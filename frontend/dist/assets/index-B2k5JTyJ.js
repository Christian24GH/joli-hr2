function zae(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const c in r)if(c!=="default"&&!(c in e)){const f=Object.getOwnPropertyDescriptor(r,c);f&&Object.defineProperty(e,c,f.get?f:{enumerable:!0,get:()=>r[c]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))r(c);new MutationObserver(c=>{for(const f of c)if(f.type==="childList")for(const p of f.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&r(p)}).observe(document,{childList:!0,subtree:!0});function n(c){const f={};return c.integrity&&(f.integrity=c.integrity),c.referrerPolicy&&(f.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?f.credentials="include":c.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function r(c){if(c.ep)return;c.ep=!0;const f=n(c);fetch(c.href,f)}})();var G2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ca(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var lP={exports:{}},s1={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S5;function Fae(){if(S5)return s1;S5=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,c,f){var p=null;if(f!==void 0&&(p=""+f),c.key!==void 0&&(p=""+c.key),"key"in c){f={};for(var s in c)s!=="key"&&(f[s]=c[s])}else f=c;return c=f.ref,{$$typeof:e,type:r,key:p,ref:c!==void 0?c:null,props:f}}return s1.Fragment=t,s1.jsx=n,s1.jsxs=n,s1}var T5;function Bae(){return T5||(T5=1,lP.exports=Fae()),lP.exports}var o=Bae(),cP={exports:{}},Is={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A5;function Uae(){if(A5)return Is;A5=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),f=Symbol.for("react.consumer"),p=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),T=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),N=Symbol.iterator;function D(He){return He===null||typeof He!="object"?null:(He=N&&He[N]||He["@@iterator"],typeof He=="function"?He:null)}var V={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$=Object.assign,B={};function F(He,pt,We){this.props=He,this.context=pt,this.refs=B,this.updater=We||V}F.prototype.isReactComponent={},F.prototype.setState=function(He,pt){if(typeof He!="object"&&typeof He!="function"&&He!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,He,pt,"setState")},F.prototype.forceUpdate=function(He){this.updater.enqueueForceUpdate(this,He,"forceUpdate")};function K(){}K.prototype=F.prototype;function Y(He,pt,We){this.props=He,this.context=pt,this.refs=B,this.updater=We||V}var X=Y.prototype=new K;X.constructor=Y,$(X,F.prototype),X.isPureReactComponent=!0;var ae=Array.isArray,Z={H:null,A:null,T:null,S:null,V:null},se=Object.prototype.hasOwnProperty;function he(He,pt,We,Je,jt,Pt){return We=Pt.ref,{$$typeof:e,type:He,key:pt,ref:We!==void 0?We:null,props:Pt}}function ye(He,pt){return he(He.type,pt,void 0,void 0,void 0,He.props)}function Ce(He){return typeof He=="object"&&He!==null&&He.$$typeof===e}function Ve(He){var pt={"=":"=0",":":"=2"};return"$"+He.replace(/[=:]/g,function(We){return pt[We]})}var Re=/\/+/g;function $e(He,pt){return typeof He=="object"&&He!==null&&He.key!=null?Ve(""+He.key):pt.toString(36)}function nt(){}function Me(He){switch(He.status){case"fulfilled":return He.value;case"rejected":throw He.reason;default:switch(typeof He.status=="string"?He.then(nt,nt):(He.status="pending",He.then(function(pt){He.status==="pending"&&(He.status="fulfilled",He.value=pt)},function(pt){He.status==="pending"&&(He.status="rejected",He.reason=pt)})),He.status){case"fulfilled":return He.value;case"rejected":throw He.reason}}throw He}function rt(He,pt,We,Je,jt){var Pt=typeof He;(Pt==="undefined"||Pt==="boolean")&&(He=null);var Ot=!1;if(He===null)Ot=!0;else switch(Pt){case"bigint":case"string":case"number":Ot=!0;break;case"object":switch(He.$$typeof){case e:case t:Ot=!0;break;case E:return Ot=He._init,rt(Ot(He._payload),pt,We,Je,jt)}}if(Ot)return jt=jt(He),Ot=Je===""?"."+$e(He,0):Je,ae(jt)?(We="",Ot!=null&&(We=Ot.replace(Re,"$&/")+"/"),rt(jt,pt,We,"",function(Jt){return Jt})):jt!=null&&(Ce(jt)&&(jt=ye(jt,We+(jt.key==null||He&&He.key===jt.key?"":(""+jt.key).replace(Re,"$&/")+"/")+Ot)),pt.push(jt)),1;Ot=0;var Mt=Je===""?".":Je+":";if(ae(He))for(var an=0;an<He.length;an++)Je=He[an],Pt=Mt+$e(Je,an),Ot+=rt(Je,pt,We,Pt,jt);else if(an=D(He),typeof an=="function")for(He=an.call(He),an=0;!(Je=He.next()).done;)Je=Je.value,Pt=Mt+$e(Je,an++),Ot+=rt(Je,pt,We,Pt,jt);else if(Pt==="object"){if(typeof He.then=="function")return rt(Me(He),pt,We,Je,jt);throw pt=String(He),Error("Objects are not valid as a React child (found: "+(pt==="[object Object]"?"object with keys {"+Object.keys(He).join(", ")+"}":pt)+"). If you meant to render a collection of children, use an array instead.")}return Ot}function Ee(He,pt,We){if(He==null)return He;var Je=[],jt=0;return rt(He,Je,"","",function(Pt){return pt.call(We,Pt,jt++)}),Je}function it(He){if(He._status===-1){var pt=He._result;pt=pt(),pt.then(function(We){(He._status===0||He._status===-1)&&(He._status=1,He._result=We)},function(We){(He._status===0||He._status===-1)&&(He._status=2,He._result=We)}),He._status===-1&&(He._status=0,He._result=pt)}if(He._status===1)return He._result.default;throw He._result}var et=typeof reportError=="function"?reportError:function(He){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var pt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof He=="object"&&He!==null&&typeof He.message=="string"?String(He.message):String(He),error:He});if(!window.dispatchEvent(pt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",He);return}console.error(He)};function mt(){}return Is.Children={map:Ee,forEach:function(He,pt,We){Ee(He,function(){pt.apply(this,arguments)},We)},count:function(He){var pt=0;return Ee(He,function(){pt++}),pt},toArray:function(He){return Ee(He,function(pt){return pt})||[]},only:function(He){if(!Ce(He))throw Error("React.Children.only expected to receive a single React element child.");return He}},Is.Component=F,Is.Fragment=n,Is.Profiler=c,Is.PureComponent=Y,Is.StrictMode=r,Is.Suspense=w,Is.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Z,Is.__COMPILER_RUNTIME={__proto__:null,c:function(He){return Z.H.useMemoCache(He)}},Is.cache=function(He){return function(){return He.apply(null,arguments)}},Is.cloneElement=function(He,pt,We){if(He==null)throw Error("The argument must be a React element, but you passed "+He+".");var Je=$({},He.props),jt=He.key,Pt=void 0;if(pt!=null)for(Ot in pt.ref!==void 0&&(Pt=void 0),pt.key!==void 0&&(jt=""+pt.key),pt)!se.call(pt,Ot)||Ot==="key"||Ot==="__self"||Ot==="__source"||Ot==="ref"&&pt.ref===void 0||(Je[Ot]=pt[Ot]);var Ot=arguments.length-2;if(Ot===1)Je.children=We;else if(1<Ot){for(var Mt=Array(Ot),an=0;an<Ot;an++)Mt[an]=arguments[an+2];Je.children=Mt}return he(He.type,jt,void 0,void 0,Pt,Je)},Is.createContext=function(He){return He={$$typeof:p,_currentValue:He,_currentValue2:He,_threadCount:0,Provider:null,Consumer:null},He.Provider=He,He.Consumer={$$typeof:f,_context:He},He},Is.createElement=function(He,pt,We){var Je,jt={},Pt=null;if(pt!=null)for(Je in pt.key!==void 0&&(Pt=""+pt.key),pt)se.call(pt,Je)&&Je!=="key"&&Je!=="__self"&&Je!=="__source"&&(jt[Je]=pt[Je]);var Ot=arguments.length-2;if(Ot===1)jt.children=We;else if(1<Ot){for(var Mt=Array(Ot),an=0;an<Ot;an++)Mt[an]=arguments[an+2];jt.children=Mt}if(He&&He.defaultProps)for(Je in Ot=He.defaultProps,Ot)jt[Je]===void 0&&(jt[Je]=Ot[Je]);return he(He,Pt,void 0,void 0,null,jt)},Is.createRef=function(){return{current:null}},Is.forwardRef=function(He){return{$$typeof:s,render:He}},Is.isValidElement=Ce,Is.lazy=function(He){return{$$typeof:E,_payload:{_status:-1,_result:He},_init:it}},Is.memo=function(He,pt){return{$$typeof:T,type:He,compare:pt===void 0?null:pt}},Is.startTransition=function(He){var pt=Z.T,We={};Z.T=We;try{var Je=He(),jt=Z.S;jt!==null&&jt(We,Je),typeof Je=="object"&&Je!==null&&typeof Je.then=="function"&&Je.then(mt,et)}catch(Pt){et(Pt)}finally{Z.T=pt}},Is.unstable_useCacheRefresh=function(){return Z.H.useCacheRefresh()},Is.use=function(He){return Z.H.use(He)},Is.useActionState=function(He,pt,We){return Z.H.useActionState(He,pt,We)},Is.useCallback=function(He,pt){return Z.H.useCallback(He,pt)},Is.useContext=function(He){return Z.H.useContext(He)},Is.useDebugValue=function(){},Is.useDeferredValue=function(He,pt){return Z.H.useDeferredValue(He,pt)},Is.useEffect=function(He,pt,We){var Je=Z.H;if(typeof We=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Je.useEffect(He,pt)},Is.useId=function(){return Z.H.useId()},Is.useImperativeHandle=function(He,pt,We){return Z.H.useImperativeHandle(He,pt,We)},Is.useInsertionEffect=function(He,pt){return Z.H.useInsertionEffect(He,pt)},Is.useLayoutEffect=function(He,pt){return Z.H.useLayoutEffect(He,pt)},Is.useMemo=function(He,pt){return Z.H.useMemo(He,pt)},Is.useOptimistic=function(He,pt){return Z.H.useOptimistic(He,pt)},Is.useReducer=function(He,pt,We){return Z.H.useReducer(He,pt,We)},Is.useRef=function(He){return Z.H.useRef(He)},Is.useState=function(He){return Z.H.useState(He)},Is.useSyncExternalStore=function(He,pt,We){return Z.H.useSyncExternalStore(He,pt,We)},Is.useTransition=function(){return Z.H.useTransition()},Is.version="19.1.1",Is}var j5;function EE(){return j5||(j5=1,cP.exports=Uae()),cP.exports}var z=EE();const _e=Ca(z),K9=zae({__proto__:null,default:_e},[z]);var uP={exports:{}},a1={},dP={exports:{}},hP={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E5;function Vae(){return E5||(E5=1,(function(e){function t(Ee,it){var et=Ee.length;Ee.push(it);e:for(;0<et;){var mt=et-1>>>1,He=Ee[mt];if(0<c(He,it))Ee[mt]=it,Ee[et]=He,et=mt;else break e}}function n(Ee){return Ee.length===0?null:Ee[0]}function r(Ee){if(Ee.length===0)return null;var it=Ee[0],et=Ee.pop();if(et!==it){Ee[0]=et;e:for(var mt=0,He=Ee.length,pt=He>>>1;mt<pt;){var We=2*(mt+1)-1,Je=Ee[We],jt=We+1,Pt=Ee[jt];if(0>c(Je,et))jt<He&&0>c(Pt,Je)?(Ee[mt]=Pt,Ee[jt]=et,mt=jt):(Ee[mt]=Je,Ee[We]=et,mt=We);else if(jt<He&&0>c(Pt,et))Ee[mt]=Pt,Ee[jt]=et,mt=jt;else break e}}return it}function c(Ee,it){var et=Ee.sortIndex-it.sortIndex;return et!==0?et:Ee.id-it.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var f=performance;e.unstable_now=function(){return f.now()}}else{var p=Date,s=p.now();e.unstable_now=function(){return p.now()-s}}var w=[],T=[],E=1,N=null,D=3,V=!1,$=!1,B=!1,F=!1,K=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,X=typeof setImmediate<"u"?setImmediate:null;function ae(Ee){for(var it=n(T);it!==null;){if(it.callback===null)r(T);else if(it.startTime<=Ee)r(T),it.sortIndex=it.expirationTime,t(w,it);else break;it=n(T)}}function Z(Ee){if(B=!1,ae(Ee),!$)if(n(w)!==null)$=!0,se||(se=!0,$e());else{var it=n(T);it!==null&&rt(Z,it.startTime-Ee)}}var se=!1,he=-1,ye=5,Ce=-1;function Ve(){return F?!0:!(e.unstable_now()-Ce<ye)}function Re(){if(F=!1,se){var Ee=e.unstable_now();Ce=Ee;var it=!0;try{e:{$=!1,B&&(B=!1,Y(he),he=-1),V=!0;var et=D;try{t:{for(ae(Ee),N=n(w);N!==null&&!(N.expirationTime>Ee&&Ve());){var mt=N.callback;if(typeof mt=="function"){N.callback=null,D=N.priorityLevel;var He=mt(N.expirationTime<=Ee);if(Ee=e.unstable_now(),typeof He=="function"){N.callback=He,ae(Ee),it=!0;break t}N===n(w)&&r(w),ae(Ee)}else r(w);N=n(w)}if(N!==null)it=!0;else{var pt=n(T);pt!==null&&rt(Z,pt.startTime-Ee),it=!1}}break e}finally{N=null,D=et,V=!1}it=void 0}}finally{it?$e():se=!1}}}var $e;if(typeof X=="function")$e=function(){X(Re)};else if(typeof MessageChannel<"u"){var nt=new MessageChannel,Me=nt.port2;nt.port1.onmessage=Re,$e=function(){Me.postMessage(null)}}else $e=function(){K(Re,0)};function rt(Ee,it){he=K(function(){Ee(e.unstable_now())},it)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ee){Ee.callback=null},e.unstable_forceFrameRate=function(Ee){0>Ee||125<Ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ye=0<Ee?Math.floor(1e3/Ee):5},e.unstable_getCurrentPriorityLevel=function(){return D},e.unstable_next=function(Ee){switch(D){case 1:case 2:case 3:var it=3;break;default:it=D}var et=D;D=it;try{return Ee()}finally{D=et}},e.unstable_requestPaint=function(){F=!0},e.unstable_runWithPriority=function(Ee,it){switch(Ee){case 1:case 2:case 3:case 4:case 5:break;default:Ee=3}var et=D;D=Ee;try{return it()}finally{D=et}},e.unstable_scheduleCallback=function(Ee,it,et){var mt=e.unstable_now();switch(typeof et=="object"&&et!==null?(et=et.delay,et=typeof et=="number"&&0<et?mt+et:mt):et=mt,Ee){case 1:var He=-1;break;case 2:He=250;break;case 5:He=1073741823;break;case 4:He=1e4;break;default:He=5e3}return He=et+He,Ee={id:E++,callback:it,priorityLevel:Ee,startTime:et,expirationTime:He,sortIndex:-1},et>mt?(Ee.sortIndex=et,t(T,Ee),n(w)===null&&Ee===n(T)&&(B?(Y(he),he=-1):B=!0,rt(Z,et-mt))):(Ee.sortIndex=He,t(w,Ee),$||V||($=!0,se||(se=!0,$e()))),Ee},e.unstable_shouldYield=Ve,e.unstable_wrapCallback=function(Ee){var it=D;return function(){var et=D;D=it;try{return Ee.apply(this,arguments)}finally{D=et}}}})(hP)),hP}var C5;function $ae(){return C5||(C5=1,dP.exports=Vae()),dP.exports}var fP={exports:{}},Yc={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N5;function qae(){if(N5)return Yc;N5=1;var e=EE();function t(w){var T="https://react.dev/errors/"+w;if(1<arguments.length){T+="?args[]="+encodeURIComponent(arguments[1]);for(var E=2;E<arguments.length;E++)T+="&args[]="+encodeURIComponent(arguments[E])}return"Minified React error #"+w+"; visit "+T+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},c=Symbol.for("react.portal");function f(w,T,E){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:N==null?null:""+N,children:w,containerInfo:T,implementation:E}}var p=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function s(w,T){if(w==="font")return"";if(typeof T=="string")return T==="use-credentials"?T:""}return Yc.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Yc.createPortal=function(w,T){var E=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!T||T.nodeType!==1&&T.nodeType!==9&&T.nodeType!==11)throw Error(t(299));return f(w,T,null,E)},Yc.flushSync=function(w){var T=p.T,E=r.p;try{if(p.T=null,r.p=2,w)return w()}finally{p.T=T,r.p=E,r.d.f()}},Yc.preconnect=function(w,T){typeof w=="string"&&(T?(T=T.crossOrigin,T=typeof T=="string"?T==="use-credentials"?T:"":void 0):T=null,r.d.C(w,T))},Yc.prefetchDNS=function(w){typeof w=="string"&&r.d.D(w)},Yc.preinit=function(w,T){if(typeof w=="string"&&T&&typeof T.as=="string"){var E=T.as,N=s(E,T.crossOrigin),D=typeof T.integrity=="string"?T.integrity:void 0,V=typeof T.fetchPriority=="string"?T.fetchPriority:void 0;E==="style"?r.d.S(w,typeof T.precedence=="string"?T.precedence:void 0,{crossOrigin:N,integrity:D,fetchPriority:V}):E==="script"&&r.d.X(w,{crossOrigin:N,integrity:D,fetchPriority:V,nonce:typeof T.nonce=="string"?T.nonce:void 0})}},Yc.preinitModule=function(w,T){if(typeof w=="string")if(typeof T=="object"&&T!==null){if(T.as==null||T.as==="script"){var E=s(T.as,T.crossOrigin);r.d.M(w,{crossOrigin:E,integrity:typeof T.integrity=="string"?T.integrity:void 0,nonce:typeof T.nonce=="string"?T.nonce:void 0})}}else T==null&&r.d.M(w)},Yc.preload=function(w,T){if(typeof w=="string"&&typeof T=="object"&&T!==null&&typeof T.as=="string"){var E=T.as,N=s(E,T.crossOrigin);r.d.L(w,E,{crossOrigin:N,integrity:typeof T.integrity=="string"?T.integrity:void 0,nonce:typeof T.nonce=="string"?T.nonce:void 0,type:typeof T.type=="string"?T.type:void 0,fetchPriority:typeof T.fetchPriority=="string"?T.fetchPriority:void 0,referrerPolicy:typeof T.referrerPolicy=="string"?T.referrerPolicy:void 0,imageSrcSet:typeof T.imageSrcSet=="string"?T.imageSrcSet:void 0,imageSizes:typeof T.imageSizes=="string"?T.imageSizes:void 0,media:typeof T.media=="string"?T.media:void 0})}},Yc.preloadModule=function(w,T){if(typeof w=="string")if(T){var E=s(T.as,T.crossOrigin);r.d.m(w,{as:typeof T.as=="string"&&T.as!=="script"?T.as:void 0,crossOrigin:E,integrity:typeof T.integrity=="string"?T.integrity:void 0})}else r.d.m(w)},Yc.requestFormReset=function(w){r.d.r(w)},Yc.unstable_batchedUpdates=function(w,T){return w(T)},Yc.useFormState=function(w,T,E){return p.H.useFormState(w,T,E)},Yc.useFormStatus=function(){return p.H.useHostTransitionStatus()},Yc.version="19.1.1",Yc}var P5;function J9(){if(P5)return fP.exports;P5=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),fP.exports=qae(),fP.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M5;function Hae(){if(M5)return a1;M5=1;var e=$ae(),t=EE(),n=J9();function r(m){var _="https://react.dev/errors/"+m;if(1<arguments.length){_+="?args[]="+encodeURIComponent(arguments[1]);for(var C=2;C<arguments.length;C++)_+="&args[]="+encodeURIComponent(arguments[C])}return"Minified React error #"+m+"; visit "+_+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(m){return!(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)}function f(m){var _=m,C=m;if(m.alternate)for(;_.return;)_=_.return;else{m=_;do _=m,(_.flags&4098)!==0&&(C=_.return),m=_.return;while(m)}return _.tag===3?C:null}function p(m){if(m.tag===13){var _=m.memoizedState;if(_===null&&(m=m.alternate,m!==null&&(_=m.memoizedState)),_!==null)return _.dehydrated}return null}function s(m){if(f(m)!==m)throw Error(r(188))}function w(m){var _=m.alternate;if(!_){if(_=f(m),_===null)throw Error(r(188));return _!==m?null:m}for(var C=m,k=_;;){var W=C.return;if(W===null)break;var ie=W.alternate;if(ie===null){if(k=W.return,k!==null){C=k;continue}break}if(W.child===ie.child){for(ie=W.child;ie;){if(ie===C)return s(W),m;if(ie===k)return s(W),_;ie=ie.sibling}throw Error(r(188))}if(C.return!==k.return)C=W,k=ie;else{for(var Ae=!1,Xe=W.child;Xe;){if(Xe===C){Ae=!0,C=W,k=ie;break}if(Xe===k){Ae=!0,k=W,C=ie;break}Xe=Xe.sibling}if(!Ae){for(Xe=ie.child;Xe;){if(Xe===C){Ae=!0,C=ie,k=W;break}if(Xe===k){Ae=!0,k=ie,C=W;break}Xe=Xe.sibling}if(!Ae)throw Error(r(189))}}if(C.alternate!==k)throw Error(r(190))}if(C.tag!==3)throw Error(r(188));return C.stateNode.current===C?m:_}function T(m){var _=m.tag;if(_===5||_===26||_===27||_===6)return m;for(m=m.child;m!==null;){if(_=T(m),_!==null)return _;m=m.sibling}return null}var E=Object.assign,N=Symbol.for("react.element"),D=Symbol.for("react.transitional.element"),V=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),K=Symbol.for("react.provider"),Y=Symbol.for("react.consumer"),X=Symbol.for("react.context"),ae=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),he=Symbol.for("react.memo"),ye=Symbol.for("react.lazy"),Ce=Symbol.for("react.activity"),Ve=Symbol.for("react.memo_cache_sentinel"),Re=Symbol.iterator;function $e(m){return m===null||typeof m!="object"?null:(m=Re&&m[Re]||m["@@iterator"],typeof m=="function"?m:null)}var nt=Symbol.for("react.client.reference");function Me(m){if(m==null)return null;if(typeof m=="function")return m.$$typeof===nt?null:m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case $:return"Fragment";case F:return"Profiler";case B:return"StrictMode";case Z:return"Suspense";case se:return"SuspenseList";case Ce:return"Activity"}if(typeof m=="object")switch(m.$$typeof){case V:return"Portal";case X:return(m.displayName||"Context")+".Provider";case Y:return(m._context.displayName||"Context")+".Consumer";case ae:var _=m.render;return m=m.displayName,m||(m=_.displayName||_.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case he:return _=m.displayName||null,_!==null?_:Me(m.type)||"Memo";case ye:_=m._payload,m=m._init;try{return Me(m(_))}catch{}}return null}var rt=Array.isArray,Ee=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,it=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,et={pending:!1,data:null,method:null,action:null},mt=[],He=-1;function pt(m){return{current:m}}function We(m){0>He||(m.current=mt[He],mt[He]=null,He--)}function Je(m,_){He++,mt[He]=m.current,m.current=_}var jt=pt(null),Pt=pt(null),Ot=pt(null),Mt=pt(null);function an(m,_){switch(Je(Ot,_),Je(Pt,m),Je(jt,null),_.nodeType){case 9:case 11:m=(m=_.documentElement)&&(m=m.namespaceURI)?XT(m):0;break;default:if(m=_.tagName,_=_.namespaceURI)_=XT(_),m=I_(_,m);else switch(m){case"svg":m=1;break;case"math":m=2;break;default:m=0}}We(jt),Je(jt,m)}function Jt(){We(jt),We(Pt),We(Ot)}function Cn(m){m.memoizedState!==null&&Je(Mt,m);var _=jt.current,C=I_(_,m.type);_!==C&&(Je(Pt,m),Je(jt,C))}function nr(m){Pt.current===m&&(We(jt),We(Pt)),Mt.current===m&&(We(Mt),sg._currentValue=et)}var sn=Object.prototype.hasOwnProperty,zr=e.unstable_scheduleCallback,or=e.unstable_cancelCallback,Rr=e.unstable_shouldYield,qr=e.unstable_requestPaint,Nn=e.unstable_now,ci=e.unstable_getCurrentPriorityLevel,ui=e.unstable_ImmediatePriority,st=e.unstable_UserBlockingPriority,qt=e.unstable_NormalPriority,rn=e.unstable_LowPriority,Wn=e.unstable_IdlePriority,Vt=e.log,un=e.unstable_setDisableYieldValue,hr=null,$t=null;function lr(m){if(typeof Vt=="function"&&un(m),$t&&typeof $t.setStrictMode=="function")try{$t.setStrictMode(hr,m)}catch{}}var ze=Math.clz32?Math.clz32:Xn,Fe=Math.log,jn=Math.LN2;function Xn(m){return m>>>=0,m===0?32:31-(Fe(m)/jn|0)|0}var mr=256,Ur=4194304;function yi(m){var _=m&42;if(_!==0)return _;switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return m&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return m}}function Hi(m,_,C){var k=m.pendingLanes;if(k===0)return 0;var W=0,ie=m.suspendedLanes,Ae=m.pingedLanes;m=m.warmLanes;var Xe=k&134217727;return Xe!==0?(k=Xe&~ie,k!==0?W=yi(k):(Ae&=Xe,Ae!==0?W=yi(Ae):C||(C=Xe&~m,C!==0&&(W=yi(C))))):(Xe=k&~ie,Xe!==0?W=yi(Xe):Ae!==0?W=yi(Ae):C||(C=k&~m,C!==0&&(W=yi(C)))),W===0?0:_!==0&&_!==W&&(_&ie)===0&&(ie=W&-W,C=_&-_,ie>=C||ie===32&&(C&4194048)!==0)?_:W}function xr(m,_){return(m.pendingLanes&~(m.suspendedLanes&~m.pingedLanes)&_)===0}function dr(m,_){switch(m){case 1:case 2:case 4:case 8:case 64:return _+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ki(){var m=mr;return mr<<=1,(mr&4194048)===0&&(mr=256),m}function Di(){var m=Ur;return Ur<<=1,(Ur&62914560)===0&&(Ur=4194304),m}function Ji(m){for(var _=[],C=0;31>C;C++)_.push(m);return _}function bs(m,_){m.pendingLanes|=_,_!==268435456&&(m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0)}function Ys(m,_,C,k,W,ie){var Ae=m.pendingLanes;m.pendingLanes=C,m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0,m.expiredLanes&=C,m.entangledLanes&=C,m.errorRecoveryDisabledLanes&=C,m.shellSuspendCounter=0;var Xe=m.entanglements,Nt=m.expirationTimes,on=m.hiddenUpdates;for(C=Ae&~C;0<C;){var zn=31-ze(C),Yn=1<<zn;Xe[zn]=0,Nt[zn]=-1;var _n=on[zn];if(_n!==null)for(on[zn]=null,zn=0;zn<_n.length;zn++){var Tn=_n[zn];Tn!==null&&(Tn.lane&=-536870913)}C&=~Yn}k!==0&&Vr(m,k,0),ie!==0&&W===0&&m.tag!==0&&(m.suspendedLanes|=ie&~(Ae&~_))}function Vr(m,_,C){m.pendingLanes|=_,m.suspendedLanes&=~_;var k=31-ze(_);m.entangledLanes|=_,m.entanglements[k]=m.entanglements[k]|1073741824|C&4194090}function Rt(m,_){var C=m.entangledLanes|=_;for(m=m.entanglements;C;){var k=31-ze(C),W=1<<k;W&_|m[k]&_&&(m[k]|=_),C&=~W}}function Jr(m){switch(m){case 2:m=1;break;case 8:m=4;break;case 32:m=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:m=128;break;case 268435456:m=134217728;break;default:m=0}return m}function xa(m){return m&=-m,2<m?8<m?(m&134217727)!==0?32:268435456:8:2}function ka(){var m=it.p;return m!==0?m:(m=window.event,m===void 0?32:Pw(m.type))}function Dr(m,_){var C=it.p;try{return it.p=m,_()}finally{it.p=C}}var gt=Math.random().toString(36).slice(2),Q="__reactFiber$"+gt,fe="__reactProps$"+gt,Te="__reactContainer$"+gt,ke="__reactEvents$"+gt,Oe="__reactListeners$"+gt,ut="__reactHandles$"+gt,Et="__reactResources$"+gt,ht="__reactMarker$"+gt;function St(m){delete m[Q],delete m[fe],delete m[ke],delete m[Oe],delete m[ut]}function nn(m){var _=m[Q];if(_)return _;for(var C=m.parentNode;C;){if(_=C[Te]||C[Q]){if(C=_.alternate,_.child!==null||C!==null&&C.child!==null)for(m=U_(m);m!==null;){if(C=m[Q])return C;m=U_(m)}return _}m=C,C=m.parentNode}return null}function Kt(m){if(m=m[Q]||m[Te]){var _=m.tag;if(_===5||_===6||_===13||_===26||_===27||_===3)return m}return null}function ir(m){var _=m.tag;if(_===5||_===26||_===27||_===6)return m.stateNode;throw Error(r(33))}function br(m){var _=m[Et];return _||(_=m[Et]={hoistableStyles:new Map,hoistableScripts:new Map}),_}function pr(m){m[ht]=!0}var Qr=new Set,Gr={};function Wr(m,_){Gi(m,_),Gi(m+"Capture",_)}function Gi(m,_){for(Gr[m]=_,m=0;m<_.length;m++)Qr.add(_[m])}var ai=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ws={},Ks={};function ca(m){return sn.call(Ks,m)?!0:sn.call(ws,m)?!1:ai.test(m)?Ks[m]=!0:(ws[m]=!0,!1)}function fr(m,_,C){if(ca(_))if(C===null)m.removeAttribute(_);else{switch(typeof C){case"undefined":case"function":case"symbol":m.removeAttribute(_);return;case"boolean":var k=_.toLowerCase().slice(0,5);if(k!=="data-"&&k!=="aria-"){m.removeAttribute(_);return}}m.setAttribute(_,""+C)}}function di(m,_,C){if(C===null)m.removeAttribute(_);else{switch(typeof C){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(_);return}m.setAttribute(_,""+C)}}function wr(m,_,C,k){if(k===null)m.removeAttribute(C);else{switch(typeof k){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(C);return}m.setAttributeNS(_,C,""+k)}}var Fi,rs;function Js(m){if(Fi===void 0)try{throw Error()}catch(C){var _=C.stack.trim().match(/\n( *(at )?)/);Fi=_&&_[1]||"",rs=-1<C.stack.indexOf(`
    at`)?" (<anonymous>)":-1<C.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Fi+m+rs}var Na=!1;function Ia(m,_){if(!m||Na)return"";Na=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var k={DetermineComponentFrameRoot:function(){try{if(_){var Yn=function(){throw Error()};if(Object.defineProperty(Yn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Yn,[])}catch(Tn){var _n=Tn}Reflect.construct(m,[],Yn)}else{try{Yn.call()}catch(Tn){_n=Tn}m.call(Yn.prototype)}}else{try{throw Error()}catch(Tn){_n=Tn}(Yn=m())&&typeof Yn.catch=="function"&&Yn.catch(function(){})}}catch(Tn){if(Tn&&_n&&typeof Tn.stack=="string")return[Tn.stack,_n.stack]}return[null,null]}};k.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var W=Object.getOwnPropertyDescriptor(k.DetermineComponentFrameRoot,"name");W&&W.configurable&&Object.defineProperty(k.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var ie=k.DetermineComponentFrameRoot(),Ae=ie[0],Xe=ie[1];if(Ae&&Xe){var Nt=Ae.split(`
`),on=Xe.split(`
`);for(W=k=0;k<Nt.length&&!Nt[k].includes("DetermineComponentFrameRoot");)k++;for(;W<on.length&&!on[W].includes("DetermineComponentFrameRoot");)W++;if(k===Nt.length||W===on.length)for(k=Nt.length-1,W=on.length-1;1<=k&&0<=W&&Nt[k]!==on[W];)W--;for(;1<=k&&0<=W;k--,W--)if(Nt[k]!==on[W]){if(k!==1||W!==1)do if(k--,W--,0>W||Nt[k]!==on[W]){var zn=`
`+Nt[k].replace(" at new "," at ");return m.displayName&&zn.includes("<anonymous>")&&(zn=zn.replace("<anonymous>",m.displayName)),zn}while(1<=k&&0<=W);break}}}finally{Na=!1,Error.prepareStackTrace=C}return(C=m?m.displayName||m.name:"")?Js(C):""}function id(m){switch(m.tag){case 26:case 27:case 5:return Js(m.type);case 16:return Js("Lazy");case 13:return Js("Suspense");case 19:return Js("SuspenseList");case 0:case 15:return Ia(m.type,!1);case 11:return Ia(m.type.render,!1);case 1:return Ia(m.type,!0);case 31:return Js("Activity");default:return""}}function Ua(m){try{var _="";do _+=id(m),m=m.return;while(m);return _}catch(C){return`
Error generating stack: `+C.message+`
`+C.stack}}function ts(m){switch(typeof m){case"bigint":case"boolean":case"number":case"string":case"undefined":return m;case"object":return m;default:return""}}function dc(m){var _=m.type;return(m=m.nodeName)&&m.toLowerCase()==="input"&&(_==="checkbox"||_==="radio")}function Dl(m){var _=dc(m)?"checked":"value",C=Object.getOwnPropertyDescriptor(m.constructor.prototype,_),k=""+m[_];if(!m.hasOwnProperty(_)&&typeof C<"u"&&typeof C.get=="function"&&typeof C.set=="function"){var W=C.get,ie=C.set;return Object.defineProperty(m,_,{configurable:!0,get:function(){return W.call(this)},set:function(Ae){k=""+Ae,ie.call(this,Ae)}}),Object.defineProperty(m,_,{enumerable:C.enumerable}),{getValue:function(){return k},setValue:function(Ae){k=""+Ae},stopTracking:function(){m._valueTracker=null,delete m[_]}}}}function hc(m){m._valueTracker||(m._valueTracker=Dl(m))}function Nu(m){if(!m)return!1;var _=m._valueTracker;if(!_)return!0;var C=_.getValue(),k="";return m&&(k=dc(m)?m.checked?"true":"false":m.value),m=k,m!==C?(_.setValue(m),!0):!1}function ru(m){if(m=m||(typeof document<"u"?document:void 0),typeof m>"u")return null;try{return m.activeElement||m.body}catch{return m.body}}var fc=/[\n"\\]/g;function Xa(m){return m.replace(fc,function(_){return"\\"+_.charCodeAt(0).toString(16)+" "})}function sd(m,_,C,k,W,ie,Ae,Xe){m.name="",Ae!=null&&typeof Ae!="function"&&typeof Ae!="symbol"&&typeof Ae!="boolean"?m.type=Ae:m.removeAttribute("type"),_!=null?Ae==="number"?(_===0&&m.value===""||m.value!=_)&&(m.value=""+ts(_)):m.value!==""+ts(_)&&(m.value=""+ts(_)):Ae!=="submit"&&Ae!=="reset"||m.removeAttribute("value"),_!=null?zo(m,Ae,ts(_)):C!=null?zo(m,Ae,ts(C)):k!=null&&m.removeAttribute("value"),W==null&&ie!=null&&(m.defaultChecked=!!ie),W!=null&&(m.checked=W&&typeof W!="function"&&typeof W!="symbol"),Xe!=null&&typeof Xe!="function"&&typeof Xe!="symbol"&&typeof Xe!="boolean"?m.name=""+ts(Xe):m.removeAttribute("name")}function co(m,_,C,k,W,ie,Ae,Xe){if(ie!=null&&typeof ie!="function"&&typeof ie!="symbol"&&typeof ie!="boolean"&&(m.type=ie),_!=null||C!=null){if(!(ie!=="submit"&&ie!=="reset"||_!=null))return;C=C!=null?""+ts(C):"",_=_!=null?""+ts(_):C,Xe||_===m.value||(m.value=_),m.defaultValue=_}k=k??W,k=typeof k!="function"&&typeof k!="symbol"&&!!k,m.checked=Xe?m.checked:!!k,m.defaultChecked=!!k,Ae!=null&&typeof Ae!="function"&&typeof Ae!="symbol"&&typeof Ae!="boolean"&&(m.name=Ae)}function zo(m,_,C){_==="number"&&ru(m.ownerDocument)===m||m.defaultValue===""+C||(m.defaultValue=""+C)}function Za(m,_,C,k){if(m=m.options,_){_={};for(var W=0;W<C.length;W++)_["$"+C[W]]=!0;for(C=0;C<m.length;C++)W=_.hasOwnProperty("$"+m[C].value),m[C].selected!==W&&(m[C].selected=W),W&&k&&(m[C].defaultSelected=!0)}else{for(C=""+ts(C),_=null,W=0;W<m.length;W++){if(m[W].value===C){m[W].selected=!0,k&&(m[W].defaultSelected=!0);return}_!==null||m[W].disabled||(_=m[W])}_!==null&&(_.selected=!0)}}function Zo(m,_,C){if(_!=null&&(_=""+ts(_),_!==m.value&&(m.value=_),C==null)){m.defaultValue!==_&&(m.defaultValue=_);return}m.defaultValue=C!=null?""+ts(C):""}function Po(m,_,C,k){if(_==null){if(k!=null){if(C!=null)throw Error(r(92));if(rt(k)){if(1<k.length)throw Error(r(93));k=k[0]}C=k}C==null&&(C=""),_=C}C=ts(_),m.defaultValue=C,k=m.textContent,k===C&&k!==""&&k!==null&&(m.value=k)}function to(m,_){if(_){var C=m.firstChild;if(C&&C===m.lastChild&&C.nodeType===3){C.nodeValue=_;return}}m.textContent=_}var Pu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ml(m,_,C){var k=_.indexOf("--")===0;C==null||typeof C=="boolean"||C===""?k?m.setProperty(_,""):_==="float"?m.cssFloat="":m[_]="":k?m.setProperty(_,C):typeof C!="number"||C===0||Pu.has(_)?_==="float"?m.cssFloat=C:m[_]=(""+C).trim():m[_]=C+"px"}function pc(m,_,C){if(_!=null&&typeof _!="object")throw Error(r(62));if(m=m.style,C!=null){for(var k in C)!C.hasOwnProperty(k)||_!=null&&_.hasOwnProperty(k)||(k.indexOf("--")===0?m.setProperty(k,""):k==="float"?m.cssFloat="":m[k]="");for(var W in _)k=_[W],_.hasOwnProperty(W)&&C[W]!==k&&ml(m,W,k)}else for(var ie in _)_.hasOwnProperty(ie)&&ml(m,ie,_[ie])}function Va(m){if(m.indexOf("-")===-1)return!1;switch(m){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nl=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ad=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function wo(m){return ad.test(""+m)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":m}var $a=null;function rl(m){return m=m.target||m.srcElement||window,m.correspondingUseElement&&(m=m.correspondingUseElement),m.nodeType===3?m.parentNode:m}var Ql=null,gl=null;function qh(m){var _=Kt(m);if(_&&(m=_.stateNode)){var C=m[fe]||null;e:switch(m=_.stateNode,_.type){case"input":if(sd(m,C.value,C.defaultValue,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name),_=C.name,C.type==="radio"&&_!=null){for(C=m;C.parentNode;)C=C.parentNode;for(C=C.querySelectorAll('input[name="'+Xa(""+_)+'"][type="radio"]'),_=0;_<C.length;_++){var k=C[_];if(k!==m&&k.form===m.form){var W=k[fe]||null;if(!W)throw Error(r(90));sd(k,W.value,W.defaultValue,W.defaultValue,W.checked,W.defaultChecked,W.type,W.name)}}for(_=0;_<C.length;_++)k=C[_],k.form===m.form&&Nu(k)}break e;case"textarea":Zo(m,C.value,C.defaultValue);break e;case"select":_=C.value,_!=null&&Za(m,!!C.multiple,_,!1)}}}var Kd=!1;function Mu(m,_,C){if(Kd)return m(_,C);Kd=!0;try{var k=m(_);return k}finally{if(Kd=!1,(Ql!==null||gl!==null)&&(la(),Ql&&(_=Ql,m=gl,gl=Ql=null,qh(_),m)))for(_=0;_<m.length;_++)qh(m[_])}}function bi(m,_){var C=m.stateNode;if(C===null)return null;var k=C[fe]||null;if(k===null)return null;C=k[_];e:switch(_){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(k=!k.disabled)||(m=m.type,k=!(m==="button"||m==="input"||m==="select"||m==="textarea")),m=!k;break e;default:m=!1}if(m)return null;if(C&&typeof C!="function")throw Error(r(231,_,typeof C));return C}var yl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),mc=!1;if(yl)try{var gc={};Object.defineProperty(gc,"passive",{get:function(){mc=!0}}),window.addEventListener("test",gc,gc),window.removeEventListener("test",gc,gc)}catch{mc=!1}var je=null,ot=null,vn=null;function Sr(){if(vn)return vn;var m,_=ot,C=_.length,k,W="value"in je?je.value:je.textContent,ie=W.length;for(m=0;m<C&&_[m]===W[m];m++);var Ae=C-m;for(k=1;k<=Ae&&_[C-k]===W[ie-k];k++);return vn=W.slice(m,1<k?1-k:void 0)}function gr(m){var _=m.keyCode;return"charCode"in m?(m=m.charCode,m===0&&_===13&&(m=13)):m=_,m===10&&(m=13),32<=m||m===13?m:0}function Zn(){return!0}function Mo(){return!1}function ua(m){function _(C,k,W,ie,Ae){this._reactName=C,this._targetInst=W,this.type=k,this.nativeEvent=ie,this.target=Ae,this.currentTarget=null;for(var Xe in m)m.hasOwnProperty(Xe)&&(C=m[Xe],this[Xe]=C?C(ie):ie[Xe]);return this.isDefaultPrevented=(ie.defaultPrevented!=null?ie.defaultPrevented:ie.returnValue===!1)?Zn:Mo,this.isPropagationStopped=Mo,this}return E(_.prototype,{preventDefault:function(){this.defaultPrevented=!0;var C=this.nativeEvent;C&&(C.preventDefault?C.preventDefault():typeof C.returnValue!="unknown"&&(C.returnValue=!1),this.isDefaultPrevented=Zn)},stopPropagation:function(){var C=this.nativeEvent;C&&(C.stopPropagation?C.stopPropagation():typeof C.cancelBubble!="unknown"&&(C.cancelBubble=!0),this.isPropagationStopped=Zn)},persist:function(){},isPersistent:Zn}),_}var no={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(m){return m.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},La=ua(no),ta=E({},no,{view:0,detail:0}),Ta=ua(ta),kl,yc,Fo,Jd=E({},ta,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wh,button:0,buttons:0,relatedTarget:function(m){return m.relatedTarget===void 0?m.fromElement===m.srcElement?m.toElement:m.fromElement:m.relatedTarget},movementX:function(m){return"movementX"in m?m.movementX:(m!==Fo&&(Fo&&m.type==="mousemove"?(kl=m.screenX-Fo.screenX,yc=m.screenY-Fo.screenY):yc=kl=0,Fo=m),kl)},movementY:function(m){return"movementY"in m?m.movementY:yc}}),fm=ua(Jd),od=E({},Jd,{dataTransfer:0}),vl=ua(od),Bg=E({},ta,{relatedTarget:0}),Qd=ua(Bg),pm=E({},no,{animationName:0,elapsedTime:0,pseudoElement:0}),ns=ua(pm),Hh=E({},no,{clipboardData:function(m){return"clipboardData"in m?m.clipboardData:window.clipboardData}}),eh=ua(Hh),Ug=E({},no,{data:0}),yr=ua(Ug),Vg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Gh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ld={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Il(m){var _=this.nativeEvent;return _.getModifierState?_.getModifierState(m):(m=ld[m])?!!_[m]:!1}function Wh(){return Il}var th=E({},ta,{key:function(m){if(m.key){var _=Vg[m.key]||m.key;if(_!=="Unidentified")return _}return m.type==="keypress"?(m=gr(m),m===13?"Enter":String.fromCharCode(m)):m.type==="keydown"||m.type==="keyup"?Gh[m.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wh,charCode:function(m){return m.type==="keypress"?gr(m):0},keyCode:function(m){return m.type==="keydown"||m.type==="keyup"?m.keyCode:0},which:function(m){return m.type==="keypress"?gr(m):m.type==="keydown"||m.type==="keyup"?m.keyCode:0}}),cr=ua(th),Qi=E({},Jd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ri=ua(Qi),Yo=E({},ta,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wh}),iu=ua(Yo),ve=E({},no,{propertyName:0,elapsedTime:0,pseudoElement:0}),oe=ua(ve),xe=E({},Jd,{deltaX:function(m){return"deltaX"in m?m.deltaX:"wheelDeltaX"in m?-m.wheelDeltaX:0},deltaY:function(m){return"deltaY"in m?m.deltaY:"wheelDeltaY"in m?-m.wheelDeltaY:"wheelDelta"in m?-m.wheelDelta:0},deltaZ:0,deltaMode:0}),lt=ua(xe),vt=E({},no,{newState:0,oldState:0}),An=ua(vt),Nr=[9,13,27,32],Xr=yl&&"CompositionEvent"in window,Ti=null;yl&&"documentMode"in document&&(Ti=document.documentMode);var Ms=yl&&"TextEvent"in window&&!Ti,$s=yl&&(!Xr||Ti&&8<Ti&&11>=Ti),Pa=" ",Ru=!1;function Bo(m,_){switch(m){case"keyup":return Nr.indexOf(_.keyCode)!==-1;case"keydown":return _.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vc(m){return m=m.detail,typeof m=="object"&&"data"in m?m.data:null}var uo=!1;function Ou(m,_){switch(m){case"compositionend":return vc(_);case"keypress":return _.which!==32?null:(Ru=!0,Pa);case"textInput":return m=_.data,m===Pa&&Ru?null:m;default:return null}}function ei(m,_){if(uo)return m==="compositionend"||!Xr&&Bo(m,_)?(m=Sr(),vn=ot=je=null,uo=!1,m):null;switch(m){case"paste":return null;case"keypress":if(!(_.ctrlKey||_.altKey||_.metaKey)||_.ctrlKey&&_.altKey){if(_.char&&1<_.char.length)return _.char;if(_.which)return String.fromCharCode(_.which)}return null;case"compositionend":return $s&&_.locale!=="ko"?null:_.data;default:return null}}var Fn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ll(m){var _=m&&m.nodeName&&m.nodeName.toLowerCase();return _==="input"?!!Fn[m.type]:_==="textarea"}function Pr(m,_,C,k){Ql?gl?gl.push(k):gl=[k]:Ql=k,_=Mp(_,"onChange"),0<_.length&&(C=new La("onChange","change",null,C,k),m.push({event:C,listeners:_}))}var aa=null,Dc=null;function _r(m){fw(m,0)}function xc(m){var _=ir(m);if(Nu(_))return m}function su(m,_){if(m==="change")return _}var kc=!1;if(yl){var Xf;if(yl){var xl="oninput"in document;if(!xl){var Uo=document.createElement("div");Uo.setAttribute("oninput","return;"),xl=typeof Uo.oninput=="function"}Xf=xl}else Xf=!1;kc=Xf&&(!document.documentMode||9<document.documentMode)}function nh(){aa&&(aa.detachEvent("onpropertychange",Ya),Dc=aa=null)}function Ya(m){if(m.propertyName==="value"&&xc(Dc)){var _=[];Pr(_,Dc,m,rl(m)),Mu(_r,_)}}function wv(m,_,C){m==="focusin"?(nh(),aa=_,Dc=C,aa.attachEvent("onpropertychange",Ya)):m==="focusout"&&nh()}function Du(m){if(m==="selectionchange"||m==="keyup"||m==="keydown")return xc(Dc)}function il(m,_){if(m==="click")return xc(_)}function mm(m,_){if(m==="input"||m==="change")return xc(_)}function ew(m,_){return m===_&&(m!==0||1/m===1/_)||m!==m&&_!==_}var _c=typeof Object.is=="function"?Object.is:ew;function Ic(m,_){if(_c(m,_))return!0;if(typeof m!="object"||m===null||typeof _!="object"||_===null)return!1;var C=Object.keys(m),k=Object.keys(_);if(C.length!==k.length)return!1;for(k=0;k<C.length;k++){var W=C[k];if(!sn.call(_,W)||!_c(m[W],_[W]))return!1}return!0}function Xh(m){for(;m&&m.firstChild;)m=m.firstChild;return m}function rh(m,_){var C=Xh(m);m=0;for(var k;C;){if(C.nodeType===3){if(k=m+C.textContent.length,m<=_&&k>=_)return{node:C,offset:_-m};m=k}e:{for(;C;){if(C.nextSibling){C=C.nextSibling;break e}C=C.parentNode}C=void 0}C=Xh(C)}}function Zh(m,_){return m&&_?m===_?!0:m&&m.nodeType===3?!1:_&&_.nodeType===3?Zh(m,_.parentNode):"contains"in m?m.contains(_):m.compareDocumentPosition?!!(m.compareDocumentPosition(_)&16):!1:!1}function Sv(m){m=m!=null&&m.ownerDocument!=null&&m.ownerDocument.defaultView!=null?m.ownerDocument.defaultView:window;for(var _=ru(m.document);_ instanceof m.HTMLIFrameElement;){try{var C=typeof _.contentWindow.location.href=="string"}catch{C=!1}if(C)m=_.contentWindow;else break;_=ru(m.document)}return _}function Zf(m){var _=m&&m.nodeName&&m.nodeName.toLowerCase();return _&&(_==="input"&&(m.type==="text"||m.type==="search"||m.type==="tel"||m.type==="url"||m.type==="password")||_==="textarea"||m.contentEditable==="true")}var Tv=yl&&"documentMode"in document&&11>=document.documentMode,bc=null,Av=null,Yf=null,jv=!1;function Ev(m,_,C){var k=C.window===C?C.document:C.nodeType===9?C:C.ownerDocument;jv||bc==null||bc!==ru(k)||(k=bc,"selectionStart"in k&&Zf(k)?k={start:k.selectionStart,end:k.selectionEnd}:(k=(k.ownerDocument&&k.ownerDocument.defaultView||window).getSelection(),k={anchorNode:k.anchorNode,anchorOffset:k.anchorOffset,focusNode:k.focusNode,focusOffset:k.focusOffset}),Yf&&Ic(Yf,k)||(Yf=k,k=Mp(Av,"onSelect"),0<k.length&&(_=new La("onSelect","select",null,_,C),m.push({event:_,listeners:k}),_.target=bc)))}function ih(m,_){var C={};return C[m.toLowerCase()]=_.toLowerCase(),C["Webkit"+m]="webkit"+_,C["Moz"+m]="moz"+_,C}var sh={animationend:ih("Animation","AnimationEnd"),animationiteration:ih("Animation","AnimationIteration"),animationstart:ih("Animation","AnimationStart"),transitionrun:ih("Transition","TransitionRun"),transitionstart:ih("Transition","TransitionStart"),transitioncancel:ih("Transition","TransitionCancel"),transitionend:ih("Transition","TransitionEnd")},ku={},Cv={};yl&&(Cv=document.createElement("div").style,"AnimationEvent"in window||(delete sh.animationend.animation,delete sh.animationiteration.animation,delete sh.animationstart.animation),"TransitionEvent"in window||delete sh.transitionend.transition);function ah(m){if(ku[m])return ku[m];if(!sh[m])return m;var _=sh[m],C;for(C in _)if(_.hasOwnProperty(C)&&C in Cv)return ku[m]=_[C];return m}var gm=ah("animationend"),cd=ah("animationiteration"),Kf=ah("animationstart"),Lc=ah("transitionrun"),Nv=ah("transitionstart"),Jf=ah("transitioncancel"),Yh=ah("transitionend"),$g=new Map,Qf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Qf.push("scrollEnd");function ro(m,_){$g.set(m,_),Wr(_,[m])}var ym=new WeakMap;function mn(m,_){if(typeof m=="object"&&m!==null){var C=ym.get(m);return C!==void 0?C:(_={value:m,source:_,stack:Ua(_)},ym.set(m,_),_)}return{value:m,source:_,stack:Ua(_)}}var ec=[],ud=0,ep=0;function oh(){for(var m=ud,_=ep=ud=0;_<m;){var C=ec[_];ec[_++]=null;var k=ec[_];ec[_++]=null;var W=ec[_];ec[_++]=null;var ie=ec[_];if(ec[_++]=null,k!==null&&W!==null){var Ae=k.pending;Ae===null?W.next=W:(W.next=Ae.next,Ae.next=W),k.pending=W}ie!==0&&hd(C,W,ie)}}function Iu(m,_,C,k){ec[ud++]=m,ec[ud++]=_,ec[ud++]=C,ec[ud++]=k,ep|=k,m.lanes|=k,m=m.alternate,m!==null&&(m.lanes|=k)}function tc(m,_,C,k){return Iu(m,_,C,k),lh(m)}function dd(m,_){return Iu(m,null,null,_),lh(m)}function hd(m,_,C){m.lanes|=C;var k=m.alternate;k!==null&&(k.lanes|=C);for(var W=!1,ie=m.return;ie!==null;)ie.childLanes|=C,k=ie.alternate,k!==null&&(k.childLanes|=C),ie.tag===22&&(m=ie.stateNode,m===null||m._visibility&1||(W=!0)),m=ie,ie=ie.return;return m.tag===3?(ie=m.stateNode,W&&_!==null&&(W=31-ze(C),m=ie.hiddenUpdates,k=m[W],k===null?m[W]=[_]:k.push(_),_.lane=C|536870912),ie):null}function lh(m){if(50<pa)throw pa=0,go=null,Error(r(185));for(var _=m.return;_!==null;)m=_,_=m.return;return m.tag===3?m.stateNode:null}var _l={};function Pi(m,_,C,k){this.tag=m,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=_,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=k,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wc(m,_,C,k){return new Pi(m,_,C,k)}function vm(m){return m=m.prototype,!(!m||!m.isReactComponent)}function fd(m,_){var C=m.alternate;return C===null?(C=wc(m.tag,_,m.key,m.mode),C.elementType=m.elementType,C.type=m.type,C.stateNode=m.stateNode,C.alternate=m,m.alternate=C):(C.pendingProps=_,C.type=m.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=m.flags&65011712,C.childLanes=m.childLanes,C.lanes=m.lanes,C.child=m.child,C.memoizedProps=m.memoizedProps,C.memoizedState=m.memoizedState,C.updateQueue=m.updateQueue,_=m.dependencies,C.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext},C.sibling=m.sibling,C.index=m.index,C.ref=m.ref,C.refCleanup=m.refCleanup,C}function qg(m,_){m.flags&=65011714;var C=m.alternate;return C===null?(m.childLanes=0,m.lanes=_,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=C.childLanes,m.lanes=C.lanes,m.child=C.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=C.memoizedProps,m.memoizedState=C.memoizedState,m.updateQueue=C.updateQueue,m.type=C.type,_=C.dependencies,m.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext}),m}function xm(m,_,C,k,W,ie){var Ae=0;if(k=m,typeof m=="function")vm(m)&&(Ae=1);else if(typeof m=="string")Ae=o2(m,C,jt.current)?26:m==="html"||m==="head"||m==="body"?27:5;else e:switch(m){case Ce:return m=wc(31,C,_,W),m.elementType=Ce,m.lanes=ie,m;case $:return Ss(C.children,W,ie,_);case B:Ae=8,W|=24;break;case F:return m=wc(12,C,_,W|2),m.elementType=F,m.lanes=ie,m;case Z:return m=wc(13,C,_,W),m.elementType=Z,m.lanes=ie,m;case se:return m=wc(19,C,_,W),m.elementType=se,m.lanes=ie,m;default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case K:case X:Ae=10;break e;case Y:Ae=9;break e;case ae:Ae=11;break e;case he:Ae=14;break e;case ye:Ae=16,k=null;break e}Ae=29,C=Error(r(130,m===null?"null":typeof m,"")),k=null}return _=wc(Ae,C,_,W),_.elementType=m,_.type=k,_.lanes=ie,_}function Ss(m,_,C,k){return m=wc(7,m,k,_),m.lanes=C,m}function Pv(m,_,C){return m=wc(6,m,null,_),m.lanes=C,m}function Mv(m,_,C){return _=wc(4,m.children!==null?m.children:[],m.key,_),_.lanes=C,_.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},_}var tp=[],np=0,_m=null,Hg=0,zl=[],zc=0,ch=null,au=1,Fc="";function pd(m,_){tp[np++]=Hg,tp[np++]=_m,_m=m,Hg=_}function uh(m,_,C){zl[zc++]=au,zl[zc++]=Fc,zl[zc++]=ch,ch=m;var k=au;m=Fc;var W=32-ze(k)-1;k&=~(1<<W),C+=1;var ie=32-ze(_)+W;if(30<ie){var Ae=W-W%5;ie=(k&(1<<Ae)-1).toString(32),k>>=Ae,W-=Ae,au=1<<32-ze(_)+W|C<<W|k,Fc=ie+m}else au=1<<ie|C<<W|k,Fc=m}function dh(m){m.return!==null&&(pd(m,1),uh(m,1,0))}function rp(m){for(;m===_m;)_m=tp[--np],tp[np]=null,Hg=tp[--np],tp[np]=null;for(;m===ch;)ch=zl[--zc],zl[zc]=null,Fc=zl[--zc],zl[zc]=null,au=zl[--zc],zl[zc]=null}var Ko=null,Ma=null,oa=!1,md=null,ou=!1,hh=Error(r(519));function Lu(m){var _=Error(r(418,""));throw ip(mn(_,m)),hh}function bm(m){var _=m.stateNode,C=m.type,k=m.memoizedProps;switch(_[Q]=m,_[fe]=k,C){case"dialog":Ls("cancel",_),Ls("close",_);break;case"iframe":case"object":case"embed":Ls("load",_);break;case"video":case"audio":for(C=0;C<wy.length;C++)Ls(wy[C],_);break;case"source":Ls("error",_);break;case"img":case"image":case"link":Ls("error",_),Ls("load",_);break;case"details":Ls("toggle",_);break;case"input":Ls("invalid",_),co(_,k.value,k.defaultValue,k.checked,k.defaultChecked,k.type,k.name,!0),hc(_);break;case"select":Ls("invalid",_);break;case"textarea":Ls("invalid",_),Po(_,k.value,k.defaultValue,k.children),hc(_)}C=k.children,typeof C!="string"&&typeof C!="number"&&typeof C!="bigint"||_.textContent===""+C||k.suppressHydrationWarning===!0||pw(_.textContent,C)?(k.popover!=null&&(Ls("beforetoggle",_),Ls("toggle",_)),k.onScroll!=null&&Ls("scroll",_),k.onScrollEnd!=null&&Ls("scrollend",_),k.onClick!=null&&(_.onclick=jh),_=!0):_=!1,_||Lu(m)}function Gg(m){for(Ko=m.return;Ko;)switch(Ko.tag){case 5:case 13:ou=!1;return;case 27:case 3:ou=!0;return;default:Ko=Ko.return}}function fh(m){if(m!==Ko)return!1;if(!oa)return Gg(m),oa=!0,!1;var _=m.tag,C;if((C=_!==3&&_!==27)&&((C=_===5)&&(C=m.type,C=!(C!=="form"&&C!=="button")||vw(m.type,m.memoizedProps)),C=!C),C&&Ma&&Lu(m),Gg(m),_===13){if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(r(317));e:{for(m=m.nextSibling,_=0;m;){if(m.nodeType===8)if(C=m.data,C==="/$"){if(_===0){Ma=kd(m.nextSibling);break e}_--}else C!=="$"&&C!=="$!"&&C!=="$?"||_++;m=m.nextSibling}Ma=null}}else _===27?(_=Ma,Dd(m.type)?(m=B_,B_=null,Ma=m):Ma=_):Ma=Ko?kd(m.stateNode.nextSibling):null;return!0}function gd(){Ma=Ko=null,oa=!1}function Rv(){var m=md;return m!==null&&(Fr===null?Fr=m:Fr.push.apply(Fr,m),md=null),m}function ip(m){md===null?md=[m]:md.push(m)}var Wg=pt(null),Bc=null,zu=null;function Fu(m,_,C){Je(Wg,_._currentValue),_._currentValue=C}function yd(m){m._currentValue=Wg.current,We(Wg)}function Xg(m,_,C){for(;m!==null;){var k=m.alternate;if((m.childLanes&_)!==_?(m.childLanes|=_,k!==null&&(k.childLanes|=_)):k!==null&&(k.childLanes&_)!==_&&(k.childLanes|=_),m===C)break;m=m.return}}function wm(m,_,C,k){var W=m.child;for(W!==null&&(W.return=m);W!==null;){var ie=W.dependencies;if(ie!==null){var Ae=W.child;ie=ie.firstContext;e:for(;ie!==null;){var Xe=ie;ie=W;for(var Nt=0;Nt<_.length;Nt++)if(Xe.context===_[Nt]){ie.lanes|=C,Xe=ie.alternate,Xe!==null&&(Xe.lanes|=C),Xg(ie.return,C,m),k||(Ae=null);break e}ie=Xe.next}}else if(W.tag===18){if(Ae=W.return,Ae===null)throw Error(r(341));Ae.lanes|=C,ie=Ae.alternate,ie!==null&&(ie.lanes|=C),Xg(Ae,C,m),Ae=null}else Ae=W.child;if(Ae!==null)Ae.return=W;else for(Ae=W;Ae!==null;){if(Ae===m){Ae=null;break}if(W=Ae.sibling,W!==null){W.return=Ae.return,Ae=W;break}Ae=Ae.return}W=Ae}}function Kh(m,_,C,k){m=null;for(var W=_,ie=!1;W!==null;){if(!ie){if((W.flags&524288)!==0)ie=!0;else if((W.flags&262144)!==0)break}if(W.tag===10){var Ae=W.alternate;if(Ae===null)throw Error(r(387));if(Ae=Ae.memoizedProps,Ae!==null){var Xe=W.type;_c(W.pendingProps.value,Ae.value)||(m!==null?m.push(Xe):m=[Xe])}}else if(W===Mt.current){if(Ae=W.alternate,Ae===null)throw Error(r(387));Ae.memoizedState.memoizedState!==W.memoizedState.memoizedState&&(m!==null?m.push(sg):m=[sg])}W=W.return}m!==null&&wm(_,m,C,k),_.flags|=262144}function sp(m){for(m=m.firstContext;m!==null;){if(!_c(m.context._currentValue,m.memoizedValue))return!0;m=m.next}return!1}function Bu(m){Bc=m,zu=null,m=m.dependencies,m!==null&&(m.firstContext=null)}function Jo(m){return Ov(Bc,m)}function Uu(m,_){return Bc===null&&Bu(m),Ov(m,_)}function Ov(m,_){var C=_._currentValue;if(_={context:_,memoizedValue:C,next:null},zu===null){if(m===null)throw Error(r(308));zu=_,m.dependencies={lanes:0,firstContext:_},m.flags|=524288}else zu=zu.next=_;return C}var ap=typeof AbortController<"u"?AbortController:function(){var m=[],_=this.signal={aborted:!1,addEventListener:function(C,k){m.push(k)}};this.abort=function(){_.aborted=!0,m.forEach(function(C){return C()})}},Sm=e.unstable_scheduleCallback,Zg=e.unstable_NormalPriority,na={$$typeof:X,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Tm(){return{controller:new ap,data:new Map,refCount:0}}function ph(m){m.refCount--,m.refCount===0&&Sm(Zg,function(){m.controller.abort()})}var vd=null,op=0,mh=0,gh=null;function Yg(m,_){if(vd===null){var C=vd=[];op=0,mh=cw(),gh={status:"pending",value:void 0,then:function(k){C.push(k)}}}return op++,_.then(Am,Am),_}function Am(){if(--op===0&&vd!==null){gh!==null&&(gh.status="fulfilled");var m=vd;vd=null,mh=0,gh=null;for(var _=0;_<m.length;_++)(0,m[_])()}}function Kg(m,_){var C=[],k={status:"pending",value:null,reason:null,then:function(W){C.push(W)}};return m.then(function(){k.status="fulfilled",k.value=_;for(var W=0;W<C.length;W++)(0,C[W])(_)},function(W){for(k.status="rejected",k.reason=W,W=0;W<C.length;W++)(0,C[W])(void 0)}),k}var yh=Ee.S;Ee.S=function(m,_){typeof _=="object"&&_!==null&&typeof _.then=="function"&&Yg(m,_),yh!==null&&yh(m,_)};var xd=pt(null);function jm(){var m=xd.current;return m!==null?m:Yt.pooledCache}function Em(m,_){_===null?Je(xd,xd.current):Je(xd,_.pool)}function Jh(){var m=jm();return m===null?null:{parent:na._currentValue,pool:m}}var lp=Error(r(460)),Dv=Error(r(474)),Jg=Error(r(542)),kv={then:function(){}};function x_(m){return m=m.status,m==="fulfilled"||m==="rejected"}function Qh(){}function Qg(m,_,C){switch(C=m[C],C===void 0?m.push(_):C!==_&&(_.then(Qh,Qh),_=C),_.status){case"fulfilled":return _.value;case"rejected":throw m=_.reason,tf(m),m;default:if(typeof _.status=="string")_.then(Qh,Qh);else{if(m=Yt,m!==null&&100<m.shellSuspendCounter)throw Error(r(482));m=_,m.status="pending",m.then(function(k){if(_.status==="pending"){var W=_;W.status="fulfilled",W.value=k}},function(k){if(_.status==="pending"){var W=_;W.status="rejected",W.reason=k}})}switch(_.status){case"fulfilled":return _.value;case"rejected":throw m=_.reason,tf(m),m}throw ef=_,lp}}var ef=null;function Iv(){if(ef===null)throw Error(r(459));var m=ef;return ef=null,m}function tf(m){if(m===lp||m===Jg)throw Error(r(483))}var Vu=!1;function ey(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ty(m,_){m=m.updateQueue,_.updateQueue===m&&(_.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,callbacks:null})}function lu(m){return{lane:m,tag:0,payload:null,callback:null,next:null}}function Fl(m,_,C){var k=m.updateQueue;if(k===null)return null;if(k=k.shared,(Gt&2)!==0){var W=k.pending;return W===null?_.next=_:(_.next=W.next,W.next=_),k.pending=_,_=lh(m),hd(m,null,C),_}return Iu(m,k,_,C),lh(m)}function nf(m,_,C){if(_=_.updateQueue,_!==null&&(_=_.shared,(C&4194048)!==0)){var k=_.lanes;k&=m.pendingLanes,C|=k,_.lanes=C,Rt(m,C)}}function $u(m,_){var C=m.updateQueue,k=m.alternate;if(k!==null&&(k=k.updateQueue,C===k)){var W=null,ie=null;if(C=C.firstBaseUpdate,C!==null){do{var Ae={lane:C.lane,tag:C.tag,payload:C.payload,callback:null,next:null};ie===null?W=ie=Ae:ie=ie.next=Ae,C=C.next}while(C!==null);ie===null?W=ie=_:ie=ie.next=_}else W=ie=_;C={baseState:k.baseState,firstBaseUpdate:W,lastBaseUpdate:ie,shared:k.shared,callbacks:k.callbacks},m.updateQueue=C;return}m=C.lastBaseUpdate,m===null?C.firstBaseUpdate=_:m.next=_,C.lastBaseUpdate=_}var qu=!1;function vh(){if(qu){var m=gh;if(m!==null)throw m}}function cp(m,_,C,k){qu=!1;var W=m.updateQueue;Vu=!1;var ie=W.firstBaseUpdate,Ae=W.lastBaseUpdate,Xe=W.shared.pending;if(Xe!==null){W.shared.pending=null;var Nt=Xe,on=Nt.next;Nt.next=null,Ae===null?ie=on:Ae.next=on,Ae=Nt;var zn=m.alternate;zn!==null&&(zn=zn.updateQueue,Xe=zn.lastBaseUpdate,Xe!==Ae&&(Xe===null?zn.firstBaseUpdate=on:Xe.next=on,zn.lastBaseUpdate=Nt))}if(ie!==null){var Yn=W.baseState;Ae=0,zn=on=Nt=null,Xe=ie;do{var _n=Xe.lane&-536870913,Tn=_n!==Xe.lane;if(Tn?(en&_n)===_n:(k&_n)===_n){_n!==0&&_n===mh&&(qu=!0),zn!==null&&(zn=zn.next={lane:0,tag:Xe.tag,payload:Xe.payload,callback:null,next:null});e:{var is=m,Li=Xe;_n=_;var ja=C;switch(Li.tag){case 1:if(is=Li.payload,typeof is=="function"){Yn=is.call(ja,Yn,_n);break e}Yn=is;break e;case 3:is.flags=is.flags&-65537|128;case 0:if(is=Li.payload,_n=typeof is=="function"?is.call(ja,Yn,_n):is,_n==null)break e;Yn=E({},Yn,_n);break e;case 2:Vu=!0}}_n=Xe.callback,_n!==null&&(m.flags|=64,Tn&&(m.flags|=8192),Tn=W.callbacks,Tn===null?W.callbacks=[_n]:Tn.push(_n))}else Tn={lane:_n,tag:Xe.tag,payload:Xe.payload,callback:Xe.callback,next:null},zn===null?(on=zn=Tn,Nt=Yn):zn=zn.next=Tn,Ae|=_n;if(Xe=Xe.next,Xe===null){if(Xe=W.shared.pending,Xe===null)break;Tn=Xe,Xe=Tn.next,Tn.next=null,W.lastBaseUpdate=Tn,W.shared.pending=null}}while(!0);zn===null&&(Nt=Yn),W.baseState=Nt,W.firstBaseUpdate=on,W.lastBaseUpdate=zn,ie===null&&(W.shared.lanes=0),Zr|=Ae,m.lanes=Ae,m.memoizedState=Yn}}function Lv(m,_){if(typeof m!="function")throw Error(r(191,m));m.call(_)}function Cm(m,_){var C=m.callbacks;if(C!==null)for(m.callbacks=null,m=0;m<C.length;m++)Lv(C[m],_)}var _d=pt(null),Nm=pt(0);function ny(m,_){m=Er,Je(Nm,m),Je(_d,_),Er=m|_.baseLanes}function bd(){Je(Nm,Er),Je(_d,_d.current)}function Pm(){Er=Nm.current,We(_d),We(Nm)}var wd=0,Ts=null,qs=null,ho=null,up=!1,Uc=!1,Hu=!1,cu=0,rf=0,Vc=null,Mm=0;function io(){throw Error(r(321))}function ry(m,_){if(_===null)return!1;for(var C=0;C<_.length&&C<m.length;C++)if(!_c(m[C],_[C]))return!1;return!0}function Rm(m,_,C,k,W,ie){return wd=ie,Ts=_,_.memoizedState=null,_.updateQueue=null,_.lanes=0,Ee.H=m===null||m.memoizedState===null?bh:uy,Hu=!1,ie=C(k,W),Hu=!1,Uc&&(ie=dp(_,C,k,W)),Sd(m),ie}function Sd(m){Ee.H=jd;var _=qs!==null&&qs.next!==null;if(wd=0,ho=qs=Ts=null,up=!1,rf=0,Vc=null,_)throw Error(r(300));m===null||fo||(m=m.dependencies,m!==null&&sp(m)&&(fo=!0))}function dp(m,_,C,k){Ts=m;var W=0;do{if(Uc&&(Vc=null),rf=0,Uc=!1,25<=W)throw Error(r(301));if(W+=1,ho=qs=null,m.updateQueue!=null){var ie=m.updateQueue;ie.lastEffect=null,ie.events=null,ie.stores=null,ie.memoCache!=null&&(ie.memoCache.index=0)}Ee.H=Gv,ie=_(C,k)}while(Uc);return ie}function Hn(){var m=Ee.H,_=m.useState()[0];return _=typeof _.then=="function"?Dm(_):_,m=m.useState()[0],(qs!==null?qs.memoizedState:null)!==m&&(Ts.flags|=1024),_}function hp(){var m=cu!==0;return cu=0,m}function sf(m,_,C){_.updateQueue=m.updateQueue,_.flags&=-2053,m.lanes&=~C}function uu(m){if(up){for(m=m.memoizedState;m!==null;){var _=m.queue;_!==null&&(_.pending=null),m=m.next}up=!1}wd=0,ho=qs=Ts=null,Uc=!1,rf=cu=0,Vc=null}function Aa(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ho===null?Ts.memoizedState=ho=m:ho=ho.next=m,ho}function sr(){if(qs===null){var m=Ts.alternate;m=m!==null?m.memoizedState:null}else m=qs.next;var _=ho===null?Ts.memoizedState:ho.next;if(_!==null)ho=_,qs=m;else{if(m===null)throw Ts.alternate===null?Error(r(467)):Error(r(310));qs=m,m={memoizedState:qs.memoizedState,baseState:qs.baseState,baseQueue:qs.baseQueue,queue:qs.queue,next:null},ho===null?Ts.memoizedState=ho=m:ho=ho.next=m}return ho}function Om(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Dm(m){var _=rf;return rf+=1,Vc===null&&(Vc=[]),m=Qg(Vc,m,_),_=Ts,(ho===null?_.memoizedState:ho.next)===null&&(_=_.alternate,Ee.H=_===null||_.memoizedState===null?bh:uy),m}function iy(m){if(m!==null&&typeof m=="object"){if(typeof m.then=="function")return Dm(m);if(m.$$typeof===X)return Jo(m)}throw Error(r(438,String(m)))}function fp(m){var _=null,C=Ts.updateQueue;if(C!==null&&(_=C.memoCache),_==null){var k=Ts.alternate;k!==null&&(k=k.updateQueue,k!==null&&(k=k.memoCache,k!=null&&(_={data:k.data.map(function(W){return W.slice()}),index:0})))}if(_==null&&(_={data:[],index:0}),C===null&&(C=Om(),Ts.updateQueue=C),C.memoCache=_,C=_.data[_.index],C===void 0)for(C=_.data[_.index]=Array(m),k=0;k<m;k++)C[k]=Ve;return _.index++,C}function $c(m,_){return typeof _=="function"?_(m):_}function km(m){var _=sr();return pp(_,qs,m)}function pp(m,_,C){var k=m.queue;if(k===null)throw Error(r(311));k.lastRenderedReducer=C;var W=m.baseQueue,ie=k.pending;if(ie!==null){if(W!==null){var Ae=W.next;W.next=ie.next,ie.next=Ae}_.baseQueue=W=ie,k.pending=null}if(ie=m.baseState,W===null)m.memoizedState=ie;else{_=W.next;var Xe=Ae=null,Nt=null,on=_,zn=!1;do{var Yn=on.lane&-536870913;if(Yn!==on.lane?(en&Yn)===Yn:(wd&Yn)===Yn){var _n=on.revertLane;if(_n===0)Nt!==null&&(Nt=Nt.next={lane:0,revertLane:0,action:on.action,hasEagerState:on.hasEagerState,eagerState:on.eagerState,next:null}),Yn===mh&&(zn=!0);else if((wd&_n)===_n){on=on.next,_n===mh&&(zn=!0);continue}else Yn={lane:0,revertLane:on.revertLane,action:on.action,hasEagerState:on.hasEagerState,eagerState:on.eagerState,next:null},Nt===null?(Xe=Nt=Yn,Ae=ie):Nt=Nt.next=Yn,Ts.lanes|=_n,Zr|=_n;Yn=on.action,Hu&&C(ie,Yn),ie=on.hasEagerState?on.eagerState:C(ie,Yn)}else _n={lane:Yn,revertLane:on.revertLane,action:on.action,hasEagerState:on.hasEagerState,eagerState:on.eagerState,next:null},Nt===null?(Xe=Nt=_n,Ae=ie):Nt=Nt.next=_n,Ts.lanes|=Yn,Zr|=Yn;on=on.next}while(on!==null&&on!==_);if(Nt===null?Ae=ie:Nt.next=Xe,!_c(ie,m.memoizedState)&&(fo=!0,zn&&(C=gh,C!==null)))throw C;m.memoizedState=ie,m.baseState=Ae,m.baseQueue=Nt,k.lastRenderedState=ie}return W===null&&(k.lanes=0),[m.memoizedState,k.dispatch]}function zv(m){var _=sr(),C=_.queue;if(C===null)throw Error(r(311));C.lastRenderedReducer=m;var k=C.dispatch,W=C.pending,ie=_.memoizedState;if(W!==null){C.pending=null;var Ae=W=W.next;do ie=m(ie,Ae.action),Ae=Ae.next;while(Ae!==W);_c(ie,_.memoizedState)||(fo=!0),_.memoizedState=ie,_.baseQueue===null&&(_.baseState=ie),C.lastRenderedState=ie}return[ie,k]}function __(m,_,C){var k=Ts,W=sr(),ie=oa;if(ie){if(C===void 0)throw Error(r(407));C=C()}else C=_();var Ae=!_c((qs||W).memoizedState,C);Ae&&(W.memoizedState=C,fo=!0),W=W.queue;var Xe=sl.bind(null,k,W,m);if(yt(2048,8,Xe,[m]),W.getSnapshot!==_||Ae||ho!==null&&ho.memoizedState.tag&1){if(k.flags|=2048,fn(9,Ln(),sy.bind(null,k,W,C,_),null),Yt===null)throw Error(r(349));ie||(wd&124)!==0||Bl(k,_,C)}return C}function Bl(m,_,C){m.flags|=16384,m={getSnapshot:_,value:C},_=Ts.updateQueue,_===null?(_=Om(),Ts.updateQueue=_,_.stores=[m]):(C=_.stores,C===null?_.stores=[m]:C.push(m))}function sy(m,_,C,k){_.value=C,_.getSnapshot=k,Td(_)&&Fv(m)}function sl(m,_,C){return C(function(){Td(_)&&Fv(m)})}function Td(m){var _=m.getSnapshot;m=m.value;try{var C=_();return!_c(m,C)}catch{return!0}}function Fv(m){var _=dd(m,2);_!==null&&za(_,m,2)}function Im(m){var _=Aa();if(typeof m=="function"){var C=m;if(m=C(),Hu){lr(!0);try{C()}finally{lr(!1)}}}return _.memoizedState=_.baseState=m,_.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$c,lastRenderedState:m},_}function ay(m,_,C,k){return m.baseState=C,pp(m,qs,typeof k=="function"?k:$c)}function Bv(m,_,C,k,W){if(_p(m))throw Error(r(485));if(m=_.action,m!==null){var ie={payload:W,action:m,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Ae){ie.listeners.push(Ae)}};Ee.T!==null?C(!0):ie.isTransition=!1,k(ie),C=_.pending,C===null?(ie.next=_.pending=ie,Uv(_,ie)):(ie.next=C.next,_.pending=C.next=ie)}}function Uv(m,_){var C=_.action,k=_.payload,W=m.state;if(_.isTransition){var ie=Ee.T,Ae={};Ee.T=Ae;try{var Xe=C(W,k),Nt=Ee.S;Nt!==null&&Nt(Ae,Xe),du(m,_,Xe)}catch(on){af(m,_,on)}finally{Ee.T=ie}}else try{ie=C(W,k),du(m,_,ie)}catch(on){af(m,_,on)}}function du(m,_,C){C!==null&&typeof C=="object"&&typeof C.then=="function"?C.then(function(k){hs(m,_,k)},function(k){return af(m,_,k)}):hs(m,_,C)}function hs(m,_,C){_.status="fulfilled",_.value=C,Lm(_),m.state=C,_=m.pending,_!==null&&(C=_.next,C===_?m.pending=null:(C=C.next,_.next=C,Uv(m,C)))}function af(m,_,C){var k=m.pending;if(m.pending=null,k!==null){k=k.next;do _.status="rejected",_.reason=C,Lm(_),_=_.next;while(_!==k)}m.action=null}function Lm(m){m=m.listeners;for(var _=0;_<m.length;_++)(0,m[_])()}function mp(m,_){return _}function Vv(m,_){if(oa){var C=Yt.formState;if(C!==null){e:{var k=Ts;if(oa){if(Ma){t:{for(var W=Ma,ie=ou;W.nodeType!==8;){if(!ie){W=null;break t}if(W=kd(W.nextSibling),W===null){W=null;break t}}ie=W.data,W=ie==="F!"||ie==="F"?W:null}if(W){Ma=kd(W.nextSibling),k=W.data==="F!";break e}}Lu(k)}k=!1}k&&(_=C[0])}}return C=Aa(),C.memoizedState=C.baseState=_,k={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mp,lastRenderedState:_},C.queue=k,C=xp.bind(null,Ts,k),k.dispatch=C,k=Im(!1),ie=Ai.bind(null,Ts,!1,k.queue),k=Aa(),W={state:_,dispatch:null,action:m,pending:null},k.queue=W,C=Bv.bind(null,Ts,W,ie,C),W.dispatch=C,k.memoizedState=m,[_,C,!1]}function $v(m){var _=sr();return Ad(_,qs,m)}function Ad(m,_,C){if(_=pp(m,_,mp)[0],m=km($c)[0],typeof _=="object"&&_!==null&&typeof _.then=="function")try{var k=Dm(_)}catch(Ae){throw Ae===lp?Jg:Ae}else k=_;_=sr();var W=_.queue,ie=W.dispatch;return C!==_.memoizedState&&(Ts.flags|=2048,fn(9,Ln(),of.bind(null,W,C),null)),[k,ie,m]}function of(m,_){m.action=_}function qc(m){var _=sr(),C=qs;if(C!==null)return Ad(_,C,m);sr(),_=_.memoizedState,C=sr();var k=C.queue.dispatch;return C.memoizedState=m,[_,k,!1]}function fn(m,_,C,k){return m={tag:m,create:C,deps:k,inst:_,next:null},_=Ts.updateQueue,_===null&&(_=Om(),Ts.updateQueue=_),C=_.lastEffect,C===null?_.lastEffect=m.next=m:(k=C.next,C.next=m,m.next=k,_.lastEffect=m),m}function Ln(){return{destroy:void 0,resource:void 0}}function lf(){return sr().memoizedState}function ra(m,_,C,k){var W=Aa();k=k===void 0?null:k,Ts.flags|=m,W.memoizedState=fn(1|_,Ln(),C,k)}function yt(m,_,C,k){var W=sr();k=k===void 0?null:k;var ie=W.memoizedState.inst;qs!==null&&k!==null&&ry(k,qs.memoizedState.deps)?W.memoizedState=fn(_,ie,C,k):(Ts.flags|=m,W.memoizedState=fn(1|_,ie,C,k))}function qv(m,_){ra(8390656,8,m,_)}function gp(m,_){yt(2048,8,m,_)}function yp(m,_){return yt(4,2,m,_)}function cf(m,_){return yt(4,4,m,_)}function oy(m,_){if(typeof _=="function"){m=m();var C=_(m);return function(){typeof C=="function"?C():_(null)}}if(_!=null)return m=m(),_.current=m,function(){_.current=null}}function zm(m,_,C){C=C!=null?C.concat([m]):null,yt(4,4,oy.bind(null,_,m),C)}function xh(){}function hu(m,_){var C=sr();_=_===void 0?null:_;var k=C.memoizedState;return _!==null&&ry(_,k[1])?k[0]:(C.memoizedState=[m,_],m)}function b_(m,_){var C=sr();_=_===void 0?null:_;var k=C.memoizedState;if(_!==null&&ry(_,k[1]))return k[0];if(k=m(),Hu){lr(!0);try{m()}finally{lr(!1)}}return C.memoizedState=[k,_],k}function Fm(m,_,C){return C===void 0||(wd&1073741824)!==0?m.memoizedState=_:(m.memoizedState=C,m=ll(),Ts.lanes|=m,Zr|=m,C)}function Bm(m,_,C,k){return _c(C,_)?C:_d.current!==null?(m=Fm(m,C,k),_c(m,_)||(fo=!0),m):(wd&42)===0?(fo=!0,m.memoizedState=C):(m=ll(),Ts.lanes|=m,Zr|=m,_)}function ly(m,_,C,k,W){var ie=it.p;it.p=ie!==0&&8>ie?ie:8;var Ae=Ee.T,Xe={};Ee.T=Xe,Ai(m,!1,_,C);try{var Nt=W(),on=Ee.S;if(on!==null&&on(Xe,Nt),Nt!==null&&typeof Nt=="object"&&typeof Nt.then=="function"){var zn=Kg(Nt,k);As(m,_,zn,so(m))}else As(m,_,k,so(m))}catch(Yn){As(m,_,{then:function(){},status:"rejected",reason:Yn},so())}finally{it.p=ie,Ee.T=Ae}}function w_(){}function cy(m,_,C,k){if(m.tag!==5)throw Error(r(476));var W=Um(m).queue;ly(m,W,_,et,C===null?w_:function(){return vp(m),C(k)})}function Um(m){var _=m.memoizedState;if(_!==null)return _;_={memoizedState:et,baseState:et,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$c,lastRenderedState:et},next:null};var C={};return _.next={memoizedState:C,baseState:C,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$c,lastRenderedState:C},next:null},m.memoizedState=_,m=m.alternate,m!==null&&(m.memoizedState=_),_}function vp(m){var _=Um(m).next.queue;As(m,_,{},so())}function _h(){return Jo(sg)}function Hv(){return sr().memoizedState}function S_(){return sr().memoizedState}function al(m){for(var _=m.return;_!==null;){switch(_.tag){case 24:case 3:var C=so();m=lu(C);var k=Fl(_,m,C);k!==null&&(za(k,_,C),nf(k,_,C)),_={cache:Tm()},m.payload=_;return}_=_.return}}function tw(m,_,C){var k=so();C={lane:k,revertLane:0,action:C,hasEagerState:!1,eagerState:null,next:null},_p(m)?bl(_,C):(C=tc(m,_,C,k),C!==null&&(za(C,m,k),uf(C,_,k)))}function xp(m,_,C){var k=so();As(m,_,C,k)}function As(m,_,C,k){var W={lane:k,revertLane:0,action:C,hasEagerState:!1,eagerState:null,next:null};if(_p(m))bl(_,W);else{var ie=m.alternate;if(m.lanes===0&&(ie===null||ie.lanes===0)&&(ie=_.lastRenderedReducer,ie!==null))try{var Ae=_.lastRenderedState,Xe=ie(Ae,C);if(W.hasEagerState=!0,W.eagerState=Xe,_c(Xe,Ae))return Iu(m,_,W,0),Yt===null&&oh(),!1}catch{}finally{}if(C=tc(m,_,W,k),C!==null)return za(C,m,k),uf(C,_,k),!0}return!1}function Ai(m,_,C,k){if(k={lane:2,revertLane:cw(),action:k,hasEagerState:!1,eagerState:null,next:null},_p(m)){if(_)throw Error(r(479))}else _=tc(m,C,k,2),_!==null&&za(_,m,2)}function _p(m){var _=m.alternate;return m===Ts||_!==null&&_===Ts}function bl(m,_){Uc=up=!0;var C=m.pending;C===null?_.next=_:(_.next=C.next,C.next=_),m.pending=_}function uf(m,_,C){if((C&4194048)!==0){var k=_.lanes;k&=m.pendingLanes,C|=k,_.lanes=C,Rt(m,C)}}var jd={readContext:Jo,use:iy,useCallback:io,useContext:io,useEffect:io,useImperativeHandle:io,useLayoutEffect:io,useInsertionEffect:io,useMemo:io,useReducer:io,useRef:io,useState:io,useDebugValue:io,useDeferredValue:io,useTransition:io,useSyncExternalStore:io,useId:io,useHostTransitionStatus:io,useFormState:io,useActionState:io,useOptimistic:io,useMemoCache:io,useCacheRefresh:io},bh={readContext:Jo,use:iy,useCallback:function(m,_){return Aa().memoizedState=[m,_===void 0?null:_],m},useContext:Jo,useEffect:qv,useImperativeHandle:function(m,_,C){C=C!=null?C.concat([m]):null,ra(4194308,4,oy.bind(null,_,m),C)},useLayoutEffect:function(m,_){return ra(4194308,4,m,_)},useInsertionEffect:function(m,_){ra(4,2,m,_)},useMemo:function(m,_){var C=Aa();_=_===void 0?null:_;var k=m();if(Hu){lr(!0);try{m()}finally{lr(!1)}}return C.memoizedState=[k,_],k},useReducer:function(m,_,C){var k=Aa();if(C!==void 0){var W=C(_);if(Hu){lr(!0);try{C(_)}finally{lr(!1)}}}else W=_;return k.memoizedState=k.baseState=W,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:W},k.queue=m,m=m.dispatch=tw.bind(null,Ts,m),[k.memoizedState,m]},useRef:function(m){var _=Aa();return m={current:m},_.memoizedState=m},useState:function(m){m=Im(m);var _=m.queue,C=xp.bind(null,Ts,_);return _.dispatch=C,[m.memoizedState,C]},useDebugValue:xh,useDeferredValue:function(m,_){var C=Aa();return Fm(C,m,_)},useTransition:function(){var m=Im(!1);return m=ly.bind(null,Ts,m.queue,!0,!1),Aa().memoizedState=m,[!1,m]},useSyncExternalStore:function(m,_,C){var k=Ts,W=Aa();if(oa){if(C===void 0)throw Error(r(407));C=C()}else{if(C=_(),Yt===null)throw Error(r(349));(en&124)!==0||Bl(k,_,C)}W.memoizedState=C;var ie={value:C,getSnapshot:_};return W.queue=ie,qv(sl.bind(null,k,ie,m),[m]),k.flags|=2048,fn(9,Ln(),sy.bind(null,k,ie,C,_),null),C},useId:function(){var m=Aa(),_=Yt.identifierPrefix;if(oa){var C=Fc,k=au;C=(k&~(1<<32-ze(k)-1)).toString(32)+C,_="«"+_+"R"+C,C=cu++,0<C&&(_+="H"+C.toString(32)),_+="»"}else C=Mm++,_="«"+_+"r"+C.toString(32)+"»";return m.memoizedState=_},useHostTransitionStatus:_h,useFormState:Vv,useActionState:Vv,useOptimistic:function(m){var _=Aa();_.memoizedState=_.baseState=m;var C={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return _.queue=C,_=Ai.bind(null,Ts,!0,C),C.dispatch=_,[m,_]},useMemoCache:fp,useCacheRefresh:function(){return Aa().memoizedState=al.bind(null,Ts)}},uy={readContext:Jo,use:iy,useCallback:hu,useContext:Jo,useEffect:gp,useImperativeHandle:zm,useInsertionEffect:yp,useLayoutEffect:cf,useMemo:b_,useReducer:km,useRef:lf,useState:function(){return km($c)},useDebugValue:xh,useDeferredValue:function(m,_){var C=sr();return Bm(C,qs.memoizedState,m,_)},useTransition:function(){var m=km($c)[0],_=sr().memoizedState;return[typeof m=="boolean"?m:Dm(m),_]},useSyncExternalStore:__,useId:Hv,useHostTransitionStatus:_h,useFormState:$v,useActionState:$v,useOptimistic:function(m,_){var C=sr();return ay(C,qs,m,_)},useMemoCache:fp,useCacheRefresh:S_},Gv={readContext:Jo,use:iy,useCallback:hu,useContext:Jo,useEffect:gp,useImperativeHandle:zm,useInsertionEffect:yp,useLayoutEffect:cf,useMemo:b_,useReducer:zv,useRef:lf,useState:function(){return zv($c)},useDebugValue:xh,useDeferredValue:function(m,_){var C=sr();return qs===null?Fm(C,m,_):Bm(C,qs.memoizedState,m,_)},useTransition:function(){var m=zv($c)[0],_=sr().memoizedState;return[typeof m=="boolean"?m:Dm(m),_]},useSyncExternalStore:__,useId:Hv,useHostTransitionStatus:_h,useFormState:qc,useActionState:qc,useOptimistic:function(m,_){var C=sr();return qs!==null?ay(C,qs,m,_):(C.baseState=m,[m,C.queue.dispatch])},useMemoCache:fp,useCacheRefresh:S_},Ed=null,wh=0;function wl(m){var _=wh;return wh+=1,Ed===null&&(Ed=[]),Qg(Ed,m,_)}function Hc(m,_){_=_.props.ref,m.ref=_!==void 0?_:null}function Cd(m,_){throw _.$$typeof===N?Error(r(525)):(m=Object.prototype.toString.call(_),Error(r(31,m==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":m)))}function Vm(m){var _=m._init;return _(m._payload)}function $m(m){function _(Qt,Ut){if(m){var ln=Qt.deletions;ln===null?(Qt.deletions=[Ut],Qt.flags|=16):ln.push(Ut)}}function C(Qt,Ut){if(!m)return null;for(;Ut!==null;)_(Qt,Ut),Ut=Ut.sibling;return null}function k(Qt){for(var Ut=new Map;Qt!==null;)Qt.key!==null?Ut.set(Qt.key,Qt):Ut.set(Qt.index,Qt),Qt=Qt.sibling;return Ut}function W(Qt,Ut){return Qt=fd(Qt,Ut),Qt.index=0,Qt.sibling=null,Qt}function ie(Qt,Ut,ln){return Qt.index=ln,m?(ln=Qt.alternate,ln!==null?(ln=ln.index,ln<Ut?(Qt.flags|=67108866,Ut):ln):(Qt.flags|=67108866,Ut)):(Qt.flags|=1048576,Ut)}function Ae(Qt){return m&&Qt.alternate===null&&(Qt.flags|=67108866),Qt}function Xe(Qt,Ut,ln,Vn){return Ut===null||Ut.tag!==6?(Ut=Pv(ln,Qt.mode,Vn),Ut.return=Qt,Ut):(Ut=W(Ut,ln),Ut.return=Qt,Ut)}function Nt(Qt,Ut,ln,Vn){var ti=ln.type;return ti===$?zn(Qt,Ut,ln.props.children,Vn,ln.key):Ut!==null&&(Ut.elementType===ti||typeof ti=="object"&&ti!==null&&ti.$$typeof===ye&&Vm(ti)===Ut.type)?(Ut=W(Ut,ln.props),Hc(Ut,ln),Ut.return=Qt,Ut):(Ut=xm(ln.type,ln.key,ln.props,null,Qt.mode,Vn),Hc(Ut,ln),Ut.return=Qt,Ut)}function on(Qt,Ut,ln,Vn){return Ut===null||Ut.tag!==4||Ut.stateNode.containerInfo!==ln.containerInfo||Ut.stateNode.implementation!==ln.implementation?(Ut=Mv(ln,Qt.mode,Vn),Ut.return=Qt,Ut):(Ut=W(Ut,ln.children||[]),Ut.return=Qt,Ut)}function zn(Qt,Ut,ln,Vn,ti){return Ut===null||Ut.tag!==7?(Ut=Ss(ln,Qt.mode,Vn,ti),Ut.return=Qt,Ut):(Ut=W(Ut,ln),Ut.return=Qt,Ut)}function Yn(Qt,Ut,ln){if(typeof Ut=="string"&&Ut!==""||typeof Ut=="number"||typeof Ut=="bigint")return Ut=Pv(""+Ut,Qt.mode,ln),Ut.return=Qt,Ut;if(typeof Ut=="object"&&Ut!==null){switch(Ut.$$typeof){case D:return ln=xm(Ut.type,Ut.key,Ut.props,null,Qt.mode,ln),Hc(ln,Ut),ln.return=Qt,ln;case V:return Ut=Mv(Ut,Qt.mode,ln),Ut.return=Qt,Ut;case ye:var Vn=Ut._init;return Ut=Vn(Ut._payload),Yn(Qt,Ut,ln)}if(rt(Ut)||$e(Ut))return Ut=Ss(Ut,Qt.mode,ln,null),Ut.return=Qt,Ut;if(typeof Ut.then=="function")return Yn(Qt,wl(Ut),ln);if(Ut.$$typeof===X)return Yn(Qt,Uu(Qt,Ut),ln);Cd(Qt,Ut)}return null}function _n(Qt,Ut,ln,Vn){var ti=Ut!==null?Ut.key:null;if(typeof ln=="string"&&ln!==""||typeof ln=="number"||typeof ln=="bigint")return ti!==null?null:Xe(Qt,Ut,""+ln,Vn);if(typeof ln=="object"&&ln!==null){switch(ln.$$typeof){case D:return ln.key===ti?Nt(Qt,Ut,ln,Vn):null;case V:return ln.key===ti?on(Qt,Ut,ln,Vn):null;case ye:return ti=ln._init,ln=ti(ln._payload),_n(Qt,Ut,ln,Vn)}if(rt(ln)||$e(ln))return ti!==null?null:zn(Qt,Ut,ln,Vn,null);if(typeof ln.then=="function")return _n(Qt,Ut,wl(ln),Vn);if(ln.$$typeof===X)return _n(Qt,Ut,Uu(Qt,ln),Vn);Cd(Qt,ln)}return null}function Tn(Qt,Ut,ln,Vn,ti){if(typeof Vn=="string"&&Vn!==""||typeof Vn=="number"||typeof Vn=="bigint")return Qt=Qt.get(ln)||null,Xe(Ut,Qt,""+Vn,ti);if(typeof Vn=="object"&&Vn!==null){switch(Vn.$$typeof){case D:return Qt=Qt.get(Vn.key===null?ln:Vn.key)||null,Nt(Ut,Qt,Vn,ti);case V:return Qt=Qt.get(Vn.key===null?ln:Vn.key)||null,on(Ut,Qt,Vn,ti);case ye:var Os=Vn._init;return Vn=Os(Vn._payload),Tn(Qt,Ut,ln,Vn,ti)}if(rt(Vn)||$e(Vn))return Qt=Qt.get(ln)||null,zn(Ut,Qt,Vn,ti,null);if(typeof Vn.then=="function")return Tn(Qt,Ut,ln,wl(Vn),ti);if(Vn.$$typeof===X)return Tn(Qt,Ut,ln,Uu(Ut,Vn),ti);Cd(Ut,Vn)}return null}function is(Qt,Ut,ln,Vn){for(var ti=null,Os=null,wi=Ut,Yi=Ut=0,cl=null;wi!==null&&Yi<ln.length;Yi++){wi.index>Yi?(cl=wi,wi=null):cl=wi.sibling;var ya=_n(Qt,wi,ln[Yi],Vn);if(ya===null){wi===null&&(wi=cl);break}m&&wi&&ya.alternate===null&&_(Qt,wi),Ut=ie(ya,Ut,Yi),Os===null?ti=ya:Os.sibling=ya,Os=ya,wi=cl}if(Yi===ln.length)return C(Qt,wi),oa&&pd(Qt,Yi),ti;if(wi===null){for(;Yi<ln.length;Yi++)wi=Yn(Qt,ln[Yi],Vn),wi!==null&&(Ut=ie(wi,Ut,Yi),Os===null?ti=wi:Os.sibling=wi,Os=wi);return oa&&pd(Qt,Yi),ti}for(wi=k(wi);Yi<ln.length;Yi++)cl=Tn(wi,Qt,Yi,ln[Yi],Vn),cl!==null&&(m&&cl.alternate!==null&&wi.delete(cl.key===null?Yi:cl.key),Ut=ie(cl,Ut,Yi),Os===null?ti=cl:Os.sibling=cl,Os=cl);return m&&wi.forEach(function(zd){return _(Qt,zd)}),oa&&pd(Qt,Yi),ti}function Li(Qt,Ut,ln,Vn){if(ln==null)throw Error(r(151));for(var ti=null,Os=null,wi=Ut,Yi=Ut=0,cl=null,ya=ln.next();wi!==null&&!ya.done;Yi++,ya=ln.next()){wi.index>Yi?(cl=wi,wi=null):cl=wi.sibling;var zd=_n(Qt,wi,ya.value,Vn);if(zd===null){wi===null&&(wi=cl);break}m&&wi&&zd.alternate===null&&_(Qt,wi),Ut=ie(zd,Ut,Yi),Os===null?ti=zd:Os.sibling=zd,Os=zd,wi=cl}if(ya.done)return C(Qt,wi),oa&&pd(Qt,Yi),ti;if(wi===null){for(;!ya.done;Yi++,ya=ln.next())ya=Yn(Qt,ya.value,Vn),ya!==null&&(Ut=ie(ya,Ut,Yi),Os===null?ti=ya:Os.sibling=ya,Os=ya);return oa&&pd(Qt,Yi),ti}for(wi=k(wi);!ya.done;Yi++,ya=ln.next())ya=Tn(wi,Qt,Yi,ya.value,Vn),ya!==null&&(m&&ya.alternate!==null&&wi.delete(ya.key===null?Yi:ya.key),Ut=ie(ya,Ut,Yi),Os===null?ti=ya:Os.sibling=ya,Os=ya);return m&&wi.forEach(function(gN){return _(Qt,gN)}),oa&&pd(Qt,Yi),ti}function ja(Qt,Ut,ln,Vn){if(typeof ln=="object"&&ln!==null&&ln.type===$&&ln.key===null&&(ln=ln.props.children),typeof ln=="object"&&ln!==null){switch(ln.$$typeof){case D:e:{for(var ti=ln.key;Ut!==null;){if(Ut.key===ti){if(ti=ln.type,ti===$){if(Ut.tag===7){C(Qt,Ut.sibling),Vn=W(Ut,ln.props.children),Vn.return=Qt,Qt=Vn;break e}}else if(Ut.elementType===ti||typeof ti=="object"&&ti!==null&&ti.$$typeof===ye&&Vm(ti)===Ut.type){C(Qt,Ut.sibling),Vn=W(Ut,ln.props),Hc(Vn,ln),Vn.return=Qt,Qt=Vn;break e}C(Qt,Ut);break}else _(Qt,Ut);Ut=Ut.sibling}ln.type===$?(Vn=Ss(ln.props.children,Qt.mode,Vn,ln.key),Vn.return=Qt,Qt=Vn):(Vn=xm(ln.type,ln.key,ln.props,null,Qt.mode,Vn),Hc(Vn,ln),Vn.return=Qt,Qt=Vn)}return Ae(Qt);case V:e:{for(ti=ln.key;Ut!==null;){if(Ut.key===ti)if(Ut.tag===4&&Ut.stateNode.containerInfo===ln.containerInfo&&Ut.stateNode.implementation===ln.implementation){C(Qt,Ut.sibling),Vn=W(Ut,ln.children||[]),Vn.return=Qt,Qt=Vn;break e}else{C(Qt,Ut);break}else _(Qt,Ut);Ut=Ut.sibling}Vn=Mv(ln,Qt.mode,Vn),Vn.return=Qt,Qt=Vn}return Ae(Qt);case ye:return ti=ln._init,ln=ti(ln._payload),ja(Qt,Ut,ln,Vn)}if(rt(ln))return is(Qt,Ut,ln,Vn);if($e(ln)){if(ti=$e(ln),typeof ti!="function")throw Error(r(150));return ln=ti.call(ln),Li(Qt,Ut,ln,Vn)}if(typeof ln.then=="function")return ja(Qt,Ut,wl(ln),Vn);if(ln.$$typeof===X)return ja(Qt,Ut,Uu(Qt,ln),Vn);Cd(Qt,ln)}return typeof ln=="string"&&ln!==""||typeof ln=="number"||typeof ln=="bigint"?(ln=""+ln,Ut!==null&&Ut.tag===6?(C(Qt,Ut.sibling),Vn=W(Ut,ln),Vn.return=Qt,Qt=Vn):(C(Qt,Ut),Vn=Pv(ln,Qt.mode,Vn),Vn.return=Qt,Qt=Vn),Ae(Qt)):C(Qt,Ut)}return function(Qt,Ut,ln,Vn){try{wh=0;var ti=ja(Qt,Ut,ln,Vn);return Ed=null,ti}catch(wi){if(wi===lp||wi===Jg)throw wi;var Os=wc(29,wi,null,Qt.mode);return Os.lanes=Vn,Os.return=Qt,Os}finally{}}}var fu=$m(!0),Nd=$m(!1),nc=pt(null),Vo=null;function Gu(m){var _=m.alternate;Je(ki,ki.current&1),Je(nc,m),Vo===null&&(_===null||_d.current!==null||_.memoizedState!==null)&&(Vo=m)}function qm(m){if(m.tag===22){if(Je(ki,ki.current),Je(nc,m),Vo===null){var _=m.alternate;_!==null&&_.memoizedState!==null&&(Vo=m)}}else Sc()}function Sc(){Je(ki,ki.current),Je(nc,nc.current)}function rc(m){We(nc),Vo===m&&(Vo=null),We(ki)}var ki=pt(0);function Pd(m){for(var _=m;_!==null;){if(_.tag===13){var C=_.memoizedState;if(C!==null&&(C=C.dehydrated,C===null||C.data==="$?"||cx(C)))return _}else if(_.tag===19&&_.memoizedProps.revealOrder!==void 0){if((_.flags&128)!==0)return _}else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===m)break;for(;_.sibling===null;){if(_.return===null||_.return===m)return null;_=_.return}_.sibling.return=_.return,_=_.sibling}return null}function Hm(m,_,C,k){_=m.memoizedState,C=C(k,_),C=C==null?_:E({},_,C),m.memoizedState=C,m.lanes===0&&(m.updateQueue.baseState=C)}var Gm={enqueueSetState:function(m,_,C){m=m._reactInternals;var k=so(),W=lu(k);W.payload=_,C!=null&&(W.callback=C),_=Fl(m,W,k),_!==null&&(za(_,m,k),nf(_,m,k))},enqueueReplaceState:function(m,_,C){m=m._reactInternals;var k=so(),W=lu(k);W.tag=1,W.payload=_,C!=null&&(W.callback=C),_=Fl(m,W,k),_!==null&&(za(_,m,k),nf(_,m,k))},enqueueForceUpdate:function(m,_){m=m._reactInternals;var C=so(),k=lu(C);k.tag=2,_!=null&&(k.callback=_),_=Fl(m,k,C),_!==null&&(za(_,m,C),nf(_,m,C))}};function Sh(m,_,C,k,W,ie,Ae){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(k,ie,Ae):_.prototype&&_.prototype.isPureReactComponent?!Ic(C,k)||!Ic(W,ie):!0}function dy(m,_,C,k){m=_.state,typeof _.componentWillReceiveProps=="function"&&_.componentWillReceiveProps(C,k),typeof _.UNSAFE_componentWillReceiveProps=="function"&&_.UNSAFE_componentWillReceiveProps(C,k),_.state!==m&&Gm.enqueueReplaceState(_,_.state,null)}function pu(m,_){var C=_;if("ref"in _){C={};for(var k in _)k!=="ref"&&(C[k]=_[k])}if(m=m.defaultProps){C===_&&(C=E({},C));for(var W in m)C[W]===void 0&&(C[W]=m[W])}return C}var bp=typeof reportError=="function"?reportError:function(m){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var _=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof m=="object"&&m!==null&&typeof m.message=="string"?String(m.message):String(m),error:m});if(!window.dispatchEvent(_))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",m);return}console.error(m)};function Md(m){bp(m)}function hy(m){console.error(m)}function fy(m){bp(m)}function df(m,_){try{var C=m.onUncaughtError;C(_.value,{componentStack:_.stack})}catch(k){setTimeout(function(){throw k})}}function hf(m,_,C){try{var k=m.onCaughtError;k(C.value,{componentStack:C.stack,errorBoundary:_.tag===1?_.stateNode:null})}catch(W){setTimeout(function(){throw W})}}function Wm(m,_,C){return C=lu(C),C.tag=3,C.payload={element:null},C.callback=function(){df(m,_)},C}function Xm(m){return m=lu(m),m.tag=3,m}function py(m,_,C,k){var W=C.type.getDerivedStateFromError;if(typeof W=="function"){var ie=k.value;m.payload=function(){return W(ie)},m.callback=function(){hf(_,C,k)}}var Ae=C.stateNode;Ae!==null&&typeof Ae.componentDidCatch=="function"&&(m.callback=function(){hf(_,C,k),typeof W!="function"&&(Xi===null?Xi=new Set([this]):Xi.add(this));var Xe=k.stack;this.componentDidCatch(k.value,{componentStack:Xe!==null?Xe:""})})}function T_(m,_,C,k,W){if(C.flags|=32768,k!==null&&typeof k=="object"&&typeof k.then=="function"){if(_=C.alternate,_!==null&&Kh(_,C,W,!0),C=nc.current,C!==null){switch(C.tag){case 13:return Vo===null?Vl():C.alternate===null&&Tr===0&&(Tr=3),C.flags&=-257,C.flags|=65536,C.lanes=W,k===kv?C.flags|=16384:(_=C.updateQueue,_===null?C.updateQueue=new Set([k]):_.add(k),Xu(m,k,W)),!1;case 22:return C.flags|=65536,k===kv?C.flags|=16384:(_=C.updateQueue,_===null?(_={transitions:null,markerInstances:null,retryQueue:new Set([k])},C.updateQueue=_):(C=_.retryQueue,C===null?_.retryQueue=new Set([k]):C.add(k)),Xu(m,k,W)),!1}throw Error(r(435,C.tag))}return Xu(m,k,W),Vl(),!1}if(oa)return _=nc.current,_!==null?((_.flags&65536)===0&&(_.flags|=256),_.flags|=65536,_.lanes=W,k!==hh&&(m=Error(r(422),{cause:k}),ip(mn(m,C)))):(k!==hh&&(_=Error(r(423),{cause:k}),ip(mn(_,C))),m=m.current.alternate,m.flags|=65536,W&=-W,m.lanes|=W,k=mn(k,C),W=Wm(m.stateNode,k,W),$u(m,W),Tr!==4&&(Tr=2)),!1;var ie=Error(r(520),{cause:k});if(ie=mn(ie,C),os===null?os=[ie]:os.push(ie),Tr!==4&&(Tr=2),_===null)return!0;k=mn(k,C),C=_;do{switch(C.tag){case 3:return C.flags|=65536,m=W&-W,C.lanes|=m,m=Wm(C.stateNode,k,m),$u(C,m),!1;case 1:if(_=C.type,ie=C.stateNode,(C.flags&128)===0&&(typeof _.getDerivedStateFromError=="function"||ie!==null&&typeof ie.componentDidCatch=="function"&&(Xi===null||!Xi.has(ie))))return C.flags|=65536,W&=-W,C.lanes|=W,W=Xm(W),py(W,m,C,k),$u(C,W),!1}C=C.return}while(C!==null);return!1}var Zm=Error(r(461)),fo=!1;function $o(m,_,C,k){_.child=m===null?Nd(_,null,C,k):fu(_,m.child,C,k)}function Wv(m,_,C,k,W){C=C.render;var ie=_.ref;if("ref"in k){var Ae={};for(var Xe in k)Xe!=="ref"&&(Ae[Xe]=k[Xe])}else Ae=k;return Bu(_),k=Rm(m,_,C,Ae,ie,W),Xe=hp(),m!==null&&!fo?(sf(m,_,W),Ro(m,_,W)):(oa&&Xe&&dh(_),_.flags|=1,$o(m,_,k,W),_.child)}function my(m,_,C,k,W){if(m===null){var ie=C.type;return typeof ie=="function"&&!vm(ie)&&ie.defaultProps===void 0&&C.compare===null?(_.tag=15,_.type=ie,Xv(m,_,ie,k,W)):(m=xm(C.type,null,k,_,_.mode,W),m.ref=_.ref,m.return=_,_.child=m)}if(ie=m.child,!Sp(m,W)){var Ae=ie.memoizedProps;if(C=C.compare,C=C!==null?C:Ic,C(Ae,k)&&m.ref===_.ref)return Ro(m,_,W)}return _.flags|=1,m=fd(ie,k),m.ref=_.ref,m.return=_,_.child=m}function Xv(m,_,C,k,W){if(m!==null){var ie=m.memoizedProps;if(Ic(ie,k)&&m.ref===_.ref)if(fo=!1,_.pendingProps=k=ie,Sp(m,W))(m.flags&131072)!==0&&(fo=!0);else return _.lanes=m.lanes,Ro(m,_,W)}return gy(m,_,C,k,W)}function Ym(m,_,C){var k=_.pendingProps,W=k.children,ie=m!==null?m.memoizedState:null;if(k.mode==="hidden"){if((_.flags&128)!==0){if(k=ie!==null?ie.baseLanes|C:C,m!==null){for(W=_.child=m.child,ie=0;W!==null;)ie=ie|W.lanes|W.childLanes,W=W.sibling;_.childLanes=ie&~k}else _.childLanes=0,_.child=null;return Zv(m,_,k,C)}if((C&536870912)!==0)_.memoizedState={baseLanes:0,cachePool:null},m!==null&&Em(_,ie!==null?ie.cachePool:null),ie!==null?ny(_,ie):bd(),qm(_);else return _.lanes=_.childLanes=536870912,Zv(m,_,ie!==null?ie.baseLanes|C:C,C)}else ie!==null?(Em(_,ie.cachePool),ny(_,ie),Sc(),_.memoizedState=null):(m!==null&&Em(_,null),bd(),Sc());return $o(m,_,W,C),_.child}function Zv(m,_,C,k){var W=jm();return W=W===null?null:{parent:na._currentValue,pool:W},_.memoizedState={baseLanes:C,cachePool:W},m!==null&&Em(_,null),bd(),qm(_),m!==null&&Kh(m,_,k,!0),null}function Km(m,_){var C=_.ref;if(C===null)m!==null&&m.ref!==null&&(_.flags|=4194816);else{if(typeof C!="function"&&typeof C!="object")throw Error(r(284));(m===null||m.ref!==C)&&(_.flags|=4194816)}}function gy(m,_,C,k,W){return Bu(_),C=Rm(m,_,C,k,void 0,W),k=hp(),m!==null&&!fo?(sf(m,_,W),Ro(m,_,W)):(oa&&k&&dh(_),_.flags|=1,$o(m,_,C,W),_.child)}function Yv(m,_,C,k,W,ie){return Bu(_),_.updateQueue=null,C=dp(_,k,C,W),Sd(m),k=hp(),m!==null&&!fo?(sf(m,_,ie),Ro(m,_,ie)):(oa&&k&&dh(_),_.flags|=1,$o(m,_,C,ie),_.child)}function Kv(m,_,C,k,W){if(Bu(_),_.stateNode===null){var ie=_l,Ae=C.contextType;typeof Ae=="object"&&Ae!==null&&(ie=Jo(Ae)),ie=new C(k,ie),_.memoizedState=ie.state!==null&&ie.state!==void 0?ie.state:null,ie.updater=Gm,_.stateNode=ie,ie._reactInternals=_,ie=_.stateNode,ie.props=k,ie.state=_.memoizedState,ie.refs={},ey(_),Ae=C.contextType,ie.context=typeof Ae=="object"&&Ae!==null?Jo(Ae):_l,ie.state=_.memoizedState,Ae=C.getDerivedStateFromProps,typeof Ae=="function"&&(Hm(_,C,Ae,k),ie.state=_.memoizedState),typeof C.getDerivedStateFromProps=="function"||typeof ie.getSnapshotBeforeUpdate=="function"||typeof ie.UNSAFE_componentWillMount!="function"&&typeof ie.componentWillMount!="function"||(Ae=ie.state,typeof ie.componentWillMount=="function"&&ie.componentWillMount(),typeof ie.UNSAFE_componentWillMount=="function"&&ie.UNSAFE_componentWillMount(),Ae!==ie.state&&Gm.enqueueReplaceState(ie,ie.state,null),cp(_,k,ie,W),vh(),ie.state=_.memoizedState),typeof ie.componentDidMount=="function"&&(_.flags|=4194308),k=!0}else if(m===null){ie=_.stateNode;var Xe=_.memoizedProps,Nt=pu(C,Xe);ie.props=Nt;var on=ie.context,zn=C.contextType;Ae=_l,typeof zn=="object"&&zn!==null&&(Ae=Jo(zn));var Yn=C.getDerivedStateFromProps;zn=typeof Yn=="function"||typeof ie.getSnapshotBeforeUpdate=="function",Xe=_.pendingProps!==Xe,zn||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(Xe||on!==Ae)&&dy(_,ie,k,Ae),Vu=!1;var _n=_.memoizedState;ie.state=_n,cp(_,k,ie,W),vh(),on=_.memoizedState,Xe||_n!==on||Vu?(typeof Yn=="function"&&(Hm(_,C,Yn,k),on=_.memoizedState),(Nt=Vu||Sh(_,C,Nt,k,_n,on,Ae))?(zn||typeof ie.UNSAFE_componentWillMount!="function"&&typeof ie.componentWillMount!="function"||(typeof ie.componentWillMount=="function"&&ie.componentWillMount(),typeof ie.UNSAFE_componentWillMount=="function"&&ie.UNSAFE_componentWillMount()),typeof ie.componentDidMount=="function"&&(_.flags|=4194308)):(typeof ie.componentDidMount=="function"&&(_.flags|=4194308),_.memoizedProps=k,_.memoizedState=on),ie.props=k,ie.state=on,ie.context=Ae,k=Nt):(typeof ie.componentDidMount=="function"&&(_.flags|=4194308),k=!1)}else{ie=_.stateNode,ty(m,_),Ae=_.memoizedProps,zn=pu(C,Ae),ie.props=zn,Yn=_.pendingProps,_n=ie.context,on=C.contextType,Nt=_l,typeof on=="object"&&on!==null&&(Nt=Jo(on)),Xe=C.getDerivedStateFromProps,(on=typeof Xe=="function"||typeof ie.getSnapshotBeforeUpdate=="function")||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(Ae!==Yn||_n!==Nt)&&dy(_,ie,k,Nt),Vu=!1,_n=_.memoizedState,ie.state=_n,cp(_,k,ie,W),vh();var Tn=_.memoizedState;Ae!==Yn||_n!==Tn||Vu||m!==null&&m.dependencies!==null&&sp(m.dependencies)?(typeof Xe=="function"&&(Hm(_,C,Xe,k),Tn=_.memoizedState),(zn=Vu||Sh(_,C,zn,k,_n,Tn,Nt)||m!==null&&m.dependencies!==null&&sp(m.dependencies))?(on||typeof ie.UNSAFE_componentWillUpdate!="function"&&typeof ie.componentWillUpdate!="function"||(typeof ie.componentWillUpdate=="function"&&ie.componentWillUpdate(k,Tn,Nt),typeof ie.UNSAFE_componentWillUpdate=="function"&&ie.UNSAFE_componentWillUpdate(k,Tn,Nt)),typeof ie.componentDidUpdate=="function"&&(_.flags|=4),typeof ie.getSnapshotBeforeUpdate=="function"&&(_.flags|=1024)):(typeof ie.componentDidUpdate!="function"||Ae===m.memoizedProps&&_n===m.memoizedState||(_.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||Ae===m.memoizedProps&&_n===m.memoizedState||(_.flags|=1024),_.memoizedProps=k,_.memoizedState=Tn),ie.props=k,ie.state=Tn,ie.context=Nt,k=zn):(typeof ie.componentDidUpdate!="function"||Ae===m.memoizedProps&&_n===m.memoizedState||(_.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||Ae===m.memoizedProps&&_n===m.memoizedState||(_.flags|=1024),k=!1)}return ie=k,Km(m,_),k=(_.flags&128)!==0,ie||k?(ie=_.stateNode,C=k&&typeof C.getDerivedStateFromError!="function"?null:ie.render(),_.flags|=1,m!==null&&k?(_.child=fu(_,m.child,null,W),_.child=fu(_,null,C,W)):$o(m,_,C,W),_.memoizedState=ie.state,m=_.child):m=Ro(m,_,W),m}function A_(m,_,C,k){return gd(),_.flags|=256,$o(m,_,C,k),_.child}var Jv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Hs(m){return{baseLanes:m,cachePool:Jh()}}function yy(m,_,C){return m=m!==null?m.childLanes&~C:0,_&&(m|=mi),m}function j_(m,_,C){var k=_.pendingProps,W=!1,ie=(_.flags&128)!==0,Ae;if((Ae=ie)||(Ae=m!==null&&m.memoizedState===null?!1:(ki.current&2)!==0),Ae&&(W=!0,_.flags&=-129),Ae=(_.flags&32)!==0,_.flags&=-33,m===null){if(oa){if(W?Gu(_):Sc(),oa){var Xe=Ma,Nt;if(Nt=Xe){e:{for(Nt=Xe,Xe=ou;Nt.nodeType!==8;){if(!Xe){Xe=null;break e}if(Nt=kd(Nt.nextSibling),Nt===null){Xe=null;break e}}Xe=Nt}Xe!==null?(_.memoizedState={dehydrated:Xe,treeContext:ch!==null?{id:au,overflow:Fc}:null,retryLane:536870912,hydrationErrors:null},Nt=wc(18,null,null,0),Nt.stateNode=Xe,Nt.return=_,_.child=Nt,Ko=_,Ma=null,Nt=!0):Nt=!1}Nt||Lu(_)}if(Xe=_.memoizedState,Xe!==null&&(Xe=Xe.dehydrated,Xe!==null))return cx(Xe)?_.lanes=32:_.lanes=536870912,null;rc(_)}return Xe=k.children,k=k.fallback,W?(Sc(),W=_.mode,Xe=vy({mode:"hidden",children:Xe},W),k=Ss(k,W,C,null),Xe.return=_,k.return=_,Xe.sibling=k,_.child=Xe,W=_.child,W.memoizedState=Hs(C),W.childLanes=yy(m,Ae,C),_.memoizedState=Jv,k):(Gu(_),Jm(_,Xe))}if(Nt=m.memoizedState,Nt!==null&&(Xe=Nt.dehydrated,Xe!==null)){if(ie)_.flags&256?(Gu(_),_.flags&=-257,_=ff(m,_,C)):_.memoizedState!==null?(Sc(),_.child=m.child,_.flags|=128,_=null):(Sc(),W=k.fallback,Xe=_.mode,k=vy({mode:"visible",children:k.children},Xe),W=Ss(W,Xe,C,null),W.flags|=2,k.return=_,W.return=_,k.sibling=W,_.child=k,fu(_,m.child,null,C),k=_.child,k.memoizedState=Hs(C),k.childLanes=yy(m,Ae,C),_.memoizedState=Jv,_=W);else if(Gu(_),cx(Xe)){if(Ae=Xe.nextSibling&&Xe.nextSibling.dataset,Ae)var on=Ae.dgst;Ae=on,k=Error(r(419)),k.stack="",k.digest=Ae,ip({value:k,source:null,stack:null}),_=ff(m,_,C)}else if(fo||Kh(m,_,C,!1),Ae=(C&m.childLanes)!==0,fo||Ae){if(Ae=Yt,Ae!==null&&(k=C&-C,k=(k&42)!==0?1:Jr(k),k=(k&(Ae.suspendedLanes|C))!==0?0:k,k!==0&&k!==Nt.retryLane))throw Nt.retryLane=k,dd(m,k),za(Ae,m,k),Zm;Xe.data==="$?"||Vl(),_=ff(m,_,C)}else Xe.data==="$?"?(_.flags|=192,_.child=m.child,_=null):(m=Nt.treeContext,Ma=kd(Xe.nextSibling),Ko=_,oa=!0,md=null,ou=!1,m!==null&&(zl[zc++]=au,zl[zc++]=Fc,zl[zc++]=ch,au=m.id,Fc=m.overflow,ch=_),_=Jm(_,k.children),_.flags|=4096);return _}return W?(Sc(),W=k.fallback,Xe=_.mode,Nt=m.child,on=Nt.sibling,k=fd(Nt,{mode:"hidden",children:k.children}),k.subtreeFlags=Nt.subtreeFlags&65011712,on!==null?W=fd(on,W):(W=Ss(W,Xe,C,null),W.flags|=2),W.return=_,k.return=_,k.sibling=W,_.child=k,k=W,W=_.child,Xe=m.child.memoizedState,Xe===null?Xe=Hs(C):(Nt=Xe.cachePool,Nt!==null?(on=na._currentValue,Nt=Nt.parent!==on?{parent:on,pool:on}:Nt):Nt=Jh(),Xe={baseLanes:Xe.baseLanes|C,cachePool:Nt}),W.memoizedState=Xe,W.childLanes=yy(m,Ae,C),_.memoizedState=Jv,k):(Gu(_),C=m.child,m=C.sibling,C=fd(C,{mode:"visible",children:k.children}),C.return=_,C.sibling=null,m!==null&&(Ae=_.deletions,Ae===null?(_.deletions=[m],_.flags|=16):Ae.push(m)),_.child=C,_.memoizedState=null,C)}function Jm(m,_){return _=vy({mode:"visible",children:_},m.mode),_.return=m,m.child=_}function vy(m,_){return m=wc(22,m,null,_),m.lanes=0,m.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},m}function ff(m,_,C){return fu(_,m.child,null,C),m=Jm(_,_.pendingProps.children),m.flags|=2,_.memoizedState=null,m}function wp(m,_,C){m.lanes|=_;var k=m.alternate;k!==null&&(k.lanes|=_),Xg(m.return,_,C)}function Qm(m,_,C,k,W){var ie=m.memoizedState;ie===null?m.memoizedState={isBackwards:_,rendering:null,renderingStartTime:0,last:k,tail:C,tailMode:W}:(ie.isBackwards=_,ie.rendering=null,ie.renderingStartTime=0,ie.last=k,ie.tail=C,ie.tailMode=W)}function eg(m,_,C){var k=_.pendingProps,W=k.revealOrder,ie=k.tail;if($o(m,_,k.children,C),k=ki.current,(k&2)!==0)k=k&1|2,_.flags|=128;else{if(m!==null&&(m.flags&128)!==0)e:for(m=_.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&wp(m,C,_);else if(m.tag===19)wp(m,C,_);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===_)break e;for(;m.sibling===null;){if(m.return===null||m.return===_)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}k&=1}switch(Je(ki,k),W){case"forwards":for(C=_.child,W=null;C!==null;)m=C.alternate,m!==null&&Pd(m)===null&&(W=C),C=C.sibling;C=W,C===null?(W=_.child,_.child=null):(W=C.sibling,C.sibling=null),Qm(_,!1,W,C,ie);break;case"backwards":for(C=null,W=_.child,_.child=null;W!==null;){if(m=W.alternate,m!==null&&Pd(m)===null){_.child=W;break}m=W.sibling,W.sibling=C,C=W,W=m}Qm(_,!0,C,null,ie);break;case"together":Qm(_,!1,null,null,void 0);break;default:_.memoizedState=null}return _.child}function Ro(m,_,C){if(m!==null&&(_.dependencies=m.dependencies),Zr|=_.lanes,(C&_.childLanes)===0)if(m!==null){if(Kh(m,_,C,!1),(C&_.childLanes)===0)return null}else return null;if(m!==null&&_.child!==m.child)throw Error(r(153));if(_.child!==null){for(m=_.child,C=fd(m,m.pendingProps),_.child=C,C.return=_;m.sibling!==null;)m=m.sibling,C=C.sibling=fd(m,m.pendingProps),C.return=_;C.sibling=null}return _.child}function Sp(m,_){return(m.lanes&_)!==0?!0:(m=m.dependencies,!!(m!==null&&sp(m)))}function Ra(m,_,C){switch(_.tag){case 3:an(_,_.stateNode.containerInfo),Fu(_,na,m.memoizedState.cache),gd();break;case 27:case 5:Cn(_);break;case 4:an(_,_.stateNode.containerInfo);break;case 10:Fu(_,_.type,_.memoizedProps.value);break;case 13:var k=_.memoizedState;if(k!==null)return k.dehydrated!==null?(Gu(_),_.flags|=128,null):(C&_.child.childLanes)!==0?j_(m,_,C):(Gu(_),m=Ro(m,_,C),m!==null?m.sibling:null);Gu(_);break;case 19:var W=(m.flags&128)!==0;if(k=(C&_.childLanes)!==0,k||(Kh(m,_,C,!1),k=(C&_.childLanes)!==0),W){if(k)return eg(m,_,C);_.flags|=128}if(W=_.memoizedState,W!==null&&(W.rendering=null,W.tail=null,W.lastEffect=null),Je(ki,ki.current),k)break;return null;case 22:case 23:return _.lanes=0,Ym(m,_,C);case 24:Fu(_,na,m.memoizedState.cache)}return Ro(m,_,C)}function mu(m,_,C){if(m!==null)if(m.memoizedProps!==_.pendingProps)fo=!0;else{if(!Sp(m,C)&&(_.flags&128)===0)return fo=!1,Ra(m,_,C);fo=(m.flags&131072)!==0}else fo=!1,oa&&(_.flags&1048576)!==0&&uh(_,Hg,_.index);switch(_.lanes=0,_.tag){case 16:e:{m=_.pendingProps;var k=_.elementType,W=k._init;if(k=W(k._payload),_.type=k,typeof k=="function")vm(k)?(m=pu(k,m),_.tag=1,_=Kv(null,_,k,m,C)):(_.tag=0,_=gy(null,_,k,m,C));else{if(k!=null){if(W=k.$$typeof,W===ae){_.tag=11,_=Wv(null,_,k,m,C);break e}else if(W===he){_.tag=14,_=my(null,_,k,m,C);break e}}throw _=Me(k)||k,Error(r(306,_,""))}}return _;case 0:return gy(m,_,_.type,_.pendingProps,C);case 1:return k=_.type,W=pu(k,_.pendingProps),Kv(m,_,k,W,C);case 3:e:{if(an(_,_.stateNode.containerInfo),m===null)throw Error(r(387));k=_.pendingProps;var ie=_.memoizedState;W=ie.element,ty(m,_),cp(_,k,null,C);var Ae=_.memoizedState;if(k=Ae.cache,Fu(_,na,k),k!==ie.cache&&wm(_,[na],C,!0),vh(),k=Ae.element,ie.isDehydrated)if(ie={element:k,isDehydrated:!1,cache:Ae.cache},_.updateQueue.baseState=ie,_.memoizedState=ie,_.flags&256){_=A_(m,_,k,C);break e}else if(k!==W){W=mn(Error(r(424)),_),ip(W),_=A_(m,_,k,C);break e}else{switch(m=_.stateNode.containerInfo,m.nodeType){case 9:m=m.body;break;default:m=m.nodeName==="HTML"?m.ownerDocument.body:m}for(Ma=kd(m.firstChild),Ko=_,oa=!0,md=null,ou=!0,C=Nd(_,null,k,C),_.child=C;C;)C.flags=C.flags&-3|4096,C=C.sibling}else{if(gd(),k===W){_=Ro(m,_,C);break e}$o(m,_,k,C)}_=_.child}return _;case 26:return Km(m,_),m===null?(C=ww(_.type,null,_.pendingProps,null))?_.memoizedState=C:oa||(C=_.type,m=_.pendingProps,k=k_(Ot.current).createElement(C),k[Q]=_,k[fe]=m,$l(k,C,m),pr(k),_.stateNode=k):_.memoizedState=ww(_.type,m.memoizedProps,_.pendingProps,m.memoizedState),null;case 27:return Cn(_),m===null&&oa&&(k=_.stateNode=V_(_.type,_.pendingProps,Ot.current),Ko=_,ou=!0,W=Ma,Dd(_.type)?(B_=W,Ma=kd(k.firstChild)):Ma=W),$o(m,_,_.pendingProps.children,C),Km(m,_),m===null&&(_.flags|=4194304),_.child;case 5:return m===null&&oa&&((W=k=Ma)&&(k=KT(k,_.type,_.pendingProps,ou),k!==null?(_.stateNode=k,Ko=_,Ma=kd(k.firstChild),ou=!1,W=!0):W=!1),W||Lu(_)),Cn(_),W=_.type,ie=_.pendingProps,Ae=m!==null?m.memoizedProps:null,k=ie.children,vw(W,ie)?k=null:Ae!==null&&vw(W,Ae)&&(_.flags|=32),_.memoizedState!==null&&(W=Rm(m,_,Hn,null,null,C),sg._currentValue=W),Km(m,_),$o(m,_,k,C),_.child;case 6:return m===null&&oa&&((m=C=Ma)&&(C=lx(C,_.pendingProps,ou),C!==null?(_.stateNode=C,Ko=_,Ma=null,m=!0):m=!1),m||Lu(_)),null;case 13:return j_(m,_,C);case 4:return an(_,_.stateNode.containerInfo),k=_.pendingProps,m===null?_.child=fu(_,null,k,C):$o(m,_,k,C),_.child;case 11:return Wv(m,_,_.type,_.pendingProps,C);case 7:return $o(m,_,_.pendingProps,C),_.child;case 8:return $o(m,_,_.pendingProps.children,C),_.child;case 12:return $o(m,_,_.pendingProps.children,C),_.child;case 10:return k=_.pendingProps,Fu(_,_.type,k.value),$o(m,_,k.children,C),_.child;case 9:return W=_.type._context,k=_.pendingProps.children,Bu(_),W=Jo(W),k=k(W),_.flags|=1,$o(m,_,k,C),_.child;case 14:return my(m,_,_.type,_.pendingProps,C);case 15:return Xv(m,_,_.type,_.pendingProps,C);case 19:return eg(m,_,C);case 31:return k=_.pendingProps,C=_.mode,k={mode:k.mode,children:k.children},m===null?(C=vy(k,C),C.ref=_.ref,_.child=C,C.return=_,_=C):(C=fd(m.child,k),C.ref=_.ref,_.child=C,C.return=_,_=C),_;case 22:return Ym(m,_,C);case 24:return Bu(_),k=Jo(na),m===null?(W=jm(),W===null&&(W=Yt,ie=Tm(),W.pooledCache=ie,ie.refCount++,ie!==null&&(W.pooledCacheLanes|=C),W=ie),_.memoizedState={parent:k,cache:W},ey(_),Fu(_,na,W)):((m.lanes&C)!==0&&(ty(m,_),cp(_,null,null,C),vh()),W=m.memoizedState,ie=_.memoizedState,W.parent!==k?(W={parent:k,cache:k},_.memoizedState=W,_.lanes===0&&(_.memoizedState=_.updateQueue.baseState=W),Fu(_,na,k)):(k=ie.cache,Fu(_,na,k),k!==W.cache&&wm(_,[na],C,!0))),$o(m,_,_.pendingProps.children,C),_.child;case 29:throw _.pendingProps}throw Error(r(156,_.tag))}function ic(m){m.flags|=4}function Tp(m,_){if(_.type!=="stylesheet"||(_.state.loading&4)!==0)m.flags&=-16777217;else if(m.flags|=16777216,!hx(_)){if(_=nc.current,_!==null&&((en&4194048)===en?Vo!==null:(en&62914560)!==en&&(en&536870912)===0||_!==Vo))throw ef=kv,Dv;m.flags|=8192}}function Ap(m,_){_!==null&&(m.flags|=4),m.flags&16384&&(_=m.tag!==22?Di():536870912,m.lanes|=_,Ii|=_)}function jp(m,_){if(!oa)switch(m.tailMode){case"hidden":_=m.tail;for(var C=null;_!==null;)_.alternate!==null&&(C=_),_=_.sibling;C===null?m.tail=null:C.sibling=null;break;case"collapsed":C=m.tail;for(var k=null;C!==null;)C.alternate!==null&&(k=C),C=C.sibling;k===null?_||m.tail===null?m.tail=null:m.tail.sibling=null:k.sibling=null}}function Oa(m){var _=m.alternate!==null&&m.alternate.child===m.child,C=0,k=0;if(_)for(var W=m.child;W!==null;)C|=W.lanes|W.childLanes,k|=W.subtreeFlags&65011712,k|=W.flags&65011712,W.return=m,W=W.sibling;else for(W=m.child;W!==null;)C|=W.lanes|W.childLanes,k|=W.subtreeFlags,k|=W.flags,W.return=m,W=W.sibling;return m.subtreeFlags|=k,m.childLanes=C,_}function nw(m,_,C){var k=_.pendingProps;switch(rp(_),_.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Oa(_),null;case 1:return Oa(_),null;case 3:return C=_.stateNode,k=null,m!==null&&(k=m.memoizedState.cache),_.memoizedState.cache!==k&&(_.flags|=2048),yd(na),Jt(),C.pendingContext&&(C.context=C.pendingContext,C.pendingContext=null),(m===null||m.child===null)&&(fh(_)?ic(_):m===null||m.memoizedState.isDehydrated&&(_.flags&256)===0||(_.flags|=1024,Rv())),Oa(_),null;case 26:return C=_.memoizedState,m===null?(ic(_),C!==null?(Oa(_),Tp(_,C)):(Oa(_),_.flags&=-16777217)):C?C!==m.memoizedState?(ic(_),Oa(_),Tp(_,C)):(Oa(_),_.flags&=-16777217):(m.memoizedProps!==k&&ic(_),Oa(_),_.flags&=-16777217),null;case 27:nr(_),C=Ot.current;var W=_.type;if(m!==null&&_.stateNode!=null)m.memoizedProps!==k&&ic(_);else{if(!k){if(_.stateNode===null)throw Error(r(166));return Oa(_),null}m=jt.current,fh(_)?bm(_):(m=V_(W,k,C),_.stateNode=m,ic(_))}return Oa(_),null;case 5:if(nr(_),C=_.type,m!==null&&_.stateNode!=null)m.memoizedProps!==k&&ic(_);else{if(!k){if(_.stateNode===null)throw Error(r(166));return Oa(_),null}if(m=jt.current,fh(_))bm(_);else{switch(W=k_(Ot.current),m){case 1:m=W.createElementNS("http://www.w3.org/2000/svg",C);break;case 2:m=W.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;default:switch(C){case"svg":m=W.createElementNS("http://www.w3.org/2000/svg",C);break;case"math":m=W.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;case"script":m=W.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof k.is=="string"?W.createElement("select",{is:k.is}):W.createElement("select"),k.multiple?m.multiple=!0:k.size&&(m.size=k.size);break;default:m=typeof k.is=="string"?W.createElement(C,{is:k.is}):W.createElement(C)}}m[Q]=_,m[fe]=k;e:for(W=_.child;W!==null;){if(W.tag===5||W.tag===6)m.appendChild(W.stateNode);else if(W.tag!==4&&W.tag!==27&&W.child!==null){W.child.return=W,W=W.child;continue}if(W===_)break e;for(;W.sibling===null;){if(W.return===null||W.return===_)break e;W=W.return}W.sibling.return=W.return,W=W.sibling}_.stateNode=m;e:switch($l(m,C,k),C){case"button":case"input":case"select":case"textarea":m=!!k.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&ic(_)}}return Oa(_),_.flags&=-16777217,null;case 6:if(m&&_.stateNode!=null)m.memoizedProps!==k&&ic(_);else{if(typeof k!="string"&&_.stateNode===null)throw Error(r(166));if(m=Ot.current,fh(_)){if(m=_.stateNode,C=_.memoizedProps,k=null,W=Ko,W!==null)switch(W.tag){case 27:case 5:k=W.memoizedProps}m[Q]=_,m=!!(m.nodeValue===C||k!==null&&k.suppressHydrationWarning===!0||pw(m.nodeValue,C)),m||Lu(_)}else m=k_(m).createTextNode(k),m[Q]=_,_.stateNode=m}return Oa(_),null;case 13:if(k=_.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(W=fh(_),k!==null&&k.dehydrated!==null){if(m===null){if(!W)throw Error(r(318));if(W=_.memoizedState,W=W!==null?W.dehydrated:null,!W)throw Error(r(317));W[Q]=_}else gd(),(_.flags&128)===0&&(_.memoizedState=null),_.flags|=4;Oa(_),W=!1}else W=Rv(),m!==null&&m.memoizedState!==null&&(m.memoizedState.hydrationErrors=W),W=!0;if(!W)return _.flags&256?(rc(_),_):(rc(_),null)}if(rc(_),(_.flags&128)!==0)return _.lanes=C,_;if(C=k!==null,m=m!==null&&m.memoizedState!==null,C){k=_.child,W=null,k.alternate!==null&&k.alternate.memoizedState!==null&&k.alternate.memoizedState.cachePool!==null&&(W=k.alternate.memoizedState.cachePool.pool);var ie=null;k.memoizedState!==null&&k.memoizedState.cachePool!==null&&(ie=k.memoizedState.cachePool.pool),ie!==W&&(k.flags|=2048)}return C!==m&&C&&(_.child.flags|=8192),Ap(_,_.updateQueue),Oa(_),null;case 4:return Jt(),m===null&&ax(_.stateNode.containerInfo),Oa(_),null;case 10:return yd(_.type),Oa(_),null;case 19:if(We(ki),W=_.memoizedState,W===null)return Oa(_),null;if(k=(_.flags&128)!==0,ie=W.rendering,ie===null)if(k)jp(W,!1);else{if(Tr!==0||m!==null&&(m.flags&128)!==0)for(m=_.child;m!==null;){if(ie=Pd(m),ie!==null){for(_.flags|=128,jp(W,!1),m=ie.updateQueue,_.updateQueue=m,Ap(_,m),_.subtreeFlags=0,m=C,C=_.child;C!==null;)qg(C,m),C=C.sibling;return Je(ki,ki.current&1|2),_.child}m=m.sibling}W.tail!==null&&Nn()>Wi&&(_.flags|=128,k=!0,jp(W,!1),_.lanes=4194304)}else{if(!k)if(m=Pd(ie),m!==null){if(_.flags|=128,k=!0,m=m.updateQueue,_.updateQueue=m,Ap(_,m),jp(W,!0),W.tail===null&&W.tailMode==="hidden"&&!ie.alternate&&!oa)return Oa(_),null}else 2*Nn()-W.renderingStartTime>Wi&&C!==536870912&&(_.flags|=128,k=!0,jp(W,!1),_.lanes=4194304);W.isBackwards?(ie.sibling=_.child,_.child=ie):(m=W.last,m!==null?m.sibling=ie:_.child=ie,W.last=ie)}return W.tail!==null?(_=W.tail,W.rendering=_,W.tail=_.sibling,W.renderingStartTime=Nn(),_.sibling=null,m=ki.current,Je(ki,k?m&1|2:m&1),_):(Oa(_),null);case 22:case 23:return rc(_),Pm(),k=_.memoizedState!==null,m!==null?m.memoizedState!==null!==k&&(_.flags|=8192):k&&(_.flags|=8192),k?(C&536870912)!==0&&(_.flags&128)===0&&(Oa(_),_.subtreeFlags&6&&(_.flags|=8192)):Oa(_),C=_.updateQueue,C!==null&&Ap(_,C.retryQueue),C=null,m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(C=m.memoizedState.cachePool.pool),k=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(k=_.memoizedState.cachePool.pool),k!==C&&(_.flags|=2048),m!==null&&We(xd),null;case 24:return C=null,m!==null&&(C=m.memoizedState.cache),_.memoizedState.cache!==C&&(_.flags|=2048),yd(na),Oa(_),null;case 25:return null;case 30:return null}throw Error(r(156,_.tag))}function E_(m,_){switch(rp(_),_.tag){case 1:return m=_.flags,m&65536?(_.flags=m&-65537|128,_):null;case 3:return yd(na),Jt(),m=_.flags,(m&65536)!==0&&(m&128)===0?(_.flags=m&-65537|128,_):null;case 26:case 27:case 5:return nr(_),null;case 13:if(rc(_),m=_.memoizedState,m!==null&&m.dehydrated!==null){if(_.alternate===null)throw Error(r(340));gd()}return m=_.flags,m&65536?(_.flags=m&-65537|128,_):null;case 19:return We(ki),null;case 4:return Jt(),null;case 10:return yd(_.type),null;case 22:case 23:return rc(_),Pm(),m!==null&&We(xd),m=_.flags,m&65536?(_.flags=m&-65537|128,_):null;case 24:return yd(na),null;case 25:return null;default:return null}}function xy(m,_){switch(rp(_),_.tag){case 3:yd(na),Jt();break;case 26:case 27:case 5:nr(_);break;case 4:Jt();break;case 13:rc(_);break;case 19:We(ki);break;case 10:yd(_.type);break;case 22:case 23:rc(_),Pm(),m!==null&&We(xd);break;case 24:yd(na)}}function pf(m,_){try{var C=_.updateQueue,k=C!==null?C.lastEffect:null;if(k!==null){var W=k.next;C=W;do{if((C.tag&m)===m){k=void 0;var ie=C.create,Ae=C.inst;k=ie(),Ae.destroy=k}C=C.next}while(C!==W)}}catch(Xe){Da(_,_.return,Xe)}}function Gc(m,_,C){try{var k=_.updateQueue,W=k!==null?k.lastEffect:null;if(W!==null){var ie=W.next;k=ie;do{if((k.tag&m)===m){var Ae=k.inst,Xe=Ae.destroy;if(Xe!==void 0){Ae.destroy=void 0,W=_;var Nt=C,on=Xe;try{on()}catch(zn){Da(W,Nt,zn)}}}k=k.next}while(k!==ie)}}catch(zn){Da(_,_.return,zn)}}function mf(m){var _=m.updateQueue;if(_!==null){var C=m.stateNode;try{Cm(_,C)}catch(k){Da(m,m.return,k)}}}function Wu(m,_,C){C.props=pu(m.type,m.memoizedProps),C.state=m.memoizedState;try{C.componentWillUnmount()}catch(k){Da(m,_,k)}}function Sl(m,_){try{var C=m.ref;if(C!==null){switch(m.tag){case 26:case 27:case 5:var k=m.stateNode;break;case 30:k=m.stateNode;break;default:k=m.stateNode}typeof C=="function"?m.refCleanup=C(k):C.current=k}}catch(W){Da(m,_,W)}}function po(m,_){var C=m.ref,k=m.refCleanup;if(C!==null)if(typeof k=="function")try{k()}catch(W){Da(m,_,W)}finally{m.refCleanup=null,m=m.alternate,m!=null&&(m.refCleanup=null)}else if(typeof C=="function")try{C(null)}catch(W){Da(m,_,W)}else C.current=null}function ol(m){var _=m.type,C=m.memoizedProps,k=m.stateNode;try{e:switch(_){case"button":case"input":case"select":case"textarea":C.autoFocus&&k.focus();break e;case"img":C.src?k.src=C.src:C.srcSet&&(k.srcset=C.srcSet)}}catch(W){Da(m,m.return,W)}}function Ul(m,_,C){try{var k=m.stateNode;fN(k,m.type,C,_),k[fe]=_}catch(W){Da(m,m.return,W)}}function C_(m){return m.tag===5||m.tag===3||m.tag===26||m.tag===27&&Dd(m.type)||m.tag===4}function Qv(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||C_(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&m.tag!==18;){if(m.tag===27&&Dd(m.type)||m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function ex(m,_,C){var k=m.tag;if(k===5||k===6)m=m.stateNode,_?(C.nodeType===9?C.body:C.nodeName==="HTML"?C.ownerDocument.body:C).insertBefore(m,_):(_=C.nodeType===9?C.body:C.nodeName==="HTML"?C.ownerDocument.body:C,_.appendChild(m),C=C._reactRootContainer,C!=null||_.onclick!==null||(_.onclick=jh));else if(k!==4&&(k===27&&Dd(m.type)&&(C=m.stateNode,_=null),m=m.child,m!==null))for(ex(m,_,C),m=m.sibling;m!==null;)ex(m,_,C),m=m.sibling}function _y(m,_,C){var k=m.tag;if(k===5||k===6)m=m.stateNode,_?C.insertBefore(m,_):C.appendChild(m);else if(k!==4&&(k===27&&Dd(m.type)&&(C=m.stateNode),m=m.child,m!==null))for(_y(m,_,C),m=m.sibling;m!==null;)_y(m,_,C),m=m.sibling}function tx(m){var _=m.stateNode,C=m.memoizedProps;try{for(var k=m.type,W=_.attributes;W.length;)_.removeAttributeNode(W[0]);$l(_,k,C),_[Q]=m,_[fe]=C}catch(ie){Da(m,m.return,ie)}}var qa=!1,mo=!1,y=!1,a=typeof WeakSet=="function"?WeakSet:Set,d=null;function v(m,_){if(m=m.containerInfo,gw=fx,m=Sv(m),Zf(m)){if("selectionStart"in m)var C={start:m.selectionStart,end:m.selectionEnd};else e:{C=(C=m.ownerDocument)&&C.defaultView||window;var k=C.getSelection&&C.getSelection();if(k&&k.rangeCount!==0){C=k.anchorNode;var W=k.anchorOffset,ie=k.focusNode;k=k.focusOffset;try{C.nodeType,ie.nodeType}catch{C=null;break e}var Ae=0,Xe=-1,Nt=-1,on=0,zn=0,Yn=m,_n=null;t:for(;;){for(var Tn;Yn!==C||W!==0&&Yn.nodeType!==3||(Xe=Ae+W),Yn!==ie||k!==0&&Yn.nodeType!==3||(Nt=Ae+k),Yn.nodeType===3&&(Ae+=Yn.nodeValue.length),(Tn=Yn.firstChild)!==null;)_n=Yn,Yn=Tn;for(;;){if(Yn===m)break t;if(_n===C&&++on===W&&(Xe=Ae),_n===ie&&++zn===k&&(Nt=Ae),(Tn=Yn.nextSibling)!==null)break;Yn=_n,_n=Yn.parentNode}Yn=Tn}C=Xe===-1||Nt===-1?null:{start:Xe,end:Nt}}else C=null}C=C||{start:0,end:0}}else C=null;for(yw={focusedElem:m,selectionRange:C},fx=!1,d=_;d!==null;)if(_=d,m=_.child,(_.subtreeFlags&1024)!==0&&m!==null)m.return=_,d=m;else for(;d!==null;){switch(_=d,ie=_.alternate,m=_.flags,_.tag){case 0:break;case 11:case 15:break;case 1:if((m&1024)!==0&&ie!==null){m=void 0,C=_,W=ie.memoizedProps,ie=ie.memoizedState,k=C.stateNode;try{var is=pu(C.type,W,C.elementType===C.type);m=k.getSnapshotBeforeUpdate(is,ie),k.__reactInternalSnapshotBeforeUpdate=m}catch(Li){Da(C,C.return,Li)}}break;case 3:if((m&1024)!==0){if(m=_.stateNode.containerInfo,C=m.nodeType,C===9)F_(m);else if(C===1)switch(m.nodeName){case"HEAD":case"HTML":case"BODY":F_(m);break;default:m.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((m&1024)!==0)throw Error(r(163))}if(m=_.sibling,m!==null){m.return=_.return,d=m;break}d=_.return}}function S(m,_,C){var k=C.flags;switch(C.tag){case 0:case 11:case 15:be(m,C),k&4&&pf(5,C);break;case 1:if(be(m,C),k&4)if(m=C.stateNode,_===null)try{m.componentDidMount()}catch(Ae){Da(C,C.return,Ae)}else{var W=pu(C.type,_.memoizedProps);_=_.memoizedState;try{m.componentDidUpdate(W,_,m.__reactInternalSnapshotBeforeUpdate)}catch(Ae){Da(C,C.return,Ae)}}k&64&&mf(C),k&512&&Sl(C,C.return);break;case 3:if(be(m,C),k&64&&(m=C.updateQueue,m!==null)){if(_=null,C.child!==null)switch(C.child.tag){case 27:case 5:_=C.child.stateNode;break;case 1:_=C.child.stateNode}try{Cm(m,_)}catch(Ae){Da(C,C.return,Ae)}}break;case 27:_===null&&k&4&&tx(C);case 26:case 5:be(m,C),_===null&&k&4&&ol(C),k&512&&Sl(C,C.return);break;case 12:be(m,C);break;case 13:be(m,C),k&4&&G(m,C),k&64&&(m=C.memoizedState,m!==null&&(m=m.dehydrated,m!==null&&(C=$T.bind(null,C),ux(m,C))));break;case 22:if(k=C.memoizedState!==null||qa,!k){_=_!==null&&_.memoizedState!==null||mo,W=qa;var ie=mo;qa=k,(mo=_)&&!ie?De(m,C,(C.subtreeFlags&8772)!==0):be(m,C),qa=W,mo=ie}break;case 30:break;default:be(m,C)}}function A(m){var _=m.alternate;_!==null&&(m.alternate=null,A(_)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(_=m.stateNode,_!==null&&St(_)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}var P=null,O=!1;function I(m,_,C){for(C=C.child;C!==null;)H(m,_,C),C=C.sibling}function H(m,_,C){if($t&&typeof $t.onCommitFiberUnmount=="function")try{$t.onCommitFiberUnmount(hr,C)}catch{}switch(C.tag){case 26:mo||po(C,_),I(m,_,C),C.memoizedState?C.memoizedState.count--:C.stateNode&&(C=C.stateNode,C.parentNode.removeChild(C));break;case 27:mo||po(C,_);var k=P,W=O;Dd(C.type)&&(P=C.stateNode,O=!1),I(m,_,C),jy(C.stateNode),P=k,O=W;break;case 5:mo||po(C,_);case 6:if(k=P,W=O,P=null,I(m,_,C),P=k,O=W,P!==null)if(O)try{(P.nodeType===9?P.body:P.nodeName==="HTML"?P.ownerDocument.body:P).removeChild(C.stateNode)}catch(ie){Da(C,_,ie)}else try{P.removeChild(C.stateNode)}catch(ie){Da(C,_,ie)}break;case 18:P!==null&&(O?(m=P,Ay(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,C.stateNode),Ld(m)):Ay(P,C.stateNode));break;case 4:k=P,W=O,P=C.stateNode.containerInfo,O=!0,I(m,_,C),P=k,O=W;break;case 0:case 11:case 14:case 15:mo||Gc(2,C,_),mo||Gc(4,C,_),I(m,_,C);break;case 1:mo||(po(C,_),k=C.stateNode,typeof k.componentWillUnmount=="function"&&Wu(C,_,k)),I(m,_,C);break;case 21:I(m,_,C);break;case 22:mo=(k=mo)||C.memoizedState!==null,I(m,_,C),mo=k;break;default:I(m,_,C)}}function G(m,_){if(_.memoizedState===null&&(m=_.alternate,m!==null&&(m=m.memoizedState,m!==null&&(m=m.dehydrated,m!==null))))try{Ld(m)}catch(C){Da(_,_.return,C)}}function ne(m){switch(m.tag){case 13:case 19:var _=m.stateNode;return _===null&&(_=m.stateNode=new a),_;case 22:return m=m.stateNode,_=m._retryCache,_===null&&(_=m._retryCache=new a),_;default:throw Error(r(435,m.tag))}}function J(m,_){var C=ne(m);_.forEach(function(k){var W=P_.bind(null,m,k);C.has(k)||(C.add(k),k.then(W,W))})}function re(m,_){var C=_.deletions;if(C!==null)for(var k=0;k<C.length;k++){var W=C[k],ie=m,Ae=_,Xe=Ae;e:for(;Xe!==null;){switch(Xe.tag){case 27:if(Dd(Xe.type)){P=Xe.stateNode,O=!1;break e}break;case 5:P=Xe.stateNode,O=!1;break e;case 3:case 4:P=Xe.stateNode.containerInfo,O=!0;break e}Xe=Xe.return}if(P===null)throw Error(r(160));H(ie,Ae,W),P=null,O=!1,ie=W.alternate,ie!==null&&(ie.return=null),W.return=null}if(_.subtreeFlags&13878)for(_=_.child;_!==null;)ce(_,m),_=_.sibling}var de=null;function ce(m,_){var C=m.alternate,k=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:re(_,m),pe(m),k&4&&(Gc(3,m,m.return),pf(3,m),Gc(5,m,m.return));break;case 1:re(_,m),pe(m),k&512&&(mo||C===null||po(C,C.return)),k&64&&qa&&(m=m.updateQueue,m!==null&&(k=m.callbacks,k!==null&&(C=m.shared.hiddenCallbacks,m.shared.hiddenCallbacks=C===null?k:C.concat(k))));break;case 26:var W=de;if(re(_,m),pe(m),k&512&&(mo||C===null||po(C,C.return)),k&4){var ie=C!==null?C.memoizedState:null;if(k=m.memoizedState,C===null)if(k===null)if(m.stateNode===null){e:{k=m.type,C=m.memoizedProps,W=W.ownerDocument||W;t:switch(k){case"title":ie=W.getElementsByTagName("title")[0],(!ie||ie[ht]||ie[Q]||ie.namespaceURI==="http://www.w3.org/2000/svg"||ie.hasAttribute("itemprop"))&&(ie=W.createElement(k),W.head.insertBefore(ie,W.querySelector("head > title"))),$l(ie,k,C),ie[Q]=m,pr(ie),k=ie;break e;case"link":var Ae=Cy("link","href",W).get(k+(C.href||""));if(Ae){for(var Xe=0;Xe<Ae.length;Xe++)if(ie=Ae[Xe],ie.getAttribute("href")===(C.href==null||C.href===""?null:C.href)&&ie.getAttribute("rel")===(C.rel==null?null:C.rel)&&ie.getAttribute("title")===(C.title==null?null:C.title)&&ie.getAttribute("crossorigin")===(C.crossOrigin==null?null:C.crossOrigin)){Ae.splice(Xe,1);break t}}ie=W.createElement(k),$l(ie,k,C),W.head.appendChild(ie);break;case"meta":if(Ae=Cy("meta","content",W).get(k+(C.content||""))){for(Xe=0;Xe<Ae.length;Xe++)if(ie=Ae[Xe],ie.getAttribute("content")===(C.content==null?null:""+C.content)&&ie.getAttribute("name")===(C.name==null?null:C.name)&&ie.getAttribute("property")===(C.property==null?null:C.property)&&ie.getAttribute("http-equiv")===(C.httpEquiv==null?null:C.httpEquiv)&&ie.getAttribute("charset")===(C.charSet==null?null:C.charSet)){Ae.splice(Xe,1);break t}}ie=W.createElement(k),$l(ie,k,C),W.head.appendChild(ie);break;default:throw Error(r(468,k))}ie[Q]=m,pr(ie),k=ie}m.stateNode=k}else Aw(W,m.type,m.stateNode);else m.stateNode=a2(W,k,m.memoizedProps);else ie!==k?(ie===null?C.stateNode!==null&&(C=C.stateNode,C.parentNode.removeChild(C)):ie.count--,k===null?Aw(W,m.type,m.stateNode):a2(W,k,m.memoizedProps)):k===null&&m.stateNode!==null&&Ul(m,m.memoizedProps,C.memoizedProps)}break;case 27:re(_,m),pe(m),k&512&&(mo||C===null||po(C,C.return)),C!==null&&k&4&&Ul(m,m.memoizedProps,C.memoizedProps);break;case 5:if(re(_,m),pe(m),k&512&&(mo||C===null||po(C,C.return)),m.flags&32){W=m.stateNode;try{to(W,"")}catch(Tn){Da(m,m.return,Tn)}}k&4&&m.stateNode!=null&&(W=m.memoizedProps,Ul(m,W,C!==null?C.memoizedProps:W)),k&1024&&(y=!0);break;case 6:if(re(_,m),pe(m),k&4){if(m.stateNode===null)throw Error(r(162));k=m.memoizedProps,C=m.stateNode;try{C.nodeValue=k}catch(Tn){Da(m,m.return,Tn)}}break;case 3:if(q_=null,W=de,de=jl(_.containerInfo),re(_,m),de=W,pe(m),k&4&&C!==null&&C.memoizedState.isDehydrated)try{Ld(_.containerInfo)}catch(Tn){Da(m,m.return,Tn)}y&&(y=!1,me(m));break;case 4:k=de,de=jl(m.stateNode.containerInfo),re(_,m),pe(m),de=k;break;case 12:re(_,m),pe(m);break;case 13:re(_,m),pe(m),m.child.flags&8192&&m.memoizedState!==null!=(C!==null&&C.memoizedState!==null)&&($i=Nn()),k&4&&(k=m.updateQueue,k!==null&&(m.updateQueue=null,J(m,k)));break;case 22:W=m.memoizedState!==null;var Nt=C!==null&&C.memoizedState!==null,on=qa,zn=mo;if(qa=on||W,mo=zn||Nt,re(_,m),mo=zn,qa=on,pe(m),k&8192)e:for(_=m.stateNode,_._visibility=W?_._visibility&-2:_._visibility|1,W&&(C===null||Nt||qa||mo||Ne(m)),C=null,_=m;;){if(_.tag===5||_.tag===26){if(C===null){Nt=C=_;try{if(ie=Nt.stateNode,W)Ae=ie.style,typeof Ae.setProperty=="function"?Ae.setProperty("display","none","important"):Ae.display="none";else{Xe=Nt.stateNode;var Yn=Nt.memoizedProps.style,_n=Yn!=null&&Yn.hasOwnProperty("display")?Yn.display:null;Xe.style.display=_n==null||typeof _n=="boolean"?"":(""+_n).trim()}}catch(Tn){Da(Nt,Nt.return,Tn)}}}else if(_.tag===6){if(C===null){Nt=_;try{Nt.stateNode.nodeValue=W?"":Nt.memoizedProps}catch(Tn){Da(Nt,Nt.return,Tn)}}}else if((_.tag!==22&&_.tag!==23||_.memoizedState===null||_===m)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===m)break e;for(;_.sibling===null;){if(_.return===null||_.return===m)break e;C===_&&(C=null),_=_.return}C===_&&(C=null),_.sibling.return=_.return,_=_.sibling}k&4&&(k=m.updateQueue,k!==null&&(C=k.retryQueue,C!==null&&(k.retryQueue=null,J(m,C))));break;case 19:re(_,m),pe(m),k&4&&(k=m.updateQueue,k!==null&&(m.updateQueue=null,J(m,k)));break;case 30:break;case 21:break;default:re(_,m),pe(m)}}function pe(m){var _=m.flags;if(_&2){try{for(var C,k=m.return;k!==null;){if(C_(k)){C=k;break}k=k.return}if(C==null)throw Error(r(160));switch(C.tag){case 27:var W=C.stateNode,ie=Qv(m);_y(m,ie,W);break;case 5:var Ae=C.stateNode;C.flags&32&&(to(Ae,""),C.flags&=-33);var Xe=Qv(m);_y(m,Xe,Ae);break;case 3:case 4:var Nt=C.stateNode.containerInfo,on=Qv(m);ex(m,on,Nt);break;default:throw Error(r(161))}}catch(zn){Da(m,m.return,zn)}m.flags&=-3}_&4096&&(m.flags&=-4097)}function me(m){if(m.subtreeFlags&1024)for(m=m.child;m!==null;){var _=m;me(_),_.tag===5&&_.flags&1024&&_.stateNode.reset(),m=m.sibling}}function be(m,_){if(_.subtreeFlags&8772)for(_=_.child;_!==null;)S(m,_.alternate,_),_=_.sibling}function Ne(m){for(m=m.child;m!==null;){var _=m;switch(_.tag){case 0:case 11:case 14:case 15:Gc(4,_,_.return),Ne(_);break;case 1:po(_,_.return);var C=_.stateNode;typeof C.componentWillUnmount=="function"&&Wu(_,_.return,C),Ne(_);break;case 27:jy(_.stateNode);case 26:case 5:po(_,_.return),Ne(_);break;case 22:_.memoizedState===null&&Ne(_);break;case 30:Ne(_);break;default:Ne(_)}m=m.sibling}}function De(m,_,C){for(C=C&&(_.subtreeFlags&8772)!==0,_=_.child;_!==null;){var k=_.alternate,W=m,ie=_,Ae=ie.flags;switch(ie.tag){case 0:case 11:case 15:De(W,ie,C),pf(4,ie);break;case 1:if(De(W,ie,C),k=ie,W=k.stateNode,typeof W.componentDidMount=="function")try{W.componentDidMount()}catch(on){Da(k,k.return,on)}if(k=ie,W=k.updateQueue,W!==null){var Xe=k.stateNode;try{var Nt=W.shared.hiddenCallbacks;if(Nt!==null)for(W.shared.hiddenCallbacks=null,W=0;W<Nt.length;W++)Lv(Nt[W],Xe)}catch(on){Da(k,k.return,on)}}C&&Ae&64&&mf(ie),Sl(ie,ie.return);break;case 27:tx(ie);case 26:case 5:De(W,ie,C),C&&k===null&&Ae&4&&ol(ie),Sl(ie,ie.return);break;case 12:De(W,ie,C);break;case 13:De(W,ie,C),C&&Ae&4&&G(W,ie);break;case 22:ie.memoizedState===null&&De(W,ie,C),Sl(ie,ie.return);break;case 30:break;default:De(W,ie,C)}_=_.sibling}}function Be(m,_){var C=null;m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(C=m.memoizedState.cachePool.pool),m=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(m=_.memoizedState.cachePool.pool),m!==C&&(m!=null&&m.refCount++,C!=null&&ph(C))}function Ze(m,_){m=null,_.alternate!==null&&(m=_.alternate.memoizedState.cache),_=_.memoizedState.cache,_!==m&&(_.refCount++,m!=null&&ph(m))}function Ye(m,_,C,k){if(_.subtreeFlags&10256)for(_=_.child;_!==null;)Ue(m,_,C,k),_=_.sibling}function Ue(m,_,C,k){var W=_.flags;switch(_.tag){case 0:case 11:case 15:Ye(m,_,C,k),W&2048&&pf(9,_);break;case 1:Ye(m,_,C,k);break;case 3:Ye(m,_,C,k),W&2048&&(m=null,_.alternate!==null&&(m=_.alternate.memoizedState.cache),_=_.memoizedState.cache,_!==m&&(_.refCount++,m!=null&&ph(m)));break;case 12:if(W&2048){Ye(m,_,C,k),m=_.stateNode;try{var ie=_.memoizedProps,Ae=ie.id,Xe=ie.onPostCommit;typeof Xe=="function"&&Xe(Ae,_.alternate===null?"mount":"update",m.passiveEffectDuration,-0)}catch(Nt){Da(_,_.return,Nt)}}else Ye(m,_,C,k);break;case 13:Ye(m,_,C,k);break;case 23:break;case 22:ie=_.stateNode,Ae=_.alternate,_.memoizedState!==null?ie._visibility&2?Ye(m,_,C,k):Ge(m,_):ie._visibility&2?Ye(m,_,C,k):(ie._visibility|=2,qe(m,_,C,k,(_.subtreeFlags&10256)!==0)),W&2048&&Be(Ae,_);break;case 24:Ye(m,_,C,k),W&2048&&Ze(_.alternate,_);break;default:Ye(m,_,C,k)}}function qe(m,_,C,k,W){for(W=W&&(_.subtreeFlags&10256)!==0,_=_.child;_!==null;){var ie=m,Ae=_,Xe=C,Nt=k,on=Ae.flags;switch(Ae.tag){case 0:case 11:case 15:qe(ie,Ae,Xe,Nt,W),pf(8,Ae);break;case 23:break;case 22:var zn=Ae.stateNode;Ae.memoizedState!==null?zn._visibility&2?qe(ie,Ae,Xe,Nt,W):Ge(ie,Ae):(zn._visibility|=2,qe(ie,Ae,Xe,Nt,W)),W&&on&2048&&Be(Ae.alternate,Ae);break;case 24:qe(ie,Ae,Xe,Nt,W),W&&on&2048&&Ze(Ae.alternate,Ae);break;default:qe(ie,Ae,Xe,Nt,W)}_=_.sibling}}function Ge(m,_){if(_.subtreeFlags&10256)for(_=_.child;_!==null;){var C=m,k=_,W=k.flags;switch(k.tag){case 22:Ge(C,k),W&2048&&Be(k.alternate,k);break;case 24:Ge(C,k),W&2048&&Ze(k.alternate,k);break;default:Ge(C,k)}_=_.sibling}}var _t=8192;function ct(m){if(m.subtreeFlags&_t)for(m=m.child;m!==null;)Bt(m),m=m.sibling}function Bt(m){switch(m.tag){case 26:ct(m),m.flags&_t&&m.memoizedState!==null&&H_(de,m.memoizedState,m.memoizedProps);break;case 5:ct(m);break;case 3:case 4:var _=de;de=jl(m.stateNode.containerInfo),ct(m),de=_;break;case 22:m.memoizedState===null&&(_=m.alternate,_!==null&&_.memoizedState!==null?(_=_t,_t=16777216,ct(m),_t=_):ct(m));break;default:ct(m)}}function Ct(m){var _=m.alternate;if(_!==null&&(m=_.child,m!==null)){_.child=null;do _=m.sibling,m.sibling=null,m=_;while(m!==null)}}function Xt(m){var _=m.deletions;if((m.flags&16)!==0){if(_!==null)for(var C=0;C<_.length;C++){var k=_[C];d=k,at(k,m)}Ct(m)}if(m.subtreeFlags&10256)for(m=m.child;m!==null;)gn(m),m=m.sibling}function gn(m){switch(m.tag){case 0:case 11:case 15:Xt(m),m.flags&2048&&Gc(9,m,m.return);break;case 3:Xt(m);break;case 12:Xt(m);break;case 22:var _=m.stateNode;m.memoizedState!==null&&_._visibility&2&&(m.return===null||m.return.tag!==13)?(_._visibility&=-3,wt(m)):Xt(m);break;default:Xt(m)}}function wt(m){var _=m.deletions;if((m.flags&16)!==0){if(_!==null)for(var C=0;C<_.length;C++){var k=_[C];d=k,at(k,m)}Ct(m)}for(m=m.child;m!==null;){switch(_=m,_.tag){case 0:case 11:case 15:Gc(8,_,_.return),wt(_);break;case 22:C=_.stateNode,C._visibility&2&&(C._visibility&=-3,wt(_));break;default:wt(_)}m=m.sibling}}function at(m,_){for(;d!==null;){var C=d;switch(C.tag){case 0:case 11:case 15:Gc(8,C,_);break;case 23:case 22:if(C.memoizedState!==null&&C.memoizedState.cachePool!==null){var k=C.memoizedState.cachePool.pool;k!=null&&k.refCount++}break;case 24:ph(C.memoizedState.cache)}if(k=C.child,k!==null)k.return=C,d=k;else e:for(C=m;d!==null;){k=d;var W=k.sibling,ie=k.return;if(A(k),k===C){d=null;break e}if(W!==null){W.return=ie,d=W;break e}d=ie}}}var Dt={getCacheForType:function(m){var _=Jo(na),C=_.data.get(m);return C===void 0&&(C=m(),_.data.set(m,C)),C}},At=typeof WeakMap=="function"?WeakMap:Map,Gt=0,Yt=null,Ht=null,en=0,Pn=0,Kn=null,In=!1,rr=!1,ar=!1,Er=0,Tr=0,Zr=0,ji=0,Lr=0,mi=0,Ii=0,os=null,Fr=null,Bi=!1,$i=0,Wi=1/0,ii=null,Xi=null,oi=0,js=null,Ei=null,Ui=0,fs=0,_a=null,ba=null,pa=0,go=null;function so(){if((Gt&2)!==0&&en!==0)return en&-en;if(Ee.T!==null){var m=mh;return m!==0?m:cw()}return ka()}function ll(){mi===0&&(mi=(en&536870912)===0||oa?Ki():536870912);var m=nc.current;return m!==null&&(m.flags|=32),mi}function za(m,_,C){(m===Yt&&(Pn===2||Pn===9)||m.cancelPendingCommit!==null)&&(ls(m,0),Ha(m,en,mi,!1)),bs(m,C),((Gt&2)===0||m!==Yt)&&(m===Yt&&((Gt&2)===0&&(ji|=C),Tr===4&&Ha(m,en,mi,!1)),Od(m))}function qo(m,_,C){if((Gt&6)!==0)throw Error(r(327));var k=!C&&(_&124)===0&&(_&m.expiredLanes)===0||xr(m,_),W=k?Ep(m,_):Rd(m,_,!0),ie=k;do{if(W===0){rr&&!k&&Ha(m,_,0,!1);break}else{if(C=m.current.alternate,ie&&!Wc(C)){W=Rd(m,_,!1),ie=!1;continue}if(W===2){if(ie=_,m.errorRecoveryDisabledLanes&ie)var Ae=0;else Ae=m.pendingLanes&-536870913,Ae=Ae!==0?Ae:Ae&536870912?536870912:0;if(Ae!==0){_=Ae;e:{var Xe=m;W=os;var Nt=Xe.current.memoizedState.isDehydrated;if(Nt&&(ls(Xe,Ae).flags|=256),Ae=Rd(Xe,Ae,!1),Ae!==2){if(ar&&!Nt){Xe.errorRecoveryDisabledLanes|=ie,ji|=ie,W=4;break e}ie=Fr,Fr=W,ie!==null&&(Fr===null?Fr=ie:Fr.push.apply(Fr,ie))}W=Ae}if(ie=!1,W!==2)continue}}if(W===1){ls(m,0),Ha(m,_,0,!0);break}e:{switch(k=m,ie=W,ie){case 0:case 1:throw Error(r(345));case 4:if((_&4194048)!==_)break;case 6:Ha(k,_,mi,!In);break e;case 2:Fr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((_&62914560)===_&&(W=$i+300-Nn(),10<W)){if(Ha(k,_,mi,!In),Hi(k,0,!0)!==0)break e;k.timeoutHandle=ZT(sc.bind(null,k,C,Fr,ii,Bi,_,mi,ji,Ii,In,ie,2,-0,0),W);break e}sc(k,C,Fr,ii,Bi,_,mi,ji,Ii,In,ie,0,-0,0)}}break}while(!0);Od(m)}function sc(m,_,C,k,W,ie,Ae,Xe,Nt,on,zn,Yn,_n,Tn){if(m.timeoutHandle=-1,Yn=_.subtreeFlags,(Yn&8192||(Yn&16785408)===16785408)&&(Ny={stylesheets:null,count:0,unsuspend:jw},Bt(_),Yn=l2(),Yn!==null)){m.cancelPendingCommit=Yn(BT.bind(null,m,_,ie,C,k,W,Ae,Xe,Nt,zn,1,_n,Tn)),Ha(m,ie,Ae,!on);return}BT(m,_,ie,C,k,W,Ae,Xe,Nt)}function Wc(m){for(var _=m;;){var C=_.tag;if((C===0||C===11||C===15)&&_.flags&16384&&(C=_.updateQueue,C!==null&&(C=C.stores,C!==null)))for(var k=0;k<C.length;k++){var W=C[k],ie=W.getSnapshot;W=W.value;try{if(!_c(ie(),W))return!1}catch{return!1}}if(C=_.child,_.subtreeFlags&16384&&C!==null)C.return=_,_=C;else{if(_===m)break;for(;_.sibling===null;){if(_.return===null||_.return===m)return!0;_=_.return}_.sibling.return=_.return,_=_.sibling}}return!0}function Ha(m,_,C,k){_&=~Lr,_&=~ji,m.suspendedLanes|=_,m.pingedLanes&=~_,k&&(m.warmLanes|=_),k=m.expirationTimes;for(var W=_;0<W;){var ie=31-ze(W),Ae=1<<ie;k[ie]=-1,W&=~Ae}C!==0&&Vr(m,C,_)}function la(){return(Gt&6)===0?(by(0),!1):!0}function ia(){if(Ht!==null){if(Pn===0)var m=Ht.return;else m=Ht,zu=Bc=null,uu(m),Ed=null,wh=0,m=Ht;for(;m!==null;)xy(m.alternate,m),m=m.return;Ht=null}}function ls(m,_){var C=m.timeoutHandle;C!==-1&&(m.timeoutHandle=-1,To(C)),C=m.cancelPendingCommit,C!==null&&(m.cancelPendingCommit=null,C()),ia(),Yt=m,Ht=C=fd(m.current,null),en=_,Pn=0,Kn=null,In=!1,rr=xr(m,_),ar=!1,Ii=mi=Lr=ji=Zr=Tr=0,Fr=os=null,Bi=!1,(_&8)!==0&&(_|=_&32);var k=m.entangledLanes;if(k!==0)for(m=m.entanglements,k&=_;0<k;){var W=31-ze(k),ie=1<<W;_|=m[W],k&=~ie}return Er=_,oh(),C}function Ga(m,_){Ts=null,Ee.H=jd,_===lp||_===Jg?(_=Iv(),Pn=3):_===Dv?(_=Iv(),Pn=4):Pn=_===Zm?8:_!==null&&typeof _=="object"&&typeof _.then=="function"?6:1,Kn=_,Ht===null&&(Tr=1,df(m,mn(_,m.current)))}function So(){var m=Ee.H;return Ee.H=jd,m===null?jd:m}function ma(){var m=Ee.A;return Ee.A=Dt,m}function Vl(){Tr=4,In||(en&4194048)!==en&&nc.current!==null||(rr=!0),(Zr&134217727)===0&&(ji&134217727)===0||Yt===null||Ha(Yt,en,mi,!1)}function Rd(m,_,C){var k=Gt;Gt|=2;var W=So(),ie=ma();(Yt!==m||en!==_)&&(ii=null,ls(m,_)),_=!1;var Ae=Tr;e:do try{if(Pn!==0&&Ht!==null){var Xe=Ht,Nt=Kn;switch(Pn){case 8:ia(),Ae=6;break e;case 3:case 2:case 9:case 6:nc.current===null&&(_=!0);var on=Pn;if(Pn=0,Kn=null,wa(m,Xe,Nt,on),C&&rr){Ae=0;break e}break;default:on=Pn,Pn=0,Kn=null,wa(m,Xe,Nt,on)}}Th(),Ae=Tr;break}catch(zn){Ga(m,zn)}while(!0);return _&&m.shellSuspendCounter++,zu=Bc=null,Gt=k,Ee.H=W,Ee.A=ie,Ht===null&&(Yt=null,en=0,oh()),Ae}function Th(){for(;Ht!==null;)ac(Ht)}function Ep(m,_){var C=Gt;Gt|=2;var k=So(),W=ma();Yt!==m||en!==_?(ii=null,Wi=Nn()+500,ls(m,_)):rr=xr(m,_);e:do try{if(Pn!==0&&Ht!==null){_=Ht;var ie=Kn;t:switch(Pn){case 1:Pn=0,Kn=null,wa(m,_,ie,1);break;case 2:case 9:if(x_(ie)){Pn=0,Kn=null,gu(_);break}_=function(){Pn!==2&&Pn!==9||Yt!==m||(Pn=7),Od(m)},ie.then(_,_);break e;case 3:Pn=7;break e;case 4:Pn=5;break e;case 7:x_(ie)?(Pn=0,Kn=null,gu(_)):(Pn=0,Kn=null,wa(m,_,ie,7));break;case 5:var Ae=null;switch(Ht.tag){case 26:Ae=Ht.memoizedState;case 5:case 27:var Xe=Ht;if(!Ae||hx(Ae)){Pn=0,Kn=null;var Nt=Xe.sibling;if(Nt!==null)Ht=Nt;else{var on=Xe.return;on!==null?(Ht=on,Tl(on)):Ht=null}break t}}Pn=0,Kn=null,wa(m,_,ie,5);break;case 6:Pn=0,Kn=null,wa(m,_,ie,6);break;case 8:ia(),Tr=6;break e;default:throw Error(r(462))}}Cp();break}catch(zn){Ga(m,zn)}while(!0);return zu=Bc=null,Ee.H=k,Ee.A=W,Gt=C,Ht!==null?0:(Yt=null,en=0,oh(),Tr)}function Cp(){for(;Ht!==null&&!Rr();)ac(Ht)}function ac(m){var _=mu(m.alternate,m,Er);m.memoizedProps=m.pendingProps,_===null?Tl(m):Ht=_}function gu(m){var _=m,C=_.alternate;switch(_.tag){case 15:case 0:_=Yv(C,_,_.pendingProps,_.type,void 0,en);break;case 11:_=Yv(C,_,_.pendingProps,_.type.render,_.ref,en);break;case 5:uu(_);default:xy(C,_),_=Ht=qg(_,Er),_=mu(C,_,Er)}m.memoizedProps=m.pendingProps,_===null?Tl(m):Ht=_}function wa(m,_,C,k){zu=Bc=null,uu(_),Ed=null,wh=0;var W=_.return;try{if(T_(m,W,_,C,en)){Tr=1,df(m,mn(C,m.current)),Ht=null;return}}catch(ie){if(W!==null)throw Ht=W,ie;Tr=1,df(m,mn(C,m.current)),Ht=null;return}_.flags&32768?(oa||k===1?m=!0:rr||(en&536870912)!==0?m=!1:(In=m=!0,(k===2||k===9||k===3||k===6)&&(k=nc.current,k!==null&&k.tag===13&&(k.flags|=16384))),Ah(_,m)):Tl(_)}function Tl(m){var _=m;do{if((_.flags&32768)!==0){Ah(_,In);return}m=_.return;var C=nw(_.alternate,_,Er);if(C!==null){Ht=C;return}if(_=_.sibling,_!==null){Ht=_;return}Ht=_=m}while(_!==null);Tr===0&&(Tr=5)}function Ah(m,_){do{var C=E_(m.alternate,m);if(C!==null){C.flags&=32767,Ht=C;return}if(C=m.return,C!==null&&(C.flags|=32768,C.subtreeFlags=0,C.deletions=null),!_&&(m=m.sibling,m!==null)){Ht=m;return}Ht=m=C}while(m!==null);Tr=6,Ht=null}function BT(m,_,C,k,W,ie,Ae,Xe,Nt){m.cancelPendingCommit=null;do N_();while(oi!==0);if((Gt&6)!==0)throw Error(r(327));if(_!==null){if(_===m.current)throw Error(r(177));if(ie=_.lanes|_.childLanes,ie|=ep,Ys(m,C,ie,Ae,Xe,Nt),m===Yt&&(Ht=Yt=null,en=0),Ei=_,js=m,Ui=C,fs=ie,_a=W,ba=k,(_.subtreeFlags&10256)!==0||(_.flags&10256)!==0?(m.callbackNode=null,m.callbackPriority=0,aw(qt,function(){return iw(),null})):(m.callbackNode=null,m.callbackPriority=0),k=(_.flags&13878)!==0,(_.subtreeFlags&13878)!==0||k){k=Ee.T,Ee.T=null,W=it.p,it.p=2,Ae=Gt,Gt|=4;try{v(m,_,C)}finally{Gt=Ae,it.p=W,Ee.T=k}}oi=1,nx(),UT(),rw()}}function nx(){if(oi===1){oi=0;var m=js,_=Ei,C=(_.flags&13878)!==0;if((_.subtreeFlags&13878)!==0||C){C=Ee.T,Ee.T=null;var k=it.p;it.p=2;var W=Gt;Gt|=4;try{ce(_,m);var ie=yw,Ae=Sv(m.containerInfo),Xe=ie.focusedElem,Nt=ie.selectionRange;if(Ae!==Xe&&Xe&&Xe.ownerDocument&&Zh(Xe.ownerDocument.documentElement,Xe)){if(Nt!==null&&Zf(Xe)){var on=Nt.start,zn=Nt.end;if(zn===void 0&&(zn=on),"selectionStart"in Xe)Xe.selectionStart=on,Xe.selectionEnd=Math.min(zn,Xe.value.length);else{var Yn=Xe.ownerDocument||document,_n=Yn&&Yn.defaultView||window;if(_n.getSelection){var Tn=_n.getSelection(),is=Xe.textContent.length,Li=Math.min(Nt.start,is),ja=Nt.end===void 0?Li:Math.min(Nt.end,is);!Tn.extend&&Li>ja&&(Ae=ja,ja=Li,Li=Ae);var Qt=rh(Xe,Li),Ut=rh(Xe,ja);if(Qt&&Ut&&(Tn.rangeCount!==1||Tn.anchorNode!==Qt.node||Tn.anchorOffset!==Qt.offset||Tn.focusNode!==Ut.node||Tn.focusOffset!==Ut.offset)){var ln=Yn.createRange();ln.setStart(Qt.node,Qt.offset),Tn.removeAllRanges(),Li>ja?(Tn.addRange(ln),Tn.extend(Ut.node,Ut.offset)):(ln.setEnd(Ut.node,Ut.offset),Tn.addRange(ln))}}}}for(Yn=[],Tn=Xe;Tn=Tn.parentNode;)Tn.nodeType===1&&Yn.push({element:Tn,left:Tn.scrollLeft,top:Tn.scrollTop});for(typeof Xe.focus=="function"&&Xe.focus(),Xe=0;Xe<Yn.length;Xe++){var Vn=Yn[Xe];Vn.element.scrollLeft=Vn.left,Vn.element.scrollTop=Vn.top}}fx=!!gw,yw=gw=null}finally{Gt=W,it.p=k,Ee.T=C}}m.current=_,oi=2}}function UT(){if(oi===2){oi=0;var m=js,_=Ei,C=(_.flags&8772)!==0;if((_.subtreeFlags&8772)!==0||C){C=Ee.T,Ee.T=null;var k=it.p;it.p=2;var W=Gt;Gt|=4;try{S(m,_.alternate,_)}finally{Gt=W,it.p=k,Ee.T=C}}oi=3}}function rw(){if(oi===4||oi===3){oi=0,qr();var m=js,_=Ei,C=Ui,k=ba;(_.subtreeFlags&10256)!==0||(_.flags&10256)!==0?oi=5:(oi=0,Ei=js=null,rx(m,m.pendingLanes));var W=m.pendingLanes;if(W===0&&(Xi=null),xa(C),_=_.stateNode,$t&&typeof $t.onCommitFiberRoot=="function")try{$t.onCommitFiberRoot(hr,_,void 0,(_.current.flags&128)===128)}catch{}if(k!==null){_=Ee.T,W=it.p,it.p=2,Ee.T=null;try{for(var ie=m.onRecoverableError,Ae=0;Ae<k.length;Ae++){var Xe=k[Ae];ie(Xe.value,{componentStack:Xe.stack})}}finally{Ee.T=_,it.p=W}}(Ui&3)!==0&&N_(),Od(m),W=m.pendingLanes,(C&4194090)!==0&&(W&42)!==0?m===go?pa++:(pa=0,go=m):pa=0,by(0)}}function rx(m,_){(m.pooledCacheLanes&=_)===0&&(_=m.pooledCache,_!=null&&(m.pooledCache=null,ph(_)))}function N_(m){return nx(),UT(),rw(),iw()}function iw(){if(oi!==5)return!1;var m=js,_=fs;fs=0;var C=xa(Ui),k=Ee.T,W=it.p;try{it.p=32>C?32:C,Ee.T=null,C=_a,_a=null;var ie=js,Ae=Ui;if(oi=0,Ei=js=null,Ui=0,(Gt&6)!==0)throw Error(r(331));var Xe=Gt;if(Gt|=4,gn(ie.current),Ue(ie,ie.current,Ae,C),Gt=Xe,by(0,!1),$t&&typeof $t.onPostCommitFiberRoot=="function")try{$t.onPostCommitFiberRoot(hr,ie)}catch{}return!0}finally{it.p=W,Ee.T=k,rx(m,_)}}function VT(m,_,C){_=mn(C,_),_=Wm(m.stateNode,_,2),m=Fl(m,_,2),m!==null&&(bs(m,2),Od(m))}function Da(m,_,C){if(m.tag===3)VT(m,m,C);else for(;_!==null;){if(_.tag===3){VT(_,m,C);break}else if(_.tag===1){var k=_.stateNode;if(typeof _.type.getDerivedStateFromError=="function"||typeof k.componentDidCatch=="function"&&(Xi===null||!Xi.has(k))){m=mn(C,m),C=Xm(2),k=Fl(_,C,2),k!==null&&(py(C,k,_,m),bs(k,2),Od(k));break}}_=_.return}}function Xu(m,_,C){var k=m.pingCache;if(k===null){k=m.pingCache=new At;var W=new Set;k.set(_,W)}else W=k.get(_),W===void 0&&(W=new Set,k.set(_,W));W.has(C)||(ar=!0,W.add(C),m=gf.bind(null,m,_,C),_.then(m,m))}function gf(m,_,C){var k=m.pingCache;k!==null&&k.delete(_),m.pingedLanes|=m.suspendedLanes&C,m.warmLanes&=~C,Yt===m&&(en&C)===C&&(Tr===4||Tr===3&&(en&62914560)===en&&300>Nn()-$i?(Gt&2)===0&&ls(m,0):Lr|=C,Ii===en&&(Ii=0)),Od(m)}function sw(m,_){_===0&&(_=Di()),m=dd(m,_),m!==null&&(bs(m,_),Od(m))}function $T(m){var _=m.memoizedState,C=0;_!==null&&(C=_.retryLane),sw(m,C)}function P_(m,_){var C=0;switch(m.tag){case 13:var k=m.stateNode,W=m.memoizedState;W!==null&&(C=W.retryLane);break;case 19:k=m.stateNode;break;case 22:k=m.stateNode._retryCache;break;default:throw Error(r(314))}k!==null&&k.delete(_),sw(m,C)}function aw(m,_){return zr(m,_)}var Np=null,yf=null,M_=!1,tg=!1,ix=!1,vf=0;function Od(m){m!==yf&&m.next===null&&(yf===null?Np=yf=m:yf=yf.next=m),tg=!0,M_||(M_=!0,lN())}function by(m,_){if(!ix&&tg){ix=!0;do for(var C=!1,k=Np;k!==null;){if(m!==0){var W=k.pendingLanes;if(W===0)var ie=0;else{var Ae=k.suspendedLanes,Xe=k.pingedLanes;ie=(1<<31-ze(42|m)+1)-1,ie&=W&~(Ae&~Xe),ie=ie&201326741?ie&201326741|1:ie?ie|2:0}ie!==0&&(C=!0,qT(k,ie))}else ie=en,ie=Hi(k,k===Yt?ie:0,k.cancelPendingCommit!==null||k.timeoutHandle!==-1),(ie&3)===0||xr(k,ie)||(C=!0,qT(k,ie));k=k.next}while(C);ix=!1}}function Pp(){ow()}function ow(){tg=M_=!1;var m=0;vf!==0&&(ox()&&(m=vf),vf=0);for(var _=Nn(),C=null,k=Np;k!==null;){var W=k.next,ie=R_(k,_);ie===0?(k.next=null,C===null?Np=W:C.next=W,W===null&&(yf=C)):(C=k,(m!==0||(ie&3)!==0)&&(tg=!0)),k=W}by(m)}function R_(m,_){for(var C=m.suspendedLanes,k=m.pingedLanes,W=m.expirationTimes,ie=m.pendingLanes&-62914561;0<ie;){var Ae=31-ze(ie),Xe=1<<Ae,Nt=W[Ae];Nt===-1?((Xe&C)===0||(Xe&k)!==0)&&(W[Ae]=dr(Xe,_)):Nt<=_&&(m.expiredLanes|=Xe),ie&=~Xe}if(_=Yt,C=en,C=Hi(m,m===_?C:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),k=m.callbackNode,C===0||m===_&&(Pn===2||Pn===9)||m.cancelPendingCommit!==null)return k!==null&&k!==null&&or(k),m.callbackNode=null,m.callbackPriority=0;if((C&3)===0||xr(m,C)){if(_=C&-C,_===m.callbackPriority)return _;switch(k!==null&&or(k),xa(C)){case 2:case 8:C=st;break;case 32:C=qt;break;case 268435456:C=Wn;break;default:C=qt}return k=lw.bind(null,m),C=zr(C,k),m.callbackPriority=_,m.callbackNode=C,_}return k!==null&&k!==null&&or(k),m.callbackPriority=2,m.callbackNode=null,2}function lw(m,_){if(oi!==0&&oi!==5)return m.callbackNode=null,m.callbackPriority=0,null;var C=m.callbackNode;if(N_()&&m.callbackNode!==C)return null;var k=en;return k=Hi(m,m===Yt?k:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),k===0?null:(qo(m,k,_),R_(m,Nn()),m.callbackNode!=null&&m.callbackNode===C?lw.bind(null,m):null)}function qT(m,_){if(N_())return null;qo(m,_,!0)}function lN(){YT(function(){(Gt&6)!==0?zr(ui,Pp):ow()})}function cw(){return vf===0&&(vf=Ki()),vf}function uw(m){return m==null||typeof m=="symbol"||typeof m=="boolean"?null:typeof m=="function"?m:wo(""+m)}function dw(m,_){var C=_.ownerDocument.createElement("input");return C.name=_.name,C.value=_.value,m.id&&C.setAttribute("form",m.id),_.parentNode.insertBefore(C,_),m=new FormData(m),C.parentNode.removeChild(C),m}function cN(m,_,C,k,W){if(_==="submit"&&C&&C.stateNode===W){var ie=uw((W[fe]||null).action),Ae=k.submitter;Ae&&(_=(_=Ae[fe]||null)?uw(_.formAction):Ae.getAttribute("formAction"),_!==null&&(ie=_,Ae=null));var Xe=new La("action","action",null,k,W);m.push({event:Xe,listeners:[{instance:null,listener:function(){if(k.defaultPrevented){if(vf!==0){var Nt=Ae?dw(W,Ae):new FormData(W);cy(C,{pending:!0,data:Nt,method:W.method,action:ie},null,Nt)}}else typeof ie=="function"&&(Xe.preventDefault(),Nt=Ae?dw(W,Ae):new FormData(W),cy(C,{pending:!0,data:Nt,method:W.method,action:ie},ie,Nt))},currentTarget:W}]})}}for(var O_=0;O_<Qf.length;O_++){var hw=Qf[O_],uN=hw.toLowerCase(),HT=hw[0].toUpperCase()+hw.slice(1);ro(uN,"on"+HT)}ro(gm,"onAnimationEnd"),ro(cd,"onAnimationIteration"),ro(Kf,"onAnimationStart"),ro("dblclick","onDoubleClick"),ro("focusin","onFocus"),ro("focusout","onBlur"),ro(Lc,"onTransitionRun"),ro(Nv,"onTransitionStart"),ro(Jf,"onTransitionCancel"),ro(Yh,"onTransitionEnd"),Gi("onMouseEnter",["mouseout","mouseover"]),Gi("onMouseLeave",["mouseout","mouseover"]),Gi("onPointerEnter",["pointerout","pointerover"]),Gi("onPointerLeave",["pointerout","pointerover"]),Wr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Wr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Wr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Wr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Wr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Wr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(wy));function fw(m,_){_=(_&4)!==0;for(var C=0;C<m.length;C++){var k=m[C],W=k.event;k=k.listeners;e:{var ie=void 0;if(_)for(var Ae=k.length-1;0<=Ae;Ae--){var Xe=k[Ae],Nt=Xe.instance,on=Xe.currentTarget;if(Xe=Xe.listener,Nt!==ie&&W.isPropagationStopped())break e;ie=Xe,W.currentTarget=on;try{ie(W)}catch(zn){bp(zn)}W.currentTarget=null,ie=Nt}else for(Ae=0;Ae<k.length;Ae++){if(Xe=k[Ae],Nt=Xe.instance,on=Xe.currentTarget,Xe=Xe.listener,Nt!==ie&&W.isPropagationStopped())break e;ie=Xe,W.currentTarget=on;try{ie(W)}catch(zn){bp(zn)}W.currentTarget=null,ie=Nt}}}}function Ls(m,_){var C=_[ke];C===void 0&&(C=_[ke]=new Set);var k=m+"__bubble";C.has(k)||(xf(_,m,2,!1),C.add(k))}function D_(m,_,C){var k=0;_&&(k|=4),xf(C,m,k,_)}var sx="_reactListening"+Math.random().toString(36).slice(2);function ax(m){if(!m[sx]){m[sx]=!0,Qr.forEach(function(C){C!=="selectionchange"&&(GT.has(C)||D_(C,!1,m),D_(C,!0,m))});var _=m.nodeType===9?m:m.ownerDocument;_===null||_[sx]||(_[sx]=!0,D_("selectionchange",!1,_))}}function xf(m,_,C,k){switch(Pw(_)){case 2:var W=Op;break;case 8:W=px;break;default:W=ag}C=W.bind(null,_,C,m),W=void 0,!mc||_!=="touchstart"&&_!=="touchmove"&&_!=="wheel"||(W=!0),k?W!==void 0?m.addEventListener(_,C,{capture:!0,passive:W}):m.addEventListener(_,C,!0):W!==void 0?m.addEventListener(_,C,{passive:W}):m.addEventListener(_,C,!1)}function Oo(m,_,C,k,W){var ie=k;if((_&1)===0&&(_&2)===0&&k!==null)e:for(;;){if(k===null)return;var Ae=k.tag;if(Ae===3||Ae===4){var Xe=k.stateNode.containerInfo;if(Xe===W)break;if(Ae===4)for(Ae=k.return;Ae!==null;){var Nt=Ae.tag;if((Nt===3||Nt===4)&&Ae.stateNode.containerInfo===W)return;Ae=Ae.return}for(;Xe!==null;){if(Ae=nn(Xe),Ae===null)return;if(Nt=Ae.tag,Nt===5||Nt===6||Nt===26||Nt===27){k=ie=Ae;continue e}Xe=Xe.parentNode}}k=k.return}Mu(function(){var on=ie,zn=rl(C),Yn=[];e:{var _n=$g.get(m);if(_n!==void 0){var Tn=La,is=m;switch(m){case"keypress":if(gr(C)===0)break e;case"keydown":case"keyup":Tn=cr;break;case"focusin":is="focus",Tn=Qd;break;case"focusout":is="blur",Tn=Qd;break;case"beforeblur":case"afterblur":Tn=Qd;break;case"click":if(C.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Tn=fm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Tn=vl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Tn=iu;break;case gm:case cd:case Kf:Tn=ns;break;case Yh:Tn=oe;break;case"scroll":case"scrollend":Tn=Ta;break;case"wheel":Tn=lt;break;case"copy":case"cut":case"paste":Tn=eh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Tn=ri;break;case"toggle":case"beforetoggle":Tn=An}var Li=(_&4)!==0,ja=!Li&&(m==="scroll"||m==="scrollend"),Qt=Li?_n!==null?_n+"Capture":null:_n;Li=[];for(var Ut=on,ln;Ut!==null;){var Vn=Ut;if(ln=Vn.stateNode,Vn=Vn.tag,Vn!==5&&Vn!==26&&Vn!==27||ln===null||Qt===null||(Vn=bi(Ut,Qt),Vn!=null&&Li.push(Sy(Ut,Vn,ln))),ja)break;Ut=Ut.return}0<Li.length&&(_n=new Tn(_n,is,null,C,zn),Yn.push({event:_n,listeners:Li}))}}if((_&7)===0){e:{if(_n=m==="mouseover"||m==="pointerover",Tn=m==="mouseout"||m==="pointerout",_n&&C!==$a&&(is=C.relatedTarget||C.fromElement)&&(nn(is)||is[Te]))break e;if((Tn||_n)&&(_n=zn.window===zn?zn:(_n=zn.ownerDocument)?_n.defaultView||_n.parentWindow:window,Tn?(is=C.relatedTarget||C.toElement,Tn=on,is=is?nn(is):null,is!==null&&(ja=f(is),Li=is.tag,is!==ja||Li!==5&&Li!==27&&Li!==6)&&(is=null)):(Tn=null,is=on),Tn!==is)){if(Li=fm,Vn="onMouseLeave",Qt="onMouseEnter",Ut="mouse",(m==="pointerout"||m==="pointerover")&&(Li=ri,Vn="onPointerLeave",Qt="onPointerEnter",Ut="pointer"),ja=Tn==null?_n:ir(Tn),ln=is==null?_n:ir(is),_n=new Li(Vn,Ut+"leave",Tn,C,zn),_n.target=ja,_n.relatedTarget=ln,Vn=null,nn(zn)===on&&(Li=new Li(Qt,Ut+"enter",is,C,zn),Li.target=ln,Li.relatedTarget=ja,Vn=Li),ja=Vn,Tn&&is)t:{for(Li=Tn,Qt=is,Ut=0,ln=Li;ln;ln=Ty(ln))Ut++;for(ln=0,Vn=Qt;Vn;Vn=Ty(Vn))ln++;for(;0<Ut-ln;)Li=Ty(Li),Ut--;for(;0<ln-Ut;)Qt=Ty(Qt),ln--;for(;Ut--;){if(Li===Qt||Qt!==null&&Li===Qt.alternate)break t;Li=Ty(Li),Qt=Ty(Qt)}Li=null}else Li=null;Tn!==null&&WT(Yn,_n,Tn,Li,!1),is!==null&&ja!==null&&WT(Yn,ja,is,Li,!0)}}e:{if(_n=on?ir(on):window,Tn=_n.nodeName&&_n.nodeName.toLowerCase(),Tn==="select"||Tn==="input"&&_n.type==="file")var ti=su;else if(Ll(_n))if(kc)ti=mm;else{ti=Du;var Os=wv}else Tn=_n.nodeName,!Tn||Tn.toLowerCase()!=="input"||_n.type!=="checkbox"&&_n.type!=="radio"?on&&Va(on.elementType)&&(ti=su):ti=il;if(ti&&(ti=ti(m,on))){Pr(Yn,ti,C,zn);break e}Os&&Os(m,_n,on),m==="focusout"&&on&&_n.type==="number"&&on.memoizedProps.value!=null&&zo(_n,"number",_n.value)}switch(Os=on?ir(on):window,m){case"focusin":(Ll(Os)||Os.contentEditable==="true")&&(bc=Os,Av=on,Yf=null);break;case"focusout":Yf=Av=bc=null;break;case"mousedown":jv=!0;break;case"contextmenu":case"mouseup":case"dragend":jv=!1,Ev(Yn,C,zn);break;case"selectionchange":if(Tv)break;case"keydown":case"keyup":Ev(Yn,C,zn)}var wi;if(Xr)e:{switch(m){case"compositionstart":var Yi="onCompositionStart";break e;case"compositionend":Yi="onCompositionEnd";break e;case"compositionupdate":Yi="onCompositionUpdate";break e}Yi=void 0}else uo?Bo(m,C)&&(Yi="onCompositionEnd"):m==="keydown"&&C.keyCode===229&&(Yi="onCompositionStart");Yi&&($s&&C.locale!=="ko"&&(uo||Yi!=="onCompositionStart"?Yi==="onCompositionEnd"&&uo&&(wi=Sr()):(je=zn,ot="value"in je?je.value:je.textContent,uo=!0)),Os=Mp(on,Yi),0<Os.length&&(Yi=new yr(Yi,m,null,C,zn),Yn.push({event:Yi,listeners:Os}),wi?Yi.data=wi:(wi=vc(C),wi!==null&&(Yi.data=wi)))),(wi=Ms?Ou(m,C):ei(m,C))&&(Yi=Mp(on,"onBeforeInput"),0<Yi.length&&(Os=new yr("onBeforeInput","beforeinput",null,C,zn),Yn.push({event:Os,listeners:Yi}),Os.data=wi)),cN(Yn,m,on,C,zn)}fw(Yn,_)})}function Sy(m,_,C){return{instance:m,listener:_,currentTarget:C}}function Mp(m,_){for(var C=_+"Capture",k=[];m!==null;){var W=m,ie=W.stateNode;if(W=W.tag,W!==5&&W!==26&&W!==27||ie===null||(W=bi(m,C),W!=null&&k.unshift(Sy(m,W,ie)),W=bi(m,_),W!=null&&k.push(Sy(m,W,ie))),m.tag===3)return k;m=m.return}return[]}function Ty(m){if(m===null)return null;do m=m.return;while(m&&m.tag!==5&&m.tag!==27);return m||null}function WT(m,_,C,k,W){for(var ie=_._reactName,Ae=[];C!==null&&C!==k;){var Xe=C,Nt=Xe.alternate,on=Xe.stateNode;if(Xe=Xe.tag,Nt!==null&&Nt===k)break;Xe!==5&&Xe!==26&&Xe!==27||on===null||(Nt=on,W?(on=bi(C,ie),on!=null&&Ae.unshift(Sy(C,on,Nt))):W||(on=bi(C,ie),on!=null&&Ae.push(Sy(C,on,Nt)))),C=C.return}Ae.length!==0&&m.push({event:_,listeners:Ae})}var dN=/\r\n?/g,hN=/\u0000|\uFFFD/g;function ng(m){return(typeof m=="string"?m:""+m).replace(dN,`
`).replace(hN,"")}function pw(m,_){return _=ng(_),ng(m)===_}function jh(){}function ga(m,_,C,k,W,ie){switch(C){case"children":typeof k=="string"?_==="body"||_==="textarea"&&k===""||to(m,k):(typeof k=="number"||typeof k=="bigint")&&_!=="body"&&to(m,""+k);break;case"className":di(m,"class",k);break;case"tabIndex":di(m,"tabindex",k);break;case"dir":case"role":case"viewBox":case"width":case"height":di(m,C,k);break;case"style":pc(m,k,ie);break;case"data":if(_!=="object"){di(m,"data",k);break}case"src":case"href":if(k===""&&(_!=="a"||C!=="href")){m.removeAttribute(C);break}if(k==null||typeof k=="function"||typeof k=="symbol"||typeof k=="boolean"){m.removeAttribute(C);break}k=wo(""+k),m.setAttribute(C,k);break;case"action":case"formAction":if(typeof k=="function"){m.setAttribute(C,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof ie=="function"&&(C==="formAction"?(_!=="input"&&ga(m,_,"name",W.name,W,null),ga(m,_,"formEncType",W.formEncType,W,null),ga(m,_,"formMethod",W.formMethod,W,null),ga(m,_,"formTarget",W.formTarget,W,null)):(ga(m,_,"encType",W.encType,W,null),ga(m,_,"method",W.method,W,null),ga(m,_,"target",W.target,W,null)));if(k==null||typeof k=="symbol"||typeof k=="boolean"){m.removeAttribute(C);break}k=wo(""+k),m.setAttribute(C,k);break;case"onClick":k!=null&&(m.onclick=jh);break;case"onScroll":k!=null&&Ls("scroll",m);break;case"onScrollEnd":k!=null&&Ls("scrollend",m);break;case"dangerouslySetInnerHTML":if(k!=null){if(typeof k!="object"||!("__html"in k))throw Error(r(61));if(C=k.__html,C!=null){if(W.children!=null)throw Error(r(60));m.innerHTML=C}}break;case"multiple":m.multiple=k&&typeof k!="function"&&typeof k!="symbol";break;case"muted":m.muted=k&&typeof k!="function"&&typeof k!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(k==null||typeof k=="function"||typeof k=="boolean"||typeof k=="symbol"){m.removeAttribute("xlink:href");break}C=wo(""+k),m.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",C);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":k!=null&&typeof k!="function"&&typeof k!="symbol"?m.setAttribute(C,""+k):m.removeAttribute(C);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":k&&typeof k!="function"&&typeof k!="symbol"?m.setAttribute(C,""):m.removeAttribute(C);break;case"capture":case"download":k===!0?m.setAttribute(C,""):k!==!1&&k!=null&&typeof k!="function"&&typeof k!="symbol"?m.setAttribute(C,k):m.removeAttribute(C);break;case"cols":case"rows":case"size":case"span":k!=null&&typeof k!="function"&&typeof k!="symbol"&&!isNaN(k)&&1<=k?m.setAttribute(C,k):m.removeAttribute(C);break;case"rowSpan":case"start":k==null||typeof k=="function"||typeof k=="symbol"||isNaN(k)?m.removeAttribute(C):m.setAttribute(C,k);break;case"popover":Ls("beforetoggle",m),Ls("toggle",m),fr(m,"popover",k);break;case"xlinkActuate":wr(m,"http://www.w3.org/1999/xlink","xlink:actuate",k);break;case"xlinkArcrole":wr(m,"http://www.w3.org/1999/xlink","xlink:arcrole",k);break;case"xlinkRole":wr(m,"http://www.w3.org/1999/xlink","xlink:role",k);break;case"xlinkShow":wr(m,"http://www.w3.org/1999/xlink","xlink:show",k);break;case"xlinkTitle":wr(m,"http://www.w3.org/1999/xlink","xlink:title",k);break;case"xlinkType":wr(m,"http://www.w3.org/1999/xlink","xlink:type",k);break;case"xmlBase":wr(m,"http://www.w3.org/XML/1998/namespace","xml:base",k);break;case"xmlLang":wr(m,"http://www.w3.org/XML/1998/namespace","xml:lang",k);break;case"xmlSpace":wr(m,"http://www.w3.org/XML/1998/namespace","xml:space",k);break;case"is":fr(m,"is",k);break;case"innerText":case"textContent":break;default:(!(2<C.length)||C[0]!=="o"&&C[0]!=="O"||C[1]!=="n"&&C[1]!=="N")&&(C=nl.get(C)||C,fr(m,C,k))}}function mw(m,_,C,k,W,ie){switch(C){case"style":pc(m,k,ie);break;case"dangerouslySetInnerHTML":if(k!=null){if(typeof k!="object"||!("__html"in k))throw Error(r(61));if(C=k.__html,C!=null){if(W.children!=null)throw Error(r(60));m.innerHTML=C}}break;case"children":typeof k=="string"?to(m,k):(typeof k=="number"||typeof k=="bigint")&&to(m,""+k);break;case"onScroll":k!=null&&Ls("scroll",m);break;case"onScrollEnd":k!=null&&Ls("scrollend",m);break;case"onClick":k!=null&&(m.onclick=jh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Gr.hasOwnProperty(C))e:{if(C[0]==="o"&&C[1]==="n"&&(W=C.endsWith("Capture"),_=C.slice(2,W?C.length-7:void 0),ie=m[fe]||null,ie=ie!=null?ie[C]:null,typeof ie=="function"&&m.removeEventListener(_,ie,W),typeof k=="function")){typeof ie!="function"&&ie!==null&&(C in m?m[C]=null:m.hasAttribute(C)&&m.removeAttribute(C)),m.addEventListener(_,k,W);break e}C in m?m[C]=k:k===!0?m.setAttribute(C,""):fr(m,C,k)}}}function $l(m,_,C){switch(_){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ls("error",m),Ls("load",m);var k=!1,W=!1,ie;for(ie in C)if(C.hasOwnProperty(ie)){var Ae=C[ie];if(Ae!=null)switch(ie){case"src":k=!0;break;case"srcSet":W=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,_));default:ga(m,_,ie,Ae,C,null)}}W&&ga(m,_,"srcSet",C.srcSet,C,null),k&&ga(m,_,"src",C.src,C,null);return;case"input":Ls("invalid",m);var Xe=ie=Ae=W=null,Nt=null,on=null;for(k in C)if(C.hasOwnProperty(k)){var zn=C[k];if(zn!=null)switch(k){case"name":W=zn;break;case"type":Ae=zn;break;case"checked":Nt=zn;break;case"defaultChecked":on=zn;break;case"value":ie=zn;break;case"defaultValue":Xe=zn;break;case"children":case"dangerouslySetInnerHTML":if(zn!=null)throw Error(r(137,_));break;default:ga(m,_,k,zn,C,null)}}co(m,ie,Xe,Nt,on,Ae,W,!1),hc(m);return;case"select":Ls("invalid",m),k=Ae=ie=null;for(W in C)if(C.hasOwnProperty(W)&&(Xe=C[W],Xe!=null))switch(W){case"value":ie=Xe;break;case"defaultValue":Ae=Xe;break;case"multiple":k=Xe;default:ga(m,_,W,Xe,C,null)}_=ie,C=Ae,m.multiple=!!k,_!=null?Za(m,!!k,_,!1):C!=null&&Za(m,!!k,C,!0);return;case"textarea":Ls("invalid",m),ie=W=k=null;for(Ae in C)if(C.hasOwnProperty(Ae)&&(Xe=C[Ae],Xe!=null))switch(Ae){case"value":k=Xe;break;case"defaultValue":W=Xe;break;case"children":ie=Xe;break;case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(r(91));break;default:ga(m,_,Ae,Xe,C,null)}Po(m,k,W,ie),hc(m);return;case"option":for(Nt in C)if(C.hasOwnProperty(Nt)&&(k=C[Nt],k!=null))switch(Nt){case"selected":m.selected=k&&typeof k!="function"&&typeof k!="symbol";break;default:ga(m,_,Nt,k,C,null)}return;case"dialog":Ls("beforetoggle",m),Ls("toggle",m),Ls("cancel",m),Ls("close",m);break;case"iframe":case"object":Ls("load",m);break;case"video":case"audio":for(k=0;k<wy.length;k++)Ls(wy[k],m);break;case"image":Ls("error",m),Ls("load",m);break;case"details":Ls("toggle",m);break;case"embed":case"source":case"link":Ls("error",m),Ls("load",m);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(on in C)if(C.hasOwnProperty(on)&&(k=C[on],k!=null))switch(on){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,_));default:ga(m,_,on,k,C,null)}return;default:if(Va(_)){for(zn in C)C.hasOwnProperty(zn)&&(k=C[zn],k!==void 0&&mw(m,_,zn,k,C,void 0));return}}for(Xe in C)C.hasOwnProperty(Xe)&&(k=C[Xe],k!=null&&ga(m,_,Xe,k,C,null))}function fN(m,_,C,k){switch(_){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var W=null,ie=null,Ae=null,Xe=null,Nt=null,on=null,zn=null;for(Tn in C){var Yn=C[Tn];if(C.hasOwnProperty(Tn)&&Yn!=null)switch(Tn){case"checked":break;case"value":break;case"defaultValue":Nt=Yn;default:k.hasOwnProperty(Tn)||ga(m,_,Tn,null,k,Yn)}}for(var _n in k){var Tn=k[_n];if(Yn=C[_n],k.hasOwnProperty(_n)&&(Tn!=null||Yn!=null))switch(_n){case"type":ie=Tn;break;case"name":W=Tn;break;case"checked":on=Tn;break;case"defaultChecked":zn=Tn;break;case"value":Ae=Tn;break;case"defaultValue":Xe=Tn;break;case"children":case"dangerouslySetInnerHTML":if(Tn!=null)throw Error(r(137,_));break;default:Tn!==Yn&&ga(m,_,_n,Tn,k,Yn)}}sd(m,Ae,Xe,Nt,on,zn,ie,W);return;case"select":Tn=Ae=Xe=_n=null;for(ie in C)if(Nt=C[ie],C.hasOwnProperty(ie)&&Nt!=null)switch(ie){case"value":break;case"multiple":Tn=Nt;default:k.hasOwnProperty(ie)||ga(m,_,ie,null,k,Nt)}for(W in k)if(ie=k[W],Nt=C[W],k.hasOwnProperty(W)&&(ie!=null||Nt!=null))switch(W){case"value":_n=ie;break;case"defaultValue":Xe=ie;break;case"multiple":Ae=ie;default:ie!==Nt&&ga(m,_,W,ie,k,Nt)}_=Xe,C=Ae,k=Tn,_n!=null?Za(m,!!C,_n,!1):!!k!=!!C&&(_!=null?Za(m,!!C,_,!0):Za(m,!!C,C?[]:"",!1));return;case"textarea":Tn=_n=null;for(Xe in C)if(W=C[Xe],C.hasOwnProperty(Xe)&&W!=null&&!k.hasOwnProperty(Xe))switch(Xe){case"value":break;case"children":break;default:ga(m,_,Xe,null,k,W)}for(Ae in k)if(W=k[Ae],ie=C[Ae],k.hasOwnProperty(Ae)&&(W!=null||ie!=null))switch(Ae){case"value":_n=W;break;case"defaultValue":Tn=W;break;case"children":break;case"dangerouslySetInnerHTML":if(W!=null)throw Error(r(91));break;default:W!==ie&&ga(m,_,Ae,W,k,ie)}Zo(m,_n,Tn);return;case"option":for(var is in C)if(_n=C[is],C.hasOwnProperty(is)&&_n!=null&&!k.hasOwnProperty(is))switch(is){case"selected":m.selected=!1;break;default:ga(m,_,is,null,k,_n)}for(Nt in k)if(_n=k[Nt],Tn=C[Nt],k.hasOwnProperty(Nt)&&_n!==Tn&&(_n!=null||Tn!=null))switch(Nt){case"selected":m.selected=_n&&typeof _n!="function"&&typeof _n!="symbol";break;default:ga(m,_,Nt,_n,k,Tn)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Li in C)_n=C[Li],C.hasOwnProperty(Li)&&_n!=null&&!k.hasOwnProperty(Li)&&ga(m,_,Li,null,k,_n);for(on in k)if(_n=k[on],Tn=C[on],k.hasOwnProperty(on)&&_n!==Tn&&(_n!=null||Tn!=null))switch(on){case"children":case"dangerouslySetInnerHTML":if(_n!=null)throw Error(r(137,_));break;default:ga(m,_,on,_n,k,Tn)}return;default:if(Va(_)){for(var ja in C)_n=C[ja],C.hasOwnProperty(ja)&&_n!==void 0&&!k.hasOwnProperty(ja)&&mw(m,_,ja,void 0,k,_n);for(zn in k)_n=k[zn],Tn=C[zn],!k.hasOwnProperty(zn)||_n===Tn||_n===void 0&&Tn===void 0||mw(m,_,zn,_n,k,Tn);return}}for(var Qt in C)_n=C[Qt],C.hasOwnProperty(Qt)&&_n!=null&&!k.hasOwnProperty(Qt)&&ga(m,_,Qt,null,k,_n);for(Yn in k)_n=k[Yn],Tn=C[Yn],!k.hasOwnProperty(Yn)||_n===Tn||_n==null&&Tn==null||ga(m,_,Yn,_n,k,Tn)}var gw=null,yw=null;function k_(m){return m.nodeType===9?m:m.ownerDocument}function XT(m){switch(m){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function I_(m,_){if(m===0)switch(_){case"svg":return 1;case"math":return 2;default:return 0}return m===1&&_==="foreignObject"?0:m}function vw(m,_){return m==="textarea"||m==="noscript"||typeof _.children=="string"||typeof _.children=="number"||typeof _.children=="bigint"||typeof _.dangerouslySetInnerHTML=="object"&&_.dangerouslySetInnerHTML!==null&&_.dangerouslySetInnerHTML.__html!=null}var L_=null;function ox(){var m=window.event;return m&&m.type==="popstate"?m===L_?!1:(L_=m,!0):(L_=null,!1)}var ZT=typeof setTimeout=="function"?setTimeout:void 0,To=typeof clearTimeout=="function"?clearTimeout:void 0,rg=typeof Promise=="function"?Promise:void 0,YT=typeof queueMicrotask=="function"?queueMicrotask:typeof rg<"u"?function(m){return rg.resolve(null).then(m).catch(z_)}:ZT;function z_(m){setTimeout(function(){throw m})}function Dd(m){return m==="head"}function Ay(m,_){var C=_,k=0,W=0;do{var ie=C.nextSibling;if(m.removeChild(C),ie&&ie.nodeType===8)if(C=ie.data,C==="/$"){if(0<k&&8>k){C=k;var Ae=m.ownerDocument;if(C&1&&jy(Ae.documentElement),C&2&&jy(Ae.body),C&4)for(C=Ae.head,jy(C),Ae=C.firstChild;Ae;){var Xe=Ae.nextSibling,Nt=Ae.nodeName;Ae[ht]||Nt==="SCRIPT"||Nt==="STYLE"||Nt==="LINK"&&Ae.rel.toLowerCase()==="stylesheet"||C.removeChild(Ae),Ae=Xe}}if(W===0){m.removeChild(ie),Ld(_);return}W--}else C==="$"||C==="$?"||C==="$!"?W++:k=C.charCodeAt(0)-48;else k=0;C=ie}while(C);Ld(_)}function F_(m){var _=m.firstChild;for(_&&_.nodeType===10&&(_=_.nextSibling);_;){var C=_;switch(_=_.nextSibling,C.nodeName){case"HTML":case"HEAD":case"BODY":F_(C),St(C);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(C.rel.toLowerCase()==="stylesheet")continue}m.removeChild(C)}}function KT(m,_,C,k){for(;m.nodeType===1;){var W=C;if(m.nodeName.toLowerCase()!==_.toLowerCase()){if(!k&&(m.nodeName!=="INPUT"||m.type!=="hidden"))break}else if(k){if(!m[ht])switch(_){case"meta":if(!m.hasAttribute("itemprop"))break;return m;case"link":if(ie=m.getAttribute("rel"),ie==="stylesheet"&&m.hasAttribute("data-precedence"))break;if(ie!==W.rel||m.getAttribute("href")!==(W.href==null||W.href===""?null:W.href)||m.getAttribute("crossorigin")!==(W.crossOrigin==null?null:W.crossOrigin)||m.getAttribute("title")!==(W.title==null?null:W.title))break;return m;case"style":if(m.hasAttribute("data-precedence"))break;return m;case"script":if(ie=m.getAttribute("src"),(ie!==(W.src==null?null:W.src)||m.getAttribute("type")!==(W.type==null?null:W.type)||m.getAttribute("crossorigin")!==(W.crossOrigin==null?null:W.crossOrigin))&&ie&&m.hasAttribute("async")&&!m.hasAttribute("itemprop"))break;return m;default:return m}}else if(_==="input"&&m.type==="hidden"){var ie=W.name==null?null:""+W.name;if(W.type==="hidden"&&m.getAttribute("name")===ie)return m}else return m;if(m=kd(m.nextSibling),m===null)break}return null}function lx(m,_,C){if(_==="")return null;for(;m.nodeType!==3;)if((m.nodeType!==1||m.nodeName!=="INPUT"||m.type!=="hidden")&&!C||(m=kd(m.nextSibling),m===null))return null;return m}function cx(m){return m.data==="$!"||m.data==="$?"&&m.ownerDocument.readyState==="complete"}function ux(m,_){var C=m.ownerDocument;if(m.data!=="$?"||C.readyState==="complete")_();else{var k=function(){_(),C.removeEventListener("DOMContentLoaded",k)};C.addEventListener("DOMContentLoaded",k),m._reactRetry=k}}function kd(m){for(;m!=null;m=m.nextSibling){var _=m.nodeType;if(_===1||_===3)break;if(_===8){if(_=m.data,_==="$"||_==="$!"||_==="$?"||_==="F!"||_==="F")break;if(_==="/$")return null}}return m}var B_=null;function U_(m){m=m.previousSibling;for(var _=0;m;){if(m.nodeType===8){var C=m.data;if(C==="$"||C==="$!"||C==="$?"){if(_===0)return m;_--}else C==="/$"&&_++}m=m.previousSibling}return null}function V_(m,_,C){switch(_=k_(C),m){case"html":if(m=_.documentElement,!m)throw Error(r(452));return m;case"head":if(m=_.head,!m)throw Error(r(453));return m;case"body":if(m=_.body,!m)throw Error(r(454));return m;default:throw Error(r(451))}}function jy(m){for(var _=m.attributes;_.length;)m.removeAttributeNode(_[0]);St(m)}var Al=new Map,JT=new Set;function jl(m){return typeof m.getRootNode=="function"?m.getRootNode():m.nodeType===9?m:m.ownerDocument}var Eh=it.d;it.d={f:QT,r:e2,D:pN,C:xw,L:n2,m:_w,X:r2,S:bw,M:i2};function QT(){var m=Eh.f(),_=la();return m||_}function e2(m){var _=Kt(m);_!==null&&_.tag===5&&_.type==="form"?vp(_):Eh.r(m)}var _f=typeof document>"u"?null:document;function t2(m,_,C){var k=_f;if(k&&typeof _=="string"&&_){var W=Xa(_);W='link[rel="'+m+'"][href="'+W+'"]',typeof C=="string"&&(W+='[crossorigin="'+C+'"]'),JT.has(W)||(JT.add(W),m={rel:m,crossOrigin:C,href:_},k.querySelector(W)===null&&(_=k.createElement("link"),$l(_,"link",m),pr(_),k.head.appendChild(_)))}}function pN(m){Eh.D(m),t2("dns-prefetch",m,null)}function xw(m,_){Eh.C(m,_),t2("preconnect",m,_)}function n2(m,_,C){Eh.L(m,_,C);var k=_f;if(k&&m&&_){var W='link[rel="preload"][as="'+Xa(_)+'"]';_==="image"&&C&&C.imageSrcSet?(W+='[imagesrcset="'+Xa(C.imageSrcSet)+'"]',typeof C.imageSizes=="string"&&(W+='[imagesizes="'+Xa(C.imageSizes)+'"]')):W+='[href="'+Xa(m)+'"]';var ie=W;switch(_){case"style":ie=ig(m);break;case"script":ie=Ey(m)}Al.has(ie)||(m=E({rel:"preload",href:_==="image"&&C&&C.imageSrcSet?void 0:m,as:_},C),Al.set(ie,m),k.querySelector(W)!==null||_==="style"&&k.querySelector(Rp(ie))||_==="script"&&k.querySelector(dx(ie))||(_=k.createElement("link"),$l(_,"link",m),pr(_),k.head.appendChild(_)))}}function _w(m,_){Eh.m(m,_);var C=_f;if(C&&m){var k=_&&typeof _.as=="string"?_.as:"script",W='link[rel="modulepreload"][as="'+Xa(k)+'"][href="'+Xa(m)+'"]',ie=W;switch(k){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":ie=Ey(m)}if(!Al.has(ie)&&(m=E({rel:"modulepreload",href:m},_),Al.set(ie,m),C.querySelector(W)===null)){switch(k){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(C.querySelector(dx(ie)))return}k=C.createElement("link"),$l(k,"link",m),pr(k),C.head.appendChild(k)}}}function bw(m,_,C){Eh.S(m,_,C);var k=_f;if(k&&m){var W=br(k).hoistableStyles,ie=ig(m);_=_||"default";var Ae=W.get(ie);if(!Ae){var Xe={loading:0,preload:null};if(Ae=k.querySelector(Rp(ie)))Xe.loading=5;else{m=E({rel:"stylesheet",href:m,"data-precedence":_},C),(C=Al.get(ie))&&Sw(m,C);var Nt=Ae=k.createElement("link");pr(Nt),$l(Nt,"link",m),Nt._p=new Promise(function(on,zn){Nt.onload=on,Nt.onerror=zn}),Nt.addEventListener("load",function(){Xe.loading|=1}),Nt.addEventListener("error",function(){Xe.loading|=2}),Xe.loading|=4,$_(Ae,_,k)}Ae={type:"stylesheet",instance:Ae,count:1,state:Xe},W.set(ie,Ae)}}}function r2(m,_){Eh.X(m,_);var C=_f;if(C&&m){var k=br(C).hoistableScripts,W=Ey(m),ie=k.get(W);ie||(ie=C.querySelector(dx(W)),ie||(m=E({src:m,async:!0},_),(_=Al.get(W))&&Tw(m,_),ie=C.createElement("script"),pr(ie),$l(ie,"link",m),C.head.appendChild(ie)),ie={type:"script",instance:ie,count:1,state:null},k.set(W,ie))}}function i2(m,_){Eh.M(m,_);var C=_f;if(C&&m){var k=br(C).hoistableScripts,W=Ey(m),ie=k.get(W);ie||(ie=C.querySelector(dx(W)),ie||(m=E({src:m,async:!0,type:"module"},_),(_=Al.get(W))&&Tw(m,_),ie=C.createElement("script"),pr(ie),$l(ie,"link",m),C.head.appendChild(ie)),ie={type:"script",instance:ie,count:1,state:null},k.set(W,ie))}}function ww(m,_,C,k){var W=(W=Ot.current)?jl(W):null;if(!W)throw Error(r(446));switch(m){case"meta":case"title":return null;case"style":return typeof C.precedence=="string"&&typeof C.href=="string"?(_=ig(C.href),C=br(W).hoistableStyles,k=C.get(_),k||(k={type:"style",instance:null,count:0,state:null},C.set(_,k)),k):{type:"void",instance:null,count:0,state:null};case"link":if(C.rel==="stylesheet"&&typeof C.href=="string"&&typeof C.precedence=="string"){m=ig(C.href);var ie=br(W).hoistableStyles,Ae=ie.get(m);if(Ae||(W=W.ownerDocument||W,Ae={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},ie.set(m,Ae),(ie=W.querySelector(Rp(m)))&&!ie._p&&(Ae.instance=ie,Ae.state.loading=5),Al.has(m)||(C={rel:"preload",as:"style",href:C.href,crossOrigin:C.crossOrigin,integrity:C.integrity,media:C.media,hrefLang:C.hrefLang,referrerPolicy:C.referrerPolicy},Al.set(m,C),ie||s2(W,m,C,Ae.state))),_&&k===null)throw Error(r(528,""));return Ae}if(_&&k!==null)throw Error(r(529,""));return null;case"script":return _=C.async,C=C.src,typeof C=="string"&&_&&typeof _!="function"&&typeof _!="symbol"?(_=Ey(C),C=br(W).hoistableScripts,k=C.get(_),k||(k={type:"script",instance:null,count:0,state:null},C.set(_,k)),k):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,m))}}function ig(m){return'href="'+Xa(m)+'"'}function Rp(m){return'link[rel="stylesheet"]['+m+"]"}function Id(m){return E({},m,{"data-precedence":m.precedence,precedence:null})}function s2(m,_,C,k){m.querySelector('link[rel="preload"][as="style"]['+_+"]")?k.loading=1:(_=m.createElement("link"),k.preload=_,_.addEventListener("load",function(){return k.loading|=1}),_.addEventListener("error",function(){return k.loading|=2}),$l(_,"link",C),pr(_),m.head.appendChild(_))}function Ey(m){return'[src="'+Xa(m)+'"]'}function dx(m){return"script[async]"+m}function a2(m,_,C){if(_.count++,_.instance===null)switch(_.type){case"style":var k=m.querySelector('style[data-href~="'+Xa(C.href)+'"]');if(k)return _.instance=k,pr(k),k;var W=E({},C,{"data-href":C.href,"data-precedence":C.precedence,href:null,precedence:null});return k=(m.ownerDocument||m).createElement("style"),pr(k),$l(k,"style",W),$_(k,C.precedence,m),_.instance=k;case"stylesheet":W=ig(C.href);var ie=m.querySelector(Rp(W));if(ie)return _.state.loading|=4,_.instance=ie,pr(ie),ie;k=Id(C),(W=Al.get(W))&&Sw(k,W),ie=(m.ownerDocument||m).createElement("link"),pr(ie);var Ae=ie;return Ae._p=new Promise(function(Xe,Nt){Ae.onload=Xe,Ae.onerror=Nt}),$l(ie,"link",k),_.state.loading|=4,$_(ie,C.precedence,m),_.instance=ie;case"script":return ie=Ey(C.src),(W=m.querySelector(dx(ie)))?(_.instance=W,pr(W),W):(k=C,(W=Al.get(ie))&&(k=E({},C),Tw(k,W)),m=m.ownerDocument||m,W=m.createElement("script"),pr(W),$l(W,"link",k),m.head.appendChild(W),_.instance=W);case"void":return null;default:throw Error(r(443,_.type))}else _.type==="stylesheet"&&(_.state.loading&4)===0&&(k=_.instance,_.state.loading|=4,$_(k,C.precedence,m));return _.instance}function $_(m,_,C){for(var k=C.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),W=k.length?k[k.length-1]:null,ie=W,Ae=0;Ae<k.length;Ae++){var Xe=k[Ae];if(Xe.dataset.precedence===_)ie=Xe;else if(ie!==W)break}ie?ie.parentNode.insertBefore(m,ie.nextSibling):(_=C.nodeType===9?C.head:C,_.insertBefore(m,_.firstChild))}function Sw(m,_){m.crossOrigin==null&&(m.crossOrigin=_.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=_.referrerPolicy),m.title==null&&(m.title=_.title)}function Tw(m,_){m.crossOrigin==null&&(m.crossOrigin=_.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=_.referrerPolicy),m.integrity==null&&(m.integrity=_.integrity)}var q_=null;function Cy(m,_,C){if(q_===null){var k=new Map,W=q_=new Map;W.set(C,k)}else W=q_,k=W.get(C),k||(k=new Map,W.set(C,k));if(k.has(m))return k;for(k.set(m,null),C=C.getElementsByTagName(m),W=0;W<C.length;W++){var ie=C[W];if(!(ie[ht]||ie[Q]||m==="link"&&ie.getAttribute("rel")==="stylesheet")&&ie.namespaceURI!=="http://www.w3.org/2000/svg"){var Ae=ie.getAttribute(_)||"";Ae=m+Ae;var Xe=k.get(Ae);Xe?Xe.push(ie):k.set(Ae,[ie])}}return k}function Aw(m,_,C){m=m.ownerDocument||m,m.head.insertBefore(C,_==="title"?m.querySelector("head > title"):null)}function o2(m,_,C){if(C===1||_.itemProp!=null)return!1;switch(m){case"meta":case"title":return!0;case"style":if(typeof _.precedence!="string"||typeof _.href!="string"||_.href==="")break;return!0;case"link":if(typeof _.rel!="string"||typeof _.href!="string"||_.href===""||_.onLoad||_.onError)break;switch(_.rel){case"stylesheet":return m=_.disabled,typeof _.precedence=="string"&&m==null;default:return!0}case"script":if(_.async&&typeof _.async!="function"&&typeof _.async!="symbol"&&!_.onLoad&&!_.onError&&_.src&&typeof _.src=="string")return!0}return!1}function hx(m){return!(m.type==="stylesheet"&&(m.state.loading&3)===0)}var Ny=null;function jw(){}function H_(m,_,C){if(Ny===null)throw Error(r(475));var k=Ny;if(_.type==="stylesheet"&&(typeof C.media!="string"||matchMedia(C.media).matches!==!1)&&(_.state.loading&4)===0){if(_.instance===null){var W=ig(C.href),ie=m.querySelector(Rp(W));if(ie){m=ie._p,m!==null&&typeof m=="object"&&typeof m.then=="function"&&(k.count++,k=G_.bind(k),m.then(k,k)),_.state.loading|=4,_.instance=ie,pr(ie);return}ie=m.ownerDocument||m,C=Id(C),(W=Al.get(W))&&Sw(C,W),ie=ie.createElement("link"),pr(ie);var Ae=ie;Ae._p=new Promise(function(Xe,Nt){Ae.onload=Xe,Ae.onerror=Nt}),$l(ie,"link",C),_.instance=ie}k.stylesheets===null&&(k.stylesheets=new Map),k.stylesheets.set(_,m),(m=_.state.preload)&&(_.state.loading&3)===0&&(k.count++,_=G_.bind(k),m.addEventListener("load",_),m.addEventListener("error",_))}}function l2(){if(Ny===null)throw Error(r(475));var m=Ny;return m.stylesheets&&m.count===0&&W_(m,m.stylesheets),0<m.count?function(_){var C=setTimeout(function(){if(m.stylesheets&&W_(m,m.stylesheets),m.unsuspend){var k=m.unsuspend;m.unsuspend=null,k()}},6e4);return m.unsuspend=_,function(){m.unsuspend=null,clearTimeout(C)}}:null}function G_(){if(this.count--,this.count===0){if(this.stylesheets)W_(this,this.stylesheets);else if(this.unsuspend){var m=this.unsuspend;this.unsuspend=null,m()}}}var Py=null;function W_(m,_){m.stylesheets=null,m.unsuspend!==null&&(m.count++,Py=new Map,_.forEach(c2,m),Py=null,G_.call(m))}function c2(m,_){if(!(_.state.loading&4)){var C=Py.get(m);if(C)var k=C.get(null);else{C=new Map,Py.set(m,C);for(var W=m.querySelectorAll("link[data-precedence],style[data-precedence]"),ie=0;ie<W.length;ie++){var Ae=W[ie];(Ae.nodeName==="LINK"||Ae.getAttribute("media")!=="not all")&&(C.set(Ae.dataset.precedence,Ae),k=Ae)}k&&C.set(null,k)}W=_.instance,Ae=W.getAttribute("data-precedence"),ie=C.get(Ae)||k,ie===k&&C.set(null,W),C.set(Ae,W),this.count++,k=G_.bind(this),W.addEventListener("load",k),W.addEventListener("error",k),ie?ie.parentNode.insertBefore(W,ie.nextSibling):(m=m.nodeType===9?m.head:m,m.insertBefore(W,m.firstChild)),_.state.loading|=4}}var sg={$$typeof:X,Provider:null,Consumer:null,_currentValue:et,_currentValue2:et,_threadCount:0};function Ew(m,_,C,k,W,ie,Ae,Xe){this.tag=1,this.containerInfo=m,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ji(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ji(0),this.hiddenUpdates=Ji(null),this.identifierPrefix=k,this.onUncaughtError=W,this.onCaughtError=ie,this.onRecoverableError=Ae,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Xe,this.incompleteTransitions=new Map}function Cw(m,_,C,k,W,ie,Ae,Xe,Nt,on,zn,Yn){return m=new Ew(m,_,C,Ae,Xe,Nt,on,Yn),_=1,ie===!0&&(_|=24),ie=wc(3,null,null,_),m.current=ie,ie.stateNode=m,_=Tm(),_.refCount++,m.pooledCache=_,_.refCount++,ie.memoizedState={element:k,isDehydrated:C,cache:_},ey(ie),m}function X_(m){return m?(m=_l,m):_l}function u2(m,_,C,k,W,ie){W=X_(W),k.context===null?k.context=W:k.pendingContext=W,k=lu(_),k.payload={element:C},ie=ie===void 0?null:ie,ie!==null&&(k.callback=ie),C=Fl(m,k,_),C!==null&&(za(C,m,_),nf(C,m,_))}function d2(m,_){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var C=m.retryLane;m.retryLane=C!==0&&C<_?C:_}}function Nw(m,_){d2(m,_),(m=m.alternate)&&d2(m,_)}function h2(m){if(m.tag===13){var _=dd(m,67108864);_!==null&&za(_,m,67108864),Nw(m,67108864)}}var fx=!0;function Op(m,_,C,k){var W=Ee.T;Ee.T=null;var ie=it.p;try{it.p=2,ag(m,_,C,k)}finally{it.p=ie,Ee.T=W}}function px(m,_,C,k){var W=Ee.T;Ee.T=null;var ie=it.p;try{it.p=8,ag(m,_,C,k)}finally{it.p=ie,Ee.T=W}}function ag(m,_,C,k){if(fx){var W=My(k);if(W===null)Oo(m,_,k,Dp,C),Mw(m,k);else if(f2(W,m,_,C,k))k.stopPropagation();else if(Mw(m,k),_&4&&-1<mN.indexOf(m)){for(;W!==null;){var ie=Kt(W);if(ie!==null)switch(ie.tag){case 3:if(ie=ie.stateNode,ie.current.memoizedState.isDehydrated){var Ae=yi(ie.pendingLanes);if(Ae!==0){var Xe=ie;for(Xe.pendingLanes|=2,Xe.entangledLanes|=2;Ae;){var Nt=1<<31-ze(Ae);Xe.entanglements[1]|=Nt,Ae&=~Nt}Od(ie),(Gt&6)===0&&(Wi=Nn()+500,by(0))}}break;case 13:Xe=dd(ie,2),Xe!==null&&za(Xe,ie,2),la(),Nw(ie,2)}if(ie=My(k),ie===null&&Oo(m,_,k,Dp,C),ie===W)break;W=ie}W!==null&&k.stopPropagation()}else Oo(m,_,k,null,C)}}function My(m){return m=rl(m),Z_(m)}var Dp=null;function Z_(m){if(Dp=null,m=nn(m),m!==null){var _=f(m);if(_===null)m=null;else{var C=_.tag;if(C===13){if(m=p(_),m!==null)return m;m=null}else if(C===3){if(_.stateNode.current.memoizedState.isDehydrated)return _.tag===3?_.stateNode.containerInfo:null;m=null}else _!==m&&(m=null)}}return Dp=m,null}function Pw(m){switch(m){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ci()){case ui:return 2;case st:return 8;case qt:case rn:return 32;case Wn:return 268435456;default:return 32}default:return 32}}var Y_=!1,bf=null,kp=null,Ip=null,og=new Map,Lp=new Map,wf=[],mN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Mw(m,_){switch(m){case"focusin":case"focusout":bf=null;break;case"dragenter":case"dragleave":kp=null;break;case"mouseover":case"mouseout":Ip=null;break;case"pointerover":case"pointerout":og.delete(_.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lp.delete(_.pointerId)}}function lg(m,_,C,k,W,ie){return m===null||m.nativeEvent!==ie?(m={blockedOn:_,domEventName:C,eventSystemFlags:k,nativeEvent:ie,targetContainers:[W]},_!==null&&(_=Kt(_),_!==null&&h2(_)),m):(m.eventSystemFlags|=k,_=m.targetContainers,W!==null&&_.indexOf(W)===-1&&_.push(W),m)}function f2(m,_,C,k,W){switch(_){case"focusin":return bf=lg(bf,m,_,C,k,W),!0;case"dragenter":return kp=lg(kp,m,_,C,k,W),!0;case"mouseover":return Ip=lg(Ip,m,_,C,k,W),!0;case"pointerover":var ie=W.pointerId;return og.set(ie,lg(og.get(ie)||null,m,_,C,k,W)),!0;case"gotpointercapture":return ie=W.pointerId,Lp.set(ie,lg(Lp.get(ie)||null,m,_,C,k,W)),!0}return!1}function Rw(m){var _=nn(m.target);if(_!==null){var C=f(_);if(C!==null){if(_=C.tag,_===13){if(_=p(C),_!==null){m.blockedOn=_,Dr(m.priority,function(){if(C.tag===13){var k=so();k=Jr(k);var W=dd(C,k);W!==null&&za(W,C,k),Nw(C,k)}});return}}else if(_===3&&C.stateNode.current.memoizedState.isDehydrated){m.blockedOn=C.tag===3?C.stateNode.containerInfo:null;return}}}m.blockedOn=null}function mx(m){if(m.blockedOn!==null)return!1;for(var _=m.targetContainers;0<_.length;){var C=My(m.nativeEvent);if(C===null){C=m.nativeEvent;var k=new C.constructor(C.type,C);$a=k,C.target.dispatchEvent(k),$a=null}else return _=Kt(C),_!==null&&h2(_),m.blockedOn=C,!1;_.shift()}return!0}function Ow(m,_,C){mx(m)&&C.delete(_)}function p2(){Y_=!1,bf!==null&&mx(bf)&&(bf=null),kp!==null&&mx(kp)&&(kp=null),Ip!==null&&mx(Ip)&&(Ip=null),og.forEach(Ow),Lp.forEach(Ow)}function K_(m,_){m.blockedOn===_&&(m.blockedOn=null,Y_||(Y_=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,p2)))}var gx=null;function Dw(m){gx!==m&&(gx=m,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){gx===m&&(gx=null);for(var _=0;_<m.length;_+=3){var C=m[_],k=m[_+1],W=m[_+2];if(typeof k!="function"){if(Z_(k||C)===null)continue;break}var ie=Kt(C);ie!==null&&(m.splice(_,3),_-=3,cy(ie,{pending:!0,data:W,method:C.method,action:k},k,W))}}))}function Ld(m){function _(Nt){return K_(Nt,m)}bf!==null&&K_(bf,m),kp!==null&&K_(kp,m),Ip!==null&&K_(Ip,m),og.forEach(_),Lp.forEach(_);for(var C=0;C<wf.length;C++){var k=wf[C];k.blockedOn===m&&(k.blockedOn=null)}for(;0<wf.length&&(C=wf[0],C.blockedOn===null);)Rw(C),C.blockedOn===null&&wf.shift();if(C=(m.ownerDocument||m).$$reactFormReplay,C!=null)for(k=0;k<C.length;k+=3){var W=C[k],ie=C[k+1],Ae=W[fe]||null;if(typeof ie=="function")Ae||Dw(C);else if(Ae){var Xe=null;if(ie&&ie.hasAttribute("formAction")){if(W=ie,Ae=ie[fe]||null)Xe=Ae.formAction;else if(Z_(W)!==null)continue}else Xe=Ae.action;typeof Xe=="function"?C[k+1]=Xe:(C.splice(k,3),k-=3),Dw(C)}}}function J_(m){this._internalRoot=m}yx.prototype.render=J_.prototype.render=function(m){var _=this._internalRoot;if(_===null)throw Error(r(409));var C=_.current,k=so();u2(C,k,m,_,null,null)},yx.prototype.unmount=J_.prototype.unmount=function(){var m=this._internalRoot;if(m!==null){this._internalRoot=null;var _=m.containerInfo;u2(m.current,2,null,m,null,null),la(),_[Te]=null}};function yx(m){this._internalRoot=m}yx.prototype.unstable_scheduleHydration=function(m){if(m){var _=ka();m={blockedOn:null,target:m,priority:_};for(var C=0;C<wf.length&&_!==0&&_<wf[C].priority;C++);wf.splice(C,0,m),C===0&&Rw(m)}};var kw=t.version;if(kw!=="19.1.1")throw Error(r(527,kw,"19.1.1"));it.findDOMNode=function(m){var _=m._reactInternals;if(_===void 0)throw typeof m.render=="function"?Error(r(188)):(m=Object.keys(m).join(","),Error(r(268,m)));return m=w(_),m=m!==null?T(m):null,m=m===null?null:m.stateNode,m};var Q_={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Ee,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var e0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!e0.isDisabled&&e0.supportsFiber)try{hr=e0.inject(Q_),$t=e0}catch{}}return a1.createRoot=function(m,_){if(!c(m))throw Error(r(299));var C=!1,k="",W=Md,ie=hy,Ae=fy,Xe=null;return _!=null&&(_.unstable_strictMode===!0&&(C=!0),_.identifierPrefix!==void 0&&(k=_.identifierPrefix),_.onUncaughtError!==void 0&&(W=_.onUncaughtError),_.onCaughtError!==void 0&&(ie=_.onCaughtError),_.onRecoverableError!==void 0&&(Ae=_.onRecoverableError),_.unstable_transitionCallbacks!==void 0&&(Xe=_.unstable_transitionCallbacks)),_=Cw(m,1,!1,null,null,C,k,W,ie,Ae,Xe,null),m[Te]=_.current,ax(m),new J_(_)},a1.hydrateRoot=function(m,_,C){if(!c(m))throw Error(r(299));var k=!1,W="",ie=Md,Ae=hy,Xe=fy,Nt=null,on=null;return C!=null&&(C.unstable_strictMode===!0&&(k=!0),C.identifierPrefix!==void 0&&(W=C.identifierPrefix),C.onUncaughtError!==void 0&&(ie=C.onUncaughtError),C.onCaughtError!==void 0&&(Ae=C.onCaughtError),C.onRecoverableError!==void 0&&(Xe=C.onRecoverableError),C.unstable_transitionCallbacks!==void 0&&(Nt=C.unstable_transitionCallbacks),C.formState!==void 0&&(on=C.formState)),_=Cw(m,1,!0,_,C??null,k,W,ie,Ae,Xe,Nt,on),_.context=X_(null),C=_.current,k=so(),k=Jr(k),W=lu(k),W.callback=null,Fl(C,W,k),C=k,_.current.lanes=C,bs(_,C),Od(_),m[Te]=_.current,ax(m),new yx(_)},a1.version="19.1.1",a1}var R5;function Gae(){if(R5)return uP.exports;R5=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),uP.exports=Hae(),uP.exports}var Wae=Gae();/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var O5="popstate";function Xae(e={}){function t(r,c){let{pathname:f,search:p,hash:s}=r.location;return xk("",{pathname:f,search:p,hash:s},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function n(r,c){return typeof c=="string"?c:Z1(c)}return Yae(t,n,null,e)}function Xo(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function sm(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Zae(){return Math.random().toString(36).substring(2,10)}function D5(e,t){return{usr:e.state,key:e.key,idx:t}}function xk(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Eb(t):t,state:n,key:t&&t.key||r||Zae()}}function Z1({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Eb(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function Yae(e,t,n,r={}){let{window:c=document.defaultView,v5Compat:f=!1}=r,p=c.history,s="POP",w=null,T=E();T==null&&(T=0,p.replaceState({...p.state,idx:T},""));function E(){return(p.state||{idx:null}).idx}function N(){s="POP";let F=E(),K=F==null?null:F-T;T=F,w&&w({action:s,location:B.location,delta:K})}function D(F,K){s="PUSH";let Y=xk(B.location,F,K);T=E()+1;let X=D5(Y,T),ae=B.createHref(Y);try{p.pushState(X,"",ae)}catch(Z){if(Z instanceof DOMException&&Z.name==="DataCloneError")throw Z;c.location.assign(ae)}f&&w&&w({action:s,location:B.location,delta:1})}function V(F,K){s="REPLACE";let Y=xk(B.location,F,K);T=E();let X=D5(Y,T),ae=B.createHref(Y);p.replaceState(X,"",ae),f&&w&&w({action:s,location:B.location,delta:0})}function $(F){return Kae(F)}let B={get action(){return s},get location(){return e(c,p)},listen(F){if(w)throw new Error("A history only accepts one active listener");return c.addEventListener(O5,N),w=F,()=>{c.removeEventListener(O5,N),w=null}},createHref(F){return t(c,F)},createURL:$,encodeLocation(F){let K=$(F);return{pathname:K.pathname,search:K.search,hash:K.hash}},push:D,replace:V,go(F){return p.go(F)}};return B}function Kae(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Xo(n,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:Z1(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function Q9(e,t,n="/"){return Jae(e,t,n,!1)}function Jae(e,t,n,r){let c=typeof t=="string"?Eb(t):t,f=Tg(c.pathname||"/",n);if(f==null)return null;let p=eW(e);Qae(p);let s=null;for(let w=0;s==null&&w<p.length;++w){let T=uoe(f);s=loe(p[w],T,r)}return s}function eW(e,t=[],n=[],r="",c=!1){let f=(p,s,w=c,T)=>{let E={relativePath:T===void 0?p.path||"":T,caseSensitive:p.caseSensitive===!0,childrenIndex:s,route:p};if(E.relativePath.startsWith("/")){if(!E.relativePath.startsWith(r)&&w)return;Xo(E.relativePath.startsWith(r),`Absolute route path "${E.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),E.relativePath=E.relativePath.slice(r.length)}let N=_g([r,E.relativePath]),D=n.concat(E);p.children&&p.children.length>0&&(Xo(p.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${N}".`),eW(p.children,t,D,N,w)),!(p.path==null&&!p.index)&&t.push({path:N,score:aoe(N,p.index),routesMeta:D})};return e.forEach((p,s)=>{if(p.path===""||!p.path?.includes("?"))f(p,s);else for(let w of tW(p.path))f(p,s,!0,w)}),t}function tW(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,c=n.endsWith("?"),f=n.replace(/\?$/,"");if(r.length===0)return c?[f,""]:[f];let p=tW(r.join("/")),s=[];return s.push(...p.map(w=>w===""?f:[f,w].join("/"))),c&&s.push(...p),s.map(w=>e.startsWith("/")&&w===""?"/":w)}function Qae(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:ooe(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var eoe=/^:[\w-]+$/,toe=3,noe=2,roe=1,ioe=10,soe=-2,k5=e=>e==="*";function aoe(e,t){let n=e.split("/"),r=n.length;return n.some(k5)&&(r+=soe),t&&(r+=noe),n.filter(c=>!k5(c)).reduce((c,f)=>c+(eoe.test(f)?toe:f===""?roe:ioe),r)}function ooe(e,t){return e.length===t.length&&e.slice(0,-1).every((r,c)=>r===t[c])?e[e.length-1]-t[t.length-1]:0}function loe(e,t,n=!1){let{routesMeta:r}=e,c={},f="/",p=[];for(let s=0;s<r.length;++s){let w=r[s],T=s===r.length-1,E=f==="/"?t:t.slice(f.length)||"/",N=UA({path:w.relativePath,caseSensitive:w.caseSensitive,end:T},E),D=w.route;if(!N&&T&&n&&!r[r.length-1].route.index&&(N=UA({path:w.relativePath,caseSensitive:w.caseSensitive,end:!1},E)),!N)return null;Object.assign(c,N.params),p.push({params:c,pathname:_g([f,N.pathname]),pathnameBase:poe(_g([f,N.pathnameBase])),route:D}),N.pathnameBase!=="/"&&(f=_g([f,N.pathnameBase]))}return p}function UA(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=coe(e.path,e.caseSensitive,e.end),c=t.match(n);if(!c)return null;let f=c[0],p=f.replace(/(.)\/+$/,"$1"),s=c.slice(1);return{params:r.reduce((T,{paramName:E,isOptional:N},D)=>{if(E==="*"){let $=s[D]||"";p=f.slice(0,f.length-$.length).replace(/(.)\/+$/,"$1")}const V=s[D];return N&&!V?T[E]=void 0:T[E]=(V||"").replace(/%2F/g,"/"),T},{}),pathname:f,pathnameBase:p,pattern:e}}function coe(e,t=!1,n=!0){sm(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],c="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(p,s,w)=>(r.push({paramName:s,isOptional:w!=null}),w?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),c+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?c+="\\/*$":e!==""&&e!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,t?void 0:"i"),r]}function uoe(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return sm(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Tg(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function doe(e,t="/"){let{pathname:n,search:r="",hash:c=""}=typeof e=="string"?Eb(e):e;return{pathname:n?n.startsWith("/")?n:hoe(n,t):t,search:moe(r),hash:goe(c)}}function hoe(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(c=>{c===".."?n.length>1&&n.pop():c!=="."&&n.push(c)}),n.length>1?n.join("/"):"/"}function pP(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function foe(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function nW(e){let t=foe(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function rW(e,t,n,r=!1){let c;typeof e=="string"?c=Eb(e):(c={...e},Xo(!c.pathname||!c.pathname.includes("?"),pP("?","pathname","search",c)),Xo(!c.pathname||!c.pathname.includes("#"),pP("#","pathname","hash",c)),Xo(!c.search||!c.search.includes("#"),pP("#","search","hash",c)));let f=e===""||c.pathname==="",p=f?"/":c.pathname,s;if(p==null)s=n;else{let N=t.length-1;if(!r&&p.startsWith("..")){let D=p.split("/");for(;D[0]==="..";)D.shift(),N-=1;c.pathname=D.join("/")}s=N>=0?t[N]:"/"}let w=doe(c,s),T=p&&p!=="/"&&p.endsWith("/"),E=(f||p===".")&&n.endsWith("/");return!w.pathname.endsWith("/")&&(T||E)&&(w.pathname+="/"),w}var _g=e=>e.join("/").replace(/\/\/+/g,"/"),poe=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),moe=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,goe=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function yoe(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var iW=["POST","PUT","PATCH","DELETE"];new Set(iW);var voe=["GET",...iW];new Set(voe);var Cb=z.createContext(null);Cb.displayName="DataRouter";var CE=z.createContext(null);CE.displayName="DataRouterState";z.createContext(!1);var sW=z.createContext({isTransitioning:!1});sW.displayName="ViewTransition";var xoe=z.createContext(new Map);xoe.displayName="Fetchers";var _oe=z.createContext(null);_oe.displayName="Await";var lm=z.createContext(null);lm.displayName="Navigation";var WS=z.createContext(null);WS.displayName="Location";var $f=z.createContext({outlet:null,matches:[],isDataRoute:!1});$f.displayName="Route";var ZL=z.createContext(null);ZL.displayName="RouteError";function boe(e,{relative:t}={}){Xo(XS(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=z.useContext(lm),{hash:c,pathname:f,search:p}=ZS(e,{relative:t}),s=f;return n!=="/"&&(s=f==="/"?n:_g([n,f])),r.createHref({pathname:s,search:p,hash:c})}function XS(){return z.useContext(WS)!=null}function cv(){return Xo(XS(),"useLocation() may be used only in the context of a <Router> component."),z.useContext(WS).location}var aW="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function oW(e){z.useContext(lm).static||z.useLayoutEffect(e)}function d_(){let{isDataRoute:e}=z.useContext($f);return e?Ioe():woe()}function woe(){Xo(XS(),"useNavigate() may be used only in the context of a <Router> component.");let e=z.useContext(Cb),{basename:t,navigator:n}=z.useContext(lm),{matches:r}=z.useContext($f),{pathname:c}=cv(),f=JSON.stringify(nW(r)),p=z.useRef(!1);return oW(()=>{p.current=!0}),z.useCallback((w,T={})=>{if(sm(p.current,aW),!p.current)return;if(typeof w=="number"){n.go(w);return}let E=rW(w,JSON.parse(f),c,T.relative==="path");e==null&&t!=="/"&&(E.pathname=E.pathname==="/"?t:_g([t,E.pathname])),(T.replace?n.replace:n.push)(E,T.state,T)},[t,n,f,c,e])}var lW=z.createContext(null);function Soe(){return z.useContext(lW)}function Toe(e){let t=z.useContext($f).outlet;return t&&z.createElement(lW.Provider,{value:e},t)}function NE(){let{matches:e}=z.useContext($f),t=e[e.length-1];return t?t.params:{}}function ZS(e,{relative:t}={}){let{matches:n}=z.useContext($f),{pathname:r}=cv(),c=JSON.stringify(nW(n));return z.useMemo(()=>rW(e,JSON.parse(c),r,t==="path"),[e,c,r,t])}function Aoe(e,t){return cW(e,t)}function cW(e,t,n,r,c){Xo(XS(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:f}=z.useContext(lm),{matches:p}=z.useContext($f),s=p[p.length-1],w=s?s.params:{},T=s?s.pathname:"/",E=s?s.pathnameBase:"/",N=s&&s.route;{let Y=N&&N.path||"";uW(T,!N||Y.endsWith("*")||Y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${T}" (under <Route path="${Y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Y}"> to <Route path="${Y==="/"?"*":`${Y}/*`}">.`)}let D=cv(),V;if(t){let Y=typeof t=="string"?Eb(t):t;Xo(E==="/"||Y.pathname?.startsWith(E),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${E}" but pathname "${Y.pathname}" was given in the \`location\` prop.`),V=Y}else V=D;let $=V.pathname||"/",B=$;if(E!=="/"){let Y=E.replace(/^\//,"").split("/");B="/"+$.replace(/^\//,"").split("/").slice(Y.length).join("/")}let F=Q9(e,{pathname:B});sm(N||F!=null,`No routes matched location "${V.pathname}${V.search}${V.hash}" `),sm(F==null||F[F.length-1].route.element!==void 0||F[F.length-1].route.Component!==void 0||F[F.length-1].route.lazy!==void 0,`Matched leaf route at location "${V.pathname}${V.search}${V.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let K=Poe(F&&F.map(Y=>Object.assign({},Y,{params:Object.assign({},w,Y.params),pathname:_g([E,f.encodeLocation?f.encodeLocation(Y.pathname).pathname:Y.pathname]),pathnameBase:Y.pathnameBase==="/"?E:_g([E,f.encodeLocation?f.encodeLocation(Y.pathnameBase).pathname:Y.pathnameBase])})),p,n,r,c);return t&&K?z.createElement(WS.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...V},navigationType:"POP"}},K):K}function joe(){let e=koe(),t=yoe(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",c={padding:"0.5rem",backgroundColor:r},f={padding:"2px 4px",backgroundColor:r},p=null;return console.error("Error handled by React Router default ErrorBoundary:",e),p=z.createElement(z.Fragment,null,z.createElement("p",null,"💿 Hey developer 👋"),z.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",z.createElement("code",{style:f},"ErrorBoundary")," or"," ",z.createElement("code",{style:f},"errorElement")," prop on your route.")),z.createElement(z.Fragment,null,z.createElement("h2",null,"Unexpected Application Error!"),z.createElement("h3",{style:{fontStyle:"italic"}},t),n?z.createElement("pre",{style:c},n):null,p)}var Eoe=z.createElement(joe,null),Coe=class extends z.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?z.createElement($f.Provider,{value:this.props.routeContext},z.createElement(ZL.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Noe({routeContext:e,match:t,children:n}){let r=z.useContext(Cb);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),z.createElement($f.Provider,{value:e},n)}function Poe(e,t=[],n=null,r=null,c=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let f=e,p=n?.errors;if(p!=null){let T=f.findIndex(E=>E.route.id&&p?.[E.route.id]!==void 0);Xo(T>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(p).join(",")}`),f=f.slice(0,Math.min(f.length,T+1))}let s=!1,w=-1;if(n)for(let T=0;T<f.length;T++){let E=f[T];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(w=T),E.route.id){let{loaderData:N,errors:D}=n,V=E.route.loader&&!N.hasOwnProperty(E.route.id)&&(!D||D[E.route.id]===void 0);if(E.route.lazy||V){s=!0,w>=0?f=f.slice(0,w+1):f=[f[0]];break}}}return f.reduceRight((T,E,N)=>{let D,V=!1,$=null,B=null;n&&(D=p&&E.route.id?p[E.route.id]:void 0,$=E.route.errorElement||Eoe,s&&(w<0&&N===0?(uW("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),V=!0,B=null):w===N&&(V=!0,B=E.route.hydrateFallbackElement||null)));let F=t.concat(f.slice(0,N+1)),K=()=>{let Y;return D?Y=$:V?Y=B:E.route.Component?Y=z.createElement(E.route.Component,null):E.route.element?Y=E.route.element:Y=T,z.createElement(Noe,{match:E,routeContext:{outlet:T,matches:F,isDataRoute:n!=null},children:Y})};return n&&(E.route.ErrorBoundary||E.route.errorElement||N===0)?z.createElement(Coe,{location:n.location,revalidation:n.revalidation,component:$,error:D,children:K(),routeContext:{outlet:null,matches:F,isDataRoute:!0},unstable_onError:r}):K()},null)}function YL(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Moe(e){let t=z.useContext(Cb);return Xo(t,YL(e)),t}function Roe(e){let t=z.useContext(CE);return Xo(t,YL(e)),t}function Ooe(e){let t=z.useContext($f);return Xo(t,YL(e)),t}function KL(e){let t=Ooe(e),n=t.matches[t.matches.length-1];return Xo(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function Doe(){return KL("useRouteId")}function koe(){let e=z.useContext(ZL),t=Roe("useRouteError"),n=KL("useRouteError");return e!==void 0?e:t.errors?.[n]}function Ioe(){let{router:e}=Moe("useNavigate"),t=KL("useNavigate"),n=z.useRef(!1);return oW(()=>{n.current=!0}),z.useCallback(async(c,f={})=>{sm(n.current,aW),n.current&&(typeof c=="number"?e.navigate(c):await e.navigate(c,{fromRouteId:t,...f}))},[e,t])}var I5={};function uW(e,t,n){!t&&!I5[e]&&(I5[e]=!0,sm(!1,n))}z.memo(Loe);function Loe({routes:e,future:t,state:n,unstable_onError:r}){return cW(e,void 0,n,r,t)}function JL(e){return Toe(e.context)}function ms(e){Xo(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function zoe({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:c,static:f=!1}){Xo(!XS(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=e.replace(/^\/*/,"/"),s=z.useMemo(()=>({basename:p,navigator:c,static:f,future:{}}),[p,c,f]);typeof n=="string"&&(n=Eb(n));let{pathname:w="/",search:T="",hash:E="",state:N=null,key:D="default"}=n,V=z.useMemo(()=>{let $=Tg(w,p);return $==null?null:{location:{pathname:$,search:T,hash:E,state:N,key:D},navigationType:r}},[p,w,T,E,N,D,r]);return sm(V!=null,`<Router basename="${p}"> is not able to match the URL "${w}${T}${E}" because it does not start with the basename, so the <Router> won't render anything.`),V==null?null:z.createElement(lm.Provider,{value:s},z.createElement(WS.Provider,{children:t,value:V}))}function Foe({children:e,location:t}){return Aoe(_k(e),t)}function _k(e,t=[]){let n=[];return z.Children.forEach(e,(r,c)=>{if(!z.isValidElement(r))return;let f=[...t,c];if(r.type===z.Fragment){n.push.apply(n,_k(r.props.children,f));return}Xo(r.type===ms,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xo(!r.props.index||!r.props.children,"An index route cannot have child routes.");let p={id:r.props.id||f.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(p.children=_k(r.props.children,f)),n.push(p)}),n}var wA="get",SA="application/x-www-form-urlencoded";function PE(e){return e!=null&&typeof e.tagName=="string"}function Boe(e){return PE(e)&&e.tagName.toLowerCase()==="button"}function Uoe(e){return PE(e)&&e.tagName.toLowerCase()==="form"}function Voe(e){return PE(e)&&e.tagName.toLowerCase()==="input"}function $oe(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function qoe(e,t){return e.button===0&&(!t||t==="_self")&&!$oe(e)}var W2=null;function Hoe(){if(W2===null)try{new FormData(document.createElement("form"),0),W2=!1}catch{W2=!0}return W2}var Goe=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function mP(e){return e!=null&&!Goe.has(e)?(sm(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${SA}"`),null):e}function Woe(e,t){let n,r,c,f,p;if(Uoe(e)){let s=e.getAttribute("action");r=s?Tg(s,t):null,n=e.getAttribute("method")||wA,c=mP(e.getAttribute("enctype"))||SA,f=new FormData(e)}else if(Boe(e)||Voe(e)&&(e.type==="submit"||e.type==="image")){let s=e.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let w=e.getAttribute("formaction")||s.getAttribute("action");if(r=w?Tg(w,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||wA,c=mP(e.getAttribute("formenctype"))||mP(s.getAttribute("enctype"))||SA,f=new FormData(s,e),!Hoe()){let{name:T,type:E,value:N}=e;if(E==="image"){let D=T?`${T}.`:"";f.append(`${D}x`,"0"),f.append(`${D}y`,"0")}else T&&f.append(T,N)}}else{if(PE(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=wA,r=null,c=SA,p=e}return f&&c==="text/plain"&&(p=f,f=void 0),{action:r,method:n.toLowerCase(),encType:c,formData:f,body:p}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function QL(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Xoe(e,t,n){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname=`_root.${n}`:t&&Tg(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function Zoe(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Yoe(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function Koe(e,t,n){let r=await Promise.all(e.map(async c=>{let f=t.routes[c.route.id];if(f){let p=await Zoe(f,n);return p.links?p.links():[]}return[]}));return tle(r.flat(1).filter(Yoe).filter(c=>c.rel==="stylesheet"||c.rel==="preload").map(c=>c.rel==="stylesheet"?{...c,rel:"prefetch",as:"style"}:{...c,rel:"prefetch"}))}function L5(e,t,n,r,c,f){let p=(w,T)=>n[T]?w.route.id!==n[T].route.id:!0,s=(w,T)=>n[T].pathname!==w.pathname||n[T].route.path?.endsWith("*")&&n[T].params["*"]!==w.params["*"];return f==="assets"?t.filter((w,T)=>p(w,T)||s(w,T)):f==="data"?t.filter((w,T)=>{let E=r.routes[w.route.id];if(!E||!E.hasLoader)return!1;if(p(w,T)||s(w,T))return!0;if(w.route.shouldRevalidate){let N=w.route.shouldRevalidate({currentUrl:new URL(c.pathname+c.search+c.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:w.params,defaultShouldRevalidate:!0});if(typeof N=="boolean")return N}return!0}):[]}function Joe(e,t,{includeHydrateFallback:n}={}){return Qoe(e.map(r=>{let c=t.routes[r.route.id];if(!c)return[];let f=[c.module];return c.clientActionModule&&(f=f.concat(c.clientActionModule)),c.clientLoaderModule&&(f=f.concat(c.clientLoaderModule)),n&&c.hydrateFallbackModule&&(f=f.concat(c.hydrateFallbackModule)),c.imports&&(f=f.concat(c.imports)),f}).flat(1))}function Qoe(e){return[...new Set(e)]}function ele(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function tle(e,t){let n=new Set;return new Set(t),e.reduce((r,c)=>{let f=JSON.stringify(ele(c));return n.has(f)||(n.add(f),r.push({key:f,link:c})),r},[])}function dW(){let e=z.useContext(Cb);return QL(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function nle(){let e=z.useContext(CE);return QL(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var e3=z.createContext(void 0);e3.displayName="FrameworkContext";function hW(){let e=z.useContext(e3);return QL(e,"You must render this element inside a <HydratedRouter> element"),e}function rle(e,t){let n=z.useContext(e3),[r,c]=z.useState(!1),[f,p]=z.useState(!1),{onFocus:s,onBlur:w,onMouseEnter:T,onMouseLeave:E,onTouchStart:N}=t,D=z.useRef(null);z.useEffect(()=>{if(e==="render"&&p(!0),e==="viewport"){let B=K=>{K.forEach(Y=>{p(Y.isIntersecting)})},F=new IntersectionObserver(B,{threshold:.5});return D.current&&F.observe(D.current),()=>{F.disconnect()}}},[e]),z.useEffect(()=>{if(r){let B=setTimeout(()=>{p(!0)},100);return()=>{clearTimeout(B)}}},[r]);let V=()=>{c(!0)},$=()=>{c(!1),p(!1)};return n?e!=="intent"?[f,D,{}]:[f,D,{onFocus:o1(s,V),onBlur:o1(w,$),onMouseEnter:o1(T,V),onMouseLeave:o1(E,$),onTouchStart:o1(N,V)}]:[!1,D,{}]}function o1(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function ile({page:e,...t}){let{router:n}=dW(),r=z.useMemo(()=>Q9(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?z.createElement(ale,{page:e,matches:r,...t}):null}function sle(e){let{manifest:t,routeModules:n}=hW(),[r,c]=z.useState([]);return z.useEffect(()=>{let f=!1;return Koe(e,t,n).then(p=>{f||c(p)}),()=>{f=!0}},[e,t,n]),r}function ale({page:e,matches:t,...n}){let r=cv(),{manifest:c,routeModules:f}=hW(),{basename:p}=dW(),{loaderData:s,matches:w}=nle(),T=z.useMemo(()=>L5(e,t,w,c,r,"data"),[e,t,w,c,r]),E=z.useMemo(()=>L5(e,t,w,c,r,"assets"),[e,t,w,c,r]),N=z.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let $=new Set,B=!1;if(t.forEach(K=>{let Y=c.routes[K.route.id];!Y||!Y.hasLoader||(!T.some(X=>X.route.id===K.route.id)&&K.route.id in s&&f[K.route.id]?.shouldRevalidate||Y.hasClientLoader?B=!0:$.add(K.route.id))}),$.size===0)return[];let F=Xoe(e,p,"data");return B&&$.size>0&&F.searchParams.set("_routes",t.filter(K=>$.has(K.route.id)).map(K=>K.route.id).join(",")),[F.pathname+F.search]},[p,s,r,c,T,t,e,f]),D=z.useMemo(()=>Joe(E,c),[E,c]),V=sle(E);return z.createElement(z.Fragment,null,N.map($=>z.createElement("link",{key:$,rel:"prefetch",as:"fetch",href:$,...n})),D.map($=>z.createElement("link",{key:$,rel:"modulepreload",href:$,...n})),V.map(({key:$,link:B})=>z.createElement("link",{key:$,nonce:n.nonce,...B})))}function ole(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var fW=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{fW&&(window.__reactRouterVersion="7.8.2")}catch{}function lle({basename:e,children:t,window:n}){let r=z.useRef();r.current==null&&(r.current=Xae({window:n,v5Compat:!0}));let c=r.current,[f,p]=z.useState({action:c.action,location:c.location}),s=z.useCallback(w=>{z.startTransition(()=>p(w))},[p]);return z.useLayoutEffect(()=>c.listen(s),[c,s]),z.createElement(zoe,{basename:e,children:t,location:f.location,navigationType:f.action,navigator:c})}var pW=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Yl=z.forwardRef(function({onClick:t,discover:n="render",prefetch:r="none",relative:c,reloadDocument:f,replace:p,state:s,target:w,to:T,preventScrollReset:E,viewTransition:N,...D},V){let{basename:$}=z.useContext(lm),B=typeof T=="string"&&pW.test(T),F,K=!1;if(typeof T=="string"&&B&&(F=T,fW))try{let Ce=new URL(window.location.href),Ve=T.startsWith("//")?new URL(Ce.protocol+T):new URL(T),Re=Tg(Ve.pathname,$);Ve.origin===Ce.origin&&Re!=null?T=Re+Ve.search+Ve.hash:K=!0}catch{sm(!1,`<Link to="${T}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let Y=boe(T,{relative:c}),[X,ae,Z]=rle(r,D),se=hle(T,{replace:p,state:s,target:w,preventScrollReset:E,relative:c,viewTransition:N});function he(Ce){t&&t(Ce),Ce.defaultPrevented||se(Ce)}let ye=z.createElement("a",{...D,...Z,href:F||Y,onClick:K||f?t:he,ref:ole(V,ae),target:w,"data-discover":!B&&n==="render"?"true":void 0});return X&&!B?z.createElement(z.Fragment,null,ye,z.createElement(ile,{page:Y})):ye});Yl.displayName="Link";var cle=z.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:r="",end:c=!1,style:f,to:p,viewTransition:s,children:w,...T},E){let N=ZS(p,{relative:T.relative}),D=cv(),V=z.useContext(CE),{navigator:$,basename:B}=z.useContext(lm),F=V!=null&&yle(N)&&s===!0,K=$.encodeLocation?$.encodeLocation(N).pathname:N.pathname,Y=D.pathname,X=V&&V.navigation&&V.navigation.location?V.navigation.location.pathname:null;n||(Y=Y.toLowerCase(),X=X?X.toLowerCase():null,K=K.toLowerCase()),X&&B&&(X=Tg(X,B)||X);const ae=K!=="/"&&K.endsWith("/")?K.length-1:K.length;let Z=Y===K||!c&&Y.startsWith(K)&&Y.charAt(ae)==="/",se=X!=null&&(X===K||!c&&X.startsWith(K)&&X.charAt(K.length)==="/"),he={isActive:Z,isPending:se,isTransitioning:F},ye=Z?t:void 0,Ce;typeof r=="function"?Ce=r(he):Ce=[r,Z?"active":null,se?"pending":null,F?"transitioning":null].filter(Boolean).join(" ");let Ve=typeof f=="function"?f(he):f;return z.createElement(Yl,{...T,"aria-current":ye,className:Ce,ref:E,style:Ve,to:p,viewTransition:s},typeof w=="function"?w(he):w)});cle.displayName="NavLink";var ule=z.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:c,state:f,method:p=wA,action:s,onSubmit:w,relative:T,preventScrollReset:E,viewTransition:N,...D},V)=>{let $=mle(),B=gle(s,{relative:T}),F=p.toLowerCase()==="get"?"get":"post",K=typeof s=="string"&&pW.test(s),Y=X=>{if(w&&w(X),X.defaultPrevented)return;X.preventDefault();let ae=X.nativeEvent.submitter,Z=ae?.getAttribute("formmethod")||p;$(ae||X.currentTarget,{fetcherKey:t,method:Z,navigate:n,replace:c,state:f,relative:T,preventScrollReset:E,viewTransition:N})};return z.createElement("form",{ref:V,method:F,action:B,onSubmit:r?w:Y,...D,"data-discover":!K&&e==="render"?"true":void 0})});ule.displayName="Form";function dle(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function mW(e){let t=z.useContext(Cb);return Xo(t,dle(e)),t}function hle(e,{target:t,replace:n,state:r,preventScrollReset:c,relative:f,viewTransition:p}={}){let s=d_(),w=cv(),T=ZS(e,{relative:f});return z.useCallback(E=>{if(qoe(E,t)){E.preventDefault();let N=n!==void 0?n:Z1(w)===Z1(T);s(e,{replace:N,state:r,preventScrollReset:c,relative:f,viewTransition:p})}},[w,s,T,n,r,t,e,c,f,p])}var fle=0,ple=()=>`__${String(++fle)}__`;function mle(){let{router:e}=mW("useSubmit"),{basename:t}=z.useContext(lm),n=Doe();return z.useCallback(async(r,c={})=>{let{action:f,method:p,encType:s,formData:w,body:T}=Woe(r,t);if(c.navigate===!1){let E=c.fetcherKey||ple();await e.fetch(E,n,c.action||f,{preventScrollReset:c.preventScrollReset,formData:w,body:T,formMethod:c.method||p,formEncType:c.encType||s,flushSync:c.flushSync})}else await e.navigate(c.action||f,{preventScrollReset:c.preventScrollReset,formData:w,body:T,formMethod:c.method||p,formEncType:c.encType||s,replace:c.replace,state:c.state,fromRouteId:n,flushSync:c.flushSync,viewTransition:c.viewTransition})},[e,t,n])}function gle(e,{relative:t}={}){let{basename:n}=z.useContext(lm),r=z.useContext($f);Xo(r,"useFormAction must be used inside a RouteContext");let[c]=r.matches.slice(-1),f={...ZS(e||".",{relative:t})},p=cv();if(e==null){f.search=p.search;let s=new URLSearchParams(f.search),w=s.getAll("index");if(w.some(E=>E==="")){s.delete("index"),w.filter(N=>N).forEach(N=>s.append("index",N));let E=s.toString();f.search=E?`?${E}`:""}}return(!e||e===".")&&c.route.index&&(f.search=f.search?f.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(f.pathname=f.pathname==="/"?n:_g([n,f.pathname])),Z1(f)}function yle(e,{relative:t}={}){let n=z.useContext(sW);Xo(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=mW("useViewTransitionState"),c=ZS(e,{relative:t});if(!n.isTransitioning)return!1;let f=Tg(n.currentLocation.pathname,r)||n.currentLocation.pathname,p=Tg(n.nextLocation.pathname,r)||n.nextLocation.pathname;return UA(c.pathname,p)!=null||UA(c.pathname,f)!=null}var YS=J9();const gW=Ca(YS);var vle=(e,t,n,r,c,f,p,s)=>{let w=document.documentElement,T=["light","dark"];function E(V){(Array.isArray(e)?e:[e]).forEach($=>{let B=$==="class",F=B&&f?c.map(K=>f[K]||K):c;B?(w.classList.remove(...F),w.classList.add(f&&f[V]?f[V]:V)):w.setAttribute($,V)}),N(V)}function N(V){s&&T.includes(V)&&(w.style.colorScheme=V)}function D(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(r)E(r);else try{let V=localStorage.getItem(t)||n,$=p&&V==="system"?D():V;E($)}catch{}},xle=z.createContext(void 0),_le={setTheme:e=>{},themes:[]},ble=()=>{var e;return(e=z.useContext(xle))!=null?e:_le};z.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:c,defaultTheme:f,value:p,themes:s,nonce:w,scriptProps:T})=>{let E=JSON.stringify([n,t,f,e,s,p,r,c]).slice(1,-1);return z.createElement("script",{...T,suppressHydrationWarning:!0,nonce:typeof window>"u"?w:"",dangerouslySetInnerHTML:{__html:`(${vle.toString()})(${E})`}})});function wle(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}const Sle=e=>{switch(e){case"success":return jle;case"info":return Cle;case"warning":return Ele;case"error":return Nle;default:return null}},Tle=Array(12).fill(0),Ale=({visible:e,className:t})=>_e.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},_e.createElement("div",{className:"sonner-spinner"},Tle.map((n,r)=>_e.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),jle=_e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},_e.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Ele=_e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},_e.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Cle=_e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},_e.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Nle=_e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},_e.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Ple=_e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},_e.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),_e.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Mle=()=>{const[e,t]=_e.useState(document.hidden);return _e.useEffect(()=>{const n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e};let bk=1;class Rle{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;const{message:r,...c}=t,f=typeof t?.id=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:bk++,p=this.toasts.find(w=>w.id===f),s=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(f)&&this.dismissedToasts.delete(f),p?this.toasts=this.toasts.map(w=>w.id===f?(this.publish({...w,...t,id:f,title:r}),{...w,...t,id:f,dismissible:s,title:r}):w):this.addToast({title:r,...c,dismissible:s,id:f}),f},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:t,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const c=Promise.resolve(t instanceof Function?t():t);let f=r!==void 0,p;const s=c.then(async T=>{if(p=["resolve",T],_e.isValidElement(T))f=!1,this.create({id:r,type:"default",message:T});else if(Dle(T)&&!T.ok){f=!1;const N=typeof n.error=="function"?await n.error(`HTTP error! status: ${T.status}`):n.error,D=typeof n.description=="function"?await n.description(`HTTP error! status: ${T.status}`):n.description,$=typeof N=="object"&&!_e.isValidElement(N)?N:{message:N};this.create({id:r,type:"error",description:D,...$})}else if(T instanceof Error){f=!1;const N=typeof n.error=="function"?await n.error(T):n.error,D=typeof n.description=="function"?await n.description(T):n.description,$=typeof N=="object"&&!_e.isValidElement(N)?N:{message:N};this.create({id:r,type:"error",description:D,...$})}else if(n.success!==void 0){f=!1;const N=typeof n.success=="function"?await n.success(T):n.success,D=typeof n.description=="function"?await n.description(T):n.description,$=typeof N=="object"&&!_e.isValidElement(N)?N:{message:N};this.create({id:r,type:"success",description:D,...$})}}).catch(async T=>{if(p=["reject",T],n.error!==void 0){f=!1;const E=typeof n.error=="function"?await n.error(T):n.error,N=typeof n.description=="function"?await n.description(T):n.description,V=typeof E=="object"&&!_e.isValidElement(E)?E:{message:E};this.create({id:r,type:"error",description:N,...V})}}).finally(()=>{f&&(this.dismiss(r),r=void 0),n.finally==null||n.finally.call(n)}),w=()=>new Promise((T,E)=>s.then(()=>p[0]==="reject"?E(p[1]):T(p[1])).catch(E));return typeof r!="string"&&typeof r!="number"?{unwrap:w}:Object.assign(r,{unwrap:w})},this.custom=(t,n)=>{const r=n?.id||bk++;return this.create({jsx:t(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Zu=new Rle,Ole=(e,t)=>{const n=t?.id||bk++;return Zu.addToast({title:e,...t,id:n}),n},Dle=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",kle=Ole,Ile=()=>Zu.toasts,Lle=()=>Zu.getActiveToasts(),Zt=Object.assign(kle,{success:Zu.success,info:Zu.info,warning:Zu.warning,error:Zu.error,custom:Zu.custom,message:Zu.message,promise:Zu.promise,dismiss:Zu.dismiss,loading:Zu.loading},{getHistory:Ile,getToasts:Lle});wle("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function X2(e){return e.label!==void 0}const zle=3,Fle="24px",Ble="16px",z5=4e3,Ule=356,Vle=14,$le=45,qle=200;function Bp(...e){return e.filter(Boolean).join(" ")}function Hle(e){const[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}const Gle=e=>{var t,n,r,c,f,p,s,w,T;const{invert:E,toast:N,unstyled:D,interacting:V,setHeights:$,visibleToasts:B,heights:F,index:K,toasts:Y,expanded:X,removeToast:ae,defaultRichColors:Z,closeButton:se,style:he,cancelButtonStyle:ye,actionButtonStyle:Ce,className:Ve="",descriptionClassName:Re="",duration:$e,position:nt,gap:Me,expandByDefault:rt,classNames:Ee,icons:it,closeButtonAriaLabel:et="Close toast"}=e,[mt,He]=_e.useState(null),[pt,We]=_e.useState(null),[Je,jt]=_e.useState(!1),[Pt,Ot]=_e.useState(!1),[Mt,an]=_e.useState(!1),[Jt,Cn]=_e.useState(!1),[nr,sn]=_e.useState(!1),[zr,or]=_e.useState(0),[Rr,qr]=_e.useState(0),Nn=_e.useRef(N.duration||$e||z5),ci=_e.useRef(null),ui=_e.useRef(null),st=K===0,qt=K+1<=B,rn=N.type,Wn=N.dismissible!==!1,Vt=N.className||"",un=N.descriptionClassName||"",hr=_e.useMemo(()=>F.findIndex(Vr=>Vr.toastId===N.id)||0,[F,N.id]),$t=_e.useMemo(()=>{var Vr;return(Vr=N.closeButton)!=null?Vr:se},[N.closeButton,se]),lr=_e.useMemo(()=>N.duration||$e||z5,[N.duration,$e]),ze=_e.useRef(0),Fe=_e.useRef(0),jn=_e.useRef(0),Xn=_e.useRef(null),[mr,Ur]=nt.split("-"),yi=_e.useMemo(()=>F.reduce((Vr,Rt,Jr)=>Jr>=hr?Vr:Vr+Rt.height,0),[F,hr]),Hi=Mle(),xr=N.invert||E,dr=rn==="loading";Fe.current=_e.useMemo(()=>hr*Me+yi,[hr,yi]),_e.useEffect(()=>{Nn.current=lr},[lr]),_e.useEffect(()=>{jt(!0)},[]),_e.useEffect(()=>{const Vr=ui.current;if(Vr){const Rt=Vr.getBoundingClientRect().height;return qr(Rt),$(Jr=>[{toastId:N.id,height:Rt,position:N.position},...Jr]),()=>$(Jr=>Jr.filter(xa=>xa.toastId!==N.id))}},[$,N.id]),_e.useLayoutEffect(()=>{if(!Je)return;const Vr=ui.current,Rt=Vr.style.height;Vr.style.height="auto";const Jr=Vr.getBoundingClientRect().height;Vr.style.height=Rt,qr(Jr),$(xa=>xa.find(Dr=>Dr.toastId===N.id)?xa.map(Dr=>Dr.toastId===N.id?{...Dr,height:Jr}:Dr):[{toastId:N.id,height:Jr,position:N.position},...xa])},[Je,N.title,N.description,$,N.id,N.jsx,N.action,N.cancel]);const Ki=_e.useCallback(()=>{Ot(!0),or(Fe.current),$(Vr=>Vr.filter(Rt=>Rt.toastId!==N.id)),setTimeout(()=>{ae(N)},qle)},[N,ae,$,Fe]);_e.useEffect(()=>{if(N.promise&&rn==="loading"||N.duration===1/0||N.type==="loading")return;let Vr;return X||V||Hi?(()=>{if(jn.current<ze.current){const xa=new Date().getTime()-ze.current;Nn.current=Nn.current-xa}jn.current=new Date().getTime()})():(()=>{Nn.current!==1/0&&(ze.current=new Date().getTime(),Vr=setTimeout(()=>{N.onAutoClose==null||N.onAutoClose.call(N,N),Ki()},Nn.current))})(),()=>clearTimeout(Vr)},[X,V,N,rn,Hi,Ki]),_e.useEffect(()=>{N.delete&&(Ki(),N.onDismiss==null||N.onDismiss.call(N,N))},[Ki,N.delete]);function Di(){var Vr;if(it?.loading){var Rt;return _e.createElement("div",{className:Bp(Ee?.loader,N==null||(Rt=N.classNames)==null?void 0:Rt.loader,"sonner-loader"),"data-visible":rn==="loading"},it.loading)}return _e.createElement(Ale,{className:Bp(Ee?.loader,N==null||(Vr=N.classNames)==null?void 0:Vr.loader),visible:rn==="loading"})}const Ji=N.icon||it?.[rn]||Sle(rn);var bs,Ys;return _e.createElement("li",{tabIndex:0,ref:ui,className:Bp(Ve,Vt,Ee?.toast,N==null||(t=N.classNames)==null?void 0:t.toast,Ee?.default,Ee?.[rn],N==null||(n=N.classNames)==null?void 0:n[rn]),"data-sonner-toast":"","data-rich-colors":(bs=N.richColors)!=null?bs:Z,"data-styled":!(N.jsx||N.unstyled||D),"data-mounted":Je,"data-promise":!!N.promise,"data-swiped":nr,"data-removed":Pt,"data-visible":qt,"data-y-position":mr,"data-x-position":Ur,"data-index":K,"data-front":st,"data-swiping":Mt,"data-dismissible":Wn,"data-type":rn,"data-invert":xr,"data-swipe-out":Jt,"data-swipe-direction":pt,"data-expanded":!!(X||rt&&Je),"data-testid":N.testId,style:{"--index":K,"--toasts-before":K,"--z-index":Y.length-K,"--offset":`${Pt?zr:Fe.current}px`,"--initial-height":rt?"auto":`${Rr}px`,...he,...N.style},onDragEnd:()=>{an(!1),He(null),Xn.current=null},onPointerDown:Vr=>{Vr.button!==2&&(dr||!Wn||(ci.current=new Date,or(Fe.current),Vr.target.setPointerCapture(Vr.pointerId),Vr.target.tagName!=="BUTTON"&&(an(!0),Xn.current={x:Vr.clientX,y:Vr.clientY})))},onPointerUp:()=>{var Vr,Rt,Jr;if(Jt||!Wn)return;Xn.current=null;const xa=Number(((Vr=ui.current)==null?void 0:Vr.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),ka=Number(((Rt=ui.current)==null?void 0:Rt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Dr=new Date().getTime()-((Jr=ci.current)==null?void 0:Jr.getTime()),gt=mt==="x"?xa:ka,Q=Math.abs(gt)/Dr;if(Math.abs(gt)>=$le||Q>.11){or(Fe.current),N.onDismiss==null||N.onDismiss.call(N,N),We(mt==="x"?xa>0?"right":"left":ka>0?"down":"up"),Ki(),Cn(!0);return}else{var fe,Te;(fe=ui.current)==null||fe.style.setProperty("--swipe-amount-x","0px"),(Te=ui.current)==null||Te.style.setProperty("--swipe-amount-y","0px")}sn(!1),an(!1),He(null)},onPointerMove:Vr=>{var Rt,Jr,xa;if(!Xn.current||!Wn||((Rt=window.getSelection())==null?void 0:Rt.toString().length)>0)return;const Dr=Vr.clientY-Xn.current.y,gt=Vr.clientX-Xn.current.x;var Q;const fe=(Q=e.swipeDirections)!=null?Q:Hle(nt);!mt&&(Math.abs(gt)>1||Math.abs(Dr)>1)&&He(Math.abs(gt)>Math.abs(Dr)?"x":"y");let Te={x:0,y:0};const ke=Oe=>1/(1.5+Math.abs(Oe)/20);if(mt==="y"){if(fe.includes("top")||fe.includes("bottom"))if(fe.includes("top")&&Dr<0||fe.includes("bottom")&&Dr>0)Te.y=Dr;else{const Oe=Dr*ke(Dr);Te.y=Math.abs(Oe)<Math.abs(Dr)?Oe:Dr}}else if(mt==="x"&&(fe.includes("left")||fe.includes("right")))if(fe.includes("left")&&gt<0||fe.includes("right")&&gt>0)Te.x=gt;else{const Oe=gt*ke(gt);Te.x=Math.abs(Oe)<Math.abs(gt)?Oe:gt}(Math.abs(Te.x)>0||Math.abs(Te.y)>0)&&sn(!0),(Jr=ui.current)==null||Jr.style.setProperty("--swipe-amount-x",`${Te.x}px`),(xa=ui.current)==null||xa.style.setProperty("--swipe-amount-y",`${Te.y}px`)}},$t&&!N.jsx&&rn!=="loading"?_e.createElement("button",{"aria-label":et,"data-disabled":dr,"data-close-button":!0,onClick:dr||!Wn?()=>{}:()=>{Ki(),N.onDismiss==null||N.onDismiss.call(N,N)},className:Bp(Ee?.closeButton,N==null||(r=N.classNames)==null?void 0:r.closeButton)},(Ys=it?.close)!=null?Ys:Ple):null,(rn||N.icon||N.promise)&&N.icon!==null&&(it?.[rn]!==null||N.icon)?_e.createElement("div",{"data-icon":"",className:Bp(Ee?.icon,N==null||(c=N.classNames)==null?void 0:c.icon)},N.promise||N.type==="loading"&&!N.icon?N.icon||Di():null,N.type!=="loading"?Ji:null):null,_e.createElement("div",{"data-content":"",className:Bp(Ee?.content,N==null||(f=N.classNames)==null?void 0:f.content)},_e.createElement("div",{"data-title":"",className:Bp(Ee?.title,N==null||(p=N.classNames)==null?void 0:p.title)},N.jsx?N.jsx:typeof N.title=="function"?N.title():N.title),N.description?_e.createElement("div",{"data-description":"",className:Bp(Re,un,Ee?.description,N==null||(s=N.classNames)==null?void 0:s.description)},typeof N.description=="function"?N.description():N.description):null),_e.isValidElement(N.cancel)?N.cancel:N.cancel&&X2(N.cancel)?_e.createElement("button",{"data-button":!0,"data-cancel":!0,style:N.cancelButtonStyle||ye,onClick:Vr=>{X2(N.cancel)&&Wn&&(N.cancel.onClick==null||N.cancel.onClick.call(N.cancel,Vr),Ki())},className:Bp(Ee?.cancelButton,N==null||(w=N.classNames)==null?void 0:w.cancelButton)},N.cancel.label):null,_e.isValidElement(N.action)?N.action:N.action&&X2(N.action)?_e.createElement("button",{"data-button":!0,"data-action":!0,style:N.actionButtonStyle||Ce,onClick:Vr=>{X2(N.action)&&(N.action.onClick==null||N.action.onClick.call(N.action,Vr),!Vr.defaultPrevented&&Ki())},className:Bp(Ee?.actionButton,N==null||(T=N.classNames)==null?void 0:T.actionButton)},N.action.label):null)};function F5(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Wle(e,t){const n={};return[e,t].forEach((r,c)=>{const f=c===1,p=f?"--mobile-offset":"--offset",s=f?Ble:Fle;function w(T){["top","right","bottom","left"].forEach(E=>{n[`${p}-${E}`]=typeof T=="number"?`${T}px`:T})}typeof r=="number"||typeof r=="string"?w(r):typeof r=="object"?["top","right","bottom","left"].forEach(T=>{r[T]===void 0?n[`${p}-${T}`]=s:n[`${p}-${T}`]=typeof r[T]=="number"?`${r[T]}px`:r[T]}):w(s)}),n}const KS=_e.forwardRef(function(t,n){const{id:r,invert:c,position:f="bottom-right",hotkey:p=["altKey","KeyT"],expand:s,closeButton:w,className:T,offset:E,mobileOffset:N,theme:D="light",richColors:V,duration:$,style:B,visibleToasts:F=zle,toastOptions:K,dir:Y=F5(),gap:X=Vle,icons:ae,containerAriaLabel:Z="Notifications"}=t,[se,he]=_e.useState([]),ye=_e.useMemo(()=>r?se.filter(Je=>Je.toasterId===r):se.filter(Je=>!Je.toasterId),[se,r]),Ce=_e.useMemo(()=>Array.from(new Set([f].concat(ye.filter(Je=>Je.position).map(Je=>Je.position)))),[ye,f]),[Ve,Re]=_e.useState([]),[$e,nt]=_e.useState(!1),[Me,rt]=_e.useState(!1),[Ee,it]=_e.useState(D!=="system"?D:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),et=_e.useRef(null),mt=p.join("+").replace(/Key/g,"").replace(/Digit/g,""),He=_e.useRef(null),pt=_e.useRef(!1),We=_e.useCallback(Je=>{he(jt=>{var Pt;return(Pt=jt.find(Ot=>Ot.id===Je.id))!=null&&Pt.delete||Zu.dismiss(Je.id),jt.filter(({id:Ot})=>Ot!==Je.id)})},[]);return _e.useEffect(()=>Zu.subscribe(Je=>{if(Je.dismiss){requestAnimationFrame(()=>{he(jt=>jt.map(Pt=>Pt.id===Je.id?{...Pt,delete:!0}:Pt))});return}setTimeout(()=>{gW.flushSync(()=>{he(jt=>{const Pt=jt.findIndex(Ot=>Ot.id===Je.id);return Pt!==-1?[...jt.slice(0,Pt),{...jt[Pt],...Je},...jt.slice(Pt+1)]:[Je,...jt]})})})}),[se]),_e.useEffect(()=>{if(D!=="system"){it(D);return}if(D==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?it("dark"):it("light")),typeof window>"u")return;const Je=window.matchMedia("(prefers-color-scheme: dark)");try{Je.addEventListener("change",({matches:jt})=>{it(jt?"dark":"light")})}catch{Je.addListener(({matches:Pt})=>{try{it(Pt?"dark":"light")}catch(Ot){console.error(Ot)}})}},[D]),_e.useEffect(()=>{se.length<=1&&nt(!1)},[se]),_e.useEffect(()=>{const Je=jt=>{var Pt;if(p.every(an=>jt[an]||jt.code===an)){var Mt;nt(!0),(Mt=et.current)==null||Mt.focus()}jt.code==="Escape"&&(document.activeElement===et.current||(Pt=et.current)!=null&&Pt.contains(document.activeElement))&&nt(!1)};return document.addEventListener("keydown",Je),()=>document.removeEventListener("keydown",Je)},[p]),_e.useEffect(()=>{if(et.current)return()=>{He.current&&(He.current.focus({preventScroll:!0}),He.current=null,pt.current=!1)}},[et.current]),_e.createElement("section",{ref:n,"aria-label":`${Z} ${mt}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},Ce.map((Je,jt)=>{var Pt;const[Ot,Mt]=Je.split("-");return ye.length?_e.createElement("ol",{key:Je,dir:Y==="auto"?F5():Y,tabIndex:-1,ref:et,className:T,"data-sonner-toaster":!0,"data-sonner-theme":Ee,"data-y-position":Ot,"data-x-position":Mt,style:{"--front-toast-height":`${((Pt=Ve[0])==null?void 0:Pt.height)||0}px`,"--width":`${Ule}px`,"--gap":`${X}px`,...B,...Wle(E,N)},onBlur:an=>{pt.current&&!an.currentTarget.contains(an.relatedTarget)&&(pt.current=!1,He.current&&(He.current.focus({preventScroll:!0}),He.current=null))},onFocus:an=>{an.target instanceof HTMLElement&&an.target.dataset.dismissible==="false"||pt.current||(pt.current=!0,He.current=an.relatedTarget)},onMouseEnter:()=>nt(!0),onMouseMove:()=>nt(!0),onMouseLeave:()=>{Me||nt(!1)},onDragEnd:()=>nt(!1),onPointerDown:an=>{an.target instanceof HTMLElement&&an.target.dataset.dismissible==="false"||rt(!0)},onPointerUp:()=>rt(!1)},ye.filter(an=>!an.position&&jt===0||an.position===Je).map((an,Jt)=>{var Cn,nr;return _e.createElement(Gle,{key:an.id,icons:ae,index:Jt,toast:an,defaultRichColors:V,duration:(Cn=K?.duration)!=null?Cn:$,className:K?.className,descriptionClassName:K?.descriptionClassName,invert:c,visibleToasts:F,closeButton:(nr=K?.closeButton)!=null?nr:w,interacting:Me,position:Je,style:K?.style,unstyled:K?.unstyled,classNames:K?.classNames,cancelButtonStyle:K?.cancelButtonStyle,actionButtonStyle:K?.actionButtonStyle,closeButtonAriaLabel:K?.closeButtonAriaLabel,removeToast:We,toasts:ye.filter(sn=>sn.position==an.position),heights:Ve.filter(sn=>sn.position==an.position),setHeights:Re,expandByDefault:s,gap:X,expanded:$e,swipeDirections:t.swipeDirections})})):null}))}),Xle=({...e})=>{const{theme:t="system"}=ble();return o.jsx(KS,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})};function yW(e,t){return function(){return e.apply(t,arguments)}}const{toString:Zle}=Object.prototype,{getPrototypeOf:t3}=Object,{iterator:ME,toStringTag:vW}=Symbol,RE=(e=>t=>{const n=Zle.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),qf=e=>(e=e.toLowerCase(),t=>RE(t)===e),OE=e=>t=>typeof t===e,{isArray:Nb}=Array,G0=OE("undefined");function JS(e){return e!==null&&!G0(e)&&e.constructor!==null&&!G0(e.constructor)&&Qu(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const xW=qf("ArrayBuffer");function Yle(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&xW(e.buffer),t}const Kle=OE("string"),Qu=OE("function"),_W=OE("number"),QS=e=>e!==null&&typeof e=="object",Jle=e=>e===!0||e===!1,TA=e=>{if(RE(e)!=="object")return!1;const t=t3(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(vW in e)&&!(ME in e)},Qle=e=>{if(!QS(e)||JS(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},ece=qf("Date"),tce=qf("File"),nce=qf("Blob"),rce=qf("FileList"),ice=e=>QS(e)&&Qu(e.pipe),sce=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Qu(e.append)&&((t=RE(e))==="formdata"||t==="object"&&Qu(e.toString)&&e.toString()==="[object FormData]"))},ace=qf("URLSearchParams"),[oce,lce,cce,uce]=["ReadableStream","Request","Response","Headers"].map(qf),dce=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function eT(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,c;if(typeof e!="object"&&(e=[e]),Nb(e))for(r=0,c=e.length;r<c;r++)t.call(null,e[r],r,e);else{if(JS(e))return;const f=n?Object.getOwnPropertyNames(e):Object.keys(e),p=f.length;let s;for(r=0;r<p;r++)s=f[r],t.call(null,e[s],s,e)}}function bW(e,t){if(JS(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r=n.length,c;for(;r-- >0;)if(c=n[r],t===c.toLowerCase())return c;return null}const Ox=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,wW=e=>!G0(e)&&e!==Ox;function wk(){const{caseless:e,skipUndefined:t}=wW(this)&&this||{},n={},r=(c,f)=>{const p=e&&bW(n,f)||f;TA(n[p])&&TA(c)?n[p]=wk(n[p],c):TA(c)?n[p]=wk({},c):Nb(c)?n[p]=c.slice():(!t||!G0(c))&&(n[p]=c)};for(let c=0,f=arguments.length;c<f;c++)arguments[c]&&eT(arguments[c],r);return n}const hce=(e,t,n,{allOwnKeys:r}={})=>(eT(t,(c,f)=>{n&&Qu(c)?e[f]=yW(c,n):e[f]=c},{allOwnKeys:r}),e),fce=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),pce=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},mce=(e,t,n,r)=>{let c,f,p;const s={};if(t=t||{},e==null)return t;do{for(c=Object.getOwnPropertyNames(e),f=c.length;f-- >0;)p=c[f],(!r||r(p,e,t))&&!s[p]&&(t[p]=e[p],s[p]=!0);e=n!==!1&&t3(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},gce=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},yce=e=>{if(!e)return null;if(Nb(e))return e;let t=e.length;if(!_W(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},vce=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&t3(Uint8Array)),xce=(e,t)=>{const r=(e&&e[ME]).call(e);let c;for(;(c=r.next())&&!c.done;){const f=c.value;t.call(e,f[0],f[1])}},_ce=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},bce=qf("HTMLFormElement"),wce=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,c){return r.toUpperCase()+c}),B5=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Sce=qf("RegExp"),SW=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};eT(n,(c,f)=>{let p;(p=t(c,f,e))!==!1&&(r[f]=p||c)}),Object.defineProperties(e,r)},Tce=e=>{SW(e,(t,n)=>{if(Qu(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(Qu(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Ace=(e,t)=>{const n={},r=c=>{c.forEach(f=>{n[f]=!0})};return Nb(e)?r(e):r(String(e).split(t)),n},jce=()=>{},Ece=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Cce(e){return!!(e&&Qu(e.append)&&e[vW]==="FormData"&&e[ME])}const Nce=e=>{const t=new Array(10),n=(r,c)=>{if(QS(r)){if(t.indexOf(r)>=0)return;if(JS(r))return r;if(!("toJSON"in r)){t[c]=r;const f=Nb(r)?[]:{};return eT(r,(p,s)=>{const w=n(p,c+1);!G0(w)&&(f[s]=w)}),t[c]=void 0,f}}return r};return n(e,0)},Pce=qf("AsyncFunction"),Mce=e=>e&&(QS(e)||Qu(e))&&Qu(e.then)&&Qu(e.catch),TW=((e,t)=>e?setImmediate:t?((n,r)=>(Ox.addEventListener("message",({source:c,data:f})=>{c===Ox&&f===n&&r.length&&r.shift()()},!1),c=>{r.push(c),Ox.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Qu(Ox.postMessage)),Rce=typeof queueMicrotask<"u"?queueMicrotask.bind(Ox):typeof process<"u"&&process.nextTick||TW,Oce=e=>e!=null&&Qu(e[ME]),Mn={isArray:Nb,isArrayBuffer:xW,isBuffer:JS,isFormData:sce,isArrayBufferView:Yle,isString:Kle,isNumber:_W,isBoolean:Jle,isObject:QS,isPlainObject:TA,isEmptyObject:Qle,isReadableStream:oce,isRequest:lce,isResponse:cce,isHeaders:uce,isUndefined:G0,isDate:ece,isFile:tce,isBlob:nce,isRegExp:Sce,isFunction:Qu,isStream:ice,isURLSearchParams:ace,isTypedArray:vce,isFileList:rce,forEach:eT,merge:wk,extend:hce,trim:dce,stripBOM:fce,inherits:pce,toFlatObject:mce,kindOf:RE,kindOfTest:qf,endsWith:gce,toArray:yce,forEachEntry:xce,matchAll:_ce,isHTMLForm:bce,hasOwnProperty:B5,hasOwnProp:B5,reduceDescriptors:SW,freezeMethods:Tce,toObjectSet:Ace,toCamelCase:wce,noop:jce,toFiniteNumber:Ece,findKey:bW,global:Ox,isContextDefined:wW,isSpecCompliantForm:Cce,toJSONObject:Nce,isAsyncFn:Pce,isThenable:Mce,setImmediate:TW,asap:Rce,isIterable:Oce};function Rs(e,t,n,r,c){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),c&&(this.response=c,this.status=c.status?c.status:null)}Mn.inherits(Rs,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Mn.toJSONObject(this.config),code:this.code,status:this.status}}});const AW=Rs.prototype,jW={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{jW[e]={value:e}});Object.defineProperties(Rs,jW);Object.defineProperty(AW,"isAxiosError",{value:!0});Rs.from=(e,t,n,r,c,f)=>{const p=Object.create(AW);Mn.toFlatObject(e,p,function(E){return E!==Error.prototype},T=>T!=="isAxiosError");const s=e&&e.message?e.message:"Error",w=t==null&&e?e.code:t;return Rs.call(p,s,w,n,r,c),e&&p.cause==null&&Object.defineProperty(p,"cause",{value:e,configurable:!0}),p.name=e&&e.name||"Error",f&&Object.assign(p,f),p};const Dce=null;function Sk(e){return Mn.isPlainObject(e)||Mn.isArray(e)}function EW(e){return Mn.endsWith(e,"[]")?e.slice(0,-2):e}function U5(e,t,n){return e?e.concat(t).map(function(c,f){return c=EW(c),!n&&f?"["+c+"]":c}).join(n?".":""):t}function kce(e){return Mn.isArray(e)&&!e.some(Sk)}const Ice=Mn.toFlatObject(Mn,{},null,function(t){return/^is[A-Z]/.test(t)});function DE(e,t,n){if(!Mn.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=Mn.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(B,F){return!Mn.isUndefined(F[B])});const r=n.metaTokens,c=n.visitor||E,f=n.dots,p=n.indexes,w=(n.Blob||typeof Blob<"u"&&Blob)&&Mn.isSpecCompliantForm(t);if(!Mn.isFunction(c))throw new TypeError("visitor must be a function");function T($){if($===null)return"";if(Mn.isDate($))return $.toISOString();if(Mn.isBoolean($))return $.toString();if(!w&&Mn.isBlob($))throw new Rs("Blob is not supported. Use a Buffer instead.");return Mn.isArrayBuffer($)||Mn.isTypedArray($)?w&&typeof Blob=="function"?new Blob([$]):Buffer.from($):$}function E($,B,F){let K=$;if($&&!F&&typeof $=="object"){if(Mn.endsWith(B,"{}"))B=r?B:B.slice(0,-2),$=JSON.stringify($);else if(Mn.isArray($)&&kce($)||(Mn.isFileList($)||Mn.endsWith(B,"[]"))&&(K=Mn.toArray($)))return B=EW(B),K.forEach(function(X,ae){!(Mn.isUndefined(X)||X===null)&&t.append(p===!0?U5([B],ae,f):p===null?B:B+"[]",T(X))}),!1}return Sk($)?!0:(t.append(U5(F,B,f),T($)),!1)}const N=[],D=Object.assign(Ice,{defaultVisitor:E,convertValue:T,isVisitable:Sk});function V($,B){if(!Mn.isUndefined($)){if(N.indexOf($)!==-1)throw Error("Circular reference detected in "+B.join("."));N.push($),Mn.forEach($,function(K,Y){(!(Mn.isUndefined(K)||K===null)&&c.call(t,K,Mn.isString(Y)?Y.trim():Y,B,D))===!0&&V(K,B?B.concat(Y):[Y])}),N.pop()}}if(!Mn.isObject(e))throw new TypeError("data must be an object");return V(e),t}function V5(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function n3(e,t){this._pairs=[],e&&DE(e,this,t)}const CW=n3.prototype;CW.append=function(t,n){this._pairs.push([t,n])};CW.toString=function(t){const n=t?function(r){return t.call(this,r,V5)}:V5;return this._pairs.map(function(c){return n(c[0])+"="+n(c[1])},"").join("&")};function Lce(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function NW(e,t,n){if(!t)return e;const r=n&&n.encode||Lce;Mn.isFunction(n)&&(n={serialize:n});const c=n&&n.serialize;let f;if(c?f=c(t,n):f=Mn.isURLSearchParams(t)?t.toString():new n3(t,n).toString(r),f){const p=e.indexOf("#");p!==-1&&(e=e.slice(0,p)),e+=(e.indexOf("?")===-1?"?":"&")+f}return e}class $5{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Mn.forEach(this.handlers,function(r){r!==null&&t(r)})}}const PW={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},zce=typeof URLSearchParams<"u"?URLSearchParams:n3,Fce=typeof FormData<"u"?FormData:null,Bce=typeof Blob<"u"?Blob:null,Uce={isBrowser:!0,classes:{URLSearchParams:zce,FormData:Fce,Blob:Bce},protocols:["http","https","file","blob","url","data"]},r3=typeof window<"u"&&typeof document<"u",Tk=typeof navigator=="object"&&navigator||void 0,Vce=r3&&(!Tk||["ReactNative","NativeScript","NS"].indexOf(Tk.product)<0),$ce=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",qce=r3&&window.location.href||"http://localhost",Hce=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:r3,hasStandardBrowserEnv:Vce,hasStandardBrowserWebWorkerEnv:$ce,navigator:Tk,origin:qce},Symbol.toStringTag,{value:"Module"})),tu={...Hce,...Uce};function Gce(e,t){return DE(e,new tu.classes.URLSearchParams,{visitor:function(n,r,c,f){return tu.isNode&&Mn.isBuffer(n)?(this.append(r,n.toString("base64")),!1):f.defaultVisitor.apply(this,arguments)},...t})}function Wce(e){return Mn.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Xce(e){const t={},n=Object.keys(e);let r;const c=n.length;let f;for(r=0;r<c;r++)f=n[r],t[f]=e[f];return t}function MW(e){function t(n,r,c,f){let p=n[f++];if(p==="__proto__")return!0;const s=Number.isFinite(+p),w=f>=n.length;return p=!p&&Mn.isArray(c)?c.length:p,w?(Mn.hasOwnProp(c,p)?c[p]=[c[p],r]:c[p]=r,!s):((!c[p]||!Mn.isObject(c[p]))&&(c[p]=[]),t(n,r,c[p],f)&&Mn.isArray(c[p])&&(c[p]=Xce(c[p])),!s)}if(Mn.isFormData(e)&&Mn.isFunction(e.entries)){const n={};return Mn.forEachEntry(e,(r,c)=>{t(Wce(r),c,n,0)}),n}return null}function Zce(e,t,n){if(Mn.isString(e))try{return(t||JSON.parse)(e),Mn.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const tT={transitional:PW,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",c=r.indexOf("application/json")>-1,f=Mn.isObject(t);if(f&&Mn.isHTMLForm(t)&&(t=new FormData(t)),Mn.isFormData(t))return c?JSON.stringify(MW(t)):t;if(Mn.isArrayBuffer(t)||Mn.isBuffer(t)||Mn.isStream(t)||Mn.isFile(t)||Mn.isBlob(t)||Mn.isReadableStream(t))return t;if(Mn.isArrayBufferView(t))return t.buffer;if(Mn.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(f){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Gce(t,this.formSerializer).toString();if((s=Mn.isFileList(t))||r.indexOf("multipart/form-data")>-1){const w=this.env&&this.env.FormData;return DE(s?{"files[]":t}:t,w&&new w,this.formSerializer)}}return f||c?(n.setContentType("application/json",!1),Zce(t)):t}],transformResponse:[function(t){const n=this.transitional||tT.transitional,r=n&&n.forcedJSONParsing,c=this.responseType==="json";if(Mn.isResponse(t)||Mn.isReadableStream(t))return t;if(t&&Mn.isString(t)&&(r&&!this.responseType||c)){const p=!(n&&n.silentJSONParsing)&&c;try{return JSON.parse(t,this.parseReviver)}catch(s){if(p)throw s.name==="SyntaxError"?Rs.from(s,Rs.ERR_BAD_RESPONSE,this,null,this.response):s}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:tu.classes.FormData,Blob:tu.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Mn.forEach(["delete","get","head","post","put","patch"],e=>{tT.headers[e]={}});const Yce=Mn.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Kce=e=>{const t={};let n,r,c;return e&&e.split(`
`).forEach(function(p){c=p.indexOf(":"),n=p.substring(0,c).trim().toLowerCase(),r=p.substring(c+1).trim(),!(!n||t[n]&&Yce[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},q5=Symbol("internals");function l1(e){return e&&String(e).trim().toLowerCase()}function AA(e){return e===!1||e==null?e:Mn.isArray(e)?e.map(AA):String(e)}function Jce(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const Qce=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function gP(e,t,n,r,c){if(Mn.isFunction(r))return r.call(this,t,n);if(c&&(t=n),!!Mn.isString(t)){if(Mn.isString(r))return t.indexOf(r)!==-1;if(Mn.isRegExp(r))return r.test(t)}}function eue(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function tue(e,t){const n=Mn.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(c,f,p){return this[r].call(this,t,c,f,p)},configurable:!0})})}let ed=class{constructor(t){t&&this.set(t)}set(t,n,r){const c=this;function f(s,w,T){const E=l1(w);if(!E)throw new Error("header name must be a non-empty string");const N=Mn.findKey(c,E);(!N||c[N]===void 0||T===!0||T===void 0&&c[N]!==!1)&&(c[N||w]=AA(s))}const p=(s,w)=>Mn.forEach(s,(T,E)=>f(T,E,w));if(Mn.isPlainObject(t)||t instanceof this.constructor)p(t,n);else if(Mn.isString(t)&&(t=t.trim())&&!Qce(t))p(Kce(t),n);else if(Mn.isObject(t)&&Mn.isIterable(t)){let s={},w,T;for(const E of t){if(!Mn.isArray(E))throw TypeError("Object iterator must return a key-value pair");s[T=E[0]]=(w=s[T])?Mn.isArray(w)?[...w,E[1]]:[w,E[1]]:E[1]}p(s,n)}else t!=null&&f(n,t,r);return this}get(t,n){if(t=l1(t),t){const r=Mn.findKey(this,t);if(r){const c=this[r];if(!n)return c;if(n===!0)return Jce(c);if(Mn.isFunction(n))return n.call(this,c,r);if(Mn.isRegExp(n))return n.exec(c);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=l1(t),t){const r=Mn.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||gP(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let c=!1;function f(p){if(p=l1(p),p){const s=Mn.findKey(r,p);s&&(!n||gP(r,r[s],s,n))&&(delete r[s],c=!0)}}return Mn.isArray(t)?t.forEach(f):f(t),c}clear(t){const n=Object.keys(this);let r=n.length,c=!1;for(;r--;){const f=n[r];(!t||gP(this,this[f],f,t,!0))&&(delete this[f],c=!0)}return c}normalize(t){const n=this,r={};return Mn.forEach(this,(c,f)=>{const p=Mn.findKey(r,f);if(p){n[p]=AA(c),delete n[f];return}const s=t?eue(f):String(f).trim();s!==f&&delete n[f],n[s]=AA(c),r[s]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return Mn.forEach(this,(r,c)=>{r!=null&&r!==!1&&(n[c]=t&&Mn.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(c=>r.set(c)),r}static accessor(t){const r=(this[q5]=this[q5]={accessors:{}}).accessors,c=this.prototype;function f(p){const s=l1(p);r[s]||(tue(c,p),r[s]=!0)}return Mn.isArray(t)?t.forEach(f):f(t),this}};ed.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Mn.reduceDescriptors(ed.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});Mn.freezeMethods(ed);function yP(e,t){const n=this||tT,r=t||n,c=ed.from(r.headers);let f=r.data;return Mn.forEach(e,function(s){f=s.call(n,f,c.normalize(),t?t.status:void 0)}),c.normalize(),f}function RW(e){return!!(e&&e.__CANCEL__)}function Pb(e,t,n){Rs.call(this,e??"canceled",Rs.ERR_CANCELED,t,n),this.name="CanceledError"}Mn.inherits(Pb,Rs,{__CANCEL__:!0});function OW(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new Rs("Request failed with status code "+n.status,[Rs.ERR_BAD_REQUEST,Rs.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function nue(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function rue(e,t){e=e||10;const n=new Array(e),r=new Array(e);let c=0,f=0,p;return t=t!==void 0?t:1e3,function(w){const T=Date.now(),E=r[f];p||(p=T),n[c]=w,r[c]=T;let N=f,D=0;for(;N!==c;)D+=n[N++],N=N%e;if(c=(c+1)%e,c===f&&(f=(f+1)%e),T-p<t)return;const V=E&&T-E;return V?Math.round(D*1e3/V):void 0}}function iue(e,t){let n=0,r=1e3/t,c,f;const p=(T,E=Date.now())=>{n=E,c=null,f&&(clearTimeout(f),f=null),e(...T)};return[(...T)=>{const E=Date.now(),N=E-n;N>=r?p(T,E):(c=T,f||(f=setTimeout(()=>{f=null,p(c)},r-N)))},()=>c&&p(c)]}const VA=(e,t,n=3)=>{let r=0;const c=rue(50,250);return iue(f=>{const p=f.loaded,s=f.lengthComputable?f.total:void 0,w=p-r,T=c(w),E=p<=s;r=p;const N={loaded:p,total:s,progress:s?p/s:void 0,bytes:w,rate:T||void 0,estimated:T&&s&&E?(s-p)/T:void 0,event:f,lengthComputable:s!=null,[t?"download":"upload"]:!0};e(N)},n)},H5=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},G5=e=>(...t)=>Mn.asap(()=>e(...t)),sue=tu.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,tu.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(tu.origin),tu.navigator&&/(msie|trident)/i.test(tu.navigator.userAgent)):()=>!0,aue=tu.hasStandardBrowserEnv?{write(e,t,n,r,c,f){const p=[e+"="+encodeURIComponent(t)];Mn.isNumber(n)&&p.push("expires="+new Date(n).toGMTString()),Mn.isString(r)&&p.push("path="+r),Mn.isString(c)&&p.push("domain="+c),f===!0&&p.push("secure"),document.cookie=p.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function oue(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function lue(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function DW(e,t,n){let r=!oue(t);return e&&(r||n==!1)?lue(e,t):t}const W5=e=>e instanceof ed?{...e}:e;function Yx(e,t){t=t||{};const n={};function r(T,E,N,D){return Mn.isPlainObject(T)&&Mn.isPlainObject(E)?Mn.merge.call({caseless:D},T,E):Mn.isPlainObject(E)?Mn.merge({},E):Mn.isArray(E)?E.slice():E}function c(T,E,N,D){if(Mn.isUndefined(E)){if(!Mn.isUndefined(T))return r(void 0,T,N,D)}else return r(T,E,N,D)}function f(T,E){if(!Mn.isUndefined(E))return r(void 0,E)}function p(T,E){if(Mn.isUndefined(E)){if(!Mn.isUndefined(T))return r(void 0,T)}else return r(void 0,E)}function s(T,E,N){if(N in t)return r(T,E);if(N in e)return r(void 0,T)}const w={url:f,method:f,data:f,baseURL:p,transformRequest:p,transformResponse:p,paramsSerializer:p,timeout:p,timeoutMessage:p,withCredentials:p,withXSRFToken:p,adapter:p,responseType:p,xsrfCookieName:p,xsrfHeaderName:p,onUploadProgress:p,onDownloadProgress:p,decompress:p,maxContentLength:p,maxBodyLength:p,beforeRedirect:p,transport:p,httpAgent:p,httpsAgent:p,cancelToken:p,socketPath:p,responseEncoding:p,validateStatus:s,headers:(T,E,N)=>c(W5(T),W5(E),N,!0)};return Mn.forEach(Object.keys({...e,...t}),function(E){const N=w[E]||c,D=N(e[E],t[E],E);Mn.isUndefined(D)&&N!==s||(n[E]=D)}),n}const kW=e=>{const t=Yx({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:c,xsrfCookieName:f,headers:p,auth:s}=t;if(t.headers=p=ed.from(p),t.url=NW(DW(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),s&&p.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):""))),Mn.isFormData(n)){if(tu.hasStandardBrowserEnv||tu.hasStandardBrowserWebWorkerEnv)p.setContentType(void 0);else if(Mn.isFunction(n.getHeaders)){const w=n.getHeaders(),T=["content-type","content-length"];Object.entries(w).forEach(([E,N])=>{T.includes(E.toLowerCase())&&p.set(E,N)})}}if(tu.hasStandardBrowserEnv&&(r&&Mn.isFunction(r)&&(r=r(t)),r||r!==!1&&sue(t.url))){const w=c&&f&&aue.read(f);w&&p.set(c,w)}return t},cue=typeof XMLHttpRequest<"u",uue=cue&&function(e){return new Promise(function(n,r){const c=kW(e);let f=c.data;const p=ed.from(c.headers).normalize();let{responseType:s,onUploadProgress:w,onDownloadProgress:T}=c,E,N,D,V,$;function B(){V&&V(),$&&$(),c.cancelToken&&c.cancelToken.unsubscribe(E),c.signal&&c.signal.removeEventListener("abort",E)}let F=new XMLHttpRequest;F.open(c.method.toUpperCase(),c.url,!0),F.timeout=c.timeout;function K(){if(!F)return;const X=ed.from("getAllResponseHeaders"in F&&F.getAllResponseHeaders()),Z={data:!s||s==="text"||s==="json"?F.responseText:F.response,status:F.status,statusText:F.statusText,headers:X,config:e,request:F};OW(function(he){n(he),B()},function(he){r(he),B()},Z),F=null}"onloadend"in F?F.onloadend=K:F.onreadystatechange=function(){!F||F.readyState!==4||F.status===0&&!(F.responseURL&&F.responseURL.indexOf("file:")===0)||setTimeout(K)},F.onabort=function(){F&&(r(new Rs("Request aborted",Rs.ECONNABORTED,e,F)),F=null)},F.onerror=function(ae){const Z=ae&&ae.message?ae.message:"Network Error",se=new Rs(Z,Rs.ERR_NETWORK,e,F);se.event=ae||null,r(se),F=null},F.ontimeout=function(){let ae=c.timeout?"timeout of "+c.timeout+"ms exceeded":"timeout exceeded";const Z=c.transitional||PW;c.timeoutErrorMessage&&(ae=c.timeoutErrorMessage),r(new Rs(ae,Z.clarifyTimeoutError?Rs.ETIMEDOUT:Rs.ECONNABORTED,e,F)),F=null},f===void 0&&p.setContentType(null),"setRequestHeader"in F&&Mn.forEach(p.toJSON(),function(ae,Z){F.setRequestHeader(Z,ae)}),Mn.isUndefined(c.withCredentials)||(F.withCredentials=!!c.withCredentials),s&&s!=="json"&&(F.responseType=c.responseType),T&&([D,$]=VA(T,!0),F.addEventListener("progress",D)),w&&F.upload&&([N,V]=VA(w),F.upload.addEventListener("progress",N),F.upload.addEventListener("loadend",V)),(c.cancelToken||c.signal)&&(E=X=>{F&&(r(!X||X.type?new Pb(null,e,F):X),F.abort(),F=null)},c.cancelToken&&c.cancelToken.subscribe(E),c.signal&&(c.signal.aborted?E():c.signal.addEventListener("abort",E)));const Y=nue(c.url);if(Y&&tu.protocols.indexOf(Y)===-1){r(new Rs("Unsupported protocol "+Y+":",Rs.ERR_BAD_REQUEST,e));return}F.send(f||null)})},due=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,c;const f=function(T){if(!c){c=!0,s();const E=T instanceof Error?T:this.reason;r.abort(E instanceof Rs?E:new Pb(E instanceof Error?E.message:E))}};let p=t&&setTimeout(()=>{p=null,f(new Rs(`timeout ${t} of ms exceeded`,Rs.ETIMEDOUT))},t);const s=()=>{e&&(p&&clearTimeout(p),p=null,e.forEach(T=>{T.unsubscribe?T.unsubscribe(f):T.removeEventListener("abort",f)}),e=null)};e.forEach(T=>T.addEventListener("abort",f));const{signal:w}=r;return w.unsubscribe=()=>Mn.asap(s),w}},hue=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,c;for(;r<n;)c=r+t,yield e.slice(r,c),r=c},fue=async function*(e,t){for await(const n of pue(e))yield*hue(n,t)},pue=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},X5=(e,t,n,r)=>{const c=fue(e,t);let f=0,p,s=w=>{p||(p=!0,r&&r(w))};return new ReadableStream({async pull(w){try{const{done:T,value:E}=await c.next();if(T){s(),w.close();return}let N=E.byteLength;if(n){let D=f+=N;n(D)}w.enqueue(new Uint8Array(E))}catch(T){throw s(T),T}},cancel(w){return s(w),c.return()}},{highWaterMark:2})},Z5=64*1024,{isFunction:Z2}=Mn,mue=(({Request:e,Response:t})=>({Request:e,Response:t}))(Mn.global),{ReadableStream:Y5,TextEncoder:K5}=Mn.global,J5=(e,...t)=>{try{return!!e(...t)}catch{return!1}},gue=e=>{e=Mn.merge.call({skipUndefined:!0},mue,e);const{fetch:t,Request:n,Response:r}=e,c=t?Z2(t):typeof fetch=="function",f=Z2(n),p=Z2(r);if(!c)return!1;const s=c&&Z2(Y5),w=c&&(typeof K5=="function"?($=>B=>$.encode(B))(new K5):async $=>new Uint8Array(await new n($).arrayBuffer())),T=f&&s&&J5(()=>{let $=!1;const B=new n(tu.origin,{body:new Y5,method:"POST",get duplex(){return $=!0,"half"}}).headers.has("Content-Type");return $&&!B}),E=p&&s&&J5(()=>Mn.isReadableStream(new r("").body)),N={stream:E&&($=>$.body)};c&&["text","arrayBuffer","blob","formData","stream"].forEach($=>{!N[$]&&(N[$]=(B,F)=>{let K=B&&B[$];if(K)return K.call(B);throw new Rs(`Response type '${$}' is not supported`,Rs.ERR_NOT_SUPPORT,F)})});const D=async $=>{if($==null)return 0;if(Mn.isBlob($))return $.size;if(Mn.isSpecCompliantForm($))return(await new n(tu.origin,{method:"POST",body:$}).arrayBuffer()).byteLength;if(Mn.isArrayBufferView($)||Mn.isArrayBuffer($))return $.byteLength;if(Mn.isURLSearchParams($)&&($=$+""),Mn.isString($))return(await w($)).byteLength},V=async($,B)=>{const F=Mn.toFiniteNumber($.getContentLength());return F??D(B)};return async $=>{let{url:B,method:F,data:K,signal:Y,cancelToken:X,timeout:ae,onDownloadProgress:Z,onUploadProgress:se,responseType:he,headers:ye,withCredentials:Ce="same-origin",fetchOptions:Ve}=kW($),Re=t||fetch;he=he?(he+"").toLowerCase():"text";let $e=due([Y,X&&X.toAbortSignal()],ae),nt=null;const Me=$e&&$e.unsubscribe&&(()=>{$e.unsubscribe()});let rt;try{if(se&&T&&F!=="get"&&F!=="head"&&(rt=await V(ye,K))!==0){let pt=new n(B,{method:"POST",body:K,duplex:"half"}),We;if(Mn.isFormData(K)&&(We=pt.headers.get("content-type"))&&ye.setContentType(We),pt.body){const[Je,jt]=H5(rt,VA(G5(se)));K=X5(pt.body,Z5,Je,jt)}}Mn.isString(Ce)||(Ce=Ce?"include":"omit");const Ee=f&&"credentials"in n.prototype,it={...Ve,signal:$e,method:F.toUpperCase(),headers:ye.normalize().toJSON(),body:K,duplex:"half",credentials:Ee?Ce:void 0};nt=f&&new n(B,it);let et=await(f?Re(nt,Ve):Re(B,it));const mt=E&&(he==="stream"||he==="response");if(E&&(Z||mt&&Me)){const pt={};["status","statusText","headers"].forEach(Pt=>{pt[Pt]=et[Pt]});const We=Mn.toFiniteNumber(et.headers.get("content-length")),[Je,jt]=Z&&H5(We,VA(G5(Z),!0))||[];et=new r(X5(et.body,Z5,Je,()=>{jt&&jt(),Me&&Me()}),pt)}he=he||"text";let He=await N[Mn.findKey(N,he)||"text"](et,$);return!mt&&Me&&Me(),await new Promise((pt,We)=>{OW(pt,We,{data:He,headers:ed.from(et.headers),status:et.status,statusText:et.statusText,config:$,request:nt})})}catch(Ee){throw Me&&Me(),Ee&&Ee.name==="TypeError"&&/Load failed|fetch/i.test(Ee.message)?Object.assign(new Rs("Network Error",Rs.ERR_NETWORK,$,nt),{cause:Ee.cause||Ee}):Rs.from(Ee,Ee&&Ee.code,$,nt)}}},yue=new Map,IW=e=>{let t=e?e.env:{};const{fetch:n,Request:r,Response:c}=t,f=[r,c,n];let p=f.length,s=p,w,T,E=yue;for(;s--;)w=f[s],T=E.get(w),T===void 0&&E.set(w,T=s?new Map:gue(t)),E=T;return T};IW();const Ak={http:Dce,xhr:uue,fetch:{get:IW}};Mn.forEach(Ak,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Q5=e=>`- ${e}`,vue=e=>Mn.isFunction(e)||e===null||e===!1,LW={getAdapter:(e,t)=>{e=Mn.isArray(e)?e:[e];const{length:n}=e;let r,c;const f={};for(let p=0;p<n;p++){r=e[p];let s;if(c=r,!vue(r)&&(c=Ak[(s=String(r)).toLowerCase()],c===void 0))throw new Rs(`Unknown adapter '${s}'`);if(c&&(Mn.isFunction(c)||(c=c.get(t))))break;f[s||"#"+p]=c}if(!c){const p=Object.entries(f).map(([w,T])=>`adapter ${w} `+(T===!1?"is not supported by the environment":"is not available in the build"));let s=n?p.length>1?`since :
`+p.map(Q5).join(`
`):" "+Q5(p[0]):"as no adapter specified";throw new Rs("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return c},adapters:Ak};function vP(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Pb(null,e)}function e6(e){return vP(e),e.headers=ed.from(e.headers),e.data=yP.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),LW.getAdapter(e.adapter||tT.adapter,e)(e).then(function(r){return vP(e),r.data=yP.call(e,e.transformResponse,r),r.headers=ed.from(r.headers),r},function(r){return RW(r)||(vP(e),r&&r.response&&(r.response.data=yP.call(e,e.transformResponse,r.response),r.response.headers=ed.from(r.response.headers))),Promise.reject(r)})}const zW="1.12.2",kE={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{kE[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const t6={};kE.transitional=function(t,n,r){function c(f,p){return"[Axios v"+zW+"] Transitional option '"+f+"'"+p+(r?". "+r:"")}return(f,p,s)=>{if(t===!1)throw new Rs(c(p," has been removed"+(n?" in "+n:"")),Rs.ERR_DEPRECATED);return n&&!t6[p]&&(t6[p]=!0,console.warn(c(p," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(f,p,s):!0}};kE.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function xue(e,t,n){if(typeof e!="object")throw new Rs("options must be an object",Rs.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let c=r.length;for(;c-- >0;){const f=r[c],p=t[f];if(p){const s=e[f],w=s===void 0||p(s,f,e);if(w!==!0)throw new Rs("option "+f+" must be "+w,Rs.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Rs("Unknown option "+f,Rs.ERR_BAD_OPTION)}}const jA={assertOptions:xue,validators:kE},Up=jA.validators;let $x=class{constructor(t){this.defaults=t||{},this.interceptors={request:new $5,response:new $5}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let c={};Error.captureStackTrace?Error.captureStackTrace(c):c=new Error;const f=c.stack?c.stack.replace(/^.+\n/,""):"";try{r.stack?f&&!String(r.stack).endsWith(f.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+f):r.stack=f}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Yx(this.defaults,n);const{transitional:r,paramsSerializer:c,headers:f}=n;r!==void 0&&jA.assertOptions(r,{silentJSONParsing:Up.transitional(Up.boolean),forcedJSONParsing:Up.transitional(Up.boolean),clarifyTimeoutError:Up.transitional(Up.boolean)},!1),c!=null&&(Mn.isFunction(c)?n.paramsSerializer={serialize:c}:jA.assertOptions(c,{encode:Up.function,serialize:Up.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),jA.assertOptions(n,{baseUrl:Up.spelling("baseURL"),withXsrfToken:Up.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let p=f&&Mn.merge(f.common,f[n.method]);f&&Mn.forEach(["delete","get","head","post","put","patch","common"],$=>{delete f[$]}),n.headers=ed.concat(p,f);const s=[];let w=!0;this.interceptors.request.forEach(function(B){typeof B.runWhen=="function"&&B.runWhen(n)===!1||(w=w&&B.synchronous,s.unshift(B.fulfilled,B.rejected))});const T=[];this.interceptors.response.forEach(function(B){T.push(B.fulfilled,B.rejected)});let E,N=0,D;if(!w){const $=[e6.bind(this),void 0];for($.unshift(...s),$.push(...T),D=$.length,E=Promise.resolve(n);N<D;)E=E.then($[N++],$[N++]);return E}D=s.length;let V=n;for(;N<D;){const $=s[N++],B=s[N++];try{V=$(V)}catch(F){B.call(this,F);break}}try{E=e6.call(this,V)}catch($){return Promise.reject($)}for(N=0,D=T.length;N<D;)E=E.then(T[N++],T[N++]);return E}getUri(t){t=Yx(this.defaults,t);const n=DW(t.baseURL,t.url,t.allowAbsoluteUrls);return NW(n,t.params,t.paramsSerializer)}};Mn.forEach(["delete","get","head","options"],function(t){$x.prototype[t]=function(n,r){return this.request(Yx(r||{},{method:t,url:n,data:(r||{}).data}))}});Mn.forEach(["post","put","patch"],function(t){function n(r){return function(f,p,s){return this.request(Yx(s||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:f,data:p}))}}$x.prototype[t]=n(),$x.prototype[t+"Form"]=n(!0)});let _ue=class FW{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(f){n=f});const r=this;this.promise.then(c=>{if(!r._listeners)return;let f=r._listeners.length;for(;f-- >0;)r._listeners[f](c);r._listeners=null}),this.promise.then=c=>{let f;const p=new Promise(s=>{r.subscribe(s),f=s}).then(c);return p.cancel=function(){r.unsubscribe(f)},p},t(function(f,p,s){r.reason||(r.reason=new Pb(f,p,s),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new FW(function(c){t=c}),cancel:t}}};function bue(e){return function(n){return e.apply(null,n)}}function wue(e){return Mn.isObject(e)&&e.isAxiosError===!0}const jk={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(jk).forEach(([e,t])=>{jk[t]=e});function BW(e){const t=new $x(e),n=yW($x.prototype.request,t);return Mn.extend(n,$x.prototype,t,{allOwnKeys:!0}),Mn.extend(n,t,null,{allOwnKeys:!0}),n.create=function(c){return BW(Yx(e,c))},n}const $r=BW(tT);$r.Axios=$x;$r.CanceledError=Pb;$r.CancelToken=_ue;$r.isCancel=RW;$r.VERSION=zW;$r.toFormData=DE;$r.AxiosError=Rs;$r.Cancel=$r.CanceledError;$r.all=function(t){return Promise.all(t)};$r.spread=bue;$r.isAxiosError=wue;$r.mergeConfig=Yx;$r.AxiosHeaders=ed;$r.formToJSON=e=>MW(Mn.isHTMLForm(e)?new FormData(e):e);$r.getAdapter=LW.getAdapter;$r.HttpStatusCode=jk;$r.default=$r;const{Axios:YVe,AxiosError:KVe,CanceledError:JVe,isCancel:QVe,CancelToken:e$e,VERSION:t$e,all:n$e,Cancel:r$e,isAxiosError:i$e,spread:s$e,toFormData:a$e,AxiosHeaders:o$e,HttpStatusCode:l$e,formToJSON:c$e,getAdapter:u$e,mergeConfig:d$e}=$r,Wd=$r.create({baseURL:"https://auth.jolitravel.jampzdev.com",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json",Accept:"application/json"}});Wd.interceptors.request.use(e=>(console.log("Starting Request",e.url,e.method,e.data),e));Wd.interceptors.response.use(e=>(console.log("Response:",e.status,e.data),e),e=>(console.log("Response Error:",e.response?.status,e.response?.data,e.message),Promise.reject(e)));const i3="auth_token";function UW(e){if(!e)return VW();Wd.defaults.headers.common.Authorization=`Bearer ${e}`,localStorage.setItem(i3,e);try{const{setHR2Token:t}=require("./hr2.js");t(e)}catch{}}function VW(){delete Wd.defaults.headers.common.Authorization,localStorage.removeItem(i3)}(function(){const t=localStorage.getItem(i3);t&&UW(t)})();async function Sue(e={}){try{const t=await Wd.post("/api/login",e);return t?.data?.token&&UW(t.data.token),t.data}catch(t){throw console.error("Login API error:",t),t}}async function Tue(){try{await Wd.post("/api/logout")}finally{VW()}}async function n6(){return(await Wd.get("/api/user")).data}async function r6(){return(await Wd.get("/api/users")).data}const Ho=$r.create({baseURL:"https://fleet.jolitravel.jampzdev.com",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json"},withCredentials:!0}),E1="http://localhost:8092",tr=$r.create({baseURL:`${E1}/api/hr2`,headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json",Accept:"application/json"}}),Aue="auth_token";tr.interceptors.request.use(e=>(e.data instanceof FormData&&e.headers&&e.headers["Content-Type"]&&delete e.headers["Content-Type"],e),e=>Promise.reject(e));tr.interceptors.response.use(e=>(console.log("HR2 API Response:",{status:e.status,data:e.data}),e),e=>(e.config?._skipErrorLog||console.error("HR2 API Error:",{status:e.response?.status,data:e.response?.data,message:e.message}),Promise.reject(e)));(function(){const t=localStorage.getItem(Aue);t&&(tr.defaults.headers.common.Authorization=`Bearer ${t}`)})();const Ar={backendBase:E1,backend:{ess:{profile:`${E1}/api/employees`},api:{workProgress:`${E1}/api/work-progress`,awards:`${E1}/api/awards`}},learning:{courses:{getAll:(e={})=>tr.get("/lms/courses",{params:e}),getById:e=>tr.get(`/lms/courses/${e}`),create:e=>tr.post("/lms/courses",e),update:(e,t)=>tr.put(`/lms/courses/${e}`,t),delete:e=>tr.delete(`/lms/courses/${e}`),getCategories:()=>tr.get("/lms/courses/categories"),search:(e,t={})=>tr.get("/lms/courses/search",{params:{q:e,...t}})},learningPlans:{getAvailable:e=>tr.get("/lms/learning-plans",{params:{all:!0,user_id:e}}),getByUser:e=>tr.get("/lms/learning-plans",{params:{user_id:e}}),getById:e=>tr.get(`/lms/learning-plans/${e}`),enroll:(e,t)=>tr.post(`/lms/learning-plans/${e}/enroll`,{user_id:t}),unenroll:(e,t)=>tr.delete(`/lms/learning-plans/${e}/enroll`,{data:{user_id:t}}),create:e=>tr.post("/lms/learning-plans",e),update:(e,t)=>tr.put(`/lms/learning-plans/${e}`,t),delete:e=>tr.delete(`/lms/learning-plans/${e}`)},progress:{getAll:(e={})=>tr.get("/lms/progress",{params:e}),getByUser:e=>tr.get("/lms/progress",{params:{user_id:e}}),getByCourse:e=>tr.get(`/lms/courses/${e}/progress`),update:(e,t)=>tr.put(`/lms/progress/${e}`,t),create:e=>tr.post("/lms/progress",e),complete:(e,t=null)=>tr.put(`/lms/progress/${e}/complete`,{score:t}),reset:e=>tr.put(`/lms/progress/${e}/reset`)},enrollment:{enroll:e=>tr.post("/lms/enroll",e),unenroll:e=>tr.delete("/lms/enroll",{data:e}),getStatus:(e,t)=>tr.get("/lms/enrollment/status",{params:{user_id:e,course_id:t}}),bulkEnroll:(e,t)=>tr.post(`/lms/courses/${e}/bulk-enroll`,{user_ids:t})},employee:{getMyCourses:()=>tr.get("/lms/my-courses"),getMyLearningPlans:()=>tr.get("/lms/my-learning-plans")},analytics:{getOverview:(e={})=>tr.get("/lms/analytics/overview",{params:e}),getUserAnalytics:e=>tr.get(`/lms/analytics/users/${e}`),getCourseAnalytics:e=>tr.get(`/lms/analytics/courses/${e}`),getRecommendations:e=>tr.get("/lms/recommendations",{params:{user_id:e}}),getLearningPaths:e=>tr.get(`/lms/learning-paths/${e}`)},feedback:{getAll:(e={})=>tr.get("/lms/feedback",{params:e}),getByCourse:e=>tr.get(`/lms/courses/${e}/feedback`),submit:e=>tr.post("/lms/feedback",e),update:(e,t)=>tr.put(`/lms/feedback/${e}`,t),delete:e=>tr.delete(`/lms/feedback/${e}`)},dashboard:{getLearningPlans:(e=1)=>tr.get("/lms/dashboard/learning-plans",{params:{user_id:e}}),getCourseCatalog:(e=1)=>tr.get("/lms/dashboard/course-catalog",{params:{user_id:e}}),getLearningProgress:(e=1)=>tr.get("/lms/dashboard/learning-progress",{params:{user_id:e}})}},competency:{},training:{getAll:(e={})=>tr.get("/training",{params:e}),getById:e=>tr.get(`/training/${e}`),create:e=>tr.post("/training",e),update:(e,t)=>tr.put(`/training/${e}`,t),delete:e=>tr.delete(`/training/${e}`),getStats:e=>tr.get(`/training/${e}/stats`)},trainingApplications:{getAll:(e={})=>tr.get("/training-applications",{params:e}),getByEmployee:e=>tr.get(`/employees/${e}/training-applications`),apply:e=>tr.post("/training-applications",e),approve:e=>tr.put(`/training-applications/${e}/approve`),reject:e=>tr.put(`/training-applications/${e}/reject`),cancel:e=>tr.put(`/training-applications/${e}/cancel`),getPending:()=>tr.get("/training-applications/pending")},trainingSessions:{getAll:(e={})=>tr.get("/training-sessions",{params:e}),create:e=>tr.post("/training-sessions",e),schedule:(e,t)=>tr.post(`/training/${e}/schedule`,t)},trainingCompletions:{getAll:(e={})=>tr.get("/training-completions",{params:e}),getByEmployee:e=>tr.get(`/employees/${e}/training-completions`),create:e=>tr.post("/training-completions",e)},certificates:{getByEmployee:e=>tr.get(`/employees/${e}/certificates`),download:e=>tr.get(`/certificates/${e}/download`,{responseType:"blob",headers:{Accept:"application/pdf"}}),issue:e=>tr.post(`/training-completions/${e}/certificate`)},trainingFeedback:{submit:e=>tr.post("/training-feedback",e),getByEmployee:e=>tr.get(`/employees/${e}/training-feedback`),getByTraining:e=>tr.get(`/training/${e}/feedback`)},trainingCalendar:{sync:e=>tr.post(`/training-applications/${e}/sync-calendar`),getEvents:(e={})=>tr.get("/training-calendar",{params:e})},succession:{},employees:{getAll:()=>tr.get("/employees"),getById:e=>tr.get(`/employees/${e}`,{_skipErrorLog:!0}),create:e=>tr.post("/employees",e),update:(e,t)=>tr.put(`/employees/${e}`,t),delete:e=>tr.delete(`/employees/${e}`),uploadPhoto:(e,t)=>tr.post(`/employees/${e}/photo`,t)},leaveRequests:{getAll:(e={})=>tr.get("/leave-requests",{params:e}),getByEmployee:(e,t={})=>tr.get("/leave-requests",{params:{employee_id:e,...t}}),getById:e=>tr.get(`/leave-requests/${e}`),create:e=>tr.post("/leave-requests",e),updateStatus:(e,t)=>tr.put(`/leave-requests/${e}`,t),delete:e=>tr.delete(`/leave-requests/${e}`),getStats:(e={})=>tr.get("/leave-requests-stats",{params:e}),getPending:()=>tr.get("/leave-requests",{params:{status:"Pending"}}),getApproved:()=>tr.get("/leave-requests",{params:{status:"Accepted"}}),getDenied:()=>tr.get("/leave-requests",{params:{status:"Denied"}}),approve:(e,t="")=>tr.put(`/leave-requests/${e}`,{status:"Accepted",admin_notes:t}),deny:(e,t="")=>tr.put(`/leave-requests/${e}`,{status:"Denied",admin_notes:t})},timesheetAdjustments:{getAll:(e={})=>tr.get("/timesheet-adjustments",{params:e}),getByEmployee:(e,t={})=>tr.get("/timesheet-adjustments",{params:{employee_id:e,...t}}),getById:e=>tr.get(`/timesheet-adjustments/${e}`),create:e=>tr.post("/timesheet-adjustments",e),updateStatus:(e,t)=>tr.put(`/timesheet-adjustments/${e}`,t),delete:e=>tr.delete(`/timesheet-adjustments/${e}`),getPending:()=>tr.get("/timesheet-adjustments",{params:{status:"Pending"}}),getApproved:()=>tr.get("/timesheet-adjustments",{params:{status:"Approved"}}),getRejected:()=>tr.get("/timesheet-adjustments",{params:{status:"Rejected"}}),approve:(e,t="")=>tr.put(`/timesheet-adjustments/${e}`,{status:"Approved",admin_notes:t}),reject:(e,t="")=>tr.put(`/timesheet-adjustments/${e}`,{status:"Rejected",admin_notes:t})},reimbursements:{getAll:(e={})=>tr.get("/reimbursements",{params:e}),getByEmployee:(e,t={})=>tr.get("/reimbursements",{params:{employee_id:e,...t}}),getById:e=>tr.get(`/reimbursements/${e}`),create:e=>tr.post("/reimbursements",e),updateStatus:(e,t)=>tr.put(`/reimbursements/${e}`,t),delete:e=>tr.delete(`/reimbursements/${e}`),getPending:()=>tr.get("/reimbursements",{params:{status:"Pending"}}),getApproved:()=>tr.get("/reimbursements",{params:{status:"Approved"}}),getRejected:()=>tr.get("/reimbursements",{params:{status:"Rejected"}}),approve:(e,t="")=>tr.put(`/reimbursements/${e}`,{status:"Approved",admin_notes:t}),reject:(e,t="")=>tr.put(`/reimbursements/${e}`,{status:"Rejected",admin_notes:t})},users:{getAuthUsers:()=>tr.get("/auth-users"),getCombinedEmployees:()=>tr.get("/combined-employees"),createEmployeeFromUser:e=>tr.post("/employees/from-user",e),updateUser:(e,t)=>Wd.put(`/api/users/${e}`,t)}},Vh=z.createContext({}),jue=({children:e})=>{console.log("AuthProvider using backend: "+"https://auth.jolitravel.jampzdev.com");const[n,r]=z.useState(null),[c,f]=z.useState(!0),p=d_(),s=async()=>{try{const N=await Wd.get("/api/user");return r(N.data),localStorage.setItem("user",JSON.stringify(N.data)),N.data}catch{return r(null),localStorage.removeItem("user"),null}finally{f(!1)}};z.useEffect(()=>{const N=localStorage.getItem("user");if(N)try{const D=JSON.parse(N);r(D),f(!1)}catch(D){console.error("Error parsing stored user data:",D),localStorage.removeItem("user"),s()}else s()},[]);const w=async N=>{try{await Sue(N);const D=await s();D?(Zt.success("Login successful, redirecting...",{position:"top-center"}),T(D,p)):Zt.error("Login failed: unable to fetch user",{position:"top-center"})}catch(D){D.response?[401,422].includes(D.response.status)?Zt.error("Invalid credentials",{position:"top-center"}):D.response.status===500?Zt.error("Server error. Please try again later.",{position:"top-center"}):Zt.error(`Login failed (${D.response.status})`,{position:"top-center"}):Zt.error("Network error. Please check your connection.",{position:"top-center"}),console.error(D)}},T=(N,D)=>{switch(N?.role){case"Super Admin":D("/login");break;case"HR1 Admin":D("/hr1/");break;case"HR2 Admin":case"Trainer":case"Employee":D("/hr2/db");break;case"LogisticsII Admin":case"Driver":case"Employee":D("/logisticsII/");break;case"LogisticsI Admin":D("/logistics1/");break;default:D("/login")}},E=async()=>{try{await Tue()}catch{}finally{r(null),localStorage.removeItem("user"),p("/login")}};return o.jsx(Vh.Provider,{value:{auth:n,setAuth:r,login:w,loading:c,roleAccess:T,logout:E},children:e})},$W=z.createContext({theme:"system",setTheme:()=>null});function Eue({children:e,defaultTheme:t="system",storageKey:n="vite-ui-theme",...r}){const[c,f]=z.useState(()=>localStorage.getItem(n)||t);z.useEffect(()=>{const s=window.document.documentElement;if(s.classList.remove("light","dark"),c==="system"){const w=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";s.classList.add(w);return}s.classList.add(c)},[c]);const p={theme:c,setTheme:s=>{localStorage.setItem(n,s),f(s)}};return o.jsx($W.Provider,{...r,value:p,children:e})}const Cue=()=>{const e=z.useContext($W);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e};function Nue(){const{auth:e,roleAccess:t}=z.useContext(Vh),n=d_();return z.useEffect(()=>{e&&t(e,n)},[e,n]),o.jsx(JL,{})}/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pue=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Mue=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),i6=e=>{const t=Mue(e);return t.charAt(0).toUpperCase()+t.slice(1)},qW=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim(),Rue=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Oue={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Due=z.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:c="",children:f,iconNode:p,...s},w)=>z.createElement("svg",{ref:w,...Oue,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:qW("lucide",c),...!f&&!Rue(s)&&{"aria-hidden":"true"},...s},[...p.map(([T,E])=>z.createElement(T,E)),...Array.isArray(f)?f:[f]]));/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=(e,t)=>{const n=z.forwardRef(({className:r,...c},f)=>z.createElement(Due,{ref:f,iconNode:t,className:qW(`lucide-${Pue(i6(e))}`,`lucide-${e}`,r),...c}));return n.displayName=i6(e),n};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kue=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],Iue=Kr("arrow-up-right",kue);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lue=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],W0=Kr("award",Lue);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zue=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Fue=Kr("badge-check",zue);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bue=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Uue=Kr("bell",Bue);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ue=[["path",{d:"M10 22V7a1 1 0 0 0-1-1H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5a1 1 0 0 0-1-1H2",key:"1ah6g2"}],["rect",{x:"14",y:"2",width:"8",height:"8",rx:"1",key:"88lufb"}]],que=Kr("blocks",$ue);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hue=[["path",{d:"M12 21V7",key:"gj6g52"}],["path",{d:"m16 12 2 2 4-4",key:"mdajum"}],["path",{d:"M22 6V4a1 1 0 0 0-1-1h-5a4 4 0 0 0-4 4 4 4 0 0 0-4-4H3a1 1 0 0 0-1 1v13a1 1 0 0 0 1 1h6a3 3 0 0 1 3 3 3 3 0 0 1 3-3h6a1 1 0 0 0 1-1v-1.3",key:"8arnkb"}]],EA=Kr("book-open-check",Hue);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gue=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],kh=Kr("book-open",Gue);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wue=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],Xue=Kr("bookmark",Wue);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zue=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],HW=Kr("brain",Zue);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yue=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],Kue=Kr("briefcase",Yue);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jue=[["path",{d:"M16 19h6",key:"xwg31i"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M21 12.598V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8.5",key:"1glfrc"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}]],s6=Kr("calendar-plus",Jue);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Que=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Hp=Kr("calendar",Que);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ede=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],tde=Kr("car",ede);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nde=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],C1=Kr("chart-column",nde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rde=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]],ide=Kr("chart-line",rde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sde=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],GW=Kr("chart-pie",sde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ade=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M7 16c.5-2 1.5-7 4-7 2 0 2 3 4 3 2.5 0 4.5-5 5-7",key:"lw07rv"}]],CA=Kr("chart-spline",ade);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ode=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],IE=Kr("check",ode);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lde=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],LE=Kr("chevron-down",lde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cde=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],WW=Kr("chevron-left",cde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ude=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Mb=Kr("chevron-right",ude);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dde=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],hde=Kr("chevron-up",dde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fde=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],zE=Kr("chevrons-up-down",fde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pde=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Wy=Kr("circle-check-big",pde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mde=[["path",{d:"M11.051 7.616a1 1 0 0 1 1.909.024l.737 1.452a1 1 0 0 0 .737.535l1.634.256a1 1 0 0 1 .588 1.806l-1.172 1.168a1 1 0 0 0-.282.866l.259 1.613a1 1 0 0 1-1.541 1.134l-1.465-.75a1 1 0 0 0-.912 0l-1.465.75a1 1 0 0 1-1.539-1.133l.258-1.613a1 1 0 0 0-.282-.867l-1.156-1.152a1 1 0 0 1 .572-1.822l1.633-.256a1 1 0 0 0 .737-.535z",key:"285bvi"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],gde=Kr("circle-star",mde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yde=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],NA=Kr("clipboard-list",yde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vde=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["path",{d:"M20 12v5",key:"12wsvk"}],["path",{d:"M20 21h.01",key:"1p6o6n"}],["path",{d:"M21.25 8.2A10 10 0 1 0 16 21.16",key:"17fp9f"}]],xde=Kr("clock-alert",vde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _de=[["path",{d:"M12 6v6l1.56.78",key:"14ed3g"}],["path",{d:"M13.227 21.925a10 10 0 1 1 8.767-9.588",key:"jwkls1"}],["path",{d:"m14 18 4-4 4 4",key:"ftkppy"}],["path",{d:"M18 22v-8",key:"su0gjh"}]],a6=Kr("clock-arrow-up",_de);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bde=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Kp=Kr("clock",bde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wde=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Sde=Kr("crown",wde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tde=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],$p=Kr("download",Tde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ade=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],jde=Kr("ellipsis",Ade);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ede=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],$A=Kr("eye",Ede);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cde=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],wx=Kr("file-text",Cde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nde=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Pde=Kr("funnel",Nde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mde=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],Ek=Kr("gauge",Mde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rde=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],s3=Kr("graduation-cap",Rde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ode=[["path",{d:"M11 15h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 17",key:"geh8rc"}],["path",{d:"m7 21 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9",key:"1fto5m"}],["path",{d:"m2 16 6 6",key:"1pfhp9"}],["circle",{cx:"16",cy:"9",r:"2.9",key:"1n0dlu"}],["circle",{cx:"6",cy:"5",r:"3",key:"151irh"}]],Dde=Kr("hand-coins",Ode);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kde=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],PA=Kr("history",kde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ide=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],Lde=Kr("layout-dashboard",Ide);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zde=[["rect",{width:"8",height:"18",x:"3",y:"3",rx:"1",key:"oynpb5"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M20.4 18.9c.2.5-.1 1.1-.6 1.3l-1.9.7c-.5.2-1.1-.1-1.3-.6L11.1 5.1c-.2-.5.1-1.1.6-1.3l1.9-.7c.5-.2 1.1.1 1.3.6Z",key:"1qboyk"}]],Ck=Kr("library-big",zde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fde=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]],o6=Kr("life-buoy",Fde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bde=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],Ude=Kr("lightbulb",Bde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vde=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],$de=Kr("loader-circle",Vde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qde=[["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M3 12h1",key:"lp3yf2"}],["path",{d:"M3 18h1",key:"1eiwyy"}],["path",{d:"M3 6h1",key:"rgxa97"}],["path",{d:"M8 12h1",key:"1con00"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M8 6h1",key:"tn6mkg"}]],l6=Kr("logs",qde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hde=[["path",{d:"M12 19h.01",key:"1wutuc"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M16 19h.01",key:"1vcnzz"}],["path",{d:"M16 3h.01",key:"ll0zb8"}],["path",{d:"M2 13h.01",key:"1aptou"}],["path",{d:"M2 17v4.286a.71.71 0 0 0 1.212.502l2.202-2.202A2 2 0 0 1 6.828 19H8",key:"4cp7zq"}],["path",{d:"M2 5a2 2 0 0 1 2-2",key:"1iztiu"}],["path",{d:"M2 9h.01",key:"1nzd1v"}],["path",{d:"M20 3a2 2 0 0 1 2 2",key:"m48m3a"}],["path",{d:"M22 13h.01",key:"ke7esy"}],["path",{d:"M22 17a2 2 0 0 1-2 2",key:"17q5fo"}],["path",{d:"M22 9h.01",key:"npkp49"}],["path",{d:"M8 3h.01",key:"133hau"}]],Gde=Kr("message-square-dashed",Hde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wde=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Xde=Kr("message-square",Wde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zde=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],Yde=Kr("moon",Zde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kde=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],Jde=Kr("panel-left",Kde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qde=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],ehe=Kr("play",Qde);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const the=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Au=Kr("plus",the);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nhe=[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]],rhe=Kr("presentation",nhe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ihe=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],she=Kr("puzzle",ihe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ahe=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],nT=Kr("search",ahe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ohe=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],lhe=Kr("send",ohe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const che=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M6.376 18.91a6 6 0 0 1 11.249.003",key:"hnjrf2"}],["circle",{cx:"12",cy:"11",r:"4",key:"1gt34v"}]],c6=Kr("shield-user",che);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uhe=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],dhe=Kr("shield",uhe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hhe=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Y1=Kr("square-pen",hhe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fhe=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Y2=Kr("star",fhe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const phe=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],mhe=Kr("sun",phe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ghe=[["path",{d:"M13.172 2a2 2 0 0 1 1.414.586l6.71 6.71a2.4 2.4 0 0 1 0 3.408l-4.592 4.592a2.4 2.4 0 0 1-3.408 0l-6.71-6.71A2 2 0 0 1 6 9.172V3a1 1 0 0 1 1-1z",key:"16rjxf"}],["path",{d:"M2 7v6.172a2 2 0 0 0 .586 1.414l6.71 6.71a2.4 2.4 0 0 0 3.191.193",key:"178nd4"}],["circle",{cx:"10.5",cy:"6.5",r:".5",fill:"currentColor",key:"12ikhr"}]],u6=Kr("tags",ghe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yhe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],d6=Kr("target",yhe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vhe=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],qA=Kr("trash-2",vhe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xhe=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],h6=Kr("trash",xhe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _he=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],K1=Kr("trending-up",_he);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bhe=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],whe=Kr("trophy",bhe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const She=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],The=Kr("upload",She);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ahe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],f6=Kr("user-plus",Ahe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jhe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Xy=Kr("user",jhe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ehe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Hy=Kr("users",Ehe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Che=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],Nhe=Kr("wallet",Che);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Phe=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],qx=Kr("wrench",Phe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mhe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],bg=Kr("x",Mhe);function Yr(e,t,{checkForDefaultPrevented:n=!0}={}){return function(c){if(e?.(c),n===!1||!c.defaultPrevented)return t?.(c)}}function Rhe(e,t){const n=z.createContext(t),r=f=>{const{children:p,...s}=f,w=z.useMemo(()=>s,Object.values(s));return o.jsx(n.Provider,{value:w,children:p})};r.displayName=e+"Provider";function c(f){const p=z.useContext(n);if(p)return p;if(t!==void 0)return t;throw new Error(`\`${f}\` must be used within \`${e}\``)}return[r,c]}function Eu(e,t=[]){let n=[];function r(f,p){const s=z.createContext(p),w=n.length;n=[...n,p];const T=N=>{const{scope:D,children:V,...$}=N,B=D?.[e]?.[w]||s,F=z.useMemo(()=>$,Object.values($));return o.jsx(B.Provider,{value:F,children:V})};T.displayName=f+"Provider";function E(N,D){const V=D?.[e]?.[w]||s,$=z.useContext(V);if($)return $;if(p!==void 0)return p;throw new Error(`\`${N}\` must be used within \`${f}\``)}return[T,E]}const c=()=>{const f=n.map(p=>z.createContext(p));return function(s){const w=s?.[e]||f;return z.useMemo(()=>({[`__scope${e}`]:{...s,[e]:w}}),[s,w])}};return c.scopeName=e,[r,Ohe(c,...t)]}function Ohe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(c=>({useScope:c(),scopeName:c.scopeName}));return function(f){const p=r.reduce((s,{useScope:w,scopeName:T})=>{const N=w(f)[`__scope${T}`];return{...s,...N}},{});return z.useMemo(()=>({[`__scope${t.scopeName}`]:p}),[p])}};return n.scopeName=t.scopeName,n}var Ol=globalThis?.document?z.useLayoutEffect:()=>{},Dhe=K9[" useInsertionEffect ".trim().toString()]||Ol;function zf({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[c,f,p]=khe({defaultProp:t,onChange:n}),s=e!==void 0,w=s?e:c;{const E=z.useRef(e!==void 0);z.useEffect(()=>{const N=E.current;N!==s&&console.warn(`${r} is changing from ${N?"controlled":"uncontrolled"} to ${s?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),E.current=s},[s,r])}const T=z.useCallback(E=>{if(s){const N=Ihe(E)?E(e):E;N!==e&&p.current?.(N)}else f(E)},[s,e,f,p]);return[w,T]}function khe({defaultProp:e,onChange:t}){const[n,r]=z.useState(e),c=z.useRef(n),f=z.useRef(t);return Dhe(()=>{f.current=t},[t]),z.useEffect(()=>{c.current!==n&&(f.current?.(n),c.current=n)},[n,c]),[n,r,f]}function Ihe(e){return typeof e=="function"}function p6(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Ag(...e){return t=>{let n=!1;const r=e.map(c=>{const f=p6(c,t);return!n&&typeof f=="function"&&(n=!0),f});if(n)return()=>{for(let c=0;c<r.length;c++){const f=r[c];typeof f=="function"?f():p6(e[c],null)}}}}function fa(...e){return z.useCallback(Ag(...e),e)}function nv(e){const t=Lhe(e),n=z.forwardRef((r,c)=>{const{children:f,...p}=r,s=z.Children.toArray(f),w=s.find(zhe);if(w){const T=w.props.children,E=s.map(N=>N===w?z.Children.count(T)>1?z.Children.only(null):z.isValidElement(T)?T.props.children:null:N);return o.jsx(t,{...p,ref:c,children:z.isValidElement(T)?z.cloneElement(T,void 0,E):null})}return o.jsx(t,{...p,ref:c,children:f})});return n.displayName=`${e}.Slot`,n}var rT=nv("Slot");function Lhe(e){const t=z.forwardRef((n,r)=>{const{children:c,...f}=n;if(z.isValidElement(c)){const p=Bhe(c),s=Fhe(f,c.props);return c.type!==z.Fragment&&(s.ref=r?Ag(r,p):p),z.cloneElement(c,s)}return z.Children.count(c)>1?z.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var XW=Symbol("radix.slottable");function ZW(e){const t=({children:n})=>o.jsx(o.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=XW,t}function zhe(e){return z.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===XW}function Fhe(e,t){const n={...t};for(const r in t){const c=e[r],f=t[r];/^on[A-Z]/.test(r)?c&&f?n[r]=(...s)=>{const w=f(...s);return c(...s),w}:c&&(n[r]=c):r==="style"?n[r]={...c,...f}:r==="className"&&(n[r]=[c,f].filter(Boolean).join(" "))}return{...e,...n}}function Bhe(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Uhe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Si=Uhe.reduce((e,t)=>{const n=nv(`Primitive.${t}`),r=z.forwardRef((c,f)=>{const{asChild:p,...s}=c,w=p?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),o.jsx(w,{...s,ref:f})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function YW(e,t){e&&YS.flushSync(()=>e.dispatchEvent(t))}function Vhe(e,t){return z.useReducer((n,r)=>t[n][r]??n,e)}var nd=e=>{const{present:t,children:n}=e,r=$he(t),c=typeof n=="function"?n({present:r.isPresent}):z.Children.only(n),f=fa(r.ref,qhe(c));return typeof n=="function"||r.isPresent?z.cloneElement(c,{ref:f}):null};nd.displayName="Presence";function $he(e){const[t,n]=z.useState(),r=z.useRef(null),c=z.useRef(e),f=z.useRef("none"),p=e?"mounted":"unmounted",[s,w]=Vhe(p,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return z.useEffect(()=>{const T=K2(r.current);f.current=s==="mounted"?T:"none"},[s]),Ol(()=>{const T=r.current,E=c.current;if(E!==e){const D=f.current,V=K2(T);e?w("MOUNT"):V==="none"||T?.display==="none"?w("UNMOUNT"):w(E&&D!==V?"ANIMATION_OUT":"UNMOUNT"),c.current=e}},[e,w]),Ol(()=>{if(t){let T;const E=t.ownerDocument.defaultView??window,N=V=>{const B=K2(r.current).includes(CSS.escape(V.animationName));if(V.target===t&&B&&(w("ANIMATION_END"),!c.current)){const F=t.style.animationFillMode;t.style.animationFillMode="forwards",T=E.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=F)})}},D=V=>{V.target===t&&(f.current=K2(r.current))};return t.addEventListener("animationstart",D),t.addEventListener("animationcancel",N),t.addEventListener("animationend",N),()=>{E.clearTimeout(T),t.removeEventListener("animationstart",D),t.removeEventListener("animationcancel",N),t.removeEventListener("animationend",N)}}else w("ANIMATION_END")},[t,w]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:z.useCallback(T=>{r.current=T?getComputedStyle(T):null,n(T)},[])}}function K2(e){return e?.animationName||"none"}function qhe(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Hhe=K9[" useId ".trim().toString()]||(()=>{}),Ghe=0;function Ml(e){const[t,n]=z.useState(Hhe());return Ol(()=>{n(r=>r??String(Ghe++))},[e]),e||(t?`radix-${t}`:"")}var FE="Collapsible",[Whe,KW]=Eu(FE),[Xhe,a3]=Whe(FE),JW=z.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:r,defaultOpen:c,disabled:f,onOpenChange:p,...s}=e,[w,T]=zf({prop:r,defaultProp:c??!1,onChange:p,caller:FE});return o.jsx(Xhe,{scope:n,disabled:f,contentId:Ml(),open:w,onOpenToggle:z.useCallback(()=>T(E=>!E),[T]),children:o.jsx(Si.div,{"data-state":l3(w),"data-disabled":f?"":void 0,...s,ref:t})})});JW.displayName=FE;var QW="CollapsibleTrigger",eX=z.forwardRef((e,t)=>{const{__scopeCollapsible:n,...r}=e,c=a3(QW,n);return o.jsx(Si.button,{type:"button","aria-controls":c.contentId,"aria-expanded":c.open||!1,"data-state":l3(c.open),"data-disabled":c.disabled?"":void 0,disabled:c.disabled,...r,ref:t,onClick:Yr(e.onClick,c.onOpenToggle)})});eX.displayName=QW;var o3="CollapsibleContent",tX=z.forwardRef((e,t)=>{const{forceMount:n,...r}=e,c=a3(o3,e.__scopeCollapsible);return o.jsx(nd,{present:n||c.open,children:({present:f})=>o.jsx(Zhe,{...r,ref:t,present:f})})});tX.displayName=o3;var Zhe=z.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:r,children:c,...f}=e,p=a3(o3,n),[s,w]=z.useState(r),T=z.useRef(null),E=fa(t,T),N=z.useRef(0),D=N.current,V=z.useRef(0),$=V.current,B=p.open||s,F=z.useRef(B),K=z.useRef(void 0);return z.useEffect(()=>{const Y=requestAnimationFrame(()=>F.current=!1);return()=>cancelAnimationFrame(Y)},[]),Ol(()=>{const Y=T.current;if(Y){K.current=K.current||{transitionDuration:Y.style.transitionDuration,animationName:Y.style.animationName},Y.style.transitionDuration="0s",Y.style.animationName="none";const X=Y.getBoundingClientRect();N.current=X.height,V.current=X.width,F.current||(Y.style.transitionDuration=K.current.transitionDuration,Y.style.animationName=K.current.animationName),w(r)}},[p.open,r]),o.jsx(Si.div,{"data-state":l3(p.open),"data-disabled":p.disabled?"":void 0,id:p.contentId,hidden:!B,...f,ref:E,style:{"--radix-collapsible-content-height":D?`${D}px`:void 0,"--radix-collapsible-content-width":$?`${$}px`:void 0,...e.style},children:B&&c})});function l3(e){return e?"open":"closed"}var Yhe=JW,Khe=eX,Jhe=tX;function nX(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var c=e.length;for(t=0;t<c;t++)e[t]&&(n=nX(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function es(){for(var e,t,n=0,r="",c=arguments.length;n<c;n++)(e=arguments[n])&&(t=nX(e))&&(r&&(r+=" "),r+=t);return r}const m6=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,g6=es,c3=(e,t)=>n=>{var r;if(t?.variants==null)return g6(e,n?.class,n?.className);const{variants:c,defaultVariants:f}=t,p=Object.keys(c).map(T=>{const E=n?.[T],N=f?.[T];if(E===null)return null;const D=m6(E)||m6(N);return c[T][D]}),s=n&&Object.entries(n).reduce((T,E)=>{let[N,D]=E;return D===void 0||(T[N]=D),T},{}),w=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((T,E)=>{let{class:N,className:D,...V}=E;return Object.entries(V).every($=>{let[B,F]=$;return Array.isArray(F)?F.includes({...f,...s}[B]):{...f,...s}[B]===F})?[...T,N,D]:T},[]);return g6(e,p,w,n?.class,n?.className)},xP=768;function Qhe(){const[e,t]=z.useState(void 0);return z.useEffect(()=>{const n=window.matchMedia(`(max-width: ${xP-1}px)`),r=()=>{t(window.innerWidth<xP)};return n.addEventListener("change",r),t(window.innerWidth<xP),()=>n.removeEventListener("change",r)},[]),!!e}const u3="-",efe=e=>{const t=nfe(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:p=>{const s=p.split(u3);return s[0]===""&&s.length!==1&&s.shift(),rX(s,t)||tfe(p)},getConflictingClassGroupIds:(p,s)=>{const w=n[p]||[];return s&&r[p]?[...w,...r[p]]:w}}},rX=(e,t)=>{if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),c=r?rX(e.slice(1),r):void 0;if(c)return c;if(t.validators.length===0)return;const f=e.join(u3);return t.validators.find(({validator:p})=>p(f))?.classGroupId},y6=/^\[(.+)\]$/,tfe=e=>{if(y6.test(e)){const t=y6.exec(e)[1],n=t?.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},nfe=e=>{const{theme:t,classGroups:n}=e,r={nextPart:new Map,validators:[]};for(const c in n)Nk(n[c],r,c,t);return r},Nk=(e,t,n,r)=>{e.forEach(c=>{if(typeof c=="string"){const f=c===""?t:v6(t,c);f.classGroupId=n;return}if(typeof c=="function"){if(rfe(c)){Nk(c(r),t,n,r);return}t.validators.push({validator:c,classGroupId:n});return}Object.entries(c).forEach(([f,p])=>{Nk(p,v6(t,f),n,r)})})},v6=(e,t)=>{let n=e;return t.split(u3).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},rfe=e=>e.isThemeGetter,ife=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const c=(f,p)=>{n.set(f,p),t++,t>e&&(t=0,r=n,n=new Map)};return{get(f){let p=n.get(f);if(p!==void 0)return p;if((p=r.get(f))!==void 0)return c(f,p),p},set(f,p){n.has(f)?n.set(f,p):c(f,p)}}},Pk="!",Mk=":",sfe=Mk.length,afe=e=>{const{prefix:t,experimentalParseClassName:n}=e;let r=c=>{const f=[];let p=0,s=0,w=0,T;for(let $=0;$<c.length;$++){let B=c[$];if(p===0&&s===0){if(B===Mk){f.push(c.slice(w,$)),w=$+sfe;continue}if(B==="/"){T=$;continue}}B==="["?p++:B==="]"?p--:B==="("?s++:B===")"&&s--}const E=f.length===0?c:c.substring(w),N=ofe(E),D=N!==E,V=T&&T>w?T-w:void 0;return{modifiers:f,hasImportantModifier:D,baseClassName:N,maybePostfixModifierPosition:V}};if(t){const c=t+Mk,f=r;r=p=>p.startsWith(c)?f(p.substring(c.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:p,maybePostfixModifierPosition:void 0}}if(n){const c=r;r=f=>n({className:f,parseClassName:c})}return r},ofe=e=>e.endsWith(Pk)?e.substring(0,e.length-1):e.startsWith(Pk)?e.substring(1):e,lfe=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const c=[];let f=[];return r.forEach(p=>{p[0]==="["||t[p]?(c.push(...f.sort(),p),f=[]):f.push(p)}),c.push(...f.sort()),c}},cfe=e=>({cache:ife(e.cacheSize),parseClassName:afe(e),sortModifiers:lfe(e),...efe(e)}),ufe=/\s+/,dfe=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:c,sortModifiers:f}=t,p=[],s=e.trim().split(ufe);let w="";for(let T=s.length-1;T>=0;T-=1){const E=s[T],{isExternal:N,modifiers:D,hasImportantModifier:V,baseClassName:$,maybePostfixModifierPosition:B}=n(E);if(N){w=E+(w.length>0?" "+w:w);continue}let F=!!B,K=r(F?$.substring(0,B):$);if(!K){if(!F){w=E+(w.length>0?" "+w:w);continue}if(K=r($),!K){w=E+(w.length>0?" "+w:w);continue}F=!1}const Y=f(D).join(":"),X=V?Y+Pk:Y,ae=X+K;if(p.includes(ae))continue;p.push(ae);const Z=c(K,F);for(let se=0;se<Z.length;++se){const he=Z[se];p.push(X+he)}w=E+(w.length>0?" "+w:w)}return w};function hfe(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=iX(t))&&(r&&(r+=" "),r+=n);return r}const iX=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=iX(e[r]))&&(n&&(n+=" "),n+=t);return n};function ffe(e,...t){let n,r,c,f=p;function p(w){const T=t.reduce((E,N)=>N(E),e());return n=cfe(T),r=n.cache.get,c=n.cache.set,f=s,s(w)}function s(w){const T=r(w);if(T)return T;const E=dfe(w,n);return c(w,E),E}return function(){return f(hfe.apply(null,arguments))}}const Hl=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},sX=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,aX=/^\((?:(\w[\w-]*):)?(.+)\)$/i,pfe=/^\d+\/\d+$/,mfe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,gfe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,yfe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,vfe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,xfe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,h0=e=>pfe.test(e),Zs=e=>!!e&&!Number.isNaN(Number(e)),zy=e=>!!e&&Number.isInteger(Number(e)),_P=e=>e.endsWith("%")&&Zs(e.slice(0,-1)),ug=e=>mfe.test(e),_fe=()=>!0,bfe=e=>gfe.test(e)&&!yfe.test(e),oX=()=>!1,wfe=e=>vfe.test(e),Sfe=e=>xfe.test(e),Tfe=e=>!vi(e)&&!xi(e),Afe=e=>Rb(e,uX,oX),vi=e=>sX.test(e),Sx=e=>Rb(e,dX,bfe),bP=e=>Rb(e,Pfe,Zs),x6=e=>Rb(e,lX,oX),jfe=e=>Rb(e,cX,Sfe),J2=e=>Rb(e,hX,wfe),xi=e=>aX.test(e),c1=e=>Ob(e,dX),Efe=e=>Ob(e,Mfe),_6=e=>Ob(e,lX),Cfe=e=>Ob(e,uX),Nfe=e=>Ob(e,cX),Q2=e=>Ob(e,hX,!0),Rb=(e,t,n)=>{const r=sX.exec(e);return r?r[1]?t(r[1]):n(r[2]):!1},Ob=(e,t,n=!1)=>{const r=aX.exec(e);return r?r[1]?t(r[1]):n:!1},lX=e=>e==="position"||e==="percentage",cX=e=>e==="image"||e==="url",uX=e=>e==="length"||e==="size"||e==="bg-size",dX=e=>e==="length",Pfe=e=>e==="number",Mfe=e=>e==="family-name",hX=e=>e==="shadow",Rfe=()=>{const e=Hl("color"),t=Hl("font"),n=Hl("text"),r=Hl("font-weight"),c=Hl("tracking"),f=Hl("leading"),p=Hl("breakpoint"),s=Hl("container"),w=Hl("spacing"),T=Hl("radius"),E=Hl("shadow"),N=Hl("inset-shadow"),D=Hl("text-shadow"),V=Hl("drop-shadow"),$=Hl("blur"),B=Hl("perspective"),F=Hl("aspect"),K=Hl("ease"),Y=Hl("animate"),X=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ae=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],Z=()=>[...ae(),xi,vi],se=()=>["auto","hidden","clip","visible","scroll"],he=()=>["auto","contain","none"],ye=()=>[xi,vi,w],Ce=()=>[h0,"full","auto",...ye()],Ve=()=>[zy,"none","subgrid",xi,vi],Re=()=>["auto",{span:["full",zy,xi,vi]},zy,xi,vi],$e=()=>[zy,"auto",xi,vi],nt=()=>["auto","min","max","fr",xi,vi],Me=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],rt=()=>["start","end","center","stretch","center-safe","end-safe"],Ee=()=>["auto",...ye()],it=()=>[h0,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...ye()],et=()=>[e,xi,vi],mt=()=>[...ae(),_6,x6,{position:[xi,vi]}],He=()=>["no-repeat",{repeat:["","x","y","space","round"]}],pt=()=>["auto","cover","contain",Cfe,Afe,{size:[xi,vi]}],We=()=>[_P,c1,Sx],Je=()=>["","none","full",T,xi,vi],jt=()=>["",Zs,c1,Sx],Pt=()=>["solid","dashed","dotted","double"],Ot=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Mt=()=>[Zs,_P,_6,x6],an=()=>["","none",$,xi,vi],Jt=()=>["none",Zs,xi,vi],Cn=()=>["none",Zs,xi,vi],nr=()=>[Zs,xi,vi],sn=()=>[h0,"full",...ye()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ug],breakpoint:[ug],color:[_fe],container:[ug],"drop-shadow":[ug],ease:["in","out","in-out"],font:[Tfe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ug],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ug],shadow:[ug],spacing:["px",Zs],text:[ug],"text-shadow":[ug],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",h0,vi,xi,F]}],container:["container"],columns:[{columns:[Zs,vi,xi,s]}],"break-after":[{"break-after":X()}],"break-before":[{"break-before":X()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:Z()}],overflow:[{overflow:se()}],"overflow-x":[{"overflow-x":se()}],"overflow-y":[{"overflow-y":se()}],overscroll:[{overscroll:he()}],"overscroll-x":[{"overscroll-x":he()}],"overscroll-y":[{"overscroll-y":he()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:Ce()}],"inset-x":[{"inset-x":Ce()}],"inset-y":[{"inset-y":Ce()}],start:[{start:Ce()}],end:[{end:Ce()}],top:[{top:Ce()}],right:[{right:Ce()}],bottom:[{bottom:Ce()}],left:[{left:Ce()}],visibility:["visible","invisible","collapse"],z:[{z:[zy,"auto",xi,vi]}],basis:[{basis:[h0,"full","auto",s,...ye()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Zs,h0,"auto","initial","none",vi]}],grow:[{grow:["",Zs,xi,vi]}],shrink:[{shrink:["",Zs,xi,vi]}],order:[{order:[zy,"first","last","none",xi,vi]}],"grid-cols":[{"grid-cols":Ve()}],"col-start-end":[{col:Re()}],"col-start":[{"col-start":$e()}],"col-end":[{"col-end":$e()}],"grid-rows":[{"grid-rows":Ve()}],"row-start-end":[{row:Re()}],"row-start":[{"row-start":$e()}],"row-end":[{"row-end":$e()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":nt()}],"auto-rows":[{"auto-rows":nt()}],gap:[{gap:ye()}],"gap-x":[{"gap-x":ye()}],"gap-y":[{"gap-y":ye()}],"justify-content":[{justify:[...Me(),"normal"]}],"justify-items":[{"justify-items":[...rt(),"normal"]}],"justify-self":[{"justify-self":["auto",...rt()]}],"align-content":[{content:["normal",...Me()]}],"align-items":[{items:[...rt(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...rt(),{baseline:["","last"]}]}],"place-content":[{"place-content":Me()}],"place-items":[{"place-items":[...rt(),"baseline"]}],"place-self":[{"place-self":["auto",...rt()]}],p:[{p:ye()}],px:[{px:ye()}],py:[{py:ye()}],ps:[{ps:ye()}],pe:[{pe:ye()}],pt:[{pt:ye()}],pr:[{pr:ye()}],pb:[{pb:ye()}],pl:[{pl:ye()}],m:[{m:Ee()}],mx:[{mx:Ee()}],my:[{my:Ee()}],ms:[{ms:Ee()}],me:[{me:Ee()}],mt:[{mt:Ee()}],mr:[{mr:Ee()}],mb:[{mb:Ee()}],ml:[{ml:Ee()}],"space-x":[{"space-x":ye()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":ye()}],"space-y-reverse":["space-y-reverse"],size:[{size:it()}],w:[{w:[s,"screen",...it()]}],"min-w":[{"min-w":[s,"screen","none",...it()]}],"max-w":[{"max-w":[s,"screen","none","prose",{screen:[p]},...it()]}],h:[{h:["screen","lh",...it()]}],"min-h":[{"min-h":["screen","lh","none",...it()]}],"max-h":[{"max-h":["screen","lh",...it()]}],"font-size":[{text:["base",n,c1,Sx]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,xi,bP]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",_P,vi]}],"font-family":[{font:[Efe,vi,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[c,xi,vi]}],"line-clamp":[{"line-clamp":[Zs,"none",xi,bP]}],leading:[{leading:[f,...ye()]}],"list-image":[{"list-image":["none",xi,vi]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",xi,vi]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:et()}],"text-color":[{text:et()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Pt(),"wavy"]}],"text-decoration-thickness":[{decoration:[Zs,"from-font","auto",xi,Sx]}],"text-decoration-color":[{decoration:et()}],"underline-offset":[{"underline-offset":[Zs,"auto",xi,vi]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ye()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",xi,vi]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",xi,vi]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:mt()}],"bg-repeat":[{bg:He()}],"bg-size":[{bg:pt()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},zy,xi,vi],radial:["",xi,vi],conic:[zy,xi,vi]},Nfe,jfe]}],"bg-color":[{bg:et()}],"gradient-from-pos":[{from:We()}],"gradient-via-pos":[{via:We()}],"gradient-to-pos":[{to:We()}],"gradient-from":[{from:et()}],"gradient-via":[{via:et()}],"gradient-to":[{to:et()}],rounded:[{rounded:Je()}],"rounded-s":[{"rounded-s":Je()}],"rounded-e":[{"rounded-e":Je()}],"rounded-t":[{"rounded-t":Je()}],"rounded-r":[{"rounded-r":Je()}],"rounded-b":[{"rounded-b":Je()}],"rounded-l":[{"rounded-l":Je()}],"rounded-ss":[{"rounded-ss":Je()}],"rounded-se":[{"rounded-se":Je()}],"rounded-ee":[{"rounded-ee":Je()}],"rounded-es":[{"rounded-es":Je()}],"rounded-tl":[{"rounded-tl":Je()}],"rounded-tr":[{"rounded-tr":Je()}],"rounded-br":[{"rounded-br":Je()}],"rounded-bl":[{"rounded-bl":Je()}],"border-w":[{border:jt()}],"border-w-x":[{"border-x":jt()}],"border-w-y":[{"border-y":jt()}],"border-w-s":[{"border-s":jt()}],"border-w-e":[{"border-e":jt()}],"border-w-t":[{"border-t":jt()}],"border-w-r":[{"border-r":jt()}],"border-w-b":[{"border-b":jt()}],"border-w-l":[{"border-l":jt()}],"divide-x":[{"divide-x":jt()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":jt()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Pt(),"hidden","none"]}],"divide-style":[{divide:[...Pt(),"hidden","none"]}],"border-color":[{border:et()}],"border-color-x":[{"border-x":et()}],"border-color-y":[{"border-y":et()}],"border-color-s":[{"border-s":et()}],"border-color-e":[{"border-e":et()}],"border-color-t":[{"border-t":et()}],"border-color-r":[{"border-r":et()}],"border-color-b":[{"border-b":et()}],"border-color-l":[{"border-l":et()}],"divide-color":[{divide:et()}],"outline-style":[{outline:[...Pt(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Zs,xi,vi]}],"outline-w":[{outline:["",Zs,c1,Sx]}],"outline-color":[{outline:et()}],shadow:[{shadow:["","none",E,Q2,J2]}],"shadow-color":[{shadow:et()}],"inset-shadow":[{"inset-shadow":["none",N,Q2,J2]}],"inset-shadow-color":[{"inset-shadow":et()}],"ring-w":[{ring:jt()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:et()}],"ring-offset-w":[{"ring-offset":[Zs,Sx]}],"ring-offset-color":[{"ring-offset":et()}],"inset-ring-w":[{"inset-ring":jt()}],"inset-ring-color":[{"inset-ring":et()}],"text-shadow":[{"text-shadow":["none",D,Q2,J2]}],"text-shadow-color":[{"text-shadow":et()}],opacity:[{opacity:[Zs,xi,vi]}],"mix-blend":[{"mix-blend":[...Ot(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Ot()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Zs]}],"mask-image-linear-from-pos":[{"mask-linear-from":Mt()}],"mask-image-linear-to-pos":[{"mask-linear-to":Mt()}],"mask-image-linear-from-color":[{"mask-linear-from":et()}],"mask-image-linear-to-color":[{"mask-linear-to":et()}],"mask-image-t-from-pos":[{"mask-t-from":Mt()}],"mask-image-t-to-pos":[{"mask-t-to":Mt()}],"mask-image-t-from-color":[{"mask-t-from":et()}],"mask-image-t-to-color":[{"mask-t-to":et()}],"mask-image-r-from-pos":[{"mask-r-from":Mt()}],"mask-image-r-to-pos":[{"mask-r-to":Mt()}],"mask-image-r-from-color":[{"mask-r-from":et()}],"mask-image-r-to-color":[{"mask-r-to":et()}],"mask-image-b-from-pos":[{"mask-b-from":Mt()}],"mask-image-b-to-pos":[{"mask-b-to":Mt()}],"mask-image-b-from-color":[{"mask-b-from":et()}],"mask-image-b-to-color":[{"mask-b-to":et()}],"mask-image-l-from-pos":[{"mask-l-from":Mt()}],"mask-image-l-to-pos":[{"mask-l-to":Mt()}],"mask-image-l-from-color":[{"mask-l-from":et()}],"mask-image-l-to-color":[{"mask-l-to":et()}],"mask-image-x-from-pos":[{"mask-x-from":Mt()}],"mask-image-x-to-pos":[{"mask-x-to":Mt()}],"mask-image-x-from-color":[{"mask-x-from":et()}],"mask-image-x-to-color":[{"mask-x-to":et()}],"mask-image-y-from-pos":[{"mask-y-from":Mt()}],"mask-image-y-to-pos":[{"mask-y-to":Mt()}],"mask-image-y-from-color":[{"mask-y-from":et()}],"mask-image-y-to-color":[{"mask-y-to":et()}],"mask-image-radial":[{"mask-radial":[xi,vi]}],"mask-image-radial-from-pos":[{"mask-radial-from":Mt()}],"mask-image-radial-to-pos":[{"mask-radial-to":Mt()}],"mask-image-radial-from-color":[{"mask-radial-from":et()}],"mask-image-radial-to-color":[{"mask-radial-to":et()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":ae()}],"mask-image-conic-pos":[{"mask-conic":[Zs]}],"mask-image-conic-from-pos":[{"mask-conic-from":Mt()}],"mask-image-conic-to-pos":[{"mask-conic-to":Mt()}],"mask-image-conic-from-color":[{"mask-conic-from":et()}],"mask-image-conic-to-color":[{"mask-conic-to":et()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:mt()}],"mask-repeat":[{mask:He()}],"mask-size":[{mask:pt()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",xi,vi]}],filter:[{filter:["","none",xi,vi]}],blur:[{blur:an()}],brightness:[{brightness:[Zs,xi,vi]}],contrast:[{contrast:[Zs,xi,vi]}],"drop-shadow":[{"drop-shadow":["","none",V,Q2,J2]}],"drop-shadow-color":[{"drop-shadow":et()}],grayscale:[{grayscale:["",Zs,xi,vi]}],"hue-rotate":[{"hue-rotate":[Zs,xi,vi]}],invert:[{invert:["",Zs,xi,vi]}],saturate:[{saturate:[Zs,xi,vi]}],sepia:[{sepia:["",Zs,xi,vi]}],"backdrop-filter":[{"backdrop-filter":["","none",xi,vi]}],"backdrop-blur":[{"backdrop-blur":an()}],"backdrop-brightness":[{"backdrop-brightness":[Zs,xi,vi]}],"backdrop-contrast":[{"backdrop-contrast":[Zs,xi,vi]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Zs,xi,vi]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Zs,xi,vi]}],"backdrop-invert":[{"backdrop-invert":["",Zs,xi,vi]}],"backdrop-opacity":[{"backdrop-opacity":[Zs,xi,vi]}],"backdrop-saturate":[{"backdrop-saturate":[Zs,xi,vi]}],"backdrop-sepia":[{"backdrop-sepia":["",Zs,xi,vi]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":ye()}],"border-spacing-x":[{"border-spacing-x":ye()}],"border-spacing-y":[{"border-spacing-y":ye()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",xi,vi]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Zs,"initial",xi,vi]}],ease:[{ease:["linear","initial",K,xi,vi]}],delay:[{delay:[Zs,xi,vi]}],animate:[{animate:["none",Y,xi,vi]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[B,xi,vi]}],"perspective-origin":[{"perspective-origin":Z()}],rotate:[{rotate:Jt()}],"rotate-x":[{"rotate-x":Jt()}],"rotate-y":[{"rotate-y":Jt()}],"rotate-z":[{"rotate-z":Jt()}],scale:[{scale:Cn()}],"scale-x":[{"scale-x":Cn()}],"scale-y":[{"scale-y":Cn()}],"scale-z":[{"scale-z":Cn()}],"scale-3d":["scale-3d"],skew:[{skew:nr()}],"skew-x":[{"skew-x":nr()}],"skew-y":[{"skew-y":nr()}],transform:[{transform:[xi,vi,"","none","gpu","cpu"]}],"transform-origin":[{origin:Z()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:sn()}],"translate-x":[{"translate-x":sn()}],"translate-y":[{"translate-y":sn()}],"translate-z":[{"translate-z":sn()}],"translate-none":["translate-none"],accent:[{accent:et()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:et()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",xi,vi]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ye()}],"scroll-mx":[{"scroll-mx":ye()}],"scroll-my":[{"scroll-my":ye()}],"scroll-ms":[{"scroll-ms":ye()}],"scroll-me":[{"scroll-me":ye()}],"scroll-mt":[{"scroll-mt":ye()}],"scroll-mr":[{"scroll-mr":ye()}],"scroll-mb":[{"scroll-mb":ye()}],"scroll-ml":[{"scroll-ml":ye()}],"scroll-p":[{"scroll-p":ye()}],"scroll-px":[{"scroll-px":ye()}],"scroll-py":[{"scroll-py":ye()}],"scroll-ps":[{"scroll-ps":ye()}],"scroll-pe":[{"scroll-pe":ye()}],"scroll-pt":[{"scroll-pt":ye()}],"scroll-pr":[{"scroll-pr":ye()}],"scroll-pb":[{"scroll-pb":ye()}],"scroll-pl":[{"scroll-pl":ye()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",xi,vi]}],fill:[{fill:["none",...et()]}],"stroke-w":[{stroke:[Zs,c1,Sx,bP]}],stroke:[{stroke:["none",...et()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Ofe=ffe(Rfe);function Rn(...e){return Ofe(es(e))}const X0=c3("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function kt({className:e,variant:t,size:n,asChild:r=!1,...c}){const f=r?rT:"button";return o.jsx(f,{"data-slot":"button",className:Rn(X0({variant:t,size:n,className:e})),...c})}function On({className:e,type:t,...n}){return o.jsx("input",{type:t,"data-slot":"input",className:Rn("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...n})}var Dfe="Separator",b6="horizontal",kfe=["horizontal","vertical"],fX=z.forwardRef((e,t)=>{const{decorative:n,orientation:r=b6,...c}=e,f=Ife(r)?r:b6,s=n?{role:"none"}:{"aria-orientation":f==="vertical"?f:void 0,role:"separator"};return o.jsx(Si.div,{"data-orientation":f,...s,...c,ref:t})});fX.displayName=Dfe;function Ife(e){return kfe.includes(e)}var Lfe=fX;function Oc({className:e,orientation:t="horizontal",decorative:n=!0,...r}){return o.jsx(Lfe,{"data-slot":"separator",decorative:n,orientation:t,className:Rn("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...r})}function Ff(e){const t=z.useRef(e);return z.useEffect(()=>{t.current=e}),z.useMemo(()=>(...n)=>t.current?.(...n),[])}function zfe(e,t=globalThis?.document){const n=Ff(e);z.useEffect(()=>{const r=c=>{c.key==="Escape"&&n(c)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var Ffe="DismissableLayer",Rk="dismissableLayer.update",Bfe="dismissableLayer.pointerDownOutside",Ufe="dismissableLayer.focusOutside",w6,pX=z.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Db=z.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:c,onFocusOutside:f,onInteractOutside:p,onDismiss:s,...w}=e,T=z.useContext(pX),[E,N]=z.useState(null),D=E?.ownerDocument??globalThis?.document,[,V]=z.useState({}),$=fa(t,he=>N(he)),B=Array.from(T.layers),[F]=[...T.layersWithOutsidePointerEventsDisabled].slice(-1),K=B.indexOf(F),Y=E?B.indexOf(E):-1,X=T.layersWithOutsidePointerEventsDisabled.size>0,ae=Y>=K,Z=qfe(he=>{const ye=he.target,Ce=[...T.branches].some(Ve=>Ve.contains(ye));!ae||Ce||(c?.(he),p?.(he),he.defaultPrevented||s?.())},D),se=Hfe(he=>{const ye=he.target;[...T.branches].some(Ve=>Ve.contains(ye))||(f?.(he),p?.(he),he.defaultPrevented||s?.())},D);return zfe(he=>{Y===T.layers.size-1&&(r?.(he),!he.defaultPrevented&&s&&(he.preventDefault(),s()))},D),z.useEffect(()=>{if(E)return n&&(T.layersWithOutsidePointerEventsDisabled.size===0&&(w6=D.body.style.pointerEvents,D.body.style.pointerEvents="none"),T.layersWithOutsidePointerEventsDisabled.add(E)),T.layers.add(E),S6(),()=>{n&&T.layersWithOutsidePointerEventsDisabled.size===1&&(D.body.style.pointerEvents=w6)}},[E,D,n,T]),z.useEffect(()=>()=>{E&&(T.layers.delete(E),T.layersWithOutsidePointerEventsDisabled.delete(E),S6())},[E,T]),z.useEffect(()=>{const he=()=>V({});return document.addEventListener(Rk,he),()=>document.removeEventListener(Rk,he)},[]),o.jsx(Si.div,{...w,ref:$,style:{pointerEvents:X?ae?"auto":"none":void 0,...e.style},onFocusCapture:Yr(e.onFocusCapture,se.onFocusCapture),onBlurCapture:Yr(e.onBlurCapture,se.onBlurCapture),onPointerDownCapture:Yr(e.onPointerDownCapture,Z.onPointerDownCapture)})});Db.displayName=Ffe;var Vfe="DismissableLayerBranch",$fe=z.forwardRef((e,t)=>{const n=z.useContext(pX),r=z.useRef(null),c=fa(t,r);return z.useEffect(()=>{const f=r.current;if(f)return n.branches.add(f),()=>{n.branches.delete(f)}},[n.branches]),o.jsx(Si.div,{...e,ref:c})});$fe.displayName=Vfe;function qfe(e,t=globalThis?.document){const n=Ff(e),r=z.useRef(!1),c=z.useRef(()=>{});return z.useEffect(()=>{const f=s=>{if(s.target&&!r.current){let w=function(){mX(Bfe,n,T,{discrete:!0})};const T={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",c.current),c.current=w,t.addEventListener("click",c.current,{once:!0})):w()}else t.removeEventListener("click",c.current);r.current=!1},p=window.setTimeout(()=>{t.addEventListener("pointerdown",f)},0);return()=>{window.clearTimeout(p),t.removeEventListener("pointerdown",f),t.removeEventListener("click",c.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function Hfe(e,t=globalThis?.document){const n=Ff(e),r=z.useRef(!1);return z.useEffect(()=>{const c=f=>{f.target&&!r.current&&mX(Ufe,n,{originalEvent:f},{discrete:!1})};return t.addEventListener("focusin",c),()=>t.removeEventListener("focusin",c)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function S6(){const e=new CustomEvent(Rk);document.dispatchEvent(e)}function mX(e,t,n,{discrete:r}){const c=n.originalEvent.target,f=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&c.addEventListener(e,t,{once:!0}),r?YW(c,f):c.dispatchEvent(f)}var wP="focusScope.autoFocusOnMount",SP="focusScope.autoFocusOnUnmount",T6={bubbles:!1,cancelable:!0},Gfe="FocusScope",iT=z.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:c,onUnmountAutoFocus:f,...p}=e,[s,w]=z.useState(null),T=Ff(c),E=Ff(f),N=z.useRef(null),D=fa(t,B=>w(B)),V=z.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;z.useEffect(()=>{if(r){let B=function(X){if(V.paused||!s)return;const ae=X.target;s.contains(ae)?N.current=ae:Uy(N.current,{select:!0})},F=function(X){if(V.paused||!s)return;const ae=X.relatedTarget;ae!==null&&(s.contains(ae)||Uy(N.current,{select:!0}))},K=function(X){if(document.activeElement===document.body)for(const Z of X)Z.removedNodes.length>0&&Uy(s)};document.addEventListener("focusin",B),document.addEventListener("focusout",F);const Y=new MutationObserver(K);return s&&Y.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",B),document.removeEventListener("focusout",F),Y.disconnect()}}},[r,s,V.paused]),z.useEffect(()=>{if(s){j6.add(V);const B=document.activeElement;if(!s.contains(B)){const K=new CustomEvent(wP,T6);s.addEventListener(wP,T),s.dispatchEvent(K),K.defaultPrevented||(Wfe(Jfe(gX(s)),{select:!0}),document.activeElement===B&&Uy(s))}return()=>{s.removeEventListener(wP,T),setTimeout(()=>{const K=new CustomEvent(SP,T6);s.addEventListener(SP,E),s.dispatchEvent(K),K.defaultPrevented||Uy(B??document.body,{select:!0}),s.removeEventListener(SP,E),j6.remove(V)},0)}}},[s,T,E,V]);const $=z.useCallback(B=>{if(!n&&!r||V.paused)return;const F=B.key==="Tab"&&!B.altKey&&!B.ctrlKey&&!B.metaKey,K=document.activeElement;if(F&&K){const Y=B.currentTarget,[X,ae]=Xfe(Y);X&&ae?!B.shiftKey&&K===ae?(B.preventDefault(),n&&Uy(X,{select:!0})):B.shiftKey&&K===X&&(B.preventDefault(),n&&Uy(ae,{select:!0})):K===Y&&B.preventDefault()}},[n,r,V.paused]);return o.jsx(Si.div,{tabIndex:-1,...p,ref:D,onKeyDown:$})});iT.displayName=Gfe;function Wfe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Uy(r,{select:t}),document.activeElement!==n)return}function Xfe(e){const t=gX(e),n=A6(t,e),r=A6(t.reverse(),e);return[n,r]}function gX(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const c=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||c?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function A6(e,t){for(const n of e)if(!Zfe(n,{upTo:t}))return n}function Zfe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Yfe(e){return e instanceof HTMLInputElement&&"select"in e}function Uy(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&Yfe(e)&&t&&e.select()}}var j6=Kfe();function Kfe(){let e=[];return{add(t){const n=e[0];t!==n&&n?.pause(),e=E6(e,t),e.unshift(t)},remove(t){e=E6(e,t),e[0]?.resume()}}}function E6(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function Jfe(e){return e.filter(t=>t.tagName!=="A")}var Qfe="Portal",kb=z.forwardRef((e,t)=>{const{container:n,...r}=e,[c,f]=z.useState(!1);Ol(()=>f(!0),[]);const p=n||c&&globalThis?.document?.body;return p?gW.createPortal(o.jsx(Si.div,{...r,ref:t}),p):null});kb.displayName=Qfe;var TP=0;function BE(){z.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??C6()),document.body.insertAdjacentElement("beforeend",e[1]??C6()),TP++,()=>{TP===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),TP--}},[])}function C6(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var qp=function(){return qp=Object.assign||function(t){for(var n,r=1,c=arguments.length;r<c;r++){n=arguments[r];for(var f in n)Object.prototype.hasOwnProperty.call(n,f)&&(t[f]=n[f])}return t},qp.apply(this,arguments)};function yX(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,r=Object.getOwnPropertySymbols(e);c<r.length;c++)t.indexOf(r[c])<0&&Object.prototype.propertyIsEnumerable.call(e,r[c])&&(n[r[c]]=e[r[c]]);return n}function epe(e,t,n){if(n||arguments.length===2)for(var r=0,c=t.length,f;r<c;r++)(f||!(r in t))&&(f||(f=Array.prototype.slice.call(t,0,r)),f[r]=t[r]);return e.concat(f||Array.prototype.slice.call(t))}var MA="right-scroll-bar-position",RA="width-before-scroll-bar",tpe="with-scroll-bars-hidden",npe="--removed-body-scroll-bar-size";function AP(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function rpe(e,t){var n=z.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var c=n.value;c!==r&&(n.value=r,n.callback(r,c))}}}})[0];return n.callback=t,n.facade}var ipe=typeof window<"u"?z.useLayoutEffect:z.useEffect,N6=new WeakMap;function spe(e,t){var n=rpe(null,function(r){return e.forEach(function(c){return AP(c,r)})});return ipe(function(){var r=N6.get(n);if(r){var c=new Set(r),f=new Set(e),p=n.current;c.forEach(function(s){f.has(s)||AP(s,null)}),f.forEach(function(s){c.has(s)||AP(s,p)})}N6.set(n,e)},[e]),n}function ape(e){return e}function ope(e,t){t===void 0&&(t=ape);var n=[],r=!1,c={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(f){var p=t(f,r);return n.push(p),function(){n=n.filter(function(s){return s!==p})}},assignSyncMedium:function(f){for(r=!0;n.length;){var p=n;n=[],p.forEach(f)}n={push:function(s){return f(s)},filter:function(){return n}}},assignMedium:function(f){r=!0;var p=[];if(n.length){var s=n;n=[],s.forEach(f),p=n}var w=function(){var E=p;p=[],E.forEach(f)},T=function(){return Promise.resolve().then(w)};T(),n={push:function(E){p.push(E),T()},filter:function(E){return p=p.filter(E),n}}}};return c}function lpe(e){e===void 0&&(e={});var t=ope(null);return t.options=qp({async:!0,ssr:!1},e),t}var vX=function(e){var t=e.sideCar,n=yX(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return z.createElement(r,qp({},n))};vX.isSideCarExport=!0;function cpe(e,t){return e.useMedium(t),vX}var xX=lpe(),jP=function(){},UE=z.forwardRef(function(e,t){var n=z.useRef(null),r=z.useState({onScrollCapture:jP,onWheelCapture:jP,onTouchMoveCapture:jP}),c=r[0],f=r[1],p=e.forwardProps,s=e.children,w=e.className,T=e.removeScrollBar,E=e.enabled,N=e.shards,D=e.sideCar,V=e.noRelative,$=e.noIsolation,B=e.inert,F=e.allowPinchZoom,K=e.as,Y=K===void 0?"div":K,X=e.gapMode,ae=yX(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),Z=D,se=spe([n,t]),he=qp(qp({},ae),c);return z.createElement(z.Fragment,null,E&&z.createElement(Z,{sideCar:xX,removeScrollBar:T,shards:N,noRelative:V,noIsolation:$,inert:B,setCallbacks:f,allowPinchZoom:!!F,lockRef:n,gapMode:X}),p?z.cloneElement(z.Children.only(s),qp(qp({},he),{ref:se})):z.createElement(Y,qp({},he,{className:w,ref:se}),s))});UE.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};UE.classNames={fullWidth:RA,zeroRight:MA};var upe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function dpe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=upe();return t&&e.setAttribute("nonce",t),e}function hpe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function fpe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var ppe=function(){var e=0,t=null;return{add:function(n){e==0&&(t=dpe())&&(hpe(t,n),fpe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},mpe=function(){var e=ppe();return function(t,n){z.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},_X=function(){var e=mpe(),t=function(n){var r=n.styles,c=n.dynamic;return e(r,c),null};return t},gpe={left:0,top:0,right:0,gap:0},EP=function(e){return parseInt(e||"",10)||0},ype=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],c=t[e==="padding"?"paddingRight":"marginRight"];return[EP(n),EP(r),EP(c)]},vpe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return gpe;var t=ype(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},xpe=_X(),L0="data-scroll-locked",_pe=function(e,t,n,r){var c=e.left,f=e.top,p=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(tpe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(L0,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(c,`px;
    padding-top: `).concat(f,`px;
    padding-right: `).concat(p,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(MA,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(RA,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(MA," .").concat(MA,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(RA," .").concat(RA,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(L0,`] {
    `).concat(npe,": ").concat(s,`px;
  }
`)},P6=function(){var e=parseInt(document.body.getAttribute(L0)||"0",10);return isFinite(e)?e:0},bpe=function(){z.useEffect(function(){return document.body.setAttribute(L0,(P6()+1).toString()),function(){var e=P6()-1;e<=0?document.body.removeAttribute(L0):document.body.setAttribute(L0,e.toString())}},[])},wpe=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,c=r===void 0?"margin":r;bpe();var f=z.useMemo(function(){return vpe(c)},[c]);return z.createElement(xpe,{styles:_pe(f,!t,c,n?"":"!important")})},Ok=!1;if(typeof window<"u")try{var eA=Object.defineProperty({},"passive",{get:function(){return Ok=!0,!0}});window.addEventListener("test",eA,eA),window.removeEventListener("test",eA,eA)}catch{Ok=!1}var f0=Ok?{passive:!1}:!1,Spe=function(e){return e.tagName==="TEXTAREA"},bX=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!Spe(e)&&n[t]==="visible")},Tpe=function(e){return bX(e,"overflowY")},Ape=function(e){return bX(e,"overflowX")},M6=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var c=wX(e,r);if(c){var f=SX(e,r),p=f[1],s=f[2];if(p>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},jpe=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},Epe=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},wX=function(e,t){return e==="v"?Tpe(t):Ape(t)},SX=function(e,t){return e==="v"?jpe(t):Epe(t)},Cpe=function(e,t){return e==="h"&&t==="rtl"?-1:1},Npe=function(e,t,n,r,c){var f=Cpe(e,window.getComputedStyle(t).direction),p=f*r,s=n.target,w=t.contains(s),T=!1,E=p>0,N=0,D=0;do{if(!s)break;var V=SX(e,s),$=V[0],B=V[1],F=V[2],K=B-F-f*$;($||K)&&wX(e,s)&&(N+=K,D+=$);var Y=s.parentNode;s=Y&&Y.nodeType===Node.DOCUMENT_FRAGMENT_NODE?Y.host:Y}while(!w&&s!==document.body||w&&(t.contains(s)||t===s));return(E&&Math.abs(N)<1||!E&&Math.abs(D)<1)&&(T=!0),T},tA=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},R6=function(e){return[e.deltaX,e.deltaY]},O6=function(e){return e&&"current"in e?e.current:e},Ppe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Mpe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Rpe=0,p0=[];function Ope(e){var t=z.useRef([]),n=z.useRef([0,0]),r=z.useRef(),c=z.useState(Rpe++)[0],f=z.useState(_X)[0],p=z.useRef(e);z.useEffect(function(){p.current=e},[e]),z.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(c));var B=epe([e.lockRef.current],(e.shards||[]).map(O6),!0).filter(Boolean);return B.forEach(function(F){return F.classList.add("allow-interactivity-".concat(c))}),function(){document.body.classList.remove("block-interactivity-".concat(c)),B.forEach(function(F){return F.classList.remove("allow-interactivity-".concat(c))})}}},[e.inert,e.lockRef.current,e.shards]);var s=z.useCallback(function(B,F){if("touches"in B&&B.touches.length===2||B.type==="wheel"&&B.ctrlKey)return!p.current.allowPinchZoom;var K=tA(B),Y=n.current,X="deltaX"in B?B.deltaX:Y[0]-K[0],ae="deltaY"in B?B.deltaY:Y[1]-K[1],Z,se=B.target,he=Math.abs(X)>Math.abs(ae)?"h":"v";if("touches"in B&&he==="h"&&se.type==="range")return!1;var ye=M6(he,se);if(!ye)return!0;if(ye?Z=he:(Z=he==="v"?"h":"v",ye=M6(he,se)),!ye)return!1;if(!r.current&&"changedTouches"in B&&(X||ae)&&(r.current=Z),!Z)return!0;var Ce=r.current||Z;return Npe(Ce,F,B,Ce==="h"?X:ae)},[]),w=z.useCallback(function(B){var F=B;if(!(!p0.length||p0[p0.length-1]!==f)){var K="deltaY"in F?R6(F):tA(F),Y=t.current.filter(function(Z){return Z.name===F.type&&(Z.target===F.target||F.target===Z.shadowParent)&&Ppe(Z.delta,K)})[0];if(Y&&Y.should){F.cancelable&&F.preventDefault();return}if(!Y){var X=(p.current.shards||[]).map(O6).filter(Boolean).filter(function(Z){return Z.contains(F.target)}),ae=X.length>0?s(F,X[0]):!p.current.noIsolation;ae&&F.cancelable&&F.preventDefault()}}},[]),T=z.useCallback(function(B,F,K,Y){var X={name:B,delta:F,target:K,should:Y,shadowParent:Dpe(K)};t.current.push(X),setTimeout(function(){t.current=t.current.filter(function(ae){return ae!==X})},1)},[]),E=z.useCallback(function(B){n.current=tA(B),r.current=void 0},[]),N=z.useCallback(function(B){T(B.type,R6(B),B.target,s(B,e.lockRef.current))},[]),D=z.useCallback(function(B){T(B.type,tA(B),B.target,s(B,e.lockRef.current))},[]);z.useEffect(function(){return p0.push(f),e.setCallbacks({onScrollCapture:N,onWheelCapture:N,onTouchMoveCapture:D}),document.addEventListener("wheel",w,f0),document.addEventListener("touchmove",w,f0),document.addEventListener("touchstart",E,f0),function(){p0=p0.filter(function(B){return B!==f}),document.removeEventListener("wheel",w,f0),document.removeEventListener("touchmove",w,f0),document.removeEventListener("touchstart",E,f0)}},[]);var V=e.removeScrollBar,$=e.inert;return z.createElement(z.Fragment,null,$?z.createElement(f,{styles:Mpe(c)}):null,V?z.createElement(wpe,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function Dpe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const kpe=cpe(xX,Ope);var sT=z.forwardRef(function(e,t){return z.createElement(UE,qp({},e,{ref:t,sideCar:kpe}))});sT.classNames=UE.classNames;var Ipe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},m0=new WeakMap,nA=new WeakMap,rA={},CP=0,TX=function(e){return e&&(e.host||TX(e.parentNode))},Lpe=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=TX(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},zpe=function(e,t,n,r){var c=Lpe(t,Array.isArray(e)?e:[e]);rA[n]||(rA[n]=new WeakMap);var f=rA[n],p=[],s=new Set,w=new Set(c),T=function(N){!N||s.has(N)||(s.add(N),T(N.parentNode))};c.forEach(T);var E=function(N){!N||w.has(N)||Array.prototype.forEach.call(N.children,function(D){if(s.has(D))E(D);else try{var V=D.getAttribute(r),$=V!==null&&V!=="false",B=(m0.get(D)||0)+1,F=(f.get(D)||0)+1;m0.set(D,B),f.set(D,F),p.push(D),B===1&&$&&nA.set(D,!0),F===1&&D.setAttribute(n,"true"),$||D.setAttribute(r,"true")}catch(K){console.error("aria-hidden: cannot operate on ",D,K)}})};return E(t),s.clear(),CP++,function(){p.forEach(function(N){var D=m0.get(N)-1,V=f.get(N)-1;m0.set(N,D),f.set(N,V),D||(nA.has(N)||N.removeAttribute(r),nA.delete(N)),V||N.removeAttribute(n)}),CP--,CP||(m0=new WeakMap,m0=new WeakMap,nA=new WeakMap,rA={})}},VE=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),c=Ipe(e);return c?(r.push.apply(r,Array.from(c.querySelectorAll("[aria-live], script"))),zpe(r,c,n,"aria-hidden")):function(){return null}},$E="Dialog",[AX,jX]=Eu($E),[Fpe,Hf]=AX($E),EX=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:c,onOpenChange:f,modal:p=!0}=e,s=z.useRef(null),w=z.useRef(null),[T,E]=zf({prop:r,defaultProp:c??!1,onChange:f,caller:$E});return o.jsx(Fpe,{scope:t,triggerRef:s,contentRef:w,contentId:Ml(),titleId:Ml(),descriptionId:Ml(),open:T,onOpenChange:E,onOpenToggle:z.useCallback(()=>E(N=>!N),[E]),modal:p,children:n})};EX.displayName=$E;var CX="DialogTrigger",NX=z.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,c=Hf(CX,n),f=fa(t,c.triggerRef);return o.jsx(Si.button,{type:"button","aria-haspopup":"dialog","aria-expanded":c.open,"aria-controls":c.contentId,"data-state":f3(c.open),...r,ref:f,onClick:Yr(e.onClick,c.onOpenToggle)})});NX.displayName=CX;var d3="DialogPortal",[Bpe,PX]=AX(d3,{forceMount:void 0}),MX=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:c}=e,f=Hf(d3,t);return o.jsx(Bpe,{scope:t,forceMount:n,children:z.Children.map(r,p=>o.jsx(nd,{present:n||f.open,children:o.jsx(kb,{asChild:!0,container:c,children:p})}))})};MX.displayName=d3;var HA="DialogOverlay",RX=z.forwardRef((e,t)=>{const n=PX(HA,e.__scopeDialog),{forceMount:r=n.forceMount,...c}=e,f=Hf(HA,e.__scopeDialog);return f.modal?o.jsx(nd,{present:r||f.open,children:o.jsx(Vpe,{...c,ref:t})}):null});RX.displayName=HA;var Upe=nv("DialogOverlay.RemoveScroll"),Vpe=z.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,c=Hf(HA,n);return o.jsx(sT,{as:Upe,allowPinchZoom:!0,shards:[c.contentRef],children:o.jsx(Si.div,{"data-state":f3(c.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Kx="DialogContent",OX=z.forwardRef((e,t)=>{const n=PX(Kx,e.__scopeDialog),{forceMount:r=n.forceMount,...c}=e,f=Hf(Kx,e.__scopeDialog);return o.jsx(nd,{present:r||f.open,children:f.modal?o.jsx($pe,{...c,ref:t}):o.jsx(qpe,{...c,ref:t})})});OX.displayName=Kx;var $pe=z.forwardRef((e,t)=>{const n=Hf(Kx,e.__scopeDialog),r=z.useRef(null),c=fa(t,n.contentRef,r);return z.useEffect(()=>{const f=r.current;if(f)return VE(f)},[]),o.jsx(DX,{...e,ref:c,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Yr(e.onCloseAutoFocus,f=>{f.preventDefault(),n.triggerRef.current?.focus()}),onPointerDownOutside:Yr(e.onPointerDownOutside,f=>{const p=f.detail.originalEvent,s=p.button===0&&p.ctrlKey===!0;(p.button===2||s)&&f.preventDefault()}),onFocusOutside:Yr(e.onFocusOutside,f=>f.preventDefault())})}),qpe=z.forwardRef((e,t)=>{const n=Hf(Kx,e.__scopeDialog),r=z.useRef(!1),c=z.useRef(!1);return o.jsx(DX,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:f=>{e.onCloseAutoFocus?.(f),f.defaultPrevented||(r.current||n.triggerRef.current?.focus(),f.preventDefault()),r.current=!1,c.current=!1},onInteractOutside:f=>{e.onInteractOutside?.(f),f.defaultPrevented||(r.current=!0,f.detail.originalEvent.type==="pointerdown"&&(c.current=!0));const p=f.target;n.triggerRef.current?.contains(p)&&f.preventDefault(),f.detail.originalEvent.type==="focusin"&&c.current&&f.preventDefault()}})}),DX=z.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:c,onCloseAutoFocus:f,...p}=e,s=Hf(Kx,n),w=z.useRef(null),T=fa(t,w);return BE(),o.jsxs(o.Fragment,{children:[o.jsx(iT,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:c,onUnmountAutoFocus:f,children:o.jsx(Db,{role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":f3(s.open),...p,ref:T,onDismiss:()=>s.onOpenChange(!1)})}),o.jsxs(o.Fragment,{children:[o.jsx(Gpe,{titleId:s.titleId}),o.jsx(Xpe,{contentRef:w,descriptionId:s.descriptionId})]})]})}),h3="DialogTitle",kX=z.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,c=Hf(h3,n);return o.jsx(Si.h2,{id:c.titleId,...r,ref:t})});kX.displayName=h3;var IX="DialogDescription",LX=z.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,c=Hf(IX,n);return o.jsx(Si.p,{id:c.descriptionId,...r,ref:t})});LX.displayName=IX;var zX="DialogClose",FX=z.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,c=Hf(zX,n);return o.jsx(Si.button,{type:"button",...r,ref:t,onClick:Yr(e.onClick,()=>c.onOpenChange(!1))})});FX.displayName=zX;function f3(e){return e?"open":"closed"}var BX="DialogTitleWarning",[Hpe,UX]=Rhe(BX,{contentName:Kx,titleName:h3,docsSlug:"dialog"}),Gpe=({titleId:e})=>{const t=UX(BX),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return z.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},Wpe="DialogDescriptionWarning",Xpe=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${UX(Wpe).contentName}}.`;return z.useEffect(()=>{const c=e.current?.getAttribute("aria-describedby");t&&c&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},qE=EX,VX=NX,HE=MX,GE=RX,WE=OX,p3=kX,m3=LX,aT=FX;function Zpe({...e}){return o.jsx(qE,{"data-slot":"sheet",...e})}function Ype({...e}){return o.jsx(HE,{"data-slot":"sheet-portal",...e})}function Kpe({className:e,...t}){return o.jsx(GE,{"data-slot":"sheet-overlay",className:Rn("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function Jpe({className:e,children:t,side:n="right",...r}){return o.jsxs(Ype,{children:[o.jsx(Kpe,{}),o.jsxs(WE,{"data-slot":"sheet-content",className:Rn("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",n==="right"&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",n==="left"&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",n==="top"&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",n==="bottom"&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",e),...r,children:[t,o.jsxs(aT,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[o.jsx(bg,{className:"size-4"}),o.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function Qpe({className:e,...t}){return o.jsx("div",{"data-slot":"sheet-header",className:Rn("flex flex-col gap-1.5 p-4",e),...t})}function eme({className:e,...t}){return o.jsx(p3,{"data-slot":"sheet-title",className:Rn("text-foreground font-semibold",e),...t})}function tme({className:e,...t}){return o.jsx(m3,{"data-slot":"sheet-description",className:Rn("text-muted-foreground text-sm",e),...t})}function ko({className:e,...t}){return o.jsx("div",{"data-slot":"skeleton",className:Rn("bg-accent animate-pulse rounded-md",e),...t})}const nme=["top","right","bottom","left"],rv=Math.min,Hd=Math.max,GA=Math.round,iA=Math.floor,Jp=e=>({x:e,y:e}),rme={left:"right",right:"left",bottom:"top",top:"bottom"},ime={start:"end",end:"start"};function Dk(e,t,n){return Hd(e,rv(t,n))}function jg(e,t){return typeof e=="function"?e(t):e}function Eg(e){return e.split("-")[0]}function Ib(e){return e.split("-")[1]}function g3(e){return e==="x"?"y":"x"}function y3(e){return e==="y"?"height":"width"}const sme=new Set(["top","bottom"]);function Gp(e){return sme.has(Eg(e))?"y":"x"}function v3(e){return g3(Gp(e))}function ame(e,t,n){n===void 0&&(n=!1);const r=Ib(e),c=v3(e),f=y3(c);let p=c==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[f]>t.floating[f]&&(p=WA(p)),[p,WA(p)]}function ome(e){const t=WA(e);return[kk(e),t,kk(t)]}function kk(e){return e.replace(/start|end/g,t=>ime[t])}const D6=["left","right"],k6=["right","left"],lme=["top","bottom"],cme=["bottom","top"];function ume(e,t,n){switch(e){case"top":case"bottom":return n?t?k6:D6:t?D6:k6;case"left":case"right":return t?lme:cme;default:return[]}}function dme(e,t,n,r){const c=Ib(e);let f=ume(Eg(e),n==="start",r);return c&&(f=f.map(p=>p+"-"+c),t&&(f=f.concat(f.map(kk)))),f}function WA(e){return e.replace(/left|right|bottom|top/g,t=>rme[t])}function hme(e){return{top:0,right:0,bottom:0,left:0,...e}}function $X(e){return typeof e!="number"?hme(e):{top:e,right:e,bottom:e,left:e}}function XA(e){const{x:t,y:n,width:r,height:c}=e;return{width:r,height:c,top:n,left:t,right:t+r,bottom:n+c,x:t,y:n}}function I6(e,t,n){let{reference:r,floating:c}=e;const f=Gp(t),p=v3(t),s=y3(p),w=Eg(t),T=f==="y",E=r.x+r.width/2-c.width/2,N=r.y+r.height/2-c.height/2,D=r[s]/2-c[s]/2;let V;switch(w){case"top":V={x:E,y:r.y-c.height};break;case"bottom":V={x:E,y:r.y+r.height};break;case"right":V={x:r.x+r.width,y:N};break;case"left":V={x:r.x-c.width,y:N};break;default:V={x:r.x,y:r.y}}switch(Ib(t)){case"start":V[p]-=D*(n&&T?-1:1);break;case"end":V[p]+=D*(n&&T?-1:1);break}return V}const fme=async(e,t,n)=>{const{placement:r="bottom",strategy:c="absolute",middleware:f=[],platform:p}=n,s=f.filter(Boolean),w=await(p.isRTL==null?void 0:p.isRTL(t));let T=await p.getElementRects({reference:e,floating:t,strategy:c}),{x:E,y:N}=I6(T,r,w),D=r,V={},$=0;for(let B=0;B<s.length;B++){const{name:F,fn:K}=s[B],{x:Y,y:X,data:ae,reset:Z}=await K({x:E,y:N,initialPlacement:r,placement:D,strategy:c,middlewareData:V,rects:T,platform:p,elements:{reference:e,floating:t}});E=Y??E,N=X??N,V={...V,[F]:{...V[F],...ae}},Z&&$<=50&&($++,typeof Z=="object"&&(Z.placement&&(D=Z.placement),Z.rects&&(T=Z.rects===!0?await p.getElementRects({reference:e,floating:t,strategy:c}):Z.rects),{x:E,y:N}=I6(T,D,w)),B=-1)}return{x:E,y:N,placement:D,strategy:c,middlewareData:V}};async function J1(e,t){var n;t===void 0&&(t={});const{x:r,y:c,platform:f,rects:p,elements:s,strategy:w}=e,{boundary:T="clippingAncestors",rootBoundary:E="viewport",elementContext:N="floating",altBoundary:D=!1,padding:V=0}=jg(t,e),$=$X(V),F=s[D?N==="floating"?"reference":"floating":N],K=XA(await f.getClippingRect({element:(n=await(f.isElement==null?void 0:f.isElement(F)))==null||n?F:F.contextElement||await(f.getDocumentElement==null?void 0:f.getDocumentElement(s.floating)),boundary:T,rootBoundary:E,strategy:w})),Y=N==="floating"?{x:r,y:c,width:p.floating.width,height:p.floating.height}:p.reference,X=await(f.getOffsetParent==null?void 0:f.getOffsetParent(s.floating)),ae=await(f.isElement==null?void 0:f.isElement(X))?await(f.getScale==null?void 0:f.getScale(X))||{x:1,y:1}:{x:1,y:1},Z=XA(f.convertOffsetParentRelativeRectToViewportRelativeRect?await f.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:Y,offsetParent:X,strategy:w}):Y);return{top:(K.top-Z.top+$.top)/ae.y,bottom:(Z.bottom-K.bottom+$.bottom)/ae.y,left:(K.left-Z.left+$.left)/ae.x,right:(Z.right-K.right+$.right)/ae.x}}const pme=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:c,rects:f,platform:p,elements:s,middlewareData:w}=t,{element:T,padding:E=0}=jg(e,t)||{};if(T==null)return{};const N=$X(E),D={x:n,y:r},V=v3(c),$=y3(V),B=await p.getDimensions(T),F=V==="y",K=F?"top":"left",Y=F?"bottom":"right",X=F?"clientHeight":"clientWidth",ae=f.reference[$]+f.reference[V]-D[V]-f.floating[$],Z=D[V]-f.reference[V],se=await(p.getOffsetParent==null?void 0:p.getOffsetParent(T));let he=se?se[X]:0;(!he||!await(p.isElement==null?void 0:p.isElement(se)))&&(he=s.floating[X]||f.floating[$]);const ye=ae/2-Z/2,Ce=he/2-B[$]/2-1,Ve=rv(N[K],Ce),Re=rv(N[Y],Ce),$e=Ve,nt=he-B[$]-Re,Me=he/2-B[$]/2+ye,rt=Dk($e,Me,nt),Ee=!w.arrow&&Ib(c)!=null&&Me!==rt&&f.reference[$]/2-(Me<$e?Ve:Re)-B[$]/2<0,it=Ee?Me<$e?Me-$e:Me-nt:0;return{[V]:D[V]+it,data:{[V]:rt,centerOffset:Me-rt-it,...Ee&&{alignmentOffset:it}},reset:Ee}}}),mme=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:c,middlewareData:f,rects:p,initialPlacement:s,platform:w,elements:T}=t,{mainAxis:E=!0,crossAxis:N=!0,fallbackPlacements:D,fallbackStrategy:V="bestFit",fallbackAxisSideDirection:$="none",flipAlignment:B=!0,...F}=jg(e,t);if((n=f.arrow)!=null&&n.alignmentOffset)return{};const K=Eg(c),Y=Gp(s),X=Eg(s)===s,ae=await(w.isRTL==null?void 0:w.isRTL(T.floating)),Z=D||(X||!B?[WA(s)]:ome(s)),se=$!=="none";!D&&se&&Z.push(...dme(s,B,$,ae));const he=[s,...Z],ye=await J1(t,F),Ce=[];let Ve=((r=f.flip)==null?void 0:r.overflows)||[];if(E&&Ce.push(ye[K]),N){const Me=ame(c,p,ae);Ce.push(ye[Me[0]],ye[Me[1]])}if(Ve=[...Ve,{placement:c,overflows:Ce}],!Ce.every(Me=>Me<=0)){var Re,$e;const Me=(((Re=f.flip)==null?void 0:Re.index)||0)+1,rt=he[Me];if(rt&&(!(N==="alignment"?Y!==Gp(rt):!1)||Ve.every(et=>Gp(et.placement)===Y?et.overflows[0]>0:!0)))return{data:{index:Me,overflows:Ve},reset:{placement:rt}};let Ee=($e=Ve.filter(it=>it.overflows[0]<=0).sort((it,et)=>it.overflows[1]-et.overflows[1])[0])==null?void 0:$e.placement;if(!Ee)switch(V){case"bestFit":{var nt;const it=(nt=Ve.filter(et=>{if(se){const mt=Gp(et.placement);return mt===Y||mt==="y"}return!0}).map(et=>[et.placement,et.overflows.filter(mt=>mt>0).reduce((mt,He)=>mt+He,0)]).sort((et,mt)=>et[1]-mt[1])[0])==null?void 0:nt[0];it&&(Ee=it);break}case"initialPlacement":Ee=s;break}if(c!==Ee)return{reset:{placement:Ee}}}return{}}}};function L6(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function z6(e){return nme.some(t=>e[t]>=0)}const gme=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...c}=jg(e,t);switch(r){case"referenceHidden":{const f=await J1(t,{...c,elementContext:"reference"}),p=L6(f,n.reference);return{data:{referenceHiddenOffsets:p,referenceHidden:z6(p)}}}case"escaped":{const f=await J1(t,{...c,altBoundary:!0}),p=L6(f,n.floating);return{data:{escapedOffsets:p,escaped:z6(p)}}}default:return{}}}}},qX=new Set(["left","top"]);async function yme(e,t){const{placement:n,platform:r,elements:c}=e,f=await(r.isRTL==null?void 0:r.isRTL(c.floating)),p=Eg(n),s=Ib(n),w=Gp(n)==="y",T=qX.has(p)?-1:1,E=f&&w?-1:1,N=jg(t,e);let{mainAxis:D,crossAxis:V,alignmentAxis:$}=typeof N=="number"?{mainAxis:N,crossAxis:0,alignmentAxis:null}:{mainAxis:N.mainAxis||0,crossAxis:N.crossAxis||0,alignmentAxis:N.alignmentAxis};return s&&typeof $=="number"&&(V=s==="end"?$*-1:$),w?{x:V*E,y:D*T}:{x:D*T,y:V*E}}const vme=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:c,y:f,placement:p,middlewareData:s}=t,w=await yme(t,e);return p===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:c+w.x,y:f+w.y,data:{...w,placement:p}}}}},xme=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:c}=t,{mainAxis:f=!0,crossAxis:p=!1,limiter:s={fn:F=>{let{x:K,y:Y}=F;return{x:K,y:Y}}},...w}=jg(e,t),T={x:n,y:r},E=await J1(t,w),N=Gp(Eg(c)),D=g3(N);let V=T[D],$=T[N];if(f){const F=D==="y"?"top":"left",K=D==="y"?"bottom":"right",Y=V+E[F],X=V-E[K];V=Dk(Y,V,X)}if(p){const F=N==="y"?"top":"left",K=N==="y"?"bottom":"right",Y=$+E[F],X=$-E[K];$=Dk(Y,$,X)}const B=s.fn({...t,[D]:V,[N]:$});return{...B,data:{x:B.x-n,y:B.y-r,enabled:{[D]:f,[N]:p}}}}}},_me=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:c,rects:f,middlewareData:p}=t,{offset:s=0,mainAxis:w=!0,crossAxis:T=!0}=jg(e,t),E={x:n,y:r},N=Gp(c),D=g3(N);let V=E[D],$=E[N];const B=jg(s,t),F=typeof B=="number"?{mainAxis:B,crossAxis:0}:{mainAxis:0,crossAxis:0,...B};if(w){const X=D==="y"?"height":"width",ae=f.reference[D]-f.floating[X]+F.mainAxis,Z=f.reference[D]+f.reference[X]-F.mainAxis;V<ae?V=ae:V>Z&&(V=Z)}if(T){var K,Y;const X=D==="y"?"width":"height",ae=qX.has(Eg(c)),Z=f.reference[N]-f.floating[X]+(ae&&((K=p.offset)==null?void 0:K[N])||0)+(ae?0:F.crossAxis),se=f.reference[N]+f.reference[X]+(ae?0:((Y=p.offset)==null?void 0:Y[N])||0)-(ae?F.crossAxis:0);$<Z?$=Z:$>se&&($=se)}return{[D]:V,[N]:$}}}},bme=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:c,rects:f,platform:p,elements:s}=t,{apply:w=()=>{},...T}=jg(e,t),E=await J1(t,T),N=Eg(c),D=Ib(c),V=Gp(c)==="y",{width:$,height:B}=f.floating;let F,K;N==="top"||N==="bottom"?(F=N,K=D===(await(p.isRTL==null?void 0:p.isRTL(s.floating))?"start":"end")?"left":"right"):(K=N,F=D==="end"?"top":"bottom");const Y=B-E.top-E.bottom,X=$-E.left-E.right,ae=rv(B-E[F],Y),Z=rv($-E[K],X),se=!t.middlewareData.shift;let he=ae,ye=Z;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(ye=X),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(he=Y),se&&!D){const Ve=Hd(E.left,0),Re=Hd(E.right,0),$e=Hd(E.top,0),nt=Hd(E.bottom,0);V?ye=$-2*(Ve!==0||Re!==0?Ve+Re:Hd(E.left,E.right)):he=B-2*($e!==0||nt!==0?$e+nt:Hd(E.top,E.bottom))}await w({...t,availableWidth:ye,availableHeight:he});const Ce=await p.getDimensions(s.floating);return $!==Ce.width||B!==Ce.height?{reset:{rects:!0}}:{}}}};function XE(){return typeof window<"u"}function Lb(e){return HX(e)?(e.nodeName||"").toLowerCase():"#document"}function Xd(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function cm(e){var t;return(t=(HX(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function HX(e){return XE()?e instanceof Node||e instanceof Xd(e).Node:!1}function Bf(e){return XE()?e instanceof Element||e instanceof Xd(e).Element:!1}function am(e){return XE()?e instanceof HTMLElement||e instanceof Xd(e).HTMLElement:!1}function F6(e){return!XE()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Xd(e).ShadowRoot}const wme=new Set(["inline","contents"]);function oT(e){const{overflow:t,overflowX:n,overflowY:r,display:c}=Uf(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!wme.has(c)}const Sme=new Set(["table","td","th"]);function Tme(e){return Sme.has(Lb(e))}const Ame=[":popover-open",":modal"];function ZE(e){return Ame.some(t=>{try{return e.matches(t)}catch{return!1}})}const jme=["transform","translate","scale","rotate","perspective"],Eme=["transform","translate","scale","rotate","perspective","filter"],Cme=["paint","layout","strict","content"];function x3(e){const t=_3(),n=Bf(e)?Uf(e):e;return jme.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||Eme.some(r=>(n.willChange||"").includes(r))||Cme.some(r=>(n.contain||"").includes(r))}function Nme(e){let t=iv(e);for(;am(t)&&!Z0(t);){if(x3(t))return t;if(ZE(t))return null;t=iv(t)}return null}function _3(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Pme=new Set(["html","body","#document"]);function Z0(e){return Pme.has(Lb(e))}function Uf(e){return Xd(e).getComputedStyle(e)}function YE(e){return Bf(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function iv(e){if(Lb(e)==="html")return e;const t=e.assignedSlot||e.parentNode||F6(e)&&e.host||cm(e);return F6(t)?t.host:t}function GX(e){const t=iv(e);return Z0(t)?e.ownerDocument?e.ownerDocument.body:e.body:am(t)&&oT(t)?t:GX(t)}function Q1(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const c=GX(e),f=c===((r=e.ownerDocument)==null?void 0:r.body),p=Xd(c);if(f){const s=Ik(p);return t.concat(p,p.visualViewport||[],oT(c)?c:[],s&&n?Q1(s):[])}return t.concat(c,Q1(c,[],n))}function Ik(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function WX(e){const t=Uf(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const c=am(e),f=c?e.offsetWidth:n,p=c?e.offsetHeight:r,s=GA(n)!==f||GA(r)!==p;return s&&(n=f,r=p),{width:n,height:r,$:s}}function b3(e){return Bf(e)?e:e.contextElement}function z0(e){const t=b3(e);if(!am(t))return Jp(1);const n=t.getBoundingClientRect(),{width:r,height:c,$:f}=WX(t);let p=(f?GA(n.width):n.width)/r,s=(f?GA(n.height):n.height)/c;return(!p||!Number.isFinite(p))&&(p=1),(!s||!Number.isFinite(s))&&(s=1),{x:p,y:s}}const Mme=Jp(0);function XX(e){const t=Xd(e);return!_3()||!t.visualViewport?Mme:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Rme(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Xd(e)?!1:t}function Jx(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const c=e.getBoundingClientRect(),f=b3(e);let p=Jp(1);t&&(r?Bf(r)&&(p=z0(r)):p=z0(e));const s=Rme(f,n,r)?XX(f):Jp(0);let w=(c.left+s.x)/p.x,T=(c.top+s.y)/p.y,E=c.width/p.x,N=c.height/p.y;if(f){const D=Xd(f),V=r&&Bf(r)?Xd(r):r;let $=D,B=Ik($);for(;B&&r&&V!==$;){const F=z0(B),K=B.getBoundingClientRect(),Y=Uf(B),X=K.left+(B.clientLeft+parseFloat(Y.paddingLeft))*F.x,ae=K.top+(B.clientTop+parseFloat(Y.paddingTop))*F.y;w*=F.x,T*=F.y,E*=F.x,N*=F.y,w+=X,T+=ae,$=Xd(B),B=Ik($)}}return XA({width:E,height:N,x:w,y:T})}function w3(e,t){const n=YE(e).scrollLeft;return t?t.left+n:Jx(cm(e)).left+n}function ZX(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),c=r.left+t.scrollLeft-(n?0:w3(e,r)),f=r.top+t.scrollTop;return{x:c,y:f}}function Ome(e){let{elements:t,rect:n,offsetParent:r,strategy:c}=e;const f=c==="fixed",p=cm(r),s=t?ZE(t.floating):!1;if(r===p||s&&f)return n;let w={scrollLeft:0,scrollTop:0},T=Jp(1);const E=Jp(0),N=am(r);if((N||!N&&!f)&&((Lb(r)!=="body"||oT(p))&&(w=YE(r)),am(r))){const V=Jx(r);T=z0(r),E.x=V.x+r.clientLeft,E.y=V.y+r.clientTop}const D=p&&!N&&!f?ZX(p,w,!0):Jp(0);return{width:n.width*T.x,height:n.height*T.y,x:n.x*T.x-w.scrollLeft*T.x+E.x+D.x,y:n.y*T.y-w.scrollTop*T.y+E.y+D.y}}function Dme(e){return Array.from(e.getClientRects())}function kme(e){const t=cm(e),n=YE(e),r=e.ownerDocument.body,c=Hd(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),f=Hd(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let p=-n.scrollLeft+w3(e);const s=-n.scrollTop;return Uf(r).direction==="rtl"&&(p+=Hd(t.clientWidth,r.clientWidth)-c),{width:c,height:f,x:p,y:s}}function Ime(e,t){const n=Xd(e),r=cm(e),c=n.visualViewport;let f=r.clientWidth,p=r.clientHeight,s=0,w=0;if(c){f=c.width,p=c.height;const T=_3();(!T||T&&t==="fixed")&&(s=c.offsetLeft,w=c.offsetTop)}return{width:f,height:p,x:s,y:w}}const Lme=new Set(["absolute","fixed"]);function zme(e,t){const n=Jx(e,!0,t==="fixed"),r=n.top+e.clientTop,c=n.left+e.clientLeft,f=am(e)?z0(e):Jp(1),p=e.clientWidth*f.x,s=e.clientHeight*f.y,w=c*f.x,T=r*f.y;return{width:p,height:s,x:w,y:T}}function B6(e,t,n){let r;if(t==="viewport")r=Ime(e,n);else if(t==="document")r=kme(cm(e));else if(Bf(t))r=zme(t,n);else{const c=XX(e);r={x:t.x-c.x,y:t.y-c.y,width:t.width,height:t.height}}return XA(r)}function YX(e,t){const n=iv(e);return n===t||!Bf(n)||Z0(n)?!1:Uf(n).position==="fixed"||YX(n,t)}function Fme(e,t){const n=t.get(e);if(n)return n;let r=Q1(e,[],!1).filter(s=>Bf(s)&&Lb(s)!=="body"),c=null;const f=Uf(e).position==="fixed";let p=f?iv(e):e;for(;Bf(p)&&!Z0(p);){const s=Uf(p),w=x3(p);!w&&s.position==="fixed"&&(c=null),(f?!w&&!c:!w&&s.position==="static"&&!!c&&Lme.has(c.position)||oT(p)&&!w&&YX(e,p))?r=r.filter(E=>E!==p):c=s,p=iv(p)}return t.set(e,r),r}function Bme(e){let{element:t,boundary:n,rootBoundary:r,strategy:c}=e;const p=[...n==="clippingAncestors"?ZE(t)?[]:Fme(t,this._c):[].concat(n),r],s=p[0],w=p.reduce((T,E)=>{const N=B6(t,E,c);return T.top=Hd(N.top,T.top),T.right=rv(N.right,T.right),T.bottom=rv(N.bottom,T.bottom),T.left=Hd(N.left,T.left),T},B6(t,s,c));return{width:w.right-w.left,height:w.bottom-w.top,x:w.left,y:w.top}}function Ume(e){const{width:t,height:n}=WX(e);return{width:t,height:n}}function Vme(e,t,n){const r=am(t),c=cm(t),f=n==="fixed",p=Jx(e,!0,f,t);let s={scrollLeft:0,scrollTop:0};const w=Jp(0);function T(){w.x=w3(c)}if(r||!r&&!f)if((Lb(t)!=="body"||oT(c))&&(s=YE(t)),r){const V=Jx(t,!0,f,t);w.x=V.x+t.clientLeft,w.y=V.y+t.clientTop}else c&&T();f&&!r&&c&&T();const E=c&&!r&&!f?ZX(c,s):Jp(0),N=p.left+s.scrollLeft-w.x-E.x,D=p.top+s.scrollTop-w.y-E.y;return{x:N,y:D,width:p.width,height:p.height}}function NP(e){return Uf(e).position==="static"}function U6(e,t){if(!am(e)||Uf(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return cm(e)===n&&(n=n.ownerDocument.body),n}function KX(e,t){const n=Xd(e);if(ZE(e))return n;if(!am(e)){let c=iv(e);for(;c&&!Z0(c);){if(Bf(c)&&!NP(c))return c;c=iv(c)}return n}let r=U6(e,t);for(;r&&Tme(r)&&NP(r);)r=U6(r,t);return r&&Z0(r)&&NP(r)&&!x3(r)?n:r||Nme(e)||n}const $me=async function(e){const t=this.getOffsetParent||KX,n=this.getDimensions,r=await n(e.floating);return{reference:Vme(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function qme(e){return Uf(e).direction==="rtl"}const Hme={convertOffsetParentRelativeRectToViewportRelativeRect:Ome,getDocumentElement:cm,getClippingRect:Bme,getOffsetParent:KX,getElementRects:$me,getClientRects:Dme,getDimensions:Ume,getScale:z0,isElement:Bf,isRTL:qme};function JX(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Gme(e,t){let n=null,r;const c=cm(e);function f(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function p(s,w){s===void 0&&(s=!1),w===void 0&&(w=1),f();const T=e.getBoundingClientRect(),{left:E,top:N,width:D,height:V}=T;if(s||t(),!D||!V)return;const $=iA(N),B=iA(c.clientWidth-(E+D)),F=iA(c.clientHeight-(N+V)),K=iA(E),X={rootMargin:-$+"px "+-B+"px "+-F+"px "+-K+"px",threshold:Hd(0,rv(1,w))||1};let ae=!0;function Z(se){const he=se[0].intersectionRatio;if(he!==w){if(!ae)return p();he?p(!1,he):r=setTimeout(()=>{p(!1,1e-7)},1e3)}he===1&&!JX(T,e.getBoundingClientRect())&&p(),ae=!1}try{n=new IntersectionObserver(Z,{...X,root:c.ownerDocument})}catch{n=new IntersectionObserver(Z,X)}n.observe(e)}return p(!0),f}function Wme(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:c=!0,ancestorResize:f=!0,elementResize:p=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:w=!1}=r,T=b3(e),E=c||f?[...T?Q1(T):[],...Q1(t)]:[];E.forEach(K=>{c&&K.addEventListener("scroll",n,{passive:!0}),f&&K.addEventListener("resize",n)});const N=T&&s?Gme(T,n):null;let D=-1,V=null;p&&(V=new ResizeObserver(K=>{let[Y]=K;Y&&Y.target===T&&V&&(V.unobserve(t),cancelAnimationFrame(D),D=requestAnimationFrame(()=>{var X;(X=V)==null||X.observe(t)})),n()}),T&&!w&&V.observe(T),V.observe(t));let $,B=w?Jx(e):null;w&&F();function F(){const K=Jx(e);B&&!JX(B,K)&&n(),B=K,$=requestAnimationFrame(F)}return n(),()=>{var K;E.forEach(Y=>{c&&Y.removeEventListener("scroll",n),f&&Y.removeEventListener("resize",n)}),N?.(),(K=V)==null||K.disconnect(),V=null,w&&cancelAnimationFrame($)}}const Xme=vme,Zme=xme,Yme=mme,Kme=bme,Jme=gme,V6=pme,Qme=_me,ege=(e,t,n)=>{const r=new Map,c={platform:Hme,...n},f={...c.platform,_c:r};return fme(e,t,{...c,platform:f})};var tge=typeof document<"u",nge=function(){},OA=tge?z.useLayoutEffect:nge;function ZA(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,c;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!ZA(e[r],t[r]))return!1;return!0}if(c=Object.keys(e),n=c.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,c[r]))return!1;for(r=n;r--!==0;){const f=c[r];if(!(f==="_owner"&&e.$$typeof)&&!ZA(e[f],t[f]))return!1}return!0}return e!==e&&t!==t}function QX(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function $6(e,t){const n=QX(e);return Math.round(t*n)/n}function PP(e){const t=z.useRef(e);return OA(()=>{t.current=e}),t}function rge(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:c,elements:{reference:f,floating:p}={},transform:s=!0,whileElementsMounted:w,open:T}=e,[E,N]=z.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[D,V]=z.useState(r);ZA(D,r)||V(r);const[$,B]=z.useState(null),[F,K]=z.useState(null),Y=z.useCallback(et=>{et!==se.current&&(se.current=et,B(et))},[]),X=z.useCallback(et=>{et!==he.current&&(he.current=et,K(et))},[]),ae=f||$,Z=p||F,se=z.useRef(null),he=z.useRef(null),ye=z.useRef(E),Ce=w!=null,Ve=PP(w),Re=PP(c),$e=PP(T),nt=z.useCallback(()=>{if(!se.current||!he.current)return;const et={placement:t,strategy:n,middleware:D};Re.current&&(et.platform=Re.current),ege(se.current,he.current,et).then(mt=>{const He={...mt,isPositioned:$e.current!==!1};Me.current&&!ZA(ye.current,He)&&(ye.current=He,YS.flushSync(()=>{N(He)}))})},[D,t,n,Re,$e]);OA(()=>{T===!1&&ye.current.isPositioned&&(ye.current.isPositioned=!1,N(et=>({...et,isPositioned:!1})))},[T]);const Me=z.useRef(!1);OA(()=>(Me.current=!0,()=>{Me.current=!1}),[]),OA(()=>{if(ae&&(se.current=ae),Z&&(he.current=Z),ae&&Z){if(Ve.current)return Ve.current(ae,Z,nt);nt()}},[ae,Z,nt,Ve,Ce]);const rt=z.useMemo(()=>({reference:se,floating:he,setReference:Y,setFloating:X}),[Y,X]),Ee=z.useMemo(()=>({reference:ae,floating:Z}),[ae,Z]),it=z.useMemo(()=>{const et={position:n,left:0,top:0};if(!Ee.floating)return et;const mt=$6(Ee.floating,E.x),He=$6(Ee.floating,E.y);return s?{...et,transform:"translate("+mt+"px, "+He+"px)",...QX(Ee.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:mt,top:He}},[n,s,Ee.floating,E.x,E.y]);return z.useMemo(()=>({...E,update:nt,refs:rt,elements:Ee,floatingStyles:it}),[E,nt,rt,Ee,it])}const ige=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:c}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?V6({element:r.current,padding:c}).fn(n):{}:r?V6({element:r,padding:c}).fn(n):{}}}},sge=(e,t)=>({...Xme(e),options:[e,t]}),age=(e,t)=>({...Zme(e),options:[e,t]}),oge=(e,t)=>({...Qme(e),options:[e,t]}),lge=(e,t)=>({...Yme(e),options:[e,t]}),cge=(e,t)=>({...Kme(e),options:[e,t]}),uge=(e,t)=>({...Jme(e),options:[e,t]}),dge=(e,t)=>({...ige(e),options:[e,t]});var hge="Arrow",eZ=z.forwardRef((e,t)=>{const{children:n,width:r=10,height:c=5,...f}=e;return o.jsx(Si.svg,{...f,ref:t,width:r,height:c,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:o.jsx("polygon",{points:"0,0 30,0 15,10"})})});eZ.displayName=hge;var fge=eZ;function pge(e){const[t,n]=z.useState(void 0);return Ol(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(c=>{if(!Array.isArray(c)||!c.length)return;const f=c[0];let p,s;if("borderBoxSize"in f){const w=f.borderBoxSize,T=Array.isArray(w)?w[0]:w;p=T.inlineSize,s=T.blockSize}else p=e.offsetWidth,s=e.offsetHeight;n({width:p,height:s})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var S3="Popper",[tZ,uv]=Eu(S3),[mge,nZ]=tZ(S3),rZ=e=>{const{__scopePopper:t,children:n}=e,[r,c]=z.useState(null);return o.jsx(mge,{scope:t,anchor:r,onAnchorChange:c,children:n})};rZ.displayName=S3;var iZ="PopperAnchor",sZ=z.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...c}=e,f=nZ(iZ,n),p=z.useRef(null),s=fa(t,p),w=z.useRef(null);return z.useEffect(()=>{const T=w.current;w.current=r?.current||p.current,T!==w.current&&f.onAnchorChange(w.current)}),r?null:o.jsx(Si.div,{...c,ref:s})});sZ.displayName=iZ;var T3="PopperContent",[gge,yge]=tZ(T3),aZ=z.forwardRef((e,t)=>{const{__scopePopper:n,side:r="bottom",sideOffset:c=0,align:f="center",alignOffset:p=0,arrowPadding:s=0,avoidCollisions:w=!0,collisionBoundary:T=[],collisionPadding:E=0,sticky:N="partial",hideWhenDetached:D=!1,updatePositionStrategy:V="optimized",onPlaced:$,...B}=e,F=nZ(T3,n),[K,Y]=z.useState(null),X=fa(t,Mt=>Y(Mt)),[ae,Z]=z.useState(null),se=pge(ae),he=se?.width??0,ye=se?.height??0,Ce=r+(f!=="center"?"-"+f:""),Ve=typeof E=="number"?E:{top:0,right:0,bottom:0,left:0,...E},Re=Array.isArray(T)?T:[T],$e=Re.length>0,nt={padding:Ve,boundary:Re.filter(xge),altBoundary:$e},{refs:Me,floatingStyles:rt,placement:Ee,isPositioned:it,middlewareData:et}=rge({strategy:"fixed",placement:Ce,whileElementsMounted:(...Mt)=>Wme(...Mt,{animationFrame:V==="always"}),elements:{reference:F.anchor},middleware:[sge({mainAxis:c+ye,alignmentAxis:p}),w&&age({mainAxis:!0,crossAxis:!1,limiter:N==="partial"?oge():void 0,...nt}),w&&lge({...nt}),cge({...nt,apply:({elements:Mt,rects:an,availableWidth:Jt,availableHeight:Cn})=>{const{width:nr,height:sn}=an.reference,zr=Mt.floating.style;zr.setProperty("--radix-popper-available-width",`${Jt}px`),zr.setProperty("--radix-popper-available-height",`${Cn}px`),zr.setProperty("--radix-popper-anchor-width",`${nr}px`),zr.setProperty("--radix-popper-anchor-height",`${sn}px`)}}),ae&&dge({element:ae,padding:s}),_ge({arrowWidth:he,arrowHeight:ye}),D&&uge({strategy:"referenceHidden",...nt})]}),[mt,He]=cZ(Ee),pt=Ff($);Ol(()=>{it&&pt?.()},[it,pt]);const We=et.arrow?.x,Je=et.arrow?.y,jt=et.arrow?.centerOffset!==0,[Pt,Ot]=z.useState();return Ol(()=>{K&&Ot(window.getComputedStyle(K).zIndex)},[K]),o.jsx("div",{ref:Me.setFloating,"data-radix-popper-content-wrapper":"",style:{...rt,transform:it?rt.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Pt,"--radix-popper-transform-origin":[et.transformOrigin?.x,et.transformOrigin?.y].join(" "),...et.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:o.jsx(gge,{scope:n,placedSide:mt,onArrowChange:Z,arrowX:We,arrowY:Je,shouldHideArrow:jt,children:o.jsx(Si.div,{"data-side":mt,"data-align":He,...B,ref:X,style:{...B.style,animation:it?void 0:"none"}})})})});aZ.displayName=T3;var oZ="PopperArrow",vge={top:"bottom",right:"left",bottom:"top",left:"right"},lZ=z.forwardRef(function(t,n){const{__scopePopper:r,...c}=t,f=yge(oZ,r),p=vge[f.placedSide];return o.jsx("span",{ref:f.onArrowChange,style:{position:"absolute",left:f.arrowX,top:f.arrowY,[p]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[f.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[f.placedSide],visibility:f.shouldHideArrow?"hidden":void 0},children:o.jsx(fge,{...c,ref:n,style:{...c.style,display:"block"}})})});lZ.displayName=oZ;function xge(e){return e!==null}var _ge=e=>({name:"transformOrigin",options:e,fn(t){const{placement:n,rects:r,middlewareData:c}=t,p=c.arrow?.centerOffset!==0,s=p?0:e.arrowWidth,w=p?0:e.arrowHeight,[T,E]=cZ(n),N={start:"0%",center:"50%",end:"100%"}[E],D=(c.arrow?.x??0)+s/2,V=(c.arrow?.y??0)+w/2;let $="",B="";return T==="bottom"?($=p?N:`${D}px`,B=`${-w}px`):T==="top"?($=p?N:`${D}px`,B=`${r.floating.height+w}px`):T==="right"?($=`${-w}px`,B=p?N:`${V}px`):T==="left"&&($=`${r.floating.width+w}px`,B=p?N:`${V}px`),{data:{x:$,y:B}}}});function cZ(e){const[t,n="center"]=e.split("-");return[t,n]}var KE=rZ,lT=sZ,JE=aZ,QE=lZ,uZ=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),bge="VisuallyHidden",dZ=z.forwardRef((e,t)=>o.jsx(Si.span,{...e,ref:t,style:{...uZ,...e.style}}));dZ.displayName=bge;var wge=dZ,[eC,h$e]=Eu("Tooltip",[uv]),tC=uv(),hZ="TooltipProvider",Sge=700,Lk="tooltip.open",[Tge,A3]=eC(hZ),fZ=e=>{const{__scopeTooltip:t,delayDuration:n=Sge,skipDelayDuration:r=300,disableHoverableContent:c=!1,children:f}=e,p=z.useRef(!0),s=z.useRef(!1),w=z.useRef(0);return z.useEffect(()=>{const T=w.current;return()=>window.clearTimeout(T)},[]),o.jsx(Tge,{scope:t,isOpenDelayedRef:p,delayDuration:n,onOpen:z.useCallback(()=>{window.clearTimeout(w.current),p.current=!1},[]),onClose:z.useCallback(()=>{window.clearTimeout(w.current),w.current=window.setTimeout(()=>p.current=!0,r)},[r]),isPointerInTransitRef:s,onPointerInTransitChange:z.useCallback(T=>{s.current=T},[]),disableHoverableContent:c,children:f})};fZ.displayName=hZ;var eS="Tooltip",[Age,cT]=eC(eS),pZ=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:c,onOpenChange:f,disableHoverableContent:p,delayDuration:s}=e,w=A3(eS,e.__scopeTooltip),T=tC(t),[E,N]=z.useState(null),D=Ml(),V=z.useRef(0),$=p??w.disableHoverableContent,B=s??w.delayDuration,F=z.useRef(!1),[K,Y]=zf({prop:r,defaultProp:c??!1,onChange:he=>{he?(w.onOpen(),document.dispatchEvent(new CustomEvent(Lk))):w.onClose(),f?.(he)},caller:eS}),X=z.useMemo(()=>K?F.current?"delayed-open":"instant-open":"closed",[K]),ae=z.useCallback(()=>{window.clearTimeout(V.current),V.current=0,F.current=!1,Y(!0)},[Y]),Z=z.useCallback(()=>{window.clearTimeout(V.current),V.current=0,Y(!1)},[Y]),se=z.useCallback(()=>{window.clearTimeout(V.current),V.current=window.setTimeout(()=>{F.current=!0,Y(!0),V.current=0},B)},[B,Y]);return z.useEffect(()=>()=>{V.current&&(window.clearTimeout(V.current),V.current=0)},[]),o.jsx(KE,{...T,children:o.jsx(Age,{scope:t,contentId:D,open:K,stateAttribute:X,trigger:E,onTriggerChange:N,onTriggerEnter:z.useCallback(()=>{w.isOpenDelayedRef.current?se():ae()},[w.isOpenDelayedRef,se,ae]),onTriggerLeave:z.useCallback(()=>{$?Z():(window.clearTimeout(V.current),V.current=0)},[Z,$]),onOpen:ae,onClose:Z,disableHoverableContent:$,children:n})})};pZ.displayName=eS;var zk="TooltipTrigger",mZ=z.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,c=cT(zk,n),f=A3(zk,n),p=tC(n),s=z.useRef(null),w=fa(t,s,c.onTriggerChange),T=z.useRef(!1),E=z.useRef(!1),N=z.useCallback(()=>T.current=!1,[]);return z.useEffect(()=>()=>document.removeEventListener("pointerup",N),[N]),o.jsx(lT,{asChild:!0,...p,children:o.jsx(Si.button,{"aria-describedby":c.open?c.contentId:void 0,"data-state":c.stateAttribute,...r,ref:w,onPointerMove:Yr(e.onPointerMove,D=>{D.pointerType!=="touch"&&!E.current&&!f.isPointerInTransitRef.current&&(c.onTriggerEnter(),E.current=!0)}),onPointerLeave:Yr(e.onPointerLeave,()=>{c.onTriggerLeave(),E.current=!1}),onPointerDown:Yr(e.onPointerDown,()=>{c.open&&c.onClose(),T.current=!0,document.addEventListener("pointerup",N,{once:!0})}),onFocus:Yr(e.onFocus,()=>{T.current||c.onOpen()}),onBlur:Yr(e.onBlur,c.onClose),onClick:Yr(e.onClick,c.onClose)})})});mZ.displayName=zk;var j3="TooltipPortal",[jge,Ege]=eC(j3,{forceMount:void 0}),gZ=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:c}=e,f=cT(j3,t);return o.jsx(jge,{scope:t,forceMount:n,children:o.jsx(nd,{present:n||f.open,children:o.jsx(kb,{asChild:!0,container:c,children:r})})})};gZ.displayName=j3;var Y0="TooltipContent",yZ=z.forwardRef((e,t)=>{const n=Ege(Y0,e.__scopeTooltip),{forceMount:r=n.forceMount,side:c="top",...f}=e,p=cT(Y0,e.__scopeTooltip);return o.jsx(nd,{present:r||p.open,children:p.disableHoverableContent?o.jsx(vZ,{side:c,...f,ref:t}):o.jsx(Cge,{side:c,...f,ref:t})})}),Cge=z.forwardRef((e,t)=>{const n=cT(Y0,e.__scopeTooltip),r=A3(Y0,e.__scopeTooltip),c=z.useRef(null),f=fa(t,c),[p,s]=z.useState(null),{trigger:w,onClose:T}=n,E=c.current,{onPointerInTransitChange:N}=r,D=z.useCallback(()=>{s(null),N(!1)},[N]),V=z.useCallback(($,B)=>{const F=$.currentTarget,K={x:$.clientX,y:$.clientY},Y=Rge(K,F.getBoundingClientRect()),X=Oge(K,Y),ae=Dge(B.getBoundingClientRect()),Z=Ige([...X,...ae]);s(Z),N(!0)},[N]);return z.useEffect(()=>()=>D(),[D]),z.useEffect(()=>{if(w&&E){const $=F=>V(F,E),B=F=>V(F,w);return w.addEventListener("pointerleave",$),E.addEventListener("pointerleave",B),()=>{w.removeEventListener("pointerleave",$),E.removeEventListener("pointerleave",B)}}},[w,E,V,D]),z.useEffect(()=>{if(p){const $=B=>{const F=B.target,K={x:B.clientX,y:B.clientY},Y=w?.contains(F)||E?.contains(F),X=!kge(K,p);Y?D():X&&(D(),T())};return document.addEventListener("pointermove",$),()=>document.removeEventListener("pointermove",$)}},[w,E,p,T,D]),o.jsx(vZ,{...e,ref:f})}),[Nge,Pge]=eC(eS,{isInside:!1}),Mge=ZW("TooltipContent"),vZ=z.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":c,onEscapeKeyDown:f,onPointerDownOutside:p,...s}=e,w=cT(Y0,n),T=tC(n),{onClose:E}=w;return z.useEffect(()=>(document.addEventListener(Lk,E),()=>document.removeEventListener(Lk,E)),[E]),z.useEffect(()=>{if(w.trigger){const N=D=>{D.target?.contains(w.trigger)&&E()};return window.addEventListener("scroll",N,{capture:!0}),()=>window.removeEventListener("scroll",N,{capture:!0})}},[w.trigger,E]),o.jsx(Db,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:f,onPointerDownOutside:p,onFocusOutside:N=>N.preventDefault(),onDismiss:E,children:o.jsxs(JE,{"data-state":w.stateAttribute,...T,...s,ref:t,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[o.jsx(Mge,{children:r}),o.jsx(Nge,{scope:n,isInside:!0,children:o.jsx(wge,{id:w.contentId,role:"tooltip",children:c||r})})]})})});yZ.displayName=Y0;var xZ="TooltipArrow",_Z=z.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,c=tC(n);return Pge(xZ,n).isInside?null:o.jsx(QE,{...c,...r,ref:t})});_Z.displayName=xZ;function Rge(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),c=Math.abs(t.right-e.x),f=Math.abs(t.left-e.x);switch(Math.min(n,r,c,f)){case f:return"left";case c:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function Oge(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function Dge(e){const{top:t,right:n,bottom:r,left:c}=e;return[{x:c,y:t},{x:n,y:t},{x:n,y:r},{x:c,y:r}]}function kge(e,t){const{x:n,y:r}=e;let c=!1;for(let f=0,p=t.length-1;f<t.length;p=f++){const s=t[f],w=t[p],T=s.x,E=s.y,N=w.x,D=w.y;E>r!=D>r&&n<(N-T)*(r-E)/(D-E)+T&&(c=!c)}return c}function Ige(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),Lge(t)}function Lge(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const c=e[r];for(;t.length>=2;){const f=t[t.length-1],p=t[t.length-2];if((f.x-p.x)*(c.y-p.y)>=(f.y-p.y)*(c.x-p.x))t.pop();else break}t.push(c)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const c=e[r];for(;n.length>=2;){const f=n[n.length-1],p=n[n.length-2];if((f.x-p.x)*(c.y-p.y)>=(f.y-p.y)*(c.x-p.x))n.pop();else break}n.push(c)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var zge=fZ,Fge=pZ,Bge=mZ,Uge=gZ,Vge=yZ,$ge=_Z;function bZ({delayDuration:e=0,...t}){return o.jsx(zge,{"data-slot":"tooltip-provider",delayDuration:e,...t})}function qge({...e}){return o.jsx(bZ,{children:o.jsx(Fge,{"data-slot":"tooltip",...e})})}function Hge({...e}){return o.jsx(Bge,{"data-slot":"tooltip-trigger",...e})}function Gge({className:e,sideOffset:t=0,children:n,...r}){return o.jsx(Uge,{children:o.jsxs(Vge,{"data-slot":"tooltip-content",sideOffset:t,className:Rn("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...r,children:[n,o.jsx($ge,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}const Wge="sidebar_state",Xge=3600*24*7,Zge="16rem",Yge="18rem",Kge="3rem",Jge="b",wZ=z.createContext(null);function uT(){const e=z.useContext(wZ);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}function YA({defaultOpen:e=!0,open:t,onOpenChange:n,className:r,style:c,children:f,...p}){const s=Qhe(),[w,T]=z.useState(!1),[E,N]=z.useState(e),D=t??E,V=z.useCallback(K=>{const Y=typeof K=="function"?K(D):K;n?n(Y):N(Y),document.cookie=`${Wge}=${Y}; path=/; max-age=${Xge}`},[n,D]),$=z.useCallback(()=>s?T(K=>!K):V(K=>!K),[s,V,T]);z.useEffect(()=>{const K=Y=>{Y.key===Jge&&(Y.metaKey||Y.ctrlKey)&&(Y.preventDefault(),$())};return window.addEventListener("keydown",K),()=>window.removeEventListener("keydown",K)},[$]);const B=D?"expanded":"collapsed",F=z.useMemo(()=>({state:B,open:D,setOpen:V,isMobile:s,openMobile:w,setOpenMobile:T,toggleSidebar:$}),[B,D,V,s,w,T,$]);return o.jsx(wZ.Provider,{value:F,children:o.jsx(bZ,{delayDuration:0,children:o.jsx("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":Zge,"--sidebar-width-icon":Kge,...c},className:Rn("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",r),...p,children:f})})})}function Qge({side:e="left",variant:t="sidebar",collapsible:n="offcanvas",className:r,children:c,...f}){const{isMobile:p,state:s,openMobile:w,setOpenMobile:T}=uT();return n==="none"?o.jsx("div",{"data-slot":"sidebar",className:Rn("bg-sidebar text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col",r),...f,children:c}):p?o.jsx(Zpe,{open:w,onOpenChange:T,...f,children:o.jsxs(Jpe,{"data-sidebar":"sidebar","data-slot":"sidebar","data-mobile":"true",className:"bg-sidebar text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden",style:{"--sidebar-width":Yge},side:e,children:[o.jsxs(Qpe,{className:"sr-only",children:[o.jsx(eme,{children:"Sidebar"}),o.jsx(tme,{children:"Displays the mobile sidebar."})]}),o.jsx("div",{className:"flex h-full w-full flex-col",children:c})]})}):o.jsxs("div",{className:"group peer text-sidebar-foreground hidden md:block","data-state":s,"data-collapsible":s==="collapsed"?n:"","data-variant":t,"data-side":e,"data-slot":"sidebar",children:[o.jsx("div",{"data-slot":"sidebar-gap",className:Rn("relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon)")}),o.jsx("div",{"data-slot":"sidebar-container",className:Rn("fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-0)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r-0 group-data-[side=right]:border-l",r),...f,children:o.jsx("div",{"data-sidebar":"sidebar","data-slot":"sidebar-inner",className:"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm",children:c})})]})}function KA({className:e,onClick:t,...n}){const{toggleSidebar:r}=uT();return o.jsxs(kt,{"data-sidebar":"trigger","data-slot":"sidebar-trigger",variant:"ghost",size:"icon",className:Rn("size-7",e),onClick:c=>{t?.(c),r()},...n,children:[o.jsx(Jde,{}),o.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function eye({className:e,...t}){const{toggleSidebar:n}=uT();return o.jsx("button",{"data-sidebar":"rail","data-slot":"sidebar-rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:n,title:"Toggle Sidebar",className:Rn("hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex","in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})}function JA({className:e,...t}){return o.jsx("main",{"data-slot":"sidebar-inset",className:Rn("bg-background relative flex w-full flex-1 flex-col","md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2",e),...t})}function tye({className:e,...t}){return o.jsx("div",{"data-slot":"sidebar-header","data-sidebar":"header",className:Rn("flex flex-col gap-2 p-2",e),...t})}function nye({className:e,...t}){return o.jsx("div",{"data-slot":"sidebar-footer","data-sidebar":"footer",className:Rn("flex flex-col gap-2 p-2",e),...t})}function rye({className:e,...t}){return o.jsx("div",{"data-slot":"sidebar-content","data-sidebar":"content",className:Rn("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t})}function iye({className:e,...t}){return o.jsx("div",{"data-slot":"sidebar-group","data-sidebar":"group",className:Rn("relative flex w-full min-w-0 flex-col p-2",e),...t})}function sye({className:e,asChild:t=!1,...n}){const r=t?rT:"div";return o.jsx(r,{"data-slot":"sidebar-group-label","data-sidebar":"group-label",className:Rn("text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:hidden",e),...n})}function aye({className:e,...t}){return o.jsx("div",{"data-slot":"sidebar-group-content","data-sidebar":"group-content",className:Rn("w-full text-sm",e),...t})}function QA({className:e,...t}){return o.jsx("ul",{"data-slot":"sidebar-menu","data-sidebar":"menu",className:Rn("flex w-full min-w-0 flex-col gap-1",e),...t})}function ej({className:e,...t}){return o.jsx("li",{"data-slot":"sidebar-menu-item","data-sidebar":"menu-item",className:Rn("group/menu-item relative",e),...t})}const oye=c3("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"bg-opacity-0 hover:bg-opacity-100 hover:bg-sidebar-accent transition duration-100 hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function Fk({asChild:e=!1,isActive:t=!1,variant:n="default",size:r="default",tooltip:c,className:f,...p}){const s=e?rT:"button",{isMobile:w,state:T}=uT(),E=o.jsx(s,{"data-slot":"sidebar-menu-button","data-sidebar":"menu-button","data-size":r,"data-active":t,className:Rn(oye({variant:n,size:r}),f),...p});return c?(typeof c=="string"&&(c={children:c}),o.jsxs(qge,{children:[o.jsx(Hge,{asChild:!0,children:E}),o.jsx(Gge,{side:"right",align:"center",hidden:T!=="collapsed"||w,...c})]})):E}function MP({data:e}){const t=location.pathname;return o.jsx(iye,{children:o.jsx(aye,{className:"flex flex-col gap-2",children:e.map((n,r)=>n.NavGroup?o.jsxs("div",{children:[o.jsx(sye,{children:n.NavGroup.NavLabel}),o.jsx(QA,{children:n.NavGroup.NavItems.map((c,f)=>o.jsx(ej,{children:o.jsx(Fk,{className:"data-[active=true]:bg-[var(--vivid-indigo)]",asChild:!0,isActive:c.url==t,children:o.jsxs(Yl,{to:c.url,children:[o.jsx(c.icon,{}),c.title]})})},f))})]},r):n.title?o.jsx(QA,{children:o.jsx(ej,{children:o.jsx(Fk,{asChild:!0,isActive:item.url==t,children:o.jsxs(Yl,{to:n.url,children:[o.jsx(n.icon,{}),n.title]})})})}):null)})})}var RP={exports:{}},OP={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q6;function lye(){if(q6)return OP;q6=1;var e=EE();function t(N,D){return N===D&&(N!==0||1/N===1/D)||N!==N&&D!==D}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,c=e.useEffect,f=e.useLayoutEffect,p=e.useDebugValue;function s(N,D){var V=D(),$=r({inst:{value:V,getSnapshot:D}}),B=$[0].inst,F=$[1];return f(function(){B.value=V,B.getSnapshot=D,w(B)&&F({inst:B})},[N,V,D]),c(function(){return w(B)&&F({inst:B}),N(function(){w(B)&&F({inst:B})})},[N]),p(V),V}function w(N){var D=N.getSnapshot;N=N.value;try{var V=D();return!n(N,V)}catch{return!0}}function T(N,D){return D()}var E=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?T:s;return OP.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:E,OP}var H6;function cye(){return H6||(H6=1,RP.exports=lye()),RP.exports}var uye=cye();function dye(){return uye.useSyncExternalStore(hye,()=>!0,()=>!1)}function hye(){return()=>{}}var E3="Avatar",[fye,f$e]=Eu(E3),[pye,SZ]=fye(E3),TZ=z.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[c,f]=z.useState("idle");return o.jsx(pye,{scope:n,imageLoadingStatus:c,onImageLoadingStatusChange:f,children:o.jsx(Si.span,{...r,ref:t})})});TZ.displayName=E3;var AZ="AvatarImage",jZ=z.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:c=()=>{},...f}=e,p=SZ(AZ,n),s=mye(r,f),w=Ff(T=>{c(T),p.onImageLoadingStatusChange(T)});return Ol(()=>{s!=="idle"&&w(s)},[s,w]),s==="loaded"?o.jsx(Si.img,{...f,ref:t,src:r}):null});jZ.displayName=AZ;var EZ="AvatarFallback",CZ=z.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...c}=e,f=SZ(EZ,n),[p,s]=z.useState(r===void 0);return z.useEffect(()=>{if(r!==void 0){const w=window.setTimeout(()=>s(!0),r);return()=>window.clearTimeout(w)}},[r]),p&&f.imageLoadingStatus!=="loaded"?o.jsx(Si.span,{...c,ref:t}):null});CZ.displayName=EZ;function G6(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function mye(e,{referrerPolicy:t,crossOrigin:n}){const r=dye(),c=z.useRef(null),f=r?(c.current||(c.current=new window.Image),c.current):null,[p,s]=z.useState(()=>G6(f,e));return Ol(()=>{s(G6(f,e))},[f,e]),Ol(()=>{const w=N=>()=>{s(N)};if(!f)return;const T=w("loaded"),E=w("error");return f.addEventListener("load",T),f.addEventListener("error",E),t&&(f.referrerPolicy=t),typeof n=="string"&&(f.crossOrigin=n),()=>{f.removeEventListener("load",T),f.removeEventListener("error",E)}},[f,n,t]),p}var gye=TZ,yye=jZ,vye=CZ;function tj({className:e,...t}){return o.jsx(gye,{"data-slot":"avatar",className:Rn("relative flex size-8 shrink-0 overflow-hidden rounded-full",e),...t})}function nj({className:e,...t}){return o.jsx(yye,{"data-slot":"avatar-image",className:Rn("aspect-square size-full",e),...t})}function rj({className:e,...t}){return o.jsx(vye,{"data-slot":"avatar-fallback",className:Rn("bg-sidebar-primary flex size-full items-center justify-center rounded-full text-sidebar-primary-foreground",e),...t})}function nC(e){const t=e+"CollectionProvider",[n,r]=Eu(t),[c,f]=n(t,{collectionRef:{current:null},itemMap:new Map}),p=B=>{const{scope:F,children:K}=B,Y=_e.useRef(null),X=_e.useRef(new Map).current;return o.jsx(c,{scope:F,itemMap:X,collectionRef:Y,children:K})};p.displayName=t;const s=e+"CollectionSlot",w=nv(s),T=_e.forwardRef((B,F)=>{const{scope:K,children:Y}=B,X=f(s,K),ae=fa(F,X.collectionRef);return o.jsx(w,{ref:ae,children:Y})});T.displayName=s;const E=e+"CollectionItemSlot",N="data-radix-collection-item",D=nv(E),V=_e.forwardRef((B,F)=>{const{scope:K,children:Y,...X}=B,ae=_e.useRef(null),Z=fa(F,ae),se=f(E,K);return _e.useEffect(()=>(se.itemMap.set(ae,{ref:ae,...X}),()=>void se.itemMap.delete(ae))),o.jsx(D,{[N]:"",ref:Z,children:Y})});V.displayName=E;function $(B){const F=f(e+"CollectionConsumer",B);return _e.useCallback(()=>{const Y=F.collectionRef.current;if(!Y)return[];const X=Array.from(Y.querySelectorAll(`[${N}]`));return Array.from(F.itemMap.values()).sort((se,he)=>X.indexOf(se.ref.current)-X.indexOf(he.ref.current))},[F.collectionRef,F.itemMap])}return[{Provider:p,Slot:T,ItemSlot:V},$,r]}var xye=z.createContext(void 0);function dT(e){const t=z.useContext(xye);return e||t||"ltr"}var DP="rovingFocusGroup.onEntryFocus",_ye={bubbles:!1,cancelable:!0},hT="RovingFocusGroup",[Bk,NZ,bye]=nC(hT),[wye,rC]=Eu(hT,[bye]),[Sye,Tye]=wye(hT),PZ=z.forwardRef((e,t)=>o.jsx(Bk.Provider,{scope:e.__scopeRovingFocusGroup,children:o.jsx(Bk.Slot,{scope:e.__scopeRovingFocusGroup,children:o.jsx(Aye,{...e,ref:t})})}));PZ.displayName=hT;var Aye=z.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:c=!1,dir:f,currentTabStopId:p,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:w,onEntryFocus:T,preventScrollOnEntryFocus:E=!1,...N}=e,D=z.useRef(null),V=fa(t,D),$=dT(f),[B,F]=zf({prop:p,defaultProp:s??null,onChange:w,caller:hT}),[K,Y]=z.useState(!1),X=Ff(T),ae=NZ(n),Z=z.useRef(!1),[se,he]=z.useState(0);return z.useEffect(()=>{const ye=D.current;if(ye)return ye.addEventListener(DP,X),()=>ye.removeEventListener(DP,X)},[X]),o.jsx(Sye,{scope:n,orientation:r,dir:$,loop:c,currentTabStopId:B,onItemFocus:z.useCallback(ye=>F(ye),[F]),onItemShiftTab:z.useCallback(()=>Y(!0),[]),onFocusableItemAdd:z.useCallback(()=>he(ye=>ye+1),[]),onFocusableItemRemove:z.useCallback(()=>he(ye=>ye-1),[]),children:o.jsx(Si.div,{tabIndex:K||se===0?-1:0,"data-orientation":r,...N,ref:V,style:{outline:"none",...e.style},onMouseDown:Yr(e.onMouseDown,()=>{Z.current=!0}),onFocus:Yr(e.onFocus,ye=>{const Ce=!Z.current;if(ye.target===ye.currentTarget&&Ce&&!K){const Ve=new CustomEvent(DP,_ye);if(ye.currentTarget.dispatchEvent(Ve),!Ve.defaultPrevented){const Re=ae().filter(Ee=>Ee.focusable),$e=Re.find(Ee=>Ee.active),nt=Re.find(Ee=>Ee.id===B),rt=[$e,nt,...Re].filter(Boolean).map(Ee=>Ee.ref.current);OZ(rt,E)}}Z.current=!1}),onBlur:Yr(e.onBlur,()=>Y(!1))})})}),MZ="RovingFocusGroupItem",RZ=z.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:c=!1,tabStopId:f,children:p,...s}=e,w=Ml(),T=f||w,E=Tye(MZ,n),N=E.currentTabStopId===T,D=NZ(n),{onFocusableItemAdd:V,onFocusableItemRemove:$,currentTabStopId:B}=E;return z.useEffect(()=>{if(r)return V(),()=>$()},[r,V,$]),o.jsx(Bk.ItemSlot,{scope:n,id:T,focusable:r,active:c,children:o.jsx(Si.span,{tabIndex:N?0:-1,"data-orientation":E.orientation,...s,ref:t,onMouseDown:Yr(e.onMouseDown,F=>{r?E.onItemFocus(T):F.preventDefault()}),onFocus:Yr(e.onFocus,()=>E.onItemFocus(T)),onKeyDown:Yr(e.onKeyDown,F=>{if(F.key==="Tab"&&F.shiftKey){E.onItemShiftTab();return}if(F.target!==F.currentTarget)return;const K=Cye(F,E.orientation,E.dir);if(K!==void 0){if(F.metaKey||F.ctrlKey||F.altKey||F.shiftKey)return;F.preventDefault();let X=D().filter(ae=>ae.focusable).map(ae=>ae.ref.current);if(K==="last")X.reverse();else if(K==="prev"||K==="next"){K==="prev"&&X.reverse();const ae=X.indexOf(F.currentTarget);X=E.loop?Nye(X,ae+1):X.slice(ae+1)}setTimeout(()=>OZ(X))}}),children:typeof p=="function"?p({isCurrentTabStop:N,hasTabStop:B!=null}):p})})});RZ.displayName=MZ;var jye={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Eye(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Cye(e,t,n){const r=Eye(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return jye[r]}function OZ(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function Nye(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var DZ=PZ,kZ=RZ,Uk=["Enter"," "],Pye=["ArrowDown","PageUp","Home"],IZ=["ArrowUp","PageDown","End"],Mye=[...Pye,...IZ],Rye={ltr:[...Uk,"ArrowRight"],rtl:[...Uk,"ArrowLeft"]},Oye={ltr:["ArrowLeft"],rtl:["ArrowRight"]},fT="Menu",[tS,Dye,kye]=nC(fT),[h_,LZ]=Eu(fT,[kye,uv,rC]),iC=uv(),zZ=rC(),[Iye,f_]=h_(fT),[Lye,pT]=h_(fT),FZ=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:c,onOpenChange:f,modal:p=!0}=e,s=iC(t),[w,T]=z.useState(null),E=z.useRef(!1),N=Ff(f),D=dT(c);return z.useEffect(()=>{const V=()=>{E.current=!0,document.addEventListener("pointerdown",$,{capture:!0,once:!0}),document.addEventListener("pointermove",$,{capture:!0,once:!0})},$=()=>E.current=!1;return document.addEventListener("keydown",V,{capture:!0}),()=>{document.removeEventListener("keydown",V,{capture:!0}),document.removeEventListener("pointerdown",$,{capture:!0}),document.removeEventListener("pointermove",$,{capture:!0})}},[]),o.jsx(KE,{...s,children:o.jsx(Iye,{scope:t,open:n,onOpenChange:N,content:w,onContentChange:T,children:o.jsx(Lye,{scope:t,onClose:z.useCallback(()=>N(!1),[N]),isUsingKeyboardRef:E,dir:D,modal:p,children:r})})})};FZ.displayName=fT;var zye="MenuAnchor",C3=z.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,c=iC(n);return o.jsx(lT,{...c,...r,ref:t})});C3.displayName=zye;var N3="MenuPortal",[Fye,BZ]=h_(N3,{forceMount:void 0}),UZ=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:c}=e,f=f_(N3,t);return o.jsx(Fye,{scope:t,forceMount:n,children:o.jsx(nd,{present:n||f.open,children:o.jsx(kb,{asChild:!0,container:c,children:r})})})};UZ.displayName=N3;var Fh="MenuContent",[Bye,P3]=h_(Fh),VZ=z.forwardRef((e,t)=>{const n=BZ(Fh,e.__scopeMenu),{forceMount:r=n.forceMount,...c}=e,f=f_(Fh,e.__scopeMenu),p=pT(Fh,e.__scopeMenu);return o.jsx(tS.Provider,{scope:e.__scopeMenu,children:o.jsx(nd,{present:r||f.open,children:o.jsx(tS.Slot,{scope:e.__scopeMenu,children:p.modal?o.jsx(Uye,{...c,ref:t}):o.jsx(Vye,{...c,ref:t})})})})}),Uye=z.forwardRef((e,t)=>{const n=f_(Fh,e.__scopeMenu),r=z.useRef(null),c=fa(t,r);return z.useEffect(()=>{const f=r.current;if(f)return VE(f)},[]),o.jsx(M3,{...e,ref:c,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Yr(e.onFocusOutside,f=>f.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Vye=z.forwardRef((e,t)=>{const n=f_(Fh,e.__scopeMenu);return o.jsx(M3,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),$ye=nv("MenuContent.ScrollLock"),M3=z.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:c,onOpenAutoFocus:f,onCloseAutoFocus:p,disableOutsidePointerEvents:s,onEntryFocus:w,onEscapeKeyDown:T,onPointerDownOutside:E,onFocusOutside:N,onInteractOutside:D,onDismiss:V,disableOutsideScroll:$,...B}=e,F=f_(Fh,n),K=pT(Fh,n),Y=iC(n),X=zZ(n),ae=Dye(n),[Z,se]=z.useState(null),he=z.useRef(null),ye=fa(t,he,F.onContentChange),Ce=z.useRef(0),Ve=z.useRef(""),Re=z.useRef(0),$e=z.useRef(null),nt=z.useRef("right"),Me=z.useRef(0),rt=$?sT:z.Fragment,Ee=$?{as:$ye,allowPinchZoom:!0}:void 0,it=mt=>{const He=Ve.current+mt,pt=ae().filter(Mt=>!Mt.disabled),We=document.activeElement,Je=pt.find(Mt=>Mt.ref.current===We)?.textValue,jt=pt.map(Mt=>Mt.textValue),Pt=tve(jt,He,Je),Ot=pt.find(Mt=>Mt.textValue===Pt)?.ref.current;(function Mt(an){Ve.current=an,window.clearTimeout(Ce.current),an!==""&&(Ce.current=window.setTimeout(()=>Mt(""),1e3))})(He),Ot&&setTimeout(()=>Ot.focus())};z.useEffect(()=>()=>window.clearTimeout(Ce.current),[]),BE();const et=z.useCallback(mt=>nt.current===$e.current?.side&&rve(mt,$e.current?.area),[]);return o.jsx(Bye,{scope:n,searchRef:Ve,onItemEnter:z.useCallback(mt=>{et(mt)&&mt.preventDefault()},[et]),onItemLeave:z.useCallback(mt=>{et(mt)||(he.current?.focus(),se(null))},[et]),onTriggerLeave:z.useCallback(mt=>{et(mt)&&mt.preventDefault()},[et]),pointerGraceTimerRef:Re,onPointerGraceIntentChange:z.useCallback(mt=>{$e.current=mt},[]),children:o.jsx(rt,{...Ee,children:o.jsx(iT,{asChild:!0,trapped:c,onMountAutoFocus:Yr(f,mt=>{mt.preventDefault(),he.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:p,children:o.jsx(Db,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:T,onPointerDownOutside:E,onFocusOutside:N,onInteractOutside:D,onDismiss:V,children:o.jsx(DZ,{asChild:!0,...X,dir:K.dir,orientation:"vertical",loop:r,currentTabStopId:Z,onCurrentTabStopIdChange:se,onEntryFocus:Yr(w,mt=>{K.isUsingKeyboardRef.current||mt.preventDefault()}),preventScrollOnEntryFocus:!0,children:o.jsx(JE,{role:"menu","aria-orientation":"vertical","data-state":iY(F.open),"data-radix-menu-content":"",dir:K.dir,...Y,...B,ref:ye,style:{outline:"none",...B.style},onKeyDown:Yr(B.onKeyDown,mt=>{const pt=mt.target.closest("[data-radix-menu-content]")===mt.currentTarget,We=mt.ctrlKey||mt.altKey||mt.metaKey,Je=mt.key.length===1;pt&&(mt.key==="Tab"&&mt.preventDefault(),!We&&Je&&it(mt.key));const jt=he.current;if(mt.target!==jt||!Mye.includes(mt.key))return;mt.preventDefault();const Ot=ae().filter(Mt=>!Mt.disabled).map(Mt=>Mt.ref.current);IZ.includes(mt.key)&&Ot.reverse(),Qye(Ot)}),onBlur:Yr(e.onBlur,mt=>{mt.currentTarget.contains(mt.target)||(window.clearTimeout(Ce.current),Ve.current="")}),onPointerMove:Yr(e.onPointerMove,nS(mt=>{const He=mt.target,pt=Me.current!==mt.clientX;if(mt.currentTarget.contains(He)&&pt){const We=mt.clientX>Me.current?"right":"left";nt.current=We,Me.current=mt.clientX}}))})})})})})})});VZ.displayName=Fh;var qye="MenuGroup",R3=z.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return o.jsx(Si.div,{role:"group",...r,ref:t})});R3.displayName=qye;var Hye="MenuLabel",$Z=z.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return o.jsx(Si.div,{...r,ref:t})});$Z.displayName=Hye;var ij="MenuItem",W6="menu.itemSelect",sC=z.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...c}=e,f=z.useRef(null),p=pT(ij,e.__scopeMenu),s=P3(ij,e.__scopeMenu),w=fa(t,f),T=z.useRef(!1),E=()=>{const N=f.current;if(!n&&N){const D=new CustomEvent(W6,{bubbles:!0,cancelable:!0});N.addEventListener(W6,V=>r?.(V),{once:!0}),YW(N,D),D.defaultPrevented?T.current=!1:p.onClose()}};return o.jsx(qZ,{...c,ref:w,disabled:n,onClick:Yr(e.onClick,E),onPointerDown:N=>{e.onPointerDown?.(N),T.current=!0},onPointerUp:Yr(e.onPointerUp,N=>{T.current||N.currentTarget?.click()}),onKeyDown:Yr(e.onKeyDown,N=>{const D=s.searchRef.current!=="";n||D&&N.key===" "||Uk.includes(N.key)&&(N.currentTarget.click(),N.preventDefault())})})});sC.displayName=ij;var qZ=z.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:c,...f}=e,p=P3(ij,n),s=zZ(n),w=z.useRef(null),T=fa(t,w),[E,N]=z.useState(!1),[D,V]=z.useState("");return z.useEffect(()=>{const $=w.current;$&&V(($.textContent??"").trim())},[f.children]),o.jsx(tS.ItemSlot,{scope:n,disabled:r,textValue:c??D,children:o.jsx(kZ,{asChild:!0,...s,focusable:!r,children:o.jsx(Si.div,{role:"menuitem","data-highlighted":E?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...f,ref:T,onPointerMove:Yr(e.onPointerMove,nS($=>{r?p.onItemLeave($):(p.onItemEnter($),$.defaultPrevented||$.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Yr(e.onPointerLeave,nS($=>p.onItemLeave($))),onFocus:Yr(e.onFocus,()=>N(!0)),onBlur:Yr(e.onBlur,()=>N(!1))})})})}),Gye="MenuCheckboxItem",HZ=z.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...c}=e;return o.jsx(YZ,{scope:e.__scopeMenu,checked:n,children:o.jsx(sC,{role:"menuitemcheckbox","aria-checked":sj(n)?"mixed":n,...c,ref:t,"data-state":D3(n),onSelect:Yr(c.onSelect,()=>r?.(sj(n)?!0:!n),{checkForDefaultPrevented:!1})})})});HZ.displayName=Gye;var GZ="MenuRadioGroup",[Wye,Xye]=h_(GZ,{value:void 0,onValueChange:()=>{}}),WZ=z.forwardRef((e,t)=>{const{value:n,onValueChange:r,...c}=e,f=Ff(r);return o.jsx(Wye,{scope:e.__scopeMenu,value:n,onValueChange:f,children:o.jsx(R3,{...c,ref:t})})});WZ.displayName=GZ;var XZ="MenuRadioItem",ZZ=z.forwardRef((e,t)=>{const{value:n,...r}=e,c=Xye(XZ,e.__scopeMenu),f=n===c.value;return o.jsx(YZ,{scope:e.__scopeMenu,checked:f,children:o.jsx(sC,{role:"menuitemradio","aria-checked":f,...r,ref:t,"data-state":D3(f),onSelect:Yr(r.onSelect,()=>c.onValueChange?.(n),{checkForDefaultPrevented:!1})})})});ZZ.displayName=XZ;var O3="MenuItemIndicator",[YZ,Zye]=h_(O3,{checked:!1}),KZ=z.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...c}=e,f=Zye(O3,n);return o.jsx(nd,{present:r||sj(f.checked)||f.checked===!0,children:o.jsx(Si.span,{...c,ref:t,"data-state":D3(f.checked)})})});KZ.displayName=O3;var Yye="MenuSeparator",JZ=z.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return o.jsx(Si.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});JZ.displayName=Yye;var Kye="MenuArrow",QZ=z.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,c=iC(n);return o.jsx(QE,{...c,...r,ref:t})});QZ.displayName=Kye;var Jye="MenuSub",[p$e,eY]=h_(Jye),N1="MenuSubTrigger",tY=z.forwardRef((e,t)=>{const n=f_(N1,e.__scopeMenu),r=pT(N1,e.__scopeMenu),c=eY(N1,e.__scopeMenu),f=P3(N1,e.__scopeMenu),p=z.useRef(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:w}=f,T={__scopeMenu:e.__scopeMenu},E=z.useCallback(()=>{p.current&&window.clearTimeout(p.current),p.current=null},[]);return z.useEffect(()=>E,[E]),z.useEffect(()=>{const N=s.current;return()=>{window.clearTimeout(N),w(null)}},[s,w]),o.jsx(C3,{asChild:!0,...T,children:o.jsx(qZ,{id:c.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":c.contentId,"data-state":iY(n.open),...e,ref:Ag(t,c.onTriggerChange),onClick:N=>{e.onClick?.(N),!(e.disabled||N.defaultPrevented)&&(N.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Yr(e.onPointerMove,nS(N=>{f.onItemEnter(N),!N.defaultPrevented&&!e.disabled&&!n.open&&!p.current&&(f.onPointerGraceIntentChange(null),p.current=window.setTimeout(()=>{n.onOpenChange(!0),E()},100))})),onPointerLeave:Yr(e.onPointerLeave,nS(N=>{E();const D=n.content?.getBoundingClientRect();if(D){const V=n.content?.dataset.side,$=V==="right",B=$?-5:5,F=D[$?"left":"right"],K=D[$?"right":"left"];f.onPointerGraceIntentChange({area:[{x:N.clientX+B,y:N.clientY},{x:F,y:D.top},{x:K,y:D.top},{x:K,y:D.bottom},{x:F,y:D.bottom}],side:V}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>f.onPointerGraceIntentChange(null),300)}else{if(f.onTriggerLeave(N),N.defaultPrevented)return;f.onPointerGraceIntentChange(null)}})),onKeyDown:Yr(e.onKeyDown,N=>{const D=f.searchRef.current!=="";e.disabled||D&&N.key===" "||Rye[r.dir].includes(N.key)&&(n.onOpenChange(!0),n.content?.focus(),N.preventDefault())})})})});tY.displayName=N1;var nY="MenuSubContent",rY=z.forwardRef((e,t)=>{const n=BZ(Fh,e.__scopeMenu),{forceMount:r=n.forceMount,...c}=e,f=f_(Fh,e.__scopeMenu),p=pT(Fh,e.__scopeMenu),s=eY(nY,e.__scopeMenu),w=z.useRef(null),T=fa(t,w);return o.jsx(tS.Provider,{scope:e.__scopeMenu,children:o.jsx(nd,{present:r||f.open,children:o.jsx(tS.Slot,{scope:e.__scopeMenu,children:o.jsx(M3,{id:s.contentId,"aria-labelledby":s.triggerId,...c,ref:T,align:"start",side:p.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:E=>{p.isUsingKeyboardRef.current&&w.current?.focus(),E.preventDefault()},onCloseAutoFocus:E=>E.preventDefault(),onFocusOutside:Yr(e.onFocusOutside,E=>{E.target!==s.trigger&&f.onOpenChange(!1)}),onEscapeKeyDown:Yr(e.onEscapeKeyDown,E=>{p.onClose(),E.preventDefault()}),onKeyDown:Yr(e.onKeyDown,E=>{const N=E.currentTarget.contains(E.target),D=Oye[p.dir].includes(E.key);N&&D&&(f.onOpenChange(!1),s.trigger?.focus(),E.preventDefault())})})})})})});rY.displayName=nY;function iY(e){return e?"open":"closed"}function sj(e){return e==="indeterminate"}function D3(e){return sj(e)?"indeterminate":e?"checked":"unchecked"}function Qye(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function eve(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function tve(e,t,n){const c=t.length>1&&Array.from(t).every(T=>T===t[0])?t[0]:t,f=n?e.indexOf(n):-1;let p=eve(e,Math.max(f,0));c.length===1&&(p=p.filter(T=>T!==n));const w=p.find(T=>T.toLowerCase().startsWith(c.toLowerCase()));return w!==n?w:void 0}function nve(e,t){const{x:n,y:r}=e;let c=!1;for(let f=0,p=t.length-1;f<t.length;p=f++){const s=t[f],w=t[p],T=s.x,E=s.y,N=w.x,D=w.y;E>r!=D>r&&n<(N-T)*(r-E)/(D-E)+T&&(c=!c)}return c}function rve(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return nve(n,t)}function nS(e){return t=>t.pointerType==="mouse"?e(t):void 0}var ive=FZ,sve=C3,ave=UZ,ove=VZ,lve=R3,cve=$Z,uve=sC,dve=HZ,hve=WZ,fve=ZZ,pve=KZ,mve=JZ,gve=QZ,yve=tY,vve=rY,aC="DropdownMenu",[xve,m$e]=Eu(aC,[LZ]),Cu=LZ(),[_ve,sY]=xve(aC),aY=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:c,defaultOpen:f,onOpenChange:p,modal:s=!0}=e,w=Cu(t),T=z.useRef(null),[E,N]=zf({prop:c,defaultProp:f??!1,onChange:p,caller:aC});return o.jsx(_ve,{scope:t,triggerId:Ml(),triggerRef:T,contentId:Ml(),open:E,onOpenChange:N,onOpenToggle:z.useCallback(()=>N(D=>!D),[N]),modal:s,children:o.jsx(ive,{...w,open:E,onOpenChange:N,dir:r,modal:s,children:n})})};aY.displayName=aC;var oY="DropdownMenuTrigger",lY=z.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...c}=e,f=sY(oY,n),p=Cu(n);return o.jsx(sve,{asChild:!0,...p,children:o.jsx(Si.button,{type:"button",id:f.triggerId,"aria-haspopup":"menu","aria-expanded":f.open,"aria-controls":f.open?f.contentId:void 0,"data-state":f.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...c,ref:Ag(t,f.triggerRef),onPointerDown:Yr(e.onPointerDown,s=>{!r&&s.button===0&&s.ctrlKey===!1&&(f.onOpenToggle(),f.open||s.preventDefault())}),onKeyDown:Yr(e.onKeyDown,s=>{r||(["Enter"," "].includes(s.key)&&f.onOpenToggle(),s.key==="ArrowDown"&&f.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})})});lY.displayName=oY;var bve="DropdownMenuPortal",cY=e=>{const{__scopeDropdownMenu:t,...n}=e,r=Cu(t);return o.jsx(ave,{...r,...n})};cY.displayName=bve;var uY="DropdownMenuContent",dY=z.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,c=sY(uY,n),f=Cu(n),p=z.useRef(!1);return o.jsx(ove,{id:c.contentId,"aria-labelledby":c.triggerId,...f,...r,ref:t,onCloseAutoFocus:Yr(e.onCloseAutoFocus,s=>{p.current||c.triggerRef.current?.focus(),p.current=!1,s.preventDefault()}),onInteractOutside:Yr(e.onInteractOutside,s=>{const w=s.detail.originalEvent,T=w.button===0&&w.ctrlKey===!0,E=w.button===2||T;(!c.modal||E)&&(p.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});dY.displayName=uY;var wve="DropdownMenuGroup",hY=z.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,c=Cu(n);return o.jsx(lve,{...c,...r,ref:t})});hY.displayName=wve;var Sve="DropdownMenuLabel",fY=z.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,c=Cu(n);return o.jsx(cve,{...c,...r,ref:t})});fY.displayName=Sve;var Tve="DropdownMenuItem",pY=z.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,c=Cu(n);return o.jsx(uve,{...c,...r,ref:t})});pY.displayName=Tve;var Ave="DropdownMenuCheckboxItem",jve=z.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,c=Cu(n);return o.jsx(dve,{...c,...r,ref:t})});jve.displayName=Ave;var Eve="DropdownMenuRadioGroup",Cve=z.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,c=Cu(n);return o.jsx(hve,{...c,...r,ref:t})});Cve.displayName=Eve;var Nve="DropdownMenuRadioItem",Pve=z.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,c=Cu(n);return o.jsx(fve,{...c,...r,ref:t})});Pve.displayName=Nve;var Mve="DropdownMenuItemIndicator",Rve=z.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,c=Cu(n);return o.jsx(pve,{...c,...r,ref:t})});Rve.displayName=Mve;var Ove="DropdownMenuSeparator",mY=z.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,c=Cu(n);return o.jsx(mve,{...c,...r,ref:t})});mY.displayName=Ove;var Dve="DropdownMenuArrow",kve=z.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,c=Cu(n);return o.jsx(gve,{...c,...r,ref:t})});kve.displayName=Dve;var Ive="DropdownMenuSubTrigger",Lve=z.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,c=Cu(n);return o.jsx(yve,{...c,...r,ref:t})});Lve.displayName=Ive;var zve="DropdownMenuSubContent",Fve=z.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,c=Cu(n);return o.jsx(vve,{...c,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Fve.displayName=zve;var Bve=aY,Uve=lY,Vve=cY,$ve=dY,qve=hY,Hve=fY,Gve=pY,Wve=mY;function gY({...e}){return o.jsx(Bve,{"data-slot":"dropdown-menu",...e})}function yY({...e}){return o.jsx(Uve,{"data-slot":"dropdown-menu-trigger",...e})}function vY({className:e,sideOffset:t=4,...n}){return o.jsx(Vve,{children:o.jsx($ve,{"data-slot":"dropdown-menu-content",sideOffset:t,className:Rn("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...n})})}function Xve({...e}){return o.jsx(qve,{"data-slot":"dropdown-menu-group",...e})}function F0({className:e,inset:t,variant:n="default",...r}){return o.jsx(Gve,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":n,className:Rn("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function Zve({className:e,inset:t,...n}){return o.jsx(Hve,{"data-slot":"dropdown-menu-label","data-inset":t,className:Rn("px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",e),...n})}function X6({className:e,...t}){return o.jsx(Wve,{"data-slot":"dropdown-menu-separator",className:Rn("bg-border -mx-1 my-1 h-px",e),...t})}function Yve({user:e,logout:t}){const{isMobile:n}=uT();return o.jsx(QA,{children:o.jsx(ej,{children:o.jsxs(gY,{children:[o.jsx(yY,{asChild:!0,children:o.jsxs(Fk,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[o.jsxs(tj,{className:"h-8 w-8 rounded-lg",children:[o.jsx(nj,{src:e.avatar,alt:e.name}),o.jsx(rj,{className:"rounded-lg bg-[var(--neon-pink)]",children:"CN"})]}),o.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight",children:[o.jsx("span",{className:"truncate font-medium",children:e.name}),o.jsx("span",{className:"truncate text-xs",children:e.email})]}),o.jsx(zE,{className:"ml-auto size-4"})]})}),o.jsxs(vY,{className:"w-(--radix-dropdown-menu-trigger-width) min-w-56 rounded-lg",side:n?"bottom":"right",align:"end",sideOffset:4,children:[o.jsx(Zve,{className:"p-0 font-normal",children:o.jsxs("div",{className:"flex items-center gap-2 px-1 py-1.5 text-left text-sm",children:[o.jsxs(tj,{className:"h-8 w-8 rounded-lg",children:[o.jsx(nj,{src:e.avatar,alt:e.name}),o.jsx(rj,{className:"rounded-lg text-sidebar-primary-foreground bg-[var(--neon-pink)]",children:"CN"})]}),o.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight",children:[o.jsx("span",{className:"truncate font-medium",children:e.name}),o.jsx("span",{className:"truncate text-xs",children:e.email})]})]})}),o.jsx(X6,{}),o.jsxs(Xve,{children:[o.jsxs(F0,{children:[o.jsx(Fue,{}),"Account"]}),o.jsxs(F0,{children:[o.jsx(Uue,{}),"Notifications"]})]}),o.jsx(X6,{}),o.jsx(F0,{onClick:()=>{t()},children:"Logout"})]})]})})})}const Kve="/assets/joli_cropped-C7siT9aC.png",kP={HR2Nav:[{NavGroup:{NavLabel:"Human Resource II",NavItems:[{title:"Dashboard",url:"/hr2/db",icon:Lde},{title:"Competency Management",url:"/hr2/cms",icon:CA},{title:"Learning Management",url:"/hr2/lms",icon:kh},{title:"Training Management",url:"/hr2/tms",icon:qx},{title:"Succession Planning",url:"/hr2/sps",icon:CA},{title:"Employee Self-Service",url:"/hr2/ess",icon:Xy}]}}],logisticsINav:[{NavGroup:{NavLabel:"Smart Warehousing System",NavItems:[{title:"Inventory Management",url:"/logistics1/inventory-management",icon:Ek},{title:"Storage Organization",url:"/logisticsI/storage-organization",icon:GW},{title:"Stock Monitoring",url:"/logisticsI/stock-monitoring",icon:CA}]}},{NavGroup:{NavLabel:"Procurement & Sourcing Management",NavItems:[{title:"Supplier Management",url:"/logistic1/supplier-management",icon:Xy},{title:"Purchase Processing",url:"/logistic1/purchase-processing",icon:qx},{title:"Expense Records",url:"/logistic1/expense-records",icon:o6}]}},{NavGroup:{NavLabel:"Project Logistic Tracker",NavItems:[{title:"Equipment Scheduling",url:"/logistic1/equipment-scheduling",icon:EA},{title:"Delivery & Transport Tracking",url:"/logistic1/delivery-transport-tracking",icon:u6},{title:"Tour Reports",url:"/logistic1/tour-reports",icon:PA}]}},{NavGroup:{NavLabel:"Asset Lifecycle & Maintenance",NavItems:[{title:"Asset Registration & QR Tagging",url:"/logistic1/asset-registration",icon:Xy},{title:"Predictive Maintenance",url:"/logistic1/predictive-maintenance",icon:qx},{title:"Maintenance History",url:"/logistic1/maintenance-history",icon:l6}]}},{NavGroup:{NavLabel:"Document Tracking & Logistics Records",NavItems:[{title:"Delivery Receipts",url:"/logistic1/delivery-receipts",icon:EA},{title:"Check-In/Check-Out Logs",url:"/logistic1/check-in-out-logs",icon:o6},{title:"Logistics Reports",url:"/logistic1/logistics-reports",icon:PA}]}}],logisticsIINav:[{NavGroup:{NavLabel:"Analytics",NavItems:[{title:"Dashboard",url:"/logisticsII",icon:Ek}]}},{NavGroup:{NavLabel:"Fleet",NavItems:[{title:"Vehicles",url:"/logisticsII/vehicles",icon:tde},{title:"Drivers",url:"/logisticsII/drivers",icon:Xy}]}},{NavGroup:{NavLabel:"Reservation and Dispatch",NavItems:[{title:"Reservations",url:"/logisticsII/reservation",icon:EA},{title:"Dispatch Orders",url:"/logisticsII/dispatch",icon:u6}]}},{NavGroup:{NavLabel:"Logs",NavItems:[{title:"Trip History",url:"#",icon:PA},{title:"Trip Logs",url:"#",icon:l6}]}}]};function td({...e}){const{auth:t,logout:n,loading:r}=z.useContext(Vh),c={name:t?.name,role:t?.role,avatar:null,email:t?.email};return o.jsxs(Qge,{collapsible:"icon",...e,className:"rounded-md",children:[o.jsx(tye,{children:o.jsx(QA,{children:o.jsx(ej,{children:o.jsx(Yl,{to:"/",className:"flex justify-center",children:o.jsx("img",{src:Kve,className:"h-10  object-scale-down",alt:""})})})})}),o.jsx(rye,{className:"flex flex-col gap-2",children:r?o.jsxs("div",{className:"flex flex-col gap-2 px-2 h-full",children:[o.jsx(ko,{className:"h-8 w-full"}),o.jsx(ko,{className:"h-8 w-full"}),o.jsx(ko,{className:"flex-1 w-full"}),o.jsx(ko,{className:"flex-1 w-full"})]}):o.jsx(o.Fragment,{children:c.role==="LogisticsII Admin"?o.jsx(MP,{data:kP.logisticsIINav}):c.role==="LogisticsI Admin"?o.jsx(MP,{data:kP.logisticsINav}):c.role==="HR2 Admin"||c.role==="Employee"||c.role==="Trainer"?o.jsx(MP,{data:kP.HR2Nav}):null})}),o.jsx(eye,{}),o.jsx(nye,{children:r?o.jsx(ko,{className:"w-full h-full"}):o.jsx(Yve,{user:c,logout:n})})]})}function xY(){const{setTheme:e}=Cue();return o.jsxs(gY,{children:[o.jsx(yY,{asChild:!0,children:o.jsxs(kt,{variant:"outline",size:"icon",children:[o.jsx(mhe,{className:"h-[1.2rem] w-[1.2rem] scale-100 rotate-0 transition-all dark:scale-0 dark:-rotate-90"}),o.jsx(Yde,{className:"absolute h-[1.2rem] w-[1.2rem] scale-0 rotate-90 transition-all dark:scale-100 dark:rotate-0"}),o.jsx("span",{className:"sr-only",children:"Toggle theme"})]})}),o.jsxs(vY,{align:"end",children:[o.jsx(F0,{onClick:()=>e("light"),children:"Light"}),o.jsx(F0,{onClick:()=>e("dark"),children:"Dark"}),o.jsx(F0,{onClick:()=>e("system"),children:"System"})]})]})}function Jve({...e}){return o.jsx("nav",{"aria-label":"breadcrumb","data-slot":"breadcrumb",...e})}function Qve({className:e,...t}){return o.jsx("ol",{"data-slot":"breadcrumb-list",className:Rn("text-muted-foreground flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-2.5",e),...t})}function exe({className:e,...t}){return o.jsx("li",{"data-slot":"breadcrumb-item",className:Rn("inline-flex items-center gap-1.5",e),...t})}function Z6({asChild:e,className:t,...n}){const r=e?rT:"a";return o.jsx(r,{"data-slot":"breadcrumb-link",className:Rn("hover:text-foreground transition-colors",t),...n})}function txe({children:e,className:t,...n}){return o.jsx("li",{"data-slot":"breadcrumb-separator",role:"presentation","aria-hidden":"true",className:Rn("[&>svg]:size-3.5",t),...n,children:e??o.jsx(Mb,{})})}function _Y(){const n=cv().pathname.split("/").filter(Boolean);return o.jsx(Jve,{children:o.jsx(Qve,{children:n.map((r,c)=>{const f="/"+n.slice(0,c+1).join("/"),p=r.charAt(0).toUpperCase()+r.slice(1);return o.jsxs(_e.Fragment,{children:[o.jsx(exe,{children:c===n.length-1?o.jsx("span",{className:"font-medium",children:p=="LogisticsII"?"Home":p}):c===0?o.jsx(o.Fragment,{children:o.jsx(Z6,{asChild:!0,children:o.jsx(Yl,{to:f,children:"Home"})})}):o.jsx(o.Fragment,{children:o.jsx(Z6,{asChild:!0,children:o.jsx(Yl,{to:f,children:p})})})}),c!==n.length-1&&o.jsx(txe,{})]},`${f}-${c}`)})})})}function IP({allowedRoles:e}){const{auth:t,loading:n,logout:r}=z.useContext(Vh),c=d_(),[f,p]=z.useState(null);return z.useEffect(()=>{if(!n)if(t)if(e.includes(t.role))p(!0);else{p(!1),Zt.error("Unauthorized User! Redirecting to login...",{position:"top-center"});const s=setTimeout(()=>{r()},2500);return()=>clearTimeout(s)}else{p(!1);const s=setTimeout(()=>{c("/login")},2500);return()=>clearTimeout(s)}},[t,n,e,r,c]),n||f===null?o.jsxs(YA,{children:[o.jsx("title",{children:"Loading..."}),o.jsx(td,{}),o.jsxs(JA,{children:[o.jsx("header",{className:"flex h-16 shrink-0 items-center gap-2",children:o.jsxs("div",{className:"flex items-center gap-2 px-4",children:[o.jsx(KA,{className:"-ml-1"}),o.jsx(Oc,{orientation:"vertical",className:"mr-2 data-[orientation=vertical]:h-4"})]})}),o.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-4 pt-0",children:[o.jsx(ko,{className:"h-1/3 w-full"}),o.jsx(ko,{className:"h-2/3 w-full"})]})]})]}):f===!1?o.jsx(o.Fragment,{children:o.jsx("p",{className:"p-4",children:"Unauthorized access, redirecting..."})}):o.jsx(o.Fragment,{children:o.jsxs(YA,{children:[o.jsx("title",{children:"JOLI - Admin"}),o.jsx(td,{}),o.jsxs(JA,{children:[o.jsx("header",{className:"flex h-16 shrink-0 items-center gap-2 rounded-md bg-background/80 backdrop-blur-md",children:o.jsxs("div",{className:"flex justify-between w-full items-center pr-4",children:[o.jsxs("div",{className:"flex items-center gap-2 px-4",children:[o.jsx(KA,{className:"-ml-1"}),o.jsx(Oc,{orientation:"vertical",className:"mr-2 data-[orientation=vertical]:h-4"}),o.jsx(_Y,{})]}),o.jsx(xY,{})]})}),o.jsx("div",{className:"flex flex-1 flex-col p-4 pt-0 relative",children:o.jsx(JL,{})})]})]})})}const nxe=z.createContext({setMapComponent:()=>{},mapComponent:null});function rxe({allowedRoles:e}){const{auth:t,loading:n,logout:r}=z.useContext(Vh),c=d_(),[f,p]=z.useState(null),[s,w]=z.useState(null);return z.useEffect(()=>{if(!n)if(t)if(e.includes(t.role))p(!0);else{p(!1),Zt.error("Unauthorized User! Redirecting to login...",{position:"top-center"});const T=setTimeout(()=>{r()},2500);return()=>clearTimeout(T)}else{p(!1);const T=setTimeout(()=>{c("/login")},2500);return()=>clearTimeout(T)}},[t,n,e,r,c]),n||f===null?o.jsxs(YA,{children:[o.jsx("title",{children:"Loading..."}),o.jsx(td,{}),o.jsxs(JA,{children:[o.jsx("header",{className:"flex h-16 shrink-0 items-center gap-2",children:o.jsxs("div",{className:"flex items-center gap-2 px-4",children:[o.jsx(KA,{className:"-ml-1"}),o.jsx(Oc,{orientation:"vertical",className:"mr-2 data-[orientation=vertical]:h-4"})]})}),o.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-4 pt-0",children:[o.jsx(ko,{className:"h-1/3 w-full"}),o.jsx(ko,{className:"h-2/3 w-full"})]})]})]}):f===!1?o.jsx(o.Fragment,{children:o.jsx("p",{className:"p-4",children:"Unauthorized access, redirecting..."})}):o.jsx(o.Fragment,{children:o.jsx(nxe.Provider,{value:{mapComponent:s,setMapComponent:w},children:o.jsxs(YA,{children:[o.jsx("title",{children:"JOLI - Admin"}),o.jsx(td,{}),o.jsxs(JA,{children:[o.jsx("header",{className:"flex h-16 shrink-0 items-center gap-2 z-50 bg-background/80 backdrop-blur-md mb-3",children:o.jsxs("div",{className:"flex justify-between w-full items-center pr-4",children:[o.jsxs("div",{className:"flex items-center gap-2 px-4",children:[o.jsx(KA,{className:"-ml-1"}),o.jsx(Oc,{orientation:"vertical",className:"mr-2 data-[orientation=vertical]:h-4"}),o.jsx(_Y,{})]}),o.jsx(xY,{})]})}),s&&o.jsx("div",{className:"fixed inset-0 w-screen h-screen",children:s}),o.jsx(JL,{context:{setMapComponent:w}})]})]})})})}function LP({className:e,...t}){return o.jsxs("div",{className:Rn("w-90 h-60 border-black border-1 rounded-md overflow-hidden relative",e),...t,children:[o.jsx("img",{src:t.src,loading:"lazy"}),o.jsxs("div",{className:"absolute bottom-0 left-0 p-4",children:[o.jsx("p",{className:"font-bold text-white",children:t.name}),o.jsx("p",{className:"text-white",children:t.desc})]})]})}const Vk="/assets/finallogo-DMsNpMYO.avif",ixe="/assets/wallpaper-header-HxgzqfzR.jpg",sxe="/assets/Bohol-BpzYKQqk.jpg",axe="/assets/Boracay-CuLFrt7t.jpg",oxe="/assets/Palawan-CHrpdVa6.jpg";function lxe(){return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center py-2 px-4 justify-evenly",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("img",{src:Vk,className:"w-30",alt:"Logo",loading:"lazy"}),o.jsx("h1",{className:"text-(--primary) text-[20px] font-bold",children:"Travel & Tours"})]}),o.jsxs("div",{className:"flex items-center gap-20",children:[o.jsx("a",{href:"#destinations",children:"Destination"}),o.jsx("a",{href:"#",children:"Why Us"}),o.jsx("a",{href:"#",children:"Packages"}),o.jsx("a",{href:"#",children:"Reviews"}),o.jsx("a",{href:"#",children:"FAQ"})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx(kt,{variant:"outline",children:"Contact"}),o.jsx(Yl,{to:"/login",children:o.jsx(kt,{children:"Login"})})]})]}),o.jsxs("div",{className:"py-60 relative overflow-hidden",children:[o.jsx("img",{src:ixe,alt:"wallpaper",className:"blur-[5px] absolute bottom-0 w-[100%] h-[100%] z-0",loading:"lazy"}),o.jsxs("div",{className:"ml-20 p-8 rounded-lg bg-white w-150 z-10",children:[o.jsx("b",{children:o.jsxs("h1",{className:"text-[30px]",children:["Design your next Escape with",o.jsx("p",{className:"text-(--primary) text-[50px]",children:"Travel And Tours"})]})}),o.jsxs("p",{className:"my-4",children:["Curated itineraries, reliable transfer, and local-guided experiences ",o.jsx("br",{}),"across the philippines and beyond."]}),o.jsx(kt,{className:"block",children:"Find Packages"})]})]}),o.jsxs("div",{className:"flex items-center py-4 justify-evenly",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-center text-(--vivid-neon-pink) font-bold text-[20px]",children:"50k+"}),o.jsx("p",{className:"text-center font-bold text-[13px]",children:"Happy Travelers"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-center text-(--vivid-neon-pink) font-bold text-[20px]",children:"4.9"}),o.jsx("p",{className:"text-center font-bold text-[13px]",children:"Average Rating"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-center text-(--vivid-neon-pink) font-bold text-[20px]",children:"200+"}),o.jsx("p",{className:"text-center font-bold text-[13px]",children:"Local Partners"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-center text-(--vivid-neon-pink) font-bold text-[20px]",children:"12yrs"}),o.jsx("p",{className:"text-center font-bold text-[13px]",children:"Experience"})]})]}),o.jsx(Oc,{}),o.jsxs("div",{className:"py-20 px-80",id:"destinations",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h1",{className:"text-[20px] font-bold",children:"Destinations"}),o.jsx("a",{href:"#",className:"text-(--primary) text-[20px] font-bold",children:"See all Packages"})]}),o.jsxs("div",{className:"flex items-center mt-4 justify-between",children:[o.jsx(LP,{src:sxe,name:"Bohol",desc:"Chocolate Hills Tarsiers"}),o.jsx(LP,{src:axe,name:"Boracay",desc:"White Beach Water Sports"}),o.jsx(LP,{src:oxe,name:"Palawan",desc:"Lagoon Hoping Limestone Cliffs"})]})]}),o.jsxs("div",{className:"py-8 px-20 bg-[#e9efff]",children:[o.jsx("h1",{className:"text-center text-[30px] mb-8 font-bold",children:"Traveler Reviews"}),o.jsxs("div",{className:"flex items-center justify-evenly",children:[o.jsxs("div",{className:"p-4 rounded-md bg-(--primary) w-80",children:[o.jsx("p",{className:"text-white",children:"Flawless Palawan trip! Transfer were on time and tours felt truly local"}),o.jsx("p",{className:"mt-2 text-white",children:"- Mika p."})]}),o.jsxs("div",{className:"p-4 rounded-md bg-(--primary) w-80",children:[o.jsx("p",{className:"text-white",children:"They customize our Cebu itinerary around our kids-super helpful support"}),o.jsx("p",{className:"mt-2 text-white",children:"- Arvin p."})]}),o.jsxs("div",{className:"p-4 rounded-md bg-(--primary) w-80",children:[o.jsx("p",{className:"text-white",children:"Great value for money. We loved the Coron shipwreck tour!"}),o.jsx("p",{className:"mt-2 text-white",children:"- Jessa L."})]}),o.jsxs("div",{className:"p-4 rounded-md bg-(--primary) w-80",children:[o.jsx("p",{className:"text-white",children:"Quick to respond and very organized. Will book again."}),o.jsx("p",{className:"mt-2 text-white",children:"- Leo S."})]})]})]}),o.jsxs("div",{className:"flex items-center py-8 flex-col",children:[o.jsx("h1",{className:"text-center font-bold text-2xl mb-8",children:"Frequently asked questions"}),o.jsxs("div",{className:"flex items-center flex-col rounded-xl border w-[40%]",children:[o.jsxs("div",{className:"p-8 border-b w-[100%]",children:[o.jsx("p",{className:"font-bold mb-8",children:"What's included in a typical package?"}),o.jsx("p",{children:"Most include accomodations, daily breakfast, tours with local guides, entrance fees, and transfer. Flights can bundled request"})]}),o.jsxs("div",{className:"p-8 border-b w-[100%]",children:[o.jsx("p",{className:"font-bold mb-8",children:"Can I customize my itinerary?"}),o.jsx("p",{children:"Absolutely. Tell us your dates, budget, and must-see spots and we'll tailor the trip"})]}),o.jsxs("div",{className:"p-8 border-b w-[100%]",children:[o.jsx("p",{className:"font-bold mb-8",children:"What is your cancellation policy?"}),o.jsx("p",{children:"Free reschedules up to 7 days befores arrival for most packages. Full policy varies partner and season"})]})]})]}),o.jsxs("div",{className:"py-8 px-20 bg-[#dd06c427]",children:[o.jsx("h1",{className:"text-center text-[30px] font-bold",children:"Ready to start Planning?"}),o.jsx("p",{className:"text-center",children:"Get a personalized quote in minutes. No commitment."}),o.jsx("div",{className:"flex items-center justify-center mt-8",children:o.jsx(kt,{className:"bg-[#dd06c5]",children:"Request a quote"})})]}),o.jsxs("div",{className:"flex justify-center p-8 gap-8",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"font-bold text-2xl",children:"Contact Us"}),o.jsx("p",{children:"Tell us your dream trip and we'll handle the rest."})]}),o.jsxs("div",{className:"px-8 py-2 shadow-xl rounded-md",children:[o.jsx("input",{type:"text",className:"border rounded-xl p-4 w-90 my-2",placeholder:"Full Name"}),o.jsx("br",{}),o.jsx("input",{type:"text",className:"border rounded-xl p-4 w-90 my-2",placeholder:"Email"}),o.jsx("br",{}),o.jsx("input",{type:"text",className:"border rounded-xl p-4 w-90 my-2",placeholder:"Destination (e.g., Cebu, Bohol)"}),o.jsx("br",{}),o.jsx("textarea",{className:"border rounded-xl p-4 w-90 h-90 resize-none my-2",placeholder:"Tell us about your trip"}),o.jsx("br",{}),o.jsx("input",{type:"submit",className:"border rounded-xl p-4 w-90 my-2 text-white bg-[#dd06c5]",placeholder:"Send Inquiry"})]})]}),o.jsx(Oc,{}),o.jsxs("div",{className:"flex items-center justify-evenly p-8",children:[o.jsxs("div",{children:[o.jsx("img",{src:Vk,className:"w-60 ml-[-40px]",alt:"Logo",loading:"lazy"}),o.jsx("h1",{className:"font-bold text-(--primary)",children:"Travel and Tours"})]}),o.jsxs("div",{children:[o.jsx("h1",{className:"font-bold",children:"Explore"}),o.jsx("p",{children:"Destinations"}),o.jsx("p",{children:"Packages"}),o.jsx("p",{children:"Reviews"})]}),o.jsxs("div",{children:[o.jsx("h1",{className:"font-bold",children:"Company"}),o.jsx("p",{children:"About"}),o.jsx("p",{children:"FAQ"}),o.jsx("p",{children:"Contact"})]})]})]})}function Jc({className:e,...t}){return o.jsx("div",{"data-slot":"alert-description",className:Rn("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}function ni({className:e,...t}){return o.jsx("div",{"data-slot":"card",className:Rn("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function Ns({className:e,...t}){return o.jsx("div",{"data-slot":"card-header",className:Rn("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function us({className:e,...t}){return o.jsx("div",{"data-slot":"card-title",className:Rn("leading-none font-semibold",e),...t})}function Nc({className:e,...t}){return o.jsx("div",{"data-slot":"card-description",className:Rn("text-muted-foreground text-sm",e),...t})}function qi({className:e,...t}){return o.jsx("div",{"data-slot":"card-content",className:Rn("px-6",e),...t})}var cxe="Label",bY=z.forwardRef((e,t)=>o.jsx(Si.label,{...e,ref:t,onMouseDown:n=>{n.target.closest("button, input, select, textarea")||(e.onMouseDown?.(n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));bY.displayName=cxe;var uxe=bY;function bt({className:e,...t}){return o.jsx(uxe,{"data-slot":"label",className:Rn("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}var mT=e=>e.type==="checkbox",Dx=e=>e instanceof Date,xu=e=>e==null;const wY=e=>typeof e=="object";var pl=e=>!xu(e)&&!Array.isArray(e)&&wY(e)&&!Dx(e),SY=e=>pl(e)&&e.target?mT(e.target)?e.target.checked:e.target.value:e,dxe=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,TY=(e,t)=>e.has(dxe(t)),hxe=e=>{const t=e.constructor&&e.constructor.prototype;return pl(t)&&t.hasOwnProperty("isPrototypeOf")},k3=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function jo(e){let t;const n=Array.isArray(e),r=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(!(k3&&(e instanceof Blob||r))&&(n||pl(e)))if(t=n?[]:Object.create(Object.getPrototypeOf(e)),!n&&!hxe(e))t=e;else for(const c in e)e.hasOwnProperty(c)&&(t[c]=jo(e[c]));else return e;return t}var oC=e=>/^\w*$/.test(e),No=e=>e===void 0,lC=e=>Array.isArray(e)?e.filter(Boolean):[],I3=e=>lC(e.replace(/["|']|\]/g,"").split(/\.|\[/)),Br=(e,t,n)=>{if(!t||!pl(e))return n;const r=(oC(t)?[t]:I3(t)).reduce((c,f)=>xu(c)?c:c[f],e);return No(r)||r===e?No(e[t])?n:e[t]:r},qd=e=>typeof e=="boolean",Ka=(e,t,n)=>{let r=-1;const c=oC(t)?[t]:I3(t),f=c.length,p=f-1;for(;++r<f;){const s=c[r];let w=n;if(r!==p){const T=e[s];w=pl(T)||Array.isArray(T)?T:isNaN(+c[r+1])?{}:[]}if(s==="__proto__"||s==="constructor"||s==="prototype")return;e[s]=w,e=e[s]}};const aj={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Ih={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},dg={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},AY=_e.createContext(null);AY.displayName="HookFormContext";const cC=()=>_e.useContext(AY);var jY=(e,t,n,r=!0)=>{const c={defaultValues:t._defaultValues};for(const f in e)Object.defineProperty(c,f,{get:()=>{const p=f;return t._proxyFormState[p]!==Ih.all&&(t._proxyFormState[p]=!r||Ih.all),n&&(n[p]=!0),e[p]}});return c};const uC=typeof window<"u"?_e.useLayoutEffect:_e.useEffect;function fxe(e){const t=cC(),{control:n=t.control,disabled:r,name:c,exact:f}=e||{},[p,s]=_e.useState(n._formState),w=_e.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return uC(()=>n._subscribe({name:c,formState:w.current,exact:f,callback:T=>{!r&&s({...n._formState,...T})}}),[c,r,f]),_e.useEffect(()=>{w.current.isValid&&n._setValid(!0)},[n]),_e.useMemo(()=>jY(p,n,w.current,!1),[p,n])}var Wp=e=>typeof e=="string",EY=(e,t,n,r,c)=>Wp(e)?(r&&t.watch.add(e),Br(n,e,c)):Array.isArray(e)?e.map(f=>(r&&t.watch.add(f),Br(n,f))):(r&&(t.watchAll=!0),n),$k=e=>xu(e)||!wY(e);function pg(e,t,n=new WeakSet){if($k(e)||$k(t))return e===t;if(Dx(e)&&Dx(t))return e.getTime()===t.getTime();const r=Object.keys(e),c=Object.keys(t);if(r.length!==c.length)return!1;if(n.has(e)||n.has(t))return!0;n.add(e),n.add(t);for(const f of r){const p=e[f];if(!c.includes(f))return!1;if(f!=="ref"){const s=t[f];if(Dx(p)&&Dx(s)||pl(p)&&pl(s)||Array.isArray(p)&&Array.isArray(s)?!pg(p,s,n):p!==s)return!1}}return!0}function pxe(e){const t=cC(),{control:n=t.control,name:r,defaultValue:c,disabled:f,exact:p,compute:s}=e||{},w=_e.useRef(c),T=_e.useRef(s),E=_e.useRef(void 0);T.current=s;const N=_e.useMemo(()=>n._getWatch(r,w.current),[n,r]),[D,V]=_e.useState(T.current?T.current(N):N);return uC(()=>n._subscribe({name:r,formState:{values:!0},exact:p,callback:$=>{if(!f){const B=EY(r,n._names,$.values||n._formValues,!1,w.current);if(T.current){const F=T.current(B);pg(F,E.current)||(V(F),E.current=F)}else V(B)}}}),[n,f,r,p]),_e.useEffect(()=>n._removeUnmounted()),D}function mxe(e){const t=cC(),{name:n,disabled:r,control:c=t.control,shouldUnregister:f,defaultValue:p}=e,s=TY(c._names.array,n),w=_e.useMemo(()=>Br(c._formValues,n,Br(c._defaultValues,n,p)),[c,n,p]),T=pxe({control:c,name:n,defaultValue:w,exact:!0}),E=fxe({control:c,name:n,exact:!0}),N=_e.useRef(e),D=_e.useRef(c.register(n,{...e.rules,value:T,...qd(e.disabled)?{disabled:e.disabled}:{}}));N.current=e;const V=_e.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Br(E.errors,n)},isDirty:{enumerable:!0,get:()=>!!Br(E.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!Br(E.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!Br(E.validatingFields,n)},error:{enumerable:!0,get:()=>Br(E.errors,n)}}),[E,n]),$=_e.useCallback(Y=>D.current.onChange({target:{value:SY(Y),name:n},type:aj.CHANGE}),[n]),B=_e.useCallback(()=>D.current.onBlur({target:{value:Br(c._formValues,n),name:n},type:aj.BLUR}),[n,c._formValues]),F=_e.useCallback(Y=>{const X=Br(c._fields,n);X&&Y&&(X._f.ref={focus:()=>Y.focus&&Y.focus(),select:()=>Y.select&&Y.select(),setCustomValidity:ae=>Y.setCustomValidity(ae),reportValidity:()=>Y.reportValidity()})},[c._fields,n]),K=_e.useMemo(()=>({name:n,value:T,...qd(r)||E.disabled?{disabled:E.disabled||r}:{},onChange:$,onBlur:B,ref:F}),[n,r,E.disabled,$,B,F,T]);return _e.useEffect(()=>{const Y=c._options.shouldUnregister||f;c.register(n,{...N.current.rules,...qd(N.current.disabled)?{disabled:N.current.disabled}:{}});const X=(ae,Z)=>{const se=Br(c._fields,ae);se&&se._f&&(se._f.mount=Z)};if(X(n,!0),Y){const ae=jo(Br(c._options.defaultValues,n));Ka(c._defaultValues,n,ae),No(Br(c._formValues,n))&&Ka(c._formValues,n,ae)}return!s&&c.register(n),()=>{(s?Y&&!c._state.action:Y)?c.unregister(n):X(n,!1)}},[n,c,s,f]),_e.useEffect(()=>{c._setDisabledField({disabled:r,name:n})},[r,n,c]),_e.useMemo(()=>({field:K,formState:E,fieldState:V}),[K,E,V])}const Qx=e=>e.render(mxe(e));var gxe=(e,t,n,r,c)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[r]:c||!0}}:{},Yu=e=>Array.isArray(e)?e:[e],Y6=()=>{let e=[];return{get observers(){return e},next:c=>{for(const f of e)f.next&&f.next(c)},subscribe:c=>(e.push(c),{unsubscribe:()=>{e=e.filter(f=>f!==c)}}),unsubscribe:()=>{e=[]}}},vu=e=>pl(e)&&!Object.keys(e).length,L3=e=>e.type==="file",Rf=e=>typeof e=="function",oj=e=>{if(!k3)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},CY=e=>e.type==="select-multiple",z3=e=>e.type==="radio",yxe=e=>z3(e)||mT(e),zP=e=>oj(e)&&e.isConnected;function vxe(e,t){const n=t.slice(0,-1).length;let r=0;for(;r<n;)e=No(e)?r++:e[t[r++]];return e}function xxe(e){for(const t in e)if(e.hasOwnProperty(t)&&!No(e[t]))return!1;return!0}function dl(e,t){const n=Array.isArray(t)?t:oC(t)?[t]:I3(t),r=n.length===1?e:vxe(e,n),c=n.length-1,f=n[c];return r&&delete r[f],c!==0&&(pl(r)&&vu(r)||Array.isArray(r)&&xxe(r))&&dl(e,n.slice(0,-1)),e}var NY=e=>{for(const t in e)if(Rf(e[t]))return!0;return!1};function lj(e,t={}){const n=Array.isArray(e);if(pl(e)||n)for(const r in e)Array.isArray(e[r])||pl(e[r])&&!NY(e[r])?(t[r]=Array.isArray(e[r])?[]:{},lj(e[r],t[r])):xu(e[r])||(t[r]=!0);return t}function PY(e,t,n){const r=Array.isArray(e);if(pl(e)||r)for(const c in e)Array.isArray(e[c])||pl(e[c])&&!NY(e[c])?No(t)||$k(n[c])?n[c]=Array.isArray(e[c])?lj(e[c],[]):{...lj(e[c])}:PY(e[c],xu(t)?{}:t[c],n[c]):n[c]=!pg(e[c],t[c]);return n}var u1=(e,t)=>PY(e,t,lj(t));const K6={value:!1,isValid:!1},J6={value:!0,isValid:!0};var MY=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!No(e[0].attributes.value)?No(e[0].value)||e[0].value===""?J6:{value:e[0].value,isValid:!0}:J6:K6}return K6},RY=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:r})=>No(e)?e:t?e===""?NaN:e&&+e:n&&Wp(e)?new Date(e):r?r(e):e;const Q6={isValid:!1,value:null};var OY=e=>Array.isArray(e)?e.reduce((t,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:t,Q6):Q6;function eU(e){const t=e.ref;return L3(t)?t.files:z3(t)?OY(e.refs).value:CY(t)?[...t.selectedOptions].map(({value:n})=>n):mT(t)?MY(e.refs).value:RY(No(t.value)?e.ref.value:t.value,e)}var _xe=(e,t,n,r)=>{const c={};for(const f of e){const p=Br(t,f);p&&Ka(c,f,p._f)}return{criteriaMode:n,names:[...e],fields:c,shouldUseNativeValidation:r}},cj=e=>e instanceof RegExp,d1=e=>No(e)?e:cj(e)?e.source:pl(e)?cj(e.value)?e.value.source:e.value:e,A0=e=>({isOnSubmit:!e||e===Ih.onSubmit,isOnBlur:e===Ih.onBlur,isOnChange:e===Ih.onChange,isOnAll:e===Ih.all,isOnTouch:e===Ih.onTouched});const tU="AsyncFunction";var bxe=e=>!!e&&!!e.validate&&!!(Rf(e.validate)&&e.validate.constructor.name===tU||pl(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===tU)),wxe=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),qk=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(r=>e.startsWith(r)&&/^\.\w+/.test(e.slice(r.length))));const B0=(e,t,n,r)=>{for(const c of n||Object.keys(e)){const f=Br(e,c);if(f){const{_f:p,...s}=f;if(p){if(p.refs&&p.refs[0]&&t(p.refs[0],c)&&!r)return!0;if(p.ref&&t(p.ref,p.name)&&!r)return!0;if(B0(s,t))break}else if(pl(s)&&B0(s,t))break}}};function nU(e,t,n){const r=Br(e,n);if(r||oC(n))return{error:r,name:n};const c=n.split(".");for(;c.length;){const f=c.join("."),p=Br(t,f),s=Br(e,f);if(p&&!Array.isArray(p)&&n!==f)return{name:n};if(s&&s.type)return{name:f,error:s};if(s&&s.root&&s.root.type)return{name:`${f}.root`,error:s.root};c.pop()}return{name:n}}var Sxe=(e,t,n,r)=>{n(e);const{name:c,...f}=e;return vu(f)||Object.keys(f).length>=Object.keys(t).length||Object.keys(f).find(p=>t[p]===(!r||Ih.all))},Txe=(e,t,n)=>!e||!t||e===t||Yu(e).some(r=>r&&(n?r===t:r.startsWith(t)||t.startsWith(r))),Axe=(e,t,n,r,c)=>c.isOnAll?!1:!n&&c.isOnTouch?!(t||e):(n?r.isOnBlur:c.isOnBlur)?!e:(n?r.isOnChange:c.isOnChange)?e:!0,jxe=(e,t)=>!lC(Br(e,t)).length&&dl(e,t),DY=(e,t,n)=>{const r=Yu(Br(e,n));return Ka(r,"root",t[n]),Ka(e,n,r),e},DA=e=>Wp(e);function rU(e,t,n="validate"){if(DA(e)||Array.isArray(e)&&e.every(DA)||qd(e)&&!e)return{type:n,message:DA(e)?e:"",ref:t}}var g0=e=>pl(e)&&!cj(e)?e:{value:e,message:""},Hk=async(e,t,n,r,c,f)=>{const{ref:p,refs:s,required:w,maxLength:T,minLength:E,min:N,max:D,pattern:V,validate:$,name:B,valueAsNumber:F,mount:K}=e._f,Y=Br(n,B);if(!K||t.has(B))return{};const X=s?s[0]:p,ae=$e=>{c&&X.reportValidity&&(X.setCustomValidity(qd($e)?"":$e||""),X.reportValidity())},Z={},se=z3(p),he=mT(p),ye=se||he,Ce=(F||L3(p))&&No(p.value)&&No(Y)||oj(p)&&p.value===""||Y===""||Array.isArray(Y)&&!Y.length,Ve=gxe.bind(null,B,r,Z),Re=($e,nt,Me,rt=dg.maxLength,Ee=dg.minLength)=>{const it=$e?nt:Me;Z[B]={type:$e?rt:Ee,message:it,ref:p,...Ve($e?rt:Ee,it)}};if(f?!Array.isArray(Y)||!Y.length:w&&(!ye&&(Ce||xu(Y))||qd(Y)&&!Y||he&&!MY(s).isValid||se&&!OY(s).isValid)){const{value:$e,message:nt}=DA(w)?{value:!!w,message:w}:g0(w);if($e&&(Z[B]={type:dg.required,message:nt,ref:X,...Ve(dg.required,nt)},!r))return ae(nt),Z}if(!Ce&&(!xu(N)||!xu(D))){let $e,nt;const Me=g0(D),rt=g0(N);if(!xu(Y)&&!isNaN(Y)){const Ee=p.valueAsNumber||Y&&+Y;xu(Me.value)||($e=Ee>Me.value),xu(rt.value)||(nt=Ee<rt.value)}else{const Ee=p.valueAsDate||new Date(Y),it=He=>new Date(new Date().toDateString()+" "+He),et=p.type=="time",mt=p.type=="week";Wp(Me.value)&&Y&&($e=et?it(Y)>it(Me.value):mt?Y>Me.value:Ee>new Date(Me.value)),Wp(rt.value)&&Y&&(nt=et?it(Y)<it(rt.value):mt?Y<rt.value:Ee<new Date(rt.value))}if(($e||nt)&&(Re(!!$e,Me.message,rt.message,dg.max,dg.min),!r))return ae(Z[B].message),Z}if((T||E)&&!Ce&&(Wp(Y)||f&&Array.isArray(Y))){const $e=g0(T),nt=g0(E),Me=!xu($e.value)&&Y.length>+$e.value,rt=!xu(nt.value)&&Y.length<+nt.value;if((Me||rt)&&(Re(Me,$e.message,nt.message),!r))return ae(Z[B].message),Z}if(V&&!Ce&&Wp(Y)){const{value:$e,message:nt}=g0(V);if(cj($e)&&!Y.match($e)&&(Z[B]={type:dg.pattern,message:nt,ref:p,...Ve(dg.pattern,nt)},!r))return ae(nt),Z}if($){if(Rf($)){const $e=await $(Y,n),nt=rU($e,X);if(nt&&(Z[B]={...nt,...Ve(dg.validate,nt.message)},!r))return ae(nt.message),Z}else if(pl($)){let $e={};for(const nt in $){if(!vu($e)&&!r)break;const Me=rU(await $[nt](Y,n),X,nt);Me&&($e={...Me,...Ve(nt,Me.message)},ae(Me.message),r&&(Z[B]=$e))}if(!vu($e)&&(Z[B]={ref:X,...$e},!r))return Z}}return ae(!0),Z};const Exe={mode:Ih.onSubmit,reValidateMode:Ih.onChange,shouldFocusError:!0};function Cxe(e={}){let t={...Exe,...e},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:Rf(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},r={},c=pl(t.defaultValues)||pl(t.values)?jo(t.defaultValues||t.values)||{}:{},f=t.shouldUnregister?{}:jo(c),p={action:!1,mount:!1,watch:!1},s={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},w,T=0;const E={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let N={...E};const D={array:Y6(),state:Y6()},V=t.criteriaMode===Ih.all,$=st=>qt=>{clearTimeout(T),T=setTimeout(st,qt)},B=async st=>{if(!t.disabled&&(E.isValid||N.isValid||st)){const qt=t.resolver?vu((await he()).errors):await Ce(r,!0);qt!==n.isValid&&D.state.next({isValid:qt})}},F=(st,qt)=>{!t.disabled&&(E.isValidating||E.validatingFields||N.isValidating||N.validatingFields)&&((st||Array.from(s.mount)).forEach(rn=>{rn&&(qt?Ka(n.validatingFields,rn,qt):dl(n.validatingFields,rn))}),D.state.next({validatingFields:n.validatingFields,isValidating:!vu(n.validatingFields)}))},K=(st,qt=[],rn,Wn,Vt=!0,un=!0)=>{if(Wn&&rn&&!t.disabled){if(p.action=!0,un&&Array.isArray(Br(r,st))){const hr=rn(Br(r,st),Wn.argA,Wn.argB);Vt&&Ka(r,st,hr)}if(un&&Array.isArray(Br(n.errors,st))){const hr=rn(Br(n.errors,st),Wn.argA,Wn.argB);Vt&&Ka(n.errors,st,hr),jxe(n.errors,st)}if((E.touchedFields||N.touchedFields)&&un&&Array.isArray(Br(n.touchedFields,st))){const hr=rn(Br(n.touchedFields,st),Wn.argA,Wn.argB);Vt&&Ka(n.touchedFields,st,hr)}(E.dirtyFields||N.dirtyFields)&&(n.dirtyFields=u1(c,f)),D.state.next({name:st,isDirty:Re(st,qt),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else Ka(f,st,qt)},Y=(st,qt)=>{Ka(n.errors,st,qt),D.state.next({errors:n.errors})},X=st=>{n.errors=st,D.state.next({errors:n.errors,isValid:!1})},ae=(st,qt,rn,Wn)=>{const Vt=Br(r,st);if(Vt){const un=Br(f,st,No(rn)?Br(c,st):rn);No(un)||Wn&&Wn.defaultChecked||qt?Ka(f,st,qt?un:eU(Vt._f)):Me(st,un),p.mount&&B()}},Z=(st,qt,rn,Wn,Vt)=>{let un=!1,hr=!1;const $t={name:st};if(!t.disabled){if(!rn||Wn){(E.isDirty||N.isDirty)&&(hr=n.isDirty,n.isDirty=$t.isDirty=Re(),un=hr!==$t.isDirty);const lr=pg(Br(c,st),qt);hr=!!Br(n.dirtyFields,st),lr?dl(n.dirtyFields,st):Ka(n.dirtyFields,st,!0),$t.dirtyFields=n.dirtyFields,un=un||(E.dirtyFields||N.dirtyFields)&&hr!==!lr}if(rn){const lr=Br(n.touchedFields,st);lr||(Ka(n.touchedFields,st,rn),$t.touchedFields=n.touchedFields,un=un||(E.touchedFields||N.touchedFields)&&lr!==rn)}un&&Vt&&D.state.next($t)}return un?$t:{}},se=(st,qt,rn,Wn)=>{const Vt=Br(n.errors,st),un=(E.isValid||N.isValid)&&qd(qt)&&n.isValid!==qt;if(t.delayError&&rn?(w=$(()=>Y(st,rn)),w(t.delayError)):(clearTimeout(T),w=null,rn?Ka(n.errors,st,rn):dl(n.errors,st)),(rn?!pg(Vt,rn):Vt)||!vu(Wn)||un){const hr={...Wn,...un&&qd(qt)?{isValid:qt}:{},errors:n.errors,name:st};n={...n,...hr},D.state.next(hr)}},he=async st=>{F(st,!0);const qt=await t.resolver(f,t.context,_xe(st||s.mount,r,t.criteriaMode,t.shouldUseNativeValidation));return F(st),qt},ye=async st=>{const{errors:qt}=await he(st);if(st)for(const rn of st){const Wn=Br(qt,rn);Wn?Ka(n.errors,rn,Wn):dl(n.errors,rn)}else n.errors=qt;return qt},Ce=async(st,qt,rn={valid:!0})=>{for(const Wn in st){const Vt=st[Wn];if(Vt){const{_f:un,...hr}=Vt;if(un){const $t=s.array.has(un.name),lr=Vt._f&&bxe(Vt._f);lr&&E.validatingFields&&F([Wn],!0);const ze=await Hk(Vt,s.disabled,f,V,t.shouldUseNativeValidation&&!qt,$t);if(lr&&E.validatingFields&&F([Wn]),ze[un.name]&&(rn.valid=!1,qt))break;!qt&&(Br(ze,un.name)?$t?DY(n.errors,ze,un.name):Ka(n.errors,un.name,ze[un.name]):dl(n.errors,un.name))}!vu(hr)&&await Ce(hr,qt,rn)}}return rn.valid},Ve=()=>{for(const st of s.unMount){const qt=Br(r,st);qt&&(qt._f.refs?qt._f.refs.every(rn=>!zP(rn)):!zP(qt._f.ref))&&Mt(st)}s.unMount=new Set},Re=(st,qt)=>!t.disabled&&(st&&qt&&Ka(f,st,qt),!pg(He(),c)),$e=(st,qt,rn)=>EY(st,s,{...p.mount?f:No(qt)?c:Wp(st)?{[st]:qt}:qt},rn,qt),nt=st=>lC(Br(p.mount?f:c,st,t.shouldUnregister?Br(c,st,[]):[])),Me=(st,qt,rn={})=>{const Wn=Br(r,st);let Vt=qt;if(Wn){const un=Wn._f;un&&(!un.disabled&&Ka(f,st,RY(qt,un)),Vt=oj(un.ref)&&xu(qt)?"":qt,CY(un.ref)?[...un.ref.options].forEach(hr=>hr.selected=Vt.includes(hr.value)):un.refs?mT(un.ref)?un.refs.forEach(hr=>{(!hr.defaultChecked||!hr.disabled)&&(Array.isArray(Vt)?hr.checked=!!Vt.find($t=>$t===hr.value):hr.checked=Vt===hr.value||!!Vt)}):un.refs.forEach(hr=>hr.checked=hr.value===Vt):L3(un.ref)?un.ref.value="":(un.ref.value=Vt,un.ref.type||D.state.next({name:st,values:jo(f)})))}(rn.shouldDirty||rn.shouldTouch)&&Z(st,Vt,rn.shouldTouch,rn.shouldDirty,!0),rn.shouldValidate&&mt(st)},rt=(st,qt,rn)=>{for(const Wn in qt){if(!qt.hasOwnProperty(Wn))return;const Vt=qt[Wn],un=st+"."+Wn,hr=Br(r,un);(s.array.has(st)||pl(Vt)||hr&&!hr._f)&&!Dx(Vt)?rt(un,Vt,rn):Me(un,Vt,rn)}},Ee=(st,qt,rn={})=>{const Wn=Br(r,st),Vt=s.array.has(st),un=jo(qt);Ka(f,st,un),Vt?(D.array.next({name:st,values:jo(f)}),(E.isDirty||E.dirtyFields||N.isDirty||N.dirtyFields)&&rn.shouldDirty&&D.state.next({name:st,dirtyFields:u1(c,f),isDirty:Re(st,un)})):Wn&&!Wn._f&&!xu(un)?rt(st,un,rn):Me(st,un,rn),qk(st,s)&&D.state.next({...n,name:st}),D.state.next({name:p.mount?st:void 0,values:jo(f)})},it=async st=>{p.mount=!0;const qt=st.target;let rn=qt.name,Wn=!0;const Vt=Br(r,rn),un=lr=>{Wn=Number.isNaN(lr)||Dx(lr)&&isNaN(lr.getTime())||pg(lr,Br(f,rn,lr))},hr=A0(t.mode),$t=A0(t.reValidateMode);if(Vt){let lr,ze;const Fe=qt.type?eU(Vt._f):SY(st),jn=st.type===aj.BLUR||st.type===aj.FOCUS_OUT,Xn=!wxe(Vt._f)&&!t.resolver&&!Br(n.errors,rn)&&!Vt._f.deps||Axe(jn,Br(n.touchedFields,rn),n.isSubmitted,$t,hr),mr=qk(rn,s,jn);Ka(f,rn,Fe),jn?(!qt||!qt.readOnly)&&(Vt._f.onBlur&&Vt._f.onBlur(st),w&&w(0)):Vt._f.onChange&&Vt._f.onChange(st);const Ur=Z(rn,Fe,jn),yi=!vu(Ur)||mr;if(!jn&&D.state.next({name:rn,type:st.type,values:jo(f)}),Xn)return(E.isValid||N.isValid)&&(t.mode==="onBlur"?jn&&B():jn||B()),yi&&D.state.next({name:rn,...mr?{}:Ur});if(!jn&&mr&&D.state.next({...n}),t.resolver){const{errors:Hi}=await he([rn]);if(un(Fe),Wn){const xr=nU(n.errors,r,rn),dr=nU(Hi,r,xr.name||rn);lr=dr.error,rn=dr.name,ze=vu(Hi)}}else F([rn],!0),lr=(await Hk(Vt,s.disabled,f,V,t.shouldUseNativeValidation))[rn],F([rn]),un(Fe),Wn&&(lr?ze=!1:(E.isValid||N.isValid)&&(ze=await Ce(r,!0)));Wn&&(Vt._f.deps&&mt(Vt._f.deps),se(rn,ze,lr,Ur))}},et=(st,qt)=>{if(Br(n.errors,qt)&&st.focus)return st.focus(),1},mt=async(st,qt={})=>{let rn,Wn;const Vt=Yu(st);if(t.resolver){const un=await ye(No(st)?st:Vt);rn=vu(un),Wn=st?!Vt.some(hr=>Br(un,hr)):rn}else st?(Wn=(await Promise.all(Vt.map(async un=>{const hr=Br(r,un);return await Ce(hr&&hr._f?{[un]:hr}:hr)}))).every(Boolean),!(!Wn&&!n.isValid)&&B()):Wn=rn=await Ce(r);return D.state.next({...!Wp(st)||(E.isValid||N.isValid)&&rn!==n.isValid?{}:{name:st},...t.resolver||!st?{isValid:rn}:{},errors:n.errors}),qt.shouldFocus&&!Wn&&B0(r,et,st?Vt:s.mount),Wn},He=st=>{const qt={...p.mount?f:c};return No(st)?qt:Wp(st)?Br(qt,st):st.map(rn=>Br(qt,rn))},pt=(st,qt)=>({invalid:!!Br((qt||n).errors,st),isDirty:!!Br((qt||n).dirtyFields,st),error:Br((qt||n).errors,st),isValidating:!!Br(n.validatingFields,st),isTouched:!!Br((qt||n).touchedFields,st)}),We=st=>{st&&Yu(st).forEach(qt=>dl(n.errors,qt)),D.state.next({errors:st?n.errors:{}})},Je=(st,qt,rn)=>{const Wn=(Br(r,st,{_f:{}})._f||{}).ref,Vt=Br(n.errors,st)||{},{ref:un,message:hr,type:$t,...lr}=Vt;Ka(n.errors,st,{...lr,...qt,ref:Wn}),D.state.next({name:st,errors:n.errors,isValid:!1}),rn&&rn.shouldFocus&&Wn&&Wn.focus&&Wn.focus()},jt=(st,qt)=>Rf(st)?D.state.subscribe({next:rn=>"values"in rn&&st($e(void 0,qt),rn)}):$e(st,qt,!0),Pt=st=>D.state.subscribe({next:qt=>{Txe(st.name,qt.name,st.exact)&&Sxe(qt,st.formState||E,Nn,st.reRenderRoot)&&st.callback({values:{...f},...n,...qt,defaultValues:c})}}).unsubscribe,Ot=st=>(p.mount=!0,N={...N,...st.formState},Pt({...st,formState:N})),Mt=(st,qt={})=>{for(const rn of st?Yu(st):s.mount)s.mount.delete(rn),s.array.delete(rn),qt.keepValue||(dl(r,rn),dl(f,rn)),!qt.keepError&&dl(n.errors,rn),!qt.keepDirty&&dl(n.dirtyFields,rn),!qt.keepTouched&&dl(n.touchedFields,rn),!qt.keepIsValidating&&dl(n.validatingFields,rn),!t.shouldUnregister&&!qt.keepDefaultValue&&dl(c,rn);D.state.next({values:jo(f)}),D.state.next({...n,...qt.keepDirty?{isDirty:Re()}:{}}),!qt.keepIsValid&&B()},an=({disabled:st,name:qt})=>{(qd(st)&&p.mount||st||s.disabled.has(qt))&&(st?s.disabled.add(qt):s.disabled.delete(qt))},Jt=(st,qt={})=>{let rn=Br(r,st);const Wn=qd(qt.disabled)||qd(t.disabled);return Ka(r,st,{...rn||{},_f:{...rn&&rn._f?rn._f:{ref:{name:st}},name:st,mount:!0,...qt}}),s.mount.add(st),rn?an({disabled:qd(qt.disabled)?qt.disabled:t.disabled,name:st}):ae(st,!0,qt.value),{...Wn?{disabled:qt.disabled||t.disabled}:{},...t.progressive?{required:!!qt.required,min:d1(qt.min),max:d1(qt.max),minLength:d1(qt.minLength),maxLength:d1(qt.maxLength),pattern:d1(qt.pattern)}:{},name:st,onChange:it,onBlur:it,ref:Vt=>{if(Vt){Jt(st,qt),rn=Br(r,st);const un=No(Vt.value)&&Vt.querySelectorAll&&Vt.querySelectorAll("input,select,textarea")[0]||Vt,hr=yxe(un),$t=rn._f.refs||[];if(hr?$t.find(lr=>lr===un):un===rn._f.ref)return;Ka(r,st,{_f:{...rn._f,...hr?{refs:[...$t.filter(zP),un,...Array.isArray(Br(c,st))?[{}]:[]],ref:{type:un.type,name:st}}:{ref:un}}}),ae(st,!1,void 0,un)}else rn=Br(r,st,{}),rn._f&&(rn._f.mount=!1),(t.shouldUnregister||qt.shouldUnregister)&&!(TY(s.array,st)&&p.action)&&s.unMount.add(st)}}},Cn=()=>t.shouldFocusError&&B0(r,et,s.mount),nr=st=>{qd(st)&&(D.state.next({disabled:st}),B0(r,(qt,rn)=>{const Wn=Br(r,rn);Wn&&(qt.disabled=Wn._f.disabled||st,Array.isArray(Wn._f.refs)&&Wn._f.refs.forEach(Vt=>{Vt.disabled=Wn._f.disabled||st}))},0,!1))},sn=(st,qt)=>async rn=>{let Wn;rn&&(rn.preventDefault&&rn.preventDefault(),rn.persist&&rn.persist());let Vt=jo(f);if(D.state.next({isSubmitting:!0}),t.resolver){const{errors:un,values:hr}=await he();n.errors=un,Vt=jo(hr)}else await Ce(r);if(s.disabled.size)for(const un of s.disabled)dl(Vt,un);if(dl(n.errors,"root"),vu(n.errors)){D.state.next({errors:{}});try{await st(Vt,rn)}catch(un){Wn=un}}else qt&&await qt({...n.errors},rn),Cn(),setTimeout(Cn);if(D.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:vu(n.errors)&&!Wn,submitCount:n.submitCount+1,errors:n.errors}),Wn)throw Wn},zr=(st,qt={})=>{Br(r,st)&&(No(qt.defaultValue)?Ee(st,jo(Br(c,st))):(Ee(st,qt.defaultValue),Ka(c,st,jo(qt.defaultValue))),qt.keepTouched||dl(n.touchedFields,st),qt.keepDirty||(dl(n.dirtyFields,st),n.isDirty=qt.defaultValue?Re(st,jo(Br(c,st))):Re()),qt.keepError||(dl(n.errors,st),E.isValid&&B()),D.state.next({...n}))},or=(st,qt={})=>{const rn=st?jo(st):c,Wn=jo(rn),Vt=vu(st),un=Vt?c:Wn;if(qt.keepDefaultValues||(c=rn),!qt.keepValues){if(qt.keepDirtyValues){const hr=new Set([...s.mount,...Object.keys(u1(c,f))]);for(const $t of Array.from(hr))Br(n.dirtyFields,$t)?Ka(un,$t,Br(f,$t)):Ee($t,Br(un,$t))}else{if(k3&&No(st))for(const hr of s.mount){const $t=Br(r,hr);if($t&&$t._f){const lr=Array.isArray($t._f.refs)?$t._f.refs[0]:$t._f.ref;if(oj(lr)){const ze=lr.closest("form");if(ze){ze.reset();break}}}}if(qt.keepFieldsRef)for(const hr of s.mount)Ee(hr,Br(un,hr));else r={}}f=t.shouldUnregister?qt.keepDefaultValues?jo(c):{}:jo(un),D.array.next({values:{...un}}),D.state.next({values:{...un}})}s={mount:qt.keepDirtyValues?s.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},p.mount=!E.isValid||!!qt.keepIsValid||!!qt.keepDirtyValues,p.watch=!!t.shouldUnregister,D.state.next({submitCount:qt.keepSubmitCount?n.submitCount:0,isDirty:Vt?!1:qt.keepDirty?n.isDirty:!!(qt.keepDefaultValues&&!pg(st,c)),isSubmitted:qt.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:Vt?{}:qt.keepDirtyValues?qt.keepDefaultValues&&f?u1(c,f):n.dirtyFields:qt.keepDefaultValues&&st?u1(c,st):qt.keepDirty?n.dirtyFields:{},touchedFields:qt.keepTouched?n.touchedFields:{},errors:qt.keepErrors?n.errors:{},isSubmitSuccessful:qt.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:c})},Rr=(st,qt)=>or(Rf(st)?st(f):st,qt),qr=(st,qt={})=>{const rn=Br(r,st),Wn=rn&&rn._f;if(Wn){const Vt=Wn.refs?Wn.refs[0]:Wn.ref;Vt.focus&&(Vt.focus(),qt.shouldSelect&&Rf(Vt.select)&&Vt.select())}},Nn=st=>{n={...n,...st}},ui={control:{register:Jt,unregister:Mt,getFieldState:pt,handleSubmit:sn,setError:Je,_subscribe:Pt,_runSchema:he,_focusError:Cn,_getWatch:$e,_getDirty:Re,_setValid:B,_setFieldArray:K,_setDisabledField:an,_setErrors:X,_getFieldArray:nt,_reset:or,_resetDefaultValues:()=>Rf(t.defaultValues)&&t.defaultValues().then(st=>{Rr(st,t.resetOptions),D.state.next({isLoading:!1})}),_removeUnmounted:Ve,_disableForm:nr,_subjects:D,_proxyFormState:E,get _fields(){return r},get _formValues(){return f},get _state(){return p},set _state(st){p=st},get _defaultValues(){return c},get _names(){return s},set _names(st){s=st},get _formState(){return n},get _options(){return t},set _options(st){t={...t,...st}}},subscribe:Ot,trigger:mt,register:Jt,handleSubmit:sn,watch:jt,setValue:Ee,getValues:He,reset:Rr,resetField:zr,clearErrors:We,unregister:Mt,setError:Je,setFocus:qr,getFieldState:pt};return{...ui,formControl:ui}}var Fy=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const e=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const n=(Math.random()*16+e)%16|0;return(t=="x"?n:n&3|8).toString(16)})},FP=(e,t,n={})=>n.shouldFocus||No(n.shouldFocus)?n.focusName||`${e}.${No(n.focusIndex)?t:n.focusIndex}.`:"",BP=(e,t)=>[...e,...Yu(t)],UP=e=>Array.isArray(e)?e.map(()=>{}):void 0;function VP(e,t,n){return[...e.slice(0,t),...Yu(n),...e.slice(t)]}var $P=(e,t,n)=>Array.isArray(e)?(No(e[n])&&(e[n]=void 0),e.splice(n,0,e.splice(t,1)[0]),e):[],qP=(e,t)=>[...Yu(t),...Yu(e)];function Nxe(e,t){let n=0;const r=[...e];for(const c of t)r.splice(c-n,1),n++;return lC(r).length?r:[]}var HP=(e,t)=>No(t)?[]:Nxe(e,Yu(t).sort((n,r)=>n-r)),GP=(e,t,n)=>{[e[t],e[n]]=[e[n],e[t]]},iU=(e,t,n)=>(e[t]=n,e);function sU(e){const t=cC(),{control:n=t.control,name:r,keyName:c="id",shouldUnregister:f,rules:p}=e,[s,w]=_e.useState(n._getFieldArray(r)),T=_e.useRef(n._getFieldArray(r).map(Fy)),E=_e.useRef(s),N=_e.useRef(!1);E.current=s,n._names.array.add(r),_e.useMemo(()=>p&&n.register(r,p),[n,p,r]),uC(()=>n._subjects.array.subscribe({next:({values:Z,name:se})=>{if(se===r||!se){const he=Br(Z,r);Array.isArray(he)&&(w(he),T.current=he.map(Fy))}}}).unsubscribe,[n,r]);const D=_e.useCallback(Z=>{N.current=!0,n._setFieldArray(r,Z)},[n,r]),V=(Z,se)=>{const he=Yu(jo(Z)),ye=BP(n._getFieldArray(r),he);n._names.focus=FP(r,ye.length-1,se),T.current=BP(T.current,he.map(Fy)),D(ye),w(ye),n._setFieldArray(r,ye,BP,{argA:UP(Z)})},$=(Z,se)=>{const he=Yu(jo(Z)),ye=qP(n._getFieldArray(r),he);n._names.focus=FP(r,0,se),T.current=qP(T.current,he.map(Fy)),D(ye),w(ye),n._setFieldArray(r,ye,qP,{argA:UP(Z)})},B=Z=>{const se=HP(n._getFieldArray(r),Z);T.current=HP(T.current,Z),D(se),w(se),!Array.isArray(Br(n._fields,r))&&Ka(n._fields,r,void 0),n._setFieldArray(r,se,HP,{argA:Z})},F=(Z,se,he)=>{const ye=Yu(jo(se)),Ce=VP(n._getFieldArray(r),Z,ye);n._names.focus=FP(r,Z,he),T.current=VP(T.current,Z,ye.map(Fy)),D(Ce),w(Ce),n._setFieldArray(r,Ce,VP,{argA:Z,argB:UP(se)})},K=(Z,se)=>{const he=n._getFieldArray(r);GP(he,Z,se),GP(T.current,Z,se),D(he),w(he),n._setFieldArray(r,he,GP,{argA:Z,argB:se},!1)},Y=(Z,se)=>{const he=n._getFieldArray(r);$P(he,Z,se),$P(T.current,Z,se),D(he),w(he),n._setFieldArray(r,he,$P,{argA:Z,argB:se},!1)},X=(Z,se)=>{const he=jo(se),ye=iU(n._getFieldArray(r),Z,he);T.current=[...ye].map((Ce,Ve)=>!Ce||Ve===Z?Fy():T.current[Ve]),D(ye),w([...ye]),n._setFieldArray(r,ye,iU,{argA:Z,argB:he},!0,!1)},ae=Z=>{const se=Yu(jo(Z));T.current=se.map(Fy),D([...se]),w([...se]),n._setFieldArray(r,[...se],he=>he,{},!0,!1)};return _e.useEffect(()=>{if(n._state.action=!1,qk(r,n._names)&&n._subjects.state.next({...n._formState}),N.current&&(!A0(n._options.mode).isOnSubmit||n._formState.isSubmitted)&&!A0(n._options.reValidateMode).isOnSubmit)if(n._options.resolver)n._runSchema([r]).then(Z=>{const se=Br(Z.errors,r),he=Br(n._formState.errors,r);(he?!se&&he.type||se&&(he.type!==se.type||he.message!==se.message):se&&se.type)&&(se?Ka(n._formState.errors,r,se):dl(n._formState.errors,r),n._subjects.state.next({errors:n._formState.errors}))});else{const Z=Br(n._fields,r);Z&&Z._f&&!(A0(n._options.reValidateMode).isOnSubmit&&A0(n._options.mode).isOnSubmit)&&Hk(Z,n._names.disabled,n._formValues,n._options.criteriaMode===Ih.all,n._options.shouldUseNativeValidation,!0).then(se=>!vu(se)&&n._subjects.state.next({errors:DY(n._formState.errors,se,r)}))}n._subjects.state.next({name:r,values:jo(n._formValues)}),n._names.focus&&B0(n._fields,(Z,se)=>{if(n._names.focus&&se.startsWith(n._names.focus)&&Z.focus)return Z.focus(),1}),n._names.focus="",n._setValid(),N.current=!1},[s,r,n]),_e.useEffect(()=>(!Br(n._formValues,r)&&n._setFieldArray(r),()=>{const Z=(se,he)=>{const ye=Br(n._fields,se);ye&&ye._f&&(ye._f.mount=he)};n._options.shouldUnregister||f?n.unregister(r):Z(r,!1)}),[r,n,c,f]),{swap:_e.useCallback(K,[D,r,n]),move:_e.useCallback(Y,[D,r,n]),prepend:_e.useCallback($,[D,r,n]),append:_e.useCallback(V,[D,r,n]),remove:_e.useCallback(B,[D,r,n]),insert:_e.useCallback(F,[D,r,n]),update:_e.useCallback(X,[D,r,n]),replace:_e.useCallback(ae,[D,r,n]),fields:_e.useMemo(()=>s.map((Z,se)=>({...Z,[c]:T.current[se]||Fy()})),[s,c])}}function dv(e={}){const t=_e.useRef(void 0),n=_e.useRef(void 0),[r,c]=_e.useState({isDirty:!1,isValidating:!1,isLoading:Rf(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:Rf(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:r},e.defaultValues&&!Rf(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:p,...s}=Cxe(e);t.current={...s,formState:r}}const f=t.current.control;return f._options=e,uC(()=>{const p=f._subscribe({formState:f._proxyFormState,callback:()=>c({...f._formState}),reRenderRoot:!0});return c(s=>({...s,isReady:!0})),f._formState.isReady=!0,p},[f]),_e.useEffect(()=>f._disableForm(e.disabled),[f,e.disabled]),_e.useEffect(()=>{e.mode&&(f._options.mode=e.mode),e.reValidateMode&&(f._options.reValidateMode=e.reValidateMode)},[f,e.mode,e.reValidateMode]),_e.useEffect(()=>{e.errors&&(f._setErrors(e.errors),f._focusError())},[f,e.errors]),_e.useEffect(()=>{e.shouldUnregister&&f._subjects.state.next({values:f._getWatch()})},[f,e.shouldUnregister]),_e.useEffect(()=>{if(f._proxyFormState.isDirty){const p=f._getDirty();p!==r.isDirty&&f._subjects.state.next({isDirty:p})}},[f,r.isDirty]),_e.useEffect(()=>{e.values&&!pg(e.values,n.current)?(f._reset(e.values,{keepFieldsRef:!0,...f._options.resetOptions}),n.current=e.values,c(p=>({...p}))):f._resetDefaultValues()},[f,e.values]),_e.useEffect(()=>{f._state.mount||(f._setValid(),f._state.mount=!0),f._state.watch&&(f._state.watch=!1,f._subjects.state.next({...f._formState})),f._removeUnmounted()}),t.current.formState=jY(r,f),t.current}function Pxe({className:e,...t}){const{register:n,handleSubmit:r,formState:{errors:c,isSubmitting:f}}=dv(),p=z.useContext(Vh),s=p?.login,w=p?.loading;console.log("AuthContext available:",!!p),console.log("Login function available:",!!s),console.log("Auth loading:",w);const T=async E=>{if(w){console.log("Auth is still loading, please wait...");return}if(!s||typeof s!="function"){console.error("Login function is not available");return}try{await s(E)}catch(N){console.error("Login error:",N)}};return o.jsx("div",{className:Rn("flex flex-col gap-6",e),...t,children:o.jsxs(ni,{className:"py-10 px-5",children:[o.jsxs(Ns,{children:[o.jsx(us,{className:"text-center",children:"Login to your account"}),o.jsx(Nc,{className:"text-center",children:"Enter your email below to login to your account"})]}),o.jsx(qi,{children:o.jsx("form",{onSubmit:r(T),children:o.jsxs("div",{className:"flex flex-col gap-6",children:[o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsx(bt,{htmlFor:"email",children:"Email"}),o.jsx(On,{...n("email",{required:"Email is required"}),id:"email",type:"email",placeholder:"m@example.com",disabled:f}),c.email&&o.jsx(Jc,{className:"text-red-500",children:c.email.message})]}),o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsx("div",{className:"flex items-center",children:o.jsx(bt,{htmlFor:"password",children:"Password"})}),o.jsx(On,{...n("password",{required:"Password is required"}),id:"password",type:"password",disabled:f}),c.password&&o.jsx(Jc,{className:"text-red-500",children:c.password.message})]}),o.jsx("div",{className:"flex flex-col gap-3",children:o.jsx(kt,{disabled:f,type:"submit",className:"w-full",children:"Login"})})]})})})]})})}const kY=z.createContext({});function Mxe(e){const t=z.useRef(null);return t.current===null&&(t.current=e()),t.current}const F3=typeof window<"u",Rxe=F3?z.useLayoutEffect:z.useEffect,B3=z.createContext(null);function U3(e,t){e.indexOf(t)===-1&&e.push(t)}function V3(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const Cg=(e,t,n)=>n>t?t:n<e?e:n;let $3=()=>{};const Ng={},IY=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function LY(e){return typeof e=="object"&&e!==null}const zY=e=>/^0[^.\s]+$/u.test(e);function q3(e){let t;return()=>(t===void 0&&(t=e()),t)}const Bh=e=>e,Oxe=(e,t)=>n=>t(e(n)),gT=(...e)=>e.reduce(Oxe),rS=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r};class H3{constructor(){this.subscriptions=[]}add(t){return U3(this.subscriptions,t),()=>V3(this.subscriptions,t)}notify(t,n,r){const c=this.subscriptions.length;if(c)if(c===1)this.subscriptions[0](t,n,r);else for(let f=0;f<c;f++){const p=this.subscriptions[f];p&&p(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Qp=e=>e*1e3,em=e=>e/1e3;function FY(e,t){return t?e*(1e3/t):0}const BY=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,Dxe=1e-7,kxe=12;function Ixe(e,t,n,r,c){let f,p,s=0;do p=t+(n-t)/2,f=BY(p,r,c)-e,f>0?n=p:t=p;while(Math.abs(f)>Dxe&&++s<kxe);return p}function yT(e,t,n,r){if(e===t&&n===r)return Bh;const c=f=>Ixe(f,0,1,e,n);return f=>f===0||f===1?f:BY(c(f),t,r)}const UY=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,VY=e=>t=>1-e(1-t),$Y=yT(.33,1.53,.69,.99),G3=VY($Y),qY=UY(G3),HY=e=>(e*=2)<1?.5*G3(e):.5*(2-Math.pow(2,-10*(e-1))),W3=e=>1-Math.sin(Math.acos(e)),GY=VY(W3),WY=UY(W3),Lxe=yT(.42,0,1,1),zxe=yT(0,0,.58,1),XY=yT(.42,0,.58,1),Fxe=e=>Array.isArray(e)&&typeof e[0]!="number",ZY=e=>Array.isArray(e)&&typeof e[0]=="number",Bxe={linear:Bh,easeIn:Lxe,easeInOut:XY,easeOut:zxe,circIn:W3,circInOut:WY,circOut:GY,backIn:G3,backInOut:qY,backOut:$Y,anticipate:HY},Uxe=e=>typeof e=="string",aU=e=>{if(ZY(e)){$3(e.length===4);const[t,n,r,c]=e;return yT(t,n,r,c)}else if(Uxe(e))return Bxe[e];return e},sA=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Vxe(e,t){let n=new Set,r=new Set,c=!1,f=!1;const p=new WeakSet;let s={delta:0,timestamp:0,isProcessing:!1};function w(E){p.has(E)&&(T.schedule(E),e()),E(s)}const T={schedule:(E,N=!1,D=!1)=>{const $=D&&c?n:r;return N&&p.add(E),$.has(E)||$.add(E),E},cancel:E=>{r.delete(E),p.delete(E)},process:E=>{if(s=E,c){f=!0;return}c=!0,[n,r]=[r,n],n.forEach(w),n.clear(),c=!1,f&&(f=!1,T.process(E))}};return T}const $xe=40;function YY(e,t){let n=!1,r=!0;const c={delta:0,timestamp:0,isProcessing:!1},f=()=>n=!0,p=sA.reduce((X,ae)=>(X[ae]=Vxe(f),X),{}),{setup:s,read:w,resolveKeyframes:T,preUpdate:E,update:N,preRender:D,render:V,postRender:$}=p,B=()=>{const X=Ng.useManualTiming?c.timestamp:performance.now();n=!1,Ng.useManualTiming||(c.delta=r?1e3/60:Math.max(Math.min(X-c.timestamp,$xe),1)),c.timestamp=X,c.isProcessing=!0,s.process(c),w.process(c),T.process(c),E.process(c),N.process(c),D.process(c),V.process(c),$.process(c),c.isProcessing=!1,n&&t&&(r=!1,e(B))},F=()=>{n=!0,r=!0,c.isProcessing||e(B)};return{schedule:sA.reduce((X,ae)=>{const Z=p[ae];return X[ae]=(se,he=!1,ye=!1)=>(n||F(),Z.schedule(se,he,ye)),X},{}),cancel:X=>{for(let ae=0;ae<sA.length;ae++)p[sA[ae]].cancel(X)},state:c,steps:p}}const{schedule:Io,cancel:sv,state:jc,steps:WP}=YY(typeof requestAnimationFrame<"u"?requestAnimationFrame:Bh,!0);let kA;function qxe(){kA=void 0}const Ku={now:()=>(kA===void 0&&Ku.set(jc.isProcessing||Ng.useManualTiming?jc.timestamp:performance.now()),kA),set:e=>{kA=e,queueMicrotask(qxe)}},KY=e=>t=>typeof t=="string"&&t.startsWith(e),X3=KY("--"),Hxe=KY("var(--"),Z3=e=>Hxe(e)?Gxe.test(e.split("/*")[0].trim()):!1,Gxe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,zb={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},iS={...zb,transform:e=>Cg(0,1,e)},aA={...zb,default:1},L1=e=>Math.round(e*1e5)/1e5,Y3=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Wxe(e){return e==null}const Xxe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,K3=(e,t)=>n=>!!(typeof n=="string"&&Xxe.test(n)&&n.startsWith(e)||t&&!Wxe(n)&&Object.prototype.hasOwnProperty.call(n,t)),JY=(e,t,n)=>r=>{if(typeof r!="string")return r;const[c,f,p,s]=r.match(Y3);return{[e]:parseFloat(c),[t]:parseFloat(f),[n]:parseFloat(p),alpha:s!==void 0?parseFloat(s):1}},Zxe=e=>Cg(0,255,e),XP={...zb,transform:e=>Math.round(Zxe(e))},kx={test:K3("rgb","red"),parse:JY("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+XP.transform(e)+", "+XP.transform(t)+", "+XP.transform(n)+", "+L1(iS.transform(r))+")"};function Yxe(e){let t="",n="",r="",c="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),c=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),c=e.substring(4,5),t+=t,n+=n,r+=r,c+=c),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:c?parseInt(c,16)/255:1}}const Gk={test:K3("#"),parse:Yxe,transform:kx.transform},vT=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Vy=vT("deg"),tm=vT("%"),cs=vT("px"),Kxe=vT("vh"),Jxe=vT("vw"),oU={...tm,parse:e=>tm.parse(e)/100,transform:e=>tm.transform(e*100)},j0={test:K3("hsl","hue"),parse:JY("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+tm.transform(L1(t))+", "+tm.transform(L1(n))+", "+L1(iS.transform(r))+")"},Pl={test:e=>kx.test(e)||Gk.test(e)||j0.test(e),parse:e=>kx.test(e)?kx.parse(e):j0.test(e)?j0.parse(e):Gk.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?kx.transform(e):j0.transform(e),getAnimatableNone:e=>{const t=Pl.parse(e);return t.alpha=0,Pl.transform(t)}},Qxe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function e_e(e){return isNaN(e)&&typeof e=="string"&&(e.match(Y3)?.length||0)+(e.match(Qxe)?.length||0)>0}const QY="number",eK="color",t_e="var",n_e="var(",lU="${}",r_e=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function sS(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},c=[];let f=0;const s=t.replace(r_e,w=>(Pl.test(w)?(r.color.push(f),c.push(eK),n.push(Pl.parse(w))):w.startsWith(n_e)?(r.var.push(f),c.push(t_e),n.push(w)):(r.number.push(f),c.push(QY),n.push(parseFloat(w))),++f,lU)).split(lU);return{values:n,split:s,indexes:r,types:c}}function tK(e){return sS(e).values}function nK(e){const{split:t,types:n}=sS(e),r=t.length;return c=>{let f="";for(let p=0;p<r;p++)if(f+=t[p],c[p]!==void 0){const s=n[p];s===QY?f+=L1(c[p]):s===eK?f+=Pl.transform(c[p]):f+=c[p]}return f}}const i_e=e=>typeof e=="number"?0:Pl.test(e)?Pl.getAnimatableNone(e):e;function s_e(e){const t=tK(e);return nK(e)(t.map(i_e))}const av={test:e_e,parse:tK,createTransformer:nK,getAnimatableNone:s_e};function ZP(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function a_e({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let c=0,f=0,p=0;if(!t)c=f=p=n;else{const s=n<.5?n*(1+t):n+t-n*t,w=2*n-s;c=ZP(w,s,e+1/3),f=ZP(w,s,e),p=ZP(w,s,e-1/3)}return{red:Math.round(c*255),green:Math.round(f*255),blue:Math.round(p*255),alpha:r}}function uj(e,t){return n=>n>0?t:e}const Wo=(e,t,n)=>e+(t-e)*n,YP=(e,t,n)=>{const r=e*e,c=n*(t*t-r)+r;return c<0?0:Math.sqrt(c)},o_e=[Gk,kx,j0],l_e=e=>o_e.find(t=>t.test(e));function cU(e){const t=l_e(e);if(!t)return!1;let n=t.parse(e);return t===j0&&(n=a_e(n)),n}const uU=(e,t)=>{const n=cU(e),r=cU(t);if(!n||!r)return uj(e,t);const c={...n};return f=>(c.red=YP(n.red,r.red,f),c.green=YP(n.green,r.green,f),c.blue=YP(n.blue,r.blue,f),c.alpha=Wo(n.alpha,r.alpha,f),kx.transform(c))},Wk=new Set(["none","hidden"]);function c_e(e,t){return Wk.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function u_e(e,t){return n=>Wo(e,t,n)}function J3(e){return typeof e=="number"?u_e:typeof e=="string"?Z3(e)?uj:Pl.test(e)?uU:f_e:Array.isArray(e)?rK:typeof e=="object"?Pl.test(e)?uU:d_e:uj}function rK(e,t){const n=[...e],r=n.length,c=e.map((f,p)=>J3(f)(f,t[p]));return f=>{for(let p=0;p<r;p++)n[p]=c[p](f);return n}}function d_e(e,t){const n={...e,...t},r={};for(const c in n)e[c]!==void 0&&t[c]!==void 0&&(r[c]=J3(e[c])(e[c],t[c]));return c=>{for(const f in r)n[f]=r[f](c);return n}}function h_e(e,t){const n=[],r={color:0,var:0,number:0};for(let c=0;c<t.values.length;c++){const f=t.types[c],p=e.indexes[f][r[f]],s=e.values[p]??0;n[c]=s,r[f]++}return n}const f_e=(e,t)=>{const n=av.createTransformer(t),r=sS(e),c=sS(t);return r.indexes.var.length===c.indexes.var.length&&r.indexes.color.length===c.indexes.color.length&&r.indexes.number.length>=c.indexes.number.length?Wk.has(e)&&!c.values.length||Wk.has(t)&&!r.values.length?c_e(e,t):gT(rK(h_e(r,c),c.values),n):uj(e,t)};function iK(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?Wo(e,t,n):J3(e)(e,t)}const p_e=e=>{const t=({timestamp:n})=>e(n);return{start:(n=!0)=>Io.update(t,n),stop:()=>sv(t),now:()=>jc.isProcessing?jc.timestamp:Ku.now()}},sK=(e,t,n=10)=>{let r="";const c=Math.max(Math.round(t/n),2);for(let f=0;f<c;f++)r+=Math.round(e(f/(c-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},dj=2e4;function Q3(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<dj;)t+=n,r=e.next(t);return t>=dj?1/0:t}function m_e(e,t=100,n){const r=n({...e,keyframes:[0,t]}),c=Math.min(Q3(r),dj);return{type:"keyframes",ease:f=>r.next(c*f).value/t,duration:em(c)}}const g_e=5;function aK(e,t,n){const r=Math.max(t-g_e,0);return FY(n-e(r),t-r)}const el={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},KP=.001;function y_e({duration:e=el.duration,bounce:t=el.bounce,velocity:n=el.velocity,mass:r=el.mass}){let c,f,p=1-t;p=Cg(el.minDamping,el.maxDamping,p),e=Cg(el.minDuration,el.maxDuration,em(e)),p<1?(c=T=>{const E=T*p,N=E*e,D=E-n,V=Xk(T,p),$=Math.exp(-N);return KP-D/V*$},f=T=>{const N=T*p*e,D=N*n+n,V=Math.pow(p,2)*Math.pow(T,2)*e,$=Math.exp(-N),B=Xk(Math.pow(T,2),p);return(-c(T)+KP>0?-1:1)*((D-V)*$)/B}):(c=T=>{const E=Math.exp(-T*e),N=(T-n)*e+1;return-KP+E*N},f=T=>{const E=Math.exp(-T*e),N=(n-T)*(e*e);return E*N});const s=5/e,w=x_e(c,f,s);if(e=Qp(e),isNaN(w))return{stiffness:el.stiffness,damping:el.damping,duration:e};{const T=Math.pow(w,2)*r;return{stiffness:T,damping:p*2*Math.sqrt(r*T),duration:e}}}const v_e=12;function x_e(e,t,n){let r=n;for(let c=1;c<v_e;c++)r=r-e(r)/t(r);return r}function Xk(e,t){return e*Math.sqrt(1-t*t)}const __e=["duration","bounce"],b_e=["stiffness","damping","mass"];function dU(e,t){return t.some(n=>e[n]!==void 0)}function w_e(e){let t={velocity:el.velocity,stiffness:el.stiffness,damping:el.damping,mass:el.mass,isResolvedFromDuration:!1,...e};if(!dU(e,b_e)&&dU(e,__e))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),c=r*r,f=2*Cg(.05,1,1-(e.bounce||0))*Math.sqrt(c);t={...t,mass:el.mass,stiffness:c,damping:f}}else{const n=y_e(e);t={...t,...n,mass:el.mass},t.isResolvedFromDuration=!0}return t}function hj(e=el.visualDuration,t=el.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:c}=n;const f=n.keyframes[0],p=n.keyframes[n.keyframes.length-1],s={done:!1,value:f},{stiffness:w,damping:T,mass:E,duration:N,velocity:D,isResolvedFromDuration:V}=w_e({...n,velocity:-em(n.velocity||0)}),$=D||0,B=T/(2*Math.sqrt(w*E)),F=p-f,K=em(Math.sqrt(w/E)),Y=Math.abs(F)<5;r||(r=Y?el.restSpeed.granular:el.restSpeed.default),c||(c=Y?el.restDelta.granular:el.restDelta.default);let X;if(B<1){const Z=Xk(K,B);X=se=>{const he=Math.exp(-B*K*se);return p-he*(($+B*K*F)/Z*Math.sin(Z*se)+F*Math.cos(Z*se))}}else if(B===1)X=Z=>p-Math.exp(-K*Z)*(F+($+K*F)*Z);else{const Z=K*Math.sqrt(B*B-1);X=se=>{const he=Math.exp(-B*K*se),ye=Math.min(Z*se,300);return p-he*(($+B*K*F)*Math.sinh(ye)+Z*F*Math.cosh(ye))/Z}}const ae={calculatedDuration:V&&N||null,next:Z=>{const se=X(Z);if(V)s.done=Z>=N;else{let he=Z===0?$:0;B<1&&(he=Z===0?Qp($):aK(X,Z,se));const ye=Math.abs(he)<=r,Ce=Math.abs(p-se)<=c;s.done=ye&&Ce}return s.value=s.done?p:se,s},toString:()=>{const Z=Math.min(Q3(ae),dj),se=sK(he=>ae.next(Z*he).value,Z,30);return Z+"ms "+se},toTransition:()=>{}};return ae}hj.applyToOptions=e=>{const t=m_e(e,100,hj);return e.ease=t.ease,e.duration=Qp(t.duration),e.type="keyframes",e};function Zk({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:c=10,bounceStiffness:f=500,modifyTarget:p,min:s,max:w,restDelta:T=.5,restSpeed:E}){const N=e[0],D={done:!1,value:N},V=ye=>s!==void 0&&ye<s||w!==void 0&&ye>w,$=ye=>s===void 0?w:w===void 0||Math.abs(s-ye)<Math.abs(w-ye)?s:w;let B=n*t;const F=N+B,K=p===void 0?F:p(F);K!==F&&(B=K-N);const Y=ye=>-B*Math.exp(-ye/r),X=ye=>K+Y(ye),ae=ye=>{const Ce=Y(ye),Ve=X(ye);D.done=Math.abs(Ce)<=T,D.value=D.done?K:Ve};let Z,se;const he=ye=>{V(D.value)&&(Z=ye,se=hj({keyframes:[D.value,$(D.value)],velocity:aK(X,ye,D.value),damping:c,stiffness:f,restDelta:T,restSpeed:E}))};return he(0),{calculatedDuration:null,next:ye=>{let Ce=!1;return!se&&Z===void 0&&(Ce=!0,ae(ye),he(ye)),Z!==void 0&&ye>=Z?se.next(ye-Z):(!Ce&&ae(ye),D)}}}function S_e(e,t,n){const r=[],c=n||Ng.mix||iK,f=e.length-1;for(let p=0;p<f;p++){let s=c(e[p],e[p+1]);if(t){const w=Array.isArray(t)?t[p]||Bh:t;s=gT(w,s)}r.push(s)}return r}function T_e(e,t,{clamp:n=!0,ease:r,mixer:c}={}){const f=e.length;if($3(f===t.length),f===1)return()=>t[0];if(f===2&&t[0]===t[1])return()=>t[1];const p=e[0]===e[1];e[0]>e[f-1]&&(e=[...e].reverse(),t=[...t].reverse());const s=S_e(t,r,c),w=s.length,T=E=>{if(p&&E<e[0])return t[0];let N=0;if(w>1)for(;N<e.length-2&&!(E<e[N+1]);N++);const D=rS(e[N],e[N+1],E);return s[N](D)};return n?E=>T(Cg(e[0],e[f-1],E)):T}function A_e(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const c=rS(0,t,r);e.push(Wo(n,1,c))}}function j_e(e){const t=[0];return A_e(t,e.length-1),t}function E_e(e,t){return e.map(n=>n*t)}function C_e(e,t){return e.map(()=>t||XY).splice(0,e.length-1)}function z1({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const c=Fxe(r)?r.map(aU):aU(r),f={done:!1,value:t[0]},p=E_e(n&&n.length===t.length?n:j_e(t),e),s=T_e(p,t,{ease:Array.isArray(c)?c:C_e(t,c)});return{calculatedDuration:e,next:w=>(f.value=s(w),f.done=w>=e,f)}}const N_e=e=>e!==null;function ez(e,{repeat:t,repeatType:n="loop"},r,c=1){const f=e.filter(N_e),s=c<0||t&&n!=="loop"&&t%2===1?0:f.length-1;return!s||r===void 0?f[s]:r}const P_e={decay:Zk,inertia:Zk,tween:z1,keyframes:z1,spring:hj};function oK(e){typeof e.type=="string"&&(e.type=P_e[e.type])}class tz{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const M_e=e=>e/100;class nz extends tz{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;n&&n.updatedAt!==Ku.now()&&this.tick(Ku.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;oK(t);const{type:n=z1,repeat:r=0,repeatDelay:c=0,repeatType:f,velocity:p=0}=t;let{keyframes:s}=t;const w=n||z1;w!==z1&&typeof s[0]!="number"&&(this.mixKeyframes=gT(M_e,iK(s[0],s[1])),s=[0,100]);const T=w({...t,keyframes:s});f==="mirror"&&(this.mirroredGenerator=w({...t,keyframes:[...s].reverse(),velocity:-p})),T.calculatedDuration===null&&(T.calculatedDuration=Q3(T));const{calculatedDuration:E}=T;this.calculatedDuration=E,this.resolvedDuration=E+c,this.totalDuration=this.resolvedDuration*(r+1)-c,this.generator=T}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:r,totalDuration:c,mixKeyframes:f,mirroredGenerator:p,resolvedDuration:s,calculatedDuration:w}=this;if(this.startTime===null)return r.next(0);const{delay:T=0,keyframes:E,repeat:N,repeatType:D,repeatDelay:V,type:$,onUpdate:B,finalKeyframe:F}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-c/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const K=this.currentTime-T*(this.playbackSpeed>=0?1:-1),Y=this.playbackSpeed>=0?K<0:K>c;this.currentTime=Math.max(K,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=c);let X=this.currentTime,ae=r;if(N){const ye=Math.min(this.currentTime,c)/s;let Ce=Math.floor(ye),Ve=ye%1;!Ve&&ye>=1&&(Ve=1),Ve===1&&Ce--,Ce=Math.min(Ce,N+1),!!(Ce%2)&&(D==="reverse"?(Ve=1-Ve,V&&(Ve-=V/s)):D==="mirror"&&(ae=p)),X=Cg(0,1,Ve)*s}const Z=Y?{done:!1,value:E[0]}:ae.next(X);f&&(Z.value=f(Z.value));let{done:se}=Z;!Y&&w!==null&&(se=this.playbackSpeed>=0?this.currentTime>=c:this.currentTime<=0);const he=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&se);return he&&$!==Zk&&(Z.value=ez(E,this.options,F,this.speed)),B&&B(Z.value),he&&this.finish(),Z}then(t,n){return this.finished.then(t,n)}get duration(){return em(this.calculatedDuration)}get time(){return em(this.currentTime)}set time(t){t=Qp(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Ku.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=em(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=p_e,startTime:n}=this.options;this.driver||(this.driver=t(c=>this.tick(c))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ku.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function R_e(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Ix=e=>e*180/Math.PI,Yk=e=>{const t=Ix(Math.atan2(e[1],e[0]));return Kk(t)},O_e={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:Yk,rotateZ:Yk,skewX:e=>Ix(Math.atan(e[1])),skewY:e=>Ix(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},Kk=e=>(e=e%360,e<0&&(e+=360),e),hU=Yk,fU=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),pU=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),D_e={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:fU,scaleY:pU,scale:e=>(fU(e)+pU(e))/2,rotateX:e=>Kk(Ix(Math.atan2(e[6],e[5]))),rotateY:e=>Kk(Ix(Math.atan2(-e[2],e[0]))),rotateZ:hU,rotate:hU,skewX:e=>Ix(Math.atan(e[4])),skewY:e=>Ix(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function Jk(e){return e.includes("scale")?1:0}function Qk(e,t){if(!e||e==="none")return Jk(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,c;if(n)r=D_e,c=n;else{const s=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=O_e,c=s}if(!c)return Jk(t);const f=r[t],p=c[1].split(",").map(I_e);return typeof f=="function"?f(p):p[f]}const k_e=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return Qk(n,t)};function I_e(e){return parseFloat(e.trim())}const Fb=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Bb=new Set(Fb),mU=e=>e===zb||e===cs,L_e=new Set(["x","y","z"]),z_e=Fb.filter(e=>!L_e.has(e));function F_e(e){const t=[];return z_e.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const Hx={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>Qk(t,"x"),y:(e,{transform:t})=>Qk(t,"y")};Hx.translateX=Hx.x;Hx.translateY=Hx.y;const Gx=new Set;let eI=!1,tI=!1,nI=!1;function lK(){if(tI){const e=Array.from(Gx).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const c=F_e(r);c.length&&(n.set(r,c),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const c=n.get(r);c&&c.forEach(([f,p])=>{r.getValue(f)?.set(p)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}tI=!1,eI=!1,Gx.forEach(e=>e.complete(nI)),Gx.clear()}function cK(){Gx.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(tI=!0)})}function B_e(){nI=!0,cK(),lK(),nI=!1}class rz{constructor(t,n,r,c,f,p=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=c,this.element=f,this.isAsync=p}scheduleResolve(){this.state="scheduled",this.isAsync?(Gx.add(this),eI||(eI=!0,Io.read(cK),Io.resolveKeyframes(lK))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:c}=this;if(t[0]===null){const f=c?.get(),p=t[t.length-1];if(f!==void 0)t[0]=f;else if(r&&n){const s=r.readValue(n,p);s!=null&&(t[0]=s)}t[0]===void 0&&(t[0]=p),c&&f===void 0&&c.set(t[0])}R_e(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Gx.delete(this)}cancel(){this.state==="scheduled"&&(Gx.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const U_e=e=>e.startsWith("--");function V_e(e,t,n){U_e(t)?e.style.setProperty(t,n):e.style[t]=n}const $_e=q3(()=>window.ScrollTimeline!==void 0),q_e={};function H_e(e,t){const n=q3(e);return()=>q_e[t]??n()}const uK=H_e(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),P1=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,gU={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:P1([0,.65,.55,1]),circOut:P1([.55,0,1,.45]),backIn:P1([.31,.01,.66,-.59]),backOut:P1([.33,1.53,.69,.99])};function dK(e,t){if(e)return typeof e=="function"?uK()?sK(e,t):"ease-out":ZY(e)?P1(e):Array.isArray(e)?e.map(n=>dK(n,t)||gU.easeOut):gU[e]}function G_e(e,t,n,{delay:r=0,duration:c=300,repeat:f=0,repeatType:p="loop",ease:s="easeOut",times:w}={},T=void 0){const E={[t]:n};w&&(E.offset=w);const N=dK(s,c);Array.isArray(N)&&(E.easing=N);const D={delay:r,duration:c,easing:Array.isArray(N)?"linear":N,fill:"both",iterations:f+1,direction:p==="reverse"?"alternate":"normal"};return T&&(D.pseudoElement=T),e.animate(E,D)}function hK(e){return typeof e=="function"&&"applyToOptions"in e}function W_e({type:e,...t}){return hK(e)&&uK()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class X_e extends tz{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:r,keyframes:c,pseudoElement:f,allowFlatten:p=!1,finalKeyframe:s,onComplete:w}=t;this.isPseudoElement=!!f,this.allowFlatten=p,this.options=t,$3(typeof t.type!="string");const T=W_e(t);this.animation=G_e(n,r,c,T,f),T.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!f){const E=ez(c,this.options,s,this.speed);this.updateMotionValue?this.updateMotionValue(E):V_e(n,r,E),this.animation.cancel()}w?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return em(Number(t))}get time(){return em(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Qp(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&$_e()?(this.animation.timeline=t,Bh):n(this)}}const fK={anticipate:HY,backInOut:qY,circInOut:WY};function Z_e(e){return e in fK}function Y_e(e){typeof e.ease=="string"&&Z_e(e.ease)&&(e.ease=fK[e.ease])}const yU=10;class K_e extends X_e{constructor(t){Y_e(t),oK(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:r,onComplete:c,element:f,...p}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const s=new nz({...p,autoplay:!1}),w=Qp(this.finishedTime??this.time);n.setWithVelocity(s.sample(w-yU).value,s.sample(w).value,yU),s.stop()}}const vU=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(av.test(e)||e==="0")&&!e.startsWith("url("));function J_e(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function Q_e(e,t,n,r){const c=e[0];if(c===null)return!1;if(t==="display"||t==="visibility")return!0;const f=e[e.length-1],p=vU(c,t),s=vU(f,t);return!p||!s?!1:J_e(e)||(n==="spring"||hK(n))&&r}function rI(e){e.duration=0,e.type}const e0e=new Set(["opacity","clipPath","filter","transform"]),t0e=q3(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function n0e(e){const{motionValue:t,name:n,repeatDelay:r,repeatType:c,damping:f,type:p}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:w,transformTemplate:T}=t.owner.getProps();return t0e()&&n&&e0e.has(n)&&(n!=="transform"||!T)&&!w&&!r&&c!=="mirror"&&f!==0&&p!=="inertia"}const r0e=40;class i0e extends tz{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:c=0,repeatDelay:f=0,repeatType:p="loop",keyframes:s,name:w,motionValue:T,element:E,...N}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Ku.now();const D={autoplay:t,delay:n,type:r,repeat:c,repeatDelay:f,repeatType:p,name:w,motionValue:T,element:E,...N},V=E?.KeyframeResolver||rz;this.keyframeResolver=new V(s,($,B,F)=>this.onKeyframesResolved($,B,D,!F),w,T,E),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,n,r,c){this.keyframeResolver=void 0;const{name:f,type:p,velocity:s,delay:w,isHandoff:T,onUpdate:E}=r;this.resolvedAt=Ku.now(),Q_e(t,f,p,s)||((Ng.instantAnimations||!w)&&E?.(ez(t,r,n)),t[0]=t[t.length-1],rI(r),r.repeat=0);const D={startTime:c?this.resolvedAt?this.resolvedAt-this.createdAt>r0e?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:t},V=!T&&n0e(D)?new K_e({...D,element:D.motionValue.owner.current}):new nz(D);V.finished.then(()=>this.notifyFinished()).catch(Bh),this.pendingTimeline&&(this.stopTimeline=V.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=V}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),B_e()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const s0e=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function a0e(e){const t=s0e.exec(e);if(!t)return[,];const[,n,r,c]=t;return[`--${n??r}`,c]}function pK(e,t,n=1){const[r,c]=a0e(e);if(!r)return;const f=window.getComputedStyle(t).getPropertyValue(r);if(f){const p=f.trim();return IY(p)?parseFloat(p):p}return Z3(c)?pK(c,t,n+1):c}function iz(e,t){return e?.[t]??e?.default??e}const mK=new Set(["width","height","top","left","right","bottom",...Fb]),o0e={test:e=>e==="auto",parse:e=>e},gK=e=>t=>t.test(e),yK=[zb,cs,tm,Vy,Jxe,Kxe,o0e],xU=e=>yK.find(gK(e));function l0e(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||zY(e):!0}const c0e=new Set(["brightness","contrast","saturate","opacity"]);function u0e(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(Y3)||[];if(!r)return e;const c=n.replace(r,"");let f=c0e.has(t)?1:0;return r!==n&&(f*=100),t+"("+f+c+")"}const d0e=/\b([a-z-]*)\(.*?\)/gu,iI={...av,getAnimatableNone:e=>{const t=e.match(d0e);return t?t.map(u0e).join(" "):e}},_U={...zb,transform:Math.round},h0e={rotate:Vy,rotateX:Vy,rotateY:Vy,rotateZ:Vy,scale:aA,scaleX:aA,scaleY:aA,scaleZ:aA,skew:Vy,skewX:Vy,skewY:Vy,distance:cs,translateX:cs,translateY:cs,translateZ:cs,x:cs,y:cs,z:cs,perspective:cs,transformPerspective:cs,opacity:iS,originX:oU,originY:oU,originZ:cs},sz={borderWidth:cs,borderTopWidth:cs,borderRightWidth:cs,borderBottomWidth:cs,borderLeftWidth:cs,borderRadius:cs,radius:cs,borderTopLeftRadius:cs,borderTopRightRadius:cs,borderBottomRightRadius:cs,borderBottomLeftRadius:cs,width:cs,maxWidth:cs,height:cs,maxHeight:cs,top:cs,right:cs,bottom:cs,left:cs,padding:cs,paddingTop:cs,paddingRight:cs,paddingBottom:cs,paddingLeft:cs,margin:cs,marginTop:cs,marginRight:cs,marginBottom:cs,marginLeft:cs,backgroundPositionX:cs,backgroundPositionY:cs,...h0e,zIndex:_U,fillOpacity:iS,strokeOpacity:iS,numOctaves:_U},f0e={...sz,color:Pl,backgroundColor:Pl,outlineColor:Pl,fill:Pl,stroke:Pl,borderColor:Pl,borderTopColor:Pl,borderRightColor:Pl,borderBottomColor:Pl,borderLeftColor:Pl,filter:iI,WebkitFilter:iI},vK=e=>f0e[e];function xK(e,t){let n=vK(e);return n!==iI&&(n=av),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const p0e=new Set(["auto","none","0"]);function m0e(e,t,n){let r=0,c;for(;r<e.length&&!c;){const f=e[r];typeof f=="string"&&!p0e.has(f)&&sS(f).values.length&&(c=e[r]),r++}if(c&&n)for(const f of t)e[f]=xK(n,c)}class g0e extends rz{constructor(t,n,r,c,f){super(t,n,r,c,f,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let w=0;w<t.length;w++){let T=t[w];if(typeof T=="string"&&(T=T.trim(),Z3(T))){const E=pK(T,n.current);E!==void 0&&(t[w]=E),w===t.length-1&&(this.finalKeyframe=T)}}if(this.resolveNoneKeyframes(),!mK.has(r)||t.length!==2)return;const[c,f]=t,p=xU(c),s=xU(f);if(p!==s)if(mU(p)&&mU(s))for(let w=0;w<t.length;w++){const T=t[w];typeof T=="string"&&(t[w]=parseFloat(T))}else Hx[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let c=0;c<t.length;c++)(t[c]===null||l0e(t[c]))&&r.push(c);r.length&&m0e(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Hx[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const c=n[n.length-1];c!==void 0&&t.getValue(r,c).jump(c,!1)}measureEndState(){const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const c=t.getValue(n);c&&c.jump(this.measuredOrigin,!1);const f=r.length-1,p=r[f];r[f]=Hx[n](t.measureViewportBox(),window.getComputedStyle(t.current)),p!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=p),this.removedTransforms?.length&&this.removedTransforms.forEach(([s,w])=>{t.getValue(s).set(w)}),this.resolveNoneKeyframes()}}function y0e(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let r=document;const c=n?.[e]??r.querySelectorAll(e);return c?Array.from(c):[]}return Array.from(e)}const _K=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function v0e(e){return LY(e)&&"offsetHeight"in e}const bU=30,x0e=e=>!isNaN(parseFloat(e));class _0e{constructor(t,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const c=Ku.now();if(this.updatedAt!==c&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const f of this.dependents)f.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=Ku.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=x0e(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new H3);const r=this.events[t].add(n);return t==="change"?()=>{r(),Io.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Ku.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>bU)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,bU);return FY(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function K0(e,t){return new _0e(e,t)}const{schedule:az}=YY(queueMicrotask,!1),Cf={x:!1,y:!1};function bK(){return Cf.x||Cf.y}function b0e(e){return e==="x"||e==="y"?Cf[e]?null:(Cf[e]=!0,()=>{Cf[e]=!1}):Cf.x||Cf.y?null:(Cf.x=Cf.y=!0,()=>{Cf.x=Cf.y=!1})}function wK(e,t){const n=y0e(e),r=new AbortController,c={passive:!0,...t,signal:r.signal};return[n,c,()=>r.abort()]}function wU(e){return!(e.pointerType==="touch"||bK())}function w0e(e,t,n={}){const[r,c,f]=wK(e,n),p=s=>{if(!wU(s))return;const{target:w}=s,T=t(w,s);if(typeof T!="function"||!w)return;const E=N=>{wU(N)&&(T(N),w.removeEventListener("pointerleave",E))};w.addEventListener("pointerleave",E,c)};return r.forEach(s=>{s.addEventListener("pointerenter",p,c)}),f}const SK=(e,t)=>t?e===t?!0:SK(e,t.parentElement):!1,oz=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,S0e=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function T0e(e){return S0e.has(e.tagName)||e.tabIndex!==-1}const IA=new WeakSet;function SU(e){return t=>{t.key==="Enter"&&e(t)}}function JP(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const A0e=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=SU(()=>{if(IA.has(n))return;JP(n,"down");const c=SU(()=>{JP(n,"up")}),f=()=>JP(n,"cancel");n.addEventListener("keyup",c,t),n.addEventListener("blur",f,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function TU(e){return oz(e)&&!bK()}function j0e(e,t,n={}){const[r,c,f]=wK(e,n),p=s=>{const w=s.currentTarget;if(!TU(s))return;IA.add(w);const T=t(w,s),E=(V,$)=>{window.removeEventListener("pointerup",N),window.removeEventListener("pointercancel",D),IA.has(w)&&IA.delete(w),TU(V)&&typeof T=="function"&&T(V,{success:$})},N=V=>{E(V,w===window||w===document||n.useGlobalTarget||SK(w,V.target))},D=V=>{E(V,!1)};window.addEventListener("pointerup",N,c),window.addEventListener("pointercancel",D,c)};return r.forEach(s=>{(n.useGlobalTarget?window:s).addEventListener("pointerdown",p,c),v0e(s)&&(s.addEventListener("focus",T=>A0e(T,c)),!T0e(s)&&!s.hasAttribute("tabindex")&&(s.tabIndex=0))}),f}function TK(e){return LY(e)&&"ownerSVGElement"in e}function E0e(e){return TK(e)&&e.tagName==="svg"}const nu=e=>!!(e&&e.getVelocity),C0e=[...yK,Pl,av],N0e=e=>C0e.find(gK(e)),AK=z.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function P0e(e=!0){const t=z.useContext(B3);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:c}=t,f=z.useId();z.useEffect(()=>{if(e)return c(f)},[e]);const p=z.useCallback(()=>e&&r&&r(f),[f,r,e]);return!n&&r?[!1,p]:[!0]}const jK=z.createContext({strict:!1}),AU={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},J0={};for(const e in AU)J0[e]={isEnabled:t=>AU[e].some(n=>!!t[n])};function M0e(e){for(const t in e)J0[t]={...J0[t],...e[t]}}const R0e=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function fj(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||R0e.has(e)}let EK=e=>!fj(e);function O0e(e){typeof e=="function"&&(EK=t=>t.startsWith("on")?!fj(t):e(t))}try{O0e(require("@emotion/is-prop-valid").default)}catch{}function D0e(e,t,n){const r={};for(const c in e)c==="values"&&typeof e.values=="object"||(EK(c)||n===!0&&fj(c)||!t&&!fj(c)||e.draggable&&c.startsWith("onDrag"))&&(r[c]=e[c]);return r}const dC=z.createContext({});function hC(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function aS(e){return typeof e=="string"||Array.isArray(e)}const lz=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],cz=["initial",...lz];function fC(e){return hC(e.animate)||cz.some(t=>aS(e[t]))}function CK(e){return!!(fC(e)||e.variants)}function k0e(e,t){if(fC(e)){const{initial:n,animate:r}=e;return{initial:n===!1||aS(n)?n:void 0,animate:aS(r)?r:void 0}}return e.inherit!==!1?t:{}}function I0e(e){const{initial:t,animate:n}=k0e(e,z.useContext(dC));return z.useMemo(()=>({initial:t,animate:n}),[jU(t),jU(n)])}function jU(e){return Array.isArray(e)?e.join(" "):e}const oS={};function L0e(e){for(const t in e)oS[t]=e[t],X3(t)&&(oS[t].isCSSVariable=!0)}function NK(e,{layout:t,layoutId:n}){return Bb.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!oS[e]||e==="opacity")}const z0e={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},F0e=Fb.length;function B0e(e,t,n){let r="",c=!0;for(let f=0;f<F0e;f++){const p=Fb[f],s=e[p];if(s===void 0)continue;let w=!0;if(typeof s=="number"?w=s===(p.startsWith("scale")?1:0):w=parseFloat(s)===0,!w||n){const T=_K(s,sz[p]);if(!w){c=!1;const E=z0e[p]||p;r+=`${E}(${T}) `}n&&(t[p]=T)}}return r=r.trim(),n?r=n(t,c?"":r):c&&(r="none"),r}function uz(e,t,n){const{style:r,vars:c,transformOrigin:f}=e;let p=!1,s=!1;for(const w in t){const T=t[w];if(Bb.has(w)){p=!0;continue}else if(X3(w)){c[w]=T;continue}else{const E=_K(T,sz[w]);w.startsWith("origin")?(s=!0,f[w]=E):r[w]=E}}if(t.transform||(p||n?r.transform=B0e(t,e.transform,n):r.transform&&(r.transform="none")),s){const{originX:w="50%",originY:T="50%",originZ:E=0}=f;r.transformOrigin=`${w} ${T} ${E}`}}const dz=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function PK(e,t,n){for(const r in t)!nu(t[r])&&!NK(r,n)&&(e[r]=t[r])}function U0e({transformTemplate:e},t){return z.useMemo(()=>{const n=dz();return uz(n,t,e),Object.assign({},n.vars,n.style)},[t])}function V0e(e,t){const n=e.style||{},r={};return PK(r,n,e),Object.assign(r,U0e(e,t)),r}function $0e(e,t){const n={},r=V0e(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const q0e={offset:"stroke-dashoffset",array:"stroke-dasharray"},H0e={offset:"strokeDashoffset",array:"strokeDasharray"};function G0e(e,t,n=1,r=0,c=!0){e.pathLength=1;const f=c?q0e:H0e;e[f.offset]=cs.transform(-r);const p=cs.transform(t),s=cs.transform(n);e[f.array]=`${p} ${s}`}function MK(e,{attrX:t,attrY:n,attrScale:r,pathLength:c,pathSpacing:f=1,pathOffset:p=0,...s},w,T,E){if(uz(e,s,T),w){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:N,style:D}=e;N.transform&&(D.transform=N.transform,delete N.transform),(D.transform||N.transformOrigin)&&(D.transformOrigin=N.transformOrigin??"50% 50%",delete N.transformOrigin),D.transform&&(D.transformBox=E?.transformBox??"fill-box",delete N.transformBox),t!==void 0&&(N.x=t),n!==void 0&&(N.y=n),r!==void 0&&(N.scale=r),c!==void 0&&G0e(N,c,f,p,!1)}const RK=()=>({...dz(),attrs:{}}),OK=e=>typeof e=="string"&&e.toLowerCase()==="svg";function W0e(e,t,n,r){const c=z.useMemo(()=>{const f=RK();return MK(f,t,OK(r),e.transformTemplate,e.style),{...f.attrs,style:{...f.style}}},[t]);if(e.style){const f={};PK(f,e.style,e),c.style={...f,...c.style}}return c}const X0e=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function hz(e){return typeof e!="string"||e.includes("-")?!1:!!(X0e.indexOf(e)>-1||/[A-Z]/u.test(e))}function Z0e(e,t,n,{latestValues:r},c,f=!1){const s=(hz(e)?W0e:$0e)(t,r,c,e),w=D0e(t,typeof e=="string",f),T=e!==z.Fragment?{...w,...s,ref:n}:{},{children:E}=t,N=z.useMemo(()=>nu(E)?E.get():E,[E]);return z.createElement(e,{...T,children:N})}function EU(e){const t=[{},{}];return e?.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function fz(e,t,n,r){if(typeof t=="function"){const[c,f]=EU(r);t=t(n!==void 0?n:e.custom,c,f)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[c,f]=EU(r);t=t(n!==void 0?n:e.custom,c,f)}return t}function LA(e){return nu(e)?e.get():e}function Y0e({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,c){return{latestValues:K0e(n,r,c,e),renderState:t()}}function K0e(e,t,n,r){const c={},f=r(e,{});for(const D in f)c[D]=LA(f[D]);let{initial:p,animate:s}=e;const w=fC(e),T=CK(e);t&&T&&!w&&e.inherit!==!1&&(p===void 0&&(p=t.initial),s===void 0&&(s=t.animate));let E=n?n.initial===!1:!1;E=E||p===!1;const N=E?s:p;if(N&&typeof N!="boolean"&&!hC(N)){const D=Array.isArray(N)?N:[N];for(let V=0;V<D.length;V++){const $=fz(e,D[V]);if($){const{transitionEnd:B,transition:F,...K}=$;for(const Y in K){let X=K[Y];if(Array.isArray(X)){const ae=E?X.length-1:0;X=X[ae]}X!==null&&(c[Y]=X)}for(const Y in B)c[Y]=B[Y]}}}return c}const DK=e=>(t,n)=>{const r=z.useContext(dC),c=z.useContext(B3),f=()=>Y0e(e,t,r,c);return n?f():Mxe(f)};function pz(e,t,n){const{style:r}=e,c={};for(const f in r)(nu(r[f])||t.style&&nu(t.style[f])||NK(f,e)||n?.getValue(f)?.liveStyle!==void 0)&&(c[f]=r[f]);return c}const J0e=DK({scrapeMotionValuesFromProps:pz,createRenderState:dz});function kK(e,t,n){const r=pz(e,t,n);for(const c in e)if(nu(e[c])||nu(t[c])){const f=Fb.indexOf(c)!==-1?"attr"+c.charAt(0).toUpperCase()+c.substring(1):c;r[f]=e[c]}return r}const Q0e=DK({scrapeMotionValuesFromProps:kK,createRenderState:RK}),ebe=Symbol.for("motionComponentSymbol");function E0(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function tbe(e,t,n){return z.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):E0(n)&&(n.current=r))},[t])}const mz=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),nbe="framerAppearId",IK="data-"+mz(nbe),LK=z.createContext({});function rbe(e,t,n,r,c){const{visualElement:f}=z.useContext(dC),p=z.useContext(jK),s=z.useContext(B3),w=z.useContext(AK).reducedMotion,T=z.useRef(null);r=r||p.renderer,!T.current&&r&&(T.current=r(e,{visualState:t,parent:f,props:n,presenceContext:s,blockInitialAnimation:s?s.initial===!1:!1,reducedMotionConfig:w}));const E=T.current,N=z.useContext(LK);E&&!E.projection&&c&&(E.type==="html"||E.type==="svg")&&ibe(T.current,n,c,N);const D=z.useRef(!1);z.useInsertionEffect(()=>{E&&D.current&&E.update(n,s)});const V=n[IK],$=z.useRef(!!V&&!window.MotionHandoffIsComplete?.(V)&&window.MotionHasOptimisedAnimation?.(V));return Rxe(()=>{E&&(D.current=!0,window.MotionIsMounted=!0,E.updateFeatures(),E.scheduleRenderMicrotask(),$.current&&E.animationState&&E.animationState.animateChanges())}),z.useEffect(()=>{E&&(!$.current&&E.animationState&&E.animationState.animateChanges(),$.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(V)}),$.current=!1),E.enteringChildren=void 0)}),E}function ibe(e,t,n,r){const{layoutId:c,layout:f,drag:p,dragConstraints:s,layoutScroll:w,layoutRoot:T,layoutCrossfade:E}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:zK(e.parent)),e.projection.setOptions({layoutId:c,layout:f,alwaysMeasureLayout:!!p||s&&E0(s),visualElement:e,animationType:typeof f=="string"?f:"both",initialPromotionConfig:r,crossfade:E,layoutScroll:w,layoutRoot:T})}function zK(e){if(e)return e.options.allowProjection!==!1?e.projection:zK(e.parent)}function QP(e,{forwardMotionProps:t=!1}={},n,r){n&&M0e(n);const c=hz(e)?Q0e:J0e;function f(s,w){let T;const E={...z.useContext(AK),...s,layoutId:sbe(s)},{isStatic:N}=E,D=I0e(s),V=c(s,N);if(!N&&F3){abe();const $=obe(E);T=$.MeasureLayout,D.visualElement=rbe(e,V,E,r,$.ProjectionNode)}return o.jsxs(dC.Provider,{value:D,children:[T&&D.visualElement?o.jsx(T,{visualElement:D.visualElement,...E}):null,Z0e(e,s,tbe(V,D.visualElement,w),V,N,t)]})}f.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const p=z.forwardRef(f);return p[ebe]=e,p}function sbe({layoutId:e}){const t=z.useContext(kY).id;return t&&e!==void 0?t+"-"+e:e}function abe(e,t){z.useContext(jK).strict}function obe(e){const{drag:t,layout:n}=J0;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t?.isEnabled(e)||n?.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function lbe(e,t){if(typeof Proxy>"u")return QP;const n=new Map,r=(f,p)=>QP(f,p,e,t),c=(f,p)=>r(f,p);return new Proxy(c,{get:(f,p)=>p==="create"?r:(n.has(p)||n.set(p,QP(p,void 0,e,t)),n.get(p))})}function FK({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function cbe({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function ube(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function eM(e){return e===void 0||e===1}function sI({scale:e,scaleX:t,scaleY:n}){return!eM(e)||!eM(t)||!eM(n)}function Cx(e){return sI(e)||BK(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function BK(e){return CU(e.x)||CU(e.y)}function CU(e){return e&&e!=="0%"}function pj(e,t,n){const r=e-n,c=t*r;return n+c}function NU(e,t,n,r,c){return c!==void 0&&(e=pj(e,c,r)),pj(e,n,r)+t}function aI(e,t=0,n=1,r,c){e.min=NU(e.min,t,n,r,c),e.max=NU(e.max,t,n,r,c)}function UK(e,{x:t,y:n}){aI(e.x,t.translate,t.scale,t.originPoint),aI(e.y,n.translate,n.scale,n.originPoint)}const PU=.999999999999,MU=1.0000000000001;function dbe(e,t,n,r=!1){const c=n.length;if(!c)return;t.x=t.y=1;let f,p;for(let s=0;s<c;s++){f=n[s],p=f.projectionDelta;const{visualElement:w}=f.options;w&&w.props.style&&w.props.style.display==="contents"||(r&&f.options.layoutScroll&&f.scroll&&f!==f.root&&N0(e,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),p&&(t.x*=p.x.scale,t.y*=p.y.scale,UK(e,p)),r&&Cx(f.latestValues)&&N0(e,f.latestValues))}t.x<MU&&t.x>PU&&(t.x=1),t.y<MU&&t.y>PU&&(t.y=1)}function C0(e,t){e.min=e.min+t,e.max=e.max+t}function RU(e,t,n,r,c=.5){const f=Wo(e.min,e.max,c);aI(e,t,n,f,r)}function N0(e,t){RU(e.x,t.x,t.scaleX,t.scale,t.originX),RU(e.y,t.y,t.scaleY,t.scale,t.originY)}function VK(e,t){return FK(ube(e.getBoundingClientRect(),t))}function hbe(e,t,n){const r=VK(e,n),{scroll:c}=t;return c&&(C0(r.x,c.offset.x),C0(r.y,c.offset.y)),r}const OU=()=>({translate:0,scale:1,origin:0,originPoint:0}),P0=()=>({x:OU(),y:OU()}),DU=()=>({min:0,max:0}),hl=()=>({x:DU(),y:DU()}),oI={current:null},$K={current:!1};function fbe(){if($K.current=!0,!!F3)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>oI.current=e.matches;e.addEventListener("change",t),t()}else oI.current=!1}const pbe=new WeakMap;function mbe(e,t,n){for(const r in t){const c=t[r],f=n[r];if(nu(c))e.addValue(r,c);else if(nu(f))e.addValue(r,K0(c,{owner:e}));else if(f!==c)if(e.hasValue(r)){const p=e.getValue(r);p.liveStyle===!0?p.jump(c):p.hasAnimated||p.set(c)}else{const p=e.getStaticValue(r);e.addValue(r,K0(p!==void 0?p:c,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const kU=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class gbe{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:c,blockInitialAnimation:f,visualState:p},s={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=rz,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const D=Ku.now();this.renderScheduledAt<D&&(this.renderScheduledAt=D,Io.render(this.render,!1,!0))};const{latestValues:w,renderState:T}=p;this.latestValues=w,this.baseTarget={...w},this.initialValues=n.initial?{...w}:{},this.renderState=T,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=c,this.options=s,this.blockInitialAnimation=!!f,this.isControllingVariants=fC(n),this.isVariantNode=CK(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:E,...N}=this.scrapeMotionValuesFromProps(n,{},this);for(const D in N){const V=N[D];w[D]!==void 0&&nu(V)&&V.set(w[D])}}mount(t){this.current=t,pbe.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),$K.current||fbe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:oI.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),sv(this.notifyUpdate),sv(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=Bb.has(t);r&&this.onBindTransform&&this.onBindTransform();const c=n.on("change",p=>{this.latestValues[t]=p,this.props.onUpdate&&Io.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let f;window.MotionCheckAppearSync&&(f=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{c(),f&&f(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in J0){const n=J0[t];if(!n)continue;const{isEnabled:r,Feature:c}=n;if(!this.features[t]&&c&&r(this.props)&&(this.features[t]=new c(this)),this.features[t]){const f=this.features[t];f.isMounted?f.update():(f.mount(),f.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):hl()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<kU.length;r++){const c=kU[r];this.propEventSubscriptions[c]&&(this.propEventSubscriptions[c](),delete this.propEventSubscriptions[c]);const f="on"+c,p=t[f];p&&(this.propEventSubscriptions[c]=this.on(c,p))}this.prevMotionValues=mbe(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=K0(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(IY(r)||zY(r))?r=parseFloat(r):!N0e(r)&&av.test(n)&&(r=xK(t,n)),this.setBaseTarget(t,nu(r)?r.get():r)),nu(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const f=fz(this.props,n,this.presenceContext?.custom);f&&(r=f[t])}if(n&&r!==void 0)return r;const c=this.getBaseTargetFromProps(this.props,t);return c!==void 0&&!nu(c)?c:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new H3),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}scheduleRenderMicrotask(){az.render(this.render)}}class qK extends gbe{constructor(){super(...arguments),this.KeyframeResolver=g0e}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;nu(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function HK(e,{style:t,vars:n},r,c){const f=e.style;let p;for(p in t)f[p]=t[p];c?.applyProjectionStyles(f,r);for(p in n)f.setProperty(p,n[p])}function ybe(e){return window.getComputedStyle(e)}class vbe extends qK{constructor(){super(...arguments),this.type="html",this.renderInstance=HK}readValueFromInstance(t,n){if(Bb.has(n))return this.projection?.isProjecting?Jk(n):k_e(t,n);{const r=ybe(t),c=(X3(n)?r.getPropertyValue(n):r[n])||0;return typeof c=="string"?c.trim():c}}measureInstanceViewportBox(t,{transformPagePoint:n}){return VK(t,n)}build(t,n,r){uz(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return pz(t,n,r)}}const GK=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function xbe(e,t,n,r){HK(e,t,void 0,r);for(const c in t.attrs)e.setAttribute(GK.has(c)?c:mz(c),t.attrs[c])}class _be extends qK{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=hl}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(Bb.has(n)){const r=vK(n);return r&&r.default||0}return n=GK.has(n)?n:mz(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return kK(t,n,r)}build(t,n,r){MK(t,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,n,r,c){xbe(t,n,r,c)}mount(t){this.isSVGTag=OK(t.tagName),super.mount(t)}}const bbe=(e,t)=>hz(e)?new _be(t):new vbe(t,{allowProjection:e!==z.Fragment});function U0(e,t,n){const r=e.getProps();return fz(r,t,n!==void 0?n:r.custom,e)}const lI=e=>Array.isArray(e);function wbe(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,K0(n))}function Sbe(e){return lI(e)?e[e.length-1]||0:e}function Tbe(e,t){const n=U0(e,t);let{transitionEnd:r={},transition:c={},...f}=n||{};f={...f,...r};for(const p in f){const s=Sbe(f[p]);wbe(e,p,s)}}function Abe(e){return!!(nu(e)&&e.add)}function cI(e,t){const n=e.getValue("willChange");if(Abe(n))return n.add(t);if(!n&&Ng.WillChange){const r=new Ng.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function WK(e){return e.props[IK]}const jbe=e=>e!==null;function Ebe(e,{repeat:t,repeatType:n="loop"},r){const c=e.filter(jbe),f=t&&n!=="loop"&&t%2===1?0:c.length-1;return c[f]}const Cbe={type:"spring",stiffness:500,damping:25,restSpeed:10},Nbe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Pbe={type:"keyframes",duration:.8},Mbe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Rbe=(e,{keyframes:t})=>t.length>2?Pbe:Bb.has(e)?e.startsWith("scale")?Nbe(t[1]):Cbe:Mbe;function Obe({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:c,repeat:f,repeatType:p,repeatDelay:s,from:w,elapsed:T,...E}){return!!Object.keys(E).length}const gz=(e,t,n,r={},c,f)=>p=>{const s=iz(r,e)||{},w=s.delay||r.delay||0;let{elapsed:T=0}=r;T=T-Qp(w);const E={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...s,delay:-T,onUpdate:D=>{t.set(D),s.onUpdate&&s.onUpdate(D)},onComplete:()=>{p(),s.onComplete&&s.onComplete()},name:e,motionValue:t,element:f?void 0:c};Obe(s)||Object.assign(E,Rbe(e,E)),E.duration&&(E.duration=Qp(E.duration)),E.repeatDelay&&(E.repeatDelay=Qp(E.repeatDelay)),E.from!==void 0&&(E.keyframes[0]=E.from);let N=!1;if((E.type===!1||E.duration===0&&!E.repeatDelay)&&(rI(E),E.delay===0&&(N=!0)),(Ng.instantAnimations||Ng.skipAnimations)&&(N=!0,rI(E),E.delay=0),E.allowFlatten=!s.type&&!s.ease,N&&!f&&t.get()!==void 0){const D=Ebe(E.keyframes,s);if(D!==void 0){Io.update(()=>{E.onUpdate(D),E.onComplete()});return}}return s.isSync?new nz(E):new i0e(E)};function Dbe({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function XK(e,t,{delay:n=0,transitionOverride:r,type:c}={}){let{transition:f=e.getDefaultTransition(),transitionEnd:p,...s}=t;r&&(f=r);const w=[],T=c&&e.animationState&&e.animationState.getState()[c];for(const E in s){const N=e.getValue(E,e.latestValues[E]??null),D=s[E];if(D===void 0||T&&Dbe(T,E))continue;const V={delay:n,...iz(f||{},E)},$=N.get();if($!==void 0&&!N.isAnimating&&!Array.isArray(D)&&D===$&&!V.velocity)continue;let B=!1;if(window.MotionHandoffAnimation){const K=WK(e);if(K){const Y=window.MotionHandoffAnimation(K,E,Io);Y!==null&&(V.startTime=Y,B=!0)}}cI(e,E),N.start(gz(E,N,D,e.shouldReduceMotion&&mK.has(E)?{type:!1}:V,e,B));const F=N.animation;F&&w.push(F)}return p&&Promise.all(w).then(()=>{Io.update(()=>{p&&Tbe(e,p)})}),w}function ZK(e,t,n,r=0,c=1){const f=Array.from(e).sort((T,E)=>T.sortNodePosition(E)).indexOf(t),p=e.size,s=(p-1)*r;return typeof n=="function"?n(f,p):c===1?f*r:s-f*r}function uI(e,t,n={}){const r=U0(e,t,n.type==="exit"?e.presenceContext?.custom:void 0);let{transition:c=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(c=n.transitionOverride);const f=r?()=>Promise.all(XK(e,r,n)):()=>Promise.resolve(),p=e.variantChildren&&e.variantChildren.size?(w=0)=>{const{delayChildren:T=0,staggerChildren:E,staggerDirection:N}=c;return kbe(e,t,w,T,E,N,n)}:()=>Promise.resolve(),{when:s}=c;if(s){const[w,T]=s==="beforeChildren"?[f,p]:[p,f];return w().then(()=>T())}else return Promise.all([f(),p(n.delay)])}function kbe(e,t,n=0,r=0,c=0,f=1,p){const s=[];for(const w of e.variantChildren)w.notify("AnimationStart",t),s.push(uI(w,t,{...p,delay:n+(typeof r=="function"?0:r)+ZK(e.variantChildren,w,r,c,f)}).then(()=>w.notify("AnimationComplete",t)));return Promise.all(s)}function Ibe(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const c=t.map(f=>uI(e,f,n));r=Promise.all(c)}else if(typeof t=="string")r=uI(e,t,n);else{const c=typeof t=="function"?U0(e,t,n.custom):t;r=Promise.all(XK(e,c,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function YK(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const Lbe=cz.length;function KK(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?KK(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<Lbe;n++){const r=cz[n],c=e.props[r];(aS(c)||c===!1)&&(t[r]=c)}return t}const zbe=[...lz].reverse(),Fbe=lz.length;function Bbe(e){return t=>Promise.all(t.map(({animation:n,options:r})=>Ibe(e,n,r)))}function Ube(e){let t=Bbe(e),n=IU(),r=!0;const c=w=>(T,E)=>{const N=U0(e,E,w==="exit"?e.presenceContext?.custom:void 0);if(N){const{transition:D,transitionEnd:V,...$}=N;T={...T,...$,...V}}return T};function f(w){t=w(e)}function p(w){const{props:T}=e,E=KK(e.parent)||{},N=[],D=new Set;let V={},$=1/0;for(let F=0;F<Fbe;F++){const K=zbe[F],Y=n[K],X=T[K]!==void 0?T[K]:E[K],ae=aS(X),Z=K===w?Y.isActive:null;Z===!1&&($=F);let se=X===E[K]&&X!==T[K]&&ae;if(se&&r&&e.manuallyAnimateOnMount&&(se=!1),Y.protectedKeys={...V},!Y.isActive&&Z===null||!X&&!Y.prevProp||hC(X)||typeof X=="boolean")continue;const he=Vbe(Y.prevProp,X);let ye=he||K===w&&Y.isActive&&!se&&ae||F>$&&ae,Ce=!1;const Ve=Array.isArray(X)?X:[X];let Re=Ve.reduce(c(K),{});Z===!1&&(Re={});const{prevResolvedValues:$e={}}=Y,nt={...$e,...Re},Me=it=>{ye=!0,D.has(it)&&(Ce=!0,D.delete(it)),Y.needsAnimating[it]=!0;const et=e.getValue(it);et&&(et.liveStyle=!1)};for(const it in nt){const et=Re[it],mt=$e[it];if(V.hasOwnProperty(it))continue;let He=!1;lI(et)&&lI(mt)?He=!YK(et,mt):He=et!==mt,He?et!=null?Me(it):D.add(it):et!==void 0&&D.has(it)?Me(it):Y.protectedKeys[it]=!0}Y.prevProp=X,Y.prevResolvedValues=Re,Y.isActive&&(V={...V,...Re}),r&&e.blockInitialAnimation&&(ye=!1);const rt=se&&he;ye&&(!rt||Ce)&&N.push(...Ve.map(it=>{const et={type:K};if(typeof it=="string"&&r&&!rt&&e.manuallyAnimateOnMount&&e.parent){const{parent:mt}=e,He=U0(mt,it);if(mt.enteringChildren&&He){const{delayChildren:pt}=He.transition||{};et.delay=ZK(mt.enteringChildren,e,pt)}}return{animation:it,options:et}}))}if(D.size){const F={};if(typeof T.initial!="boolean"){const K=U0(e,Array.isArray(T.initial)?T.initial[0]:T.initial);K&&K.transition&&(F.transition=K.transition)}D.forEach(K=>{const Y=e.getBaseTarget(K),X=e.getValue(K);X&&(X.liveStyle=!0),F[K]=Y??null}),N.push({animation:F})}let B=!!N.length;return r&&(T.initial===!1||T.initial===T.animate)&&!e.manuallyAnimateOnMount&&(B=!1),r=!1,B?t(N):Promise.resolve()}function s(w,T){if(n[w].isActive===T)return Promise.resolve();e.variantChildren?.forEach(N=>N.animationState?.setActive(w,T)),n[w].isActive=T;const E=p(w);for(const N in n)n[N].protectedKeys={};return E}return{animateChanges:p,setActive:s,setAnimateFunction:f,getState:()=>n,reset:()=>{n=IU(),r=!0}}}function Vbe(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!YK(t,e):!1}function Tx(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function IU(){return{animate:Tx(!0),whileInView:Tx(),whileHover:Tx(),whileTap:Tx(),whileDrag:Tx(),whileFocus:Tx(),exit:Tx()}}class hv{constructor(t){this.isMounted=!1,this.node=t}update(){}}class $be extends hv{constructor(t){super(t),t.animationState||(t.animationState=Ube(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();hC(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let qbe=0;class Hbe extends hv{constructor(){super(...arguments),this.id=qbe++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const c=this.node.animationState.setActive("exit",!t);n&&!t&&c.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const Gbe={animation:{Feature:$be},exit:{Feature:Hbe}};function lS(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}function xT(e){return{point:{x:e.pageX,y:e.pageY}}}const Wbe=e=>t=>oz(t)&&e(t,xT(t));function F1(e,t,n,r){return lS(e,t,Wbe(n),r)}const JK=1e-4,Xbe=1-JK,Zbe=1+JK,QK=.01,Ybe=0-QK,Kbe=0+QK;function _u(e){return e.max-e.min}function Jbe(e,t,n){return Math.abs(e-t)<=n}function LU(e,t,n,r=.5){e.origin=r,e.originPoint=Wo(t.min,t.max,e.origin),e.scale=_u(n)/_u(t),e.translate=Wo(n.min,n.max,e.origin)-e.originPoint,(e.scale>=Xbe&&e.scale<=Zbe||isNaN(e.scale))&&(e.scale=1),(e.translate>=Ybe&&e.translate<=Kbe||isNaN(e.translate))&&(e.translate=0)}function B1(e,t,n,r){LU(e.x,t.x,n.x,r?r.originX:void 0),LU(e.y,t.y,n.y,r?r.originY:void 0)}function zU(e,t,n){e.min=n.min+t.min,e.max=e.min+_u(t)}function Qbe(e,t,n){zU(e.x,t.x,n.x),zU(e.y,t.y,n.y)}function FU(e,t,n){e.min=t.min-n.min,e.max=e.min+_u(t)}function U1(e,t,n){FU(e.x,t.x,n.x),FU(e.y,t.y,n.y)}function Oh(e){return[e("x"),e("y")]}const eJ=({current:e})=>e?e.ownerDocument.defaultView:null,BU=(e,t)=>Math.abs(e-t);function ewe(e,t){const n=BU(e.x,t.x),r=BU(e.y,t.y);return Math.sqrt(n**2+r**2)}class tJ{constructor(t,n,{transformPagePoint:r,contextWindow:c=window,dragSnapToOrigin:f=!1,distanceThreshold:p=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const D=nM(this.lastMoveEventInfo,this.history),V=this.startEvent!==null,$=ewe(D.offset,{x:0,y:0})>=this.distanceThreshold;if(!V&&!$)return;const{point:B}=D,{timestamp:F}=jc;this.history.push({...B,timestamp:F});const{onStart:K,onMove:Y}=this.handlers;V||(K&&K(this.lastMoveEvent,D),this.startEvent=this.lastMoveEvent),Y&&Y(this.lastMoveEvent,D)},this.handlePointerMove=(D,V)=>{this.lastMoveEvent=D,this.lastMoveEventInfo=tM(V,this.transformPagePoint),Io.update(this.updatePoint,!0)},this.handlePointerUp=(D,V)=>{this.end();const{onEnd:$,onSessionEnd:B,resumeAnimation:F}=this.handlers;if(this.dragSnapToOrigin&&F&&F(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const K=nM(D.type==="pointercancel"?this.lastMoveEventInfo:tM(V,this.transformPagePoint),this.history);this.startEvent&&$&&$(D,K),B&&B(D,K)},!oz(t))return;this.dragSnapToOrigin=f,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=p,this.contextWindow=c||window;const s=xT(t),w=tM(s,this.transformPagePoint),{point:T}=w,{timestamp:E}=jc;this.history=[{...T,timestamp:E}];const{onSessionStart:N}=n;N&&N(t,nM(w,this.history)),this.removeListeners=gT(F1(this.contextWindow,"pointermove",this.handlePointerMove),F1(this.contextWindow,"pointerup",this.handlePointerUp),F1(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),sv(this.updatePoint)}}function tM(e,t){return t?{point:t(e.point)}:e}function UU(e,t){return{x:e.x-t.x,y:e.y-t.y}}function nM({point:e},t){return{point:e,delta:UU(e,nJ(t)),offset:UU(e,twe(t)),velocity:nwe(t,.1)}}function twe(e){return e[0]}function nJ(e){return e[e.length-1]}function nwe(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const c=nJ(e);for(;n>=0&&(r=e[n],!(c.timestamp-r.timestamp>Qp(t)));)n--;if(!r)return{x:0,y:0};const f=em(c.timestamp-r.timestamp);if(f===0)return{x:0,y:0};const p={x:(c.x-r.x)/f,y:(c.y-r.y)/f};return p.x===1/0&&(p.x=0),p.y===1/0&&(p.y=0),p}function rwe(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?Wo(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?Wo(n,e,r.max):Math.min(e,n)),e}function VU(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function iwe(e,{top:t,left:n,bottom:r,right:c}){return{x:VU(e.x,n,c),y:VU(e.y,t,r)}}function $U(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function swe(e,t){return{x:$U(e.x,t.x),y:$U(e.y,t.y)}}function awe(e,t){let n=.5;const r=_u(e),c=_u(t);return c>r?n=rS(t.min,t.max-r,e.min):r>c&&(n=rS(e.min,e.max-c,t.min)),Cg(0,1,n)}function owe(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const dI=.35;function lwe(e=dI){return e===!1?e=0:e===!0&&(e=dI),{x:qU(e,"left","right"),y:qU(e,"top","bottom")}}function qU(e,t,n){return{min:HU(e,t),max:HU(e,n)}}function HU(e,t){return typeof e=="number"?e:e[t]||0}const cwe=new WeakMap;class uwe{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=hl(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:n=!1,distanceThreshold:r}={}){const{presenceContext:c}=this.visualElement;if(c&&c.isPresent===!1)return;const f=N=>{const{dragSnapToOrigin:D}=this.getProps();D?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(xT(N).point)},p=(N,D)=>{const{drag:V,dragPropagation:$,onDragStart:B}=this.getProps();if(V&&!$&&(this.openDragLock&&this.openDragLock(),this.openDragLock=b0e(V),!this.openDragLock))return;this.latestPointerEvent=N,this.latestPanInfo=D,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Oh(K=>{let Y=this.getAxisMotionValue(K).get()||0;if(tm.test(Y)){const{projection:X}=this.visualElement;if(X&&X.layout){const ae=X.layout.layoutBox[K];ae&&(Y=_u(ae)*(parseFloat(Y)/100))}}this.originPoint[K]=Y}),B&&Io.postRender(()=>B(N,D)),cI(this.visualElement,"transform");const{animationState:F}=this.visualElement;F&&F.setActive("whileDrag",!0)},s=(N,D)=>{this.latestPointerEvent=N,this.latestPanInfo=D;const{dragPropagation:V,dragDirectionLock:$,onDirectionLock:B,onDrag:F}=this.getProps();if(!V&&!this.openDragLock)return;const{offset:K}=D;if($&&this.currentDirection===null){this.currentDirection=dwe(K),this.currentDirection!==null&&B&&B(this.currentDirection);return}this.updateAxis("x",D.point,K),this.updateAxis("y",D.point,K),this.visualElement.render(),F&&F(N,D)},w=(N,D)=>{this.latestPointerEvent=N,this.latestPanInfo=D,this.stop(N,D),this.latestPointerEvent=null,this.latestPanInfo=null},T=()=>Oh(N=>this.getAnimationState(N)==="paused"&&this.getAxisMotionValue(N).animation?.play()),{dragSnapToOrigin:E}=this.getProps();this.panSession=new tJ(t,{onSessionStart:f,onStart:p,onMove:s,onSessionEnd:w,resumeAnimation:T},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:E,distanceThreshold:r,contextWindow:eJ(this.visualElement)})}stop(t,n){const r=t||this.latestPointerEvent,c=n||this.latestPanInfo,f=this.isDragging;if(this.cancel(),!f||!c||!r)return;const{velocity:p}=c;this.startAnimation(p);const{onDragEnd:s}=this.getProps();s&&Io.postRender(()=>s(r,c))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:c}=this.getProps();if(!r||!oA(t,c,this.currentDirection))return;const f=this.getAxisMotionValue(t);let p=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(p=rwe(p,this.constraints[t],this.elastic[t])),f.set(p)}resolveConstraints(){const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,c=this.constraints;t&&E0(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=iwe(r.layoutBox,t):this.constraints=!1,this.elastic=lwe(n),c!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Oh(f=>{this.constraints!==!1&&this.getAxisMotionValue(f)&&(this.constraints[f]=owe(r.layoutBox[f],this.constraints[f]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!E0(t))return!1;const r=t.current,{projection:c}=this.visualElement;if(!c||!c.layout)return!1;const f=hbe(r,c.root,this.visualElement.getTransformPagePoint());let p=swe(c.layout.layoutBox,f);if(n){const s=n(cbe(p));this.hasMutatedConstraints=!!s,s&&(p=FK(s))}return p}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:c,dragTransition:f,dragSnapToOrigin:p,onDragTransitionEnd:s}=this.getProps(),w=this.constraints||{},T=Oh(E=>{if(!oA(E,n,this.currentDirection))return;let N=w&&w[E]||{};p&&(N={min:0,max:0});const D=c?200:1e6,V=c?40:1e7,$={type:"inertia",velocity:r?t[E]:0,bounceStiffness:D,bounceDamping:V,timeConstant:750,restDelta:1,restSpeed:10,...f,...N};return this.startAxisValueAnimation(E,$)});return Promise.all(T).then(s)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return cI(this.visualElement,t),r.start(gz(t,r,0,n,this.visualElement,!1))}stopAnimation(){Oh(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Oh(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),c=r[n];return c||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Oh(n=>{const{drag:r}=this.getProps();if(!oA(n,r,this.currentDirection))return;const{projection:c}=this.visualElement,f=this.getAxisMotionValue(n);if(c&&c.layout){const{min:p,max:s}=c.layout.layoutBox[n];f.set(t[n]-Wo(p,s,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!E0(n)||!r||!this.constraints)return;this.stopAnimation();const c={x:0,y:0};Oh(p=>{const s=this.getAxisMotionValue(p);if(s&&this.constraints!==!1){const w=s.get();c[p]=awe({min:w,max:w},this.constraints[p])}});const{transformTemplate:f}=this.visualElement.getProps();this.visualElement.current.style.transform=f?f({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Oh(p=>{if(!oA(p,t,null))return;const s=this.getAxisMotionValue(p),{min:w,max:T}=this.constraints[p];s.set(Wo(w,T,c[p]))})}addListeners(){if(!this.visualElement.current)return;cwe.set(this.visualElement,this);const t=this.visualElement.current,n=F1(t,"pointerdown",w=>{const{drag:T,dragListener:E=!0}=this.getProps();T&&E&&this.start(w)}),r=()=>{const{dragConstraints:w}=this.getProps();E0(w)&&w.current&&(this.constraints=this.resolveRefConstraints())},{projection:c}=this.visualElement,f=c.addEventListener("measure",r);c&&!c.layout&&(c.root&&c.root.updateScroll(),c.updateLayout()),Io.read(r);const p=lS(window,"resize",()=>this.scalePositionWithinConstraints()),s=c.addEventListener("didUpdate",(({delta:w,hasLayoutChanged:T})=>{this.isDragging&&T&&(Oh(E=>{const N=this.getAxisMotionValue(E);N&&(this.originPoint[E]+=w[E].translate,N.set(N.get()+w[E].translate))}),this.visualElement.render())}));return()=>{p(),n(),f(),s&&s()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:c=!1,dragConstraints:f=!1,dragElastic:p=dI,dragMomentum:s=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:c,dragConstraints:f,dragElastic:p,dragMomentum:s}}}function oA(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function dwe(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class hwe extends hv{constructor(t){super(t),this.removeGroupControls=Bh,this.removeListeners=Bh,this.controls=new uwe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Bh}unmount(){this.removeGroupControls(),this.removeListeners()}}const GU=e=>(t,n)=>{e&&Io.postRender(()=>e(t,n))};class fwe extends hv{constructor(){super(...arguments),this.removePointerDownListener=Bh}onPointerDown(t){this.session=new tJ(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:eJ(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:c}=this.node.getProps();return{onSessionStart:GU(t),onStart:GU(n),onMove:r,onEnd:(f,p)=>{delete this.session,c&&Io.postRender(()=>c(f,p))}}}mount(){this.removePointerDownListener=F1(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const zA={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function WU(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const h1={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(cs.test(e))e=parseFloat(e);else return e;const n=WU(e,t.target.x),r=WU(e,t.target.y);return`${n}% ${r}%`}},pwe={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,c=av.parse(e);if(c.length>5)return r;const f=av.createTransformer(e),p=typeof c[0]!="number"?1:0,s=n.x.scale*t.x,w=n.y.scale*t.y;c[0+p]/=s,c[1+p]/=w;const T=Wo(s,w,.5);return typeof c[2+p]=="number"&&(c[2+p]/=T),typeof c[3+p]=="number"&&(c[3+p]/=T),f(c)}};let rM=!1;class mwe extends z.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:c}=this.props,{projection:f}=t;L0e(gwe),f&&(n.group&&n.group.add(f),r&&r.register&&c&&r.register(f),rM&&f.root.didUpdate(),f.addEventListener("animationComplete",()=>{this.safeToRemove()}),f.setOptions({...f.options,onExitComplete:()=>this.safeToRemove()})),zA.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:c,isPresent:f}=this.props,{projection:p}=r;return p&&(p.isPresent=f,rM=!0,c||t.layoutDependency!==n||n===void 0||t.isPresent!==f?p.willUpdate():this.safeToRemove(),t.isPresent!==f&&(f?p.promote():p.relegate()||Io.postRender(()=>{const s=p.getStack();(!s||!s.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),az.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:c}=t;rM=!0,c&&(c.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(c),r&&r.deregister&&r.deregister(c))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function rJ(e){const[t,n]=P0e(),r=z.useContext(kY);return o.jsx(mwe,{...e,layoutGroup:r,switchLayoutGroup:z.useContext(LK),isPresent:t,safeToRemove:n})}const gwe={borderRadius:{...h1,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:h1,borderTopRightRadius:h1,borderBottomLeftRadius:h1,borderBottomRightRadius:h1,boxShadow:pwe};function ywe(e,t,n){const r=nu(e)?e:K0(e);return r.start(gz("",r,t,n)),r.animation}const vwe=(e,t)=>e.depth-t.depth;class xwe{constructor(){this.children=[],this.isDirty=!1}add(t){U3(this.children,t),this.isDirty=!0}remove(t){V3(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(vwe),this.isDirty=!1,this.children.forEach(t)}}function _we(e,t){const n=Ku.now(),r=({timestamp:c})=>{const f=c-n;f>=t&&(sv(r),e(f-t))};return Io.setup(r,!0),()=>sv(r)}const iJ=["TopLeft","TopRight","BottomLeft","BottomRight"],bwe=iJ.length,XU=e=>typeof e=="string"?parseFloat(e):e,ZU=e=>typeof e=="number"||cs.test(e);function wwe(e,t,n,r,c,f){c?(e.opacity=Wo(0,n.opacity??1,Swe(r)),e.opacityExit=Wo(t.opacity??1,0,Twe(r))):f&&(e.opacity=Wo(t.opacity??1,n.opacity??1,r));for(let p=0;p<bwe;p++){const s=`border${iJ[p]}Radius`;let w=YU(t,s),T=YU(n,s);if(w===void 0&&T===void 0)continue;w||(w=0),T||(T=0),w===0||T===0||ZU(w)===ZU(T)?(e[s]=Math.max(Wo(XU(w),XU(T),r),0),(tm.test(T)||tm.test(w))&&(e[s]+="%")):e[s]=T}(t.rotate||n.rotate)&&(e.rotate=Wo(t.rotate||0,n.rotate||0,r))}function YU(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Swe=sJ(0,.5,GY),Twe=sJ(.5,.95,Bh);function sJ(e,t,n){return r=>r<e?0:r>t?1:n(rS(e,t,r))}function KU(e,t){e.min=t.min,e.max=t.max}function Nh(e,t){KU(e.x,t.x),KU(e.y,t.y)}function JU(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function QU(e,t,n,r,c){return e-=t,e=pj(e,1/n,r),c!==void 0&&(e=pj(e,1/c,r)),e}function Awe(e,t=0,n=1,r=.5,c,f=e,p=e){if(tm.test(t)&&(t=parseFloat(t),t=Wo(p.min,p.max,t/100)-p.min),typeof t!="number")return;let s=Wo(f.min,f.max,r);e===f&&(s-=t),e.min=QU(e.min,t,n,s,c),e.max=QU(e.max,t,n,s,c)}function eV(e,t,[n,r,c],f,p){Awe(e,t[n],t[r],t[c],t.scale,f,p)}const jwe=["x","scaleX","originX"],Ewe=["y","scaleY","originY"];function tV(e,t,n,r){eV(e.x,t,jwe,n?n.x:void 0,r?r.x:void 0),eV(e.y,t,Ewe,n?n.y:void 0,r?r.y:void 0)}function nV(e){return e.translate===0&&e.scale===1}function aJ(e){return nV(e.x)&&nV(e.y)}function rV(e,t){return e.min===t.min&&e.max===t.max}function Cwe(e,t){return rV(e.x,t.x)&&rV(e.y,t.y)}function iV(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function oJ(e,t){return iV(e.x,t.x)&&iV(e.y,t.y)}function sV(e){return _u(e.x)/_u(e.y)}function aV(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class Nwe{constructor(){this.members=[]}add(t){U3(this.members,t),t.scheduleRender()}remove(t){if(V3(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(c=>t===c);if(n===0)return!1;let r;for(let c=n;c>=0;c--){const f=this.members[c];if(f.isPresent!==!1){r=f;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:c}=t.options;c===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Pwe(e,t,n){let r="";const c=e.x.translate/t.x,f=e.y.translate/t.y,p=n?.z||0;if((c||f||p)&&(r=`translate3d(${c}px, ${f}px, ${p}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:T,rotate:E,rotateX:N,rotateY:D,skewX:V,skewY:$}=n;T&&(r=`perspective(${T}px) ${r}`),E&&(r+=`rotate(${E}deg) `),N&&(r+=`rotateX(${N}deg) `),D&&(r+=`rotateY(${D}deg) `),V&&(r+=`skewX(${V}deg) `),$&&(r+=`skewY(${$}deg) `)}const s=e.x.scale*t.x,w=e.y.scale*t.y;return(s!==1||w!==1)&&(r+=`scale(${s}, ${w})`),r||"none"}const iM=["","X","Y","Z"],Mwe=1e3;let Rwe=0;function sM(e,t,n,r){const{latestValues:c}=t;c[e]&&(n[e]=c[e],t.setStaticValue(e,0),r&&(r[e]=0))}function lJ(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=WK(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:c,layoutId:f}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",Io,!(c||f))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&lJ(r)}function cJ({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:c}){return class{constructor(p={},s=t?.()){this.id=Rwe++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(kwe),this.nodes.forEach(Fwe),this.nodes.forEach(Bwe),this.nodes.forEach(Iwe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=p,this.root=s?s.root||s:this,this.path=s?[...s.path,s]:[],this.parent=s,this.depth=s?s.depth+1:0;for(let w=0;w<this.path.length;w++)this.path[w].shouldResetTransform=!0;this.root===this&&(this.nodes=new xwe)}addEventListener(p,s){return this.eventHandlers.has(p)||this.eventHandlers.set(p,new H3),this.eventHandlers.get(p).add(s)}notifyListeners(p,...s){const w=this.eventHandlers.get(p);w&&w.notify(...s)}hasListeners(p){return this.eventHandlers.has(p)}mount(p){if(this.instance)return;this.isSVG=TK(p)&&!E0e(p),this.instance=p;const{layoutId:s,layout:w,visualElement:T}=this.options;if(T&&!T.current&&T.mount(p),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(w||s)&&(this.isLayoutDirty=!0),e){let E,N=0;const D=()=>this.root.updateBlockedByResize=!1;Io.read(()=>{N=window.innerWidth}),e(p,()=>{const V=window.innerWidth;V!==N&&(N=V,this.root.updateBlockedByResize=!0,E&&E(),E=_we(D,250),zA.hasAnimatedSinceResize&&(zA.hasAnimatedSinceResize=!1,this.nodes.forEach(cV)))})}s&&this.root.registerSharedNode(s,this),this.options.animate!==!1&&T&&(s||w)&&this.addEventListener("didUpdate",({delta:E,hasLayoutChanged:N,hasRelativeLayoutChanged:D,layout:V})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const $=this.options.transition||T.getDefaultTransition()||Hwe,{onLayoutAnimationStart:B,onLayoutAnimationComplete:F}=T.getProps(),K=!this.targetLayout||!oJ(this.targetLayout,V),Y=!N&&D;if(this.options.layoutRoot||this.resumeFrom||Y||N&&(K||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const X={...iz($,"layout"),onPlay:B,onComplete:F};(T.shouldReduceMotion||this.options.layoutRoot)&&(X.delay=0,X.type=!1),this.startAnimation(X),this.setAnimationOrigin(E,Y)}else N||cV(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=V})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const p=this.getStack();p&&p.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),sv(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Uwe),this.animationId++)}getTransformTemplate(){const{visualElement:p}=this.options;return p&&p.getProps().transformTemplate}willUpdate(p=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&lJ(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let E=0;E<this.path.length;E++){const N=this.path[E];N.shouldResetTransform=!0,N.updateScroll("snapshot"),N.options.layoutRoot&&N.willUpdate(!1)}const{layoutId:s,layout:w}=this.options;if(s===void 0&&!w)return;const T=this.getTransformTemplate();this.prevTransformTemplateValue=T?T(this.latestValues,""):void 0,this.updateSnapshot(),p&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(oV);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(lV);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(zwe),this.nodes.forEach(Owe),this.nodes.forEach(Dwe)):this.nodes.forEach(lV),this.clearAllSnapshots();const s=Ku.now();jc.delta=Cg(0,1e3/60,s-jc.timestamp),jc.timestamp=s,jc.isProcessing=!0,WP.update.process(jc),WP.preRender.process(jc),WP.render.process(jc),jc.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,az.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Lwe),this.sharedNodes.forEach(Vwe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Io.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Io.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!_u(this.snapshot.measuredBox.x)&&!_u(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let w=0;w<this.path.length;w++)this.path[w].updateScroll();const p=this.layout;this.layout=this.measure(!1),this.layoutCorrected=hl(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:s}=this.options;s&&s.notify("LayoutMeasure",this.layout.layoutBox,p?p.layoutBox:void 0)}updateScroll(p="measure"){let s=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===p&&(s=!1),s&&this.instance){const w=r(this.instance);this.scroll={animationId:this.root.animationId,phase:p,isRoot:w,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:w}}}resetTransform(){if(!c)return;const p=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,s=this.projectionDelta&&!aJ(this.projectionDelta),w=this.getTransformTemplate(),T=w?w(this.latestValues,""):void 0,E=T!==this.prevTransformTemplateValue;p&&this.instance&&(s||Cx(this.latestValues)||E)&&(c(this.instance,T),this.shouldResetTransform=!1,this.scheduleRender())}measure(p=!0){const s=this.measurePageBox();let w=this.removeElementScroll(s);return p&&(w=this.removeTransform(w)),Gwe(w),{animationId:this.root.animationId,measuredBox:s,layoutBox:w,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:p}=this.options;if(!p)return hl();const s=p.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(Wwe))){const{scroll:T}=this.root;T&&(C0(s.x,T.offset.x),C0(s.y,T.offset.y))}return s}removeElementScroll(p){const s=hl();if(Nh(s,p),this.scroll?.wasRoot)return s;for(let w=0;w<this.path.length;w++){const T=this.path[w],{scroll:E,options:N}=T;T!==this.root&&E&&N.layoutScroll&&(E.wasRoot&&Nh(s,p),C0(s.x,E.offset.x),C0(s.y,E.offset.y))}return s}applyTransform(p,s=!1){const w=hl();Nh(w,p);for(let T=0;T<this.path.length;T++){const E=this.path[T];!s&&E.options.layoutScroll&&E.scroll&&E!==E.root&&N0(w,{x:-E.scroll.offset.x,y:-E.scroll.offset.y}),Cx(E.latestValues)&&N0(w,E.latestValues)}return Cx(this.latestValues)&&N0(w,this.latestValues),w}removeTransform(p){const s=hl();Nh(s,p);for(let w=0;w<this.path.length;w++){const T=this.path[w];if(!T.instance||!Cx(T.latestValues))continue;sI(T.latestValues)&&T.updateSnapshot();const E=hl(),N=T.measurePageBox();Nh(E,N),tV(s,T.latestValues,T.snapshot?T.snapshot.layoutBox:void 0,E)}return Cx(this.latestValues)&&tV(s,this.latestValues),s}setTargetDelta(p){this.targetDelta=p,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(p){this.options={...this.options,...p,crossfade:p.crossfade!==void 0?p.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==jc.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(p=!1){const s=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=s.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=s.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=s.isSharedProjectionDirty);const w=!!this.resumingFrom||this!==s;if(!(p||w&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:E,layoutId:N}=this.options;if(!(!this.layout||!(E||N))){if(this.resolvedRelativeTargetAt=jc.timestamp,!this.targetDelta&&!this.relativeTarget){const D=this.getClosestProjectingParent();D&&D.layout&&this.animationProgress!==1?(this.relativeParent=D,this.forceRelativeParentToResolveTarget(),this.relativeTarget=hl(),this.relativeTargetOrigin=hl(),U1(this.relativeTargetOrigin,this.layout.layoutBox,D.layout.layoutBox),Nh(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=hl(),this.targetWithTransforms=hl()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Qbe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Nh(this.target,this.layout.layoutBox),UK(this.target,this.targetDelta)):Nh(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const D=this.getClosestProjectingParent();D&&!!D.resumingFrom==!!this.resumingFrom&&!D.options.layoutScroll&&D.target&&this.animationProgress!==1?(this.relativeParent=D,this.forceRelativeParentToResolveTarget(),this.relativeTarget=hl(),this.relativeTargetOrigin=hl(),U1(this.relativeTargetOrigin,this.target,D.target),Nh(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||sI(this.parent.latestValues)||BK(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const p=this.getLead(),s=!!this.resumingFrom||this!==p;let w=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(w=!1),s&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(w=!1),this.resolvedRelativeTargetAt===jc.timestamp&&(w=!1),w)return;const{layout:T,layoutId:E}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(T||E))return;Nh(this.layoutCorrected,this.layout.layoutBox);const N=this.treeScale.x,D=this.treeScale.y;dbe(this.layoutCorrected,this.treeScale,this.path,s),p.layout&&!p.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(p.target=p.layout.layoutBox,p.targetWithTransforms=hl());const{target:V}=p;if(!V){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(JU(this.prevProjectionDelta.x,this.projectionDelta.x),JU(this.prevProjectionDelta.y,this.projectionDelta.y)),B1(this.projectionDelta,this.layoutCorrected,V,this.latestValues),(this.treeScale.x!==N||this.treeScale.y!==D||!aV(this.projectionDelta.x,this.prevProjectionDelta.x)||!aV(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",V))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(p=!0){if(this.options.visualElement?.scheduleRender(),p){const s=this.getStack();s&&s.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=P0(),this.projectionDelta=P0(),this.projectionDeltaWithTransform=P0()}setAnimationOrigin(p,s=!1){const w=this.snapshot,T=w?w.latestValues:{},E={...this.latestValues},N=P0();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!s;const D=hl(),V=w?w.source:void 0,$=this.layout?this.layout.source:void 0,B=V!==$,F=this.getStack(),K=!F||F.members.length<=1,Y=!!(B&&!K&&this.options.crossfade===!0&&!this.path.some(qwe));this.animationProgress=0;let X;this.mixTargetDelta=ae=>{const Z=ae/1e3;uV(N.x,p.x,Z),uV(N.y,p.y,Z),this.setTargetDelta(N),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(U1(D,this.layout.layoutBox,this.relativeParent.layout.layoutBox),$we(this.relativeTarget,this.relativeTargetOrigin,D,Z),X&&Cwe(this.relativeTarget,X)&&(this.isProjectionDirty=!1),X||(X=hl()),Nh(X,this.relativeTarget)),B&&(this.animationValues=E,wwe(E,T,this.latestValues,Z,Y,K)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=Z},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(p){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(sv(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Io.update(()=>{zA.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=K0(0)),this.currentAnimation=ywe(this.motionValue,[0,1e3],{...p,velocity:0,isSync:!0,onUpdate:s=>{this.mixTargetDelta(s),p.onUpdate&&p.onUpdate(s)},onStop:()=>{},onComplete:()=>{p.onComplete&&p.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const p=this.getStack();p&&p.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Mwe),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const p=this.getLead();let{targetWithTransforms:s,target:w,layout:T,latestValues:E}=p;if(!(!s||!w||!T)){if(this!==p&&this.layout&&T&&uJ(this.options.animationType,this.layout.layoutBox,T.layoutBox)){w=this.target||hl();const N=_u(this.layout.layoutBox.x);w.x.min=p.target.x.min,w.x.max=w.x.min+N;const D=_u(this.layout.layoutBox.y);w.y.min=p.target.y.min,w.y.max=w.y.min+D}Nh(s,w),N0(s,E),B1(this.projectionDeltaWithTransform,this.layoutCorrected,s,E)}}registerSharedNode(p,s){this.sharedNodes.has(p)||this.sharedNodes.set(p,new Nwe),this.sharedNodes.get(p).add(s);const T=s.options.initialPromotionConfig;s.promote({transition:T?T.transition:void 0,preserveFollowOpacity:T&&T.shouldPreserveFollowOpacity?T.shouldPreserveFollowOpacity(s):void 0})}isLead(){const p=this.getStack();return p?p.lead===this:!0}getLead(){const{layoutId:p}=this.options;return p?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:p}=this.options;return p?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:p}=this.options;if(p)return this.root.sharedNodes.get(p)}promote({needsReset:p,transition:s,preserveFollowOpacity:w}={}){const T=this.getStack();T&&T.promote(this,w),p&&(this.projectionDelta=void 0,this.needsReset=!0),s&&this.setOptions({transition:s})}relegate(){const p=this.getStack();return p?p.relegate(this):!1}resetSkewAndRotation(){const{visualElement:p}=this.options;if(!p)return;let s=!1;const{latestValues:w}=p;if((w.z||w.rotate||w.rotateX||w.rotateY||w.rotateZ||w.skewX||w.skewY)&&(s=!0),!s)return;const T={};w.z&&sM("z",p,T,this.animationValues);for(let E=0;E<iM.length;E++)sM(`rotate${iM[E]}`,p,T,this.animationValues),sM(`skew${iM[E]}`,p,T,this.animationValues);p.render();for(const E in T)p.setStaticValue(E,T[E]),this.animationValues&&(this.animationValues[E]=T[E]);p.scheduleRender()}applyProjectionStyles(p,s){if(!this.instance||this.isSVG)return;if(!this.isVisible){p.visibility="hidden";return}const w=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,p.visibility="",p.opacity="",p.pointerEvents=LA(s?.pointerEvents)||"",p.transform=w?w(this.latestValues,""):"none";return}const T=this.getLead();if(!this.projectionDelta||!this.layout||!T.target){this.options.layoutId&&(p.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,p.pointerEvents=LA(s?.pointerEvents)||""),this.hasProjected&&!Cx(this.latestValues)&&(p.transform=w?w({},""):"none",this.hasProjected=!1);return}p.visibility="";const E=T.animationValues||T.latestValues;this.applyTransformsToTarget();let N=Pwe(this.projectionDeltaWithTransform,this.treeScale,E);w&&(N=w(E,N)),p.transform=N;const{x:D,y:V}=this.projectionDelta;p.transformOrigin=`${D.origin*100}% ${V.origin*100}% 0`,T.animationValues?p.opacity=T===this?E.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:E.opacityExit:p.opacity=T===this?E.opacity!==void 0?E.opacity:"":E.opacityExit!==void 0?E.opacityExit:0;for(const $ in oS){if(E[$]===void 0)continue;const{correct:B,applyTo:F,isCSSVariable:K}=oS[$],Y=N==="none"?E[$]:B(E[$],T);if(F){const X=F.length;for(let ae=0;ae<X;ae++)p[F[ae]]=Y}else K?this.options.visualElement.renderState.vars[$]=Y:p[$]=Y}this.options.layoutId&&(p.pointerEvents=T===this?LA(s?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(p=>p.currentAnimation?.stop()),this.root.nodes.forEach(oV),this.root.sharedNodes.clear()}}}function Owe(e){e.updateLayout()}function Dwe(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:r}=e.layout,{animationType:c}=e.options,f=t.source!==e.layout.source;c==="size"?Oh(E=>{const N=f?t.measuredBox[E]:t.layoutBox[E],D=_u(N);N.min=n[E].min,N.max=N.min+D}):uJ(c,t.layoutBox,n)&&Oh(E=>{const N=f?t.measuredBox[E]:t.layoutBox[E],D=_u(n[E]);N.max=N.min+D,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[E].max=e.relativeTarget[E].min+D)});const p=P0();B1(p,n,t.layoutBox);const s=P0();f?B1(s,e.applyTransform(r,!0),t.measuredBox):B1(s,n,t.layoutBox);const w=!aJ(p);let T=!1;if(!e.resumeFrom){const E=e.getClosestProjectingParent();if(E&&!E.resumeFrom){const{snapshot:N,layout:D}=E;if(N&&D){const V=hl();U1(V,t.layoutBox,N.layoutBox);const $=hl();U1($,n,D.layoutBox),oJ(V,$)||(T=!0),E.options.layoutRoot&&(e.relativeTarget=$,e.relativeTargetOrigin=V,e.relativeParent=E)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:t,delta:s,layoutDelta:p,hasLayoutChanged:w,hasRelativeLayoutChanged:T})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function kwe(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Iwe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Lwe(e){e.clearSnapshot()}function oV(e){e.clearMeasurements()}function lV(e){e.isLayoutDirty=!1}function zwe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function cV(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Fwe(e){e.resolveTargetDelta()}function Bwe(e){e.calcProjection()}function Uwe(e){e.resetSkewAndRotation()}function Vwe(e){e.removeLeadSnapshot()}function uV(e,t,n){e.translate=Wo(t.translate,0,n),e.scale=Wo(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function dV(e,t,n,r){e.min=Wo(t.min,n.min,r),e.max=Wo(t.max,n.max,r)}function $we(e,t,n,r){dV(e.x,t.x,n.x,r),dV(e.y,t.y,n.y,r)}function qwe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Hwe={duration:.45,ease:[.4,0,.1,1]},hV=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),fV=hV("applewebkit/")&&!hV("chrome/")?Math.round:Bh;function pV(e){e.min=fV(e.min),e.max=fV(e.max)}function Gwe(e){pV(e.x),pV(e.y)}function uJ(e,t,n){return e==="position"||e==="preserve-aspect"&&!Jbe(sV(t),sV(n),.2)}function Wwe(e){return e!==e.root&&e.scroll?.wasRoot}const Xwe=cJ({attachResizeListener:(e,t)=>lS(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),aM={current:void 0},dJ=cJ({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!aM.current){const e=new Xwe({});e.mount(window),e.setOptions({layoutScroll:!0}),aM.current=e}return aM.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Zwe={pan:{Feature:fwe},drag:{Feature:hwe,ProjectionNode:dJ,MeasureLayout:rJ}};function mV(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const c="onHover"+n,f=r[c];f&&Io.postRender(()=>f(t,xT(t)))}class Ywe extends hv{mount(){const{current:t}=this.node;t&&(this.unmount=w0e(t,(n,r)=>(mV(this.node,r,"Start"),c=>mV(this.node,c,"End"))))}unmount(){}}class Kwe extends hv{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=gT(lS(this.node.current,"focus",()=>this.onFocus()),lS(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function gV(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const c="onTap"+(n==="End"?"":n),f=r[c];f&&Io.postRender(()=>f(t,xT(t)))}class Jwe extends hv{mount(){const{current:t}=this.node;t&&(this.unmount=j0e(t,(n,r)=>(gV(this.node,r,"Start"),(c,{success:f})=>gV(this.node,c,f?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const hI=new WeakMap,oM=new WeakMap,Qwe=e=>{const t=hI.get(e.target);t&&t(e)},e1e=e=>{e.forEach(Qwe)};function t1e({root:e,...t}){const n=e||document;oM.has(n)||oM.set(n,{});const r=oM.get(n),c=JSON.stringify(t);return r[c]||(r[c]=new IntersectionObserver(e1e,{root:e,...t})),r[c]}function n1e(e,t,n){const r=t1e(t);return hI.set(e,n),r.observe(e),()=>{hI.delete(e),r.unobserve(e)}}const r1e={some:0,all:1};class i1e extends hv{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:c="some",once:f}=t,p={root:n?n.current:void 0,rootMargin:r,threshold:typeof c=="number"?c:r1e[c]},s=w=>{const{isIntersecting:T}=w;if(this.isInView===T||(this.isInView=T,f&&!T&&this.hasEnteredView))return;T&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",T);const{onViewportEnter:E,onViewportLeave:N}=this.node.getProps(),D=T?E:N;D&&D(w)};return n1e(this.node.current,p,s)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(s1e(t,n))&&this.startObserver()}unmount(){}}function s1e({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const a1e={inView:{Feature:i1e},tap:{Feature:Jwe},focus:{Feature:Kwe},hover:{Feature:Ywe}},o1e={layout:{ProjectionNode:dJ,MeasureLayout:rJ}},l1e={...Gbe,...a1e,...Zwe,...o1e},ju=lbe(l1e,bbe),c1e="/assets/ironpattern-CiRMqoUU.png";function u1e(){return o.jsxs(o.Fragment,{children:[o.jsx("title",{children:"JOLI - Login"}),o.jsxs("div",{className:"flex min-h-svh w-full flex-col items-center justify-center p-6 md:p-10 relative",children:[o.jsx(KS,{richColors:!0}),o.jsx(ju.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute top-4 left-1/2 -translate-x-1/2 md:top-6 md:left-6 md:translate-x-0",children:o.jsx(Yl,{to:"/",children:o.jsx("img",{src:Vk,className:"w-32 md:w-56",alt:"Logo"})})}),o.jsx(ju.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"w-full max-w-sm sm:max-w-md md:max-w-lg lg:max-w-xl mt-20 md:mt-0",children:o.jsx(Pxe,{})}),o.jsx("div",{className:"absolute inset-0 -z-50 bg-repeat",style:{backgroundImage:`url(${c1e})`}})]})]})}function d1e(){const e=d_();return o.jsxs(ju.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:[o.jsx(bt,{style:{marginBottom:"1rem"},children:"Looks like you've wandered too far"}),o.jsx(kt,{style:{marginBottom:"0.5rem"},onClick:()=>e(-1),children:"Go Back to previous location"}),o.jsx(kt,{variant:"secondary",onClick:()=>e("/"),children:"Go Home"})]})}var lM,yV;function rd(){if(yV)return lM;yV=1;var e=Array.isArray;return lM=e,lM}var cM,vV;function hJ(){if(vV)return cM;vV=1;var e=typeof G2=="object"&&G2&&G2.Object===Object&&G2;return cM=e,cM}var uM,xV;function um(){if(xV)return uM;xV=1;var e=hJ(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return uM=n,uM}var dM,_V;function _T(){if(_V)return dM;_V=1;var e=um(),t=e.Symbol;return dM=t,dM}var hM,bV;function h1e(){if(bV)return hM;bV=1;var e=_T(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,c=e?e.toStringTag:void 0;function f(p){var s=n.call(p,c),w=p[c];try{p[c]=void 0;var T=!0}catch{}var E=r.call(p);return T&&(s?p[c]=w:delete p[c]),E}return hM=f,hM}var fM,wV;function f1e(){if(wV)return fM;wV=1;var e=Object.prototype,t=e.toString;function n(r){return t.call(r)}return fM=n,fM}var pM,SV;function Dg(){if(SV)return pM;SV=1;var e=_T(),t=h1e(),n=f1e(),r="[object Null]",c="[object Undefined]",f=e?e.toStringTag:void 0;function p(s){return s==null?s===void 0?c:r:f&&f in Object(s)?t(s):n(s)}return pM=p,pM}var mM,TV;function kg(){if(TV)return mM;TV=1;function e(t){return t!=null&&typeof t=="object"}return mM=e,mM}var gM,AV;function Ub(){if(AV)return gM;AV=1;var e=Dg(),t=kg(),n="[object Symbol]";function r(c){return typeof c=="symbol"||t(c)&&e(c)==n}return gM=r,gM}var yM,jV;function yz(){if(jV)return yM;jV=1;var e=rd(),t=Ub(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function c(f,p){if(e(f))return!1;var s=typeof f;return s=="number"||s=="symbol"||s=="boolean"||f==null||t(f)?!0:r.test(f)||!n.test(f)||p!=null&&f in Object(p)}return yM=c,yM}var vM,EV;function fv(){if(EV)return vM;EV=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return vM=e,vM}var xM,CV;function vz(){if(CV)return xM;CV=1;var e=Dg(),t=fv(),n="[object AsyncFunction]",r="[object Function]",c="[object GeneratorFunction]",f="[object Proxy]";function p(s){if(!t(s))return!1;var w=e(s);return w==r||w==c||w==n||w==f}return xM=p,xM}var _M,NV;function p1e(){if(NV)return _M;NV=1;var e=um(),t=e["__core-js_shared__"];return _M=t,_M}var bM,PV;function m1e(){if(PV)return bM;PV=1;var e=p1e(),t=(function(){var r=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""})();function n(r){return!!t&&t in r}return bM=n,bM}var wM,MV;function fJ(){if(MV)return wM;MV=1;var e=Function.prototype,t=e.toString;function n(r){if(r!=null){try{return t.call(r)}catch{}try{return r+""}catch{}}return""}return wM=n,wM}var SM,RV;function g1e(){if(RV)return SM;RV=1;var e=vz(),t=m1e(),n=fv(),r=fJ(),c=/[\\^$.*+?()[\]{}|]/g,f=/^\[object .+?Constructor\]$/,p=Function.prototype,s=Object.prototype,w=p.toString,T=s.hasOwnProperty,E=RegExp("^"+w.call(T).replace(c,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function N(D){if(!n(D)||t(D))return!1;var V=e(D)?E:f;return V.test(r(D))}return SM=N,SM}var TM,OV;function y1e(){if(OV)return TM;OV=1;function e(t,n){return t?.[n]}return TM=e,TM}var AM,DV;function p_(){if(DV)return AM;DV=1;var e=g1e(),t=y1e();function n(r,c){var f=t(r,c);return e(f)?f:void 0}return AM=n,AM}var jM,kV;function pC(){if(kV)return jM;kV=1;var e=p_(),t=e(Object,"create");return jM=t,jM}var EM,IV;function v1e(){if(IV)return EM;IV=1;var e=pC();function t(){this.__data__=e?e(null):{},this.size=0}return EM=t,EM}var CM,LV;function x1e(){if(LV)return CM;LV=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return CM=e,CM}var NM,zV;function _1e(){if(zV)return NM;zV=1;var e=pC(),t="__lodash_hash_undefined__",n=Object.prototype,r=n.hasOwnProperty;function c(f){var p=this.__data__;if(e){var s=p[f];return s===t?void 0:s}return r.call(p,f)?p[f]:void 0}return NM=c,NM}var PM,FV;function b1e(){if(FV)return PM;FV=1;var e=pC(),t=Object.prototype,n=t.hasOwnProperty;function r(c){var f=this.__data__;return e?f[c]!==void 0:n.call(f,c)}return PM=r,PM}var MM,BV;function w1e(){if(BV)return MM;BV=1;var e=pC(),t="__lodash_hash_undefined__";function n(r,c){var f=this.__data__;return this.size+=this.has(r)?0:1,f[r]=e&&c===void 0?t:c,this}return MM=n,MM}var RM,UV;function S1e(){if(UV)return RM;UV=1;var e=v1e(),t=x1e(),n=_1e(),r=b1e(),c=w1e();function f(p){var s=-1,w=p==null?0:p.length;for(this.clear();++s<w;){var T=p[s];this.set(T[0],T[1])}}return f.prototype.clear=e,f.prototype.delete=t,f.prototype.get=n,f.prototype.has=r,f.prototype.set=c,RM=f,RM}var OM,VV;function T1e(){if(VV)return OM;VV=1;function e(){this.__data__=[],this.size=0}return OM=e,OM}var DM,$V;function xz(){if($V)return DM;$V=1;function e(t,n){return t===n||t!==t&&n!==n}return DM=e,DM}var kM,qV;function mC(){if(qV)return kM;qV=1;var e=xz();function t(n,r){for(var c=n.length;c--;)if(e(n[c][0],r))return c;return-1}return kM=t,kM}var IM,HV;function A1e(){if(HV)return IM;HV=1;var e=mC(),t=Array.prototype,n=t.splice;function r(c){var f=this.__data__,p=e(f,c);if(p<0)return!1;var s=f.length-1;return p==s?f.pop():n.call(f,p,1),--this.size,!0}return IM=r,IM}var LM,GV;function j1e(){if(GV)return LM;GV=1;var e=mC();function t(n){var r=this.__data__,c=e(r,n);return c<0?void 0:r[c][1]}return LM=t,LM}var zM,WV;function E1e(){if(WV)return zM;WV=1;var e=mC();function t(n){return e(this.__data__,n)>-1}return zM=t,zM}var FM,XV;function C1e(){if(XV)return FM;XV=1;var e=mC();function t(n,r){var c=this.__data__,f=e(c,n);return f<0?(++this.size,c.push([n,r])):c[f][1]=r,this}return FM=t,FM}var BM,ZV;function gC(){if(ZV)return BM;ZV=1;var e=T1e(),t=A1e(),n=j1e(),r=E1e(),c=C1e();function f(p){var s=-1,w=p==null?0:p.length;for(this.clear();++s<w;){var T=p[s];this.set(T[0],T[1])}}return f.prototype.clear=e,f.prototype.delete=t,f.prototype.get=n,f.prototype.has=r,f.prototype.set=c,BM=f,BM}var UM,YV;function _z(){if(YV)return UM;YV=1;var e=p_(),t=um(),n=e(t,"Map");return UM=n,UM}var VM,KV;function N1e(){if(KV)return VM;KV=1;var e=S1e(),t=gC(),n=_z();function r(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return VM=r,VM}var $M,JV;function P1e(){if(JV)return $M;JV=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return $M=e,$M}var qM,QV;function yC(){if(QV)return qM;QV=1;var e=P1e();function t(n,r){var c=n.__data__;return e(r)?c[typeof r=="string"?"string":"hash"]:c.map}return qM=t,qM}var HM,e$;function M1e(){if(e$)return HM;e$=1;var e=yC();function t(n){var r=e(this,n).delete(n);return this.size-=r?1:0,r}return HM=t,HM}var GM,t$;function R1e(){if(t$)return GM;t$=1;var e=yC();function t(n){return e(this,n).get(n)}return GM=t,GM}var WM,n$;function O1e(){if(n$)return WM;n$=1;var e=yC();function t(n){return e(this,n).has(n)}return WM=t,WM}var XM,r$;function D1e(){if(r$)return XM;r$=1;var e=yC();function t(n,r){var c=e(this,n),f=c.size;return c.set(n,r),this.size+=c.size==f?0:1,this}return XM=t,XM}var ZM,i$;function bz(){if(i$)return ZM;i$=1;var e=N1e(),t=M1e(),n=R1e(),r=O1e(),c=D1e();function f(p){var s=-1,w=p==null?0:p.length;for(this.clear();++s<w;){var T=p[s];this.set(T[0],T[1])}}return f.prototype.clear=e,f.prototype.delete=t,f.prototype.get=n,f.prototype.has=r,f.prototype.set=c,ZM=f,ZM}var YM,s$;function pJ(){if(s$)return YM;s$=1;var e=bz(),t="Expected a function";function n(r,c){if(typeof r!="function"||c!=null&&typeof c!="function")throw new TypeError(t);var f=function(){var p=arguments,s=c?c.apply(this,p):p[0],w=f.cache;if(w.has(s))return w.get(s);var T=r.apply(this,p);return f.cache=w.set(s,T)||w,T};return f.cache=new(n.Cache||e),f}return n.Cache=e,YM=n,YM}var KM,a$;function k1e(){if(a$)return KM;a$=1;var e=pJ(),t=500;function n(r){var c=e(r,function(p){return f.size===t&&f.clear(),p}),f=c.cache;return c}return KM=n,KM}var JM,o$;function I1e(){if(o$)return JM;o$=1;var e=k1e(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=e(function(c){var f=[];return c.charCodeAt(0)===46&&f.push(""),c.replace(t,function(p,s,w,T){f.push(w?T.replace(n,"$1"):s||p)}),f});return JM=r,JM}var QM,l$;function wz(){if(l$)return QM;l$=1;function e(t,n){for(var r=-1,c=t==null?0:t.length,f=Array(c);++r<c;)f[r]=n(t[r],r,t);return f}return QM=e,QM}var eR,c$;function L1e(){if(c$)return eR;c$=1;var e=_T(),t=wz(),n=rd(),r=Ub(),c=e?e.prototype:void 0,f=c?c.toString:void 0;function p(s){if(typeof s=="string")return s;if(n(s))return t(s,p)+"";if(r(s))return f?f.call(s):"";var w=s+"";return w=="0"&&1/s==-1/0?"-0":w}return eR=p,eR}var tR,u$;function mJ(){if(u$)return tR;u$=1;var e=L1e();function t(n){return n==null?"":e(n)}return tR=t,tR}var nR,d$;function gJ(){if(d$)return nR;d$=1;var e=rd(),t=yz(),n=I1e(),r=mJ();function c(f,p){return e(f)?f:t(f,p)?[f]:n(r(f))}return nR=c,nR}var rR,h$;function vC(){if(h$)return rR;h$=1;var e=Ub();function t(n){if(typeof n=="string"||e(n))return n;var r=n+"";return r=="0"&&1/n==-1/0?"-0":r}return rR=t,rR}var iR,f$;function Sz(){if(f$)return iR;f$=1;var e=gJ(),t=vC();function n(r,c){c=e(c,r);for(var f=0,p=c.length;r!=null&&f<p;)r=r[t(c[f++])];return f&&f==p?r:void 0}return iR=n,iR}var sR,p$;function yJ(){if(p$)return sR;p$=1;var e=Sz();function t(n,r,c){var f=n==null?void 0:e(n,r);return f===void 0?c:f}return sR=t,sR}var z1e=yJ();const Zd=Ca(z1e);var aR,m$;function F1e(){if(m$)return aR;m$=1;function e(t){return t==null}return aR=e,aR}var B1e=F1e();const xs=Ca(B1e);var oR,g$;function U1e(){if(g$)return oR;g$=1;var e=Dg(),t=rd(),n=kg(),r="[object String]";function c(f){return typeof f=="string"||!t(f)&&n(f)&&e(f)==r}return oR=c,oR}var V1e=U1e();const e_=Ca(V1e);var $1e=vz();const as=Ca($1e);var q1e=fv();const Vb=Ca(q1e);var lR={exports:{}},Fa={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y$;function H1e(){if(y$)return Fa;y$=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),p=Symbol.for("react.context"),s=Symbol.for("react.server_context"),w=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),V=Symbol.for("react.offscreen"),$;$=Symbol.for("react.module.reference");function B(F){if(typeof F=="object"&&F!==null){var K=F.$$typeof;switch(K){case e:switch(F=F.type,F){case n:case c:case r:case T:case E:return F;default:switch(F=F&&F.$$typeof,F){case s:case p:case w:case D:case N:case f:return F;default:return K}}case t:return K}}}return Fa.ContextConsumer=p,Fa.ContextProvider=f,Fa.Element=e,Fa.ForwardRef=w,Fa.Fragment=n,Fa.Lazy=D,Fa.Memo=N,Fa.Portal=t,Fa.Profiler=c,Fa.StrictMode=r,Fa.Suspense=T,Fa.SuspenseList=E,Fa.isAsyncMode=function(){return!1},Fa.isConcurrentMode=function(){return!1},Fa.isContextConsumer=function(F){return B(F)===p},Fa.isContextProvider=function(F){return B(F)===f},Fa.isElement=function(F){return typeof F=="object"&&F!==null&&F.$$typeof===e},Fa.isForwardRef=function(F){return B(F)===w},Fa.isFragment=function(F){return B(F)===n},Fa.isLazy=function(F){return B(F)===D},Fa.isMemo=function(F){return B(F)===N},Fa.isPortal=function(F){return B(F)===t},Fa.isProfiler=function(F){return B(F)===c},Fa.isStrictMode=function(F){return B(F)===r},Fa.isSuspense=function(F){return B(F)===T},Fa.isSuspenseList=function(F){return B(F)===E},Fa.isValidElementType=function(F){return typeof F=="string"||typeof F=="function"||F===n||F===c||F===r||F===T||F===E||F===V||typeof F=="object"&&F!==null&&(F.$$typeof===D||F.$$typeof===N||F.$$typeof===f||F.$$typeof===p||F.$$typeof===w||F.$$typeof===$||F.getModuleId!==void 0)},Fa.typeOf=B,Fa}var v$;function G1e(){return v$||(v$=1,lR.exports=H1e()),lR.exports}var W1e=G1e(),cR,x$;function vJ(){if(x$)return cR;x$=1;var e=Dg(),t=kg(),n="[object Number]";function r(c){return typeof c=="number"||t(c)&&e(c)==n}return cR=r,cR}var uR,_$;function X1e(){if(_$)return uR;_$=1;var e=vJ();function t(n){return e(n)&&n!=+n}return uR=t,uR}var Z1e=X1e();const $b=Ca(Z1e);var Y1e=vJ();const K1e=Ca(Y1e);var bu=function(t){return t===0?0:t>0?1:-1},Lx=function(t){return e_(t)&&t.indexOf("%")===t.length-1},jr=function(t){return K1e(t)&&!$b(t)},J1e=function(t){return xs(t)},Zl=function(t){return jr(t)||e_(t)},Q1e=0,m_=function(t){var n=++Q1e;return"".concat(t||"").concat(n)},wu=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!jr(t)&&!e_(t))return r;var f;if(Lx(t)){var p=t.indexOf("%");f=n*parseFloat(t.slice(0,p))/100}else f=+t;return $b(f)&&(f=r),c&&f>n&&(f=n),f},Gy=function(t){if(!t)return null;var n=Object.keys(t);return n&&n.length?t[n[0]]:null},eSe=function(t){if(!Array.isArray(t))return!1;for(var n=t.length,r={},c=0;c<n;c++)if(!r[t[c]])r[t[c]]=!0;else return!0;return!1},Xl=function(t,n){return jr(t)&&jr(n)?function(r){return t+r*(n-t)}:function(){return n}};function mj(e,t,n){return!e||!e.length?null:e.find(function(r){return r&&(typeof t=="function"?t(r):Zd(r,t))===n})}var tSe=function(t,n){return jr(t)&&jr(n)?t-n:e_(t)&&e_(n)?t.localeCompare(n):t instanceof Date&&n instanceof Date?t.getTime()-n.getTime():String(t).localeCompare(String(n))};function V0(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function fI(e){"@babel/helpers - typeof";return fI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fI(e)}var nSe=["viewBox","children"],rSe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],b$=["points","pathLength"],dR={svg:nSe,polygon:b$,polyline:b$},Tz=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],gj=function(t,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(z.isValidElement(t)&&(r=t.props),!Vb(r))return null;var c={};return Object.keys(r).forEach(function(f){Tz.includes(f)&&(c[f]=n||function(p){return r[f](r,p)})}),c},iSe=function(t,n,r){return function(c){return t(n,r,c),null}},t_=function(t,n,r){if(!Vb(t)||fI(t)!=="object")return null;var c=null;return Object.keys(t).forEach(function(f){var p=t[f];Tz.includes(f)&&typeof p=="function"&&(c||(c={}),c[f]=iSe(p,n,r))}),c},sSe=["children"],aSe=["children"];function w$(e,t){if(e==null)return{};var n=oSe(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function oSe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function pI(e){"@babel/helpers - typeof";return pI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pI(e)}var S$={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},wg=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},T$=null,hR=null,Az=function e(t){if(t===T$&&Array.isArray(hR))return hR;var n=[];return z.Children.forEach(t,function(r){xs(r)||(W1e.isFragment(r)?n=n.concat(e(r.props.children)):n.push(r))}),hR=n,T$=t,n};function Yd(e,t){var n=[],r=[];return Array.isArray(t)?r=t.map(function(c){return wg(c)}):r=[wg(t)],Az(e).forEach(function(c){var f=Zd(c,"type.displayName")||Zd(c,"type.name");r.indexOf(f)!==-1&&n.push(c)}),n}function Vd(e,t){var n=Yd(e,t);return n&&n[0]}var A$=function(t){if(!t||!t.props)return!1;var n=t.props,r=n.width,c=n.height;return!(!jr(r)||r<=0||!jr(c)||c<=0)},lSe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],cSe=function(t){return t&&t.type&&e_(t.type)&&lSe.indexOf(t.type)>=0},xJ=function(t){return t&&pI(t)==="object"&&"clipDot"in t},uSe=function(t,n,r,c){var f,p=(f=dR?.[c])!==null&&f!==void 0?f:[];return n.startsWith("data-")||!as(t)&&(c&&p.includes(n)||rSe.includes(n))||r&&Tz.includes(n)},Oi=function(t,n,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var c=t;if(z.isValidElement(t)&&(c=t.props),!Vb(c))return null;var f={};return Object.keys(c).forEach(function(p){var s;uSe((s=c)===null||s===void 0?void 0:s[p],p,n,r)&&(f[p]=c[p])}),f},mI=function e(t,n){if(t===n)return!0;var r=z.Children.count(t);if(r!==z.Children.count(n))return!1;if(r===0)return!0;if(r===1)return j$(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var c=0;c<r;c++){var f=t[c],p=n[c];if(Array.isArray(f)||Array.isArray(p)){if(!e(f,p))return!1}else if(!j$(f,p))return!1}return!0},j$=function(t,n){if(xs(t)&&xs(n))return!0;if(!xs(t)&&!xs(n)){var r=t.props||{},c=r.children,f=w$(r,sSe),p=n.props||{},s=p.children,w=w$(p,aSe);return c&&s?V0(f,w)&&mI(c,s):!c&&!s?V0(f,w):!1}return!1},E$=function(t,n){var r=[],c={};return Az(t).forEach(function(f,p){if(cSe(f))r.push(f);else if(f){var s=wg(f.type),w=n[s]||{},T=w.handler,E=w.once;if(T&&(!E||!c[s])){var N=T(f,s,p);r.push(N),c[s]=!0}}}),r},dSe=function(t){var n=t&&t.type;return n&&S$[n]?S$[n]:null},hSe=function(t,n){return Az(n).indexOf(t)},fSe=["children","width","height","viewBox","className","style","title","desc"];function gI(){return gI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gI.apply(this,arguments)}function pSe(e,t){if(e==null)return{};var n=mSe(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function mSe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function yI(e){var t=e.children,n=e.width,r=e.height,c=e.viewBox,f=e.className,p=e.style,s=e.title,w=e.desc,T=pSe(e,fSe),E=c||{width:n,height:r,x:0,y:0},N=es("recharts-surface",f);return _e.createElement("svg",gI({},Oi(T,!0,"svg"),{className:N,width:n,height:r,style:p,viewBox:"".concat(E.x," ").concat(E.y," ").concat(E.width," ").concat(E.height)}),_e.createElement("title",null,s),_e.createElement("desc",null,w),t)}var gSe=["children","className"];function vI(){return vI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vI.apply(this,arguments)}function ySe(e,t){if(e==null)return{};var n=vSe(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function vSe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var sa=_e.forwardRef(function(e,t){var n=e.children,r=e.className,c=ySe(e,gSe),f=es("recharts-layer",r);return _e.createElement("g",vI({className:f},Oi(c,!0),{ref:t}),n)}),Lf=function(t,n){for(var r=arguments.length,c=new Array(r>2?r-2:0),f=2;f<r;f++)c[f-2]=arguments[f]},fR,C$;function xSe(){if(C$)return fR;C$=1;function e(t,n,r){var c=-1,f=t.length;n<0&&(n=-n>f?0:f+n),r=r>f?f:r,r<0&&(r+=f),f=n>r?0:r-n>>>0,n>>>=0;for(var p=Array(f);++c<f;)p[c]=t[c+n];return p}return fR=e,fR}var pR,N$;function _Se(){if(N$)return pR;N$=1;var e=xSe();function t(n,r,c){var f=n.length;return c=c===void 0?f:c,!r&&c>=f?n:e(n,r,c)}return pR=t,pR}var mR,P$;function _J(){if(P$)return mR;P$=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",c=t+n+r,f="\\ufe0e\\ufe0f",p="\\u200d",s=RegExp("["+p+e+c+f+"]");function w(T){return s.test(T)}return mR=w,mR}var gR,M$;function bSe(){if(M$)return gR;M$=1;function e(t){return t.split("")}return gR=e,gR}var yR,R$;function wSe(){if(R$)return yR;R$=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",c=t+n+r,f="\\ufe0e\\ufe0f",p="["+e+"]",s="["+c+"]",w="\\ud83c[\\udffb-\\udfff]",T="(?:"+s+"|"+w+")",E="[^"+e+"]",N="(?:\\ud83c[\\udde6-\\uddff]){2}",D="[\\ud800-\\udbff][\\udc00-\\udfff]",V="\\u200d",$=T+"?",B="["+f+"]?",F="(?:"+V+"(?:"+[E,N,D].join("|")+")"+B+$+")*",K=B+$+F,Y="(?:"+[E+s+"?",s,N,D,p].join("|")+")",X=RegExp(w+"(?="+w+")|"+Y+K,"g");function ae(Z){return Z.match(X)||[]}return yR=ae,yR}var vR,O$;function SSe(){if(O$)return vR;O$=1;var e=bSe(),t=_J(),n=wSe();function r(c){return t(c)?n(c):e(c)}return vR=r,vR}var xR,D$;function TSe(){if(D$)return xR;D$=1;var e=_Se(),t=_J(),n=SSe(),r=mJ();function c(f){return function(p){p=r(p);var s=t(p)?n(p):void 0,w=s?s[0]:p.charAt(0),T=s?e(s,1).join(""):p.slice(1);return w[f]()+T}}return xR=c,xR}var _R,k$;function ASe(){if(k$)return _R;k$=1;var e=TSe(),t=e("toUpperCase");return _R=t,_R}var jSe=ASe();const xC=Ca(jSe);function _o(e){return function(){return e}}const bJ=Math.cos,yj=Math.sin,Gf=Math.sqrt,vj=Math.PI,_C=2*vj,xI=Math.PI,_I=2*xI,Nx=1e-6,ESe=_I-Nx;function wJ(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function CSe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return wJ;const n=10**t;return function(r){this._+=r[0];for(let c=1,f=r.length;c<f;++c)this._+=Math.round(arguments[c]*n)/n+r[c]}}class NSe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?wJ:CSe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,c){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+c}`}bezierCurveTo(t,n,r,c,f,p){this._append`C${+t},${+n},${+r},${+c},${this._x1=+f},${this._y1=+p}`}arcTo(t,n,r,c,f){if(t=+t,n=+n,r=+r,c=+c,f=+f,f<0)throw new Error(`negative radius: ${f}`);let p=this._x1,s=this._y1,w=r-t,T=c-n,E=p-t,N=s-n,D=E*E+N*N;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(D>Nx)if(!(Math.abs(N*w-T*E)>Nx)||!f)this._append`L${this._x1=t},${this._y1=n}`;else{let V=r-p,$=c-s,B=w*w+T*T,F=V*V+$*$,K=Math.sqrt(B),Y=Math.sqrt(D),X=f*Math.tan((xI-Math.acos((B+D-F)/(2*K*Y)))/2),ae=X/Y,Z=X/K;Math.abs(ae-1)>Nx&&this._append`L${t+ae*E},${n+ae*N}`,this._append`A${f},${f},0,0,${+(N*V>E*$)},${this._x1=t+Z*w},${this._y1=n+Z*T}`}}arc(t,n,r,c,f,p){if(t=+t,n=+n,r=+r,p=!!p,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(c),w=r*Math.sin(c),T=t+s,E=n+w,N=1^p,D=p?c-f:f-c;this._x1===null?this._append`M${T},${E}`:(Math.abs(this._x1-T)>Nx||Math.abs(this._y1-E)>Nx)&&this._append`L${T},${E}`,r&&(D<0&&(D=D%_I+_I),D>ESe?this._append`A${r},${r},0,1,${N},${t-s},${n-w}A${r},${r},0,1,${N},${this._x1=T},${this._y1=E}`:D>Nx&&this._append`A${r},${r},0,${+(D>=xI)},${N},${this._x1=t+r*Math.cos(f)},${this._y1=n+r*Math.sin(f)}`)}rect(t,n,r,c){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+c}h${-r}Z`}toString(){return this._}}function jz(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new NSe(t)}function Ez(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function SJ(e){this._context=e}SJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function bC(e){return new SJ(e)}function TJ(e){return e[0]}function AJ(e){return e[1]}function jJ(e,t){var n=_o(!0),r=null,c=bC,f=null,p=jz(s);e=typeof e=="function"?e:e===void 0?TJ:_o(e),t=typeof t=="function"?t:t===void 0?AJ:_o(t);function s(w){var T,E=(w=Ez(w)).length,N,D=!1,V;for(r==null&&(f=c(V=p())),T=0;T<=E;++T)!(T<E&&n(N=w[T],T,w))===D&&((D=!D)?f.lineStart():f.lineEnd()),D&&f.point(+e(N,T,w),+t(N,T,w));if(V)return f=null,V+""||null}return s.x=function(w){return arguments.length?(e=typeof w=="function"?w:_o(+w),s):e},s.y=function(w){return arguments.length?(t=typeof w=="function"?w:_o(+w),s):t},s.defined=function(w){return arguments.length?(n=typeof w=="function"?w:_o(!!w),s):n},s.curve=function(w){return arguments.length?(c=w,r!=null&&(f=c(r)),s):c},s.context=function(w){return arguments.length?(w==null?r=f=null:f=c(r=w),s):r},s}function lA(e,t,n){var r=null,c=_o(!0),f=null,p=bC,s=null,w=jz(T);e=typeof e=="function"?e:e===void 0?TJ:_o(+e),t=typeof t=="function"?t:_o(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?AJ:_o(+n);function T(N){var D,V,$,B=(N=Ez(N)).length,F,K=!1,Y,X=new Array(B),ae=new Array(B);for(f==null&&(s=p(Y=w())),D=0;D<=B;++D){if(!(D<B&&c(F=N[D],D,N))===K)if(K=!K)V=D,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),$=D-1;$>=V;--$)s.point(X[$],ae[$]);s.lineEnd(),s.areaEnd()}K&&(X[D]=+e(F,D,N),ae[D]=+t(F,D,N),s.point(r?+r(F,D,N):X[D],n?+n(F,D,N):ae[D]))}if(Y)return s=null,Y+""||null}function E(){return jJ().defined(c).curve(p).context(f)}return T.x=function(N){return arguments.length?(e=typeof N=="function"?N:_o(+N),r=null,T):e},T.x0=function(N){return arguments.length?(e=typeof N=="function"?N:_o(+N),T):e},T.x1=function(N){return arguments.length?(r=N==null?null:typeof N=="function"?N:_o(+N),T):r},T.y=function(N){return arguments.length?(t=typeof N=="function"?N:_o(+N),n=null,T):t},T.y0=function(N){return arguments.length?(t=typeof N=="function"?N:_o(+N),T):t},T.y1=function(N){return arguments.length?(n=N==null?null:typeof N=="function"?N:_o(+N),T):n},T.lineX0=T.lineY0=function(){return E().x(e).y(t)},T.lineY1=function(){return E().x(e).y(n)},T.lineX1=function(){return E().x(r).y(t)},T.defined=function(N){return arguments.length?(c=typeof N=="function"?N:_o(!!N),T):c},T.curve=function(N){return arguments.length?(p=N,f!=null&&(s=p(f)),T):p},T.context=function(N){return arguments.length?(N==null?f=s=null:s=p(f=N),T):f},T}class EJ{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function PSe(e){return new EJ(e,!0)}function MSe(e){return new EJ(e,!1)}const Cz={draw(e,t){const n=Gf(t/vj);e.moveTo(n,0),e.arc(0,0,n,0,_C)}},RSe={draw(e,t){const n=Gf(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},CJ=Gf(1/3),OSe=CJ*2,DSe={draw(e,t){const n=Gf(t/OSe),r=n*CJ;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},kSe={draw(e,t){const n=Gf(t),r=-n/2;e.rect(r,r,n,n)}},ISe=.8908130915292852,NJ=yj(vj/10)/yj(7*vj/10),LSe=yj(_C/10)*NJ,zSe=-bJ(_C/10)*NJ,FSe={draw(e,t){const n=Gf(t*ISe),r=LSe*n,c=zSe*n;e.moveTo(0,-n),e.lineTo(r,c);for(let f=1;f<5;++f){const p=_C*f/5,s=bJ(p),w=yj(p);e.lineTo(w*n,-s*n),e.lineTo(s*r-w*c,w*r+s*c)}e.closePath()}},bR=Gf(3),BSe={draw(e,t){const n=-Gf(t/(bR*3));e.moveTo(0,n*2),e.lineTo(-bR*n,-n),e.lineTo(bR*n,-n),e.closePath()}},Ph=-.5,Mh=Gf(3)/2,bI=1/Gf(12),USe=(bI/2+1)*3,VSe={draw(e,t){const n=Gf(t/USe),r=n/2,c=n*bI,f=r,p=n*bI+n,s=-f,w=p;e.moveTo(r,c),e.lineTo(f,p),e.lineTo(s,w),e.lineTo(Ph*r-Mh*c,Mh*r+Ph*c),e.lineTo(Ph*f-Mh*p,Mh*f+Ph*p),e.lineTo(Ph*s-Mh*w,Mh*s+Ph*w),e.lineTo(Ph*r+Mh*c,Ph*c-Mh*r),e.lineTo(Ph*f+Mh*p,Ph*p-Mh*f),e.lineTo(Ph*s+Mh*w,Ph*w-Mh*s),e.closePath()}};function $Se(e,t){let n=null,r=jz(c);e=typeof e=="function"?e:_o(e||Cz),t=typeof t=="function"?t:_o(t===void 0?64:+t);function c(){let f;if(n||(n=f=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),f)return n=null,f+""||null}return c.type=function(f){return arguments.length?(e=typeof f=="function"?f:_o(f),c):e},c.size=function(f){return arguments.length?(t=typeof f=="function"?f:_o(+f),c):t},c.context=function(f){return arguments.length?(n=f??null,c):n},c}function xj(){}function _j(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function PJ(e){this._context=e}PJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:_j(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:_j(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function qSe(e){return new PJ(e)}function MJ(e){this._context=e}MJ.prototype={areaStart:xj,areaEnd:xj,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:_j(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function HSe(e){return new MJ(e)}function RJ(e){this._context=e}RJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:_j(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function GSe(e){return new RJ(e)}function OJ(e){this._context=e}OJ.prototype={areaStart:xj,areaEnd:xj,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function WSe(e){return new OJ(e)}function I$(e){return e<0?-1:1}function L$(e,t,n){var r=e._x1-e._x0,c=t-e._x1,f=(e._y1-e._y0)/(r||c<0&&-0),p=(n-e._y1)/(c||r<0&&-0),s=(f*c+p*r)/(r+c);return(I$(f)+I$(p))*Math.min(Math.abs(f),Math.abs(p),.5*Math.abs(s))||0}function z$(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function wR(e,t,n){var r=e._x0,c=e._y0,f=e._x1,p=e._y1,s=(f-r)/3;e._context.bezierCurveTo(r+s,c+s*t,f-s,p-s*n,f,p)}function bj(e){this._context=e}bj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:wR(this,this._t0,z$(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,wR(this,z$(this,n=L$(this,e,t)),n);break;default:wR(this,this._t0,n=L$(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function DJ(e){this._context=new kJ(e)}(DJ.prototype=Object.create(bj.prototype)).point=function(e,t){bj.prototype.point.call(this,t,e)};function kJ(e){this._context=e}kJ.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,c,f){this._context.bezierCurveTo(t,e,r,n,f,c)}};function XSe(e){return new bj(e)}function ZSe(e){return new DJ(e)}function IJ(e){this._context=e}IJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=F$(e),c=F$(t),f=0,p=1;p<n;++f,++p)this._context.bezierCurveTo(r[0][f],c[0][f],r[1][f],c[1][f],e[p],t[p]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function F$(e){var t,n=e.length-1,r,c=new Array(n),f=new Array(n),p=new Array(n);for(c[0]=0,f[0]=2,p[0]=e[0]+2*e[1],t=1;t<n-1;++t)c[t]=1,f[t]=4,p[t]=4*e[t]+2*e[t+1];for(c[n-1]=2,f[n-1]=7,p[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=c[t]/f[t-1],f[t]-=r,p[t]-=r*p[t-1];for(c[n-1]=p[n-1]/f[n-1],t=n-2;t>=0;--t)c[t]=(p[t]-c[t+1])/f[t];for(f[n-1]=(e[n]+c[n-1])/2,t=0;t<n-1;++t)f[t]=2*e[t+1]-c[t+1];return[c,f]}function YSe(e){return new IJ(e)}function wC(e,t){this._context=e,this._t=t}wC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function KSe(e){return new wC(e,.5)}function JSe(e){return new wC(e,0)}function QSe(e){return new wC(e,1)}function Q0(e,t){if((p=e.length)>1)for(var n=1,r,c,f=e[t[0]],p,s=f.length;n<p;++n)for(c=f,f=e[t[n]],r=0;r<s;++r)f[r][1]+=f[r][0]=isNaN(c[r][1])?c[r][0]:c[r][1]}function wI(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function eTe(e,t){return e[t]}function tTe(e){const t=[];return t.key=e,t}function nTe(){var e=_o([]),t=wI,n=Q0,r=eTe;function c(f){var p=Array.from(e.apply(this,arguments),tTe),s,w=p.length,T=-1,E;for(const N of f)for(s=0,++T;s<w;++s)(p[s][T]=[0,+r(N,p[s].key,T,f)]).data=N;for(s=0,E=Ez(t(p));s<w;++s)p[E[s]].index=s;return n(p,E),p}return c.keys=function(f){return arguments.length?(e=typeof f=="function"?f:_o(Array.from(f)),c):e},c.value=function(f){return arguments.length?(r=typeof f=="function"?f:_o(+f),c):r},c.order=function(f){return arguments.length?(t=f==null?wI:typeof f=="function"?f:_o(Array.from(f)),c):t},c.offset=function(f){return arguments.length?(n=f??Q0,c):n},c}function rTe(e,t){if((r=e.length)>0){for(var n,r,c=0,f=e[0].length,p;c<f;++c){for(p=n=0;n<r;++n)p+=e[n][c][1]||0;if(p)for(n=0;n<r;++n)e[n][c][1]/=p}Q0(e,t)}}function iTe(e,t){if((c=e.length)>0){for(var n=0,r=e[t[0]],c,f=r.length;n<f;++n){for(var p=0,s=0;p<c;++p)s+=e[p][n][1]||0;r[n][1]+=r[n][0]=-s/2}Q0(e,t)}}function sTe(e,t){if(!(!((p=e.length)>0)||!((f=(c=e[t[0]]).length)>0))){for(var n=0,r=1,c,f,p;r<f;++r){for(var s=0,w=0,T=0;s<p;++s){for(var E=e[t[s]],N=E[r][1]||0,D=E[r-1][1]||0,V=(N-D)/2,$=0;$<s;++$){var B=e[t[$]],F=B[r][1]||0,K=B[r-1][1]||0;V+=F-K}w+=N,T+=V*N}c[r-1][1]+=c[r-1][0]=n,w&&(n-=T/w)}c[r-1][1]+=c[r-1][0]=n,Q0(e,t)}}function cS(e){"@babel/helpers - typeof";return cS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cS(e)}var aTe=["type","size","sizeType"];function SI(){return SI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},SI.apply(this,arguments)}function B$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function U$(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?B$(Object(n),!0).forEach(function(r){oTe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B$(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function oTe(e,t,n){return t=lTe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lTe(e){var t=cTe(e,"string");return cS(t)=="symbol"?t:t+""}function cTe(e,t){if(cS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(cS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uTe(e,t){if(e==null)return{};var n=dTe(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dTe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var LJ={symbolCircle:Cz,symbolCross:RSe,symbolDiamond:DSe,symbolSquare:kSe,symbolStar:FSe,symbolTriangle:BSe,symbolWye:VSe},hTe=Math.PI/180,fTe=function(t){var n="symbol".concat(xC(t));return LJ[n]||Cz},pTe=function(t,n,r){if(n==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var c=18*hTe;return 1.25*t*t*(Math.tan(c)-Math.tan(c*2)*Math.pow(Math.tan(c),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},mTe=function(t,n){LJ["symbol".concat(xC(t))]=n},Nz=function(t){var n=t.type,r=n===void 0?"circle":n,c=t.size,f=c===void 0?64:c,p=t.sizeType,s=p===void 0?"area":p,w=uTe(t,aTe),T=U$(U$({},w),{},{type:r,size:f,sizeType:s}),E=function(){var F=fTe(r),K=$Se().type(F).size(pTe(f,s,r));return K()},N=T.className,D=T.cx,V=T.cy,$=Oi(T,!0);return D===+D&&V===+V&&f===+f?_e.createElement("path",SI({},$,{className:es("recharts-symbols",N),transform:"translate(".concat(D,", ").concat(V,")"),d:E()})):null};Nz.registerSymbol=mTe;function eb(e){"@babel/helpers - typeof";return eb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eb(e)}function TI(){return TI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},TI.apply(this,arguments)}function V$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function gTe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?V$(Object(n),!0).forEach(function(r){uS(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V$(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function yTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vTe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,FJ(r.key),r)}}function xTe(e,t,n){return t&&vTe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Te(e,t,n){return t=wj(t),bTe(e,zJ()?Reflect.construct(t,n||[],wj(e).constructor):t.apply(e,n))}function bTe(e,t){if(t&&(eb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wTe(e)}function wTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zJ=function(){return!!e})()}function wj(e){return wj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},wj(e)}function STe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AI(e,t)}function AI(e,t){return AI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},AI(e,t)}function uS(e,t,n){return t=FJ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FJ(e){var t=TTe(e,"string");return eb(t)=="symbol"?t:t+""}function TTe(e,t){if(eb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(eb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Rh=32,Pz=(function(e){function t(){return yTe(this,t),_Te(this,t,arguments)}return STe(t,e),xTe(t,[{key:"renderIcon",value:function(r){var c=this.props.inactiveColor,f=Rh/2,p=Rh/6,s=Rh/3,w=r.inactive?c:r.color;if(r.type==="plainline")return _e.createElement("line",{strokeWidth:4,fill:"none",stroke:w,strokeDasharray:r.payload.strokeDasharray,x1:0,y1:f,x2:Rh,y2:f,className:"recharts-legend-icon"});if(r.type==="line")return _e.createElement("path",{strokeWidth:4,fill:"none",stroke:w,d:"M0,".concat(f,"h").concat(s,`
            A`).concat(p,",").concat(p,",0,1,1,").concat(2*s,",").concat(f,`
            H`).concat(Rh,"M").concat(2*s,",").concat(f,`
            A`).concat(p,",").concat(p,",0,1,1,").concat(s,",").concat(f),className:"recharts-legend-icon"});if(r.type==="rect")return _e.createElement("path",{stroke:"none",fill:w,d:"M0,".concat(Rh/8,"h").concat(Rh,"v").concat(Rh*3/4,"h").concat(-Rh,"z"),className:"recharts-legend-icon"});if(_e.isValidElement(r.legendIcon)){var T=gTe({},r);return delete T.legendIcon,_e.cloneElement(r.legendIcon,T)}return _e.createElement(Nz,{fill:w,cx:f,cy:f,size:Rh,sizeType:"diameter",type:r.type})}},{key:"renderItems",value:function(){var r=this,c=this.props,f=c.payload,p=c.iconSize,s=c.layout,w=c.formatter,T=c.inactiveColor,E={x:0,y:0,width:Rh,height:Rh},N={display:s==="horizontal"?"inline-block":"block",marginRight:10},D={display:"inline-block",verticalAlign:"middle",marginRight:4};return f.map(function(V,$){var B=V.formatter||w,F=es(uS(uS({"recharts-legend-item":!0},"legend-item-".concat($),!0),"inactive",V.inactive));if(V.type==="none")return null;var K=as(V.value)?null:V.value;Lf(!as(V.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var Y=V.inactive?T:V.color;return _e.createElement("li",TI({className:F,style:N,key:"legend-item-".concat($)},t_(r.props,V,$)),_e.createElement(yI,{width:p,height:p,viewBox:E,style:D},r.renderIcon(V)),_e.createElement("span",{className:"recharts-legend-item-text",style:{color:Y}},B?B(K,V,$):K))})}},{key:"render",value:function(){var r=this.props,c=r.payload,f=r.layout,p=r.align;if(!c||!c.length)return null;var s={padding:0,margin:0,textAlign:f==="horizontal"?p:"left"};return _e.createElement("ul",{className:"recharts-default-legend",style:s},this.renderItems())}}])})(z.PureComponent);uS(Pz,"displayName","Legend");uS(Pz,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var SR,$$;function ATe(){if($$)return SR;$$=1;var e=gC();function t(){this.__data__=new e,this.size=0}return SR=t,SR}var TR,q$;function jTe(){if(q$)return TR;q$=1;function e(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r}return TR=e,TR}var AR,H$;function ETe(){if(H$)return AR;H$=1;function e(t){return this.__data__.get(t)}return AR=e,AR}var jR,G$;function CTe(){if(G$)return jR;G$=1;function e(t){return this.__data__.has(t)}return jR=e,jR}var ER,W$;function NTe(){if(W$)return ER;W$=1;var e=gC(),t=_z(),n=bz(),r=200;function c(f,p){var s=this.__data__;if(s instanceof e){var w=s.__data__;if(!t||w.length<r-1)return w.push([f,p]),this.size=++s.size,this;s=this.__data__=new n(w)}return s.set(f,p),this.size=s.size,this}return ER=c,ER}var CR,X$;function BJ(){if(X$)return CR;X$=1;var e=gC(),t=ATe(),n=jTe(),r=ETe(),c=CTe(),f=NTe();function p(s){var w=this.__data__=new e(s);this.size=w.size}return p.prototype.clear=t,p.prototype.delete=n,p.prototype.get=r,p.prototype.has=c,p.prototype.set=f,CR=p,CR}var NR,Z$;function PTe(){if(Z$)return NR;Z$=1;var e="__lodash_hash_undefined__";function t(n){return this.__data__.set(n,e),this}return NR=t,NR}var PR,Y$;function MTe(){if(Y$)return PR;Y$=1;function e(t){return this.__data__.has(t)}return PR=e,PR}var MR,K$;function UJ(){if(K$)return MR;K$=1;var e=bz(),t=PTe(),n=MTe();function r(c){var f=-1,p=c==null?0:c.length;for(this.__data__=new e;++f<p;)this.add(c[f])}return r.prototype.add=r.prototype.push=t,r.prototype.has=n,MR=r,MR}var RR,J$;function VJ(){if(J$)return RR;J$=1;function e(t,n){for(var r=-1,c=t==null?0:t.length;++r<c;)if(n(t[r],r,t))return!0;return!1}return RR=e,RR}var OR,Q$;function $J(){if(Q$)return OR;Q$=1;function e(t,n){return t.has(n)}return OR=e,OR}var DR,e8;function qJ(){if(e8)return DR;e8=1;var e=UJ(),t=VJ(),n=$J(),r=1,c=2;function f(p,s,w,T,E,N){var D=w&r,V=p.length,$=s.length;if(V!=$&&!(D&&$>V))return!1;var B=N.get(p),F=N.get(s);if(B&&F)return B==s&&F==p;var K=-1,Y=!0,X=w&c?new e:void 0;for(N.set(p,s),N.set(s,p);++K<V;){var ae=p[K],Z=s[K];if(T)var se=D?T(Z,ae,K,s,p,N):T(ae,Z,K,p,s,N);if(se!==void 0){if(se)continue;Y=!1;break}if(X){if(!t(s,function(he,ye){if(!n(X,ye)&&(ae===he||E(ae,he,w,T,N)))return X.push(ye)})){Y=!1;break}}else if(!(ae===Z||E(ae,Z,w,T,N))){Y=!1;break}}return N.delete(p),N.delete(s),Y}return DR=f,DR}var kR,t8;function RTe(){if(t8)return kR;t8=1;var e=um(),t=e.Uint8Array;return kR=t,kR}var IR,n8;function OTe(){if(n8)return IR;n8=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(c,f){r[++n]=[f,c]}),r}return IR=e,IR}var LR,r8;function Mz(){if(r8)return LR;r8=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(c){r[++n]=c}),r}return LR=e,LR}var zR,i8;function DTe(){if(i8)return zR;i8=1;var e=_T(),t=RTe(),n=xz(),r=qJ(),c=OTe(),f=Mz(),p=1,s=2,w="[object Boolean]",T="[object Date]",E="[object Error]",N="[object Map]",D="[object Number]",V="[object RegExp]",$="[object Set]",B="[object String]",F="[object Symbol]",K="[object ArrayBuffer]",Y="[object DataView]",X=e?e.prototype:void 0,ae=X?X.valueOf:void 0;function Z(se,he,ye,Ce,Ve,Re,$e){switch(ye){case Y:if(se.byteLength!=he.byteLength||se.byteOffset!=he.byteOffset)return!1;se=se.buffer,he=he.buffer;case K:return!(se.byteLength!=he.byteLength||!Re(new t(se),new t(he)));case w:case T:case D:return n(+se,+he);case E:return se.name==he.name&&se.message==he.message;case V:case B:return se==he+"";case N:var nt=c;case $:var Me=Ce&p;if(nt||(nt=f),se.size!=he.size&&!Me)return!1;var rt=$e.get(se);if(rt)return rt==he;Ce|=s,$e.set(se,he);var Ee=r(nt(se),nt(he),Ce,Ve,Re,$e);return $e.delete(se),Ee;case F:if(ae)return ae.call(se)==ae.call(he)}return!1}return zR=Z,zR}var FR,s8;function HJ(){if(s8)return FR;s8=1;function e(t,n){for(var r=-1,c=n.length,f=t.length;++r<c;)t[f+r]=n[r];return t}return FR=e,FR}var BR,a8;function kTe(){if(a8)return BR;a8=1;var e=HJ(),t=rd();function n(r,c,f){var p=c(r);return t(r)?p:e(p,f(r))}return BR=n,BR}var UR,o8;function ITe(){if(o8)return UR;o8=1;function e(t,n){for(var r=-1,c=t==null?0:t.length,f=0,p=[];++r<c;){var s=t[r];n(s,r,t)&&(p[f++]=s)}return p}return UR=e,UR}var VR,l8;function LTe(){if(l8)return VR;l8=1;function e(){return[]}return VR=e,VR}var $R,c8;function zTe(){if(c8)return $R;c8=1;var e=ITe(),t=LTe(),n=Object.prototype,r=n.propertyIsEnumerable,c=Object.getOwnPropertySymbols,f=c?function(p){return p==null?[]:(p=Object(p),e(c(p),function(s){return r.call(p,s)}))}:t;return $R=f,$R}var qR,u8;function FTe(){if(u8)return qR;u8=1;function e(t,n){for(var r=-1,c=Array(t);++r<t;)c[r]=n(r);return c}return qR=e,qR}var HR,d8;function BTe(){if(d8)return HR;d8=1;var e=Dg(),t=kg(),n="[object Arguments]";function r(c){return t(c)&&e(c)==n}return HR=r,HR}var GR,h8;function Rz(){if(h8)return GR;h8=1;var e=BTe(),t=kg(),n=Object.prototype,r=n.hasOwnProperty,c=n.propertyIsEnumerable,f=e((function(){return arguments})())?e:function(p){return t(p)&&r.call(p,"callee")&&!c.call(p,"callee")};return GR=f,GR}var M1={exports:{}},WR,f8;function UTe(){if(f8)return WR;f8=1;function e(){return!1}return WR=e,WR}M1.exports;var p8;function GJ(){return p8||(p8=1,(function(e,t){var n=um(),r=UTe(),c=t&&!t.nodeType&&t,f=c&&!0&&e&&!e.nodeType&&e,p=f&&f.exports===c,s=p?n.Buffer:void 0,w=s?s.isBuffer:void 0,T=w||r;e.exports=T})(M1,M1.exports)),M1.exports}var XR,m8;function Oz(){if(m8)return XR;m8=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function n(r,c){var f=typeof r;return c=c??e,!!c&&(f=="number"||f!="symbol"&&t.test(r))&&r>-1&&r%1==0&&r<c}return XR=n,XR}var ZR,g8;function Dz(){if(g8)return ZR;g8=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return ZR=t,ZR}var YR,y8;function VTe(){if(y8)return YR;y8=1;var e=Dg(),t=Dz(),n=kg(),r="[object Arguments]",c="[object Array]",f="[object Boolean]",p="[object Date]",s="[object Error]",w="[object Function]",T="[object Map]",E="[object Number]",N="[object Object]",D="[object RegExp]",V="[object Set]",$="[object String]",B="[object WeakMap]",F="[object ArrayBuffer]",K="[object DataView]",Y="[object Float32Array]",X="[object Float64Array]",ae="[object Int8Array]",Z="[object Int16Array]",se="[object Int32Array]",he="[object Uint8Array]",ye="[object Uint8ClampedArray]",Ce="[object Uint16Array]",Ve="[object Uint32Array]",Re={};Re[Y]=Re[X]=Re[ae]=Re[Z]=Re[se]=Re[he]=Re[ye]=Re[Ce]=Re[Ve]=!0,Re[r]=Re[c]=Re[F]=Re[f]=Re[K]=Re[p]=Re[s]=Re[w]=Re[T]=Re[E]=Re[N]=Re[D]=Re[V]=Re[$]=Re[B]=!1;function $e(nt){return n(nt)&&t(nt.length)&&!!Re[e(nt)]}return YR=$e,YR}var KR,v8;function WJ(){if(v8)return KR;v8=1;function e(t){return function(n){return t(n)}}return KR=e,KR}var R1={exports:{}};R1.exports;var x8;function $Te(){return x8||(x8=1,(function(e,t){var n=hJ(),r=t&&!t.nodeType&&t,c=r&&!0&&e&&!e.nodeType&&e,f=c&&c.exports===r,p=f&&n.process,s=(function(){try{var w=c&&c.require&&c.require("util").types;return w||p&&p.binding&&p.binding("util")}catch{}})();e.exports=s})(R1,R1.exports)),R1.exports}var JR,_8;function XJ(){if(_8)return JR;_8=1;var e=VTe(),t=WJ(),n=$Te(),r=n&&n.isTypedArray,c=r?t(r):e;return JR=c,JR}var QR,b8;function qTe(){if(b8)return QR;b8=1;var e=FTe(),t=Rz(),n=rd(),r=GJ(),c=Oz(),f=XJ(),p=Object.prototype,s=p.hasOwnProperty;function w(T,E){var N=n(T),D=!N&&t(T),V=!N&&!D&&r(T),$=!N&&!D&&!V&&f(T),B=N||D||V||$,F=B?e(T.length,String):[],K=F.length;for(var Y in T)(E||s.call(T,Y))&&!(B&&(Y=="length"||V&&(Y=="offset"||Y=="parent")||$&&(Y=="buffer"||Y=="byteLength"||Y=="byteOffset")||c(Y,K)))&&F.push(Y);return F}return QR=w,QR}var eO,w8;function HTe(){if(w8)return eO;w8=1;var e=Object.prototype;function t(n){var r=n&&n.constructor,c=typeof r=="function"&&r.prototype||e;return n===c}return eO=t,eO}var tO,S8;function ZJ(){if(S8)return tO;S8=1;function e(t,n){return function(r){return t(n(r))}}return tO=e,tO}var nO,T8;function GTe(){if(T8)return nO;T8=1;var e=ZJ(),t=e(Object.keys,Object);return nO=t,nO}var rO,A8;function WTe(){if(A8)return rO;A8=1;var e=HTe(),t=GTe(),n=Object.prototype,r=n.hasOwnProperty;function c(f){if(!e(f))return t(f);var p=[];for(var s in Object(f))r.call(f,s)&&s!="constructor"&&p.push(s);return p}return rO=c,rO}var iO,j8;function bT(){if(j8)return iO;j8=1;var e=vz(),t=Dz();function n(r){return r!=null&&t(r.length)&&!e(r)}return iO=n,iO}var sO,E8;function SC(){if(E8)return sO;E8=1;var e=qTe(),t=WTe(),n=bT();function r(c){return n(c)?e(c):t(c)}return sO=r,sO}var aO,C8;function XTe(){if(C8)return aO;C8=1;var e=kTe(),t=zTe(),n=SC();function r(c){return e(c,n,t)}return aO=r,aO}var oO,N8;function ZTe(){if(N8)return oO;N8=1;var e=XTe(),t=1,n=Object.prototype,r=n.hasOwnProperty;function c(f,p,s,w,T,E){var N=s&t,D=e(f),V=D.length,$=e(p),B=$.length;if(V!=B&&!N)return!1;for(var F=V;F--;){var K=D[F];if(!(N?K in p:r.call(p,K)))return!1}var Y=E.get(f),X=E.get(p);if(Y&&X)return Y==p&&X==f;var ae=!0;E.set(f,p),E.set(p,f);for(var Z=N;++F<V;){K=D[F];var se=f[K],he=p[K];if(w)var ye=N?w(he,se,K,p,f,E):w(se,he,K,f,p,E);if(!(ye===void 0?se===he||T(se,he,s,w,E):ye)){ae=!1;break}Z||(Z=K=="constructor")}if(ae&&!Z){var Ce=f.constructor,Ve=p.constructor;Ce!=Ve&&"constructor"in f&&"constructor"in p&&!(typeof Ce=="function"&&Ce instanceof Ce&&typeof Ve=="function"&&Ve instanceof Ve)&&(ae=!1)}return E.delete(f),E.delete(p),ae}return oO=c,oO}var lO,P8;function YTe(){if(P8)return lO;P8=1;var e=p_(),t=um(),n=e(t,"DataView");return lO=n,lO}var cO,M8;function KTe(){if(M8)return cO;M8=1;var e=p_(),t=um(),n=e(t,"Promise");return cO=n,cO}var uO,R8;function YJ(){if(R8)return uO;R8=1;var e=p_(),t=um(),n=e(t,"Set");return uO=n,uO}var dO,O8;function JTe(){if(O8)return dO;O8=1;var e=p_(),t=um(),n=e(t,"WeakMap");return dO=n,dO}var hO,D8;function QTe(){if(D8)return hO;D8=1;var e=YTe(),t=_z(),n=KTe(),r=YJ(),c=JTe(),f=Dg(),p=fJ(),s="[object Map]",w="[object Object]",T="[object Promise]",E="[object Set]",N="[object WeakMap]",D="[object DataView]",V=p(e),$=p(t),B=p(n),F=p(r),K=p(c),Y=f;return(e&&Y(new e(new ArrayBuffer(1)))!=D||t&&Y(new t)!=s||n&&Y(n.resolve())!=T||r&&Y(new r)!=E||c&&Y(new c)!=N)&&(Y=function(X){var ae=f(X),Z=ae==w?X.constructor:void 0,se=Z?p(Z):"";if(se)switch(se){case V:return D;case $:return s;case B:return T;case F:return E;case K:return N}return ae}),hO=Y,hO}var fO,k8;function e2e(){if(k8)return fO;k8=1;var e=BJ(),t=qJ(),n=DTe(),r=ZTe(),c=QTe(),f=rd(),p=GJ(),s=XJ(),w=1,T="[object Arguments]",E="[object Array]",N="[object Object]",D=Object.prototype,V=D.hasOwnProperty;function $(B,F,K,Y,X,ae){var Z=f(B),se=f(F),he=Z?E:c(B),ye=se?E:c(F);he=he==T?N:he,ye=ye==T?N:ye;var Ce=he==N,Ve=ye==N,Re=he==ye;if(Re&&p(B)){if(!p(F))return!1;Z=!0,Ce=!1}if(Re&&!Ce)return ae||(ae=new e),Z||s(B)?t(B,F,K,Y,X,ae):n(B,F,he,K,Y,X,ae);if(!(K&w)){var $e=Ce&&V.call(B,"__wrapped__"),nt=Ve&&V.call(F,"__wrapped__");if($e||nt){var Me=$e?B.value():B,rt=nt?F.value():F;return ae||(ae=new e),X(Me,rt,K,Y,ae)}}return Re?(ae||(ae=new e),r(B,F,K,Y,X,ae)):!1}return fO=$,fO}var pO,I8;function kz(){if(I8)return pO;I8=1;var e=e2e(),t=kg();function n(r,c,f,p,s){return r===c?!0:r==null||c==null||!t(r)&&!t(c)?r!==r&&c!==c:e(r,c,f,p,n,s)}return pO=n,pO}var mO,L8;function t2e(){if(L8)return mO;L8=1;var e=BJ(),t=kz(),n=1,r=2;function c(f,p,s,w){var T=s.length,E=T,N=!w;if(f==null)return!E;for(f=Object(f);T--;){var D=s[T];if(N&&D[2]?D[1]!==f[D[0]]:!(D[0]in f))return!1}for(;++T<E;){D=s[T];var V=D[0],$=f[V],B=D[1];if(N&&D[2]){if($===void 0&&!(V in f))return!1}else{var F=new e;if(w)var K=w($,B,V,f,p,F);if(!(K===void 0?t(B,$,n|r,w,F):K))return!1}}return!0}return mO=c,mO}var gO,z8;function KJ(){if(z8)return gO;z8=1;var e=fv();function t(n){return n===n&&!e(n)}return gO=t,gO}var yO,F8;function n2e(){if(F8)return yO;F8=1;var e=KJ(),t=SC();function n(r){for(var c=t(r),f=c.length;f--;){var p=c[f],s=r[p];c[f]=[p,s,e(s)]}return c}return yO=n,yO}var vO,B8;function JJ(){if(B8)return vO;B8=1;function e(t,n){return function(r){return r==null?!1:r[t]===n&&(n!==void 0||t in Object(r))}}return vO=e,vO}var xO,U8;function r2e(){if(U8)return xO;U8=1;var e=t2e(),t=n2e(),n=JJ();function r(c){var f=t(c);return f.length==1&&f[0][2]?n(f[0][0],f[0][1]):function(p){return p===c||e(p,c,f)}}return xO=r,xO}var _O,V8;function i2e(){if(V8)return _O;V8=1;function e(t,n){return t!=null&&n in Object(t)}return _O=e,_O}var bO,$8;function s2e(){if($8)return bO;$8=1;var e=gJ(),t=Rz(),n=rd(),r=Oz(),c=Dz(),f=vC();function p(s,w,T){w=e(w,s);for(var E=-1,N=w.length,D=!1;++E<N;){var V=f(w[E]);if(!(D=s!=null&&T(s,V)))break;s=s[V]}return D||++E!=N?D:(N=s==null?0:s.length,!!N&&c(N)&&r(V,N)&&(n(s)||t(s)))}return bO=p,bO}var wO,q8;function a2e(){if(q8)return wO;q8=1;var e=i2e(),t=s2e();function n(r,c){return r!=null&&t(r,c,e)}return wO=n,wO}var SO,H8;function o2e(){if(H8)return SO;H8=1;var e=kz(),t=yJ(),n=a2e(),r=yz(),c=KJ(),f=JJ(),p=vC(),s=1,w=2;function T(E,N){return r(E)&&c(N)?f(p(E),N):function(D){var V=t(D,E);return V===void 0&&V===N?n(D,E):e(N,V,s|w)}}return SO=T,SO}var TO,G8;function qb(){if(G8)return TO;G8=1;function e(t){return t}return TO=e,TO}var AO,W8;function l2e(){if(W8)return AO;W8=1;function e(t){return function(n){return n?.[t]}}return AO=e,AO}var jO,X8;function c2e(){if(X8)return jO;X8=1;var e=Sz();function t(n){return function(r){return e(r,n)}}return jO=t,jO}var EO,Z8;function u2e(){if(Z8)return EO;Z8=1;var e=l2e(),t=c2e(),n=yz(),r=vC();function c(f){return n(f)?e(r(f)):t(f)}return EO=c,EO}var CO,Y8;function dm(){if(Y8)return CO;Y8=1;var e=r2e(),t=o2e(),n=qb(),r=rd(),c=u2e();function f(p){return typeof p=="function"?p:p==null?n:typeof p=="object"?r(p)?t(p[0],p[1]):e(p):c(p)}return CO=f,CO}var NO,K8;function QJ(){if(K8)return NO;K8=1;function e(t,n,r,c){for(var f=t.length,p=r+(c?1:-1);c?p--:++p<f;)if(n(t[p],p,t))return p;return-1}return NO=e,NO}var PO,J8;function d2e(){if(J8)return PO;J8=1;function e(t){return t!==t}return PO=e,PO}var MO,Q8;function h2e(){if(Q8)return MO;Q8=1;function e(t,n,r){for(var c=r-1,f=t.length;++c<f;)if(t[c]===n)return c;return-1}return MO=e,MO}var RO,eq;function f2e(){if(eq)return RO;eq=1;var e=QJ(),t=d2e(),n=h2e();function r(c,f,p){return f===f?n(c,f,p):e(c,t,p)}return RO=r,RO}var OO,tq;function p2e(){if(tq)return OO;tq=1;var e=f2e();function t(n,r){var c=n==null?0:n.length;return!!c&&e(n,r,0)>-1}return OO=t,OO}var DO,nq;function m2e(){if(nq)return DO;nq=1;function e(t,n,r){for(var c=-1,f=t==null?0:t.length;++c<f;)if(r(n,t[c]))return!0;return!1}return DO=e,DO}var kO,rq;function g2e(){if(rq)return kO;rq=1;function e(){}return kO=e,kO}var IO,iq;function y2e(){if(iq)return IO;iq=1;var e=YJ(),t=g2e(),n=Mz(),r=1/0,c=e&&1/n(new e([,-0]))[1]==r?function(f){return new e(f)}:t;return IO=c,IO}var LO,sq;function v2e(){if(sq)return LO;sq=1;var e=UJ(),t=p2e(),n=m2e(),r=$J(),c=y2e(),f=Mz(),p=200;function s(w,T,E){var N=-1,D=t,V=w.length,$=!0,B=[],F=B;if(E)$=!1,D=n;else if(V>=p){var K=T?null:c(w);if(K)return f(K);$=!1,D=r,F=new e}else F=T?[]:B;e:for(;++N<V;){var Y=w[N],X=T?T(Y):Y;if(Y=E||Y!==0?Y:0,$&&X===X){for(var ae=F.length;ae--;)if(F[ae]===X)continue e;T&&F.push(X),B.push(Y)}else D(F,X,E)||(F!==B&&F.push(X),B.push(Y))}return B}return LO=s,LO}var zO,aq;function x2e(){if(aq)return zO;aq=1;var e=dm(),t=v2e();function n(r,c){return r&&r.length?t(r,e(c,2)):[]}return zO=n,zO}var _2e=x2e();const oq=Ca(_2e);function eQ(e,t,n){return t===!0?oq(e,n):as(t)?oq(e,t):e}function tb(e){"@babel/helpers - typeof";return tb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tb(e)}var b2e=["ref"];function lq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function hg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lq(Object(n),!0).forEach(function(r){TC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function w2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,nQ(r.key),r)}}function S2e(e,t,n){return t&&cq(e.prototype,t),n&&cq(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function T2e(e,t,n){return t=Sj(t),A2e(e,tQ()?Reflect.construct(t,n||[],Sj(e).constructor):t.apply(e,n))}function A2e(e,t){if(t&&(tb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return j2e(e)}function j2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tQ=function(){return!!e})()}function Sj(e){return Sj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Sj(e)}function E2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jI(e,t)}function jI(e,t){return jI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},jI(e,t)}function TC(e,t,n){return t=nQ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nQ(e){var t=C2e(e,"string");return tb(t)=="symbol"?t:t+""}function C2e(e,t){if(tb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(tb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function N2e(e,t){if(e==null)return{};var n=P2e(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function P2e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function M2e(e){return e.value}function R2e(e,t){if(_e.isValidElement(e))return _e.cloneElement(e,t);if(typeof e=="function")return _e.createElement(e,t);t.ref;var n=N2e(t,b2e);return _e.createElement(Pz,n)}var uq=1,Qy=(function(e){function t(){var n;w2e(this,t);for(var r=arguments.length,c=new Array(r),f=0;f<r;f++)c[f]=arguments[f];return n=T2e(this,t,[].concat(c)),TC(n,"lastBoundingBox",{width:-1,height:-1}),n}return E2e(t,e),S2e(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();return r.height=this.wrapperNode.offsetHeight,r.width=this.wrapperNode.offsetWidth,r}return null}},{key:"updateBBox",value:function(){var r=this.props.onBBoxUpdate,c=this.getBBox();c?(Math.abs(c.width-this.lastBoundingBox.width)>uq||Math.abs(c.height-this.lastBoundingBox.height)>uq)&&(this.lastBoundingBox.width=c.width,this.lastBoundingBox.height=c.height,r&&r(c)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,r&&r(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?hg({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(r){var c=this.props,f=c.layout,p=c.align,s=c.verticalAlign,w=c.margin,T=c.chartWidth,E=c.chartHeight,N,D;if(!r||(r.left===void 0||r.left===null)&&(r.right===void 0||r.right===null))if(p==="center"&&f==="vertical"){var V=this.getBBoxSnapshot();N={left:((T||0)-V.width)/2}}else N=p==="right"?{right:w&&w.right||0}:{left:w&&w.left||0};if(!r||(r.top===void 0||r.top===null)&&(r.bottom===void 0||r.bottom===null))if(s==="middle"){var $=this.getBBoxSnapshot();D={top:((E||0)-$.height)/2}}else D=s==="bottom"?{bottom:w&&w.bottom||0}:{top:w&&w.top||0};return hg(hg({},N),D)}},{key:"render",value:function(){var r=this,c=this.props,f=c.content,p=c.width,s=c.height,w=c.wrapperStyle,T=c.payloadUniqBy,E=c.payload,N=hg(hg({position:"absolute",width:p||"auto",height:s||"auto"},this.getDefaultPosition(w)),w);return _e.createElement("div",{className:"recharts-legend-wrapper",style:N,ref:function(V){r.wrapperNode=V}},R2e(f,hg(hg({},this.props),{},{payload:eQ(E,T,M2e)})))}}],[{key:"getWithHeight",value:function(r,c){var f=hg(hg({},this.defaultProps),r.props),p=f.layout;return p==="vertical"&&jr(r.props.height)?{height:r.props.height}:p==="horizontal"?{width:r.props.width||c}:null}}])})(z.PureComponent);TC(Qy,"displayName","Legend");TC(Qy,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var FO,dq;function O2e(){if(dq)return FO;dq=1;var e=_T(),t=Rz(),n=rd(),r=e?e.isConcatSpreadable:void 0;function c(f){return n(f)||t(f)||!!(r&&f&&f[r])}return FO=c,FO}var BO,hq;function rQ(){if(hq)return BO;hq=1;var e=HJ(),t=O2e();function n(r,c,f,p,s){var w=-1,T=r.length;for(f||(f=t),s||(s=[]);++w<T;){var E=r[w];c>0&&f(E)?c>1?n(E,c-1,f,p,s):e(s,E):p||(s[s.length]=E)}return s}return BO=n,BO}var UO,fq;function D2e(){if(fq)return UO;fq=1;function e(t){return function(n,r,c){for(var f=-1,p=Object(n),s=c(n),w=s.length;w--;){var T=s[t?w:++f];if(r(p[T],T,p)===!1)break}return n}}return UO=e,UO}var VO,pq;function k2e(){if(pq)return VO;pq=1;var e=D2e(),t=e();return VO=t,VO}var $O,mq;function iQ(){if(mq)return $O;mq=1;var e=k2e(),t=SC();function n(r,c){return r&&e(r,c,t)}return $O=n,$O}var qO,gq;function I2e(){if(gq)return qO;gq=1;var e=bT();function t(n,r){return function(c,f){if(c==null)return c;if(!e(c))return n(c,f);for(var p=c.length,s=r?p:-1,w=Object(c);(r?s--:++s<p)&&f(w[s],s,w)!==!1;);return c}}return qO=t,qO}var HO,yq;function Iz(){if(yq)return HO;yq=1;var e=iQ(),t=I2e(),n=t(e);return HO=n,HO}var GO,vq;function sQ(){if(vq)return GO;vq=1;var e=Iz(),t=bT();function n(r,c){var f=-1,p=t(r)?Array(r.length):[];return e(r,function(s,w,T){p[++f]=c(s,w,T)}),p}return GO=n,GO}var WO,xq;function L2e(){if(xq)return WO;xq=1;function e(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}return WO=e,WO}var XO,_q;function z2e(){if(_q)return XO;_q=1;var e=Ub();function t(n,r){if(n!==r){var c=n!==void 0,f=n===null,p=n===n,s=e(n),w=r!==void 0,T=r===null,E=r===r,N=e(r);if(!T&&!N&&!s&&n>r||s&&w&&E&&!T&&!N||f&&w&&E||!c&&E||!p)return 1;if(!f&&!s&&!N&&n<r||N&&c&&p&&!f&&!s||T&&c&&p||!w&&p||!E)return-1}return 0}return XO=t,XO}var ZO,bq;function F2e(){if(bq)return ZO;bq=1;var e=z2e();function t(n,r,c){for(var f=-1,p=n.criteria,s=r.criteria,w=p.length,T=c.length;++f<w;){var E=e(p[f],s[f]);if(E){if(f>=T)return E;var N=c[f];return E*(N=="desc"?-1:1)}}return n.index-r.index}return ZO=t,ZO}var YO,wq;function B2e(){if(wq)return YO;wq=1;var e=wz(),t=Sz(),n=dm(),r=sQ(),c=L2e(),f=WJ(),p=F2e(),s=qb(),w=rd();function T(E,N,D){N.length?N=e(N,function(B){return w(B)?function(F){return t(F,B.length===1?B[0]:B)}:B}):N=[s];var V=-1;N=e(N,f(n));var $=r(E,function(B,F,K){var Y=e(N,function(X){return X(B)});return{criteria:Y,index:++V,value:B}});return c($,function(B,F){return p(B,F,D)})}return YO=T,YO}var KO,Sq;function U2e(){if(Sq)return KO;Sq=1;function e(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}return KO=e,KO}var JO,Tq;function V2e(){if(Tq)return JO;Tq=1;var e=U2e(),t=Math.max;function n(r,c,f){return c=t(c===void 0?r.length-1:c,0),function(){for(var p=arguments,s=-1,w=t(p.length-c,0),T=Array(w);++s<w;)T[s]=p[c+s];s=-1;for(var E=Array(c+1);++s<c;)E[s]=p[s];return E[c]=f(T),e(r,this,E)}}return JO=n,JO}var QO,Aq;function $2e(){if(Aq)return QO;Aq=1;function e(t){return function(){return t}}return QO=e,QO}var eD,jq;function aQ(){if(jq)return eD;jq=1;var e=p_(),t=(function(){try{var n=e(Object,"defineProperty");return n({},"",{}),n}catch{}})();return eD=t,eD}var tD,Eq;function q2e(){if(Eq)return tD;Eq=1;var e=$2e(),t=aQ(),n=qb(),r=t?function(c,f){return t(c,"toString",{configurable:!0,enumerable:!1,value:e(f),writable:!0})}:n;return tD=r,tD}var nD,Cq;function H2e(){if(Cq)return nD;Cq=1;var e=800,t=16,n=Date.now;function r(c){var f=0,p=0;return function(){var s=n(),w=t-(s-p);if(p=s,w>0){if(++f>=e)return arguments[0]}else f=0;return c.apply(void 0,arguments)}}return nD=r,nD}var rD,Nq;function G2e(){if(Nq)return rD;Nq=1;var e=q2e(),t=H2e(),n=t(e);return rD=n,rD}var iD,Pq;function W2e(){if(Pq)return iD;Pq=1;var e=qb(),t=V2e(),n=G2e();function r(c,f){return n(t(c,f,e),c+"")}return iD=r,iD}var sD,Mq;function AC(){if(Mq)return sD;Mq=1;var e=xz(),t=bT(),n=Oz(),r=fv();function c(f,p,s){if(!r(s))return!1;var w=typeof p;return(w=="number"?t(s)&&n(p,s.length):w=="string"&&p in s)?e(s[p],f):!1}return sD=c,sD}var aD,Rq;function X2e(){if(Rq)return aD;Rq=1;var e=rQ(),t=B2e(),n=W2e(),r=AC(),c=n(function(f,p){if(f==null)return[];var s=p.length;return s>1&&r(f,p[0],p[1])?p=[]:s>2&&r(p[0],p[1],p[2])&&(p=[p[0]]),t(f,e(p,1),[])});return aD=c,aD}var Z2e=X2e();const Lz=Ca(Z2e);function dS(e){"@babel/helpers - typeof";return dS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dS(e)}function EI(){return EI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},EI.apply(this,arguments)}function Y2e(e,t){return eAe(e)||Q2e(e,t)||J2e(e,t)||K2e()}function K2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J2e(e,t){if(e){if(typeof e=="string")return Oq(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Oq(e,t)}}function Oq(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Q2e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,c,f,p,s=[],w=!0,T=!1;try{if(f=(n=n.call(e)).next,t!==0)for(;!(w=(r=f.call(n)).done)&&(s.push(r.value),s.length!==t);w=!0);}catch(E){T=!0,c=E}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return s}}function eAe(e){if(Array.isArray(e))return e}function Dq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function oD(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Dq(Object(n),!0).forEach(function(r){tAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function tAe(e,t,n){return t=nAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nAe(e){var t=rAe(e,"string");return dS(t)=="symbol"?t:t+""}function rAe(e,t){if(dS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(dS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iAe(e){return Array.isArray(e)&&Zl(e[0])&&Zl(e[1])?e.join(" ~ "):e}var sAe=function(t){var n=t.separator,r=n===void 0?" : ":n,c=t.contentStyle,f=c===void 0?{}:c,p=t.itemStyle,s=p===void 0?{}:p,w=t.labelStyle,T=w===void 0?{}:w,E=t.payload,N=t.formatter,D=t.itemSorter,V=t.wrapperClassName,$=t.labelClassName,B=t.label,F=t.labelFormatter,K=t.accessibilityLayer,Y=K===void 0?!1:K,X=function(){if(E&&E.length){var $e={padding:0,margin:0},nt=(D?Lz(E,D):E).map(function(Me,rt){if(Me.type==="none")return null;var Ee=oD({display:"block",paddingTop:4,paddingBottom:4,color:Me.color||"#000"},s),it=Me.formatter||N||iAe,et=Me.value,mt=Me.name,He=et,pt=mt;if(it&&He!=null&&pt!=null){var We=it(et,mt,Me,rt,E);if(Array.isArray(We)){var Je=Y2e(We,2);He=Je[0],pt=Je[1]}else He=We}return _e.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(rt),style:Ee},Zl(pt)?_e.createElement("span",{className:"recharts-tooltip-item-name"},pt):null,Zl(pt)?_e.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,_e.createElement("span",{className:"recharts-tooltip-item-value"},He),_e.createElement("span",{className:"recharts-tooltip-item-unit"},Me.unit||""))});return _e.createElement("ul",{className:"recharts-tooltip-item-list",style:$e},nt)}return null},ae=oD({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},f),Z=oD({margin:0},T),se=!xs(B),he=se?B:"",ye=es("recharts-default-tooltip",V),Ce=es("recharts-tooltip-label",$);se&&F&&E!==void 0&&E!==null&&(he=F(B,E));var Ve=Y?{role:"status","aria-live":"assertive"}:{};return _e.createElement("div",EI({className:ye,style:ae},Ve),_e.createElement("p",{className:Ce,style:Z},_e.isValidElement(he)?he:"".concat(he)),X())};function hS(e){"@babel/helpers - typeof";return hS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hS(e)}function cA(e,t,n){return t=aAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aAe(e){var t=oAe(e,"string");return hS(t)=="symbol"?t:t+""}function oAe(e,t){if(hS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(hS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var f1="recharts-tooltip-wrapper",lAe={visibility:"hidden"};function cAe(e){var t=e.coordinate,n=e.translateX,r=e.translateY;return es(f1,cA(cA(cA(cA({},"".concat(f1,"-right"),jr(n)&&t&&jr(t.x)&&n>=t.x),"".concat(f1,"-left"),jr(n)&&t&&jr(t.x)&&n<t.x),"".concat(f1,"-bottom"),jr(r)&&t&&jr(t.y)&&r>=t.y),"".concat(f1,"-top"),jr(r)&&t&&jr(t.y)&&r<t.y))}function kq(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.key,c=e.offsetTopLeft,f=e.position,p=e.reverseDirection,s=e.tooltipDimension,w=e.viewBox,T=e.viewBoxDimension;if(f&&jr(f[r]))return f[r];var E=n[r]-s-c,N=n[r]+c;if(t[r])return p[r]?E:N;if(p[r]){var D=E,V=w[r];return D<V?Math.max(N,w[r]):Math.max(E,w[r])}var $=N+s,B=w[r]+T;return $>B?Math.max(E,w[r]):Math.max(N,w[r])}function uAe(e){var t=e.translateX,n=e.translateY,r=e.useTranslate3d;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function dAe(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.offsetTopLeft,c=e.position,f=e.reverseDirection,p=e.tooltipBox,s=e.useTranslate3d,w=e.viewBox,T,E,N;return p.height>0&&p.width>0&&n?(E=kq({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:r,position:c,reverseDirection:f,tooltipDimension:p.width,viewBox:w,viewBoxDimension:w.width}),N=kq({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:r,position:c,reverseDirection:f,tooltipDimension:p.height,viewBox:w,viewBoxDimension:w.height}),T=uAe({translateX:E,translateY:N,useTranslate3d:s})):T=lAe,{cssProperties:T,cssClasses:cAe({translateX:E,translateY:N,coordinate:n})}}function nb(e){"@babel/helpers - typeof";return nb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nb(e)}function Iq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function Lq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Iq(Object(n),!0).forEach(function(r){NI(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Iq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function hAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fAe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,lQ(r.key),r)}}function pAe(e,t,n){return t&&fAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function mAe(e,t,n){return t=Tj(t),gAe(e,oQ()?Reflect.construct(t,n||[],Tj(e).constructor):t.apply(e,n))}function gAe(e,t){if(t&&(nb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yAe(e)}function yAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oQ=function(){return!!e})()}function Tj(e){return Tj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Tj(e)}function vAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CI(e,t)}function CI(e,t){return CI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},CI(e,t)}function NI(e,t,n){return t=lQ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lQ(e){var t=xAe(e,"string");return nb(t)=="symbol"?t:t+""}function xAe(e,t){if(nb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(nb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var zq=1,_Ae=(function(e){function t(){var n;hAe(this,t);for(var r=arguments.length,c=new Array(r),f=0;f<r;f++)c[f]=arguments[f];return n=mAe(this,t,[].concat(c)),NI(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),NI(n,"handleKeyDown",function(p){if(p.key==="Escape"){var s,w,T,E;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(w=n.props.coordinate)===null||w===void 0?void 0:w.x)!==null&&s!==void 0?s:0,y:(T=(E=n.props.coordinate)===null||E===void 0?void 0:E.y)!==null&&T!==void 0?T:0}})}}),n}return vAe(t,e),pAe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();(Math.abs(r.width-this.state.lastBoundingBox.width)>zq||Math.abs(r.height-this.state.lastBoundingBox.height)>zq)&&this.setState({lastBoundingBox:{width:r.width,height:r.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var r,c;this.props.active&&this.updateBBox(),this.state.dismissed&&(((r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==this.state.dismissedAtCoordinate.x||((c=this.props.coordinate)===null||c===void 0?void 0:c.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var r=this,c=this.props,f=c.active,p=c.allowEscapeViewBox,s=c.animationDuration,w=c.animationEasing,T=c.children,E=c.coordinate,N=c.hasPayload,D=c.isAnimationActive,V=c.offset,$=c.position,B=c.reverseDirection,F=c.useTranslate3d,K=c.viewBox,Y=c.wrapperStyle,X=dAe({allowEscapeViewBox:p,coordinate:E,offsetTopLeft:V,position:$,reverseDirection:B,tooltipBox:this.state.lastBoundingBox,useTranslate3d:F,viewBox:K}),ae=X.cssClasses,Z=X.cssProperties,se=Lq(Lq({transition:D&&f?"transform ".concat(s,"ms ").concat(w):void 0},Z),{},{pointerEvents:"none",visibility:!this.state.dismissed&&f&&N?"visible":"hidden",position:"absolute",top:0,left:0},Y);return _e.createElement("div",{tabIndex:-1,className:ae,style:se,ref:function(ye){r.wrapperNode=ye}},T)}}])})(z.PureComponent),bAe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},pv={isSsr:bAe()};function rb(e){"@babel/helpers - typeof";return rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rb(e)}function Fq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function Bq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Fq(Object(n),!0).forEach(function(r){zz(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function wAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SAe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,uQ(r.key),r)}}function TAe(e,t,n){return t&&SAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function AAe(e,t,n){return t=Aj(t),jAe(e,cQ()?Reflect.construct(t,n||[],Aj(e).constructor):t.apply(e,n))}function jAe(e,t){if(t&&(rb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EAe(e)}function EAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cQ=function(){return!!e})()}function Aj(e){return Aj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Aj(e)}function CAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PI(e,t)}function PI(e,t){return PI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},PI(e,t)}function zz(e,t,n){return t=uQ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uQ(e){var t=NAe(e,"string");return rb(t)=="symbol"?t:t+""}function NAe(e,t){if(rb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(rb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function PAe(e){return e.dataKey}function MAe(e,t){return _e.isValidElement(e)?_e.cloneElement(e,t):typeof e=="function"?_e.createElement(e,t):_e.createElement(sAe,t)}var Dh=(function(e){function t(){return wAe(this,t),AAe(this,t,arguments)}return CAe(t,e),TAe(t,[{key:"render",value:function(){var r=this,c=this.props,f=c.active,p=c.allowEscapeViewBox,s=c.animationDuration,w=c.animationEasing,T=c.content,E=c.coordinate,N=c.filterNull,D=c.isAnimationActive,V=c.offset,$=c.payload,B=c.payloadUniqBy,F=c.position,K=c.reverseDirection,Y=c.useTranslate3d,X=c.viewBox,ae=c.wrapperStyle,Z=$??[];N&&Z.length&&(Z=eQ($.filter(function(he){return he.value!=null&&(he.hide!==!0||r.props.includeHidden)}),B,PAe));var se=Z.length>0;return _e.createElement(_Ae,{allowEscapeViewBox:p,animationDuration:s,animationEasing:w,isAnimationActive:D,active:f,coordinate:E,hasPayload:se,offset:V,position:F,reverseDirection:K,useTranslate3d:Y,viewBox:X,wrapperStyle:ae},MAe(T,Bq(Bq({},this.props),{},{payload:Z})))}}])})(z.PureComponent);zz(Dh,"displayName","Tooltip");zz(Dh,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!pv.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var lD,Uq;function RAe(){if(Uq)return lD;Uq=1;var e=um(),t=function(){return e.Date.now()};return lD=t,lD}var cD,Vq;function OAe(){if(Vq)return cD;Vq=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return cD=t,cD}var uD,$q;function DAe(){if($q)return uD;$q=1;var e=OAe(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return uD=n,uD}var dD,qq;function dQ(){if(qq)return dD;qq=1;var e=DAe(),t=fv(),n=Ub(),r=NaN,c=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,p=/^0o[0-7]+$/i,s=parseInt;function w(T){if(typeof T=="number")return T;if(n(T))return r;if(t(T)){var E=typeof T.valueOf=="function"?T.valueOf():T;T=t(E)?E+"":E}if(typeof T!="string")return T===0?T:+T;T=e(T);var N=f.test(T);return N||p.test(T)?s(T.slice(2),N?2:8):c.test(T)?r:+T}return dD=w,dD}var hD,Hq;function kAe(){if(Hq)return hD;Hq=1;var e=fv(),t=RAe(),n=dQ(),r="Expected a function",c=Math.max,f=Math.min;function p(s,w,T){var E,N,D,V,$,B,F=0,K=!1,Y=!1,X=!0;if(typeof s!="function")throw new TypeError(r);w=n(w)||0,e(T)&&(K=!!T.leading,Y="maxWait"in T,D=Y?c(n(T.maxWait)||0,w):D,X="trailing"in T?!!T.trailing:X);function ae(nt){var Me=E,rt=N;return E=N=void 0,F=nt,V=s.apply(rt,Me),V}function Z(nt){return F=nt,$=setTimeout(ye,w),K?ae(nt):V}function se(nt){var Me=nt-B,rt=nt-F,Ee=w-Me;return Y?f(Ee,D-rt):Ee}function he(nt){var Me=nt-B,rt=nt-F;return B===void 0||Me>=w||Me<0||Y&&rt>=D}function ye(){var nt=t();if(he(nt))return Ce(nt);$=setTimeout(ye,se(nt))}function Ce(nt){return $=void 0,X&&E?ae(nt):(E=N=void 0,V)}function Ve(){$!==void 0&&clearTimeout($),F=0,E=B=N=$=void 0}function Re(){return $===void 0?V:Ce(t())}function $e(){var nt=t(),Me=he(nt);if(E=arguments,N=this,B=nt,Me){if($===void 0)return Z(B);if(Y)return clearTimeout($),$=setTimeout(ye,w),ae(B)}return $===void 0&&($=setTimeout(ye,w)),V}return $e.cancel=Ve,$e.flush=Re,$e}return hD=p,hD}var fD,Gq;function IAe(){if(Gq)return fD;Gq=1;var e=kAe(),t=fv(),n="Expected a function";function r(c,f,p){var s=!0,w=!0;if(typeof c!="function")throw new TypeError(n);return t(p)&&(s="leading"in p?!!p.leading:s,w="trailing"in p?!!p.trailing:w),e(c,f,{leading:s,maxWait:f,trailing:w})}return fD=r,fD}var LAe=IAe();const hQ=Ca(LAe);function fS(e){"@babel/helpers - typeof";return fS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fS(e)}function Wq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function uA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Wq(Object(n),!0).forEach(function(r){zAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function zAe(e,t,n){return t=FAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FAe(e){var t=BAe(e,"string");return fS(t)=="symbol"?t:t+""}function BAe(e,t){if(fS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(fS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UAe(e,t){return HAe(e)||qAe(e,t)||$Ae(e,t)||VAe()}function VAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Ae(e,t){if(e){if(typeof e=="string")return Xq(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xq(e,t)}}function Xq(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qAe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,c,f,p,s=[],w=!0,T=!1;try{if(f=(n=n.call(e)).next,t!==0)for(;!(w=(r=f.call(n)).done)&&(s.push(r.value),s.length!==t);w=!0);}catch(E){T=!0,c=E}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return s}}function HAe(e){if(Array.isArray(e))return e}var Fz=z.forwardRef(function(e,t){var n=e.aspect,r=e.initialDimension,c=r===void 0?{width:-1,height:-1}:r,f=e.width,p=f===void 0?"100%":f,s=e.height,w=s===void 0?"100%":s,T=e.minWidth,E=T===void 0?0:T,N=e.minHeight,D=e.maxHeight,V=e.children,$=e.debounce,B=$===void 0?0:$,F=e.id,K=e.className,Y=e.onResize,X=e.style,ae=X===void 0?{}:X,Z=z.useRef(null),se=z.useRef();se.current=Y,z.useImperativeHandle(t,function(){return Object.defineProperty(Z.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),Z.current},configurable:!0})});var he=z.useState({containerWidth:c.width,containerHeight:c.height}),ye=UAe(he,2),Ce=ye[0],Ve=ye[1],Re=z.useCallback(function(nt,Me){Ve(function(rt){var Ee=Math.round(nt),it=Math.round(Me);return rt.containerWidth===Ee&&rt.containerHeight===it?rt:{containerWidth:Ee,containerHeight:it}})},[]);z.useEffect(function(){var nt=function(mt){var He,pt=mt[0].contentRect,We=pt.width,Je=pt.height;Re(We,Je),(He=se.current)===null||He===void 0||He.call(se,We,Je)};B>0&&(nt=hQ(nt,B,{trailing:!0,leading:!1}));var Me=new ResizeObserver(nt),rt=Z.current.getBoundingClientRect(),Ee=rt.width,it=rt.height;return Re(Ee,it),Me.observe(Z.current),function(){Me.disconnect()}},[Re,B]);var $e=z.useMemo(function(){var nt=Ce.containerWidth,Me=Ce.containerHeight;if(nt<0||Me<0)return null;Lf(Lx(p)||Lx(w),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,p,w),Lf(!n||n>0,"The aspect(%s) must be greater than zero.",n);var rt=Lx(p)?nt:p,Ee=Lx(w)?Me:w;n&&n>0&&(rt?Ee=rt/n:Ee&&(rt=Ee*n),D&&Ee>D&&(Ee=D)),Lf(rt>0||Ee>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,rt,Ee,p,w,E,N,n);var it=!Array.isArray(V)&&wg(V.type).endsWith("Chart");return _e.Children.map(V,function(et){return _e.isValidElement(et)?z.cloneElement(et,uA({width:rt,height:Ee},it?{style:uA({height:"100%",width:"100%",maxHeight:Ee,maxWidth:rt},et.props.style)}:{})):et})},[n,V,w,D,N,E,Ce,p]);return _e.createElement("div",{id:F?"".concat(F):void 0,className:es("recharts-responsive-container",K),style:uA(uA({},ae),{},{width:p,height:w,minWidth:E,minHeight:N,maxHeight:D}),ref:Z},$e)}),jC=function(t){return null};jC.displayName="Cell";function pS(e){"@babel/helpers - typeof";return pS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pS(e)}function Zq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function MI(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Zq(Object(n),!0).forEach(function(r){GAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function GAe(e,t,n){return t=WAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WAe(e){var t=XAe(e,"string");return pS(t)=="symbol"?t:t+""}function XAe(e,t){if(pS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(pS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var y0={widthCache:{},cacheCount:0},ZAe=2e3,YAe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Yq="recharts_measurement_span";function KAe(e){var t=MI({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var V1=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||pv.isSsr)return{width:0,height:0};var r=KAe(n),c=JSON.stringify({text:t,copyStyle:r});if(y0.widthCache[c])return y0.widthCache[c];try{var f=document.getElementById(Yq);f||(f=document.createElement("span"),f.setAttribute("id",Yq),f.setAttribute("aria-hidden","true"),document.body.appendChild(f));var p=MI(MI({},YAe),r);Object.assign(f.style,p),f.textContent="".concat(t);var s=f.getBoundingClientRect(),w={width:s.width,height:s.height};return y0.widthCache[c]=w,++y0.cacheCount>ZAe&&(y0.cacheCount=0,y0.widthCache={}),w}catch{return{width:0,height:0}}},JAe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function mS(e){"@babel/helpers - typeof";return mS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mS(e)}function jj(e,t){return nje(e)||tje(e,t)||eje(e,t)||QAe()}function QAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eje(e,t){if(e){if(typeof e=="string")return Kq(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kq(e,t)}}function Kq(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tje(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,c,f,p,s=[],w=!0,T=!1;try{if(f=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;w=!1}else for(;!(w=(r=f.call(n)).done)&&(s.push(r.value),s.length!==t);w=!0);}catch(E){T=!0,c=E}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return s}}function nje(e){if(Array.isArray(e))return e}function rje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,sje(r.key),r)}}function ije(e,t,n){return t&&Jq(e.prototype,t),n&&Jq(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function sje(e){var t=aje(e,"string");return mS(t)=="symbol"?t:t+""}function aje(e,t){if(mS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(mS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Qq=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,eH=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,oje=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,lje=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,fQ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},cje=Object.keys(fQ),M0="NaN";function uje(e,t){return e*fQ[t]}var dA=(function(){function e(t,n){rje(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!oje.test(n)&&(this.num=NaN,this.unit=""),cje.includes(n)&&(this.num=uje(t,n),this.unit="px")}return ije(e,[{key:"add",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var r,c=(r=lje.exec(n))!==null&&r!==void 0?r:[],f=jj(c,3),p=f[1],s=f[2];return new e(parseFloat(p),s??"")}}])})();function pQ(e){if(e.includes(M0))return M0;for(var t=e;t.includes("*")||t.includes("/");){var n,r=(n=Qq.exec(t))!==null&&n!==void 0?n:[],c=jj(r,4),f=c[1],p=c[2],s=c[3],w=dA.parse(f??""),T=dA.parse(s??""),E=p==="*"?w.multiply(T):w.divide(T);if(E.isNaN())return M0;t=t.replace(Qq,E.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var N,D=(N=eH.exec(t))!==null&&N!==void 0?N:[],V=jj(D,4),$=V[1],B=V[2],F=V[3],K=dA.parse($??""),Y=dA.parse(F??""),X=B==="+"?K.add(Y):K.subtract(Y);if(X.isNaN())return M0;t=t.replace(eH,X.toString())}return t}var tH=/\(([^()]*)\)/;function dje(e){for(var t=e;t.includes("(");){var n=tH.exec(t),r=jj(n,2),c=r[1];t=t.replace(tH,pQ(c))}return t}function hje(e){var t=e.replace(/\s+/g,"");return t=dje(t),t=pQ(t),t}function fje(e){try{return hje(e)}catch{return M0}}function pD(e){var t=fje(e.slice(5,-1));return t===M0?"":t}var pje=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],mje=["dx","dy","angle","className","breakAll"];function RI(){return RI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},RI.apply(this,arguments)}function nH(e,t){if(e==null)return{};var n=gje(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function gje(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function rH(e,t){return _je(e)||xje(e,t)||vje(e,t)||yje()}function yje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vje(e,t){if(e){if(typeof e=="string")return iH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iH(e,t)}}function iH(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xje(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,c,f,p,s=[],w=!0,T=!1;try{if(f=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;w=!1}else for(;!(w=(r=f.call(n)).done)&&(s.push(r.value),s.length!==t);w=!0);}catch(E){T=!0,c=E}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return s}}function _je(e){if(Array.isArray(e))return e}var mQ=/[ \f\n\r\t\v\u2028\u2029]+/,gQ=function(t){var n=t.children,r=t.breakAll,c=t.style;try{var f=[];xs(n)||(r?f=n.toString().split(""):f=n.toString().split(mQ));var p=f.map(function(w){return{word:w,width:V1(w,c).width}}),s=r?0:V1(" ",c).width;return{wordsWithComputedWidth:p,spaceWidth:s}}catch{return null}},bje=function(t,n,r,c,f){var p=t.maxLines,s=t.children,w=t.style,T=t.breakAll,E=jr(p),N=s,D=function(){var rt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return rt.reduce(function(Ee,it){var et=it.word,mt=it.width,He=Ee[Ee.length-1];if(He&&(c==null||f||He.width+mt+r<Number(c)))He.words.push(et),He.width+=mt+r;else{var pt={words:[et],width:mt};Ee.push(pt)}return Ee},[])},V=D(n),$=function(rt){return rt.reduce(function(Ee,it){return Ee.width>it.width?Ee:it})};if(!E)return V;for(var B="…",F=function(rt){var Ee=N.slice(0,rt),it=gQ({breakAll:T,style:w,children:Ee+B}).wordsWithComputedWidth,et=D(it),mt=et.length>p||$(et).width>Number(c);return[mt,et]},K=0,Y=N.length-1,X=0,ae;K<=Y&&X<=N.length-1;){var Z=Math.floor((K+Y)/2),se=Z-1,he=F(se),ye=rH(he,2),Ce=ye[0],Ve=ye[1],Re=F(Z),$e=rH(Re,1),nt=$e[0];if(!Ce&&!nt&&(K=Z+1),Ce&&nt&&(Y=Z-1),!Ce&&nt){ae=Ve;break}X++}return ae||V},sH=function(t){var n=xs(t)?[]:t.toString().split(mQ);return[{words:n}]},wje=function(t){var n=t.width,r=t.scaleToFit,c=t.children,f=t.style,p=t.breakAll,s=t.maxLines;if((n||r)&&!pv.isSsr){var w,T,E=gQ({breakAll:p,children:c,style:f});if(E){var N=E.wordsWithComputedWidth,D=E.spaceWidth;w=N,T=D}else return sH(c);return bje({breakAll:p,children:c,maxLines:s,style:f},w,T,n,r)}return sH(c)},aH="#808080",n_=function(t){var n=t.x,r=n===void 0?0:n,c=t.y,f=c===void 0?0:c,p=t.lineHeight,s=p===void 0?"1em":p,w=t.capHeight,T=w===void 0?"0.71em":w,E=t.scaleToFit,N=E===void 0?!1:E,D=t.textAnchor,V=D===void 0?"start":D,$=t.verticalAnchor,B=$===void 0?"end":$,F=t.fill,K=F===void 0?aH:F,Y=nH(t,pje),X=z.useMemo(function(){return wje({breakAll:Y.breakAll,children:Y.children,maxLines:Y.maxLines,scaleToFit:N,style:Y.style,width:Y.width})},[Y.breakAll,Y.children,Y.maxLines,N,Y.style,Y.width]),ae=Y.dx,Z=Y.dy,se=Y.angle,he=Y.className,ye=Y.breakAll,Ce=nH(Y,mje);if(!Zl(r)||!Zl(f))return null;var Ve=r+(jr(ae)?ae:0),Re=f+(jr(Z)?Z:0),$e;switch(B){case"start":$e=pD("calc(".concat(T,")"));break;case"middle":$e=pD("calc(".concat((X.length-1)/2," * -").concat(s," + (").concat(T," / 2))"));break;default:$e=pD("calc(".concat(X.length-1," * -").concat(s,")"));break}var nt=[];if(N){var Me=X[0].width,rt=Y.width;nt.push("scale(".concat((jr(rt)?rt/Me:1)/Me,")"))}return se&&nt.push("rotate(".concat(se,", ").concat(Ve,", ").concat(Re,")")),nt.length&&(Ce.transform=nt.join(" ")),_e.createElement("text",RI({},Oi(Ce,!0),{x:Ve,y:Re,className:es("recharts-text",he),textAnchor:V,fill:K.includes("url")?aH:K}),X.map(function(Ee,it){var et=Ee.words.join(ye?"":" ");return _e.createElement("tspan",{x:Ve,dy:it===0?$e:s,key:"".concat(et,"-").concat(it)},et)}))};function ev(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Sje(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Bz(e){let t,n,r;e.length!==2?(t=ev,n=(s,w)=>ev(e(s),w),r=(s,w)=>e(s)-w):(t=e===ev||e===Sje?e:Tje,n=e,r=e);function c(s,w,T=0,E=s.length){if(T<E){if(t(w,w)!==0)return E;do{const N=T+E>>>1;n(s[N],w)<0?T=N+1:E=N}while(T<E)}return T}function f(s,w,T=0,E=s.length){if(T<E){if(t(w,w)!==0)return E;do{const N=T+E>>>1;n(s[N],w)<=0?T=N+1:E=N}while(T<E)}return T}function p(s,w,T=0,E=s.length){const N=c(s,w,T,E-1);return N>T&&r(s[N-1],w)>-r(s[N],w)?N-1:N}return{left:c,center:p,right:f}}function Tje(){return 0}function yQ(e){return e===null?NaN:+e}function*Aje(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const jje=Bz(ev),wT=jje.right;Bz(yQ).center;class oH extends Map{constructor(t,n=Nje){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,c]of t)this.set(r,c)}get(t){return super.get(lH(this,t))}has(t){return super.has(lH(this,t))}set(t,n){return super.set(Eje(this,t),n)}delete(t){return super.delete(Cje(this,t))}}function lH({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function Eje({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function Cje({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function Nje(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Pje(e=ev){if(e===ev)return vQ;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function vQ(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Mje=Math.sqrt(50),Rje=Math.sqrt(10),Oje=Math.sqrt(2);function Ej(e,t,n){const r=(t-e)/Math.max(0,n),c=Math.floor(Math.log10(r)),f=r/Math.pow(10,c),p=f>=Mje?10:f>=Rje?5:f>=Oje?2:1;let s,w,T;return c<0?(T=Math.pow(10,-c)/p,s=Math.round(e*T),w=Math.round(t*T),s/T<e&&++s,w/T>t&&--w,T=-T):(T=Math.pow(10,c)*p,s=Math.round(e/T),w=Math.round(t/T),s*T<e&&++s,w*T>t&&--w),w<s&&.5<=n&&n<2?Ej(e,t,n*2):[s,w,T]}function OI(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[c,f,p]=r?Ej(t,e,n):Ej(e,t,n);if(!(f>=c))return[];const s=f-c+1,w=new Array(s);if(r)if(p<0)for(let T=0;T<s;++T)w[T]=(f-T)/-p;else for(let T=0;T<s;++T)w[T]=(f-T)*p;else if(p<0)for(let T=0;T<s;++T)w[T]=(c+T)/-p;else for(let T=0;T<s;++T)w[T]=(c+T)*p;return w}function DI(e,t,n){return t=+t,e=+e,n=+n,Ej(e,t,n)[2]}function kI(e,t,n){t=+t,e=+e,n=+n;const r=t<e,c=r?DI(t,e,n):DI(e,t,n);return(r?-1:1)*(c<0?1/-c:c)}function cH(e,t){let n;for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function uH(e,t){let n;for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function xQ(e,t,n=0,r=1/0,c){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(c=c===void 0?vQ:Pje(c);r>n;){if(r-n>600){const w=r-n+1,T=t-n+1,E=Math.log(w),N=.5*Math.exp(2*E/3),D=.5*Math.sqrt(E*N*(w-N)/w)*(T-w/2<0?-1:1),V=Math.max(n,Math.floor(t-T*N/w+D)),$=Math.min(r,Math.floor(t+(w-T)*N/w+D));xQ(e,t,V,$,c)}const f=e[t];let p=n,s=r;for(p1(e,n,t),c(e[r],f)>0&&p1(e,n,r);p<s;){for(p1(e,p,s),++p,--s;c(e[p],f)<0;)++p;for(;c(e[s],f)>0;)--s}c(e[n],f)===0?p1(e,n,s):(++s,p1(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function p1(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Dje(e,t,n){if(e=Float64Array.from(Aje(e)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return uH(e);if(t>=1)return cH(e);var r,c=(r-1)*t,f=Math.floor(c),p=cH(xQ(e,f).subarray(0,f+1)),s=uH(e.subarray(f+1));return p+(s-p)*(c-f)}}function kje(e,t,n=yQ){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,c=(r-1)*t,f=Math.floor(c),p=+n(e[f],f,e),s=+n(e[f+1],f+1,e);return p+(s-p)*(c-f)}}function Ije(e,t,n){e=+e,t=+t,n=(c=arguments.length)<2?(t=e,e=0,1):c<3?1:+n;for(var r=-1,c=Math.max(0,Math.ceil((t-e)/n))|0,f=new Array(c);++r<c;)f[r]=e+r*n;return f}function $h(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ig(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const II=Symbol("implicit");function Uz(){var e=new oH,t=[],n=[],r=II;function c(f){let p=e.get(f);if(p===void 0){if(r!==II)return r;e.set(f,p=t.push(f)-1)}return n[p%n.length]}return c.domain=function(f){if(!arguments.length)return t.slice();t=[],e=new oH;for(const p of f)e.has(p)||e.set(p,t.push(p)-1);return c},c.range=function(f){return arguments.length?(n=Array.from(f),c):n.slice()},c.unknown=function(f){return arguments.length?(r=f,c):r},c.copy=function(){return Uz(t,n).unknown(r)},$h.apply(c,arguments),c}function gS(){var e=Uz().unknown(void 0),t=e.domain,n=e.range,r=0,c=1,f,p,s=!1,w=0,T=0,E=.5;delete e.unknown;function N(){var D=t().length,V=c<r,$=V?c:r,B=V?r:c;f=(B-$)/Math.max(1,D-w+T*2),s&&(f=Math.floor(f)),$+=(B-$-f*(D-w))*E,p=f*(1-w),s&&($=Math.round($),p=Math.round(p));var F=Ije(D).map(function(K){return $+f*K});return n(V?F.reverse():F)}return e.domain=function(D){return arguments.length?(t(D),N()):t()},e.range=function(D){return arguments.length?([r,c]=D,r=+r,c=+c,N()):[r,c]},e.rangeRound=function(D){return[r,c]=D,r=+r,c=+c,s=!0,N()},e.bandwidth=function(){return p},e.step=function(){return f},e.round=function(D){return arguments.length?(s=!!D,N()):s},e.padding=function(D){return arguments.length?(w=Math.min(1,T=+D),N()):w},e.paddingInner=function(D){return arguments.length?(w=Math.min(1,D),N()):w},e.paddingOuter=function(D){return arguments.length?(T=+D,N()):T},e.align=function(D){return arguments.length?(E=Math.max(0,Math.min(1,D)),N()):E},e.copy=function(){return gS(t(),[r,c]).round(s).paddingInner(w).paddingOuter(T).align(E)},$h.apply(N(),arguments)}function _Q(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return _Q(t())},e}function $1(){return _Q(gS.apply(null,arguments).paddingInner(1))}function Vz(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function bQ(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ST(){}var yS=.7,Cj=1/yS,$0="\\s*([+-]?\\d+)\\s*",vS="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",nm="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Lje=/^#([0-9a-f]{3,8})$/,zje=new RegExp(`^rgb\\(${$0},${$0},${$0}\\)$`),Fje=new RegExp(`^rgb\\(${nm},${nm},${nm}\\)$`),Bje=new RegExp(`^rgba\\(${$0},${$0},${$0},${vS}\\)$`),Uje=new RegExp(`^rgba\\(${nm},${nm},${nm},${vS}\\)$`),Vje=new RegExp(`^hsl\\(${vS},${nm},${nm}\\)$`),$je=new RegExp(`^hsla\\(${vS},${nm},${nm},${vS}\\)$`),dH={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Vz(ST,xS,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:hH,formatHex:hH,formatHex8:qje,formatHsl:Hje,formatRgb:fH,toString:fH});function hH(){return this.rgb().formatHex()}function qje(){return this.rgb().formatHex8()}function Hje(){return wQ(this).formatHsl()}function fH(){return this.rgb().formatRgb()}function xS(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Lje.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?pH(t):n===3?new Ju(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?hA(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?hA(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=zje.exec(e))?new Ju(t[1],t[2],t[3],1):(t=Fje.exec(e))?new Ju(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Bje.exec(e))?hA(t[1],t[2],t[3],t[4]):(t=Uje.exec(e))?hA(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Vje.exec(e))?yH(t[1],t[2]/100,t[3]/100,1):(t=$je.exec(e))?yH(t[1],t[2]/100,t[3]/100,t[4]):dH.hasOwnProperty(e)?pH(dH[e]):e==="transparent"?new Ju(NaN,NaN,NaN,0):null}function pH(e){return new Ju(e>>16&255,e>>8&255,e&255,1)}function hA(e,t,n,r){return r<=0&&(e=t=n=NaN),new Ju(e,t,n,r)}function Gje(e){return e instanceof ST||(e=xS(e)),e?(e=e.rgb(),new Ju(e.r,e.g,e.b,e.opacity)):new Ju}function LI(e,t,n,r){return arguments.length===1?Gje(e):new Ju(e,t,n,r??1)}function Ju(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Vz(Ju,LI,bQ(ST,{brighter(e){return e=e==null?Cj:Math.pow(Cj,e),new Ju(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?yS:Math.pow(yS,e),new Ju(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ju(Wx(this.r),Wx(this.g),Wx(this.b),Nj(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:mH,formatHex:mH,formatHex8:Wje,formatRgb:gH,toString:gH}));function mH(){return`#${zx(this.r)}${zx(this.g)}${zx(this.b)}`}function Wje(){return`#${zx(this.r)}${zx(this.g)}${zx(this.b)}${zx((isNaN(this.opacity)?1:this.opacity)*255)}`}function gH(){const e=Nj(this.opacity);return`${e===1?"rgb(":"rgba("}${Wx(this.r)}, ${Wx(this.g)}, ${Wx(this.b)}${e===1?")":`, ${e})`}`}function Nj(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Wx(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function zx(e){return e=Wx(e),(e<16?"0":"")+e.toString(16)}function yH(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Of(e,t,n,r)}function wQ(e){if(e instanceof Of)return new Of(e.h,e.s,e.l,e.opacity);if(e instanceof ST||(e=xS(e)),!e)return new Of;if(e instanceof Of)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,c=Math.min(t,n,r),f=Math.max(t,n,r),p=NaN,s=f-c,w=(f+c)/2;return s?(t===f?p=(n-r)/s+(n<r)*6:n===f?p=(r-t)/s+2:p=(t-n)/s+4,s/=w<.5?f+c:2-f-c,p*=60):s=w>0&&w<1?0:p,new Of(p,s,w,e.opacity)}function Xje(e,t,n,r){return arguments.length===1?wQ(e):new Of(e,t,n,r??1)}function Of(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Vz(Of,Xje,bQ(ST,{brighter(e){return e=e==null?Cj:Math.pow(Cj,e),new Of(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?yS:Math.pow(yS,e),new Of(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,c=2*n-r;return new Ju(mD(e>=240?e-240:e+120,c,r),mD(e,c,r),mD(e<120?e+240:e-120,c,r),this.opacity)},clamp(){return new Of(vH(this.h),fA(this.s),fA(this.l),Nj(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Nj(this.opacity);return`${e===1?"hsl(":"hsla("}${vH(this.h)}, ${fA(this.s)*100}%, ${fA(this.l)*100}%${e===1?")":`, ${e})`}`}}));function vH(e){return e=(e||0)%360,e<0?e+360:e}function fA(e){return Math.max(0,Math.min(1,e||0))}function mD(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const $z=e=>()=>e;function Zje(e,t){return function(n){return e+n*t}}function Yje(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Kje(e){return(e=+e)==1?SQ:function(t,n){return n-t?Yje(t,n,e):$z(isNaN(t)?n:t)}}function SQ(e,t){var n=t-e;return n?Zje(e,n):$z(isNaN(e)?t:e)}const xH=(function e(t){var n=Kje(t);function r(c,f){var p=n((c=LI(c)).r,(f=LI(f)).r),s=n(c.g,f.g),w=n(c.b,f.b),T=SQ(c.opacity,f.opacity);return function(E){return c.r=p(E),c.g=s(E),c.b=w(E),c.opacity=T(E),c+""}}return r.gamma=e,r})(1);function Jje(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),c;return function(f){for(c=0;c<n;++c)r[c]=e[c]*(1-f)+t[c]*f;return r}}function Qje(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function eEe(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,c=new Array(r),f=new Array(n),p;for(p=0;p<r;++p)c[p]=Hb(e[p],t[p]);for(;p<n;++p)f[p]=t[p];return function(s){for(p=0;p<r;++p)f[p]=c[p](s);return f}}function tEe(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Pj(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function nEe(e,t){var n={},r={},c;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(c in t)c in e?n[c]=Hb(e[c],t[c]):r[c]=t[c];return function(f){for(c in n)r[c]=n[c](f);return r}}var zI=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gD=new RegExp(zI.source,"g");function rEe(e){return function(){return e}}function iEe(e){return function(t){return e(t)+""}}function sEe(e,t){var n=zI.lastIndex=gD.lastIndex=0,r,c,f,p=-1,s=[],w=[];for(e=e+"",t=t+"";(r=zI.exec(e))&&(c=gD.exec(t));)(f=c.index)>n&&(f=t.slice(n,f),s[p]?s[p]+=f:s[++p]=f),(r=r[0])===(c=c[0])?s[p]?s[p]+=c:s[++p]=c:(s[++p]=null,w.push({i:p,x:Pj(r,c)})),n=gD.lastIndex;return n<t.length&&(f=t.slice(n),s[p]?s[p]+=f:s[++p]=f),s.length<2?w[0]?iEe(w[0].x):rEe(t):(t=w.length,function(T){for(var E=0,N;E<t;++E)s[(N=w[E]).i]=N.x(T);return s.join("")})}function Hb(e,t){var n=typeof t,r;return t==null||n==="boolean"?$z(t):(n==="number"?Pj:n==="string"?(r=xS(t))?(t=r,xH):sEe:t instanceof xS?xH:t instanceof Date?tEe:Qje(t)?Jje:Array.isArray(t)?eEe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?nEe:Pj)(e,t)}function qz(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function aEe(e,t){t===void 0&&(t=e,e=Hb);for(var n=0,r=t.length-1,c=t[0],f=new Array(r<0?0:r);n<r;)f[n]=e(c,c=t[++n]);return function(p){var s=Math.max(0,Math.min(r-1,Math.floor(p*=r)));return f[s](p-s)}}function oEe(e){return function(){return e}}function Mj(e){return+e}var _H=[0,1];function Su(e){return e}function FI(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:oEe(isNaN(t)?NaN:.5)}function lEe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function cEe(e,t,n){var r=e[0],c=e[1],f=t[0],p=t[1];return c<r?(r=FI(c,r),f=n(p,f)):(r=FI(r,c),f=n(f,p)),function(s){return f(r(s))}}function uEe(e,t,n){var r=Math.min(e.length,t.length)-1,c=new Array(r),f=new Array(r),p=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++p<r;)c[p]=FI(e[p],e[p+1]),f[p]=n(t[p],t[p+1]);return function(s){var w=wT(e,s,1,r)-1;return f[w](c[w](s))}}function TT(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function EC(){var e=_H,t=_H,n=Hb,r,c,f,p=Su,s,w,T;function E(){var D=Math.min(e.length,t.length);return p!==Su&&(p=lEe(e[0],e[D-1])),s=D>2?uEe:cEe,w=T=null,N}function N(D){return D==null||isNaN(D=+D)?f:(w||(w=s(e.map(r),t,n)))(r(p(D)))}return N.invert=function(D){return p(c((T||(T=s(t,e.map(r),Pj)))(D)))},N.domain=function(D){return arguments.length?(e=Array.from(D,Mj),E()):e.slice()},N.range=function(D){return arguments.length?(t=Array.from(D),E()):t.slice()},N.rangeRound=function(D){return t=Array.from(D),n=qz,E()},N.clamp=function(D){return arguments.length?(p=D?!0:Su,E()):p!==Su},N.interpolate=function(D){return arguments.length?(n=D,E()):n},N.unknown=function(D){return arguments.length?(f=D,N):f},function(D,V){return r=D,c=V,E()}}function Hz(){return EC()(Su,Su)}function dEe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Rj(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function ib(e){return e=Rj(Math.abs(e)),e?e[1]:NaN}function hEe(e,t){return function(n,r){for(var c=n.length,f=[],p=0,s=e[0],w=0;c>0&&s>0&&(w+s+1>r&&(s=Math.max(1,r-w)),f.push(n.substring(c-=s,c+s)),!((w+=s+1)>r));)s=e[p=(p+1)%e.length];return f.reverse().join(t)}}function fEe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var pEe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function _S(e){if(!(t=pEe.exec(e)))throw new Error("invalid format: "+e);var t;return new Gz({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}_S.prototype=Gz.prototype;function Gz(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Gz.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function mEe(e){e:for(var t=e.length,n=1,r=-1,c;n<t;++n)switch(e[n]){case".":r=c=n;break;case"0":r===0&&(r=n),c=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(c+1):e}var TQ;function gEe(e,t){var n=Rj(e,t);if(!n)return e+"";var r=n[0],c=n[1],f=c-(TQ=Math.max(-8,Math.min(8,Math.floor(c/3)))*3)+1,p=r.length;return f===p?r:f>p?r+new Array(f-p+1).join("0"):f>0?r.slice(0,f)+"."+r.slice(f):"0."+new Array(1-f).join("0")+Rj(e,Math.max(0,t+f-1))[0]}function bH(e,t){var n=Rj(e,t);if(!n)return e+"";var r=n[0],c=n[1];return c<0?"0."+new Array(-c).join("0")+r:r.length>c+1?r.slice(0,c+1)+"."+r.slice(c+1):r+new Array(c-r.length+2).join("0")}const wH={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:dEe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>bH(e*100,t),r:bH,s:gEe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function SH(e){return e}var TH=Array.prototype.map,AH=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function yEe(e){var t=e.grouping===void 0||e.thousands===void 0?SH:hEe(TH.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",c=e.decimal===void 0?".":e.decimal+"",f=e.numerals===void 0?SH:fEe(TH.call(e.numerals,String)),p=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"−":e.minus+"",w=e.nan===void 0?"NaN":e.nan+"";function T(N){N=_S(N);var D=N.fill,V=N.align,$=N.sign,B=N.symbol,F=N.zero,K=N.width,Y=N.comma,X=N.precision,ae=N.trim,Z=N.type;Z==="n"?(Y=!0,Z="g"):wH[Z]||(X===void 0&&(X=12),ae=!0,Z="g"),(F||D==="0"&&V==="=")&&(F=!0,D="0",V="=");var se=B==="$"?n:B==="#"&&/[boxX]/.test(Z)?"0"+Z.toLowerCase():"",he=B==="$"?r:/[%p]/.test(Z)?p:"",ye=wH[Z],Ce=/[defgprs%]/.test(Z);X=X===void 0?6:/[gprs]/.test(Z)?Math.max(1,Math.min(21,X)):Math.max(0,Math.min(20,X));function Ve(Re){var $e=se,nt=he,Me,rt,Ee;if(Z==="c")nt=ye(Re)+nt,Re="";else{Re=+Re;var it=Re<0||1/Re<0;if(Re=isNaN(Re)?w:ye(Math.abs(Re),X),ae&&(Re=mEe(Re)),it&&+Re==0&&$!=="+"&&(it=!1),$e=(it?$==="("?$:s:$==="-"||$==="("?"":$)+$e,nt=(Z==="s"?AH[8+TQ/3]:"")+nt+(it&&$==="("?")":""),Ce){for(Me=-1,rt=Re.length;++Me<rt;)if(Ee=Re.charCodeAt(Me),48>Ee||Ee>57){nt=(Ee===46?c+Re.slice(Me+1):Re.slice(Me))+nt,Re=Re.slice(0,Me);break}}}Y&&!F&&(Re=t(Re,1/0));var et=$e.length+Re.length+nt.length,mt=et<K?new Array(K-et+1).join(D):"";switch(Y&&F&&(Re=t(mt+Re,mt.length?K-nt.length:1/0),mt=""),V){case"<":Re=$e+Re+nt+mt;break;case"=":Re=$e+mt+Re+nt;break;case"^":Re=mt.slice(0,et=mt.length>>1)+$e+Re+nt+mt.slice(et);break;default:Re=mt+$e+Re+nt;break}return f(Re)}return Ve.toString=function(){return N+""},Ve}function E(N,D){var V=T((N=_S(N),N.type="f",N)),$=Math.max(-8,Math.min(8,Math.floor(ib(D)/3)))*3,B=Math.pow(10,-$),F=AH[8+$/3];return function(K){return V(B*K)+F}}return{format:T,formatPrefix:E}}var pA,Wz,AQ;vEe({thousands:",",grouping:[3],currency:["$",""]});function vEe(e){return pA=yEe(e),Wz=pA.format,AQ=pA.formatPrefix,pA}function xEe(e){return Math.max(0,-ib(Math.abs(e)))}function _Ee(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ib(t)/3)))*3-ib(Math.abs(e)))}function bEe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ib(t)-ib(e))+1}function jQ(e,t,n,r){var c=kI(e,t,n),f;switch(r=_S(r??",f"),r.type){case"s":{var p=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(f=_Ee(c,p))&&(r.precision=f),AQ(r,p)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(f=bEe(c,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=f-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(f=xEe(c))&&(r.precision=f-(r.type==="%")*2);break}}return Wz(r)}function mv(e){var t=e.domain;return e.ticks=function(n){var r=t();return OI(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var c=t();return jQ(c[0],c[c.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),c=0,f=r.length-1,p=r[c],s=r[f],w,T,E=10;for(s<p&&(T=p,p=s,s=T,T=c,c=f,f=T);E-- >0;){if(T=DI(p,s,n),T===w)return r[c]=p,r[f]=s,t(r);if(T>0)p=Math.floor(p/T)*T,s=Math.ceil(s/T)*T;else if(T<0)p=Math.ceil(p*T)/T,s=Math.floor(s*T)/T;else break;w=T}return e},e}function Oj(){var e=Hz();return e.copy=function(){return TT(e,Oj())},$h.apply(e,arguments),mv(e)}function EQ(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,Mj),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return EQ(e).unknown(t)},e=arguments.length?Array.from(e,Mj):[0,1],mv(n)}function CQ(e,t){e=e.slice();var n=0,r=e.length-1,c=e[n],f=e[r],p;return f<c&&(p=n,n=r,r=p,p=c,c=f,f=p),e[n]=t.floor(c),e[r]=t.ceil(f),e}function jH(e){return Math.log(e)}function EH(e){return Math.exp(e)}function wEe(e){return-Math.log(-e)}function SEe(e){return-Math.exp(-e)}function TEe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function AEe(e){return e===10?TEe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function jEe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function CH(e){return(t,n)=>-e(-t,n)}function Xz(e){const t=e(jH,EH),n=t.domain;let r=10,c,f;function p(){return c=jEe(r),f=AEe(r),n()[0]<0?(c=CH(c),f=CH(f),e(wEe,SEe)):e(jH,EH),t}return t.base=function(s){return arguments.length?(r=+s,p()):r},t.domain=function(s){return arguments.length?(n(s),p()):n()},t.ticks=s=>{const w=n();let T=w[0],E=w[w.length-1];const N=E<T;N&&([T,E]=[E,T]);let D=c(T),V=c(E),$,B;const F=s==null?10:+s;let K=[];if(!(r%1)&&V-D<F){if(D=Math.floor(D),V=Math.ceil(V),T>0){for(;D<=V;++D)for($=1;$<r;++$)if(B=D<0?$/f(-D):$*f(D),!(B<T)){if(B>E)break;K.push(B)}}else for(;D<=V;++D)for($=r-1;$>=1;--$)if(B=D>0?$/f(-D):$*f(D),!(B<T)){if(B>E)break;K.push(B)}K.length*2<F&&(K=OI(T,E,F))}else K=OI(D,V,Math.min(V-D,F)).map(f);return N?K.reverse():K},t.tickFormat=(s,w)=>{if(s==null&&(s=10),w==null&&(w=r===10?"s":","),typeof w!="function"&&(!(r%1)&&(w=_S(w)).precision==null&&(w.trim=!0),w=Wz(w)),s===1/0)return w;const T=Math.max(1,r*s/t.ticks().length);return E=>{let N=E/f(Math.round(c(E)));return N*r<r-.5&&(N*=r),N<=T?w(E):""}},t.nice=()=>n(CQ(n(),{floor:s=>f(Math.floor(c(s))),ceil:s=>f(Math.ceil(c(s)))})),t}function NQ(){const e=Xz(EC()).domain([1,10]);return e.copy=()=>TT(e,NQ()).base(e.base()),$h.apply(e,arguments),e}function NH(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function PH(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Zz(e){var t=1,n=e(NH(t),PH(t));return n.constant=function(r){return arguments.length?e(NH(t=+r),PH(t)):t},mv(n)}function PQ(){var e=Zz(EC());return e.copy=function(){return TT(e,PQ()).constant(e.constant())},$h.apply(e,arguments)}function MH(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function EEe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function CEe(e){return e<0?-e*e:e*e}function Yz(e){var t=e(Su,Su),n=1;function r(){return n===1?e(Su,Su):n===.5?e(EEe,CEe):e(MH(n),MH(1/n))}return t.exponent=function(c){return arguments.length?(n=+c,r()):n},mv(t)}function Kz(){var e=Yz(EC());return e.copy=function(){return TT(e,Kz()).exponent(e.exponent())},$h.apply(e,arguments),e}function NEe(){return Kz.apply(null,arguments).exponent(.5)}function RH(e){return Math.sign(e)*e*e}function PEe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function MQ(){var e=Hz(),t=[0,1],n=!1,r;function c(f){var p=PEe(e(f));return isNaN(p)?r:n?Math.round(p):p}return c.invert=function(f){return e.invert(RH(f))},c.domain=function(f){return arguments.length?(e.domain(f),c):e.domain()},c.range=function(f){return arguments.length?(e.range((t=Array.from(f,Mj)).map(RH)),c):t.slice()},c.rangeRound=function(f){return c.range(f).round(!0)},c.round=function(f){return arguments.length?(n=!!f,c):n},c.clamp=function(f){return arguments.length?(e.clamp(f),c):e.clamp()},c.unknown=function(f){return arguments.length?(r=f,c):r},c.copy=function(){return MQ(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},$h.apply(c,arguments),mv(c)}function RQ(){var e=[],t=[],n=[],r;function c(){var p=0,s=Math.max(1,t.length);for(n=new Array(s-1);++p<s;)n[p-1]=kje(e,p/s);return f}function f(p){return p==null||isNaN(p=+p)?r:t[wT(n,p)]}return f.invertExtent=function(p){var s=t.indexOf(p);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},f.domain=function(p){if(!arguments.length)return e.slice();e=[];for(let s of p)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(ev),c()},f.range=function(p){return arguments.length?(t=Array.from(p),c()):t.slice()},f.unknown=function(p){return arguments.length?(r=p,f):r},f.quantiles=function(){return n.slice()},f.copy=function(){return RQ().domain(e).range(t).unknown(r)},$h.apply(f,arguments)}function OQ(){var e=0,t=1,n=1,r=[.5],c=[0,1],f;function p(w){return w!=null&&w<=w?c[wT(r,w,0,n)]:f}function s(){var w=-1;for(r=new Array(n);++w<n;)r[w]=((w+1)*t-(w-n)*e)/(n+1);return p}return p.domain=function(w){return arguments.length?([e,t]=w,e=+e,t=+t,s()):[e,t]},p.range=function(w){return arguments.length?(n=(c=Array.from(w)).length-1,s()):c.slice()},p.invertExtent=function(w){var T=c.indexOf(w);return T<0?[NaN,NaN]:T<1?[e,r[0]]:T>=n?[r[n-1],t]:[r[T-1],r[T]]},p.unknown=function(w){return arguments.length&&(f=w),p},p.thresholds=function(){return r.slice()},p.copy=function(){return OQ().domain([e,t]).range(c).unknown(f)},$h.apply(mv(p),arguments)}function DQ(){var e=[.5],t=[0,1],n,r=1;function c(f){return f!=null&&f<=f?t[wT(e,f,0,r)]:n}return c.domain=function(f){return arguments.length?(e=Array.from(f),r=Math.min(e.length,t.length-1),c):e.slice()},c.range=function(f){return arguments.length?(t=Array.from(f),r=Math.min(e.length,t.length-1),c):t.slice()},c.invertExtent=function(f){var p=t.indexOf(f);return[e[p-1],e[p]]},c.unknown=function(f){return arguments.length?(n=f,c):n},c.copy=function(){return DQ().domain(e).range(t).unknown(n)},$h.apply(c,arguments)}const yD=new Date,vD=new Date;function Jl(e,t,n,r){function c(f){return e(f=arguments.length===0?new Date:new Date(+f)),f}return c.floor=f=>(e(f=new Date(+f)),f),c.ceil=f=>(e(f=new Date(f-1)),t(f,1),e(f),f),c.round=f=>{const p=c(f),s=c.ceil(f);return f-p<s-f?p:s},c.offset=(f,p)=>(t(f=new Date(+f),p==null?1:Math.floor(p)),f),c.range=(f,p,s)=>{const w=[];if(f=c.ceil(f),s=s==null?1:Math.floor(s),!(f<p)||!(s>0))return w;let T;do w.push(T=new Date(+f)),t(f,s),e(f);while(T<f&&f<p);return w},c.filter=f=>Jl(p=>{if(p>=p)for(;e(p),!f(p);)p.setTime(p-1)},(p,s)=>{if(p>=p)if(s<0)for(;++s<=0;)for(;t(p,-1),!f(p););else for(;--s>=0;)for(;t(p,1),!f(p););}),n&&(c.count=(f,p)=>(yD.setTime(+f),vD.setTime(+p),e(yD),e(vD),Math.floor(n(yD,vD))),c.every=f=>(f=Math.floor(f),!isFinite(f)||!(f>0)?null:f>1?c.filter(r?p=>r(p)%f===0:p=>c.count(0,p)%f===0):c)),c}const Dj=Jl(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Dj.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Jl(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Dj);Dj.range;const mg=1e3,zh=mg*60,gg=zh*60,Pg=gg*24,Jz=Pg*7,OH=Pg*30,xD=Pg*365,Fx=Jl(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*mg)},(e,t)=>(t-e)/mg,e=>e.getUTCSeconds());Fx.range;const Qz=Jl(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*mg)},(e,t)=>{e.setTime(+e+t*zh)},(e,t)=>(t-e)/zh,e=>e.getMinutes());Qz.range;const eF=Jl(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*zh)},(e,t)=>(t-e)/zh,e=>e.getUTCMinutes());eF.range;const tF=Jl(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*mg-e.getMinutes()*zh)},(e,t)=>{e.setTime(+e+t*gg)},(e,t)=>(t-e)/gg,e=>e.getHours());tF.range;const nF=Jl(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*gg)},(e,t)=>(t-e)/gg,e=>e.getUTCHours());nF.range;const AT=Jl(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*zh)/Pg,e=>e.getDate()-1);AT.range;const CC=Jl(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Pg,e=>e.getUTCDate()-1);CC.range;const kQ=Jl(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Pg,e=>Math.floor(e/Pg));kQ.range;function g_(e){return Jl(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*zh)/Jz)}const NC=g_(0),kj=g_(1),MEe=g_(2),REe=g_(3),sb=g_(4),OEe=g_(5),DEe=g_(6);NC.range;kj.range;MEe.range;REe.range;sb.range;OEe.range;DEe.range;function y_(e){return Jl(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/Jz)}const PC=y_(0),Ij=y_(1),kEe=y_(2),IEe=y_(3),ab=y_(4),LEe=y_(5),zEe=y_(6);PC.range;Ij.range;kEe.range;IEe.range;ab.range;LEe.range;zEe.range;const rF=Jl(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());rF.range;const iF=Jl(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());iF.range;const Mg=Jl(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Mg.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Jl(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Mg.range;const Rg=Jl(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Rg.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Jl(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Rg.range;function IQ(e,t,n,r,c,f){const p=[[Fx,1,mg],[Fx,5,5*mg],[Fx,15,15*mg],[Fx,30,30*mg],[f,1,zh],[f,5,5*zh],[f,15,15*zh],[f,30,30*zh],[c,1,gg],[c,3,3*gg],[c,6,6*gg],[c,12,12*gg],[r,1,Pg],[r,2,2*Pg],[n,1,Jz],[t,1,OH],[t,3,3*OH],[e,1,xD]];function s(T,E,N){const D=E<T;D&&([T,E]=[E,T]);const V=N&&typeof N.range=="function"?N:w(T,E,N),$=V?V.range(T,+E+1):[];return D?$.reverse():$}function w(T,E,N){const D=Math.abs(E-T)/N,V=Bz(([,,F])=>F).right(p,D);if(V===p.length)return e.every(kI(T/xD,E/xD,N));if(V===0)return Dj.every(Math.max(kI(T,E,N),1));const[$,B]=p[D/p[V-1][2]<p[V][2]/D?V-1:V];return $.every(B)}return[s,w]}const[FEe,BEe]=IQ(Rg,iF,PC,kQ,nF,eF),[UEe,VEe]=IQ(Mg,rF,NC,AT,tF,Qz);function _D(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function bD(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function m1(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function $Ee(e){var t=e.dateTime,n=e.date,r=e.time,c=e.periods,f=e.days,p=e.shortDays,s=e.months,w=e.shortMonths,T=g1(c),E=y1(c),N=g1(f),D=y1(f),V=g1(p),$=y1(p),B=g1(s),F=y1(s),K=g1(w),Y=y1(w),X={a:it,A:et,b:mt,B:He,c:null,d:FH,e:FH,f:hCe,g:wCe,G:TCe,H:cCe,I:uCe,j:dCe,L:LQ,m:fCe,M:pCe,p:pt,q:We,Q:VH,s:$H,S:mCe,u:gCe,U:yCe,V:vCe,w:xCe,W:_Ce,x:null,X:null,y:bCe,Y:SCe,Z:ACe,"%":UH},ae={a:Je,A:jt,b:Pt,B:Ot,c:null,d:BH,e:BH,f:NCe,g:FCe,G:UCe,H:jCe,I:ECe,j:CCe,L:FQ,m:PCe,M:MCe,p:Mt,q:an,Q:VH,s:$H,S:RCe,u:OCe,U:DCe,V:kCe,w:ICe,W:LCe,x:null,X:null,y:zCe,Y:BCe,Z:VCe,"%":UH},Z={a:Ve,A:Re,b:$e,B:nt,c:Me,d:LH,e:LH,f:sCe,g:IH,G:kH,H:zH,I:zH,j:tCe,L:iCe,m:eCe,M:nCe,p:Ce,q:QEe,Q:oCe,s:lCe,S:rCe,u:XEe,U:ZEe,V:YEe,w:WEe,W:KEe,x:rt,X:Ee,y:IH,Y:kH,Z:JEe,"%":aCe};X.x=se(n,X),X.X=se(r,X),X.c=se(t,X),ae.x=se(n,ae),ae.X=se(r,ae),ae.c=se(t,ae);function se(Jt,Cn){return function(nr){var sn=[],zr=-1,or=0,Rr=Jt.length,qr,Nn,ci;for(nr instanceof Date||(nr=new Date(+nr));++zr<Rr;)Jt.charCodeAt(zr)===37&&(sn.push(Jt.slice(or,zr)),(Nn=DH[qr=Jt.charAt(++zr)])!=null?qr=Jt.charAt(++zr):Nn=qr==="e"?" ":"0",(ci=Cn[qr])&&(qr=ci(nr,Nn)),sn.push(qr),or=zr+1);return sn.push(Jt.slice(or,zr)),sn.join("")}}function he(Jt,Cn){return function(nr){var sn=m1(1900,void 0,1),zr=ye(sn,Jt,nr+="",0),or,Rr;if(zr!=nr.length)return null;if("Q"in sn)return new Date(sn.Q);if("s"in sn)return new Date(sn.s*1e3+("L"in sn?sn.L:0));if(Cn&&!("Z"in sn)&&(sn.Z=0),"p"in sn&&(sn.H=sn.H%12+sn.p*12),sn.m===void 0&&(sn.m="q"in sn?sn.q:0),"V"in sn){if(sn.V<1||sn.V>53)return null;"w"in sn||(sn.w=1),"Z"in sn?(or=bD(m1(sn.y,0,1)),Rr=or.getUTCDay(),or=Rr>4||Rr===0?Ij.ceil(or):Ij(or),or=CC.offset(or,(sn.V-1)*7),sn.y=or.getUTCFullYear(),sn.m=or.getUTCMonth(),sn.d=or.getUTCDate()+(sn.w+6)%7):(or=_D(m1(sn.y,0,1)),Rr=or.getDay(),or=Rr>4||Rr===0?kj.ceil(or):kj(or),or=AT.offset(or,(sn.V-1)*7),sn.y=or.getFullYear(),sn.m=or.getMonth(),sn.d=or.getDate()+(sn.w+6)%7)}else("W"in sn||"U"in sn)&&("w"in sn||(sn.w="u"in sn?sn.u%7:"W"in sn?1:0),Rr="Z"in sn?bD(m1(sn.y,0,1)).getUTCDay():_D(m1(sn.y,0,1)).getDay(),sn.m=0,sn.d="W"in sn?(sn.w+6)%7+sn.W*7-(Rr+5)%7:sn.w+sn.U*7-(Rr+6)%7);return"Z"in sn?(sn.H+=sn.Z/100|0,sn.M+=sn.Z%100,bD(sn)):_D(sn)}}function ye(Jt,Cn,nr,sn){for(var zr=0,or=Cn.length,Rr=nr.length,qr,Nn;zr<or;){if(sn>=Rr)return-1;if(qr=Cn.charCodeAt(zr++),qr===37){if(qr=Cn.charAt(zr++),Nn=Z[qr in DH?Cn.charAt(zr++):qr],!Nn||(sn=Nn(Jt,nr,sn))<0)return-1}else if(qr!=nr.charCodeAt(sn++))return-1}return sn}function Ce(Jt,Cn,nr){var sn=T.exec(Cn.slice(nr));return sn?(Jt.p=E.get(sn[0].toLowerCase()),nr+sn[0].length):-1}function Ve(Jt,Cn,nr){var sn=V.exec(Cn.slice(nr));return sn?(Jt.w=$.get(sn[0].toLowerCase()),nr+sn[0].length):-1}function Re(Jt,Cn,nr){var sn=N.exec(Cn.slice(nr));return sn?(Jt.w=D.get(sn[0].toLowerCase()),nr+sn[0].length):-1}function $e(Jt,Cn,nr){var sn=K.exec(Cn.slice(nr));return sn?(Jt.m=Y.get(sn[0].toLowerCase()),nr+sn[0].length):-1}function nt(Jt,Cn,nr){var sn=B.exec(Cn.slice(nr));return sn?(Jt.m=F.get(sn[0].toLowerCase()),nr+sn[0].length):-1}function Me(Jt,Cn,nr){return ye(Jt,t,Cn,nr)}function rt(Jt,Cn,nr){return ye(Jt,n,Cn,nr)}function Ee(Jt,Cn,nr){return ye(Jt,r,Cn,nr)}function it(Jt){return p[Jt.getDay()]}function et(Jt){return f[Jt.getDay()]}function mt(Jt){return w[Jt.getMonth()]}function He(Jt){return s[Jt.getMonth()]}function pt(Jt){return c[+(Jt.getHours()>=12)]}function We(Jt){return 1+~~(Jt.getMonth()/3)}function Je(Jt){return p[Jt.getUTCDay()]}function jt(Jt){return f[Jt.getUTCDay()]}function Pt(Jt){return w[Jt.getUTCMonth()]}function Ot(Jt){return s[Jt.getUTCMonth()]}function Mt(Jt){return c[+(Jt.getUTCHours()>=12)]}function an(Jt){return 1+~~(Jt.getUTCMonth()/3)}return{format:function(Jt){var Cn=se(Jt+="",X);return Cn.toString=function(){return Jt},Cn},parse:function(Jt){var Cn=he(Jt+="",!1);return Cn.toString=function(){return Jt},Cn},utcFormat:function(Jt){var Cn=se(Jt+="",ae);return Cn.toString=function(){return Jt},Cn},utcParse:function(Jt){var Cn=he(Jt+="",!0);return Cn.toString=function(){return Jt},Cn}}}var DH={"-":"",_:" ",0:"0"},uc=/^\s*\d+/,qEe=/^%/,HEe=/[\\^$*+?|[\]().{}]/g;function Ea(e,t,n){var r=e<0?"-":"",c=(r?-e:e)+"",f=c.length;return r+(f<n?new Array(n-f+1).join(t)+c:c)}function GEe(e){return e.replace(HEe,"\\$&")}function g1(e){return new RegExp("^(?:"+e.map(GEe).join("|")+")","i")}function y1(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function WEe(e,t,n){var r=uc.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function XEe(e,t,n){var r=uc.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function ZEe(e,t,n){var r=uc.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function YEe(e,t,n){var r=uc.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function KEe(e,t,n){var r=uc.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function kH(e,t,n){var r=uc.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function IH(e,t,n){var r=uc.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function JEe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function QEe(e,t,n){var r=uc.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function eCe(e,t,n){var r=uc.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function LH(e,t,n){var r=uc.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function tCe(e,t,n){var r=uc.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function zH(e,t,n){var r=uc.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function nCe(e,t,n){var r=uc.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function rCe(e,t,n){var r=uc.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function iCe(e,t,n){var r=uc.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function sCe(e,t,n){var r=uc.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function aCe(e,t,n){var r=qEe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function oCe(e,t,n){var r=uc.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function lCe(e,t,n){var r=uc.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function FH(e,t){return Ea(e.getDate(),t,2)}function cCe(e,t){return Ea(e.getHours(),t,2)}function uCe(e,t){return Ea(e.getHours()%12||12,t,2)}function dCe(e,t){return Ea(1+AT.count(Mg(e),e),t,3)}function LQ(e,t){return Ea(e.getMilliseconds(),t,3)}function hCe(e,t){return LQ(e,t)+"000"}function fCe(e,t){return Ea(e.getMonth()+1,t,2)}function pCe(e,t){return Ea(e.getMinutes(),t,2)}function mCe(e,t){return Ea(e.getSeconds(),t,2)}function gCe(e){var t=e.getDay();return t===0?7:t}function yCe(e,t){return Ea(NC.count(Mg(e)-1,e),t,2)}function zQ(e){var t=e.getDay();return t>=4||t===0?sb(e):sb.ceil(e)}function vCe(e,t){return e=zQ(e),Ea(sb.count(Mg(e),e)+(Mg(e).getDay()===4),t,2)}function xCe(e){return e.getDay()}function _Ce(e,t){return Ea(kj.count(Mg(e)-1,e),t,2)}function bCe(e,t){return Ea(e.getFullYear()%100,t,2)}function wCe(e,t){return e=zQ(e),Ea(e.getFullYear()%100,t,2)}function SCe(e,t){return Ea(e.getFullYear()%1e4,t,4)}function TCe(e,t){var n=e.getDay();return e=n>=4||n===0?sb(e):sb.ceil(e),Ea(e.getFullYear()%1e4,t,4)}function ACe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ea(t/60|0,"0",2)+Ea(t%60,"0",2)}function BH(e,t){return Ea(e.getUTCDate(),t,2)}function jCe(e,t){return Ea(e.getUTCHours(),t,2)}function ECe(e,t){return Ea(e.getUTCHours()%12||12,t,2)}function CCe(e,t){return Ea(1+CC.count(Rg(e),e),t,3)}function FQ(e,t){return Ea(e.getUTCMilliseconds(),t,3)}function NCe(e,t){return FQ(e,t)+"000"}function PCe(e,t){return Ea(e.getUTCMonth()+1,t,2)}function MCe(e,t){return Ea(e.getUTCMinutes(),t,2)}function RCe(e,t){return Ea(e.getUTCSeconds(),t,2)}function OCe(e){var t=e.getUTCDay();return t===0?7:t}function DCe(e,t){return Ea(PC.count(Rg(e)-1,e),t,2)}function BQ(e){var t=e.getUTCDay();return t>=4||t===0?ab(e):ab.ceil(e)}function kCe(e,t){return e=BQ(e),Ea(ab.count(Rg(e),e)+(Rg(e).getUTCDay()===4),t,2)}function ICe(e){return e.getUTCDay()}function LCe(e,t){return Ea(Ij.count(Rg(e)-1,e),t,2)}function zCe(e,t){return Ea(e.getUTCFullYear()%100,t,2)}function FCe(e,t){return e=BQ(e),Ea(e.getUTCFullYear()%100,t,2)}function BCe(e,t){return Ea(e.getUTCFullYear()%1e4,t,4)}function UCe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?ab(e):ab.ceil(e),Ea(e.getUTCFullYear()%1e4,t,4)}function VCe(){return"+0000"}function UH(){return"%"}function VH(e){return+e}function $H(e){return Math.floor(+e/1e3)}var v0,UQ,VQ;$Ce({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function $Ce(e){return v0=$Ee(e),UQ=v0.format,v0.parse,VQ=v0.utcFormat,v0.utcParse,v0}function qCe(e){return new Date(e)}function HCe(e){return e instanceof Date?+e:+new Date(+e)}function sF(e,t,n,r,c,f,p,s,w,T){var E=Hz(),N=E.invert,D=E.domain,V=T(".%L"),$=T(":%S"),B=T("%I:%M"),F=T("%I %p"),K=T("%a %d"),Y=T("%b %d"),X=T("%B"),ae=T("%Y");function Z(se){return(w(se)<se?V:s(se)<se?$:p(se)<se?B:f(se)<se?F:r(se)<se?c(se)<se?K:Y:n(se)<se?X:ae)(se)}return E.invert=function(se){return new Date(N(se))},E.domain=function(se){return arguments.length?D(Array.from(se,HCe)):D().map(qCe)},E.ticks=function(se){var he=D();return e(he[0],he[he.length-1],se??10)},E.tickFormat=function(se,he){return he==null?Z:T(he)},E.nice=function(se){var he=D();return(!se||typeof se.range!="function")&&(se=t(he[0],he[he.length-1],se??10)),se?D(CQ(he,se)):E},E.copy=function(){return TT(E,sF(e,t,n,r,c,f,p,s,w,T))},E}function GCe(){return $h.apply(sF(UEe,VEe,Mg,rF,NC,AT,tF,Qz,Fx,UQ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function WCe(){return $h.apply(sF(FEe,BEe,Rg,iF,PC,CC,nF,eF,Fx,VQ).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function MC(){var e=0,t=1,n,r,c,f,p=Su,s=!1,w;function T(N){return N==null||isNaN(N=+N)?w:p(c===0?.5:(N=(f(N)-n)*c,s?Math.max(0,Math.min(1,N)):N))}T.domain=function(N){return arguments.length?([e,t]=N,n=f(e=+e),r=f(t=+t),c=n===r?0:1/(r-n),T):[e,t]},T.clamp=function(N){return arguments.length?(s=!!N,T):s},T.interpolator=function(N){return arguments.length?(p=N,T):p};function E(N){return function(D){var V,$;return arguments.length?([V,$]=D,p=N(V,$),T):[p(0),p(1)]}}return T.range=E(Hb),T.rangeRound=E(qz),T.unknown=function(N){return arguments.length?(w=N,T):w},function(N){return f=N,n=N(e),r=N(t),c=n===r?0:1/(r-n),T}}function gv(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function $Q(){var e=mv(MC()(Su));return e.copy=function(){return gv(e,$Q())},Ig.apply(e,arguments)}function qQ(){var e=Xz(MC()).domain([1,10]);return e.copy=function(){return gv(e,qQ()).base(e.base())},Ig.apply(e,arguments)}function HQ(){var e=Zz(MC());return e.copy=function(){return gv(e,HQ()).constant(e.constant())},Ig.apply(e,arguments)}function aF(){var e=Yz(MC());return e.copy=function(){return gv(e,aF()).exponent(e.exponent())},Ig.apply(e,arguments)}function XCe(){return aF.apply(null,arguments).exponent(.5)}function GQ(){var e=[],t=Su;function n(r){if(r!=null&&!isNaN(r=+r))return t((wT(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let c of r)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(ev),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,c)=>t(c/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(c,f)=>Dje(e,f/r))},n.copy=function(){return GQ(t).domain(e)},Ig.apply(n,arguments)}function RC(){var e=0,t=.5,n=1,r=1,c,f,p,s,w,T=Su,E,N=!1,D;function V(B){return isNaN(B=+B)?D:(B=.5+((B=+E(B))-f)*(r*B<r*f?s:w),T(N?Math.max(0,Math.min(1,B)):B))}V.domain=function(B){return arguments.length?([e,t,n]=B,c=E(e=+e),f=E(t=+t),p=E(n=+n),s=c===f?0:.5/(f-c),w=f===p?0:.5/(p-f),r=f<c?-1:1,V):[e,t,n]},V.clamp=function(B){return arguments.length?(N=!!B,V):N},V.interpolator=function(B){return arguments.length?(T=B,V):T};function $(B){return function(F){var K,Y,X;return arguments.length?([K,Y,X]=F,T=aEe(B,[K,Y,X]),V):[T(0),T(.5),T(1)]}}return V.range=$(Hb),V.rangeRound=$(qz),V.unknown=function(B){return arguments.length?(D=B,V):D},function(B){return E=B,c=B(e),f=B(t),p=B(n),s=c===f?0:.5/(f-c),w=f===p?0:.5/(p-f),r=f<c?-1:1,V}}function WQ(){var e=mv(RC()(Su));return e.copy=function(){return gv(e,WQ())},Ig.apply(e,arguments)}function XQ(){var e=Xz(RC()).domain([.1,1,10]);return e.copy=function(){return gv(e,XQ()).base(e.base())},Ig.apply(e,arguments)}function ZQ(){var e=Zz(RC());return e.copy=function(){return gv(e,ZQ()).constant(e.constant())},Ig.apply(e,arguments)}function oF(){var e=Yz(RC());return e.copy=function(){return gv(e,oF()).exponent(e.exponent())},Ig.apply(e,arguments)}function ZCe(){return oF.apply(null,arguments).exponent(.5)}const qH=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:gS,scaleDiverging:WQ,scaleDivergingLog:XQ,scaleDivergingPow:oF,scaleDivergingSqrt:ZCe,scaleDivergingSymlog:ZQ,scaleIdentity:EQ,scaleImplicit:II,scaleLinear:Oj,scaleLog:NQ,scaleOrdinal:Uz,scalePoint:$1,scalePow:Kz,scaleQuantile:RQ,scaleQuantize:OQ,scaleRadial:MQ,scaleSequential:$Q,scaleSequentialLog:qQ,scaleSequentialPow:aF,scaleSequentialQuantile:GQ,scaleSequentialSqrt:XCe,scaleSequentialSymlog:HQ,scaleSqrt:NEe,scaleSymlog:PQ,scaleThreshold:DQ,scaleTime:GCe,scaleUtc:WCe,tickFormat:jQ},Symbol.toStringTag,{value:"Module"}));var wD,HH;function OC(){if(HH)return wD;HH=1;var e=Ub();function t(n,r,c){for(var f=-1,p=n.length;++f<p;){var s=n[f],w=r(s);if(w!=null&&(T===void 0?w===w&&!e(w):c(w,T)))var T=w,E=s}return E}return wD=t,wD}var SD,GH;function YQ(){if(GH)return SD;GH=1;function e(t,n){return t>n}return SD=e,SD}var TD,WH;function YCe(){if(WH)return TD;WH=1;var e=OC(),t=YQ(),n=qb();function r(c){return c&&c.length?e(c,n,t):void 0}return TD=r,TD}var KCe=YCe();const Zy=Ca(KCe);var AD,XH;function KQ(){if(XH)return AD;XH=1;function e(t,n){return t<n}return AD=e,AD}var jD,ZH;function JCe(){if(ZH)return jD;ZH=1;var e=OC(),t=KQ(),n=qb();function r(c){return c&&c.length?e(c,n,t):void 0}return jD=r,jD}var QCe=JCe();const DC=Ca(QCe);var ED,YH;function eNe(){if(YH)return ED;YH=1;var e=wz(),t=dm(),n=sQ(),r=rd();function c(f,p){var s=r(f)?e:n;return s(f,t(p,3))}return ED=c,ED}var CD,KH;function tNe(){if(KH)return CD;KH=1;var e=rQ(),t=eNe();function n(r,c){return e(t(r,c),1)}return CD=n,CD}var nNe=tNe();const rNe=Ca(nNe);var ND,JH;function iNe(){if(JH)return ND;JH=1;var e=kz();function t(n,r){return e(n,r)}return ND=t,ND}var sNe=iNe();const r_=Ca(sNe);var Gb=1e9,aNe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},cF,Lo=!0,Uh="[DecimalError] ",Xx=Uh+"Invalid argument: ",lF=Uh+"Exponent out of range: ",Wb=Math.floor,Px=Math.pow,oNe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Gd,lc=1e7,Eo=7,JQ=9007199254740991,Lj=Wb(JQ/Eo),pi={};pi.absoluteValue=pi.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};pi.comparedTo=pi.cmp=function(e){var t,n,r,c,f=this;if(e=new f.constructor(e),f.s!==e.s)return f.s||-e.s;if(f.e!==e.e)return f.e>e.e^f.s<0?1:-1;for(r=f.d.length,c=e.d.length,t=0,n=r<c?r:c;t<n;++t)if(f.d[t]!==e.d[t])return f.d[t]>e.d[t]^f.s<0?1:-1;return r===c?0:r>c^f.s<0?1:-1};pi.decimalPlaces=pi.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*Eo;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};pi.dividedBy=pi.div=function(e){return Sg(this,new this.constructor(e))};pi.dividedToIntegerBy=pi.idiv=function(e){var t=this,n=t.constructor;return lo(Sg(t,new n(e),0,1),n.precision)};pi.equals=pi.eq=function(e){return!this.cmp(e)};pi.exponent=function(){return Rl(this)};pi.greaterThan=pi.gt=function(e){return this.cmp(e)>0};pi.greaterThanOrEqualTo=pi.gte=function(e){return this.cmp(e)>=0};pi.isInteger=pi.isint=function(){return this.e>this.d.length-2};pi.isNegative=pi.isneg=function(){return this.s<0};pi.isPositive=pi.ispos=function(){return this.s>0};pi.isZero=function(){return this.s===0};pi.lessThan=pi.lt=function(e){return this.cmp(e)<0};pi.lessThanOrEqualTo=pi.lte=function(e){return this.cmp(e)<1};pi.logarithm=pi.log=function(e){var t,n=this,r=n.constructor,c=r.precision,f=c+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(Gd))throw Error(Uh+"NaN");if(n.s<1)throw Error(Uh+(n.s?"NaN":"-Infinity"));return n.eq(Gd)?new r(0):(Lo=!1,t=Sg(bS(n,f),bS(e,f),f),Lo=!0,lo(t,c))};pi.minus=pi.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?tee(t,e):QQ(t,(e.s=-e.s,e))};pi.modulo=pi.mod=function(e){var t,n=this,r=n.constructor,c=r.precision;if(e=new r(e),!e.s)throw Error(Uh+"NaN");return n.s?(Lo=!1,t=Sg(n,e,0,1).times(e),Lo=!0,n.minus(t)):lo(new r(n),c)};pi.naturalExponential=pi.exp=function(){return eee(this)};pi.naturalLogarithm=pi.ln=function(){return bS(this)};pi.negated=pi.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};pi.plus=pi.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?QQ(t,e):tee(t,(e.s=-e.s,e))};pi.precision=pi.sd=function(e){var t,n,r,c=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Xx+e);if(t=Rl(c)+1,r=c.d.length-1,n=r*Eo+1,r=c.d[r],r){for(;r%10==0;r/=10)n--;for(r=c.d[0];r>=10;r/=10)n++}return e&&t>n?t:n};pi.squareRoot=pi.sqrt=function(){var e,t,n,r,c,f,p,s=this,w=s.constructor;if(s.s<1){if(!s.s)return new w(0);throw Error(Uh+"NaN")}for(e=Rl(s),Lo=!1,c=Math.sqrt(+s),c==0||c==1/0?(t=Xp(s.d),(t.length+e)%2==0&&(t+="0"),c=Math.sqrt(t),e=Wb((e+1)/2)-(e<0||e%2),c==1/0?t="5e"+e:(t=c.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new w(t)):r=new w(c.toString()),n=w.precision,c=p=n+3;;)if(f=r,r=f.plus(Sg(s,f,p+2)).times(.5),Xp(f.d).slice(0,p)===(t=Xp(r.d)).slice(0,p)){if(t=t.slice(p-3,p+1),c==p&&t=="4999"){if(lo(f,n+1,0),f.times(f).eq(s)){r=f;break}}else if(t!="9999")break;p+=4}return Lo=!0,lo(r,n)};pi.times=pi.mul=function(e){var t,n,r,c,f,p,s,w,T,E=this,N=E.constructor,D=E.d,V=(e=new N(e)).d;if(!E.s||!e.s)return new N(0);for(e.s*=E.s,n=E.e+e.e,w=D.length,T=V.length,w<T&&(f=D,D=V,V=f,p=w,w=T,T=p),f=[],p=w+T,r=p;r--;)f.push(0);for(r=T;--r>=0;){for(t=0,c=w+r;c>r;)s=f[c]+V[r]*D[c-r-1]+t,f[c--]=s%lc|0,t=s/lc|0;f[c]=(f[c]+t)%lc|0}for(;!f[--p];)f.pop();return t?++n:f.shift(),e.d=f,e.e=n,Lo?lo(e,N.precision):e};pi.toDecimalPlaces=pi.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(om(e,0,Gb),t===void 0?t=r.rounding:om(t,0,8),lo(n,e+Rl(n)+1,t))};pi.toExponential=function(e,t){var n,r=this,c=r.constructor;return e===void 0?n=i_(r,!0):(om(e,0,Gb),t===void 0?t=c.rounding:om(t,0,8),r=lo(new c(r),e+1,t),n=i_(r,!0,e+1)),n};pi.toFixed=function(e,t){var n,r,c=this,f=c.constructor;return e===void 0?i_(c):(om(e,0,Gb),t===void 0?t=f.rounding:om(t,0,8),r=lo(new f(c),e+Rl(c)+1,t),n=i_(r.abs(),!1,e+Rl(r)+1),c.isneg()&&!c.isZero()?"-"+n:n)};pi.toInteger=pi.toint=function(){var e=this,t=e.constructor;return lo(new t(e),Rl(e)+1,t.rounding)};pi.toNumber=function(){return+this};pi.toPower=pi.pow=function(e){var t,n,r,c,f,p,s=this,w=s.constructor,T=12,E=+(e=new w(e));if(!e.s)return new w(Gd);if(s=new w(s),!s.s){if(e.s<1)throw Error(Uh+"Infinity");return s}if(s.eq(Gd))return s;if(r=w.precision,e.eq(Gd))return lo(s,r);if(t=e.e,n=e.d.length-1,p=t>=n,f=s.s,p){if((n=E<0?-E:E)<=JQ){for(c=new w(Gd),t=Math.ceil(r/Eo+4),Lo=!1;n%2&&(c=c.times(s),eG(c.d,t)),n=Wb(n/2),n!==0;)s=s.times(s),eG(s.d,t);return Lo=!0,e.s<0?new w(Gd).div(c):lo(c,r)}}else if(f<0)throw Error(Uh+"NaN");return f=f<0&&e.d[Math.max(t,n)]&1?-1:1,s.s=1,Lo=!1,c=e.times(bS(s,r+T)),Lo=!0,c=eee(c),c.s=f,c};pi.toPrecision=function(e,t){var n,r,c=this,f=c.constructor;return e===void 0?(n=Rl(c),r=i_(c,n<=f.toExpNeg||n>=f.toExpPos)):(om(e,1,Gb),t===void 0?t=f.rounding:om(t,0,8),c=lo(new f(c),e,t),n=Rl(c),r=i_(c,e<=n||n<=f.toExpNeg,e)),r};pi.toSignificantDigits=pi.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(om(e,1,Gb),t===void 0?t=r.rounding:om(t,0,8)),lo(new r(n),e,t)};pi.toString=pi.valueOf=pi.val=pi.toJSON=pi[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Rl(e),n=e.constructor;return i_(e,t<=n.toExpNeg||t>=n.toExpPos)};function QQ(e,t){var n,r,c,f,p,s,w,T,E=e.constructor,N=E.precision;if(!e.s||!t.s)return t.s||(t=new E(e)),Lo?lo(t,N):t;if(w=e.d,T=t.d,p=e.e,c=t.e,w=w.slice(),f=p-c,f){for(f<0?(r=w,f=-f,s=T.length):(r=T,c=p,s=w.length),p=Math.ceil(N/Eo),s=p>s?p+1:s+1,f>s&&(f=s,r.length=1),r.reverse();f--;)r.push(0);r.reverse()}for(s=w.length,f=T.length,s-f<0&&(f=s,r=T,T=w,w=r),n=0;f;)n=(w[--f]=w[f]+T[f]+n)/lc|0,w[f]%=lc;for(n&&(w.unshift(n),++c),s=w.length;w[--s]==0;)w.pop();return t.d=w,t.e=c,Lo?lo(t,N):t}function om(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Xx+e)}function Xp(e){var t,n,r,c=e.length-1,f="",p=e[0];if(c>0){for(f+=p,t=1;t<c;t++)r=e[t]+"",n=Eo-r.length,n&&(f+=qy(n)),f+=r;p=e[t],r=p+"",n=Eo-r.length,n&&(f+=qy(n))}else if(p===0)return"0";for(;p%10===0;)p/=10;return f+p}var Sg=(function(){function e(r,c){var f,p=0,s=r.length;for(r=r.slice();s--;)f=r[s]*c+p,r[s]=f%lc|0,p=f/lc|0;return p&&r.unshift(p),r}function t(r,c,f,p){var s,w;if(f!=p)w=f>p?1:-1;else for(s=w=0;s<f;s++)if(r[s]!=c[s]){w=r[s]>c[s]?1:-1;break}return w}function n(r,c,f){for(var p=0;f--;)r[f]-=p,p=r[f]<c[f]?1:0,r[f]=p*lc+r[f]-c[f];for(;!r[0]&&r.length>1;)r.shift()}return function(r,c,f,p){var s,w,T,E,N,D,V,$,B,F,K,Y,X,ae,Z,se,he,ye,Ce=r.constructor,Ve=r.s==c.s?1:-1,Re=r.d,$e=c.d;if(!r.s)return new Ce(r);if(!c.s)throw Error(Uh+"Division by zero");for(w=r.e-c.e,he=$e.length,Z=Re.length,V=new Ce(Ve),$=V.d=[],T=0;$e[T]==(Re[T]||0);)++T;if($e[T]>(Re[T]||0)&&--w,f==null?Y=f=Ce.precision:p?Y=f+(Rl(r)-Rl(c))+1:Y=f,Y<0)return new Ce(0);if(Y=Y/Eo+2|0,T=0,he==1)for(E=0,$e=$e[0],Y++;(T<Z||E)&&Y--;T++)X=E*lc+(Re[T]||0),$[T]=X/$e|0,E=X%$e|0;else{for(E=lc/($e[0]+1)|0,E>1&&($e=e($e,E),Re=e(Re,E),he=$e.length,Z=Re.length),ae=he,B=Re.slice(0,he),F=B.length;F<he;)B[F++]=0;ye=$e.slice(),ye.unshift(0),se=$e[0],$e[1]>=lc/2&&++se;do E=0,s=t($e,B,he,F),s<0?(K=B[0],he!=F&&(K=K*lc+(B[1]||0)),E=K/se|0,E>1?(E>=lc&&(E=lc-1),N=e($e,E),D=N.length,F=B.length,s=t(N,B,D,F),s==1&&(E--,n(N,he<D?ye:$e,D))):(E==0&&(s=E=1),N=$e.slice()),D=N.length,D<F&&N.unshift(0),n(B,N,F),s==-1&&(F=B.length,s=t($e,B,he,F),s<1&&(E++,n(B,he<F?ye:$e,F))),F=B.length):s===0&&(E++,B=[0]),$[T++]=E,s&&B[0]?B[F++]=Re[ae]||0:(B=[Re[ae]],F=1);while((ae++<Z||B[0]!==void 0)&&Y--)}return $[0]||$.shift(),V.e=w,lo(V,p?f+Rl(V)+1:f)}})();function eee(e,t){var n,r,c,f,p,s,w=0,T=0,E=e.constructor,N=E.precision;if(Rl(e)>16)throw Error(lF+Rl(e));if(!e.s)return new E(Gd);for(Lo=!1,s=N,p=new E(.03125);e.abs().gte(.1);)e=e.times(p),T+=5;for(r=Math.log(Px(2,T))/Math.LN10*2+5|0,s+=r,n=c=f=new E(Gd),E.precision=s;;){if(c=lo(c.times(e),s),n=n.times(++w),p=f.plus(Sg(c,n,s)),Xp(p.d).slice(0,s)===Xp(f.d).slice(0,s)){for(;T--;)f=lo(f.times(f),s);return E.precision=N,t==null?(Lo=!0,lo(f,N)):f}f=p}}function Rl(e){for(var t=e.e*Eo,n=e.d[0];n>=10;n/=10)t++;return t}function PD(e,t,n){if(t>e.LN10.sd())throw Lo=!0,n&&(e.precision=n),Error(Uh+"LN10 precision limit exceeded");return lo(new e(e.LN10),t)}function qy(e){for(var t="";e--;)t+="0";return t}function bS(e,t){var n,r,c,f,p,s,w,T,E,N=1,D=10,V=e,$=V.d,B=V.constructor,F=B.precision;if(V.s<1)throw Error(Uh+(V.s?"NaN":"-Infinity"));if(V.eq(Gd))return new B(0);if(t==null?(Lo=!1,T=F):T=t,V.eq(10))return t==null&&(Lo=!0),PD(B,T);if(T+=D,B.precision=T,n=Xp($),r=n.charAt(0),f=Rl(V),Math.abs(f)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)V=V.times(e),n=Xp(V.d),r=n.charAt(0),N++;f=Rl(V),r>1?(V=new B("0."+n),f++):V=new B(r+"."+n.slice(1))}else return w=PD(B,T+2,F).times(f+""),V=bS(new B(r+"."+n.slice(1)),T-D).plus(w),B.precision=F,t==null?(Lo=!0,lo(V,F)):V;for(s=p=V=Sg(V.minus(Gd),V.plus(Gd),T),E=lo(V.times(V),T),c=3;;){if(p=lo(p.times(E),T),w=s.plus(Sg(p,new B(c),T)),Xp(w.d).slice(0,T)===Xp(s.d).slice(0,T))return s=s.times(2),f!==0&&(s=s.plus(PD(B,T+2,F).times(f+""))),s=Sg(s,new B(N),T),B.precision=F,t==null?(Lo=!0,lo(s,F)):s;s=w,c+=2}}function QH(e,t){var n,r,c;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(c=t.length;t.charCodeAt(c-1)===48;)--c;if(t=t.slice(r,c),t){if(c-=r,n=n-r-1,e.e=Wb(n/Eo),e.d=[],r=(n+1)%Eo,n<0&&(r+=Eo),r<c){for(r&&e.d.push(+t.slice(0,r)),c-=Eo;r<c;)e.d.push(+t.slice(r,r+=Eo));t=t.slice(r),r=Eo-t.length}else r-=c;for(;r--;)t+="0";if(e.d.push(+t),Lo&&(e.e>Lj||e.e<-Lj))throw Error(lF+n)}else e.s=0,e.e=0,e.d=[0];return e}function lo(e,t,n){var r,c,f,p,s,w,T,E,N=e.d;for(p=1,f=N[0];f>=10;f/=10)p++;if(r=t-p,r<0)r+=Eo,c=t,T=N[E=0];else{if(E=Math.ceil((r+1)/Eo),f=N.length,E>=f)return e;for(T=f=N[E],p=1;f>=10;f/=10)p++;r%=Eo,c=r-Eo+p}if(n!==void 0&&(f=Px(10,p-c-1),s=T/f%10|0,w=t<0||N[E+1]!==void 0||T%f,w=n<4?(s||w)&&(n==0||n==(e.s<0?3:2)):s>5||s==5&&(n==4||w||n==6&&(r>0?c>0?T/Px(10,p-c):0:N[E-1])%10&1||n==(e.s<0?8:7))),t<1||!N[0])return w?(f=Rl(e),N.length=1,t=t-f-1,N[0]=Px(10,(Eo-t%Eo)%Eo),e.e=Wb(-t/Eo)||0):(N.length=1,N[0]=e.e=e.s=0),e;if(r==0?(N.length=E,f=1,E--):(N.length=E+1,f=Px(10,Eo-r),N[E]=c>0?(T/Px(10,p-c)%Px(10,c)|0)*f:0),w)for(;;)if(E==0){(N[0]+=f)==lc&&(N[0]=1,++e.e);break}else{if(N[E]+=f,N[E]!=lc)break;N[E--]=0,f=1}for(r=N.length;N[--r]===0;)N.pop();if(Lo&&(e.e>Lj||e.e<-Lj))throw Error(lF+Rl(e));return e}function tee(e,t){var n,r,c,f,p,s,w,T,E,N,D=e.constructor,V=D.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new D(e),Lo?lo(t,V):t;if(w=e.d,N=t.d,r=t.e,T=e.e,w=w.slice(),p=T-r,p){for(E=p<0,E?(n=w,p=-p,s=N.length):(n=N,r=T,s=w.length),c=Math.max(Math.ceil(V/Eo),s)+2,p>c&&(p=c,n.length=1),n.reverse(),c=p;c--;)n.push(0);n.reverse()}else{for(c=w.length,s=N.length,E=c<s,E&&(s=c),c=0;c<s;c++)if(w[c]!=N[c]){E=w[c]<N[c];break}p=0}for(E&&(n=w,w=N,N=n,t.s=-t.s),s=w.length,c=N.length-s;c>0;--c)w[s++]=0;for(c=N.length;c>p;){if(w[--c]<N[c]){for(f=c;f&&w[--f]===0;)w[f]=lc-1;--w[f],w[c]+=lc}w[c]-=N[c]}for(;w[--s]===0;)w.pop();for(;w[0]===0;w.shift())--r;return w[0]?(t.d=w,t.e=r,Lo?lo(t,V):t):new D(0)}function i_(e,t,n){var r,c=Rl(e),f=Xp(e.d),p=f.length;return t?(n&&(r=n-p)>0?f=f.charAt(0)+"."+f.slice(1)+qy(r):p>1&&(f=f.charAt(0)+"."+f.slice(1)),f=f+(c<0?"e":"e+")+c):c<0?(f="0."+qy(-c-1)+f,n&&(r=n-p)>0&&(f+=qy(r))):c>=p?(f+=qy(c+1-p),n&&(r=n-c-1)>0&&(f=f+"."+qy(r))):((r=c+1)<p&&(f=f.slice(0,r)+"."+f.slice(r)),n&&(r=n-p)>0&&(c+1===p&&(f+="."),f+=qy(r))),e.s<0?"-"+f:f}function eG(e,t){if(e.length>t)return e.length=t,!0}function nee(e){var t,n,r;function c(f){var p=this;if(!(p instanceof c))return new c(f);if(p.constructor=c,f instanceof c){p.s=f.s,p.e=f.e,p.d=(f=f.d)?f.slice():f;return}if(typeof f=="number"){if(f*0!==0)throw Error(Xx+f);if(f>0)p.s=1;else if(f<0)f=-f,p.s=-1;else{p.s=0,p.e=0,p.d=[0];return}if(f===~~f&&f<1e7){p.e=0,p.d=[f];return}return QH(p,f.toString())}else if(typeof f!="string")throw Error(Xx+f);if(f.charCodeAt(0)===45?(f=f.slice(1),p.s=-1):p.s=1,oNe.test(f))QH(p,f);else throw Error(Xx+f)}if(c.prototype=pi,c.ROUND_UP=0,c.ROUND_DOWN=1,c.ROUND_CEIL=2,c.ROUND_FLOOR=3,c.ROUND_HALF_UP=4,c.ROUND_HALF_DOWN=5,c.ROUND_HALF_EVEN=6,c.ROUND_HALF_CEIL=7,c.ROUND_HALF_FLOOR=8,c.clone=nee,c.config=c.set=lNe,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return c.config(e),c}function lNe(e){if(!e||typeof e!="object")throw Error(Uh+"Object expected");var t,n,r,c=["precision",1,Gb,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<c.length;t+=3)if((r=e[n=c[t]])!==void 0)if(Wb(r)===r&&r>=c[t+1]&&r<=c[t+2])this[n]=r;else throw Error(Xx+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Xx+n+": "+r);return this}var cF=nee(aNe);Gd=new cF(1);const Ja=cF;function cNe(e){return fNe(e)||hNe(e)||dNe(e)||uNe()}function uNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dNe(e,t){if(e){if(typeof e=="string")return BI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return BI(e,t)}}function hNe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function fNe(e){if(Array.isArray(e))return BI(e)}function BI(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var pNe=function(t){return t},ree={},iee=function(t){return t===ree},tG=function(t){return function n(){return arguments.length===0||arguments.length===1&&iee(arguments.length<=0?void 0:arguments[0])?n:t.apply(void 0,arguments)}},mNe=function e(t,n){return t===1?n:tG(function(){for(var r=arguments.length,c=new Array(r),f=0;f<r;f++)c[f]=arguments[f];var p=c.filter(function(s){return s!==ree}).length;return p>=t?n.apply(void 0,c):e(t-p,tG(function(){for(var s=arguments.length,w=new Array(s),T=0;T<s;T++)w[T]=arguments[T];var E=c.map(function(N){return iee(N)?w.shift():N});return n.apply(void 0,cNe(E).concat(w))}))})},kC=function(t){return mNe(t.length,t)},UI=function(t,n){for(var r=[],c=t;c<n;++c)r[c-t]=c;return r},gNe=kC(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),yNe=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(!n.length)return pNe;var c=n.reverse(),f=c[0],p=c.slice(1);return function(){return p.reduce(function(s,w){return w(s)},f.apply(void 0,arguments))}},VI=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},see=function(t){var n=null,r=null;return function(){for(var c=arguments.length,f=new Array(c),p=0;p<c;p++)f[p]=arguments[p];return n&&f.every(function(s,w){return s===n[w]})||(n=f,r=t.apply(void 0,f)),r}};function vNe(e){var t;return e===0?t=1:t=Math.floor(new Ja(e).abs().log(10).toNumber())+1,t}function xNe(e,t,n){for(var r=new Ja(e),c=0,f=[];r.lt(t)&&c<1e5;)f.push(r.toNumber()),r=r.add(n),c++;return f}var _Ne=kC(function(e,t,n){var r=+e,c=+t;return r+n*(c-r)}),bNe=kC(function(e,t,n){var r=t-+e;return r=r||1/0,(n-e)/r}),wNe=kC(function(e,t,n){var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});const IC={rangeStep:xNe,getDigitCount:vNe,interpolateNumber:_Ne,uninterpolateNumber:bNe,uninterpolateTruncation:wNe};function $I(e){return ANe(e)||TNe(e)||aee(e)||SNe()}function SNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TNe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function ANe(e){if(Array.isArray(e))return qI(e)}function wS(e,t){return CNe(e)||ENe(e,t)||aee(e,t)||jNe()}function jNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aee(e,t){if(e){if(typeof e=="string")return qI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qI(e,t)}}function qI(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ENe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,c=!1,f=void 0;try{for(var p=e[Symbol.iterator](),s;!(r=(s=p.next()).done)&&(n.push(s.value),!(t&&n.length===t));r=!0);}catch(w){c=!0,f=w}finally{try{!r&&p.return!=null&&p.return()}finally{if(c)throw f}}return n}}function CNe(e){if(Array.isArray(e))return e}function oee(e){var t=wS(e,2),n=t[0],r=t[1],c=n,f=r;return n>r&&(c=r,f=n),[c,f]}function lee(e,t,n){if(e.lte(0))return new Ja(0);var r=IC.getDigitCount(e.toNumber()),c=new Ja(10).pow(r),f=e.div(c),p=r!==1?.05:.1,s=new Ja(Math.ceil(f.div(p).toNumber())).add(n).mul(p),w=s.mul(c);return t?w:new Ja(Math.ceil(w))}function NNe(e,t,n){var r=1,c=new Ja(e);if(!c.isint()&&n){var f=Math.abs(e);f<1?(r=new Ja(10).pow(IC.getDigitCount(e)-1),c=new Ja(Math.floor(c.div(r).toNumber())).mul(r)):f>1&&(c=new Ja(Math.floor(e)))}else e===0?c=new Ja(Math.floor((t-1)/2)):n||(c=new Ja(Math.floor(e)));var p=Math.floor((t-1)/2),s=yNe(gNe(function(w){return c.add(new Ja(w-p).mul(r)).toNumber()}),UI);return s(0,t)}function cee(e,t,n,r){var c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new Ja(0),tickMin:new Ja(0),tickMax:new Ja(0)};var f=lee(new Ja(t).sub(e).div(n-1),r,c),p;e<=0&&t>=0?p=new Ja(0):(p=new Ja(e).add(t).div(2),p=p.sub(new Ja(p).mod(f)));var s=Math.ceil(p.sub(e).div(f).toNumber()),w=Math.ceil(new Ja(t).sub(p).div(f).toNumber()),T=s+w+1;return T>n?cee(e,t,n,r,c+1):(T<n&&(w=t>0?w+(n-T):w,s=t>0?s:s+(n-T)),{step:f,tickMin:p.sub(new Ja(s).mul(f)),tickMax:p.add(new Ja(w).mul(f))})}function PNe(e){var t=wS(e,2),n=t[0],r=t[1],c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,p=Math.max(c,2),s=oee([n,r]),w=wS(s,2),T=w[0],E=w[1];if(T===-1/0||E===1/0){var N=E===1/0?[T].concat($I(UI(0,c-1).map(function(){return 1/0}))):[].concat($I(UI(0,c-1).map(function(){return-1/0})),[E]);return n>r?VI(N):N}if(T===E)return NNe(T,c,f);var D=cee(T,E,p,f),V=D.step,$=D.tickMin,B=D.tickMax,F=IC.rangeStep($,B.add(new Ja(.1).mul(V)),V);return n>r?VI(F):F}function MNe(e,t){var n=wS(e,2),r=n[0],c=n[1],f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,p=oee([r,c]),s=wS(p,2),w=s[0],T=s[1];if(w===-1/0||T===1/0)return[r,c];if(w===T)return[w];var E=Math.max(t,2),N=lee(new Ja(T).sub(w).div(E-1),f,0),D=[].concat($I(IC.rangeStep(new Ja(w),new Ja(T).sub(new Ja(.99).mul(N)),N)),[T]);return r>c?VI(D):D}var RNe=see(PNe),ONe=see(MNe),DNe="Invariant failed";function s_(e,t){throw new Error(DNe)}var kNe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function ob(e){"@babel/helpers - typeof";return ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ob(e)}function zj(){return zj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zj.apply(this,arguments)}function INe(e,t){return BNe(e)||FNe(e,t)||zNe(e,t)||LNe()}function LNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zNe(e,t){if(e){if(typeof e=="string")return nG(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nG(e,t)}}function nG(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function FNe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,c,f,p,s=[],w=!0,T=!1;try{if(f=(n=n.call(e)).next,t!==0)for(;!(w=(r=f.call(n)).done)&&(s.push(r.value),s.length!==t);w=!0);}catch(E){T=!0,c=E}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return s}}function BNe(e){if(Array.isArray(e))return e}function UNe(e,t){if(e==null)return{};var n=VNe(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function VNe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function $Ne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qNe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,hee(r.key),r)}}function HNe(e,t,n){return t&&qNe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function GNe(e,t,n){return t=Fj(t),WNe(e,uee()?Reflect.construct(t,n||[],Fj(e).constructor):t.apply(e,n))}function WNe(e,t){if(t&&(ob(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XNe(e)}function XNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uee=function(){return!!e})()}function Fj(e){return Fj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Fj(e)}function ZNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HI(e,t)}function HI(e,t){return HI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},HI(e,t)}function dee(e,t,n){return t=hee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hee(e){var t=YNe(e,"string");return ob(t)=="symbol"?t:t+""}function YNe(e,t){if(ob(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(ob(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var jT=(function(e){function t(){return $Ne(this,t),GNe(this,t,arguments)}return ZNe(t,e),HNe(t,[{key:"render",value:function(){var r=this.props,c=r.offset,f=r.layout,p=r.width,s=r.dataKey,w=r.data,T=r.dataPointFormatter,E=r.xAxis,N=r.yAxis,D=UNe(r,kNe),V=Oi(D,!1);this.props.direction==="x"&&E.type!=="number"&&s_();var $=w.map(function(B){var F=T(B,s),K=F.x,Y=F.y,X=F.value,ae=F.errorVal;if(!ae)return null;var Z=[],se,he;if(Array.isArray(ae)){var ye=INe(ae,2);se=ye[0],he=ye[1]}else se=he=ae;if(f==="vertical"){var Ce=E.scale,Ve=Y+c,Re=Ve+p,$e=Ve-p,nt=Ce(X-se),Me=Ce(X+he);Z.push({x1:Me,y1:Re,x2:Me,y2:$e}),Z.push({x1:nt,y1:Ve,x2:Me,y2:Ve}),Z.push({x1:nt,y1:Re,x2:nt,y2:$e})}else if(f==="horizontal"){var rt=N.scale,Ee=K+c,it=Ee-p,et=Ee+p,mt=rt(X-se),He=rt(X+he);Z.push({x1:it,y1:He,x2:et,y2:He}),Z.push({x1:Ee,y1:mt,x2:Ee,y2:He}),Z.push({x1:it,y1:mt,x2:et,y2:mt})}return _e.createElement(sa,zj({className:"recharts-errorBar",key:"bar-".concat(Z.map(function(pt){return"".concat(pt.x1,"-").concat(pt.x2,"-").concat(pt.y1,"-").concat(pt.y2)}))},V),Z.map(function(pt){return _e.createElement("line",zj({},pt,{key:"line-".concat(pt.x1,"-").concat(pt.x2,"-").concat(pt.y1,"-").concat(pt.y2)}))}))});return _e.createElement(sa,{className:"recharts-errorBars"},$)}}])})(_e.Component);dee(jT,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});dee(jT,"displayName","ErrorBar");function SS(e){"@babel/helpers - typeof";return SS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},SS(e)}function rG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function Ax(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?rG(Object(n),!0).forEach(function(r){KNe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function KNe(e,t,n){return t=JNe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JNe(e){var t=QNe(e,"string");return SS(t)=="symbol"?t:t+""}function QNe(e,t){if(SS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(SS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fee=function(t){var n=t.children,r=t.formattedGraphicalItems,c=t.legendWidth,f=t.legendContent,p=Vd(n,Qy);if(!p)return null;var s=Qy.defaultProps,w=s!==void 0?Ax(Ax({},s),p.props):{},T;return p.props&&p.props.payload?T=p.props&&p.props.payload:f==="children"?T=(r||[]).reduce(function(E,N){var D=N.item,V=N.props,$=V.sectors||V.data||[];return E.concat($.map(function(B){return{type:p.props.iconType||D.props.legendType,value:B.name,color:B.fill,payload:B}}))},[]):T=(r||[]).map(function(E){var N=E.item,D=N.type.defaultProps,V=D!==void 0?Ax(Ax({},D),N.props):{},$=V.dataKey,B=V.name,F=V.legendType,K=V.hide;return{inactive:K,dataKey:$,type:w.iconType||F||"square",color:uF(N),value:B||$,payload:V}}),Ax(Ax(Ax({},w),Qy.getWithHeight(p,c)),{},{payload:T,item:p})};function TS(e){"@babel/helpers - typeof";return TS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TS(e)}function iG(e){return rPe(e)||nPe(e)||tPe(e)||ePe()}function ePe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tPe(e,t){if(e){if(typeof e=="string")return GI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return GI(e,t)}}function nPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rPe(e){if(Array.isArray(e))return GI(e)}function GI(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function sG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function tl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sG(Object(n),!0).forEach(function(r){q0(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function q0(e,t,n){return t=iPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iPe(e){var t=sPe(e,"string");return TS(t)=="symbol"?t:t+""}function sPe(e,t){if(TS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(TS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fl(e,t,n){return xs(e)||xs(t)?n:Zl(t)?Zd(e,t,n):as(t)?t(e):n}function q1(e,t,n,r){var c=rNe(e,function(s){return fl(s,t)});if(n==="number"){var f=c.filter(function(s){return jr(s)||parseFloat(s)});return f.length?[DC(f),Zy(f)]:[1/0,-1/0]}var p=r?c.filter(function(s){return!xs(s)}):c;return p.map(function(s){return Zl(s)||s instanceof Date?s:""})}var aPe=function(t){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],c=arguments.length>2?arguments[2]:void 0,f=arguments.length>3?arguments[3]:void 0,p=-1,s=(n=r?.length)!==null&&n!==void 0?n:0;if(s<=1)return 0;if(f&&f.axisType==="angleAxis"&&Math.abs(Math.abs(f.range[1]-f.range[0])-360)<=1e-6)for(var w=f.range,T=0;T<s;T++){var E=T>0?c[T-1].coordinate:c[s-1].coordinate,N=c[T].coordinate,D=T>=s-1?c[0].coordinate:c[T+1].coordinate,V=void 0;if(bu(N-E)!==bu(D-N)){var $=[];if(bu(D-N)===bu(w[1]-w[0])){V=D;var B=N+w[1]-w[0];$[0]=Math.min(B,(B+E)/2),$[1]=Math.max(B,(B+E)/2)}else{V=E;var F=D+w[1]-w[0];$[0]=Math.min(N,(F+N)/2),$[1]=Math.max(N,(F+N)/2)}var K=[Math.min(N,(V+N)/2),Math.max(N,(V+N)/2)];if(t>K[0]&&t<=K[1]||t>=$[0]&&t<=$[1]){p=c[T].index;break}}else{var Y=Math.min(E,D),X=Math.max(E,D);if(t>(Y+N)/2&&t<=(X+N)/2){p=c[T].index;break}}}else for(var ae=0;ae<s;ae++)if(ae===0&&t<=(r[ae].coordinate+r[ae+1].coordinate)/2||ae>0&&ae<s-1&&t>(r[ae].coordinate+r[ae-1].coordinate)/2&&t<=(r[ae].coordinate+r[ae+1].coordinate)/2||ae===s-1&&t>(r[ae].coordinate+r[ae-1].coordinate)/2){p=r[ae].index;break}return p},uF=function(t){var n,r=t,c=r.type.displayName,f=(n=t.type)!==null&&n!==void 0&&n.defaultProps?tl(tl({},t.type.defaultProps),t.props):t.props,p=f.stroke,s=f.fill,w;switch(c){case"Line":w=p;break;case"Area":case"Radar":w=p&&p!=="none"?p:s;break;default:w=s;break}return w},oPe=function(t){var n=t.barSize,r=t.totalSize,c=t.stackGroups,f=c===void 0?{}:c;if(!f)return{};for(var p={},s=Object.keys(f),w=0,T=s.length;w<T;w++)for(var E=f[s[w]].stackGroups,N=Object.keys(E),D=0,V=N.length;D<V;D++){var $=E[N[D]],B=$.items,F=$.cateAxisId,K=B.filter(function(he){return wg(he.type).indexOf("Bar")>=0});if(K&&K.length){var Y=K[0].type.defaultProps,X=Y!==void 0?tl(tl({},Y),K[0].props):K[0].props,ae=X.barSize,Z=X[F];p[Z]||(p[Z]=[]);var se=xs(ae)?n:ae;p[Z].push({item:K[0],stackList:K.slice(1),barSize:xs(se)?void 0:wu(se,r,0)})}}return p},lPe=function(t){var n=t.barGap,r=t.barCategoryGap,c=t.bandSize,f=t.sizeList,p=f===void 0?[]:f,s=t.maxBarSize,w=p.length;if(w<1)return null;var T=wu(n,c,0,!0),E,N=[];if(p[0].barSize===+p[0].barSize){var D=!1,V=c/w,$=p.reduce(function(ae,Z){return ae+Z.barSize||0},0);$+=(w-1)*T,$>=c&&($-=(w-1)*T,T=0),$>=c&&V>0&&(D=!0,V*=.9,$=w*V);var B=(c-$)/2>>0,F={offset:B-T,size:0};E=p.reduce(function(ae,Z){var se={item:Z.item,position:{offset:F.offset+F.size+T,size:D?V:Z.barSize}},he=[].concat(iG(ae),[se]);return F=he[he.length-1].position,Z.stackList&&Z.stackList.length&&Z.stackList.forEach(function(ye){he.push({item:ye,position:F})}),he},N)}else{var K=wu(r,c,0,!0);c-2*K-(w-1)*T<=0&&(T=0);var Y=(c-2*K-(w-1)*T)/w;Y>1&&(Y>>=0);var X=s===+s?Math.min(Y,s):Y;E=p.reduce(function(ae,Z,se){var he=[].concat(iG(ae),[{item:Z.item,position:{offset:K+(Y+T)*se+(Y-X)/2,size:X}}]);return Z.stackList&&Z.stackList.length&&Z.stackList.forEach(function(ye){he.push({item:ye,position:he[he.length-1].position})}),he},N)}return E},cPe=function(t,n,r,c){var f=r.children,p=r.width,s=r.margin,w=p-(s.left||0)-(s.right||0),T=fee({children:f,legendWidth:w});if(T){var E=c||{},N=E.width,D=E.height,V=T.align,$=T.verticalAlign,B=T.layout;if((B==="vertical"||B==="horizontal"&&$==="middle")&&V!=="center"&&jr(t[V]))return tl(tl({},t),{},q0({},V,t[V]+(N||0)));if((B==="horizontal"||B==="vertical"&&V==="center")&&$!=="middle"&&jr(t[$]))return tl(tl({},t),{},q0({},$,t[$]+(D||0)))}return t},uPe=function(t,n,r){return xs(n)?!0:t==="horizontal"?n==="yAxis":t==="vertical"||r==="x"?n==="xAxis":r==="y"?n==="yAxis":!0},pee=function(t,n,r,c,f){var p=n.props.children,s=Yd(p,jT).filter(function(T){return uPe(c,f,T.props.direction)});if(s&&s.length){var w=s.map(function(T){return T.props.dataKey});return t.reduce(function(T,E){var N=fl(E,r);if(xs(N))return T;var D=Array.isArray(N)?[DC(N),Zy(N)]:[N,N],V=w.reduce(function($,B){var F=fl(E,B,0),K=D[0]-Math.abs(Array.isArray(F)?F[0]:F),Y=D[1]+Math.abs(Array.isArray(F)?F[1]:F);return[Math.min(K,$[0]),Math.max(Y,$[1])]},[1/0,-1/0]);return[Math.min(V[0],T[0]),Math.max(V[1],T[1])]},[1/0,-1/0])}return null},dPe=function(t,n,r,c,f){var p=n.map(function(s){return pee(t,s,r,f,c)}).filter(function(s){return!xs(s)});return p&&p.length?p.reduce(function(s,w){return[Math.min(s[0],w[0]),Math.max(s[1],w[1])]},[1/0,-1/0]):null},mee=function(t,n,r,c,f){var p=n.map(function(w){var T=w.props.dataKey;return r==="number"&&T&&pee(t,w,T,c)||q1(t,T,r,f)});if(r==="number")return p.reduce(function(w,T){return[Math.min(w[0],T[0]),Math.max(w[1],T[1])]},[1/0,-1/0]);var s={};return p.reduce(function(w,T){for(var E=0,N=T.length;E<N;E++)s[T[E]]||(s[T[E]]=!0,w.push(T[E]));return w},[])},gee=function(t,n){return t==="horizontal"&&n==="xAxis"||t==="vertical"&&n==="yAxis"||t==="centric"&&n==="angleAxis"||t==="radial"&&n==="radiusAxis"},yee=function(t,n,r,c){if(c)return t.map(function(w){return w.coordinate});var f,p,s=t.map(function(w){return w.coordinate===n&&(f=!0),w.coordinate===r&&(p=!0),w.coordinate});return f||s.push(n),p||s.push(r),s},yg=function(t,n,r){if(!t)return null;var c=t.scale,f=t.duplicateDomain,p=t.type,s=t.range,w=t.realScaleType==="scaleBand"?c.bandwidth()/2:2,T=(n||r)&&p==="category"&&c.bandwidth?c.bandwidth()/w:0;if(T=t.axisType==="angleAxis"&&s?.length>=2?bu(s[0]-s[1])*2*T:T,n&&(t.ticks||t.niceTicks)){var E=(t.ticks||t.niceTicks).map(function(N){var D=f?f.indexOf(N):N;return{coordinate:c(D)+T,value:N,offset:T}});return E.filter(function(N){return!$b(N.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(N,D){return{coordinate:c(N)+T,value:N,index:D,offset:T}}):c.ticks&&!r?c.ticks(t.tickCount).map(function(N){return{coordinate:c(N)+T,value:N,offset:T}}):c.domain().map(function(N,D){return{coordinate:c(N)+T,value:f?f[N]:N,index:D,offset:T}})},MD=new WeakMap,mA=function(t,n){if(typeof n!="function")return t;MD.has(t)||MD.set(t,new WeakMap);var r=MD.get(t);if(r.has(n))return r.get(n);var c=function(){t.apply(void 0,arguments),n.apply(void 0,arguments)};return r.set(n,c),c},vee=function(t,n,r){var c=t.scale,f=t.type,p=t.layout,s=t.axisType;if(c==="auto")return p==="radial"&&s==="radiusAxis"?{scale:gS(),realScaleType:"band"}:p==="radial"&&s==="angleAxis"?{scale:Oj(),realScaleType:"linear"}:f==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?{scale:$1(),realScaleType:"point"}:f==="category"?{scale:gS(),realScaleType:"band"}:{scale:Oj(),realScaleType:"linear"};if(e_(c)){var w="scale".concat(xC(c));return{scale:(qH[w]||$1)(),realScaleType:qH[w]?w:"point"}}return as(c)?{scale:c}:{scale:$1(),realScaleType:"point"}},aG=1e-4,xee=function(t){var n=t.domain();if(!(!n||n.length<=2)){var r=n.length,c=t.range(),f=Math.min(c[0],c[1])-aG,p=Math.max(c[0],c[1])+aG,s=t(n[0]),w=t(n[r-1]);(s<f||s>p||w<f||w>p)&&t.domain([n[0],n[r-1]])}},hPe=function(t,n){if(!t)return null;for(var r=0,c=t.length;r<c;r++)if(t[r].item===n)return t[r].position;return null},fPe=function(t,n){if(!n||n.length!==2||!jr(n[0])||!jr(n[1]))return t;var r=Math.min(n[0],n[1]),c=Math.max(n[0],n[1]),f=[t[0],t[1]];return(!jr(t[0])||t[0]<r)&&(f[0]=r),(!jr(t[1])||t[1]>c)&&(f[1]=c),f[0]>c&&(f[0]=c),f[1]<r&&(f[1]=r),f},pPe=function(t){var n=t.length;if(!(n<=0))for(var r=0,c=t[0].length;r<c;++r)for(var f=0,p=0,s=0;s<n;++s){var w=$b(t[s][r][1])?t[s][r][0]:t[s][r][1];w>=0?(t[s][r][0]=f,t[s][r][1]=f+w,f=t[s][r][1]):(t[s][r][0]=p,t[s][r][1]=p+w,p=t[s][r][1])}},mPe=function(t){var n=t.length;if(!(n<=0))for(var r=0,c=t[0].length;r<c;++r)for(var f=0,p=0;p<n;++p){var s=$b(t[p][r][1])?t[p][r][0]:t[p][r][1];s>=0?(t[p][r][0]=f,t[p][r][1]=f+s,f=t[p][r][1]):(t[p][r][0]=0,t[p][r][1]=0)}},gPe={sign:pPe,expand:rTe,none:Q0,silhouette:iTe,wiggle:sTe,positive:mPe},yPe=function(t,n,r){var c=n.map(function(s){return s.props.dataKey}),f=gPe[r],p=nTe().keys(c).value(function(s,w){return+fl(s,w,0)}).order(wI).offset(f);return p(t)},vPe=function(t,n,r,c,f,p){if(!t)return null;var s=p?n.reverse():n,w={},T=s.reduce(function(N,D){var V,$=(V=D.type)!==null&&V!==void 0&&V.defaultProps?tl(tl({},D.type.defaultProps),D.props):D.props,B=$.stackId,F=$.hide;if(F)return N;var K=$[r],Y=N[K]||{hasStack:!1,stackGroups:{}};if(Zl(B)){var X=Y.stackGroups[B]||{numericAxisId:r,cateAxisId:c,items:[]};X.items.push(D),Y.hasStack=!0,Y.stackGroups[B]=X}else Y.stackGroups[m_("_stackId_")]={numericAxisId:r,cateAxisId:c,items:[D]};return tl(tl({},N),{},q0({},K,Y))},w),E={};return Object.keys(T).reduce(function(N,D){var V=T[D];if(V.hasStack){var $={};V.stackGroups=Object.keys(V.stackGroups).reduce(function(B,F){var K=V.stackGroups[F];return tl(tl({},B),{},q0({},F,{numericAxisId:r,cateAxisId:c,items:K.items,stackedData:yPe(t,K.items,f)}))},$)}return tl(tl({},N),{},q0({},D,V))},E)},_ee=function(t,n){var r=n.realScaleType,c=n.type,f=n.tickCount,p=n.originalDomain,s=n.allowDecimals,w=r||n.scale;if(w!=="auto"&&w!=="linear")return null;if(f&&c==="number"&&p&&(p[0]==="auto"||p[1]==="auto")){var T=t.domain();if(!T.length)return null;var E=RNe(T,f,s);return t.domain([DC(E),Zy(E)]),{niceTicks:E}}if(f&&c==="number"){var N=t.domain(),D=ONe(N,f,s);return{niceTicks:D}}return null};function Bj(e){var t=e.axis,n=e.ticks,r=e.bandSize,c=e.entry,f=e.index,p=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!xs(c[t.dataKey])){var s=mj(n,"value",c[t.dataKey]);if(s)return s.coordinate+r/2}return n[f]?n[f].coordinate+r/2:null}var w=fl(c,xs(p)?t.dataKey:p);return xs(w)?null:t.scale(w)}var oG=function(t){var n=t.axis,r=t.ticks,c=t.offset,f=t.bandSize,p=t.entry,s=t.index;if(n.type==="category")return r[s]?r[s].coordinate+c:null;var w=fl(p,n.dataKey,n.domain[s]);return xs(w)?null:n.scale(w)-f/2+c},xPe=function(t){var n=t.numericAxis,r=n.scale.domain();if(n.type==="number"){var c=Math.min(r[0],r[1]),f=Math.max(r[0],r[1]);return c<=0&&f>=0?0:f<0?f:c}return r[0]},_Pe=function(t,n){var r,c=(r=t.type)!==null&&r!==void 0&&r.defaultProps?tl(tl({},t.type.defaultProps),t.props):t.props,f=c.stackId;if(Zl(f)){var p=n[f];if(p){var s=p.items.indexOf(t);return s>=0?p.stackedData[s]:null}}return null},bPe=function(t){return t.reduce(function(n,r){return[DC(r.concat([n[0]]).filter(jr)),Zy(r.concat([n[1]]).filter(jr))]},[1/0,-1/0])},bee=function(t,n,r){return Object.keys(t).reduce(function(c,f){var p=t[f],s=p.stackedData,w=s.reduce(function(T,E){var N=bPe(E.slice(n,r+1));return[Math.min(T[0],N[0]),Math.max(T[1],N[1])]},[1/0,-1/0]);return[Math.min(w[0],c[0]),Math.max(w[1],c[1])]},[1/0,-1/0]).map(function(c){return c===1/0||c===-1/0?0:c})},lG=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,cG=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,WI=function(t,n,r){if(as(t))return t(n,r);if(!Array.isArray(t))return n;var c=[];if(jr(t[0]))c[0]=r?t[0]:Math.min(t[0],n[0]);else if(lG.test(t[0])){var f=+lG.exec(t[0])[1];c[0]=n[0]-f}else as(t[0])?c[0]=t[0](n[0]):c[0]=n[0];if(jr(t[1]))c[1]=r?t[1]:Math.max(t[1],n[1]);else if(cG.test(t[1])){var p=+cG.exec(t[1])[1];c[1]=n[1]+p}else as(t[1])?c[1]=t[1](n[1]):c[1]=n[1];return c},Uj=function(t,n,r){if(t&&t.scale&&t.scale.bandwidth){var c=t.scale.bandwidth();if(!r||c>0)return c}if(t&&n&&n.length>=2){for(var f=Lz(n,function(N){return N.coordinate}),p=1/0,s=1,w=f.length;s<w;s++){var T=f[s],E=f[s-1];p=Math.min((T.coordinate||0)-(E.coordinate||0),p)}return p===1/0?0:p}return r?void 0:0},uG=function(t,n,r){return!t||!t.length||r_(t,Zd(r,"type.defaultProps.domain"))?n:t},wee=function(t,n){var r=t.type.defaultProps?tl(tl({},t.type.defaultProps),t.props):t.props,c=r.dataKey,f=r.name,p=r.unit,s=r.formatter,w=r.tooltipType,T=r.chartType,E=r.hide;return tl(tl({},Oi(t,!1)),{},{dataKey:c,unit:p,formatter:s,name:f||c,color:uF(t),value:fl(n,c),type:w,payload:n,chartType:T,hide:E})};function AS(e){"@babel/helpers - typeof";return AS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AS(e)}function dG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function fg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?dG(Object(n),!0).forEach(function(r){See(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function See(e,t,n){return t=wPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wPe(e){var t=SPe(e,"string");return AS(t)=="symbol"?t:t+""}function SPe(e,t){if(AS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(AS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TPe(e,t){return CPe(e)||EPe(e,t)||jPe(e,t)||APe()}function APe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jPe(e,t){if(e){if(typeof e=="string")return hG(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hG(e,t)}}function hG(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function EPe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,c,f,p,s=[],w=!0,T=!1;try{if(f=(n=n.call(e)).next,t!==0)for(;!(w=(r=f.call(n)).done)&&(s.push(r.value),s.length!==t);w=!0);}catch(E){T=!0,c=E}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return s}}function CPe(e){if(Array.isArray(e))return e}var Vj=Math.PI/180,NPe=function(t){return t*180/Math.PI},bo=function(t,n,r,c){return{x:t+Math.cos(-Vj*c)*r,y:n+Math.sin(-Vj*c)*r}},Tee=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(r.left||0)-(r.right||0)),Math.abs(n-(r.top||0)-(r.bottom||0)))/2},PPe=function(t,n,r,c,f){var p=t.width,s=t.height,w=t.startAngle,T=t.endAngle,E=wu(t.cx,p,p/2),N=wu(t.cy,s,s/2),D=Tee(p,s,r),V=wu(t.innerRadius,D,0),$=wu(t.outerRadius,D,D*.8),B=Object.keys(n);return B.reduce(function(F,K){var Y=n[K],X=Y.domain,ae=Y.reversed,Z;if(xs(Y.range))c==="angleAxis"?Z=[w,T]:c==="radiusAxis"&&(Z=[V,$]),ae&&(Z=[Z[1],Z[0]]);else{Z=Y.range;var se=Z,he=TPe(se,2);w=he[0],T=he[1]}var ye=vee(Y,f),Ce=ye.realScaleType,Ve=ye.scale;Ve.domain(X).range(Z),xee(Ve);var Re=_ee(Ve,fg(fg({},Y),{},{realScaleType:Ce})),$e=fg(fg(fg({},Y),Re),{},{range:Z,radius:$,realScaleType:Ce,scale:Ve,cx:E,cy:N,innerRadius:V,outerRadius:$,startAngle:w,endAngle:T});return fg(fg({},F),{},See({},K,$e))},{})},MPe=function(t,n){var r=t.x,c=t.y,f=n.x,p=n.y;return Math.sqrt(Math.pow(r-f,2)+Math.pow(c-p,2))},RPe=function(t,n){var r=t.x,c=t.y,f=n.cx,p=n.cy,s=MPe({x:r,y:c},{x:f,y:p});if(s<=0)return{radius:s};var w=(r-f)/s,T=Math.acos(w);return c>p&&(T=2*Math.PI-T),{radius:s,angle:NPe(T),angleInRadian:T}},OPe=function(t){var n=t.startAngle,r=t.endAngle,c=Math.floor(n/360),f=Math.floor(r/360),p=Math.min(c,f);return{startAngle:n-p*360,endAngle:r-p*360}},DPe=function(t,n){var r=n.startAngle,c=n.endAngle,f=Math.floor(r/360),p=Math.floor(c/360),s=Math.min(f,p);return t+s*360},fG=function(t,n){var r=t.x,c=t.y,f=RPe({x:r,y:c},n),p=f.radius,s=f.angle,w=n.innerRadius,T=n.outerRadius;if(p<w||p>T)return!1;if(p===0)return!0;var E=OPe(n),N=E.startAngle,D=E.endAngle,V=s,$;if(N<=D){for(;V>D;)V-=360;for(;V<N;)V+=360;$=V>=N&&V<=D}else{for(;V>N;)V-=360;for(;V<D;)V+=360;$=V>=D&&V<=N}return $?fg(fg({},n),{},{radius:p,angle:DPe(V,n)}):null},Aee=function(t){return!z.isValidElement(t)&&!as(t)&&typeof t!="boolean"?t.className:""};function jS(e){"@babel/helpers - typeof";return jS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jS(e)}var kPe=["offset"];function IPe(e){return BPe(e)||FPe(e)||zPe(e)||LPe()}function LPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zPe(e,t){if(e){if(typeof e=="string")return XI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return XI(e,t)}}function FPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function BPe(e){if(Array.isArray(e))return XI(e)}function XI(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function UPe(e,t){if(e==null)return{};var n=VPe(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function VPe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function pG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function Wl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pG(Object(n),!0).forEach(function(r){$Pe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function $Pe(e,t,n){return t=qPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qPe(e){var t=HPe(e,"string");return jS(t)=="symbol"?t:t+""}function HPe(e,t){if(jS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(jS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ES(){return ES=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ES.apply(this,arguments)}var GPe=function(t){var n=t.value,r=t.formatter,c=xs(t.children)?n:t.children;return as(r)?r(c):c},WPe=function(t,n){var r=bu(n-t),c=Math.min(Math.abs(n-t),360);return r*c},XPe=function(t,n,r){var c=t.position,f=t.viewBox,p=t.offset,s=t.className,w=f,T=w.cx,E=w.cy,N=w.innerRadius,D=w.outerRadius,V=w.startAngle,$=w.endAngle,B=w.clockWise,F=(N+D)/2,K=WPe(V,$),Y=K>=0?1:-1,X,ae;c==="insideStart"?(X=V+Y*p,ae=B):c==="insideEnd"?(X=$-Y*p,ae=!B):c==="end"&&(X=$+Y*p,ae=B),ae=K<=0?ae:!ae;var Z=bo(T,E,F,X),se=bo(T,E,F,X+(ae?1:-1)*359),he="M".concat(Z.x,",").concat(Z.y,`
    A`).concat(F,",").concat(F,",0,1,").concat(ae?0:1,`,
    `).concat(se.x,",").concat(se.y),ye=xs(t.id)?m_("recharts-radial-line-"):t.id;return _e.createElement("text",ES({},r,{dominantBaseline:"central",className:es("recharts-radial-bar-label",s)}),_e.createElement("defs",null,_e.createElement("path",{id:ye,d:he})),_e.createElement("textPath",{xlinkHref:"#".concat(ye)},n))},ZPe=function(t){var n=t.viewBox,r=t.offset,c=t.position,f=n,p=f.cx,s=f.cy,w=f.innerRadius,T=f.outerRadius,E=f.startAngle,N=f.endAngle,D=(E+N)/2;if(c==="outside"){var V=bo(p,s,T+r,D),$=V.x,B=V.y;return{x:$,y:B,textAnchor:$>=p?"start":"end",verticalAnchor:"middle"}}if(c==="center")return{x:p,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(c==="centerTop")return{x:p,y:s,textAnchor:"middle",verticalAnchor:"start"};if(c==="centerBottom")return{x:p,y:s,textAnchor:"middle",verticalAnchor:"end"};var F=(w+T)/2,K=bo(p,s,F,D),Y=K.x,X=K.y;return{x:Y,y:X,textAnchor:"middle",verticalAnchor:"middle"}},YPe=function(t){var n=t.viewBox,r=t.parentViewBox,c=t.offset,f=t.position,p=n,s=p.x,w=p.y,T=p.width,E=p.height,N=E>=0?1:-1,D=N*c,V=N>0?"end":"start",$=N>0?"start":"end",B=T>=0?1:-1,F=B*c,K=B>0?"end":"start",Y=B>0?"start":"end";if(f==="top"){var X={x:s+T/2,y:w-N*c,textAnchor:"middle",verticalAnchor:V};return Wl(Wl({},X),r?{height:Math.max(w-r.y,0),width:T}:{})}if(f==="bottom"){var ae={x:s+T/2,y:w+E+D,textAnchor:"middle",verticalAnchor:$};return Wl(Wl({},ae),r?{height:Math.max(r.y+r.height-(w+E),0),width:T}:{})}if(f==="left"){var Z={x:s-F,y:w+E/2,textAnchor:K,verticalAnchor:"middle"};return Wl(Wl({},Z),r?{width:Math.max(Z.x-r.x,0),height:E}:{})}if(f==="right"){var se={x:s+T+F,y:w+E/2,textAnchor:Y,verticalAnchor:"middle"};return Wl(Wl({},se),r?{width:Math.max(r.x+r.width-se.x,0),height:E}:{})}var he=r?{width:T,height:E}:{};return f==="insideLeft"?Wl({x:s+F,y:w+E/2,textAnchor:Y,verticalAnchor:"middle"},he):f==="insideRight"?Wl({x:s+T-F,y:w+E/2,textAnchor:K,verticalAnchor:"middle"},he):f==="insideTop"?Wl({x:s+T/2,y:w+D,textAnchor:"middle",verticalAnchor:$},he):f==="insideBottom"?Wl({x:s+T/2,y:w+E-D,textAnchor:"middle",verticalAnchor:V},he):f==="insideTopLeft"?Wl({x:s+F,y:w+D,textAnchor:Y,verticalAnchor:$},he):f==="insideTopRight"?Wl({x:s+T-F,y:w+D,textAnchor:K,verticalAnchor:$},he):f==="insideBottomLeft"?Wl({x:s+F,y:w+E-D,textAnchor:Y,verticalAnchor:V},he):f==="insideBottomRight"?Wl({x:s+T-F,y:w+E-D,textAnchor:K,verticalAnchor:V},he):Vb(f)&&(jr(f.x)||Lx(f.x))&&(jr(f.y)||Lx(f.y))?Wl({x:s+wu(f.x,T),y:w+wu(f.y,E),textAnchor:"end",verticalAnchor:"end"},he):Wl({x:s+T/2,y:w+E/2,textAnchor:"middle",verticalAnchor:"middle"},he)},KPe=function(t){return"cx"in t&&jr(t.cx)};function cc(e){var t=e.offset,n=t===void 0?5:t,r=UPe(e,kPe),c=Wl({offset:n},r),f=c.viewBox,p=c.position,s=c.value,w=c.children,T=c.content,E=c.className,N=E===void 0?"":E,D=c.textBreakAll;if(!f||xs(s)&&xs(w)&&!z.isValidElement(T)&&!as(T))return null;if(z.isValidElement(T))return z.cloneElement(T,c);var V;if(as(T)){if(V=z.createElement(T,c),z.isValidElement(V))return V}else V=GPe(c);var $=KPe(f),B=Oi(c,!0);if($&&(p==="insideStart"||p==="insideEnd"||p==="end"))return XPe(c,V,B);var F=$?ZPe(c):YPe(c);return _e.createElement(n_,ES({className:es("recharts-label",N)},B,F,{breakAll:D}),V)}cc.displayName="Label";var jee=function(t){var n=t.cx,r=t.cy,c=t.angle,f=t.startAngle,p=t.endAngle,s=t.r,w=t.radius,T=t.innerRadius,E=t.outerRadius,N=t.x,D=t.y,V=t.top,$=t.left,B=t.width,F=t.height,K=t.clockWise,Y=t.labelViewBox;if(Y)return Y;if(jr(B)&&jr(F)){if(jr(N)&&jr(D))return{x:N,y:D,width:B,height:F};if(jr(V)&&jr($))return{x:V,y:$,width:B,height:F}}return jr(N)&&jr(D)?{x:N,y:D,width:0,height:0}:jr(n)&&jr(r)?{cx:n,cy:r,startAngle:f||c||0,endAngle:p||c||0,innerRadius:T||0,outerRadius:E||w||s||0,clockWise:K}:t.viewBox?t.viewBox:{}},JPe=function(t,n){return t?t===!0?_e.createElement(cc,{key:"label-implicit",viewBox:n}):Zl(t)?_e.createElement(cc,{key:"label-implicit",viewBox:n,value:t}):z.isValidElement(t)?t.type===cc?z.cloneElement(t,{key:"label-implicit",viewBox:n}):_e.createElement(cc,{key:"label-implicit",content:t,viewBox:n}):as(t)?_e.createElement(cc,{key:"label-implicit",content:t,viewBox:n}):Vb(t)?_e.createElement(cc,ES({viewBox:n},t,{key:"label-implicit"})):null:null},QPe=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var c=t.children,f=jee(t),p=Yd(c,cc).map(function(w,T){return z.cloneElement(w,{viewBox:n||f,key:"label-".concat(T)})});if(!r)return p;var s=JPe(t.label,n||f);return[s].concat(IPe(p))};cc.parseViewBox=jee;cc.renderCallByParent=QPe;var RD,mG;function eMe(){if(mG)return RD;mG=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return RD=e,RD}var tMe=eMe();const nMe=Ca(tMe);function CS(e){"@babel/helpers - typeof";return CS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},CS(e)}var rMe=["valueAccessor"],iMe=["data","dataKey","clockWise","id","textBreakAll"];function sMe(e){return cMe(e)||lMe(e)||oMe(e)||aMe()}function aMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oMe(e,t){if(e){if(typeof e=="string")return ZI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ZI(e,t)}}function lMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cMe(e){if(Array.isArray(e))return ZI(e)}function ZI(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $j(){return $j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$j.apply(this,arguments)}function gG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function yG(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gG(Object(n),!0).forEach(function(r){uMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function uMe(e,t,n){return t=dMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dMe(e){var t=hMe(e,"string");return CS(t)=="symbol"?t:t+""}function hMe(e,t){if(CS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(CS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vG(e,t){if(e==null)return{};var n=fMe(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function fMe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var pMe=function(t){return Array.isArray(t.value)?nMe(t.value):t.value};function rm(e){var t=e.valueAccessor,n=t===void 0?pMe:t,r=vG(e,rMe),c=r.data,f=r.dataKey,p=r.clockWise,s=r.id,w=r.textBreakAll,T=vG(r,iMe);return!c||!c.length?null:_e.createElement(sa,{className:"recharts-label-list"},c.map(function(E,N){var D=xs(f)?n(E,N):fl(E&&E.payload,f),V=xs(s)?{}:{id:"".concat(s,"-").concat(N)};return _e.createElement(cc,$j({},Oi(E,!0),T,V,{parentViewBox:E.parentViewBox,value:D,textBreakAll:w,viewBox:cc.parseViewBox(xs(p)?E:yG(yG({},E),{},{clockWise:p})),key:"label-".concat(N),index:N}))}))}rm.displayName="LabelList";function mMe(e,t){return e?e===!0?_e.createElement(rm,{key:"labelList-implicit",data:t}):_e.isValidElement(e)||as(e)?_e.createElement(rm,{key:"labelList-implicit",data:t,content:e}):Vb(e)?_e.createElement(rm,$j({data:t},e,{key:"labelList-implicit"})):null:null}function gMe(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,c=Yd(r,rm).map(function(p,s){return z.cloneElement(p,{data:t,key:"labelList-".concat(s)})});if(!n)return c;var f=mMe(e.label,t);return[f].concat(sMe(c))}rm.renderCallByParent=gMe;function NS(e){"@babel/helpers - typeof";return NS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NS(e)}function YI(){return YI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},YI.apply(this,arguments)}function xG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function _G(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xG(Object(n),!0).forEach(function(r){yMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function yMe(e,t,n){return t=vMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vMe(e){var t=xMe(e,"string");return NS(t)=="symbol"?t:t+""}function xMe(e,t){if(NS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(NS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _Me=function(t,n){var r=bu(n-t),c=Math.min(Math.abs(n-t),359.999);return r*c},gA=function(t){var n=t.cx,r=t.cy,c=t.radius,f=t.angle,p=t.sign,s=t.isExternal,w=t.cornerRadius,T=t.cornerIsExternal,E=w*(s?1:-1)+c,N=Math.asin(w/E)/Vj,D=T?f:f+p*N,V=bo(n,r,E,D),$=bo(n,r,c,D),B=T?f-p*N:f,F=bo(n,r,E*Math.cos(N*Vj),B);return{center:V,circleTangency:$,lineTangency:F,theta:N}},Eee=function(t){var n=t.cx,r=t.cy,c=t.innerRadius,f=t.outerRadius,p=t.startAngle,s=t.endAngle,w=_Me(p,s),T=p+w,E=bo(n,r,f,p),N=bo(n,r,f,T),D="M ".concat(E.x,",").concat(E.y,`
    A `).concat(f,",").concat(f,`,0,
    `).concat(+(Math.abs(w)>180),",").concat(+(p>T),`,
    `).concat(N.x,",").concat(N.y,`
  `);if(c>0){var V=bo(n,r,c,p),$=bo(n,r,c,T);D+="L ".concat($.x,",").concat($.y,`
            A `).concat(c,",").concat(c,`,0,
            `).concat(+(Math.abs(w)>180),",").concat(+(p<=T),`,
            `).concat(V.x,",").concat(V.y," Z")}else D+="L ".concat(n,",").concat(r," Z");return D},bMe=function(t){var n=t.cx,r=t.cy,c=t.innerRadius,f=t.outerRadius,p=t.cornerRadius,s=t.forceCornerRadius,w=t.cornerIsExternal,T=t.startAngle,E=t.endAngle,N=bu(E-T),D=gA({cx:n,cy:r,radius:f,angle:T,sign:N,cornerRadius:p,cornerIsExternal:w}),V=D.circleTangency,$=D.lineTangency,B=D.theta,F=gA({cx:n,cy:r,radius:f,angle:E,sign:-N,cornerRadius:p,cornerIsExternal:w}),K=F.circleTangency,Y=F.lineTangency,X=F.theta,ae=w?Math.abs(T-E):Math.abs(T-E)-B-X;if(ae<0)return s?"M ".concat($.x,",").concat($.y,`
        a`).concat(p,",").concat(p,",0,0,1,").concat(p*2,`,0
        a`).concat(p,",").concat(p,",0,0,1,").concat(-p*2,`,0
      `):Eee({cx:n,cy:r,innerRadius:c,outerRadius:f,startAngle:T,endAngle:E});var Z="M ".concat($.x,",").concat($.y,`
    A`).concat(p,",").concat(p,",0,0,").concat(+(N<0),",").concat(V.x,",").concat(V.y,`
    A`).concat(f,",").concat(f,",0,").concat(+(ae>180),",").concat(+(N<0),",").concat(K.x,",").concat(K.y,`
    A`).concat(p,",").concat(p,",0,0,").concat(+(N<0),",").concat(Y.x,",").concat(Y.y,`
  `);if(c>0){var se=gA({cx:n,cy:r,radius:c,angle:T,sign:N,isExternal:!0,cornerRadius:p,cornerIsExternal:w}),he=se.circleTangency,ye=se.lineTangency,Ce=se.theta,Ve=gA({cx:n,cy:r,radius:c,angle:E,sign:-N,isExternal:!0,cornerRadius:p,cornerIsExternal:w}),Re=Ve.circleTangency,$e=Ve.lineTangency,nt=Ve.theta,Me=w?Math.abs(T-E):Math.abs(T-E)-Ce-nt;if(Me<0&&p===0)return"".concat(Z,"L").concat(n,",").concat(r,"Z");Z+="L".concat($e.x,",").concat($e.y,`
      A`).concat(p,",").concat(p,",0,0,").concat(+(N<0),",").concat(Re.x,",").concat(Re.y,`
      A`).concat(c,",").concat(c,",0,").concat(+(Me>180),",").concat(+(N>0),",").concat(he.x,",").concat(he.y,`
      A`).concat(p,",").concat(p,",0,0,").concat(+(N<0),",").concat(ye.x,",").concat(ye.y,"Z")}else Z+="L".concat(n,",").concat(r,"Z");return Z},wMe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Cee=function(t){var n=_G(_G({},wMe),t),r=n.cx,c=n.cy,f=n.innerRadius,p=n.outerRadius,s=n.cornerRadius,w=n.forceCornerRadius,T=n.cornerIsExternal,E=n.startAngle,N=n.endAngle,D=n.className;if(p<f||E===N)return null;var V=es("recharts-sector",D),$=p-f,B=wu(s,$,0,!0),F;return B>0&&Math.abs(E-N)<360?F=bMe({cx:r,cy:c,innerRadius:f,outerRadius:p,cornerRadius:Math.min(B,$/2),forceCornerRadius:w,cornerIsExternal:T,startAngle:E,endAngle:N}):F=Eee({cx:r,cy:c,innerRadius:f,outerRadius:p,startAngle:E,endAngle:N}),_e.createElement("path",YI({},Oi(n,!0),{className:V,d:F,role:"img"}))};function PS(e){"@babel/helpers - typeof";return PS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},PS(e)}function KI(){return KI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},KI.apply(this,arguments)}function bG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function wG(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bG(Object(n),!0).forEach(function(r){SMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function SMe(e,t,n){return t=TMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function TMe(e){var t=AMe(e,"string");return PS(t)=="symbol"?t:t+""}function AMe(e,t){if(PS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(PS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SG={curveBasisClosed:HSe,curveBasisOpen:GSe,curveBasis:qSe,curveBumpX:PSe,curveBumpY:MSe,curveLinearClosed:WSe,curveLinear:bC,curveMonotoneX:XSe,curveMonotoneY:ZSe,curveNatural:YSe,curveStep:KSe,curveStepAfter:QSe,curveStepBefore:JSe},yA=function(t){return t.x===+t.x&&t.y===+t.y},v1=function(t){return t.x},x1=function(t){return t.y},jMe=function(t,n){if(as(t))return t;var r="curve".concat(xC(t));return(r==="curveMonotone"||r==="curveBump")&&n?SG["".concat(r).concat(n==="vertical"?"Y":"X")]:SG[r]||bC},EMe=function(t){var n=t.type,r=n===void 0?"linear":n,c=t.points,f=c===void 0?[]:c,p=t.baseLine,s=t.layout,w=t.connectNulls,T=w===void 0?!1:w,E=jMe(r,s),N=T?f.filter(function(B){return yA(B)}):f,D;if(Array.isArray(p)){var V=T?p.filter(function(B){return yA(B)}):p,$=N.map(function(B,F){return wG(wG({},B),{},{base:V[F]})});return s==="vertical"?D=lA().y(x1).x1(v1).x0(function(B){return B.base.x}):D=lA().x(v1).y1(x1).y0(function(B){return B.base.y}),D.defined(yA).curve(E),D($)}return s==="vertical"&&jr(p)?D=lA().y(x1).x1(v1).x0(p):jr(p)?D=lA().x(v1).y1(x1).y0(p):D=jJ().x(v1).y(x1),D.defined(yA).curve(E),D(N)},Zx=function(t){var n=t.className,r=t.points,c=t.path,f=t.pathRef;if((!r||!r.length)&&!c)return null;var p=r&&r.length?EMe(t):c;return z.createElement("path",KI({},Oi(t,!1),gj(t),{className:es("recharts-curve",n),d:p,ref:f}))},OD={exports:{}},DD,TG;function CMe(){if(TG)return DD;TG=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return DD=e,DD}var kD,AG;function NMe(){if(AG)return kD;AG=1;var e=CMe();function t(){}function n(){}return n.resetWarningCache=t,kD=function(){function r(p,s,w,T,E,N){if(N!==e){var D=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw D.name="Invariant Violation",D}}r.isRequired=r;function c(){return r}var f={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:c,element:r,elementType:r,instanceOf:c,node:r,objectOf:c,oneOf:c,oneOfType:c,shape:c,exact:c,checkPropTypes:n,resetWarningCache:t};return f.PropTypes=f,f},kD}var jG;function PMe(){return jG||(jG=1,OD.exports=NMe()()),OD.exports}var MMe=PMe();const Ba=Ca(MMe);var RMe=Object.getOwnPropertyNames,OMe=Object.getOwnPropertySymbols,DMe=Object.prototype.hasOwnProperty;function EG(e,t){return function(r,c,f){return e(r,c,f)&&t(r,c,f)}}function vA(e){return function(n,r,c){if(!n||!r||typeof n!="object"||typeof r!="object")return e(n,r,c);var f=c.cache,p=f.get(n),s=f.get(r);if(p&&s)return p===r&&s===n;f.set(n,r),f.set(r,n);var w=e(n,r,c);return f.delete(n),f.delete(r),w}}function CG(e){return RMe(e).concat(OMe(e))}var kMe=Object.hasOwn||(function(e,t){return DMe.call(e,t)});function v_(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var IMe="__v",LMe="__o",zMe="_owner",NG=Object.getOwnPropertyDescriptor,PG=Object.keys;function FMe(e,t,n){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function BMe(e,t){return v_(e.getTime(),t.getTime())}function UMe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function VMe(e,t){return e===t}function MG(e,t,n){var r=e.size;if(r!==t.size)return!1;if(!r)return!0;for(var c=new Array(r),f=e.entries(),p,s,w=0;(p=f.next())&&!p.done;){for(var T=t.entries(),E=!1,N=0;(s=T.next())&&!s.done;){if(c[N]){N++;continue}var D=p.value,V=s.value;if(n.equals(D[0],V[0],w,N,e,t,n)&&n.equals(D[1],V[1],D[0],V[0],e,t,n)){E=c[N]=!0;break}N++}if(!E)return!1;w++}return!0}var $Me=v_;function qMe(e,t,n){var r=PG(e),c=r.length;if(PG(t).length!==c)return!1;for(;c-- >0;)if(!Nee(e,t,n,r[c]))return!1;return!0}function _1(e,t,n){var r=CG(e),c=r.length;if(CG(t).length!==c)return!1;for(var f,p,s;c-- >0;)if(f=r[c],!Nee(e,t,n,f)||(p=NG(e,f),s=NG(t,f),(p||s)&&(!p||!s||p.configurable!==s.configurable||p.enumerable!==s.enumerable||p.writable!==s.writable)))return!1;return!0}function HMe(e,t){return v_(e.valueOf(),t.valueOf())}function GMe(e,t){return e.source===t.source&&e.flags===t.flags}function RG(e,t,n){var r=e.size;if(r!==t.size)return!1;if(!r)return!0;for(var c=new Array(r),f=e.values(),p,s;(p=f.next())&&!p.done;){for(var w=t.values(),T=!1,E=0;(s=w.next())&&!s.done;){if(!c[E]&&n.equals(p.value,s.value,p.value,s.value,e,t,n)){T=c[E]=!0;break}E++}if(!T)return!1}return!0}function WMe(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}function XMe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function Nee(e,t,n,r){return(r===zMe||r===LMe||r===IMe)&&(e.$$typeof||t.$$typeof)?!0:kMe(t,r)&&n.equals(e[r],t[r],r,r,e,t,n)}var ZMe="[object Arguments]",YMe="[object Boolean]",KMe="[object Date]",JMe="[object Error]",QMe="[object Map]",eRe="[object Number]",tRe="[object Object]",nRe="[object RegExp]",rRe="[object Set]",iRe="[object String]",sRe="[object URL]",aRe=Array.isArray,OG=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,DG=Object.assign,oRe=Object.prototype.toString.call.bind(Object.prototype.toString);function lRe(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areErrorsEqual,c=e.areFunctionsEqual,f=e.areMapsEqual,p=e.areNumbersEqual,s=e.areObjectsEqual,w=e.arePrimitiveWrappersEqual,T=e.areRegExpsEqual,E=e.areSetsEqual,N=e.areTypedArraysEqual,D=e.areUrlsEqual;return function($,B,F){if($===B)return!0;if($==null||B==null)return!1;var K=typeof $;if(K!==typeof B)return!1;if(K!=="object")return K==="number"?p($,B,F):K==="function"?c($,B,F):!1;var Y=$.constructor;if(Y!==B.constructor)return!1;if(Y===Object)return s($,B,F);if(aRe($))return t($,B,F);if(OG!=null&&OG($))return N($,B,F);if(Y===Date)return n($,B,F);if(Y===RegExp)return T($,B,F);if(Y===Map)return f($,B,F);if(Y===Set)return E($,B,F);var X=oRe($);return X===KMe?n($,B,F):X===nRe?T($,B,F):X===QMe?f($,B,F):X===rRe?E($,B,F):X===tRe?typeof $.then!="function"&&typeof B.then!="function"&&s($,B,F):X===sRe?D($,B,F):X===JMe?r($,B,F):X===ZMe?s($,B,F):X===YMe||X===eRe||X===iRe?w($,B,F):!1}}function cRe(e){var t=e.circular,n=e.createCustomConfig,r=e.strict,c={areArraysEqual:r?_1:FMe,areDatesEqual:BMe,areErrorsEqual:UMe,areFunctionsEqual:VMe,areMapsEqual:r?EG(MG,_1):MG,areNumbersEqual:$Me,areObjectsEqual:r?_1:qMe,arePrimitiveWrappersEqual:HMe,areRegExpsEqual:GMe,areSetsEqual:r?EG(RG,_1):RG,areTypedArraysEqual:r?_1:WMe,areUrlsEqual:XMe};if(n&&(c=DG({},c,n(c))),t){var f=vA(c.areArraysEqual),p=vA(c.areMapsEqual),s=vA(c.areObjectsEqual),w=vA(c.areSetsEqual);c=DG({},c,{areArraysEqual:f,areMapsEqual:p,areObjectsEqual:s,areSetsEqual:w})}return c}function uRe(e){return function(t,n,r,c,f,p,s){return e(t,n,s)}}function dRe(e){var t=e.circular,n=e.comparator,r=e.createState,c=e.equals,f=e.strict;if(r)return function(w,T){var E=r(),N=E.cache,D=N===void 0?t?new WeakMap:void 0:N,V=E.meta;return n(w,T,{cache:D,equals:c,meta:V,strict:f})};if(t)return function(w,T){return n(w,T,{cache:new WeakMap,equals:c,meta:void 0,strict:f})};var p={cache:void 0,equals:c,meta:void 0,strict:f};return function(w,T){return n(w,T,p)}}var hRe=yv();yv({strict:!0});yv({circular:!0});yv({circular:!0,strict:!0});yv({createInternalComparator:function(){return v_}});yv({strict:!0,createInternalComparator:function(){return v_}});yv({circular:!0,createInternalComparator:function(){return v_}});yv({circular:!0,createInternalComparator:function(){return v_},strict:!0});function yv(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,r=e.createInternalComparator,c=e.createState,f=e.strict,p=f===void 0?!1:f,s=cRe(e),w=lRe(s),T=r?r(w):uRe(w);return dRe({circular:n,comparator:w,createState:c,equals:T,strict:p})}function fRe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function kG(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function c(f){n<0&&(n=f),f-n>t?(e(f),n=-1):fRe(c)};requestAnimationFrame(r)}function JI(e){"@babel/helpers - typeof";return JI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},JI(e)}function pRe(e){return vRe(e)||yRe(e)||gRe(e)||mRe()}function mRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gRe(e,t){if(e){if(typeof e=="string")return IG(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return IG(e,t)}}function IG(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vRe(e){if(Array.isArray(e))return e}function xRe(){var e={},t=function(){return null},n=!1,r=function c(f){if(!n){if(Array.isArray(f)){if(!f.length)return;var p=f,s=pRe(p),w=s[0],T=s.slice(1);if(typeof w=="number"){kG(c.bind(null,T),w);return}c(w),kG(c.bind(null,T));return}JI(f)==="object"&&(e=f,t(e)),typeof f=="function"&&f()}};return{stop:function(){n=!0},start:function(f){n=!1,r(f)},subscribe:function(f){return t=f,function(){t=function(){return null}}}}}function MS(e){"@babel/helpers - typeof";return MS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},MS(e)}function LG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function zG(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?LG(Object(n),!0).forEach(function(r){Pee(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):LG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Pee(e,t,n){return t=_Re(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _Re(e){var t=bRe(e,"string");return MS(t)==="symbol"?t:String(t)}function bRe(e,t){if(MS(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(MS(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wRe=function(t,n){return[Object.keys(t),Object.keys(n)].reduce(function(r,c){return r.filter(function(f){return c.includes(f)})})},SRe=function(t){return t},TRe=function(t){return t.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},H1=function(t,n){return Object.keys(n).reduce(function(r,c){return zG(zG({},r),{},Pee({},c,t(c,n[c])))},{})},FG=function(t,n,r){return t.map(function(c){return"".concat(TRe(c)," ").concat(n,"ms ").concat(r)}).join(",")};function ARe(e,t){return CRe(e)||ERe(e,t)||Mee(e,t)||jRe()}function jRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ERe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,c,f,p,s=[],w=!0,T=!1;try{if(f=(n=n.call(e)).next,t!==0)for(;!(w=(r=f.call(n)).done)&&(s.push(r.value),s.length!==t);w=!0);}catch(E){T=!0,c=E}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return s}}function CRe(e){if(Array.isArray(e))return e}function NRe(e){return RRe(e)||MRe(e)||Mee(e)||PRe()}function PRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mee(e,t){if(e){if(typeof e=="string")return QI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return QI(e,t)}}function MRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function RRe(e){if(Array.isArray(e))return QI(e)}function QI(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var qj=1e-4,Ree=function(t,n){return[0,3*t,3*n-6*t,3*t-3*n+1]},Oee=function(t,n){return t.map(function(r,c){return r*Math.pow(n,c)}).reduce(function(r,c){return r+c})},BG=function(t,n){return function(r){var c=Ree(t,n);return Oee(c,r)}},ORe=function(t,n){return function(r){var c=Ree(t,n),f=[].concat(NRe(c.map(function(p,s){return p*s}).slice(1)),[0]);return Oee(f,r)}},UG=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var c=n[0],f=n[1],p=n[2],s=n[3];if(n.length===1)switch(n[0]){case"linear":c=0,f=0,p=1,s=1;break;case"ease":c=.25,f=.1,p=.25,s=1;break;case"ease-in":c=.42,f=0,p=1,s=1;break;case"ease-out":c=.42,f=0,p=.58,s=1;break;case"ease-in-out":c=0,f=0,p=.58,s=1;break;default:{var w=n[0].split("(");if(w[0]==="cubic-bezier"&&w[1].split(")")[0].split(",").length===4){var T=w[1].split(")")[0].split(",").map(function(F){return parseFloat(F)}),E=ARe(T,4);c=E[0],f=E[1],p=E[2],s=E[3]}}}var N=BG(c,p),D=BG(f,s),V=ORe(c,p),$=function(K){return K>1?1:K<0?0:K},B=function(K){for(var Y=K>1?1:K,X=Y,ae=0;ae<8;++ae){var Z=N(X)-Y,se=V(X);if(Math.abs(Z-Y)<qj||se<qj)return D(X);X=$(X-Z/se)}return D(X)};return B.isStepper=!1,B},DRe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.stiff,r=n===void 0?100:n,c=t.damping,f=c===void 0?8:c,p=t.dt,s=p===void 0?17:p,w=function(E,N,D){var V=-(E-N)*r,$=D*f,B=D+(V-$)*s/1e3,F=D*s/1e3+E;return Math.abs(F-N)<qj&&Math.abs(B)<qj?[N,0]:[F,B]};return w.isStepper=!0,w.dt=s,w},kRe=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var c=n[0];if(typeof c=="string")switch(c){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return UG(c);case"spring":return DRe();default:if(c.split("(")[0]==="cubic-bezier")return UG(c)}return typeof c=="function"?c:null};function RS(e){"@babel/helpers - typeof";return RS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},RS(e)}function VG(e){return zRe(e)||LRe(e)||Dee(e)||IRe()}function IRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zRe(e){if(Array.isArray(e))return tL(e)}function $G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function Ac(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$G(Object(n),!0).forEach(function(r){eL(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$G(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function eL(e,t,n){return t=FRe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FRe(e){var t=BRe(e,"string");return RS(t)==="symbol"?t:String(t)}function BRe(e,t){if(RS(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(RS(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function URe(e,t){return qRe(e)||$Re(e,t)||Dee(e,t)||VRe()}function VRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dee(e,t){if(e){if(typeof e=="string")return tL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tL(e,t)}}function tL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $Re(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,c,f,p,s=[],w=!0,T=!1;try{if(f=(n=n.call(e)).next,t!==0)for(;!(w=(r=f.call(n)).done)&&(s.push(r.value),s.length!==t);w=!0);}catch(E){T=!0,c=E}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return s}}function qRe(e){if(Array.isArray(e))return e}var Hj=function(t,n,r){return t+(n-t)*r},nL=function(t){var n=t.from,r=t.to;return n!==r},HRe=function e(t,n,r){var c=H1(function(f,p){if(nL(p)){var s=t(p.from,p.to,p.velocity),w=URe(s,2),T=w[0],E=w[1];return Ac(Ac({},p),{},{from:T,velocity:E})}return p},n);return r<1?H1(function(f,p){return nL(p)?Ac(Ac({},p),{},{velocity:Hj(p.velocity,c[f].velocity,r),from:Hj(p.from,c[f].from,r)}):p},n):e(t,c,r-1)};const GRe=(function(e,t,n,r,c){var f=wRe(e,t),p=f.reduce(function(F,K){return Ac(Ac({},F),{},eL({},K,[e[K],t[K]]))},{}),s=f.reduce(function(F,K){return Ac(Ac({},F),{},eL({},K,{from:e[K],velocity:0,to:t[K]}))},{}),w=-1,T,E,N=function(){return null},D=function(){return H1(function(K,Y){return Y.from},s)},V=function(){return!Object.values(s).filter(nL).length},$=function(K){T||(T=K);var Y=K-T,X=Y/n.dt;s=HRe(n,s,X),c(Ac(Ac(Ac({},e),t),D())),T=K,V()||(w=requestAnimationFrame(N))},B=function(K){E||(E=K);var Y=(K-E)/r,X=H1(function(Z,se){return Hj.apply(void 0,VG(se).concat([n(Y)]))},p);if(c(Ac(Ac(Ac({},e),t),X)),Y<1)w=requestAnimationFrame(N);else{var ae=H1(function(Z,se){return Hj.apply(void 0,VG(se).concat([n(1)]))},p);c(Ac(Ac(Ac({},e),t),ae))}};return N=n.isStepper?$:B,function(){return requestAnimationFrame(N),function(){cancelAnimationFrame(w)}}});function lb(e){"@babel/helpers - typeof";return lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lb(e)}var WRe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function XRe(e,t){if(e==null)return{};var n=ZRe(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ZRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),c,f;for(f=0;f<r.length;f++)c=r[f],!(t.indexOf(c)>=0)&&(n[c]=e[c]);return n}function ID(e){return QRe(e)||JRe(e)||KRe(e)||YRe()}function YRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KRe(e,t){if(e){if(typeof e=="string")return rL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rL(e,t)}}function JRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function QRe(e){if(Array.isArray(e))return rL(e)}function rL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function jf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qG(Object(n),!0).forEach(function(r){O1(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function O1(e,t,n){return t=kee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tOe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,kee(r.key),r)}}function nOe(e,t,n){return t&&tOe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function kee(e){var t=rOe(e,"string");return lb(t)==="symbol"?t:String(t)}function rOe(e,t){if(lb(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(lb(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iL(e,t)}function iL(e,t){return iL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},iL(e,t)}function sOe(e){var t=aOe();return function(){var r=Gj(e),c;if(t){var f=Gj(this).constructor;c=Reflect.construct(r,arguments,f)}else c=r.apply(this,arguments);return sL(this,c)}}function sL(e,t){if(t&&(lb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aL(e)}function aL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gj(e){return Gj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Gj(e)}var Vf=(function(e){iOe(n,e);var t=sOe(n);function n(r,c){var f;eOe(this,n),f=t.call(this,r,c);var p=f.props,s=p.isActive,w=p.attributeName,T=p.from,E=p.to,N=p.steps,D=p.children,V=p.duration;if(f.handleStyleChange=f.handleStyleChange.bind(aL(f)),f.changeStyle=f.changeStyle.bind(aL(f)),!s||V<=0)return f.state={style:{}},typeof D=="function"&&(f.state={style:E}),sL(f);if(N&&N.length)f.state={style:N[0].style};else if(T){if(typeof D=="function")return f.state={style:T},sL(f);f.state={style:w?O1({},w,T):T}}else f.state={style:{}};return f}return nOe(n,[{key:"componentDidMount",value:function(){var c=this.props,f=c.isActive,p=c.canBegin;this.mounted=!0,!(!f||!p)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(c){var f=this.props,p=f.isActive,s=f.canBegin,w=f.attributeName,T=f.shouldReAnimate,E=f.to,N=f.from,D=this.state.style;if(s){if(!p){var V={style:w?O1({},w,E):E};this.state&&D&&(w&&D[w]!==E||!w&&D!==E)&&this.setState(V);return}if(!(hRe(c.to,E)&&c.canBegin&&c.isActive)){var $=!c.canBegin||!c.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var B=$||T?N:c.to;if(this.state&&D){var F={style:w?O1({},w,B):B};(w&&D[w]!==B||!w&&D!==B)&&this.setState(F)}this.runAnimation(jf(jf({},this.props),{},{from:B,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var c=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),c&&c()}},{key:"handleStyleChange",value:function(c){this.changeStyle(c)}},{key:"changeStyle",value:function(c){this.mounted&&this.setState({style:c})}},{key:"runJSAnimation",value:function(c){var f=this,p=c.from,s=c.to,w=c.duration,T=c.easing,E=c.begin,N=c.onAnimationEnd,D=c.onAnimationStart,V=GRe(p,s,kRe(T),w,this.changeStyle),$=function(){f.stopJSAnimation=V()};this.manager.start([D,E,$,w,N])}},{key:"runStepAnimation",value:function(c){var f=this,p=c.steps,s=c.begin,w=c.onAnimationStart,T=p[0],E=T.style,N=T.duration,D=N===void 0?0:N,V=function(B,F,K){if(K===0)return B;var Y=F.duration,X=F.easing,ae=X===void 0?"ease":X,Z=F.style,se=F.properties,he=F.onAnimationEnd,ye=K>0?p[K-1]:F,Ce=se||Object.keys(Z);if(typeof ae=="function"||ae==="spring")return[].concat(ID(B),[f.runJSAnimation.bind(f,{from:ye.style,to:Z,duration:Y,easing:ae}),Y]);var Ve=FG(Ce,Y,ae),Re=jf(jf(jf({},ye.style),Z),{},{transition:Ve});return[].concat(ID(B),[Re,Y,he]).filter(SRe)};return this.manager.start([w].concat(ID(p.reduce(V,[E,Math.max(D,s)])),[c.onAnimationEnd]))}},{key:"runAnimation",value:function(c){this.manager||(this.manager=xRe());var f=c.begin,p=c.duration,s=c.attributeName,w=c.to,T=c.easing,E=c.onAnimationStart,N=c.onAnimationEnd,D=c.steps,V=c.children,$=this.manager;if(this.unSubscribe=$.subscribe(this.handleStyleChange),typeof T=="function"||typeof V=="function"||T==="spring"){this.runJSAnimation(c);return}if(D.length>1){this.runStepAnimation(c);return}var B=s?O1({},s,w):w,F=FG(Object.keys(B),p,T);$.start([E,f,jf(jf({},B),{},{transition:F}),p,N])}},{key:"render",value:function(){var c=this.props,f=c.children;c.begin;var p=c.duration;c.attributeName,c.easing;var s=c.isActive;c.steps,c.from,c.to,c.canBegin,c.onAnimationEnd,c.shouldReAnimate,c.onAnimationReStart;var w=XRe(c,WRe),T=z.Children.count(f),E=this.state.style;if(typeof f=="function")return f(E);if(!s||T===0||p<=0)return f;var N=function(V){var $=V.props,B=$.style,F=B===void 0?{}:B,K=$.className,Y=z.cloneElement(V,jf(jf({},w),{},{style:jf(jf({},F),E),className:K}));return Y};return T===1?N(z.Children.only(f)):_e.createElement("div",null,z.Children.map(f,function(D){return N(D)}))}}]),n})(z.PureComponent);Vf.displayName="Animate";Vf.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Vf.propTypes={from:Ba.oneOfType([Ba.object,Ba.string]),to:Ba.oneOfType([Ba.object,Ba.string]),attributeName:Ba.string,duration:Ba.number,begin:Ba.number,easing:Ba.oneOfType([Ba.string,Ba.func]),steps:Ba.arrayOf(Ba.shape({duration:Ba.number.isRequired,style:Ba.object.isRequired,easing:Ba.oneOfType([Ba.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Ba.func]),properties:Ba.arrayOf("string"),onAnimationEnd:Ba.func})),children:Ba.oneOfType([Ba.node,Ba.func]),isActive:Ba.bool,canBegin:Ba.bool,onAnimationEnd:Ba.func,shouldReAnimate:Ba.bool,onAnimationStart:Ba.func,onAnimationReStart:Ba.func};function OS(e){"@babel/helpers - typeof";return OS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OS(e)}function Wj(){return Wj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Wj.apply(this,arguments)}function oOe(e,t){return dOe(e)||uOe(e,t)||cOe(e,t)||lOe()}function lOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cOe(e,t){if(e){if(typeof e=="string")return HG(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return HG(e,t)}}function HG(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function uOe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,c,f,p,s=[],w=!0,T=!1;try{if(f=(n=n.call(e)).next,t!==0)for(;!(w=(r=f.call(n)).done)&&(s.push(r.value),s.length!==t);w=!0);}catch(E){T=!0,c=E}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return s}}function dOe(e){if(Array.isArray(e))return e}function GG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function WG(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?GG(Object(n),!0).forEach(function(r){hOe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function hOe(e,t,n){return t=fOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fOe(e){var t=pOe(e,"string");return OS(t)=="symbol"?t:t+""}function pOe(e,t){if(OS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(OS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XG=function(t,n,r,c,f){var p=Math.min(Math.abs(r)/2,Math.abs(c)/2),s=c>=0?1:-1,w=r>=0?1:-1,T=c>=0&&r>=0||c<0&&r<0?1:0,E;if(p>0&&f instanceof Array){for(var N=[0,0,0,0],D=0,V=4;D<V;D++)N[D]=f[D]>p?p:f[D];E="M".concat(t,",").concat(n+s*N[0]),N[0]>0&&(E+="A ".concat(N[0],",").concat(N[0],",0,0,").concat(T,",").concat(t+w*N[0],",").concat(n)),E+="L ".concat(t+r-w*N[1],",").concat(n),N[1]>0&&(E+="A ".concat(N[1],",").concat(N[1],",0,0,").concat(T,`,
        `).concat(t+r,",").concat(n+s*N[1])),E+="L ".concat(t+r,",").concat(n+c-s*N[2]),N[2]>0&&(E+="A ".concat(N[2],",").concat(N[2],",0,0,").concat(T,`,
        `).concat(t+r-w*N[2],",").concat(n+c)),E+="L ".concat(t+w*N[3],",").concat(n+c),N[3]>0&&(E+="A ".concat(N[3],",").concat(N[3],",0,0,").concat(T,`,
        `).concat(t,",").concat(n+c-s*N[3])),E+="Z"}else if(p>0&&f===+f&&f>0){var $=Math.min(p,f);E="M ".concat(t,",").concat(n+s*$,`
            A `).concat($,",").concat($,",0,0,").concat(T,",").concat(t+w*$,",").concat(n,`
            L `).concat(t+r-w*$,",").concat(n,`
            A `).concat($,",").concat($,",0,0,").concat(T,",").concat(t+r,",").concat(n+s*$,`
            L `).concat(t+r,",").concat(n+c-s*$,`
            A `).concat($,",").concat($,",0,0,").concat(T,",").concat(t+r-w*$,",").concat(n+c,`
            L `).concat(t+w*$,",").concat(n+c,`
            A `).concat($,",").concat($,",0,0,").concat(T,",").concat(t,",").concat(n+c-s*$," Z")}else E="M ".concat(t,",").concat(n," h ").concat(r," v ").concat(c," h ").concat(-r," Z");return E},mOe=function(t,n){if(!t||!n)return!1;var r=t.x,c=t.y,f=n.x,p=n.y,s=n.width,w=n.height;if(Math.abs(s)>0&&Math.abs(w)>0){var T=Math.min(f,f+s),E=Math.max(f,f+s),N=Math.min(p,p+w),D=Math.max(p,p+w);return r>=T&&r<=E&&c>=N&&c<=D}return!1},gOe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},dF=function(t){var n=WG(WG({},gOe),t),r=z.useRef(),c=z.useState(-1),f=oOe(c,2),p=f[0],s=f[1];z.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var ae=r.current.getTotalLength();ae&&s(ae)}catch{}},[]);var w=n.x,T=n.y,E=n.width,N=n.height,D=n.radius,V=n.className,$=n.animationEasing,B=n.animationDuration,F=n.animationBegin,K=n.isAnimationActive,Y=n.isUpdateAnimationActive;if(w!==+w||T!==+T||E!==+E||N!==+N||E===0||N===0)return null;var X=es("recharts-rectangle",V);return Y?_e.createElement(Vf,{canBegin:p>0,from:{width:E,height:N,x:w,y:T},to:{width:E,height:N,x:w,y:T},duration:B,animationEasing:$,isActive:Y},function(ae){var Z=ae.width,se=ae.height,he=ae.x,ye=ae.y;return _e.createElement(Vf,{canBegin:p>0,from:"0px ".concat(p===-1?1:p,"px"),to:"".concat(p,"px 0px"),attributeName:"strokeDasharray",begin:F,duration:B,isActive:K,easing:$},_e.createElement("path",Wj({},Oi(n,!0),{className:X,d:XG(he,ye,Z,se,D),ref:r})))}):_e.createElement("path",Wj({},Oi(n,!0),{className:X,d:XG(w,T,E,N,D)}))},yOe=["points","className","baseLinePoints","connectNulls"];function R0(){return R0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},R0.apply(this,arguments)}function vOe(e,t){if(e==null)return{};var n=xOe(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function xOe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function ZG(e){return SOe(e)||wOe(e)||bOe(e)||_Oe()}function _Oe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bOe(e,t){if(e){if(typeof e=="string")return oL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oL(e,t)}}function wOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function SOe(e){if(Array.isArray(e))return oL(e)}function oL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var YG=function(t){return t&&t.x===+t.x&&t.y===+t.y},TOe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[[]];return t.forEach(function(r){YG(r)?n[n.length-1].push(r):n[n.length-1].length>0&&n.push([])}),YG(t[0])&&n[n.length-1].push(t[0]),n[n.length-1].length<=0&&(n=n.slice(0,-1)),n},G1=function(t,n){var r=TOe(t);n&&(r=[r.reduce(function(f,p){return[].concat(ZG(f),ZG(p))},[])]);var c=r.map(function(f){return f.reduce(function(p,s,w){return"".concat(p).concat(w===0?"M":"L").concat(s.x,",").concat(s.y)},"")}).join("");return r.length===1?"".concat(c,"Z"):c},AOe=function(t,n,r){var c=G1(t,r);return"".concat(c.slice(-1)==="Z"?c.slice(0,-1):c,"L").concat(G1(n.reverse(),r).slice(1))},jOe=function(t){var n=t.points,r=t.className,c=t.baseLinePoints,f=t.connectNulls,p=vOe(t,yOe);if(!n||!n.length)return null;var s=es("recharts-polygon",r);if(c&&c.length){var w=p.stroke&&p.stroke!=="none",T=AOe(n,c,f);return _e.createElement("g",{className:s},_e.createElement("path",R0({},Oi(p,!0),{fill:T.slice(-1)==="Z"?p.fill:"none",stroke:"none",d:T})),w?_e.createElement("path",R0({},Oi(p,!0),{fill:"none",d:G1(n,f)})):null,w?_e.createElement("path",R0({},Oi(p,!0),{fill:"none",d:G1(c,f)})):null)}var E=G1(n,f);return _e.createElement("path",R0({},Oi(p,!0),{fill:E.slice(-1)==="Z"?p.fill:"none",className:s,d:E}))};function lL(){return lL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lL.apply(this,arguments)}var ET=function(t){var n=t.cx,r=t.cy,c=t.r,f=t.className,p=es("recharts-dot",f);return n===+n&&r===+r&&c===+c?z.createElement("circle",lL({},Oi(t,!1),gj(t),{className:p,cx:n,cy:r,r:c})):null};function DS(e){"@babel/helpers - typeof";return DS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},DS(e)}var EOe=["x","y","top","left","width","height","className"];function cL(){return cL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cL.apply(this,arguments)}function KG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function COe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?KG(Object(n),!0).forEach(function(r){NOe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function NOe(e,t,n){return t=POe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function POe(e){var t=MOe(e,"string");return DS(t)=="symbol"?t:t+""}function MOe(e,t){if(DS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(DS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ROe(e,t){if(e==null)return{};var n=OOe(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function OOe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var DOe=function(t,n,r,c,f,p){return"M".concat(t,",").concat(f,"v").concat(c,"M").concat(p,",").concat(n,"h").concat(r)},kOe=function(t){var n=t.x,r=n===void 0?0:n,c=t.y,f=c===void 0?0:c,p=t.top,s=p===void 0?0:p,w=t.left,T=w===void 0?0:w,E=t.width,N=E===void 0?0:E,D=t.height,V=D===void 0?0:D,$=t.className,B=ROe(t,EOe),F=COe({x:r,y:f,top:s,left:T,width:N,height:V},B);return!jr(r)||!jr(f)||!jr(N)||!jr(V)||!jr(s)||!jr(T)?null:_e.createElement("path",cL({},Oi(F,!0),{className:es("recharts-cross",$),d:DOe(r,f,N,V,s,T)}))},LD,JG;function IOe(){if(JG)return LD;JG=1;var e=OC(),t=YQ(),n=dm();function r(c,f){return c&&c.length?e(c,n(f,2),t):void 0}return LD=r,LD}var LOe=IOe();const zOe=Ca(LOe);var zD,QG;function FOe(){if(QG)return zD;QG=1;var e=OC(),t=dm(),n=KQ();function r(c,f){return c&&c.length?e(c,t(f,2),n):void 0}return zD=r,zD}var BOe=FOe();const UOe=Ca(BOe);var VOe=["cx","cy","angle","ticks","axisLine"],$Oe=["ticks","tick","angle","tickFormatter","stroke"];function cb(e){"@babel/helpers - typeof";return cb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cb(e)}function W1(){return W1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},W1.apply(this,arguments)}function e7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function jx(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?e7(Object(n),!0).forEach(function(r){LC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function t7(e,t){if(e==null)return{};var n=qOe(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function qOe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function HOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Lee(r.key),r)}}function GOe(e,t,n){return t&&n7(e.prototype,t),n&&n7(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function WOe(e,t,n){return t=Xj(t),XOe(e,Iee()?Reflect.construct(t,n||[],Xj(e).constructor):t.apply(e,n))}function XOe(e,t){if(t&&(cb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZOe(e)}function ZOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Iee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Iee=function(){return!!e})()}function Xj(e){return Xj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Xj(e)}function YOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uL(e,t)}function uL(e,t){return uL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},uL(e,t)}function LC(e,t,n){return t=Lee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lee(e){var t=KOe(e,"string");return cb(t)=="symbol"?t:t+""}function KOe(e,t){if(cb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(cb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zC=(function(e){function t(){return HOe(this,t),WOe(this,t,arguments)}return YOe(t,e),GOe(t,[{key:"getTickValueCoord",value:function(r){var c=r.coordinate,f=this.props,p=f.angle,s=f.cx,w=f.cy;return bo(s,w,c,p)}},{key:"getTickTextAnchor",value:function(){var r=this.props.orientation,c;switch(r){case"left":c="end";break;case"right":c="start";break;default:c="middle";break}return c}},{key:"getViewBox",value:function(){var r=this.props,c=r.cx,f=r.cy,p=r.angle,s=r.ticks,w=zOe(s,function(E){return E.coordinate||0}),T=UOe(s,function(E){return E.coordinate||0});return{cx:c,cy:f,startAngle:p,endAngle:p,innerRadius:T.coordinate||0,outerRadius:w.coordinate||0}}},{key:"renderAxisLine",value:function(){var r=this.props,c=r.cx,f=r.cy,p=r.angle,s=r.ticks,w=r.axisLine,T=t7(r,VOe),E=s.reduce(function($,B){return[Math.min($[0],B.coordinate),Math.max($[1],B.coordinate)]},[1/0,-1/0]),N=bo(c,f,E[0],p),D=bo(c,f,E[1],p),V=jx(jx(jx({},Oi(T,!1)),{},{fill:"none"},Oi(w,!1)),{},{x1:N.x,y1:N.y,x2:D.x,y2:D.y});return _e.createElement("line",W1({className:"recharts-polar-radius-axis-line"},V))}},{key:"renderTicks",value:function(){var r=this,c=this.props,f=c.ticks,p=c.tick,s=c.angle,w=c.tickFormatter,T=c.stroke,E=t7(c,$Oe),N=this.getTickTextAnchor(),D=Oi(E,!1),V=Oi(p,!1),$=f.map(function(B,F){var K=r.getTickValueCoord(B),Y=jx(jx(jx(jx({textAnchor:N,transform:"rotate(".concat(90-s,", ").concat(K.x,", ").concat(K.y,")")},D),{},{stroke:"none",fill:T},V),{},{index:F},K),{},{payload:B});return _e.createElement(sa,W1({className:es("recharts-polar-radius-axis-tick",Aee(p)),key:"tick-".concat(B.coordinate)},t_(r.props,B,F)),t.renderTickItem(p,Y,w?w(B.value,F):B.value))});return _e.createElement(sa,{className:"recharts-polar-radius-axis-ticks"},$)}},{key:"render",value:function(){var r=this.props,c=r.ticks,f=r.axisLine,p=r.tick;return!c||!c.length?null:_e.createElement(sa,{className:es("recharts-polar-radius-axis",this.props.className)},f&&this.renderAxisLine(),p&&this.renderTicks(),cc.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(r,c,f){var p;return _e.isValidElement(r)?p=_e.cloneElement(r,c):as(r)?p=r(c):p=_e.createElement(n_,W1({},c,{className:"recharts-polar-radius-axis-tick-value"}),f),p}}])})(z.PureComponent);LC(zC,"displayName","PolarRadiusAxis");LC(zC,"axisType","radiusAxis");LC(zC,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function ub(e){"@babel/helpers - typeof";return ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ub(e)}function Rx(){return Rx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Rx.apply(this,arguments)}function r7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function Ex(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?r7(Object(n),!0).forEach(function(r){FC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function JOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Fee(r.key),r)}}function QOe(e,t,n){return t&&i7(e.prototype,t),n&&i7(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function eDe(e,t,n){return t=Zj(t),tDe(e,zee()?Reflect.construct(t,n||[],Zj(e).constructor):t.apply(e,n))}function tDe(e,t){if(t&&(ub(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nDe(e)}function nDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zee=function(){return!!e})()}function Zj(e){return Zj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Zj(e)}function rDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dL(e,t)}function dL(e,t){return dL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},dL(e,t)}function FC(e,t,n){return t=Fee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fee(e){var t=iDe(e,"string");return ub(t)=="symbol"?t:t+""}function iDe(e,t){if(ub(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(ub(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sDe=Math.PI/180,s7=1e-5,BC=(function(e){function t(){return JOe(this,t),eDe(this,t,arguments)}return rDe(t,e),QOe(t,[{key:"getTickLineCoord",value:function(r){var c=this.props,f=c.cx,p=c.cy,s=c.radius,w=c.orientation,T=c.tickSize,E=T||8,N=bo(f,p,s,r.coordinate),D=bo(f,p,s+(w==="inner"?-1:1)*E,r.coordinate);return{x1:N.x,y1:N.y,x2:D.x,y2:D.y}}},{key:"getTickTextAnchor",value:function(r){var c=this.props.orientation,f=Math.cos(-r.coordinate*sDe),p;return f>s7?p=c==="outer"?"start":"end":f<-s7?p=c==="outer"?"end":"start":p="middle",p}},{key:"renderAxisLine",value:function(){var r=this.props,c=r.cx,f=r.cy,p=r.radius,s=r.axisLine,w=r.axisLineType,T=Ex(Ex({},Oi(this.props,!1)),{},{fill:"none"},Oi(s,!1));if(w==="circle")return _e.createElement(ET,Rx({className:"recharts-polar-angle-axis-line"},T,{cx:c,cy:f,r:p}));var E=this.props.ticks,N=E.map(function(D){return bo(c,f,p,D.coordinate)});return _e.createElement(jOe,Rx({className:"recharts-polar-angle-axis-line"},T,{points:N}))}},{key:"renderTicks",value:function(){var r=this,c=this.props,f=c.ticks,p=c.tick,s=c.tickLine,w=c.tickFormatter,T=c.stroke,E=Oi(this.props,!1),N=Oi(p,!1),D=Ex(Ex({},E),{},{fill:"none"},Oi(s,!1)),V=f.map(function($,B){var F=r.getTickLineCoord($),K=r.getTickTextAnchor($),Y=Ex(Ex(Ex({textAnchor:K},E),{},{stroke:"none",fill:T},N),{},{index:B,payload:$,x:F.x2,y:F.y2});return _e.createElement(sa,Rx({className:es("recharts-polar-angle-axis-tick",Aee(p)),key:"tick-".concat($.coordinate)},t_(r.props,$,B)),s&&_e.createElement("line",Rx({className:"recharts-polar-angle-axis-tick-line"},D,F)),p&&t.renderTickItem(p,Y,w?w($.value,B):$.value))});return _e.createElement(sa,{className:"recharts-polar-angle-axis-ticks"},V)}},{key:"render",value:function(){var r=this.props,c=r.ticks,f=r.radius,p=r.axisLine;return f<=0||!c||!c.length?null:_e.createElement(sa,{className:es("recharts-polar-angle-axis",this.props.className)},p&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(r,c,f){var p;return _e.isValidElement(r)?p=_e.cloneElement(r,c):as(r)?p=r(c):p=_e.createElement(n_,Rx({},c,{className:"recharts-polar-angle-axis-tick-value"}),f),p}}])})(z.PureComponent);FC(BC,"displayName","PolarAngleAxis");FC(BC,"axisType","angleAxis");FC(BC,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var FD,a7;function aDe(){if(a7)return FD;a7=1;var e=ZJ(),t=e(Object.getPrototypeOf,Object);return FD=t,FD}var BD,o7;function oDe(){if(o7)return BD;o7=1;var e=Dg(),t=aDe(),n=kg(),r="[object Object]",c=Function.prototype,f=Object.prototype,p=c.toString,s=f.hasOwnProperty,w=p.call(Object);function T(E){if(!n(E)||e(E)!=r)return!1;var N=t(E);if(N===null)return!0;var D=s.call(N,"constructor")&&N.constructor;return typeof D=="function"&&D instanceof D&&p.call(D)==w}return BD=T,BD}var lDe=oDe();const cDe=Ca(lDe);var UD,l7;function uDe(){if(l7)return UD;l7=1;var e=Dg(),t=kg(),n="[object Boolean]";function r(c){return c===!0||c===!1||t(c)&&e(c)==n}return UD=r,UD}var dDe=uDe();const hDe=Ca(dDe);function kS(e){"@babel/helpers - typeof";return kS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kS(e)}function Yj(){return Yj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Yj.apply(this,arguments)}function fDe(e,t){return yDe(e)||gDe(e,t)||mDe(e,t)||pDe()}function pDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mDe(e,t){if(e){if(typeof e=="string")return c7(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c7(e,t)}}function c7(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gDe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,c,f,p,s=[],w=!0,T=!1;try{if(f=(n=n.call(e)).next,t!==0)for(;!(w=(r=f.call(n)).done)&&(s.push(r.value),s.length!==t);w=!0);}catch(E){T=!0,c=E}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return s}}function yDe(e){if(Array.isArray(e))return e}function u7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function d7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?u7(Object(n),!0).forEach(function(r){vDe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function vDe(e,t,n){return t=xDe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xDe(e){var t=_De(e,"string");return kS(t)=="symbol"?t:t+""}function _De(e,t){if(kS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(kS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var h7=function(t,n,r,c,f){var p=r-c,s;return s="M ".concat(t,",").concat(n),s+="L ".concat(t+r,",").concat(n),s+="L ".concat(t+r-p/2,",").concat(n+f),s+="L ".concat(t+r-p/2-c,",").concat(n+f),s+="L ".concat(t,",").concat(n," Z"),s},bDe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},wDe=function(t){var n=d7(d7({},bDe),t),r=z.useRef(),c=z.useState(-1),f=fDe(c,2),p=f[0],s=f[1];z.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var X=r.current.getTotalLength();X&&s(X)}catch{}},[]);var w=n.x,T=n.y,E=n.upperWidth,N=n.lowerWidth,D=n.height,V=n.className,$=n.animationEasing,B=n.animationDuration,F=n.animationBegin,K=n.isUpdateAnimationActive;if(w!==+w||T!==+T||E!==+E||N!==+N||D!==+D||E===0&&N===0||D===0)return null;var Y=es("recharts-trapezoid",V);return K?_e.createElement(Vf,{canBegin:p>0,from:{upperWidth:0,lowerWidth:0,height:D,x:w,y:T},to:{upperWidth:E,lowerWidth:N,height:D,x:w,y:T},duration:B,animationEasing:$,isActive:K},function(X){var ae=X.upperWidth,Z=X.lowerWidth,se=X.height,he=X.x,ye=X.y;return _e.createElement(Vf,{canBegin:p>0,from:"0px ".concat(p===-1?1:p,"px"),to:"".concat(p,"px 0px"),attributeName:"strokeDasharray",begin:F,duration:B,easing:$},_e.createElement("path",Yj({},Oi(n,!0),{className:Y,d:h7(he,ye,ae,Z,se),ref:r})))}):_e.createElement("g",null,_e.createElement("path",Yj({},Oi(n,!0),{className:Y,d:h7(w,T,E,N,D)})))},SDe=["option","shapeType","propTransformer","activeClassName","isActive"];function IS(e){"@babel/helpers - typeof";return IS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},IS(e)}function TDe(e,t){if(e==null)return{};var n=ADe(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ADe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function f7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function Kj(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?f7(Object(n),!0).forEach(function(r){jDe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function jDe(e,t,n){return t=EDe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function EDe(e){var t=CDe(e,"string");return IS(t)=="symbol"?t:t+""}function CDe(e,t){if(IS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(IS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NDe(e,t){return Kj(Kj({},t),e)}function PDe(e,t){return e==="symbols"}function p7(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return _e.createElement(dF,n);case"trapezoid":return _e.createElement(wDe,n);case"sector":return _e.createElement(Cee,n);case"symbols":if(PDe(t))return _e.createElement(Nz,n);break;default:return null}}function MDe(e){return z.isValidElement(e)?e.props:e}function Bee(e){var t=e.option,n=e.shapeType,r=e.propTransformer,c=r===void 0?NDe:r,f=e.activeClassName,p=f===void 0?"recharts-active-shape":f,s=e.isActive,w=TDe(e,SDe),T;if(z.isValidElement(t))T=z.cloneElement(t,Kj(Kj({},w),MDe(t)));else if(as(t))T=t(w);else if(cDe(t)&&!hDe(t)){var E=c(t,w);T=_e.createElement(p7,{shapeType:n,elementProps:E})}else{var N=w;T=_e.createElement(p7,{shapeType:n,elementProps:N})}return s?_e.createElement(sa,{className:p},T):T}function UC(e,t){return t!=null&&"trapezoids"in e.props}function VC(e,t){return t!=null&&"sectors"in e.props}function LS(e,t){return t!=null&&"points"in e.props}function RDe(e,t){var n,r,c=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,f=e.y===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.y)||e.y===t.y;return c&&f}function ODe(e,t){var n=e.endAngle===t.endAngle,r=e.startAngle===t.startAngle;return n&&r}function DDe(e,t){var n=e.x===t.x,r=e.y===t.y,c=e.z===t.z;return n&&r&&c}function kDe(e,t){var n;return UC(e,t)?n=RDe:VC(e,t)?n=ODe:LS(e,t)&&(n=DDe),n}function IDe(e,t){var n;return UC(e,t)?n="trapezoids":VC(e,t)?n="sectors":LS(e,t)&&(n="points"),n}function LDe(e,t){if(UC(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(VC(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return LS(e,t)?t.payload:{}}function zDe(e){var t=e.activeTooltipItem,n=e.graphicalItem,r=e.itemData,c=IDe(n,t),f=LDe(n,t),p=r.filter(function(w,T){var E=r_(f,w),N=n.props[c].filter(function($){var B=kDe(n,t);return B($,t)}),D=n.props[c].indexOf(N[N.length-1]),V=T===D;return E&&V}),s=r.indexOf(p[p.length-1]);return s}var FA;function db(e){"@babel/helpers - typeof";return db=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},db(e)}function O0(){return O0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},O0.apply(this,arguments)}function m7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function xo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?m7(Object(n),!0).forEach(function(r){Lh(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function FDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Vee(r.key),r)}}function BDe(e,t,n){return t&&g7(e.prototype,t),n&&g7(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function UDe(e,t,n){return t=Jj(t),VDe(e,Uee()?Reflect.construct(t,n||[],Jj(e).constructor):t.apply(e,n))}function VDe(e,t){if(t&&(db(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $De(e)}function $De(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Uee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Uee=function(){return!!e})()}function Jj(e){return Jj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Jj(e)}function qDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hL(e,t)}function hL(e,t){return hL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},hL(e,t)}function Lh(e,t,n){return t=Vee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vee(e){var t=HDe(e,"string");return db(t)=="symbol"?t:t+""}function HDe(e,t){if(db(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(db(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Lg=(function(e){function t(n){var r;return FDe(this,t),r=UDe(this,t,[n]),Lh(r,"pieRef",null),Lh(r,"sectorRefs",[]),Lh(r,"id",m_("recharts-pie-")),Lh(r,"handleAnimationEnd",function(){var c=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),as(c)&&c()}),Lh(r,"handleAnimationStart",function(){var c=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),as(c)&&c()}),r.state={isAnimationFinished:!n.isAnimationActive,prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,sectorToFocus:0},r}return qDe(t,e),BDe(t,[{key:"isActiveIndex",value:function(r){var c=this.props.activeIndex;return Array.isArray(c)?c.indexOf(r)!==-1:r===c}},{key:"hasActiveIndex",value:function(){var r=this.props.activeIndex;return Array.isArray(r)?r.length!==0:r||r===0}},{key:"renderLabels",value:function(r){var c=this.props.isAnimationActive;if(c&&!this.state.isAnimationFinished)return null;var f=this.props,p=f.label,s=f.labelLine,w=f.dataKey,T=f.valueKey,E=Oi(this.props,!1),N=Oi(p,!1),D=Oi(s,!1),V=p&&p.offsetRadius||20,$=r.map(function(B,F){var K=(B.startAngle+B.endAngle)/2,Y=bo(B.cx,B.cy,B.outerRadius+V,K),X=xo(xo(xo(xo({},E),B),{},{stroke:"none"},N),{},{index:F,textAnchor:t.getTextAnchor(Y.x,B.cx)},Y),ae=xo(xo(xo(xo({},E),B),{},{fill:"none",stroke:B.fill},D),{},{index:F,points:[bo(B.cx,B.cy,B.outerRadius,K),Y]}),Z=w;return xs(w)&&xs(T)?Z="value":xs(w)&&(Z=T),_e.createElement(sa,{key:"label-".concat(B.startAngle,"-").concat(B.endAngle,"-").concat(B.midAngle,"-").concat(F)},s&&t.renderLabelLineItem(s,ae,"line"),t.renderLabelItem(p,X,fl(B,Z)))});return _e.createElement(sa,{className:"recharts-pie-labels"},$)}},{key:"renderSectorsStatically",value:function(r){var c=this,f=this.props,p=f.activeShape,s=f.blendStroke,w=f.inactiveShape;return r.map(function(T,E){if(T?.startAngle===0&&T?.endAngle===0&&r.length!==1)return null;var N=c.isActiveIndex(E),D=w&&c.hasActiveIndex()?w:null,V=N?p:D,$=xo(xo({},T),{},{stroke:s?T.fill:T.stroke,tabIndex:-1});return _e.createElement(sa,O0({ref:function(F){F&&!c.sectorRefs.includes(F)&&c.sectorRefs.push(F)},tabIndex:-1,className:"recharts-pie-sector"},t_(c.props,T,E),{key:"sector-".concat(T?.startAngle,"-").concat(T?.endAngle,"-").concat(T.midAngle,"-").concat(E)}),_e.createElement(Bee,O0({option:V,isActive:N,shapeType:"sector"},$)))})}},{key:"renderSectorsWithAnimation",value:function(){var r=this,c=this.props,f=c.sectors,p=c.isAnimationActive,s=c.animationBegin,w=c.animationDuration,T=c.animationEasing,E=c.animationId,N=this.state,D=N.prevSectors,V=N.prevIsAnimationActive;return _e.createElement(Vf,{begin:s,duration:w,isActive:p,easing:T,from:{t:0},to:{t:1},key:"pie-".concat(E,"-").concat(V),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function($){var B=$.t,F=[],K=f&&f[0],Y=K.startAngle;return f.forEach(function(X,ae){var Z=D&&D[ae],se=ae>0?Zd(X,"paddingAngle",0):0;if(Z){var he=Xl(Z.endAngle-Z.startAngle,X.endAngle-X.startAngle),ye=xo(xo({},X),{},{startAngle:Y+se,endAngle:Y+he(B)+se});F.push(ye),Y=ye.endAngle}else{var Ce=X.endAngle,Ve=X.startAngle,Re=Xl(0,Ce-Ve),$e=Re(B),nt=xo(xo({},X),{},{startAngle:Y+se,endAngle:Y+$e+se});F.push(nt),Y=nt.endAngle}}),_e.createElement(sa,null,r.renderSectorsStatically(F))})}},{key:"attachKeyboardHandlers",value:function(r){var c=this;r.onkeydown=function(f){if(!f.altKey)switch(f.key){case"ArrowLeft":{var p=++c.state.sectorToFocus%c.sectorRefs.length;c.sectorRefs[p].focus(),c.setState({sectorToFocus:p});break}case"ArrowRight":{var s=--c.state.sectorToFocus<0?c.sectorRefs.length-1:c.state.sectorToFocus%c.sectorRefs.length;c.sectorRefs[s].focus(),c.setState({sectorToFocus:s});break}case"Escape":{c.sectorRefs[c.state.sectorToFocus].blur(),c.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var r=this.props,c=r.sectors,f=r.isAnimationActive,p=this.state.prevSectors;return f&&c&&c.length&&(!p||!r_(p,c))?this.renderSectorsWithAnimation():this.renderSectorsStatically(c)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var r=this,c=this.props,f=c.hide,p=c.sectors,s=c.className,w=c.label,T=c.cx,E=c.cy,N=c.innerRadius,D=c.outerRadius,V=c.isAnimationActive,$=this.state.isAnimationFinished;if(f||!p||!p.length||!jr(T)||!jr(E)||!jr(N)||!jr(D))return null;var B=es("recharts-pie",s);return _e.createElement(sa,{tabIndex:this.props.rootTabIndex,className:B,ref:function(K){r.pieRef=K}},this.renderSectors(),w&&this.renderLabels(p),cc.renderCallByParent(this.props,null,!1),(!V||$)&&rm.renderCallByParent(this.props,p,!1))}}],[{key:"getDerivedStateFromProps",value:function(r,c){return c.prevIsAnimationActive!==r.isAnimationActive?{prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:[],isAnimationFinished:!0}:r.isAnimationActive&&r.animationId!==c.prevAnimationId?{prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:c.curSectors,isAnimationFinished:!0}:r.sectors!==c.curSectors?{curSectors:r.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(r,c){return r>c?"start":r<c?"end":"middle"}},{key:"renderLabelLineItem",value:function(r,c,f){if(_e.isValidElement(r))return _e.cloneElement(r,c);if(as(r))return r(c);var p=es("recharts-pie-label-line",typeof r!="boolean"?r.className:"");return _e.createElement(Zx,O0({},c,{key:f,type:"linear",className:p}))}},{key:"renderLabelItem",value:function(r,c,f){if(_e.isValidElement(r))return _e.cloneElement(r,c);var p=f;if(as(r)&&(p=r(c),_e.isValidElement(p)))return p;var s=es("recharts-pie-label-text",typeof r!="boolean"&&!as(r)?r.className:"");return _e.createElement(n_,O0({},c,{alignmentBaseline:"middle",className:s}),p)}}])})(z.PureComponent);FA=Lg;Lh(Lg,"displayName","Pie");Lh(Lg,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!pv.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Lh(Lg,"parseDeltaAngle",function(e,t){var n=bu(t-e),r=Math.min(Math.abs(t-e),360);return n*r});Lh(Lg,"getRealPieData",function(e){var t=e.data,n=e.children,r=Oi(e,!1),c=Yd(n,jC);return t&&t.length?t.map(function(f,p){return xo(xo(xo({payload:f},r),f),c&&c[p]&&c[p].props)}):c&&c.length?c.map(function(f){return xo(xo({},r),f.props)}):[]});Lh(Lg,"parseCoordinateOfPie",function(e,t){var n=t.top,r=t.left,c=t.width,f=t.height,p=Tee(c,f),s=r+wu(e.cx,c,c/2),w=n+wu(e.cy,f,f/2),T=wu(e.innerRadius,p,0),E=wu(e.outerRadius,p,p*.8),N=e.maxRadius||Math.sqrt(c*c+f*f)/2;return{cx:s,cy:w,innerRadius:T,outerRadius:E,maxRadius:N}});Lh(Lg,"getComposedData",function(e){var t=e.item,n=e.offset,r=t.type.defaultProps!==void 0?xo(xo({},t.type.defaultProps),t.props):t.props,c=FA.getRealPieData(r);if(!c||!c.length)return null;var f=r.cornerRadius,p=r.startAngle,s=r.endAngle,w=r.paddingAngle,T=r.dataKey,E=r.nameKey,N=r.valueKey,D=r.tooltipType,V=Math.abs(r.minAngle),$=FA.parseCoordinateOfPie(r,n),B=FA.parseDeltaAngle(p,s),F=Math.abs(B),K=T;xs(T)&&xs(N)?(Lf(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),K="value"):xs(T)&&(Lf(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),K=N);var Y=c.filter(function(ye){return fl(ye,K,0)!==0}).length,X=(F>=360?Y:Y-1)*w,ae=F-Y*V-X,Z=c.reduce(function(ye,Ce){var Ve=fl(Ce,K,0);return ye+(jr(Ve)?Ve:0)},0),se;if(Z>0){var he;se=c.map(function(ye,Ce){var Ve=fl(ye,K,0),Re=fl(ye,E,Ce),$e=(jr(Ve)?Ve:0)/Z,nt;Ce?nt=he.endAngle+bu(B)*w*(Ve!==0?1:0):nt=p;var Me=nt+bu(B)*((Ve!==0?V:0)+$e*ae),rt=(nt+Me)/2,Ee=($.innerRadius+$.outerRadius)/2,it=[{name:Re,value:Ve,payload:ye,dataKey:K,type:D}],et=bo($.cx,$.cy,Ee,rt);return he=xo(xo(xo({percent:$e,cornerRadius:f,name:Re,tooltipPayload:it,midAngle:rt,middleRadius:Ee,tooltipPosition:et},ye),$),{},{value:fl(ye,K),startAngle:nt,endAngle:Me,payload:ye,paddingAngle:bu(B)*w}),he})}return xo(xo({},$),{},{sectors:se,data:c})});var VD,y7;function GDe(){if(y7)return VD;y7=1;var e=Math.ceil,t=Math.max;function n(r,c,f,p){for(var s=-1,w=t(e((c-r)/(f||1)),0),T=Array(w);w--;)T[p?w:++s]=r,r+=f;return T}return VD=n,VD}var $D,v7;function $ee(){if(v7)return $D;v7=1;var e=dQ(),t=1/0,n=17976931348623157e292;function r(c){if(!c)return c===0?c:0;if(c=e(c),c===t||c===-t){var f=c<0?-1:1;return f*n}return c===c?c:0}return $D=r,$D}var qD,x7;function WDe(){if(x7)return qD;x7=1;var e=GDe(),t=AC(),n=$ee();function r(c){return function(f,p,s){return s&&typeof s!="number"&&t(f,p,s)&&(p=s=void 0),f=n(f),p===void 0?(p=f,f=0):p=n(p),s=s===void 0?f<p?1:-1:n(s),e(f,p,s,c)}}return qD=r,qD}var HD,_7;function XDe(){if(_7)return HD;_7=1;var e=WDe(),t=e();return HD=t,HD}var ZDe=XDe();const Qj=Ca(ZDe);function zS(e){"@babel/helpers - typeof";return zS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zS(e)}function b7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function w7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?b7(Object(n),!0).forEach(function(r){qee(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function qee(e,t,n){return t=YDe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YDe(e){var t=KDe(e,"string");return zS(t)=="symbol"?t:t+""}function KDe(e,t){if(zS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(zS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JDe=["Webkit","Moz","O","ms"],QDe=function(t,n){var r=t.replace(/(\w)/,function(f){return f.toUpperCase()}),c=JDe.reduce(function(f,p){return w7(w7({},f),{},qee({},p+r,n))},{});return c[t]=n,c};function hb(e){"@babel/helpers - typeof";return hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hb(e)}function eE(){return eE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eE.apply(this,arguments)}function S7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function GD(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?S7(Object(n),!0).forEach(function(r){Ud(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function eke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Gee(r.key),r)}}function tke(e,t,n){return t&&T7(e.prototype,t),n&&T7(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function nke(e,t,n){return t=tE(t),rke(e,Hee()?Reflect.construct(t,n||[],tE(e).constructor):t.apply(e,n))}function rke(e,t){if(t&&(hb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ike(e)}function ike(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Hee=function(){return!!e})()}function tE(e){return tE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},tE(e)}function ske(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fL(e,t)}function fL(e,t){return fL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},fL(e,t)}function Ud(e,t,n){return t=Gee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gee(e){var t=ake(e,"string");return hb(t)=="symbol"?t:t+""}function ake(e,t){if(hb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(hb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var oke=function(t){var n=t.data,r=t.startIndex,c=t.endIndex,f=t.x,p=t.width,s=t.travellerWidth;if(!n||!n.length)return{};var w=n.length,T=$1().domain(Qj(0,w)).range([f,f+p-s]),E=T.domain().map(function(N){return T(N)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:T(r),endX:T(c),scale:T,scaleValues:E}},A7=function(t){return t.changedTouches&&!!t.changedTouches.length},fb=(function(e){function t(n){var r;return eke(this,t),r=nke(this,t,[n]),Ud(r,"handleDrag",function(c){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(c):r.state.isSlideMoving&&r.handleSlideDrag(c)}),Ud(r,"handleTouchMove",function(c){c.changedTouches!=null&&c.changedTouches.length>0&&r.handleDrag(c.changedTouches[0])}),Ud(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var c=r.props,f=c.endIndex,p=c.onDragEnd,s=c.startIndex;p?.({endIndex:f,startIndex:s})}),r.detachDragEndListener()}),Ud(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),Ud(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),Ud(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),Ud(r,"handleSlideDragStart",function(c){var f=A7(c)?c.changedTouches[0]:c;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:f.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return ske(t,e),tke(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(r){var c=r.startX,f=r.endX,p=this.state.scaleValues,s=this.props,w=s.gap,T=s.data,E=T.length-1,N=Math.min(c,f),D=Math.max(c,f),V=t.getIndexInRange(p,N),$=t.getIndexInRange(p,D);return{startIndex:V-V%w,endIndex:$===E?E:$-$%w}}},{key:"getTextOfTick",value:function(r){var c=this.props,f=c.data,p=c.tickFormatter,s=c.dataKey,w=fl(f[r],s,r);return as(p)?p(w,r):w}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(r){var c=this.state,f=c.slideMoveStartX,p=c.startX,s=c.endX,w=this.props,T=w.x,E=w.width,N=w.travellerWidth,D=w.startIndex,V=w.endIndex,$=w.onChange,B=r.pageX-f;B>0?B=Math.min(B,T+E-N-s,T+E-N-p):B<0&&(B=Math.max(B,T-p,T-s));var F=this.getIndex({startX:p+B,endX:s+B});(F.startIndex!==D||F.endIndex!==V)&&$&&$(F),this.setState({startX:p+B,endX:s+B,slideMoveStartX:r.pageX})}},{key:"handleTravellerDragStart",value:function(r,c){var f=A7(c)?c.changedTouches[0]:c;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:r,brushMoveStartX:f.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(r){var c=this.state,f=c.brushMoveStartX,p=c.movingTravellerId,s=c.endX,w=c.startX,T=this.state[p],E=this.props,N=E.x,D=E.width,V=E.travellerWidth,$=E.onChange,B=E.gap,F=E.data,K={startX:this.state.startX,endX:this.state.endX},Y=r.pageX-f;Y>0?Y=Math.min(Y,N+D-V-T):Y<0&&(Y=Math.max(Y,N-T)),K[p]=T+Y;var X=this.getIndex(K),ae=X.startIndex,Z=X.endIndex,se=function(){var ye=F.length-1;return p==="startX"&&(s>w?ae%B===0:Z%B===0)||s<w&&Z===ye||p==="endX"&&(s>w?Z%B===0:ae%B===0)||s>w&&Z===ye};this.setState(Ud(Ud({},p,T+Y),"brushMoveStartX",r.pageX),function(){$&&se()&&$(X)})}},{key:"handleTravellerMoveKeyboard",value:function(r,c){var f=this,p=this.state,s=p.scaleValues,w=p.startX,T=p.endX,E=this.state[c],N=s.indexOf(E);if(N!==-1){var D=N+r;if(!(D===-1||D>=s.length)){var V=s[D];c==="startX"&&V>=T||c==="endX"&&V<=w||this.setState(Ud({},c,V),function(){f.props.onChange(f.getIndex({startX:f.state.startX,endX:f.state.endX}))})}}}},{key:"renderBackground",value:function(){var r=this.props,c=r.x,f=r.y,p=r.width,s=r.height,w=r.fill,T=r.stroke;return _e.createElement("rect",{stroke:T,fill:w,x:c,y:f,width:p,height:s})}},{key:"renderPanorama",value:function(){var r=this.props,c=r.x,f=r.y,p=r.width,s=r.height,w=r.data,T=r.children,E=r.padding,N=z.Children.only(T);return N?_e.cloneElement(N,{x:c,y:f,width:p,height:s,margin:E,compact:!0,data:w}):null}},{key:"renderTravellerLayer",value:function(r,c){var f,p,s=this,w=this.props,T=w.y,E=w.travellerWidth,N=w.height,D=w.traveller,V=w.ariaLabel,$=w.data,B=w.startIndex,F=w.endIndex,K=Math.max(r,this.props.x),Y=GD(GD({},Oi(this.props,!1)),{},{x:K,y:T,width:E,height:N}),X=V||"Min value: ".concat((f=$[B])===null||f===void 0?void 0:f.name,", Max value: ").concat((p=$[F])===null||p===void 0?void 0:p.name);return _e.createElement(sa,{tabIndex:0,role:"slider","aria-label":X,"aria-valuenow":r,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[c],onTouchStart:this.travellerDragStartHandlers[c],onKeyDown:function(Z){["ArrowLeft","ArrowRight"].includes(Z.key)&&(Z.preventDefault(),Z.stopPropagation(),s.handleTravellerMoveKeyboard(Z.key==="ArrowRight"?1:-1,c))},onFocus:function(){s.setState({isTravellerFocused:!0})},onBlur:function(){s.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(D,Y))}},{key:"renderSlide",value:function(r,c){var f=this.props,p=f.y,s=f.height,w=f.stroke,T=f.travellerWidth,E=Math.min(r,c)+T,N=Math.max(Math.abs(c-r)-T,0);return _e.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:w,fillOpacity:.2,x:E,y:p,width:N,height:s})}},{key:"renderText",value:function(){var r=this.props,c=r.startIndex,f=r.endIndex,p=r.y,s=r.height,w=r.travellerWidth,T=r.stroke,E=this.state,N=E.startX,D=E.endX,V=5,$={pointerEvents:"none",fill:T};return _e.createElement(sa,{className:"recharts-brush-texts"},_e.createElement(n_,eE({textAnchor:"end",verticalAnchor:"middle",x:Math.min(N,D)-V,y:p+s/2},$),this.getTextOfTick(c)),_e.createElement(n_,eE({textAnchor:"start",verticalAnchor:"middle",x:Math.max(N,D)+w+V,y:p+s/2},$),this.getTextOfTick(f)))}},{key:"render",value:function(){var r=this.props,c=r.data,f=r.className,p=r.children,s=r.x,w=r.y,T=r.width,E=r.height,N=r.alwaysShowText,D=this.state,V=D.startX,$=D.endX,B=D.isTextActive,F=D.isSlideMoving,K=D.isTravellerMoving,Y=D.isTravellerFocused;if(!c||!c.length||!jr(s)||!jr(w)||!jr(T)||!jr(E)||T<=0||E<=0)return null;var X=es("recharts-brush",f),ae=_e.Children.count(p)===1,Z=QDe("userSelect","none");return _e.createElement(sa,{className:X,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:Z},this.renderBackground(),ae&&this.renderPanorama(),this.renderSlide(V,$),this.renderTravellerLayer(V,"startX"),this.renderTravellerLayer($,"endX"),(B||F||K||Y||N)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(r){var c=r.x,f=r.y,p=r.width,s=r.height,w=r.stroke,T=Math.floor(f+s/2)-1;return _e.createElement(_e.Fragment,null,_e.createElement("rect",{x:c,y:f,width:p,height:s,fill:w,stroke:"none"}),_e.createElement("line",{x1:c+1,y1:T,x2:c+p-1,y2:T,fill:"none",stroke:"#fff"}),_e.createElement("line",{x1:c+1,y1:T+2,x2:c+p-1,y2:T+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(r,c){var f;return _e.isValidElement(r)?f=_e.cloneElement(r,c):as(r)?f=r(c):f=t.renderDefaultTraveller(c),f}},{key:"getDerivedStateFromProps",value:function(r,c){var f=r.data,p=r.width,s=r.x,w=r.travellerWidth,T=r.updateId,E=r.startIndex,N=r.endIndex;if(f!==c.prevData||T!==c.prevUpdateId)return GD({prevData:f,prevTravellerWidth:w,prevUpdateId:T,prevX:s,prevWidth:p},f&&f.length?oke({data:f,width:p,x:s,travellerWidth:w,startIndex:E,endIndex:N}):{scale:null,scaleValues:null});if(c.scale&&(p!==c.prevWidth||s!==c.prevX||w!==c.prevTravellerWidth)){c.scale.range([s,s+p-w]);var D=c.scale.domain().map(function(V){return c.scale(V)});return{prevData:f,prevTravellerWidth:w,prevUpdateId:T,prevX:s,prevWidth:p,startX:c.scale(r.startIndex),endX:c.scale(r.endIndex),scaleValues:D}}return null}},{key:"getIndexInRange",value:function(r,c){for(var f=r.length,p=0,s=f-1;s-p>1;){var w=Math.floor((p+s)/2);r[w]>c?s=w:p=w}return c>=r[s]?s:p}}])})(z.PureComponent);Ud(fb,"displayName","Brush");Ud(fb,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var WD,j7;function lke(){if(j7)return WD;j7=1;var e=Iz();function t(n,r){var c;return e(n,function(f,p,s){return c=r(f,p,s),!c}),!!c}return WD=t,WD}var XD,E7;function cke(){if(E7)return XD;E7=1;var e=VJ(),t=dm(),n=lke(),r=rd(),c=AC();function f(p,s,w){var T=r(p)?e:n;return w&&c(p,s,w)&&(s=void 0),T(p,t(s,3))}return XD=f,XD}var uke=cke();const dke=Ca(uke);var im=function(t,n){var r=t.alwaysShow,c=t.ifOverflow;return r&&(c="extendDomain"),c===n},ZD,C7;function hke(){if(C7)return ZD;C7=1;var e=aQ();function t(n,r,c){r=="__proto__"&&e?e(n,r,{configurable:!0,enumerable:!0,value:c,writable:!0}):n[r]=c}return ZD=t,ZD}var YD,N7;function fke(){if(N7)return YD;N7=1;var e=hke(),t=iQ(),n=dm();function r(c,f){var p={};return f=n(f,3),t(c,function(s,w,T){e(p,w,f(s,w,T))}),p}return YD=r,YD}var pke=fke();const mke=Ca(pke);var KD,P7;function gke(){if(P7)return KD;P7=1;function e(t,n){for(var r=-1,c=t==null?0:t.length;++r<c;)if(!n(t[r],r,t))return!1;return!0}return KD=e,KD}var JD,M7;function yke(){if(M7)return JD;M7=1;var e=Iz();function t(n,r){var c=!0;return e(n,function(f,p,s){return c=!!r(f,p,s),c}),c}return JD=t,JD}var QD,R7;function vke(){if(R7)return QD;R7=1;var e=gke(),t=yke(),n=dm(),r=rd(),c=AC();function f(p,s,w){var T=r(p)?e:t;return w&&c(p,s,w)&&(s=void 0),T(p,n(s,3))}return QD=f,QD}var xke=vke();const Wee=Ca(xke);var _ke=["x","y"];function FS(e){"@babel/helpers - typeof";return FS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FS(e)}function pL(){return pL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pL.apply(this,arguments)}function O7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function b1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?O7(Object(n),!0).forEach(function(r){bke(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function bke(e,t,n){return t=wke(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wke(e){var t=Ske(e,"string");return FS(t)=="symbol"?t:t+""}function Ske(e,t){if(FS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(FS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tke(e,t){if(e==null)return{};var n=Ake(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ake(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function jke(e,t){var n=e.x,r=e.y,c=Tke(e,_ke),f="".concat(n),p=parseInt(f,10),s="".concat(r),w=parseInt(s,10),T="".concat(t.height||c.height),E=parseInt(T,10),N="".concat(t.width||c.width),D=parseInt(N,10);return b1(b1(b1(b1(b1({},t),c),p?{x:p}:{}),w?{y:w}:{}),{},{height:E,width:D,name:t.name,radius:t.radius})}function D7(e){return _e.createElement(Bee,pL({shapeType:"rectangle",propTransformer:jke,activeClassName:"recharts-active-bar"},e))}var Eke=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(r,c){if(typeof t=="number")return t;var f=jr(r)||J1e(r);return f?t(r,c):(f||s_(),n)}},Cke=["value","background"],Xee;function pb(e){"@babel/helpers - typeof";return pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pb(e)}function Nke(e,t){if(e==null)return{};var n=Pke(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Pke(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function nE(){return nE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nE.apply(this,arguments)}function k7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function Nl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?k7(Object(n),!0).forEach(function(r){Yy(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Mke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Yee(r.key),r)}}function Rke(e,t,n){return t&&I7(e.prototype,t),n&&I7(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oke(e,t,n){return t=rE(t),Dke(e,Zee()?Reflect.construct(t,n||[],rE(e).constructor):t.apply(e,n))}function Dke(e,t){if(t&&(pb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kke(e)}function kke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zee=function(){return!!e})()}function rE(e){return rE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},rE(e)}function Ike(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mL(e,t)}function mL(e,t){return mL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},mL(e,t)}function Yy(e,t,n){return t=Yee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Yee(e){var t=Lke(e,"string");return pb(t)=="symbol"?t:t+""}function Lke(e,t){if(pb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(pb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var CT=(function(e){function t(){var n;Mke(this,t);for(var r=arguments.length,c=new Array(r),f=0;f<r;f++)c[f]=arguments[f];return n=Oke(this,t,[].concat(c)),Yy(n,"state",{isAnimationFinished:!1}),Yy(n,"id",m_("recharts-bar-")),Yy(n,"handleAnimationEnd",function(){var p=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),p&&p()}),Yy(n,"handleAnimationStart",function(){var p=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),p&&p()}),n}return Ike(t,e),Rke(t,[{key:"renderRectanglesStatically",value:function(r){var c=this,f=this.props,p=f.shape,s=f.dataKey,w=f.activeIndex,T=f.activeBar,E=Oi(this.props,!1);return r&&r.map(function(N,D){var V=D===w,$=V?T:p,B=Nl(Nl(Nl({},E),N),{},{isActive:V,option:$,index:D,dataKey:s,onAnimationStart:c.handleAnimationStart,onAnimationEnd:c.handleAnimationEnd});return _e.createElement(sa,nE({className:"recharts-bar-rectangle"},t_(c.props,N,D),{key:"rectangle-".concat(N?.x,"-").concat(N?.y,"-").concat(N?.value,"-").concat(D)}),_e.createElement(D7,B))})}},{key:"renderRectanglesWithAnimation",value:function(){var r=this,c=this.props,f=c.data,p=c.layout,s=c.isAnimationActive,w=c.animationBegin,T=c.animationDuration,E=c.animationEasing,N=c.animationId,D=this.state.prevData;return _e.createElement(Vf,{begin:w,duration:T,isActive:s,easing:E,from:{t:0},to:{t:1},key:"bar-".concat(N),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(V){var $=V.t,B=f.map(function(F,K){var Y=D&&D[K];if(Y){var X=Xl(Y.x,F.x),ae=Xl(Y.y,F.y),Z=Xl(Y.width,F.width),se=Xl(Y.height,F.height);return Nl(Nl({},F),{},{x:X($),y:ae($),width:Z($),height:se($)})}if(p==="horizontal"){var he=Xl(0,F.height),ye=he($);return Nl(Nl({},F),{},{y:F.y+F.height-ye,height:ye})}var Ce=Xl(0,F.width),Ve=Ce($);return Nl(Nl({},F),{},{width:Ve})});return _e.createElement(sa,null,r.renderRectanglesStatically(B))})}},{key:"renderRectangles",value:function(){var r=this.props,c=r.data,f=r.isAnimationActive,p=this.state.prevData;return f&&c&&c.length&&(!p||!r_(p,c))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(c)}},{key:"renderBackground",value:function(){var r=this,c=this.props,f=c.data,p=c.dataKey,s=c.activeIndex,w=Oi(this.props.background,!1);return f.map(function(T,E){T.value;var N=T.background,D=Nke(T,Cke);if(!N)return null;var V=Nl(Nl(Nl(Nl(Nl({},D),{},{fill:"#eee"},N),w),t_(r.props,T,E)),{},{onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd,dataKey:p,index:E,className:"recharts-bar-background-rectangle"});return _e.createElement(D7,nE({key:"background-bar-".concat(E),option:r.props.background,isActive:E===s},V))})}},{key:"renderErrorBar",value:function(r,c){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var f=this.props,p=f.data,s=f.xAxis,w=f.yAxis,T=f.layout,E=f.children,N=Yd(E,jT);if(!N)return null;var D=T==="vertical"?p[0].height/2:p[0].width/2,V=function(F,K){var Y=Array.isArray(F.value)?F.value[1]:F.value;return{x:F.x,y:F.y,value:Y,errorVal:fl(F,K)}},$={clipPath:r?"url(#clipPath-".concat(c,")"):null};return _e.createElement(sa,$,N.map(function(B){return _e.cloneElement(B,{key:"error-bar-".concat(c,"-").concat(B.props.dataKey),data:p,xAxis:s,yAxis:w,layout:T,offset:D,dataPointFormatter:V})}))}},{key:"render",value:function(){var r=this.props,c=r.hide,f=r.data,p=r.className,s=r.xAxis,w=r.yAxis,T=r.left,E=r.top,N=r.width,D=r.height,V=r.isAnimationActive,$=r.background,B=r.id;if(c||!f||!f.length)return null;var F=this.state.isAnimationFinished,K=es("recharts-bar",p),Y=s&&s.allowDataOverflow,X=w&&w.allowDataOverflow,ae=Y||X,Z=xs(B)?this.id:B;return _e.createElement(sa,{className:K},Y||X?_e.createElement("defs",null,_e.createElement("clipPath",{id:"clipPath-".concat(Z)},_e.createElement("rect",{x:Y?T:T-N/2,y:X?E:E-D/2,width:Y?N:N*2,height:X?D:D*2}))):null,_e.createElement(sa,{className:"recharts-bar-rectangles",clipPath:ae?"url(#clipPath-".concat(Z,")"):null},$?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(ae,Z),(!V||F)&&rm.renderCallByParent(this.props,f))}}],[{key:"getDerivedStateFromProps",value:function(r,c){return r.animationId!==c.prevAnimationId?{prevAnimationId:r.animationId,curData:r.data,prevData:c.curData}:r.data!==c.curData?{curData:r.data}:null}}])})(z.PureComponent);Xee=CT;Yy(CT,"displayName","Bar");Yy(CT,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!pv.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Yy(CT,"getComposedData",function(e){var t=e.props,n=e.item,r=e.barPosition,c=e.bandSize,f=e.xAxis,p=e.yAxis,s=e.xAxisTicks,w=e.yAxisTicks,T=e.stackedData,E=e.dataStartIndex,N=e.displayedData,D=e.offset,V=hPe(r,n);if(!V)return null;var $=t.layout,B=n.type.defaultProps,F=B!==void 0?Nl(Nl({},B),n.props):n.props,K=F.dataKey,Y=F.children,X=F.minPointSize,ae=$==="horizontal"?p:f,Z=T?ae.scale.domain():null,se=xPe({numericAxis:ae}),he=Yd(Y,jC),ye=N.map(function(Ce,Ve){var Re,$e,nt,Me,rt,Ee;T?Re=fPe(T[E+Ve],Z):(Re=fl(Ce,K),Array.isArray(Re)||(Re=[se,Re]));var it=Eke(X,Xee.defaultProps.minPointSize)(Re[1],Ve);if($==="horizontal"){var et,mt=[p.scale(Re[0]),p.scale(Re[1])],He=mt[0],pt=mt[1];$e=oG({axis:f,ticks:s,bandSize:c,offset:V.offset,entry:Ce,index:Ve}),nt=(et=pt??He)!==null&&et!==void 0?et:void 0,Me=V.size;var We=He-pt;if(rt=Number.isNaN(We)?0:We,Ee={x:$e,y:p.y,width:Me,height:p.height},Math.abs(it)>0&&Math.abs(rt)<Math.abs(it)){var Je=bu(rt||it)*(Math.abs(it)-Math.abs(rt));nt-=Je,rt+=Je}}else{var jt=[f.scale(Re[0]),f.scale(Re[1])],Pt=jt[0],Ot=jt[1];if($e=Pt,nt=oG({axis:p,ticks:w,bandSize:c,offset:V.offset,entry:Ce,index:Ve}),Me=Ot-Pt,rt=V.size,Ee={x:f.x,y:nt,width:f.width,height:rt},Math.abs(it)>0&&Math.abs(Me)<Math.abs(it)){var Mt=bu(Me||it)*(Math.abs(it)-Math.abs(Me));Me+=Mt}}return Nl(Nl(Nl({},Ce),{},{x:$e,y:nt,width:Me,height:rt,value:T?Re:Re[1],payload:Ce,background:Ee},he&&he[Ve]&&he[Ve].props),{},{tooltipPayload:[wee(n,Ce)],tooltipPosition:{x:$e+Me/2,y:nt+rt/2}})});return Nl({data:ye,layout:$},D)});function BS(e){"@babel/helpers - typeof";return BS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},BS(e)}function zke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Kee(r.key),r)}}function Fke(e,t,n){return t&&L7(e.prototype,t),n&&L7(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function z7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function Pf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?z7(Object(n),!0).forEach(function(r){$C(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function $C(e,t,n){return t=Kee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kee(e){var t=Bke(e,"string");return BS(t)=="symbol"?t:t+""}function Bke(e,t){if(BS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(BS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jee=function(t,n,r,c,f){var p=t.width,s=t.height,w=t.layout,T=t.children,E=Object.keys(n),N={left:r.left,leftMirror:r.left,right:p-r.right,rightMirror:p-r.right,top:r.top,topMirror:r.top,bottom:s-r.bottom,bottomMirror:s-r.bottom},D=!!Vd(T,CT);return E.reduce(function(V,$){var B=n[$],F=B.orientation,K=B.domain,Y=B.padding,X=Y===void 0?{}:Y,ae=B.mirror,Z=B.reversed,se="".concat(F).concat(ae?"Mirror":""),he,ye,Ce,Ve,Re;if(B.type==="number"&&(B.padding==="gap"||B.padding==="no-gap")){var $e=K[1]-K[0],nt=1/0,Me=B.categoricalDomain.sort(tSe);if(Me.forEach(function(jt,Pt){Pt>0&&(nt=Math.min((jt||0)-(Me[Pt-1]||0),nt))}),Number.isFinite(nt)){var rt=nt/$e,Ee=B.layout==="vertical"?r.height:r.width;if(B.padding==="gap"&&(he=rt*Ee/2),B.padding==="no-gap"){var it=wu(t.barCategoryGap,rt*Ee),et=rt*Ee/2;he=et-it-(et-it)/Ee*it}}}c==="xAxis"?ye=[r.left+(X.left||0)+(he||0),r.left+r.width-(X.right||0)-(he||0)]:c==="yAxis"?ye=w==="horizontal"?[r.top+r.height-(X.bottom||0),r.top+(X.top||0)]:[r.top+(X.top||0)+(he||0),r.top+r.height-(X.bottom||0)-(he||0)]:ye=B.range,Z&&(ye=[ye[1],ye[0]]);var mt=vee(B,f,D),He=mt.scale,pt=mt.realScaleType;He.domain(K).range(ye),xee(He);var We=_ee(He,Pf(Pf({},B),{},{realScaleType:pt}));c==="xAxis"?(Re=F==="top"&&!ae||F==="bottom"&&ae,Ce=r.left,Ve=N[se]-Re*B.height):c==="yAxis"&&(Re=F==="left"&&!ae||F==="right"&&ae,Ce=N[se]-Re*B.width,Ve=r.top);var Je=Pf(Pf(Pf({},B),We),{},{realScaleType:pt,x:Ce,y:Ve,scale:He,width:c==="xAxis"?r.width:B.width,height:c==="yAxis"?r.height:B.height});return Je.bandSize=Uj(Je,We),!B.hide&&c==="xAxis"?N[se]+=(Re?-1:1)*Je.height:B.hide||(N[se]+=(Re?-1:1)*Je.width),Pf(Pf({},V),{},$C({},$,Je))},{})},Qee=function(t,n){var r=t.x,c=t.y,f=n.x,p=n.y;return{x:Math.min(r,f),y:Math.min(c,p),width:Math.abs(f-r),height:Math.abs(p-c)}},Uke=function(t){var n=t.x1,r=t.y1,c=t.x2,f=t.y2;return Qee({x:n,y:r},{x:c,y:f})},ete=(function(){function e(t){zke(this,e),this.scale=t}return Fke(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=r.bandAware,f=r.position;if(n!==void 0){if(f)switch(f){case"start":return this.scale(n);case"middle":{var p=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+p}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(n)+s}default:return this.scale(n)}if(c){var w=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+w}return this.scale(n)}}},{key:"isInRange",value:function(n){var r=this.range(),c=r[0],f=r[r.length-1];return c<=f?n>=c&&n<=f:n>=f&&n<=c}}],[{key:"create",value:function(n){return new e(n)}}])})();$C(ete,"EPS",1e-4);var hF=function(t){var n=Object.keys(t).reduce(function(r,c){return Pf(Pf({},r),{},$C({},c,ete.create(t[c])))},{});return Pf(Pf({},n),{},{apply:function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=f.bandAware,s=f.position;return mke(c,function(w,T){return n[T].apply(w,{bandAware:p,position:s})})},isInRange:function(c){return Wee(c,function(f,p){return n[p].isInRange(f)})}})};function Vke(e){return(e%180+180)%180}var $ke=function(t){var n=t.width,r=t.height,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=Vke(c),p=f*Math.PI/180,s=Math.atan(r/n),w=p>s&&p<Math.PI-s?r/Math.sin(p):n/Math.cos(p);return Math.abs(w)},ek,F7;function qke(){if(F7)return ek;F7=1;var e=dm(),t=bT(),n=SC();function r(c){return function(f,p,s){var w=Object(f);if(!t(f)){var T=e(p,3);f=n(f),p=function(N){return T(w[N],N,w)}}var E=c(f,p,s);return E>-1?w[T?f[E]:E]:void 0}}return ek=r,ek}var tk,B7;function Hke(){if(B7)return tk;B7=1;var e=$ee();function t(n){var r=e(n),c=r%1;return r===r?c?r-c:r:0}return tk=t,tk}var nk,U7;function Gke(){if(U7)return nk;U7=1;var e=QJ(),t=dm(),n=Hke(),r=Math.max;function c(f,p,s){var w=f==null?0:f.length;if(!w)return-1;var T=s==null?0:n(s);return T<0&&(T=r(w+T,0)),e(f,t(p,3),T)}return nk=c,nk}var rk,V7;function Wke(){if(V7)return rk;V7=1;var e=qke(),t=Gke(),n=e(t);return rk=n,rk}var Xke=Wke();const Zke=Ca(Xke);var Yke=pJ();const Kke=Ca(Yke);var Jke=Kke(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),fF=z.createContext(void 0),pF=z.createContext(void 0),tte=z.createContext(void 0),nte=z.createContext({}),rte=z.createContext(void 0),ite=z.createContext(0),ste=z.createContext(0),$7=function(t){var n=t.state,r=n.xAxisMap,c=n.yAxisMap,f=n.offset,p=t.clipPathId,s=t.children,w=t.width,T=t.height,E=Jke(f);return _e.createElement(fF.Provider,{value:r},_e.createElement(pF.Provider,{value:c},_e.createElement(nte.Provider,{value:f},_e.createElement(tte.Provider,{value:E},_e.createElement(rte.Provider,{value:p},_e.createElement(ite.Provider,{value:T},_e.createElement(ste.Provider,{value:w},s)))))))},Qke=function(){return z.useContext(rte)},ate=function(t){var n=z.useContext(fF);n==null&&s_();var r=n[t];return r==null&&s_(),r},eIe=function(){var t=z.useContext(fF);return Gy(t)},tIe=function(){var t=z.useContext(pF),n=Zke(t,function(r){return Wee(r.domain,Number.isFinite)});return n||Gy(t)},ote=function(t){var n=z.useContext(pF);n==null&&s_();var r=n[t];return r==null&&s_(),r},nIe=function(){var t=z.useContext(tte);return t},rIe=function(){return z.useContext(nte)},mF=function(){return z.useContext(ste)},gF=function(){return z.useContext(ite)};function mb(e){"@babel/helpers - typeof";return mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mb(e)}function iIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sIe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,cte(r.key),r)}}function aIe(e,t,n){return t&&sIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function oIe(e,t,n){return t=iE(t),lIe(e,lte()?Reflect.construct(t,n||[],iE(e).constructor):t.apply(e,n))}function lIe(e,t){if(t&&(mb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cIe(e)}function cIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lte=function(){return!!e})()}function iE(e){return iE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},iE(e)}function uIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gL(e,t)}function gL(e,t){return gL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},gL(e,t)}function q7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function H7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?q7(Object(n),!0).forEach(function(r){yF(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function yF(e,t,n){return t=cte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cte(e){var t=dIe(e,"string");return mb(t)=="symbol"?t:t+""}function dIe(e,t){if(mb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(mb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function hIe(e,t){return gIe(e)||mIe(e,t)||pIe(e,t)||fIe()}function fIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pIe(e,t){if(e){if(typeof e=="string")return G7(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G7(e,t)}}function G7(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mIe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,c,f,p,s=[],w=!0,T=!1;try{if(f=(n=n.call(e)).next,t!==0)for(;!(w=(r=f.call(n)).done)&&(s.push(r.value),s.length!==t);w=!0);}catch(E){T=!0,c=E}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return s}}function gIe(e){if(Array.isArray(e))return e}function yL(){return yL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yL.apply(this,arguments)}var yIe=function(t,n){var r;return _e.isValidElement(t)?r=_e.cloneElement(t,n):as(t)?r=t(n):r=_e.createElement("line",yL({},n,{className:"recharts-reference-line-line"})),r},vIe=function(t,n,r,c,f,p,s,w,T){var E=f.x,N=f.y,D=f.width,V=f.height;if(r){var $=T.y,B=t.y.apply($,{position:p});if(im(T,"discard")&&!t.y.isInRange(B))return null;var F=[{x:E+D,y:B},{x:E,y:B}];return w==="left"?F.reverse():F}if(n){var K=T.x,Y=t.x.apply(K,{position:p});if(im(T,"discard")&&!t.x.isInRange(Y))return null;var X=[{x:Y,y:N+V},{x:Y,y:N}];return s==="top"?X.reverse():X}if(c){var ae=T.segment,Z=ae.map(function(se){return t.apply(se,{position:p})});return im(T,"discard")&&dke(Z,function(se){return!t.isInRange(se)})?null:Z}return null};function xIe(e){var t=e.x,n=e.y,r=e.segment,c=e.xAxisId,f=e.yAxisId,p=e.shape,s=e.className,w=e.alwaysShow,T=Qke(),E=ate(c),N=ote(f),D=nIe();if(!T||!D)return null;Lf(w===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var V=hF({x:E.scale,y:N.scale}),$=Zl(t),B=Zl(n),F=r&&r.length===2,K=vIe(V,$,B,F,D,e.position,E.orientation,N.orientation,e);if(!K)return null;var Y=hIe(K,2),X=Y[0],ae=X.x,Z=X.y,se=Y[1],he=se.x,ye=se.y,Ce=im(e,"hidden")?"url(#".concat(T,")"):void 0,Ve=H7(H7({clipPath:Ce},Oi(e,!0)),{},{x1:ae,y1:Z,x2:he,y2:ye});return _e.createElement(sa,{className:es("recharts-reference-line",s)},yIe(p,Ve),cc.renderCallByParent(e,Uke({x1:ae,y1:Z,x2:he,y2:ye})))}var vF=(function(e){function t(){return iIe(this,t),oIe(this,t,arguments)}return uIe(t,e),aIe(t,[{key:"render",value:function(){return _e.createElement(xIe,this.props)}}])})(_e.Component);yF(vF,"displayName","ReferenceLine");yF(vF,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function vL(){return vL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vL.apply(this,arguments)}function gb(e){"@babel/helpers - typeof";return gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gb(e)}function W7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function X7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?W7(Object(n),!0).forEach(function(r){qC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _Ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bIe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,dte(r.key),r)}}function wIe(e,t,n){return t&&bIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function SIe(e,t,n){return t=sE(t),TIe(e,ute()?Reflect.construct(t,n||[],sE(e).constructor):t.apply(e,n))}function TIe(e,t){if(t&&(gb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AIe(e)}function AIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ute(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ute=function(){return!!e})()}function sE(e){return sE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},sE(e)}function jIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xL(e,t)}function xL(e,t){return xL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},xL(e,t)}function qC(e,t,n){return t=dte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dte(e){var t=EIe(e,"string");return gb(t)=="symbol"?t:t+""}function EIe(e,t){if(gb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(gb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var CIe=function(t){var n=t.x,r=t.y,c=t.xAxis,f=t.yAxis,p=hF({x:c.scale,y:f.scale}),s=p.apply({x:n,y:r},{bandAware:!0});return im(t,"discard")&&!p.isInRange(s)?null:s},HC=(function(e){function t(){return _Ie(this,t),SIe(this,t,arguments)}return jIe(t,e),wIe(t,[{key:"render",value:function(){var r=this.props,c=r.x,f=r.y,p=r.r,s=r.alwaysShow,w=r.clipPathId,T=Zl(c),E=Zl(f);if(Lf(s===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!T||!E)return null;var N=CIe(this.props);if(!N)return null;var D=N.x,V=N.y,$=this.props,B=$.shape,F=$.className,K=im(this.props,"hidden")?"url(#".concat(w,")"):void 0,Y=X7(X7({clipPath:K},Oi(this.props,!0)),{},{cx:D,cy:V});return _e.createElement(sa,{className:es("recharts-reference-dot",F)},t.renderDot(B,Y),cc.renderCallByParent(this.props,{x:D-p,y:V-p,width:2*p,height:2*p}))}}])})(_e.Component);qC(HC,"displayName","ReferenceDot");qC(HC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});qC(HC,"renderDot",function(e,t){var n;return _e.isValidElement(e)?n=_e.cloneElement(e,t):as(e)?n=e(t):n=_e.createElement(ET,vL({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function _L(){return _L=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_L.apply(this,arguments)}function yb(e){"@babel/helpers - typeof";return yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yb(e)}function Z7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function Y7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Z7(Object(n),!0).forEach(function(r){GC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function NIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PIe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fte(r.key),r)}}function MIe(e,t,n){return t&&PIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function RIe(e,t,n){return t=aE(t),OIe(e,hte()?Reflect.construct(t,n||[],aE(e).constructor):t.apply(e,n))}function OIe(e,t){if(t&&(yb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DIe(e)}function DIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hte=function(){return!!e})()}function aE(e){return aE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},aE(e)}function kIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bL(e,t)}function bL(e,t){return bL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},bL(e,t)}function GC(e,t,n){return t=fte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fte(e){var t=IIe(e,"string");return yb(t)=="symbol"?t:t+""}function IIe(e,t){if(yb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(yb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var LIe=function(t,n,r,c,f){var p=f.x1,s=f.x2,w=f.y1,T=f.y2,E=f.xAxis,N=f.yAxis;if(!E||!N)return null;var D=hF({x:E.scale,y:N.scale}),V={x:t?D.x.apply(p,{position:"start"}):D.x.rangeMin,y:r?D.y.apply(w,{position:"start"}):D.y.rangeMin},$={x:n?D.x.apply(s,{position:"end"}):D.x.rangeMax,y:c?D.y.apply(T,{position:"end"}):D.y.rangeMax};return im(f,"discard")&&(!D.isInRange(V)||!D.isInRange($))?null:Qee(V,$)},WC=(function(e){function t(){return NIe(this,t),RIe(this,t,arguments)}return kIe(t,e),MIe(t,[{key:"render",value:function(){var r=this.props,c=r.x1,f=r.x2,p=r.y1,s=r.y2,w=r.className,T=r.alwaysShow,E=r.clipPathId;Lf(T===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var N=Zl(c),D=Zl(f),V=Zl(p),$=Zl(s),B=this.props.shape;if(!N&&!D&&!V&&!$&&!B)return null;var F=LIe(N,D,V,$,this.props);if(!F&&!B)return null;var K=im(this.props,"hidden")?"url(#".concat(E,")"):void 0;return _e.createElement(sa,{className:es("recharts-reference-area",w)},t.renderRect(B,Y7(Y7({clipPath:K},Oi(this.props,!0)),F)),cc.renderCallByParent(this.props,F))}}])})(_e.Component);GC(WC,"displayName","ReferenceArea");GC(WC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});GC(WC,"renderRect",function(e,t){var n;return _e.isValidElement(e)?n=_e.cloneElement(e,t):as(e)?n=e(t):n=_e.createElement(dF,_L({},t,{className:"recharts-reference-area-rect"})),n});function pte(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var r=[],c=0;c<e.length;c+=t)r.push(e[c]);return r}function zIe(e,t,n){var r={width:e.width+t.width,height:e.height+t.height};return $ke(r,n)}function FIe(e,t,n){var r=n==="width",c=e.x,f=e.y,p=e.width,s=e.height;return t===1?{start:r?c:f,end:r?c+p:f+s}:{start:r?c+p:f+s,end:r?c:f}}function oE(e,t,n,r,c){if(e*t<e*r||e*t>e*c)return!1;var f=n();return e*(t-e*f/2-r)>=0&&e*(t+e*f/2-c)<=0}function BIe(e,t){return pte(e,t+1)}function UIe(e,t,n,r,c){for(var f=(r||[]).slice(),p=t.start,s=t.end,w=0,T=1,E=p,N=function(){var $=r?.[w];if($===void 0)return{v:pte(r,T)};var B=w,F,K=function(){return F===void 0&&(F=n($,B)),F},Y=$.coordinate,X=w===0||oE(e,Y,K,E,s);X||(w=0,E=p,T+=1),X&&(E=Y+e*(K()/2+c),w+=T)},D;T<=f.length;)if(D=N(),D)return D.v;return[]}function US(e){"@babel/helpers - typeof";return US=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},US(e)}function K7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function Kc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?K7(Object(n),!0).forEach(function(r){VIe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function VIe(e,t,n){return t=$Ie(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $Ie(e){var t=qIe(e,"string");return US(t)=="symbol"?t:t+""}function qIe(e,t){if(US(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(US(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HIe(e,t,n,r,c){for(var f=(r||[]).slice(),p=f.length,s=t.start,w=t.end,T=function(D){var V=f[D],$,B=function(){return $===void 0&&($=n(V,D)),$};if(D===p-1){var F=e*(V.coordinate+e*B()/2-w);f[D]=V=Kc(Kc({},V),{},{tickCoord:F>0?V.coordinate-F*e:V.coordinate})}else f[D]=V=Kc(Kc({},V),{},{tickCoord:V.coordinate});var K=oE(e,V.tickCoord,B,s,w);K&&(w=V.tickCoord-e*(B()/2+c),f[D]=Kc(Kc({},V),{},{isShow:!0}))},E=p-1;E>=0;E--)T(E);return f}function GIe(e,t,n,r,c,f){var p=(r||[]).slice(),s=p.length,w=t.start,T=t.end;if(f){var E=r[s-1],N=n(E,s-1),D=e*(E.coordinate+e*N/2-T);p[s-1]=E=Kc(Kc({},E),{},{tickCoord:D>0?E.coordinate-D*e:E.coordinate});var V=oE(e,E.tickCoord,function(){return N},w,T);V&&(T=E.tickCoord-e*(N/2+c),p[s-1]=Kc(Kc({},E),{},{isShow:!0}))}for(var $=f?s-1:s,B=function(Y){var X=p[Y],ae,Z=function(){return ae===void 0&&(ae=n(X,Y)),ae};if(Y===0){var se=e*(X.coordinate-e*Z()/2-w);p[Y]=X=Kc(Kc({},X),{},{tickCoord:se<0?X.coordinate-se*e:X.coordinate})}else p[Y]=X=Kc(Kc({},X),{},{tickCoord:X.coordinate});var he=oE(e,X.tickCoord,Z,w,T);he&&(w=X.tickCoord+e*(Z()/2+c),p[Y]=Kc(Kc({},X),{},{isShow:!0}))},F=0;F<$;F++)B(F);return p}function xF(e,t,n){var r=e.tick,c=e.ticks,f=e.viewBox,p=e.minTickGap,s=e.orientation,w=e.interval,T=e.tickFormatter,E=e.unit,N=e.angle;if(!c||!c.length||!r)return[];if(jr(w)||pv.isSsr)return BIe(c,typeof w=="number"&&jr(w)?w:0);var D=[],V=s==="top"||s==="bottom"?"width":"height",$=E&&V==="width"?V1(E,{fontSize:t,letterSpacing:n}):{width:0,height:0},B=function(X,ae){var Z=as(T)?T(X.value,ae):X.value;return V==="width"?zIe(V1(Z,{fontSize:t,letterSpacing:n}),$,N):V1(Z,{fontSize:t,letterSpacing:n})[V]},F=c.length>=2?bu(c[1].coordinate-c[0].coordinate):1,K=FIe(f,F,V);return w==="equidistantPreserveStart"?UIe(F,K,B,c,p):(w==="preserveStart"||w==="preserveStartEnd"?D=GIe(F,K,B,c,p,w==="preserveStartEnd"):D=HIe(F,K,B,c,p),D.filter(function(Y){return Y.isShow}))}var WIe=["viewBox"],XIe=["viewBox"],ZIe=["ticks"];function vb(e){"@babel/helpers - typeof";return vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vb(e)}function D0(){return D0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},D0.apply(this,arguments)}function J7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function Gl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?J7(Object(n),!0).forEach(function(r){_F(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ik(e,t){if(e==null)return{};var n=YIe(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function YIe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function KIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,gte(r.key),r)}}function JIe(e,t,n){return t&&Q7(e.prototype,t),n&&Q7(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function QIe(e,t,n){return t=lE(t),eLe(e,mte()?Reflect.construct(t,n||[],lE(e).constructor):t.apply(e,n))}function eLe(e,t){if(t&&(vb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tLe(e)}function tLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mte=function(){return!!e})()}function lE(e){return lE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},lE(e)}function nLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wL(e,t)}function wL(e,t){return wL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},wL(e,t)}function _F(e,t,n){return t=gte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gte(e){var t=rLe(e,"string");return vb(t)=="symbol"?t:t+""}function rLe(e,t){if(vb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(vb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Xb=(function(e){function t(n){var r;return KIe(this,t),r=QIe(this,t,[n]),r.state={fontSize:"",letterSpacing:""},r}return nLe(t,e),JIe(t,[{key:"shouldComponentUpdate",value:function(r,c){var f=r.viewBox,p=ik(r,WIe),s=this.props,w=s.viewBox,T=ik(s,XIe);return!V0(f,w)||!V0(p,T)||!V0(c,this.state)}},{key:"componentDidMount",value:function(){var r=this.layerReference;if(r){var c=r.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];c&&this.setState({fontSize:window.getComputedStyle(c).fontSize,letterSpacing:window.getComputedStyle(c).letterSpacing})}}},{key:"getTickLineCoord",value:function(r){var c=this.props,f=c.x,p=c.y,s=c.width,w=c.height,T=c.orientation,E=c.tickSize,N=c.mirror,D=c.tickMargin,V,$,B,F,K,Y,X=N?-1:1,ae=r.tickSize||E,Z=jr(r.tickCoord)?r.tickCoord:r.coordinate;switch(T){case"top":V=$=r.coordinate,F=p+ +!N*w,B=F-X*ae,Y=B-X*D,K=Z;break;case"left":B=F=r.coordinate,$=f+ +!N*s,V=$-X*ae,K=V-X*D,Y=Z;break;case"right":B=F=r.coordinate,$=f+ +N*s,V=$+X*ae,K=V+X*D,Y=Z;break;default:V=$=r.coordinate,F=p+ +N*w,B=F+X*ae,Y=B+X*D,K=Z;break}return{line:{x1:V,y1:B,x2:$,y2:F},tick:{x:K,y:Y}}}},{key:"getTickTextAnchor",value:function(){var r=this.props,c=r.orientation,f=r.mirror,p;switch(c){case"left":p=f?"start":"end";break;case"right":p=f?"end":"start";break;default:p="middle";break}return p}},{key:"getTickVerticalAnchor",value:function(){var r=this.props,c=r.orientation,f=r.mirror,p="end";switch(c){case"left":case"right":p="middle";break;case"top":p=f?"start":"end";break;default:p=f?"end":"start";break}return p}},{key:"renderAxisLine",value:function(){var r=this.props,c=r.x,f=r.y,p=r.width,s=r.height,w=r.orientation,T=r.mirror,E=r.axisLine,N=Gl(Gl(Gl({},Oi(this.props,!1)),Oi(E,!1)),{},{fill:"none"});if(w==="top"||w==="bottom"){var D=+(w==="top"&&!T||w==="bottom"&&T);N=Gl(Gl({},N),{},{x1:c,y1:f+D*s,x2:c+p,y2:f+D*s})}else{var V=+(w==="left"&&!T||w==="right"&&T);N=Gl(Gl({},N),{},{x1:c+V*p,y1:f,x2:c+V*p,y2:f+s})}return _e.createElement("line",D0({},N,{className:es("recharts-cartesian-axis-line",Zd(E,"className"))}))}},{key:"renderTicks",value:function(r,c,f){var p=this,s=this.props,w=s.tickLine,T=s.stroke,E=s.tick,N=s.tickFormatter,D=s.unit,V=xF(Gl(Gl({},this.props),{},{ticks:r}),c,f),$=this.getTickTextAnchor(),B=this.getTickVerticalAnchor(),F=Oi(this.props,!1),K=Oi(E,!1),Y=Gl(Gl({},F),{},{fill:"none"},Oi(w,!1)),X=V.map(function(ae,Z){var se=p.getTickLineCoord(ae),he=se.line,ye=se.tick,Ce=Gl(Gl(Gl(Gl({textAnchor:$,verticalAnchor:B},F),{},{stroke:"none",fill:T},K),ye),{},{index:Z,payload:ae,visibleTicksCount:V.length,tickFormatter:N});return _e.createElement(sa,D0({className:"recharts-cartesian-axis-tick",key:"tick-".concat(ae.value,"-").concat(ae.coordinate,"-").concat(ae.tickCoord)},t_(p.props,ae,Z)),w&&_e.createElement("line",D0({},Y,he,{className:es("recharts-cartesian-axis-tick-line",Zd(w,"className"))})),E&&t.renderTickItem(E,Ce,"".concat(as(N)?N(ae.value,Z):ae.value).concat(D||"")))});return _e.createElement("g",{className:"recharts-cartesian-axis-ticks"},X)}},{key:"render",value:function(){var r=this,c=this.props,f=c.axisLine,p=c.width,s=c.height,w=c.ticksGenerator,T=c.className,E=c.hide;if(E)return null;var N=this.props,D=N.ticks,V=ik(N,ZIe),$=D;return as(w)&&($=D&&D.length>0?w(this.props):w(V)),p<=0||s<=0||!$||!$.length?null:_e.createElement(sa,{className:es("recharts-cartesian-axis",T),ref:function(F){r.layerReference=F}},f&&this.renderAxisLine(),this.renderTicks($,this.state.fontSize,this.state.letterSpacing),cc.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(r,c,f){var p,s=es(c.className,"recharts-cartesian-axis-tick-value");return _e.isValidElement(r)?p=_e.cloneElement(r,Gl(Gl({},c),{},{className:s})):as(r)?p=r(Gl(Gl({},c),{},{className:s})):p=_e.createElement(n_,D0({},c,{className:"recharts-cartesian-axis-tick-value"}),f),p}}])})(z.Component);_F(Xb,"displayName","CartesianAxis");_F(Xb,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var iLe=["x1","y1","x2","y2","key"],sLe=["offset"];function a_(e){"@babel/helpers - typeof";return a_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a_(e)}function e9(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function eu(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?e9(Object(n),!0).forEach(function(r){aLe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e9(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function aLe(e,t,n){return t=oLe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oLe(e){var t=lLe(e,"string");return a_(t)=="symbol"?t:t+""}function lLe(e,t){if(a_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(a_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bx(){return Bx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bx.apply(this,arguments)}function t9(e,t){if(e==null)return{};var n=cLe(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function cLe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var uLe=function(t){var n=t.fill;if(!n||n==="none")return null;var r=t.fillOpacity,c=t.x,f=t.y,p=t.width,s=t.height,w=t.ry;return _e.createElement("rect",{x:c,y:f,ry:w,width:p,height:s,stroke:"none",fill:n,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function yte(e,t){var n;if(_e.isValidElement(e))n=_e.cloneElement(e,t);else if(as(e))n=e(t);else{var r=t.x1,c=t.y1,f=t.x2,p=t.y2,s=t.key,w=t9(t,iLe),T=Oi(w,!1);T.offset;var E=t9(T,sLe);n=_e.createElement("line",Bx({},E,{x1:r,y1:c,x2:f,y2:p,fill:"none",key:s}))}return n}function dLe(e){var t=e.x,n=e.width,r=e.horizontal,c=r===void 0?!0:r,f=e.horizontalPoints;if(!c||!f||!f.length)return null;var p=f.map(function(s,w){var T=eu(eu({},e),{},{x1:t,y1:s,x2:t+n,y2:s,key:"line-".concat(w),index:w});return yte(c,T)});return _e.createElement("g",{className:"recharts-cartesian-grid-horizontal"},p)}function hLe(e){var t=e.y,n=e.height,r=e.vertical,c=r===void 0?!0:r,f=e.verticalPoints;if(!c||!f||!f.length)return null;var p=f.map(function(s,w){var T=eu(eu({},e),{},{x1:s,y1:t,x2:s,y2:t+n,key:"line-".concat(w),index:w});return yte(c,T)});return _e.createElement("g",{className:"recharts-cartesian-grid-vertical"},p)}function fLe(e){var t=e.horizontalFill,n=e.fillOpacity,r=e.x,c=e.y,f=e.width,p=e.height,s=e.horizontalPoints,w=e.horizontal,T=w===void 0?!0:w;if(!T||!t||!t.length)return null;var E=s.map(function(D){return Math.round(D+c-c)}).sort(function(D,V){return D-V});c!==E[0]&&E.unshift(0);var N=E.map(function(D,V){var $=!E[V+1],B=$?c+p-D:E[V+1]-D;if(B<=0)return null;var F=V%t.length;return _e.createElement("rect",{key:"react-".concat(V),y:D,x:r,height:B,width:f,stroke:"none",fill:t[F],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return _e.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},N)}function pLe(e){var t=e.vertical,n=t===void 0?!0:t,r=e.verticalFill,c=e.fillOpacity,f=e.x,p=e.y,s=e.width,w=e.height,T=e.verticalPoints;if(!n||!r||!r.length)return null;var E=T.map(function(D){return Math.round(D+f-f)}).sort(function(D,V){return D-V});f!==E[0]&&E.unshift(0);var N=E.map(function(D,V){var $=!E[V+1],B=$?f+s-D:E[V+1]-D;if(B<=0)return null;var F=V%r.length;return _e.createElement("rect",{key:"react-".concat(V),x:D,y:p,width:B,height:w,stroke:"none",fill:r[F],fillOpacity:c,className:"recharts-cartesian-grid-bg"})});return _e.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},N)}var mLe=function(t,n){var r=t.xAxis,c=t.width,f=t.height,p=t.offset;return yee(xF(eu(eu(eu({},Xb.defaultProps),r),{},{ticks:yg(r,!0),viewBox:{x:0,y:0,width:c,height:f}})),p.left,p.left+p.width,n)},gLe=function(t,n){var r=t.yAxis,c=t.width,f=t.height,p=t.offset;return yee(xF(eu(eu(eu({},Xb.defaultProps),r),{},{ticks:yg(r,!0),viewBox:{x:0,y:0,width:c,height:f}})),p.top,p.top+p.height,n)},x0={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function bF(e){var t,n,r,c,f,p,s=mF(),w=gF(),T=rIe(),E=eu(eu({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:x0.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:x0.fill,horizontal:(r=e.horizontal)!==null&&r!==void 0?r:x0.horizontal,horizontalFill:(c=e.horizontalFill)!==null&&c!==void 0?c:x0.horizontalFill,vertical:(f=e.vertical)!==null&&f!==void 0?f:x0.vertical,verticalFill:(p=e.verticalFill)!==null&&p!==void 0?p:x0.verticalFill,x:jr(e.x)?e.x:T.left,y:jr(e.y)?e.y:T.top,width:jr(e.width)?e.width:T.width,height:jr(e.height)?e.height:T.height}),N=E.x,D=E.y,V=E.width,$=E.height,B=E.syncWithTicks,F=E.horizontalValues,K=E.verticalValues,Y=eIe(),X=tIe();if(!jr(V)||V<=0||!jr($)||$<=0||!jr(N)||N!==+N||!jr(D)||D!==+D)return null;var ae=E.verticalCoordinatesGenerator||mLe,Z=E.horizontalCoordinatesGenerator||gLe,se=E.horizontalPoints,he=E.verticalPoints;if((!se||!se.length)&&as(Z)){var ye=F&&F.length,Ce=Z({yAxis:X?eu(eu({},X),{},{ticks:ye?F:X.ticks}):void 0,width:s,height:w,offset:T},ye?!0:B);Lf(Array.isArray(Ce),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(a_(Ce),"]")),Array.isArray(Ce)&&(se=Ce)}if((!he||!he.length)&&as(ae)){var Ve=K&&K.length,Re=ae({xAxis:Y?eu(eu({},Y),{},{ticks:Ve?K:Y.ticks}):void 0,width:s,height:w,offset:T},Ve?!0:B);Lf(Array.isArray(Re),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(a_(Re),"]")),Array.isArray(Re)&&(he=Re)}return _e.createElement("g",{className:"recharts-cartesian-grid"},_e.createElement(uLe,{fill:E.fill,fillOpacity:E.fillOpacity,x:E.x,y:E.y,width:E.width,height:E.height,ry:E.ry}),_e.createElement(dLe,Bx({},E,{offset:T,horizontalPoints:se,xAxis:Y,yAxis:X})),_e.createElement(hLe,Bx({},E,{offset:T,verticalPoints:he,xAxis:Y,yAxis:X})),_e.createElement(fLe,Bx({},E,{horizontalPoints:se})),_e.createElement(pLe,Bx({},E,{verticalPoints:he})))}bF.displayName="CartesianGrid";var yLe=["type","layout","connectNulls","ref"],vLe=["key"];function xb(e){"@babel/helpers - typeof";return xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xb(e)}function n9(e,t){if(e==null)return{};var n=xLe(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function xLe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function X1(){return X1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},X1.apply(this,arguments)}function r9(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function Bd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?r9(Object(n),!0).forEach(function(r){Mf(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r9(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _0(e){return SLe(e)||wLe(e)||bLe(e)||_Le()}function _Le(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bLe(e,t){if(e){if(typeof e=="string")return SL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return SL(e,t)}}function wLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function SLe(e){if(Array.isArray(e))return SL(e)}function SL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function TLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i9(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,xte(r.key),r)}}function ALe(e,t,n){return t&&i9(e.prototype,t),n&&i9(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function jLe(e,t,n){return t=cE(t),ELe(e,vte()?Reflect.construct(t,n||[],cE(e).constructor):t.apply(e,n))}function ELe(e,t){if(t&&(xb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CLe(e)}function CLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vte=function(){return!!e})()}function cE(e){return cE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},cE(e)}function NLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TL(e,t)}function TL(e,t){return TL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},TL(e,t)}function Mf(e,t,n){return t=xte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xte(e){var t=PLe(e,"string");return xb(t)=="symbol"?t:t+""}function PLe(e,t){if(xb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(xb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ky=(function(e){function t(){var n;TLe(this,t);for(var r=arguments.length,c=new Array(r),f=0;f<r;f++)c[f]=arguments[f];return n=jLe(this,t,[].concat(c)),Mf(n,"state",{isAnimationFinished:!0,totalLength:0}),Mf(n,"generateSimpleStrokeDasharray",function(p,s){return"".concat(s,"px ").concat(p-s,"px")}),Mf(n,"getStrokeDasharray",function(p,s,w){var T=w.reduce(function(K,Y){return K+Y});if(!T)return n.generateSimpleStrokeDasharray(s,p);for(var E=Math.floor(p/T),N=p%T,D=s-p,V=[],$=0,B=0;$<w.length;B+=w[$],++$)if(B+w[$]>N){V=[].concat(_0(w.slice(0,$)),[N-B]);break}var F=V.length%2===0?[0,D]:[D];return[].concat(_0(t.repeat(w,E)),_0(V),F).map(function(K){return"".concat(K,"px")}).join(", ")}),Mf(n,"id",m_("recharts-line-")),Mf(n,"pathRef",function(p){n.mainCurve=p}),Mf(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),Mf(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return NLe(t,e),ALe(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(r,c){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var f=this.props,p=f.points,s=f.xAxis,w=f.yAxis,T=f.layout,E=f.children,N=Yd(E,jT);if(!N)return null;var D=function(B,F){return{x:B.x,y:B.y,value:B.value,errorVal:fl(B.payload,F)}},V={clipPath:r?"url(#clipPath-".concat(c,")"):null};return _e.createElement(sa,V,N.map(function($){return _e.cloneElement($,{key:"bar-".concat($.props.dataKey),data:p,xAxis:s,yAxis:w,layout:T,dataPointFormatter:D})}))}},{key:"renderDots",value:function(r,c,f){var p=this.props.isAnimationActive;if(p&&!this.state.isAnimationFinished)return null;var s=this.props,w=s.dot,T=s.points,E=s.dataKey,N=Oi(this.props,!1),D=Oi(w,!0),V=T.map(function(B,F){var K=Bd(Bd(Bd({key:"dot-".concat(F),r:3},N),D),{},{index:F,cx:B.x,cy:B.y,value:B.value,dataKey:E,payload:B.payload,points:T});return t.renderDotItem(w,K)}),$={clipPath:r?"url(#clipPath-".concat(c?"":"dots-").concat(f,")"):null};return _e.createElement(sa,X1({className:"recharts-line-dots",key:"dots"},$),V)}},{key:"renderCurveStatically",value:function(r,c,f,p){var s=this.props,w=s.type,T=s.layout,E=s.connectNulls;s.ref;var N=n9(s,yLe),D=Bd(Bd(Bd({},Oi(N,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:c?"url(#clipPath-".concat(f,")"):null,points:r},p),{},{type:w,layout:T,connectNulls:E});return _e.createElement(Zx,X1({},D,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,c){var f=this,p=this.props,s=p.points,w=p.strokeDasharray,T=p.isAnimationActive,E=p.animationBegin,N=p.animationDuration,D=p.animationEasing,V=p.animationId,$=p.animateNewValues,B=p.width,F=p.height,K=this.state,Y=K.prevPoints,X=K.totalLength;return _e.createElement(Vf,{begin:E,duration:N,isActive:T,easing:D,from:{t:0},to:{t:1},key:"line-".concat(V),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(ae){var Z=ae.t;if(Y){var se=Y.length/s.length,he=s.map(function($e,nt){var Me=Math.floor(nt*se);if(Y[Me]){var rt=Y[Me],Ee=Xl(rt.x,$e.x),it=Xl(rt.y,$e.y);return Bd(Bd({},$e),{},{x:Ee(Z),y:it(Z)})}if($){var et=Xl(B*2,$e.x),mt=Xl(F/2,$e.y);return Bd(Bd({},$e),{},{x:et(Z),y:mt(Z)})}return Bd(Bd({},$e),{},{x:$e.x,y:$e.y})});return f.renderCurveStatically(he,r,c)}var ye=Xl(0,X),Ce=ye(Z),Ve;if(w){var Re="".concat(w).split(/[,\s]+/gim).map(function($e){return parseFloat($e)});Ve=f.getStrokeDasharray(Ce,X,Re)}else Ve=f.generateSimpleStrokeDasharray(X,Ce);return f.renderCurveStatically(s,r,c,{strokeDasharray:Ve})})}},{key:"renderCurve",value:function(r,c){var f=this.props,p=f.points,s=f.isAnimationActive,w=this.state,T=w.prevPoints,E=w.totalLength;return s&&p&&p.length&&(!T&&E>0||!r_(T,p))?this.renderCurveWithAnimation(r,c):this.renderCurveStatically(p,r,c)}},{key:"render",value:function(){var r,c=this.props,f=c.hide,p=c.dot,s=c.points,w=c.className,T=c.xAxis,E=c.yAxis,N=c.top,D=c.left,V=c.width,$=c.height,B=c.isAnimationActive,F=c.id;if(f||!s||!s.length)return null;var K=this.state.isAnimationFinished,Y=s.length===1,X=es("recharts-line",w),ae=T&&T.allowDataOverflow,Z=E&&E.allowDataOverflow,se=ae||Z,he=xs(F)?this.id:F,ye=(r=Oi(p,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},Ce=ye.r,Ve=Ce===void 0?3:Ce,Re=ye.strokeWidth,$e=Re===void 0?2:Re,nt=xJ(p)?p:{},Me=nt.clipDot,rt=Me===void 0?!0:Me,Ee=Ve*2+$e;return _e.createElement(sa,{className:X},ae||Z?_e.createElement("defs",null,_e.createElement("clipPath",{id:"clipPath-".concat(he)},_e.createElement("rect",{x:ae?D:D-V/2,y:Z?N:N-$/2,width:ae?V:V*2,height:Z?$:$*2})),!rt&&_e.createElement("clipPath",{id:"clipPath-dots-".concat(he)},_e.createElement("rect",{x:D-Ee/2,y:N-Ee/2,width:V+Ee,height:$+Ee}))):null,!Y&&this.renderCurve(se,he),this.renderErrorBar(se,he),(Y||p)&&this.renderDots(se,rt,he),(!B||K)&&rm.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(r,c){return r.animationId!==c.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:c.curPoints}:r.points!==c.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,c){for(var f=r.length%2!==0?[].concat(_0(r),[0]):r,p=[],s=0;s<c;++s)p=[].concat(_0(p),_0(f));return p}},{key:"renderDotItem",value:function(r,c){var f;if(_e.isValidElement(r))f=_e.cloneElement(r,c);else if(as(r))f=r(c);else{var p=c.key,s=n9(c,vLe),w=es("recharts-line-dot",typeof r!="boolean"?r.className:"");f=_e.createElement(ET,X1({key:p},s,{className:w}))}return f}}])})(z.PureComponent);Mf(Ky,"displayName","Line");Mf(Ky,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!pv.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Mf(Ky,"getComposedData",function(e){var t=e.props,n=e.xAxis,r=e.yAxis,c=e.xAxisTicks,f=e.yAxisTicks,p=e.dataKey,s=e.bandSize,w=e.displayedData,T=e.offset,E=t.layout,N=w.map(function(D,V){var $=fl(D,p);return E==="horizontal"?{x:Bj({axis:n,ticks:c,bandSize:s,entry:D,index:V}),y:xs($)?null:r.scale($),value:$,payload:D}:{x:xs($)?null:n.scale($),y:Bj({axis:r,ticks:f,bandSize:s,entry:D,index:V}),value:$,payload:D}});return Bd({points:N,layout:E},T)});var MLe=["layout","type","stroke","connectNulls","isRange","ref"],RLe=["key"],_te;function _b(e){"@babel/helpers - typeof";return _b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_b(e)}function bte(e,t){if(e==null)return{};var n=OLe(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function OLe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Ux(){return Ux=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ux.apply(this,arguments)}function s9(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function $y(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?s9(Object(n),!0).forEach(function(r){Zp(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s9(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function DLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a9(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ste(r.key),r)}}function kLe(e,t,n){return t&&a9(e.prototype,t),n&&a9(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ILe(e,t,n){return t=uE(t),LLe(e,wte()?Reflect.construct(t,n||[],uE(e).constructor):t.apply(e,n))}function LLe(e,t){if(t&&(_b(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zLe(e)}function zLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wte=function(){return!!e})()}function uE(e){return uE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},uE(e)}function FLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AL(e,t)}function AL(e,t){return AL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},AL(e,t)}function Zp(e,t,n){return t=Ste(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ste(e){var t=BLe(e,"string");return _b(t)=="symbol"?t:t+""}function BLe(e,t){if(_b(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(_b(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var vv=(function(e){function t(){var n;DLe(this,t);for(var r=arguments.length,c=new Array(r),f=0;f<r;f++)c[f]=arguments[f];return n=ILe(this,t,[].concat(c)),Zp(n,"state",{isAnimationFinished:!0}),Zp(n,"id",m_("recharts-area-")),Zp(n,"handleAnimationEnd",function(){var p=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),as(p)&&p()}),Zp(n,"handleAnimationStart",function(){var p=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),as(p)&&p()}),n}return FLe(t,e),kLe(t,[{key:"renderDots",value:function(r,c,f){var p=this.props.isAnimationActive,s=this.state.isAnimationFinished;if(p&&!s)return null;var w=this.props,T=w.dot,E=w.points,N=w.dataKey,D=Oi(this.props,!1),V=Oi(T,!0),$=E.map(function(F,K){var Y=$y($y($y({key:"dot-".concat(K),r:3},D),V),{},{index:K,cx:F.x,cy:F.y,dataKey:N,value:F.value,payload:F.payload,points:E});return t.renderDotItem(T,Y)}),B={clipPath:r?"url(#clipPath-".concat(c?"":"dots-").concat(f,")"):null};return _e.createElement(sa,Ux({className:"recharts-area-dots"},B),$)}},{key:"renderHorizontalRect",value:function(r){var c=this.props,f=c.baseLine,p=c.points,s=c.strokeWidth,w=p[0].x,T=p[p.length-1].x,E=r*Math.abs(w-T),N=Zy(p.map(function(D){return D.y||0}));return jr(f)&&typeof f=="number"?N=Math.max(f,N):f&&Array.isArray(f)&&f.length&&(N=Math.max(Zy(f.map(function(D){return D.y||0})),N)),jr(N)?_e.createElement("rect",{x:w<T?w:w-E,y:0,width:E,height:Math.floor(N+(s?parseInt("".concat(s),10):1))}):null}},{key:"renderVerticalRect",value:function(r){var c=this.props,f=c.baseLine,p=c.points,s=c.strokeWidth,w=p[0].y,T=p[p.length-1].y,E=r*Math.abs(w-T),N=Zy(p.map(function(D){return D.x||0}));return jr(f)&&typeof f=="number"?N=Math.max(f,N):f&&Array.isArray(f)&&f.length&&(N=Math.max(Zy(f.map(function(D){return D.x||0})),N)),jr(N)?_e.createElement("rect",{x:0,y:w<T?w:w-E,width:N+(s?parseInt("".concat(s),10):1),height:Math.floor(E)}):null}},{key:"renderClipRect",value:function(r){var c=this.props.layout;return c==="vertical"?this.renderVerticalRect(r):this.renderHorizontalRect(r)}},{key:"renderAreaStatically",value:function(r,c,f,p){var s=this.props,w=s.layout,T=s.type,E=s.stroke,N=s.connectNulls,D=s.isRange;s.ref;var V=bte(s,MLe);return _e.createElement(sa,{clipPath:f?"url(#clipPath-".concat(p,")"):null},_e.createElement(Zx,Ux({},Oi(V,!0),{points:r,connectNulls:N,type:T,baseLine:c,layout:w,stroke:"none",className:"recharts-area-area"})),E!=="none"&&_e.createElement(Zx,Ux({},Oi(this.props,!1),{className:"recharts-area-curve",layout:w,type:T,connectNulls:N,fill:"none",points:r})),E!=="none"&&D&&_e.createElement(Zx,Ux({},Oi(this.props,!1),{className:"recharts-area-curve",layout:w,type:T,connectNulls:N,fill:"none",points:c})))}},{key:"renderAreaWithAnimation",value:function(r,c){var f=this,p=this.props,s=p.points,w=p.baseLine,T=p.isAnimationActive,E=p.animationBegin,N=p.animationDuration,D=p.animationEasing,V=p.animationId,$=this.state,B=$.prevPoints,F=$.prevBaseLine;return _e.createElement(Vf,{begin:E,duration:N,isActive:T,easing:D,from:{t:0},to:{t:1},key:"area-".concat(V),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(K){var Y=K.t;if(B){var X=B.length/s.length,ae=s.map(function(ye,Ce){var Ve=Math.floor(Ce*X);if(B[Ve]){var Re=B[Ve],$e=Xl(Re.x,ye.x),nt=Xl(Re.y,ye.y);return $y($y({},ye),{},{x:$e(Y),y:nt(Y)})}return ye}),Z;if(jr(w)&&typeof w=="number"){var se=Xl(F,w);Z=se(Y)}else if(xs(w)||$b(w)){var he=Xl(F,0);Z=he(Y)}else Z=w.map(function(ye,Ce){var Ve=Math.floor(Ce*X);if(F[Ve]){var Re=F[Ve],$e=Xl(Re.x,ye.x),nt=Xl(Re.y,ye.y);return $y($y({},ye),{},{x:$e(Y),y:nt(Y)})}return ye});return f.renderAreaStatically(ae,Z,r,c)}return _e.createElement(sa,null,_e.createElement("defs",null,_e.createElement("clipPath",{id:"animationClipPath-".concat(c)},f.renderClipRect(Y))),_e.createElement(sa,{clipPath:"url(#animationClipPath-".concat(c,")")},f.renderAreaStatically(s,w,r,c)))})}},{key:"renderArea",value:function(r,c){var f=this.props,p=f.points,s=f.baseLine,w=f.isAnimationActive,T=this.state,E=T.prevPoints,N=T.prevBaseLine,D=T.totalLength;return w&&p&&p.length&&(!E&&D>0||!r_(E,p)||!r_(N,s))?this.renderAreaWithAnimation(r,c):this.renderAreaStatically(p,s,r,c)}},{key:"render",value:function(){var r,c=this.props,f=c.hide,p=c.dot,s=c.points,w=c.className,T=c.top,E=c.left,N=c.xAxis,D=c.yAxis,V=c.width,$=c.height,B=c.isAnimationActive,F=c.id;if(f||!s||!s.length)return null;var K=this.state.isAnimationFinished,Y=s.length===1,X=es("recharts-area",w),ae=N&&N.allowDataOverflow,Z=D&&D.allowDataOverflow,se=ae||Z,he=xs(F)?this.id:F,ye=(r=Oi(p,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},Ce=ye.r,Ve=Ce===void 0?3:Ce,Re=ye.strokeWidth,$e=Re===void 0?2:Re,nt=xJ(p)?p:{},Me=nt.clipDot,rt=Me===void 0?!0:Me,Ee=Ve*2+$e;return _e.createElement(sa,{className:X},ae||Z?_e.createElement("defs",null,_e.createElement("clipPath",{id:"clipPath-".concat(he)},_e.createElement("rect",{x:ae?E:E-V/2,y:Z?T:T-$/2,width:ae?V:V*2,height:Z?$:$*2})),!rt&&_e.createElement("clipPath",{id:"clipPath-dots-".concat(he)},_e.createElement("rect",{x:E-Ee/2,y:T-Ee/2,width:V+Ee,height:$+Ee}))):null,Y?null:this.renderArea(se,he),(p||Y)&&this.renderDots(se,rt,he),(!B||K)&&rm.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(r,c){return r.animationId!==c.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,curBaseLine:r.baseLine,prevPoints:c.curPoints,prevBaseLine:c.curBaseLine}:r.points!==c.curPoints||r.baseLine!==c.curBaseLine?{curPoints:r.points,curBaseLine:r.baseLine}:null}}])})(z.PureComponent);_te=vv;Zp(vv,"displayName","Area");Zp(vv,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!pv.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Zp(vv,"getBaseValue",function(e,t,n,r){var c=e.layout,f=e.baseValue,p=t.props.baseValue,s=p??f;if(jr(s)&&typeof s=="number")return s;var w=c==="horizontal"?r:n,T=w.scale.domain();if(w.type==="number"){var E=Math.max(T[0],T[1]),N=Math.min(T[0],T[1]);return s==="dataMin"?N:s==="dataMax"||E<0?E:Math.max(Math.min(T[0],T[1]),0)}return s==="dataMin"?T[0]:s==="dataMax"?T[1]:T[0]});Zp(vv,"getComposedData",function(e){var t=e.props,n=e.item,r=e.xAxis,c=e.yAxis,f=e.xAxisTicks,p=e.yAxisTicks,s=e.bandSize,w=e.dataKey,T=e.stackedData,E=e.dataStartIndex,N=e.displayedData,D=e.offset,V=t.layout,$=T&&T.length,B=_te.getBaseValue(t,n,r,c),F=V==="horizontal",K=!1,Y=N.map(function(ae,Z){var se;$?se=T[E+Z]:(se=fl(ae,w),Array.isArray(se)?K=!0:se=[B,se]);var he=se[1]==null||$&&fl(ae,w)==null;return F?{x:Bj({axis:r,ticks:f,bandSize:s,entry:ae,index:Z}),y:he?null:c.scale(se[1]),value:se,payload:ae}:{x:he?null:r.scale(se[1]),y:Bj({axis:c,ticks:p,bandSize:s,entry:ae,index:Z}),value:se,payload:ae}}),X;return $||K?X=Y.map(function(ae){var Z=Array.isArray(ae.value)?ae.value[0]:null;return F?{x:ae.x,y:Z!=null&&ae.y!=null?c.scale(Z):null}:{x:Z!=null?r.scale(Z):null,y:ae.y}}):X=F?c.scale(B):r.scale(B),$y({points:Y,baseLine:X,layout:V,isRange:K},D)});Zp(vv,"renderDotItem",function(e,t){var n;if(_e.isValidElement(e))n=_e.cloneElement(e,t);else if(as(e))n=e(t);else{var r=es("recharts-area-dot",typeof e!="boolean"?e.className:""),c=t.key,f=bte(t,RLe);n=_e.createElement(ET,Ux({},f,{key:c,className:r}))}return n});function bb(e){"@babel/helpers - typeof";return bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bb(e)}function ULe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VLe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,jte(r.key),r)}}function $Le(e,t,n){return t&&VLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qLe(e,t,n){return t=dE(t),HLe(e,Tte()?Reflect.construct(t,n||[],dE(e).constructor):t.apply(e,n))}function HLe(e,t){if(t&&(bb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GLe(e)}function GLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Tte=function(){return!!e})()}function dE(e){return dE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},dE(e)}function WLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jL(e,t)}function jL(e,t){return jL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},jL(e,t)}function Ate(e,t,n){return t=jte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jte(e){var t=XLe(e,"string");return bb(t)=="symbol"?t:t+""}function XLe(e,t){if(bb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(bb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function EL(){return EL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},EL.apply(this,arguments)}function ZLe(e){var t=e.xAxisId,n=mF(),r=gF(),c=ate(t);return c==null?null:z.createElement(Xb,EL({},c,{className:es("recharts-".concat(c.axisType," ").concat(c.axisType),c.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(p){return yg(p,!0)}}))}var Zb=(function(e){function t(){return ULe(this,t),qLe(this,t,arguments)}return WLe(t,e),$Le(t,[{key:"render",value:function(){return z.createElement(ZLe,this.props)}}])})(z.Component);Ate(Zb,"displayName","XAxis");Ate(Zb,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function wb(e){"@babel/helpers - typeof";return wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wb(e)}function YLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KLe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Nte(r.key),r)}}function JLe(e,t,n){return t&&KLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function QLe(e,t,n){return t=hE(t),e3e(e,Ete()?Reflect.construct(t,n||[],hE(e).constructor):t.apply(e,n))}function e3e(e,t){if(t&&(wb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t3e(e)}function t3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ete(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ete=function(){return!!e})()}function hE(e){return hE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},hE(e)}function n3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CL(e,t)}function CL(e,t){return CL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},CL(e,t)}function Cte(e,t,n){return t=Nte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nte(e){var t=r3e(e,"string");return wb(t)=="symbol"?t:t+""}function r3e(e,t){if(wb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(wb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function NL(){return NL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},NL.apply(this,arguments)}var i3e=function(t){var n=t.yAxisId,r=mF(),c=gF(),f=ote(n);return f==null?null:z.createElement(Xb,NL({},f,{className:es("recharts-".concat(f.axisType," ").concat(f.axisType),f.className),viewBox:{x:0,y:0,width:r,height:c},ticksGenerator:function(s){return yg(s,!0)}}))},NT=(function(e){function t(){return YLe(this,t),QLe(this,t,arguments)}return n3e(t,e),JLe(t,[{key:"render",value:function(){return z.createElement(i3e,this.props)}}])})(z.Component);Cte(NT,"displayName","YAxis");Cte(NT,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function o9(e){return l3e(e)||o3e(e)||a3e(e)||s3e()}function s3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a3e(e,t){if(e){if(typeof e=="string")return PL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PL(e,t)}}function o3e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function l3e(e){if(Array.isArray(e))return PL(e)}function PL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ML=function(t,n,r,c,f){var p=Yd(t,vF),s=Yd(t,HC),w=[].concat(o9(p),o9(s)),T=Yd(t,WC),E="".concat(c,"Id"),N=c[0],D=n;if(w.length&&(D=w.reduce(function(B,F){if(F.props[E]===r&&im(F.props,"extendDomain")&&jr(F.props[N])){var K=F.props[N];return[Math.min(B[0],K),Math.max(B[1],K)]}return B},D)),T.length){var V="".concat(N,"1"),$="".concat(N,"2");D=T.reduce(function(B,F){if(F.props[E]===r&&im(F.props,"extendDomain")&&jr(F.props[V])&&jr(F.props[$])){var K=F.props[V],Y=F.props[$];return[Math.min(B[0],K,Y),Math.max(B[1],K,Y)]}return B},D)}return f&&f.length&&(D=f.reduce(function(B,F){return jr(F)?[Math.min(B[0],F),Math.max(B[1],F)]:B},D)),D},sk={exports:{}},l9;function c3e(){return l9||(l9=1,(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function c(w,T,E){this.fn=w,this.context=T,this.once=E||!1}function f(w,T,E,N,D){if(typeof E!="function")throw new TypeError("The listener must be a function");var V=new c(E,N||w,D),$=n?n+T:T;return w._events[$]?w._events[$].fn?w._events[$]=[w._events[$],V]:w._events[$].push(V):(w._events[$]=V,w._eventsCount++),w}function p(w,T){--w._eventsCount===0?w._events=new r:delete w._events[T]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var T=[],E,N;if(this._eventsCount===0)return T;for(N in E=this._events)t.call(E,N)&&T.push(n?N.slice(1):N);return Object.getOwnPropertySymbols?T.concat(Object.getOwnPropertySymbols(E)):T},s.prototype.listeners=function(T){var E=n?n+T:T,N=this._events[E];if(!N)return[];if(N.fn)return[N.fn];for(var D=0,V=N.length,$=new Array(V);D<V;D++)$[D]=N[D].fn;return $},s.prototype.listenerCount=function(T){var E=n?n+T:T,N=this._events[E];return N?N.fn?1:N.length:0},s.prototype.emit=function(T,E,N,D,V,$){var B=n?n+T:T;if(!this._events[B])return!1;var F=this._events[B],K=arguments.length,Y,X;if(F.fn){switch(F.once&&this.removeListener(T,F.fn,void 0,!0),K){case 1:return F.fn.call(F.context),!0;case 2:return F.fn.call(F.context,E),!0;case 3:return F.fn.call(F.context,E,N),!0;case 4:return F.fn.call(F.context,E,N,D),!0;case 5:return F.fn.call(F.context,E,N,D,V),!0;case 6:return F.fn.call(F.context,E,N,D,V,$),!0}for(X=1,Y=new Array(K-1);X<K;X++)Y[X-1]=arguments[X];F.fn.apply(F.context,Y)}else{var ae=F.length,Z;for(X=0;X<ae;X++)switch(F[X].once&&this.removeListener(T,F[X].fn,void 0,!0),K){case 1:F[X].fn.call(F[X].context);break;case 2:F[X].fn.call(F[X].context,E);break;case 3:F[X].fn.call(F[X].context,E,N);break;case 4:F[X].fn.call(F[X].context,E,N,D);break;default:if(!Y)for(Z=1,Y=new Array(K-1);Z<K;Z++)Y[Z-1]=arguments[Z];F[X].fn.apply(F[X].context,Y)}}return!0},s.prototype.on=function(T,E,N){return f(this,T,E,N,!1)},s.prototype.once=function(T,E,N){return f(this,T,E,N,!0)},s.prototype.removeListener=function(T,E,N,D){var V=n?n+T:T;if(!this._events[V])return this;if(!E)return p(this,V),this;var $=this._events[V];if($.fn)$.fn===E&&(!D||$.once)&&(!N||$.context===N)&&p(this,V);else{for(var B=0,F=[],K=$.length;B<K;B++)($[B].fn!==E||D&&!$[B].once||N&&$[B].context!==N)&&F.push($[B]);F.length?this._events[V]=F.length===1?F[0]:F:p(this,V)}return this},s.prototype.removeAllListeners=function(T){var E;return T?(E=n?n+T:T,this._events[E]&&p(this,E)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s})(sk)),sk.exports}var u3e=c3e();const d3e=Ca(u3e);var ak=new d3e,ok="recharts.syncMouseEvents";function VS(e){"@babel/helpers - typeof";return VS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},VS(e)}function h3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f3e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Pte(r.key),r)}}function p3e(e,t,n){return t&&f3e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function lk(e,t,n){return t=Pte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pte(e){var t=m3e(e,"string");return VS(t)=="symbol"?t:t+""}function m3e(e,t){if(VS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(VS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var g3e=(function(){function e(){h3e(this,e),lk(this,"activeIndex",0),lk(this,"coordinateList",[]),lk(this,"layout","horizontal")}return p3e(e,[{key:"setDetails",value:function(n){var r,c=n.coordinateList,f=c===void 0?null:c,p=n.container,s=p===void 0?null:p,w=n.layout,T=w===void 0?null:w,E=n.offset,N=E===void 0?null:E,D=n.mouseHandlerCallback,V=D===void 0?null:D;this.coordinateList=(r=f??this.coordinateList)!==null&&r!==void 0?r:[],this.container=s??this.container,this.layout=T??this.layout,this.offset=N??this.offset,this.mouseHandlerCallback=V??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,r;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var c=this.container.getBoundingClientRect(),f=c.x,p=c.y,s=c.height,w=this.coordinateList[this.activeIndex].coordinate,T=((n=window)===null||n===void 0?void 0:n.scrollX)||0,E=((r=window)===null||r===void 0?void 0:r.scrollY)||0,N=f+w+T,D=p+this.offset.top+s/2+E;this.mouseHandlerCallback({pageX:N,pageY:D})}}}])})();function y3e(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var r=e?.[0],c=e?.[1];if(r&&c&&jr(r)&&jr(c))return!0}return!1}function v3e(e,t,n,r){var c=r/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-c:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-c,width:e==="horizontal"?r:n.width-1,height:e==="horizontal"?n.height-1:r}}function Mte(e){var t=e.cx,n=e.cy,r=e.radius,c=e.startAngle,f=e.endAngle,p=bo(t,n,r,c),s=bo(t,n,r,f);return{points:[p,s],cx:t,cy:n,radius:r,startAngle:c,endAngle:f}}function x3e(e,t,n){var r,c,f,p;if(e==="horizontal")r=t.x,f=r,c=n.top,p=n.top+n.height;else if(e==="vertical")c=t.y,p=c,r=n.left,f=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var s=t.cx,w=t.cy,T=t.innerRadius,E=t.outerRadius,N=t.angle,D=bo(s,w,T,N),V=bo(s,w,E,N);r=D.x,c=D.y,f=V.x,p=V.y}else return Mte(t);return[{x:r,y:c},{x:f,y:p}]}function $S(e){"@babel/helpers - typeof";return $S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$S(e)}function c9(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function xA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?c9(Object(n),!0).forEach(function(r){_3e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c9(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _3e(e,t,n){return t=b3e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b3e(e){var t=w3e(e,"string");return $S(t)=="symbol"?t:t+""}function w3e(e,t){if($S(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if($S(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function S3e(e){var t,n,r=e.element,c=e.tooltipEventType,f=e.isActive,p=e.activeCoordinate,s=e.activePayload,w=e.offset,T=e.activeTooltipIndex,E=e.tooltipAxisBandSize,N=e.layout,D=e.chartName,V=(t=r.props.cursor)!==null&&t!==void 0?t:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!V||!f||!p||D!=="ScatterChart"&&c!=="axis")return null;var $,B=Zx;if(D==="ScatterChart")$=p,B=kOe;else if(D==="BarChart")$=v3e(N,p,w,E),B=dF;else if(N==="radial"){var F=Mte(p),K=F.cx,Y=F.cy,X=F.radius,ae=F.startAngle,Z=F.endAngle;$={cx:K,cy:Y,startAngle:ae,endAngle:Z,innerRadius:X,outerRadius:X},B=Cee}else $={points:x3e(N,p,w)},B=Zx;var se=xA(xA(xA(xA({stroke:"#ccc",pointerEvents:"none"},w),$),Oi(V,!1)),{},{payload:s,payloadIndex:T,className:es("recharts-tooltip-cursor",V.className)});return z.isValidElement(V)?z.cloneElement(V,se):z.createElement(B,se)}var T3e=["item"],A3e=["children","className","width","height","style","compact","title","desc"];function Sb(e){"@babel/helpers - typeof";return Sb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sb(e)}function k0(){return k0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},k0.apply(this,arguments)}function u9(e,t){return C3e(e)||E3e(e,t)||Ote(e,t)||j3e()}function j3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E3e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,c,f,p,s=[],w=!0,T=!1;try{if(f=(n=n.call(e)).next,t!==0)for(;!(w=(r=f.call(n)).done)&&(s.push(r.value),s.length!==t);w=!0);}catch(E){T=!0,c=E}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return s}}function C3e(e){if(Array.isArray(e))return e}function d9(e,t){if(e==null)return{};var n=N3e(e,t),r,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(c=0;c<f.length;c++)r=f[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function N3e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function P3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M3e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Dte(r.key),r)}}function R3e(e,t,n){return t&&M3e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function O3e(e,t,n){return t=fE(t),D3e(e,Rte()?Reflect.construct(t,n||[],fE(e).constructor):t.apply(e,n))}function D3e(e,t){if(t&&(Sb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return k3e(e)}function k3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Rte=function(){return!!e})()}function fE(e){return fE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},fE(e)}function I3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RL(e,t)}function RL(e,t){return RL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},RL(e,t)}function Tb(e){return F3e(e)||z3e(e)||Ote(e)||L3e()}function L3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ote(e,t){if(e){if(typeof e=="string")return OL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return OL(e,t)}}function z3e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function F3e(e){if(Array.isArray(e))return OL(e)}function OL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h9(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,r)}return n}function Un(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?h9(Object(n),!0).forEach(function(r){ss(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h9(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ss(e,t,n){return t=Dte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dte(e){var t=B3e(e,"string");return Sb(t)=="symbol"?t:t+""}function B3e(e,t){if(Sb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Sb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var U3e={xAxis:["bottom","top"],yAxis:["left","right"]},V3e={width:"100%",height:"100%"},kte={x:0,y:0};function _A(e){return e}var $3e=function(t,n){return n==="horizontal"?t.x:n==="vertical"?t.y:n==="centric"?t.angle:t.radius},q3e=function(t,n,r,c){var f=n.find(function(E){return E&&E.index===r});if(f){if(t==="horizontal")return{x:f.coordinate,y:c.y};if(t==="vertical")return{x:c.x,y:f.coordinate};if(t==="centric"){var p=f.coordinate,s=c.radius;return Un(Un(Un({},c),bo(c.cx,c.cy,s,p)),{},{angle:p,radius:s})}var w=f.coordinate,T=c.angle;return Un(Un(Un({},c),bo(c.cx,c.cy,w,T)),{},{angle:T,radius:w})}return kte},XC=function(t,n){var r=n.graphicalItems,c=n.dataStartIndex,f=n.dataEndIndex,p=(r??[]).reduce(function(s,w){var T=w.props.data;return T&&T.length?[].concat(Tb(s),Tb(T)):s},[]);return p.length>0?p:t&&t.length&&jr(c)&&jr(f)?t.slice(c,f+1):[]};function Ite(e){return e==="number"?[0,"auto"]:void 0}var DL=function(t,n,r,c){var f=t.graphicalItems,p=t.tooltipAxis,s=XC(n,t);return r<0||!f||!f.length||r>=s.length?null:f.reduce(function(w,T){var E,N=(E=T.props.data)!==null&&E!==void 0?E:n;N&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=r&&(N=N.slice(t.dataStartIndex,t.dataEndIndex+1));var D;if(p.dataKey&&!p.allowDuplicatedCategory){var V=N===void 0?s:N;D=mj(V,p.dataKey,c)}else D=N&&N[r]||s[r];return D?[].concat(Tb(w),[wee(T,D)]):w},[])},f9=function(t,n,r,c){var f=c||{x:t.chartX,y:t.chartY},p=$3e(f,r),s=t.orderedTooltipTicks,w=t.tooltipAxis,T=t.tooltipTicks,E=aPe(p,s,T,w);if(E>=0&&T){var N=T[E]&&T[E].value,D=DL(t,n,E,N),V=q3e(r,s,E,f);return{activeTooltipIndex:E,activeLabel:N,activePayload:D,activeCoordinate:V}}return null},H3e=function(t,n){var r=n.axes,c=n.graphicalItems,f=n.axisType,p=n.axisIdKey,s=n.stackGroups,w=n.dataStartIndex,T=n.dataEndIndex,E=t.layout,N=t.children,D=t.stackOffset,V=gee(E,f);return r.reduce(function($,B){var F,K=B.type.defaultProps!==void 0?Un(Un({},B.type.defaultProps),B.props):B.props,Y=K.type,X=K.dataKey,ae=K.allowDataOverflow,Z=K.allowDuplicatedCategory,se=K.scale,he=K.ticks,ye=K.includeHidden,Ce=K[p];if($[Ce])return $;var Ve=XC(t.data,{graphicalItems:c.filter(function(We){var Je,jt=p in We.props?We.props[p]:(Je=We.type.defaultProps)===null||Je===void 0?void 0:Je[p];return jt===Ce}),dataStartIndex:w,dataEndIndex:T}),Re=Ve.length,$e,nt,Me;y3e(K.domain,ae,Y)&&($e=WI(K.domain,null,ae),V&&(Y==="number"||se!=="auto")&&(Me=q1(Ve,X,"category")));var rt=Ite(Y);if(!$e||$e.length===0){var Ee,it=(Ee=K.domain)!==null&&Ee!==void 0?Ee:rt;if(X){if($e=q1(Ve,X,Y),Y==="category"&&V){var et=eSe($e);Z&&et?(nt=$e,$e=Qj(0,Re)):Z||($e=uG(it,$e,B).reduce(function(We,Je){return We.indexOf(Je)>=0?We:[].concat(Tb(We),[Je])},[]))}else if(Y==="category")Z?$e=$e.filter(function(We){return We!==""&&!xs(We)}):$e=uG(it,$e,B).reduce(function(We,Je){return We.indexOf(Je)>=0||Je===""||xs(Je)?We:[].concat(Tb(We),[Je])},[]);else if(Y==="number"){var mt=dPe(Ve,c.filter(function(We){var Je,jt,Pt=p in We.props?We.props[p]:(Je=We.type.defaultProps)===null||Je===void 0?void 0:Je[p],Ot="hide"in We.props?We.props.hide:(jt=We.type.defaultProps)===null||jt===void 0?void 0:jt.hide;return Pt===Ce&&(ye||!Ot)}),X,f,E);mt&&($e=mt)}V&&(Y==="number"||se!=="auto")&&(Me=q1(Ve,X,"category"))}else V?$e=Qj(0,Re):s&&s[Ce]&&s[Ce].hasStack&&Y==="number"?$e=D==="expand"?[0,1]:bee(s[Ce].stackGroups,w,T):$e=mee(Ve,c.filter(function(We){var Je=p in We.props?We.props[p]:We.type.defaultProps[p],jt="hide"in We.props?We.props.hide:We.type.defaultProps.hide;return Je===Ce&&(ye||!jt)}),Y,E,!0);if(Y==="number")$e=ML(N,$e,Ce,f,he),it&&($e=WI(it,$e,ae));else if(Y==="category"&&it){var He=it,pt=$e.every(function(We){return He.indexOf(We)>=0});pt&&($e=He)}}return Un(Un({},$),{},ss({},Ce,Un(Un({},K),{},{axisType:f,domain:$e,categoricalDomain:Me,duplicateDomain:nt,originalDomain:(F=K.domain)!==null&&F!==void 0?F:rt,isCategorical:V,layout:E})))},{})},G3e=function(t,n){var r=n.graphicalItems,c=n.Axis,f=n.axisType,p=n.axisIdKey,s=n.stackGroups,w=n.dataStartIndex,T=n.dataEndIndex,E=t.layout,N=t.children,D=XC(t.data,{graphicalItems:r,dataStartIndex:w,dataEndIndex:T}),V=D.length,$=gee(E,f),B=-1;return r.reduce(function(F,K){var Y=K.type.defaultProps!==void 0?Un(Un({},K.type.defaultProps),K.props):K.props,X=Y[p],ae=Ite("number");if(!F[X]){B++;var Z;return $?Z=Qj(0,V):s&&s[X]&&s[X].hasStack?(Z=bee(s[X].stackGroups,w,T),Z=ML(N,Z,X,f)):(Z=WI(ae,mee(D,r.filter(function(se){var he,ye,Ce=p in se.props?se.props[p]:(he=se.type.defaultProps)===null||he===void 0?void 0:he[p],Ve="hide"in se.props?se.props.hide:(ye=se.type.defaultProps)===null||ye===void 0?void 0:ye.hide;return Ce===X&&!Ve}),"number",E),c.defaultProps.allowDataOverflow),Z=ML(N,Z,X,f)),Un(Un({},F),{},ss({},X,Un(Un({axisType:f},c.defaultProps),{},{hide:!0,orientation:Zd(U3e,"".concat(f,".").concat(B%2),null),domain:Z,originalDomain:ae,isCategorical:$,layout:E})))}return F},{})},W3e=function(t,n){var r=n.axisType,c=r===void 0?"xAxis":r,f=n.AxisComp,p=n.graphicalItems,s=n.stackGroups,w=n.dataStartIndex,T=n.dataEndIndex,E=t.children,N="".concat(c,"Id"),D=Yd(E,f),V={};return D&&D.length?V=H3e(t,{axes:D,graphicalItems:p,axisType:c,axisIdKey:N,stackGroups:s,dataStartIndex:w,dataEndIndex:T}):p&&p.length&&(V=G3e(t,{Axis:f,graphicalItems:p,axisType:c,axisIdKey:N,stackGroups:s,dataStartIndex:w,dataEndIndex:T})),V},X3e=function(t){var n=Gy(t),r=yg(n,!1,!0);return{tooltipTicks:r,orderedTooltipTicks:Lz(r,function(c){return c.coordinate}),tooltipAxis:n,tooltipAxisBandSize:Uj(n,r)}},p9=function(t){var n=t.children,r=t.defaultShowTooltip,c=Vd(n,fb),f=0,p=0;return t.data&&t.data.length!==0&&(p=t.data.length-1),c&&c.props&&(c.props.startIndex>=0&&(f=c.props.startIndex),c.props.endIndex>=0&&(p=c.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:f,dataEndIndex:p,activeTooltipIndex:-1,isTooltipActive:!!r}},Z3e=function(t){return!t||!t.length?!1:t.some(function(n){var r=wg(n&&n.type);return r&&r.indexOf("Bar")>=0})},m9=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Y3e=function(t,n){var r=t.props,c=t.graphicalItems,f=t.xAxisMap,p=f===void 0?{}:f,s=t.yAxisMap,w=s===void 0?{}:s,T=r.width,E=r.height,N=r.children,D=r.margin||{},V=Vd(N,fb),$=Vd(N,Qy),B=Object.keys(w).reduce(function(Z,se){var he=w[se],ye=he.orientation;return!he.mirror&&!he.hide?Un(Un({},Z),{},ss({},ye,Z[ye]+he.width)):Z},{left:D.left||0,right:D.right||0}),F=Object.keys(p).reduce(function(Z,se){var he=p[se],ye=he.orientation;return!he.mirror&&!he.hide?Un(Un({},Z),{},ss({},ye,Zd(Z,"".concat(ye))+he.height)):Z},{top:D.top||0,bottom:D.bottom||0}),K=Un(Un({},F),B),Y=K.bottom;V&&(K.bottom+=V.props.height||fb.defaultProps.height),$&&n&&(K=cPe(K,c,r,n));var X=T-K.left-K.right,ae=E-K.top-K.bottom;return Un(Un({brushBottom:Y},K),{},{width:Math.max(X,0),height:Math.max(ae,0)})},K3e=function(t,n){if(n==="xAxis")return t[n].width;if(n==="yAxis")return t[n].height},wF=function(t){var n=t.chartName,r=t.GraphicalChild,c=t.defaultTooltipEventType,f=c===void 0?"axis":c,p=t.validateTooltipEventTypes,s=p===void 0?["axis"]:p,w=t.axisComponents,T=t.legendContent,E=t.formatAxisMap,N=t.defaultProps,D=function(K,Y){var X=Y.graphicalItems,ae=Y.stackGroups,Z=Y.offset,se=Y.updateId,he=Y.dataStartIndex,ye=Y.dataEndIndex,Ce=K.barSize,Ve=K.layout,Re=K.barGap,$e=K.barCategoryGap,nt=K.maxBarSize,Me=m9(Ve),rt=Me.numericAxisName,Ee=Me.cateAxisName,it=Z3e(X),et=[];return X.forEach(function(mt,He){var pt=XC(K.data,{graphicalItems:[mt],dataStartIndex:he,dataEndIndex:ye}),We=mt.type.defaultProps!==void 0?Un(Un({},mt.type.defaultProps),mt.props):mt.props,Je=We.dataKey,jt=We.maxBarSize,Pt=We["".concat(rt,"Id")],Ot=We["".concat(Ee,"Id")],Mt={},an=w.reduce(function(qt,rn){var Wn=Y["".concat(rn.axisType,"Map")],Vt=We["".concat(rn.axisType,"Id")];Wn&&Wn[Vt]||rn.axisType==="zAxis"||s_();var un=Wn[Vt];return Un(Un({},qt),{},ss(ss({},rn.axisType,un),"".concat(rn.axisType,"Ticks"),yg(un)))},Mt),Jt=an[Ee],Cn=an["".concat(Ee,"Ticks")],nr=ae&&ae[Pt]&&ae[Pt].hasStack&&_Pe(mt,ae[Pt].stackGroups),sn=wg(mt.type).indexOf("Bar")>=0,zr=Uj(Jt,Cn),or=[],Rr=it&&oPe({barSize:Ce,stackGroups:ae,totalSize:K3e(an,Ee)});if(sn){var qr,Nn,ci=xs(jt)?nt:jt,ui=(qr=(Nn=Uj(Jt,Cn,!0))!==null&&Nn!==void 0?Nn:ci)!==null&&qr!==void 0?qr:0;or=lPe({barGap:Re,barCategoryGap:$e,bandSize:ui!==zr?ui:zr,sizeList:Rr[Ot],maxBarSize:ci}),ui!==zr&&(or=or.map(function(qt){return Un(Un({},qt),{},{position:Un(Un({},qt.position),{},{offset:qt.position.offset-ui/2})})}))}var st=mt&&mt.type&&mt.type.getComposedData;st&&et.push({props:Un(Un({},st(Un(Un({},an),{},{displayedData:pt,props:K,dataKey:Je,item:mt,bandSize:zr,barPosition:or,offset:Z,stackedData:nr,layout:Ve,dataStartIndex:he,dataEndIndex:ye}))),{},ss(ss(ss({key:mt.key||"item-".concat(He)},rt,an[rt]),Ee,an[Ee]),"animationId",se)),childIndex:hSe(mt,K.children),item:mt})}),et},V=function(K,Y){var X=K.props,ae=K.dataStartIndex,Z=K.dataEndIndex,se=K.updateId;if(!A$({props:X}))return null;var he=X.children,ye=X.layout,Ce=X.stackOffset,Ve=X.data,Re=X.reverseStackOrder,$e=m9(ye),nt=$e.numericAxisName,Me=$e.cateAxisName,rt=Yd(he,r),Ee=vPe(Ve,rt,"".concat(nt,"Id"),"".concat(Me,"Id"),Ce,Re),it=w.reduce(function(We,Je){var jt="".concat(Je.axisType,"Map");return Un(Un({},We),{},ss({},jt,W3e(X,Un(Un({},Je),{},{graphicalItems:rt,stackGroups:Je.axisType===nt&&Ee,dataStartIndex:ae,dataEndIndex:Z}))))},{}),et=Y3e(Un(Un({},it),{},{props:X,graphicalItems:rt}),Y?.legendBBox);Object.keys(it).forEach(function(We){it[We]=E(X,it[We],et,We.replace("Map",""),n)});var mt=it["".concat(Me,"Map")],He=X3e(mt),pt=D(X,Un(Un({},it),{},{dataStartIndex:ae,dataEndIndex:Z,updateId:se,graphicalItems:rt,stackGroups:Ee,offset:et}));return Un(Un({formattedGraphicalItems:pt,graphicalItems:rt,offset:et,stackGroups:Ee},He),it)},$=(function(F){function K(Y){var X,ae,Z;return P3e(this,K),Z=O3e(this,K,[Y]),ss(Z,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),ss(Z,"accessibilityManager",new g3e),ss(Z,"handleLegendBBoxUpdate",function(se){if(se){var he=Z.state,ye=he.dataStartIndex,Ce=he.dataEndIndex,Ve=he.updateId;Z.setState(Un({legendBBox:se},V({props:Z.props,dataStartIndex:ye,dataEndIndex:Ce,updateId:Ve},Un(Un({},Z.state),{},{legendBBox:se}))))}}),ss(Z,"handleReceiveSyncEvent",function(se,he,ye){if(Z.props.syncId===se){if(ye===Z.eventEmitterSymbol&&typeof Z.props.syncMethod!="function")return;Z.applySyncEvent(he)}}),ss(Z,"handleBrushChange",function(se){var he=se.startIndex,ye=se.endIndex;if(he!==Z.state.dataStartIndex||ye!==Z.state.dataEndIndex){var Ce=Z.state.updateId;Z.setState(function(){return Un({dataStartIndex:he,dataEndIndex:ye},V({props:Z.props,dataStartIndex:he,dataEndIndex:ye,updateId:Ce},Z.state))}),Z.triggerSyncEvent({dataStartIndex:he,dataEndIndex:ye})}}),ss(Z,"handleMouseEnter",function(se){var he=Z.getMouseInfo(se);if(he){var ye=Un(Un({},he),{},{isTooltipActive:!0});Z.setState(ye),Z.triggerSyncEvent(ye);var Ce=Z.props.onMouseEnter;as(Ce)&&Ce(ye,se)}}),ss(Z,"triggeredAfterMouseMove",function(se){var he=Z.getMouseInfo(se),ye=he?Un(Un({},he),{},{isTooltipActive:!0}):{isTooltipActive:!1};Z.setState(ye),Z.triggerSyncEvent(ye);var Ce=Z.props.onMouseMove;as(Ce)&&Ce(ye,se)}),ss(Z,"handleItemMouseEnter",function(se){Z.setState(function(){return{isTooltipActive:!0,activeItem:se,activePayload:se.tooltipPayload,activeCoordinate:se.tooltipPosition||{x:se.cx,y:se.cy}}})}),ss(Z,"handleItemMouseLeave",function(){Z.setState(function(){return{isTooltipActive:!1}})}),ss(Z,"handleMouseMove",function(se){se.persist(),Z.throttleTriggeredAfterMouseMove(se)}),ss(Z,"handleMouseLeave",function(se){Z.throttleTriggeredAfterMouseMove.cancel();var he={isTooltipActive:!1};Z.setState(he),Z.triggerSyncEvent(he);var ye=Z.props.onMouseLeave;as(ye)&&ye(he,se)}),ss(Z,"handleOuterEvent",function(se){var he=dSe(se),ye=Zd(Z.props,"".concat(he));if(he&&as(ye)){var Ce,Ve;/.*touch.*/i.test(he)?Ve=Z.getMouseInfo(se.changedTouches[0]):Ve=Z.getMouseInfo(se),ye((Ce=Ve)!==null&&Ce!==void 0?Ce:{},se)}}),ss(Z,"handleClick",function(se){var he=Z.getMouseInfo(se);if(he){var ye=Un(Un({},he),{},{isTooltipActive:!0});Z.setState(ye),Z.triggerSyncEvent(ye);var Ce=Z.props.onClick;as(Ce)&&Ce(ye,se)}}),ss(Z,"handleMouseDown",function(se){var he=Z.props.onMouseDown;if(as(he)){var ye=Z.getMouseInfo(se);he(ye,se)}}),ss(Z,"handleMouseUp",function(se){var he=Z.props.onMouseUp;if(as(he)){var ye=Z.getMouseInfo(se);he(ye,se)}}),ss(Z,"handleTouchMove",function(se){se.changedTouches!=null&&se.changedTouches.length>0&&Z.throttleTriggeredAfterMouseMove(se.changedTouches[0])}),ss(Z,"handleTouchStart",function(se){se.changedTouches!=null&&se.changedTouches.length>0&&Z.handleMouseDown(se.changedTouches[0])}),ss(Z,"handleTouchEnd",function(se){se.changedTouches!=null&&se.changedTouches.length>0&&Z.handleMouseUp(se.changedTouches[0])}),ss(Z,"handleDoubleClick",function(se){var he=Z.props.onDoubleClick;if(as(he)){var ye=Z.getMouseInfo(se);he(ye,se)}}),ss(Z,"handleContextMenu",function(se){var he=Z.props.onContextMenu;if(as(he)){var ye=Z.getMouseInfo(se);he(ye,se)}}),ss(Z,"triggerSyncEvent",function(se){Z.props.syncId!==void 0&&ak.emit(ok,Z.props.syncId,se,Z.eventEmitterSymbol)}),ss(Z,"applySyncEvent",function(se){var he=Z.props,ye=he.layout,Ce=he.syncMethod,Ve=Z.state.updateId,Re=se.dataStartIndex,$e=se.dataEndIndex;if(se.dataStartIndex!==void 0||se.dataEndIndex!==void 0)Z.setState(Un({dataStartIndex:Re,dataEndIndex:$e},V({props:Z.props,dataStartIndex:Re,dataEndIndex:$e,updateId:Ve},Z.state)));else if(se.activeTooltipIndex!==void 0){var nt=se.chartX,Me=se.chartY,rt=se.activeTooltipIndex,Ee=Z.state,it=Ee.offset,et=Ee.tooltipTicks;if(!it)return;if(typeof Ce=="function")rt=Ce(et,se);else if(Ce==="value"){rt=-1;for(var mt=0;mt<et.length;mt++)if(et[mt].value===se.activeLabel){rt=mt;break}}var He=Un(Un({},it),{},{x:it.left,y:it.top}),pt=Math.min(nt,He.x+He.width),We=Math.min(Me,He.y+He.height),Je=et[rt]&&et[rt].value,jt=DL(Z.state,Z.props.data,rt),Pt=et[rt]?{x:ye==="horizontal"?et[rt].coordinate:pt,y:ye==="horizontal"?We:et[rt].coordinate}:kte;Z.setState(Un(Un({},se),{},{activeLabel:Je,activeCoordinate:Pt,activePayload:jt,activeTooltipIndex:rt}))}else Z.setState(se)}),ss(Z,"renderCursor",function(se){var he,ye=Z.state,Ce=ye.isTooltipActive,Ve=ye.activeCoordinate,Re=ye.activePayload,$e=ye.offset,nt=ye.activeTooltipIndex,Me=ye.tooltipAxisBandSize,rt=Z.getTooltipEventType(),Ee=(he=se.props.active)!==null&&he!==void 0?he:Ce,it=Z.props.layout,et=se.key||"_recharts-cursor";return _e.createElement(S3e,{key:et,activeCoordinate:Ve,activePayload:Re,activeTooltipIndex:nt,chartName:n,element:se,isActive:Ee,layout:it,offset:$e,tooltipAxisBandSize:Me,tooltipEventType:rt})}),ss(Z,"renderPolarAxis",function(se,he,ye){var Ce=Zd(se,"type.axisType"),Ve=Zd(Z.state,"".concat(Ce,"Map")),Re=se.type.defaultProps,$e=Re!==void 0?Un(Un({},Re),se.props):se.props,nt=Ve&&Ve[$e["".concat(Ce,"Id")]];return z.cloneElement(se,Un(Un({},nt),{},{className:es(Ce,nt.className),key:se.key||"".concat(he,"-").concat(ye),ticks:yg(nt,!0)}))}),ss(Z,"renderPolarGrid",function(se){var he=se.props,ye=he.radialLines,Ce=he.polarAngles,Ve=he.polarRadius,Re=Z.state,$e=Re.radiusAxisMap,nt=Re.angleAxisMap,Me=Gy($e),rt=Gy(nt),Ee=rt.cx,it=rt.cy,et=rt.innerRadius,mt=rt.outerRadius;return z.cloneElement(se,{polarAngles:Array.isArray(Ce)?Ce:yg(rt,!0).map(function(He){return He.coordinate}),polarRadius:Array.isArray(Ve)?Ve:yg(Me,!0).map(function(He){return He.coordinate}),cx:Ee,cy:it,innerRadius:et,outerRadius:mt,key:se.key||"polar-grid",radialLines:ye})}),ss(Z,"renderLegend",function(){var se=Z.state.formattedGraphicalItems,he=Z.props,ye=he.children,Ce=he.width,Ve=he.height,Re=Z.props.margin||{},$e=Ce-(Re.left||0)-(Re.right||0),nt=fee({children:ye,formattedGraphicalItems:se,legendWidth:$e,legendContent:T});if(!nt)return null;var Me=nt.item,rt=d9(nt,T3e);return z.cloneElement(Me,Un(Un({},rt),{},{chartWidth:Ce,chartHeight:Ve,margin:Re,onBBoxUpdate:Z.handleLegendBBoxUpdate}))}),ss(Z,"renderTooltip",function(){var se,he=Z.props,ye=he.children,Ce=he.accessibilityLayer,Ve=Vd(ye,Dh);if(!Ve)return null;var Re=Z.state,$e=Re.isTooltipActive,nt=Re.activeCoordinate,Me=Re.activePayload,rt=Re.activeLabel,Ee=Re.offset,it=(se=Ve.props.active)!==null&&se!==void 0?se:$e;return z.cloneElement(Ve,{viewBox:Un(Un({},Ee),{},{x:Ee.left,y:Ee.top}),active:it,label:rt,payload:it?Me:[],coordinate:nt,accessibilityLayer:Ce})}),ss(Z,"renderBrush",function(se){var he=Z.props,ye=he.margin,Ce=he.data,Ve=Z.state,Re=Ve.offset,$e=Ve.dataStartIndex,nt=Ve.dataEndIndex,Me=Ve.updateId;return z.cloneElement(se,{key:se.key||"_recharts-brush",onChange:mA(Z.handleBrushChange,se.props.onChange),data:Ce,x:jr(se.props.x)?se.props.x:Re.left,y:jr(se.props.y)?se.props.y:Re.top+Re.height+Re.brushBottom-(ye.bottom||0),width:jr(se.props.width)?se.props.width:Re.width,startIndex:$e,endIndex:nt,updateId:"brush-".concat(Me)})}),ss(Z,"renderReferenceElement",function(se,he,ye){if(!se)return null;var Ce=Z,Ve=Ce.clipPathId,Re=Z.state,$e=Re.xAxisMap,nt=Re.yAxisMap,Me=Re.offset,rt=se.type.defaultProps||{},Ee=se.props,it=Ee.xAxisId,et=it===void 0?rt.xAxisId:it,mt=Ee.yAxisId,He=mt===void 0?rt.yAxisId:mt;return z.cloneElement(se,{key:se.key||"".concat(he,"-").concat(ye),xAxis:$e[et],yAxis:nt[He],viewBox:{x:Me.left,y:Me.top,width:Me.width,height:Me.height},clipPathId:Ve})}),ss(Z,"renderActivePoints",function(se){var he=se.item,ye=se.activePoint,Ce=se.basePoint,Ve=se.childIndex,Re=se.isRange,$e=[],nt=he.props.key,Me=he.item.type.defaultProps!==void 0?Un(Un({},he.item.type.defaultProps),he.item.props):he.item.props,rt=Me.activeDot,Ee=Me.dataKey,it=Un(Un({index:Ve,dataKey:Ee,cx:ye.x,cy:ye.y,r:4,fill:uF(he.item),strokeWidth:2,stroke:"#fff",payload:ye.payload,value:ye.value},Oi(rt,!1)),gj(rt));return $e.push(K.renderActiveDot(rt,it,"".concat(nt,"-activePoint-").concat(Ve))),Ce?$e.push(K.renderActiveDot(rt,Un(Un({},it),{},{cx:Ce.x,cy:Ce.y}),"".concat(nt,"-basePoint-").concat(Ve))):Re&&$e.push(null),$e}),ss(Z,"renderGraphicChild",function(se,he,ye){var Ce=Z.filterFormatItem(se,he,ye);if(!Ce)return null;var Ve=Z.getTooltipEventType(),Re=Z.state,$e=Re.isTooltipActive,nt=Re.tooltipAxis,Me=Re.activeTooltipIndex,rt=Re.activeLabel,Ee=Z.props.children,it=Vd(Ee,Dh),et=Ce.props,mt=et.points,He=et.isRange,pt=et.baseLine,We=Ce.item.type.defaultProps!==void 0?Un(Un({},Ce.item.type.defaultProps),Ce.item.props):Ce.item.props,Je=We.activeDot,jt=We.hide,Pt=We.activeBar,Ot=We.activeShape,Mt=!!(!jt&&$e&&it&&(Je||Pt||Ot)),an={};Ve!=="axis"&&it&&it.props.trigger==="click"?an={onClick:mA(Z.handleItemMouseEnter,se.props.onClick)}:Ve!=="axis"&&(an={onMouseLeave:mA(Z.handleItemMouseLeave,se.props.onMouseLeave),onMouseEnter:mA(Z.handleItemMouseEnter,se.props.onMouseEnter)});var Jt=z.cloneElement(se,Un(Un({},Ce.props),an));function Cn(rn){return typeof nt.dataKey=="function"?nt.dataKey(rn.payload):null}if(Mt)if(Me>=0){var nr,sn;if(nt.dataKey&&!nt.allowDuplicatedCategory){var zr=typeof nt.dataKey=="function"?Cn:"payload.".concat(nt.dataKey.toString());nr=mj(mt,zr,rt),sn=He&&pt&&mj(pt,zr,rt)}else nr=mt?.[Me],sn=He&&pt&&pt[Me];if(Ot||Pt){var or=se.props.activeIndex!==void 0?se.props.activeIndex:Me;return[z.cloneElement(se,Un(Un(Un({},Ce.props),an),{},{activeIndex:or})),null,null]}if(!xs(nr))return[Jt].concat(Tb(Z.renderActivePoints({item:Ce,activePoint:nr,basePoint:sn,childIndex:Me,isRange:He})))}else{var Rr,qr=(Rr=Z.getItemByXY(Z.state.activeCoordinate))!==null&&Rr!==void 0?Rr:{graphicalItem:Jt},Nn=qr.graphicalItem,ci=Nn.item,ui=ci===void 0?se:ci,st=Nn.childIndex,qt=Un(Un(Un({},Ce.props),an),{},{activeIndex:st});return[z.cloneElement(ui,qt),null,null]}return He?[Jt,null,null]:[Jt,null]}),ss(Z,"renderCustomized",function(se,he,ye){return z.cloneElement(se,Un(Un({key:"recharts-customized-".concat(ye)},Z.props),Z.state))}),ss(Z,"renderMap",{CartesianGrid:{handler:_A,once:!0},ReferenceArea:{handler:Z.renderReferenceElement},ReferenceLine:{handler:_A},ReferenceDot:{handler:Z.renderReferenceElement},XAxis:{handler:_A},YAxis:{handler:_A},Brush:{handler:Z.renderBrush,once:!0},Bar:{handler:Z.renderGraphicChild},Line:{handler:Z.renderGraphicChild},Area:{handler:Z.renderGraphicChild},Radar:{handler:Z.renderGraphicChild},RadialBar:{handler:Z.renderGraphicChild},Scatter:{handler:Z.renderGraphicChild},Pie:{handler:Z.renderGraphicChild},Funnel:{handler:Z.renderGraphicChild},Tooltip:{handler:Z.renderCursor,once:!0},PolarGrid:{handler:Z.renderPolarGrid,once:!0},PolarAngleAxis:{handler:Z.renderPolarAxis},PolarRadiusAxis:{handler:Z.renderPolarAxis},Customized:{handler:Z.renderCustomized}}),Z.clipPathId="".concat((X=Y.id)!==null&&X!==void 0?X:m_("recharts"),"-clip"),Z.throttleTriggeredAfterMouseMove=hQ(Z.triggeredAfterMouseMove,(ae=Y.throttleDelay)!==null&&ae!==void 0?ae:1e3/60),Z.state={},Z}return I3e(K,F),R3e(K,[{key:"componentDidMount",value:function(){var X,ae;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(X=this.props.margin.left)!==null&&X!==void 0?X:0,top:(ae=this.props.margin.top)!==null&&ae!==void 0?ae:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var X=this.props,ae=X.children,Z=X.data,se=X.height,he=X.layout,ye=Vd(ae,Dh);if(ye){var Ce=ye.props.defaultIndex;if(!(typeof Ce!="number"||Ce<0||Ce>this.state.tooltipTicks.length-1)){var Ve=this.state.tooltipTicks[Ce]&&this.state.tooltipTicks[Ce].value,Re=DL(this.state,Z,Ce,Ve),$e=this.state.tooltipTicks[Ce].coordinate,nt=(this.state.offset.top+se)/2,Me=he==="horizontal",rt=Me?{x:$e,y:nt}:{y:$e,x:nt},Ee=this.state.formattedGraphicalItems.find(function(et){var mt=et.item;return mt.type.name==="Scatter"});Ee&&(rt=Un(Un({},rt),Ee.props.points[Ce].tooltipPosition),Re=Ee.props.points[Ce].tooltipPayload);var it={activeTooltipIndex:Ce,isTooltipActive:!0,activeLabel:Ve,activePayload:Re,activeCoordinate:rt};this.setState(it),this.renderCursor(ye),this.accessibilityManager.setIndex(Ce)}}}},{key:"getSnapshotBeforeUpdate",value:function(X,ae){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==ae.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==X.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==X.margin){var Z,se;this.accessibilityManager.setDetails({offset:{left:(Z=this.props.margin.left)!==null&&Z!==void 0?Z:0,top:(se=this.props.margin.top)!==null&&se!==void 0?se:0}})}return null}},{key:"componentDidUpdate",value:function(X){mI([Vd(X.children,Dh)],[Vd(this.props.children,Dh)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var X=Vd(this.props.children,Dh);if(X&&typeof X.props.shared=="boolean"){var ae=X.props.shared?"axis":"item";return s.indexOf(ae)>=0?ae:f}return f}},{key:"getMouseInfo",value:function(X){if(!this.container)return null;var ae=this.container,Z=ae.getBoundingClientRect(),se=JAe(Z),he={chartX:Math.round(X.pageX-se.left),chartY:Math.round(X.pageY-se.top)},ye=Z.width/ae.offsetWidth||1,Ce=this.inRange(he.chartX,he.chartY,ye);if(!Ce)return null;var Ve=this.state,Re=Ve.xAxisMap,$e=Ve.yAxisMap,nt=this.getTooltipEventType(),Me=f9(this.state,this.props.data,this.props.layout,Ce);if(nt!=="axis"&&Re&&$e){var rt=Gy(Re).scale,Ee=Gy($e).scale,it=rt&&rt.invert?rt.invert(he.chartX):null,et=Ee&&Ee.invert?Ee.invert(he.chartY):null;return Un(Un({},he),{},{xValue:it,yValue:et},Me)}return Me?Un(Un({},he),Me):null}},{key:"inRange",value:function(X,ae){var Z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,se=this.props.layout,he=X/Z,ye=ae/Z;if(se==="horizontal"||se==="vertical"){var Ce=this.state.offset,Ve=he>=Ce.left&&he<=Ce.left+Ce.width&&ye>=Ce.top&&ye<=Ce.top+Ce.height;return Ve?{x:he,y:ye}:null}var Re=this.state,$e=Re.angleAxisMap,nt=Re.radiusAxisMap;if($e&&nt){var Me=Gy($e);return fG({x:he,y:ye},Me)}return null}},{key:"parseEventsOfWrapper",value:function(){var X=this.props.children,ae=this.getTooltipEventType(),Z=Vd(X,Dh),se={};Z&&ae==="axis"&&(Z.props.trigger==="click"?se={onClick:this.handleClick}:se={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var he=gj(this.props,this.handleOuterEvent);return Un(Un({},he),se)}},{key:"addListener",value:function(){ak.on(ok,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){ak.removeListener(ok,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(X,ae,Z){for(var se=this.state.formattedGraphicalItems,he=0,ye=se.length;he<ye;he++){var Ce=se[he];if(Ce.item===X||Ce.props.key===X.key||ae===wg(Ce.item.type)&&Z===Ce.childIndex)return Ce}return null}},{key:"renderClipPath",value:function(){var X=this.clipPathId,ae=this.state.offset,Z=ae.left,se=ae.top,he=ae.height,ye=ae.width;return _e.createElement("defs",null,_e.createElement("clipPath",{id:X},_e.createElement("rect",{x:Z,y:se,height:he,width:ye})))}},{key:"getXScales",value:function(){var X=this.state.xAxisMap;return X?Object.entries(X).reduce(function(ae,Z){var se=u9(Z,2),he=se[0],ye=se[1];return Un(Un({},ae),{},ss({},he,ye.scale))},{}):null}},{key:"getYScales",value:function(){var X=this.state.yAxisMap;return X?Object.entries(X).reduce(function(ae,Z){var se=u9(Z,2),he=se[0],ye=se[1];return Un(Un({},ae),{},ss({},he,ye.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(X){var ae;return(ae=this.state.xAxisMap)===null||ae===void 0||(ae=ae[X])===null||ae===void 0?void 0:ae.scale}},{key:"getYScaleByAxisId",value:function(X){var ae;return(ae=this.state.yAxisMap)===null||ae===void 0||(ae=ae[X])===null||ae===void 0?void 0:ae.scale}},{key:"getItemByXY",value:function(X){var ae=this.state,Z=ae.formattedGraphicalItems,se=ae.activeItem;if(Z&&Z.length)for(var he=0,ye=Z.length;he<ye;he++){var Ce=Z[he],Ve=Ce.props,Re=Ce.item,$e=Re.type.defaultProps!==void 0?Un(Un({},Re.type.defaultProps),Re.props):Re.props,nt=wg(Re.type);if(nt==="Bar"){var Me=(Ve.data||[]).find(function(et){return mOe(X,et)});if(Me)return{graphicalItem:Ce,payload:Me}}else if(nt==="RadialBar"){var rt=(Ve.data||[]).find(function(et){return fG(X,et)});if(rt)return{graphicalItem:Ce,payload:rt}}else if(UC(Ce,se)||VC(Ce,se)||LS(Ce,se)){var Ee=zDe({graphicalItem:Ce,activeTooltipItem:se,itemData:$e.data}),it=$e.activeIndex===void 0?Ee:$e.activeIndex;return{graphicalItem:Un(Un({},Ce),{},{childIndex:it}),payload:LS(Ce,se)?$e.data[Ee]:Ce.props.data[Ee]}}}return null}},{key:"render",value:function(){var X=this;if(!A$(this))return null;var ae=this.props,Z=ae.children,se=ae.className,he=ae.width,ye=ae.height,Ce=ae.style,Ve=ae.compact,Re=ae.title,$e=ae.desc,nt=d9(ae,A3e),Me=Oi(nt,!1);if(Ve)return _e.createElement($7,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},_e.createElement(yI,k0({},Me,{width:he,height:ye,title:Re,desc:$e}),this.renderClipPath(),E$(Z,this.renderMap)));if(this.props.accessibilityLayer){var rt,Ee;Me.tabIndex=(rt=this.props.tabIndex)!==null&&rt!==void 0?rt:0,Me.role=(Ee=this.props.role)!==null&&Ee!==void 0?Ee:"application",Me.onKeyDown=function(et){X.accessibilityManager.keyboardEvent(et)},Me.onFocus=function(){X.accessibilityManager.focus()}}var it=this.parseEventsOfWrapper();return _e.createElement($7,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},_e.createElement("div",k0({className:es("recharts-wrapper",se),style:Un({position:"relative",cursor:"default",width:he,height:ye},Ce)},it,{ref:function(mt){X.container=mt}}),_e.createElement(yI,k0({},Me,{width:he,height:ye,title:Re,desc:$e,style:V3e}),this.renderClipPath(),E$(Z,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])})(z.Component);ss($,"displayName",n),ss($,"defaultProps",Un({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},N)),ss($,"getDerivedStateFromProps",function(F,K){var Y=F.dataKey,X=F.data,ae=F.children,Z=F.width,se=F.height,he=F.layout,ye=F.stackOffset,Ce=F.margin,Ve=K.dataStartIndex,Re=K.dataEndIndex;if(K.updateId===void 0){var $e=p9(F);return Un(Un(Un({},$e),{},{updateId:0},V(Un(Un({props:F},$e),{},{updateId:0}),K)),{},{prevDataKey:Y,prevData:X,prevWidth:Z,prevHeight:se,prevLayout:he,prevStackOffset:ye,prevMargin:Ce,prevChildren:ae})}if(Y!==K.prevDataKey||X!==K.prevData||Z!==K.prevWidth||se!==K.prevHeight||he!==K.prevLayout||ye!==K.prevStackOffset||!V0(Ce,K.prevMargin)){var nt=p9(F),Me={chartX:K.chartX,chartY:K.chartY,isTooltipActive:K.isTooltipActive},rt=Un(Un({},f9(K,X,he)),{},{updateId:K.updateId+1}),Ee=Un(Un(Un({},nt),Me),rt);return Un(Un(Un({},Ee),V(Un({props:F},Ee),K)),{},{prevDataKey:Y,prevData:X,prevWidth:Z,prevHeight:se,prevLayout:he,prevStackOffset:ye,prevMargin:Ce,prevChildren:ae})}if(!mI(ae,K.prevChildren)){var it,et,mt,He,pt=Vd(ae,fb),We=pt&&(it=(et=pt.props)===null||et===void 0?void 0:et.startIndex)!==null&&it!==void 0?it:Ve,Je=pt&&(mt=(He=pt.props)===null||He===void 0?void 0:He.endIndex)!==null&&mt!==void 0?mt:Re,jt=We!==Ve||Je!==Re,Pt=!xs(X),Ot=Pt&&!jt?K.updateId:K.updateId+1;return Un(Un({updateId:Ot},V(Un(Un({props:F},K),{},{updateId:Ot,dataStartIndex:We,dataEndIndex:Je}),K)),{},{prevChildren:ae,dataStartIndex:We,dataEndIndex:Je})}return null}),ss($,"renderActiveDot",function(F,K,Y){var X;return z.isValidElement(F)?X=z.cloneElement(F,K):as(F)?X=F(K):X=_e.createElement(ET,K),_e.createElement(sa,{className:"recharts-active-dot",key:Y},X)});var B=z.forwardRef(function(K,Y){return _e.createElement($,k0({},K,{ref:Y}))});return B.displayName=$.displayName,B},J3e=wF({chartName:"LineChart",GraphicalChild:Ky,axisComponents:[{axisType:"xAxis",AxisComp:Zb},{axisType:"yAxis",AxisComp:NT}],formatAxisMap:Jee}),Q3e=wF({chartName:"PieChart",GraphicalChild:Lg,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:BC},{axisType:"radiusAxis",AxisComp:zC}],formatAxisMap:PPe,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),eze=wF({chartName:"AreaChart",GraphicalChild:vv,axisComponents:[{axisType:"xAxis",AxisComp:Zb},{axisType:"yAxis",AxisComp:NT}],formatAxisMap:Jee});const tze=[{label:"Competency",value:82,icon:GW,color:"#6366f1",link:"/hr2/cms"},{label:"Learning",value:67,icon:EA,color:"#10b981",link:"/hr2/lms"},{label:"Training",value:74,icon:Ek,color:"#f59e42",link:"/hr2/tms"},{label:"Succession",value:59,icon:CA,color:"#f43f5e",link:"/hr2/sps"}],g9=[{name:"Completed",value:320},{name:"In Progress",value:120},{name:"Pending",value:60}],y9=["#10b981","#6366f1","#f59e42"];function nze(){return o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Dashboard"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:tze.map(e=>o.jsx(Yl,{to:e.link,className:"group",children:o.jsxs(ni,{className:"shadow-sm transition-transform group-hover:scale-105 group-hover:shadow-lg cursor-pointer",children:[o.jsxs(Ns,{className:"flex flex-row items-center gap-3 pb-2",children:[o.jsx(e.icon,{className:"size-6",style:{color:e.color}}),o.jsx(us,{className:"text-lg font-semibold text-gray-700",children:e.label})]}),o.jsxs(qi,{children:[o.jsxs("div",{className:"text-3xl font-bold text-gray-900",children:[e.value,"%"]}),o.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Avg. Completion"})]})]})},e.label))}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-8",children:[o.jsxs(ni,{className:"shadow-sm",children:[o.jsx(Ns,{children:o.jsx(us,{children:"Learning Progress Overview"})}),o.jsx(qi,{children:o.jsx(Fz,{width:"100%",height:250,children:o.jsxs(Q3e,{children:[o.jsx(Lg,{data:g9,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,label:!0,children:g9.map((e,t)=>o.jsx(jC,{fill:y9[t%y9.length]},`cell-${t}`))}),o.jsx(Dh,{}),o.jsx(Qy,{})]})})})]}),o.jsxs(ni,{className:"shadow-sm",children:[o.jsx(Ns,{children:o.jsx(us,{children:"Reserved"})}),o.jsx(qi,{children:o.jsx("div",{className:"flex flex-col gap-3",children:o.jsx("a",{children:"111 222 333"})})})]})]})]})}const rze=c3("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function _i({className:e,variant:t,asChild:n=!1,...r}){const c=n?rT:"span";return o.jsx(c,{"data-slot":"badge",className:Rn(rze({variant:t}),e),...r})}var SF="Progress",TF=100,[ize,y$e]=Eu(SF),[sze,aze]=ize(SF),Lte=z.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:c,getValueLabel:f=oze,...p}=e;(c||c===0)&&!v9(c)&&console.error(lze(`${c}`,"Progress"));const s=v9(c)?c:TF;r!==null&&!x9(r,s)&&console.error(cze(`${r}`,"Progress"));const w=x9(r,s)?r:null,T=pE(w)?f(w,s):void 0;return o.jsx(sze,{scope:n,value:w,max:s,children:o.jsx(Si.div,{"aria-valuemax":s,"aria-valuemin":0,"aria-valuenow":pE(w)?w:void 0,"aria-valuetext":T,role:"progressbar","data-state":Bte(w,s),"data-value":w??void 0,"data-max":s,...p,ref:t})})});Lte.displayName=SF;var zte="ProgressIndicator",Fte=z.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,c=aze(zte,n);return o.jsx(Si.div,{"data-state":Bte(c.value,c.max),"data-value":c.value??void 0,"data-max":c.max,...r,ref:t})});Fte.displayName=zte;function oze(e,t){return`${Math.round(e/t*100)}%`}function Bte(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function pE(e){return typeof e=="number"}function v9(e){return pE(e)&&!isNaN(e)&&e>0}function x9(e,t){return pE(e)&&!isNaN(e)&&e<=t&&e>=0}function lze(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${TF}\`.`}function cze(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${TF} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Ute=Lte,uze=Fte;const Df=z.forwardRef(({className:e,value:t,...n},r)=>o.jsx(Ute,{ref:r,className:Rn("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...n,children:o.jsx(uze,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Df.displayName=Ute.displayName;function ds({...e}){return o.jsx(qE,{"data-slot":"dialog",...e})}function kf({...e}){return o.jsx(VX,{"data-slot":"dialog-trigger",...e})}function dze({...e}){return o.jsx(HE,{"data-slot":"dialog-portal",...e})}function hze({...e}){return o.jsx(aT,{"data-slot":"dialog-close",...e})}function fze({className:e,...t}){return o.jsx(GE,{"data-slot":"dialog-overlay",className:Rn("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function gs({className:e,children:t,showCloseButton:n=!0,...r}){return o.jsxs(dze,{"data-slot":"dialog-portal",children:[o.jsx(fze,{}),o.jsxs(WE,{"data-slot":"dialog-content",className:Rn("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...r,children:[t,n&&o.jsxs(aT,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[o.jsx(bg,{}),o.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function ys({className:e,...t}){return o.jsx("div",{"data-slot":"dialog-header",className:Rn("flex flex-col gap-2 text-center sm:text-left",e),...t})}function Co({className:e,...t}){return o.jsx("div",{"data-slot":"dialog-footer",className:Rn("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function vs({className:e,...t}){return o.jsx(p3,{"data-slot":"dialog-title",className:Rn("text-lg leading-none font-semibold",e),...t})}function Cc({className:e,...t}){return o.jsx(m3,{"data-slot":"dialog-description",className:Rn("text-muted-foreground text-sm",e),...t})}function _9(e,[t,n]){return Math.min(n,Math.max(t,e))}function pze(e){const t=z.useRef({value:e,previous:e});return z.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var mze=[" ","Enter","ArrowUp","ArrowDown"],gze=[" ","Enter"],o_="Select",[ZC,YC,yze]=nC(o_),[Yb,v$e]=Eu(o_,[yze,uv]),KC=uv(),[vze,xv]=Yb(o_),[xze,_ze]=Yb(o_),Vte=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:c,onOpenChange:f,value:p,defaultValue:s,onValueChange:w,dir:T,name:E,autoComplete:N,disabled:D,required:V,form:$}=e,B=KC(t),[F,K]=z.useState(null),[Y,X]=z.useState(null),[ae,Z]=z.useState(!1),se=dT(T),[he,ye]=zf({prop:r,defaultProp:c??!1,onChange:f,caller:o_}),[Ce,Ve]=zf({prop:p,defaultProp:s,onChange:w,caller:o_}),Re=z.useRef(null),$e=F?$||!!F.closest("form"):!0,[nt,Me]=z.useState(new Set),rt=Array.from(nt).map(Ee=>Ee.props.value).join(";");return o.jsx(KE,{...B,children:o.jsxs(vze,{required:V,scope:t,trigger:F,onTriggerChange:K,valueNode:Y,onValueNodeChange:X,valueNodeHasChildren:ae,onValueNodeHasChildrenChange:Z,contentId:Ml(),value:Ce,onValueChange:Ve,open:he,onOpenChange:ye,dir:se,triggerPointerDownPosRef:Re,disabled:D,children:[o.jsx(ZC.Provider,{scope:t,children:o.jsx(xze,{scope:e.__scopeSelect,onNativeOptionAdd:z.useCallback(Ee=>{Me(it=>new Set(it).add(Ee))},[]),onNativeOptionRemove:z.useCallback(Ee=>{Me(it=>{const et=new Set(it);return et.delete(Ee),et})},[]),children:n})}),$e?o.jsxs(une,{"aria-hidden":!0,required:V,tabIndex:-1,name:E,autoComplete:N,value:Ce,onChange:Ee=>Ve(Ee.target.value),disabled:D,form:$,children:[Ce===void 0?o.jsx("option",{value:""}):null,Array.from(nt)]},rt):null]})})};Vte.displayName=o_;var $te="SelectTrigger",qte=z.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...c}=e,f=KC(n),p=xv($te,n),s=p.disabled||r,w=fa(t,p.onTriggerChange),T=YC(n),E=z.useRef("touch"),[N,D,V]=hne(B=>{const F=T().filter(X=>!X.disabled),K=F.find(X=>X.value===p.value),Y=fne(F,B,K);Y!==void 0&&p.onValueChange(Y.value)}),$=B=>{s||(p.onOpenChange(!0),V()),B&&(p.triggerPointerDownPosRef.current={x:Math.round(B.pageX),y:Math.round(B.pageY)})};return o.jsx(lT,{asChild:!0,...f,children:o.jsx(Si.button,{type:"button",role:"combobox","aria-controls":p.contentId,"aria-expanded":p.open,"aria-required":p.required,"aria-autocomplete":"none",dir:p.dir,"data-state":p.open?"open":"closed",disabled:s,"data-disabled":s?"":void 0,"data-placeholder":dne(p.value)?"":void 0,...c,ref:w,onClick:Yr(c.onClick,B=>{B.currentTarget.focus(),E.current!=="mouse"&&$(B)}),onPointerDown:Yr(c.onPointerDown,B=>{E.current=B.pointerType;const F=B.target;F.hasPointerCapture(B.pointerId)&&F.releasePointerCapture(B.pointerId),B.button===0&&B.ctrlKey===!1&&B.pointerType==="mouse"&&($(B),B.preventDefault())}),onKeyDown:Yr(c.onKeyDown,B=>{const F=N.current!=="";!(B.ctrlKey||B.altKey||B.metaKey)&&B.key.length===1&&D(B.key),!(F&&B.key===" ")&&mze.includes(B.key)&&($(),B.preventDefault())})})})});qte.displayName=$te;var Hte="SelectValue",Gte=z.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:c,children:f,placeholder:p="",...s}=e,w=xv(Hte,n),{onValueNodeHasChildrenChange:T}=w,E=f!==void 0,N=fa(t,w.onValueNodeChange);return Ol(()=>{T(E)},[T,E]),o.jsx(Si.span,{...s,ref:N,style:{pointerEvents:"none"},children:dne(w.value)?o.jsx(o.Fragment,{children:p}):f})});Gte.displayName=Hte;var bze="SelectIcon",Wte=z.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...c}=e;return o.jsx(Si.span,{"aria-hidden":!0,...c,ref:t,children:r||"▼"})});Wte.displayName=bze;var wze="SelectPortal",Xte=e=>o.jsx(kb,{asChild:!0,...e});Xte.displayName=wze;var l_="SelectContent",Zte=z.forwardRef((e,t)=>{const n=xv(l_,e.__scopeSelect),[r,c]=z.useState();if(Ol(()=>{c(new DocumentFragment)},[]),!n.open){const f=r;return f?YS.createPortal(o.jsx(Yte,{scope:e.__scopeSelect,children:o.jsx(ZC.Slot,{scope:e.__scopeSelect,children:o.jsx("div",{children:e.children})})}),f):null}return o.jsx(Kte,{...e,ref:t})});Zte.displayName=l_;var Nf=10,[Yte,_v]=Yb(l_),Sze="SelectContentImpl",Tze=nv("SelectContent.RemoveScroll"),Kte=z.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:c,onEscapeKeyDown:f,onPointerDownOutside:p,side:s,sideOffset:w,align:T,alignOffset:E,arrowPadding:N,collisionBoundary:D,collisionPadding:V,sticky:$,hideWhenDetached:B,avoidCollisions:F,...K}=e,Y=xv(l_,n),[X,ae]=z.useState(null),[Z,se]=z.useState(null),he=fa(t,Mt=>ae(Mt)),[ye,Ce]=z.useState(null),[Ve,Re]=z.useState(null),$e=YC(n),[nt,Me]=z.useState(!1),rt=z.useRef(!1);z.useEffect(()=>{if(X)return VE(X)},[X]),BE();const Ee=z.useCallback(Mt=>{const[an,...Jt]=$e().map(sn=>sn.ref.current),[Cn]=Jt.slice(-1),nr=document.activeElement;for(const sn of Mt)if(sn===nr||(sn?.scrollIntoView({block:"nearest"}),sn===an&&Z&&(Z.scrollTop=0),sn===Cn&&Z&&(Z.scrollTop=Z.scrollHeight),sn?.focus(),document.activeElement!==nr))return},[$e,Z]),it=z.useCallback(()=>Ee([ye,X]),[Ee,ye,X]);z.useEffect(()=>{nt&&it()},[nt,it]);const{onOpenChange:et,triggerPointerDownPosRef:mt}=Y;z.useEffect(()=>{if(X){let Mt={x:0,y:0};const an=Cn=>{Mt={x:Math.abs(Math.round(Cn.pageX)-(mt.current?.x??0)),y:Math.abs(Math.round(Cn.pageY)-(mt.current?.y??0))}},Jt=Cn=>{Mt.x<=10&&Mt.y<=10?Cn.preventDefault():X.contains(Cn.target)||et(!1),document.removeEventListener("pointermove",an),mt.current=null};return mt.current!==null&&(document.addEventListener("pointermove",an),document.addEventListener("pointerup",Jt,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",an),document.removeEventListener("pointerup",Jt,{capture:!0})}}},[X,et,mt]),z.useEffect(()=>{const Mt=()=>et(!1);return window.addEventListener("blur",Mt),window.addEventListener("resize",Mt),()=>{window.removeEventListener("blur",Mt),window.removeEventListener("resize",Mt)}},[et]);const[He,pt]=hne(Mt=>{const an=$e().filter(nr=>!nr.disabled),Jt=an.find(nr=>nr.ref.current===document.activeElement),Cn=fne(an,Mt,Jt);Cn&&setTimeout(()=>Cn.ref.current.focus())}),We=z.useCallback((Mt,an,Jt)=>{const Cn=!rt.current&&!Jt;(Y.value!==void 0&&Y.value===an||Cn)&&(Ce(Mt),Cn&&(rt.current=!0))},[Y.value]),Je=z.useCallback(()=>X?.focus(),[X]),jt=z.useCallback((Mt,an,Jt)=>{const Cn=!rt.current&&!Jt;(Y.value!==void 0&&Y.value===an||Cn)&&Re(Mt)},[Y.value]),Pt=r==="popper"?kL:Jte,Ot=Pt===kL?{side:s,sideOffset:w,align:T,alignOffset:E,arrowPadding:N,collisionBoundary:D,collisionPadding:V,sticky:$,hideWhenDetached:B,avoidCollisions:F}:{};return o.jsx(Yte,{scope:n,content:X,viewport:Z,onViewportChange:se,itemRefCallback:We,selectedItem:ye,onItemLeave:Je,itemTextRefCallback:jt,focusSelectedItem:it,selectedItemText:Ve,position:r,isPositioned:nt,searchRef:He,children:o.jsx(sT,{as:Tze,allowPinchZoom:!0,children:o.jsx(iT,{asChild:!0,trapped:Y.open,onMountAutoFocus:Mt=>{Mt.preventDefault()},onUnmountAutoFocus:Yr(c,Mt=>{Y.trigger?.focus({preventScroll:!0}),Mt.preventDefault()}),children:o.jsx(Db,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:f,onPointerDownOutside:p,onFocusOutside:Mt=>Mt.preventDefault(),onDismiss:()=>Y.onOpenChange(!1),children:o.jsx(Pt,{role:"listbox",id:Y.contentId,"data-state":Y.open?"open":"closed",dir:Y.dir,onContextMenu:Mt=>Mt.preventDefault(),...K,...Ot,onPlaced:()=>Me(!0),ref:he,style:{display:"flex",flexDirection:"column",outline:"none",...K.style},onKeyDown:Yr(K.onKeyDown,Mt=>{const an=Mt.ctrlKey||Mt.altKey||Mt.metaKey;if(Mt.key==="Tab"&&Mt.preventDefault(),!an&&Mt.key.length===1&&pt(Mt.key),["ArrowUp","ArrowDown","Home","End"].includes(Mt.key)){let Cn=$e().filter(nr=>!nr.disabled).map(nr=>nr.ref.current);if(["ArrowUp","End"].includes(Mt.key)&&(Cn=Cn.slice().reverse()),["ArrowUp","ArrowDown"].includes(Mt.key)){const nr=Mt.target,sn=Cn.indexOf(nr);Cn=Cn.slice(sn+1)}setTimeout(()=>Ee(Cn)),Mt.preventDefault()}})})})})})})});Kte.displayName=Sze;var Aze="SelectItemAlignedPosition",Jte=z.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...c}=e,f=xv(l_,n),p=_v(l_,n),[s,w]=z.useState(null),[T,E]=z.useState(null),N=fa(t,he=>E(he)),D=YC(n),V=z.useRef(!1),$=z.useRef(!0),{viewport:B,selectedItem:F,selectedItemText:K,focusSelectedItem:Y}=p,X=z.useCallback(()=>{if(f.trigger&&f.valueNode&&s&&T&&B&&F&&K){const he=f.trigger.getBoundingClientRect(),ye=T.getBoundingClientRect(),Ce=f.valueNode.getBoundingClientRect(),Ve=K.getBoundingClientRect();if(f.dir!=="rtl"){const nr=Ve.left-ye.left,sn=Ce.left-nr,zr=he.left-sn,or=he.width+zr,Rr=Math.max(or,ye.width),qr=window.innerWidth-Nf,Nn=_9(sn,[Nf,Math.max(Nf,qr-Rr)]);s.style.minWidth=or+"px",s.style.left=Nn+"px"}else{const nr=ye.right-Ve.right,sn=window.innerWidth-Ce.right-nr,zr=window.innerWidth-he.right-sn,or=he.width+zr,Rr=Math.max(or,ye.width),qr=window.innerWidth-Nf,Nn=_9(sn,[Nf,Math.max(Nf,qr-Rr)]);s.style.minWidth=or+"px",s.style.right=Nn+"px"}const Re=D(),$e=window.innerHeight-Nf*2,nt=B.scrollHeight,Me=window.getComputedStyle(T),rt=parseInt(Me.borderTopWidth,10),Ee=parseInt(Me.paddingTop,10),it=parseInt(Me.borderBottomWidth,10),et=parseInt(Me.paddingBottom,10),mt=rt+Ee+nt+et+it,He=Math.min(F.offsetHeight*5,mt),pt=window.getComputedStyle(B),We=parseInt(pt.paddingTop,10),Je=parseInt(pt.paddingBottom,10),jt=he.top+he.height/2-Nf,Pt=$e-jt,Ot=F.offsetHeight/2,Mt=F.offsetTop+Ot,an=rt+Ee+Mt,Jt=mt-an;if(an<=jt){const nr=Re.length>0&&F===Re[Re.length-1].ref.current;s.style.bottom="0px";const sn=T.clientHeight-B.offsetTop-B.offsetHeight,zr=Math.max(Pt,Ot+(nr?Je:0)+sn+it),or=an+zr;s.style.height=or+"px"}else{const nr=Re.length>0&&F===Re[0].ref.current;s.style.top="0px";const zr=Math.max(jt,rt+B.offsetTop+(nr?We:0)+Ot)+Jt;s.style.height=zr+"px",B.scrollTop=an-jt+B.offsetTop}s.style.margin=`${Nf}px 0`,s.style.minHeight=He+"px",s.style.maxHeight=$e+"px",r?.(),requestAnimationFrame(()=>V.current=!0)}},[D,f.trigger,f.valueNode,s,T,B,F,K,f.dir,r]);Ol(()=>X(),[X]);const[ae,Z]=z.useState();Ol(()=>{T&&Z(window.getComputedStyle(T).zIndex)},[T]);const se=z.useCallback(he=>{he&&$.current===!0&&(X(),Y?.(),$.current=!1)},[X,Y]);return o.jsx(Eze,{scope:n,contentWrapper:s,shouldExpandOnScrollRef:V,onScrollButtonChange:se,children:o.jsx("div",{ref:w,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:ae},children:o.jsx(Si.div,{...c,ref:N,style:{boxSizing:"border-box",maxHeight:"100%",...c.style}})})})});Jte.displayName=Aze;var jze="SelectPopperPosition",kL=z.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:c=Nf,...f}=e,p=KC(n);return o.jsx(JE,{...p,...f,ref:t,align:r,collisionPadding:c,style:{boxSizing:"border-box",...f.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});kL.displayName=jze;var[Eze,AF]=Yb(l_,{}),IL="SelectViewport",Qte=z.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...c}=e,f=_v(IL,n),p=AF(IL,n),s=fa(t,f.onViewportChange),w=z.useRef(0);return o.jsxs(o.Fragment,{children:[o.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),o.jsx(ZC.Slot,{scope:n,children:o.jsx(Si.div,{"data-radix-select-viewport":"",role:"presentation",...c,ref:s,style:{position:"relative",flex:1,overflow:"hidden auto",...c.style},onScroll:Yr(c.onScroll,T=>{const E=T.currentTarget,{contentWrapper:N,shouldExpandOnScrollRef:D}=p;if(D?.current&&N){const V=Math.abs(w.current-E.scrollTop);if(V>0){const $=window.innerHeight-Nf*2,B=parseFloat(N.style.minHeight),F=parseFloat(N.style.height),K=Math.max(B,F);if(K<$){const Y=K+V,X=Math.min($,Y),ae=Y-X;N.style.height=X+"px",N.style.bottom==="0px"&&(E.scrollTop=ae>0?ae:0,N.style.justifyContent="flex-end")}}}w.current=E.scrollTop})})})]})});Qte.displayName=IL;var ene="SelectGroup",[Cze,Nze]=Yb(ene),Pze=z.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,c=Ml();return o.jsx(Cze,{scope:n,id:c,children:o.jsx(Si.div,{role:"group","aria-labelledby":c,...r,ref:t})})});Pze.displayName=ene;var tne="SelectLabel",Mze=z.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,c=Nze(tne,n);return o.jsx(Si.div,{id:c.id,...r,ref:t})});Mze.displayName=tne;var mE="SelectItem",[Rze,nne]=Yb(mE),rne=z.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:c=!1,textValue:f,...p}=e,s=xv(mE,n),w=_v(mE,n),T=s.value===r,[E,N]=z.useState(f??""),[D,V]=z.useState(!1),$=fa(t,Y=>w.itemRefCallback?.(Y,r,c)),B=Ml(),F=z.useRef("touch"),K=()=>{c||(s.onValueChange(r),s.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return o.jsx(Rze,{scope:n,value:r,disabled:c,textId:B,isSelected:T,onItemTextChange:z.useCallback(Y=>{N(X=>X||(Y?.textContent??"").trim())},[]),children:o.jsx(ZC.ItemSlot,{scope:n,value:r,disabled:c,textValue:E,children:o.jsx(Si.div,{role:"option","aria-labelledby":B,"data-highlighted":D?"":void 0,"aria-selected":T&&D,"data-state":T?"checked":"unchecked","aria-disabled":c||void 0,"data-disabled":c?"":void 0,tabIndex:c?void 0:-1,...p,ref:$,onFocus:Yr(p.onFocus,()=>V(!0)),onBlur:Yr(p.onBlur,()=>V(!1)),onClick:Yr(p.onClick,()=>{F.current!=="mouse"&&K()}),onPointerUp:Yr(p.onPointerUp,()=>{F.current==="mouse"&&K()}),onPointerDown:Yr(p.onPointerDown,Y=>{F.current=Y.pointerType}),onPointerMove:Yr(p.onPointerMove,Y=>{F.current=Y.pointerType,c?w.onItemLeave?.():F.current==="mouse"&&Y.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Yr(p.onPointerLeave,Y=>{Y.currentTarget===document.activeElement&&w.onItemLeave?.()}),onKeyDown:Yr(p.onKeyDown,Y=>{w.searchRef?.current!==""&&Y.key===" "||(gze.includes(Y.key)&&K(),Y.key===" "&&Y.preventDefault())})})})})});rne.displayName=mE;var D1="SelectItemText",ine=z.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:c,...f}=e,p=xv(D1,n),s=_v(D1,n),w=nne(D1,n),T=_ze(D1,n),[E,N]=z.useState(null),D=fa(t,K=>N(K),w.onItemTextChange,K=>s.itemTextRefCallback?.(K,w.value,w.disabled)),V=E?.textContent,$=z.useMemo(()=>o.jsx("option",{value:w.value,disabled:w.disabled,children:V},w.value),[w.disabled,w.value,V]),{onNativeOptionAdd:B,onNativeOptionRemove:F}=T;return Ol(()=>(B($),()=>F($)),[B,F,$]),o.jsxs(o.Fragment,{children:[o.jsx(Si.span,{id:w.textId,...f,ref:D}),w.isSelected&&p.valueNode&&!p.valueNodeHasChildren?YS.createPortal(f.children,p.valueNode):null]})});ine.displayName=D1;var sne="SelectItemIndicator",ane=z.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return nne(sne,n).isSelected?o.jsx(Si.span,{"aria-hidden":!0,...r,ref:t}):null});ane.displayName=sne;var LL="SelectScrollUpButton",one=z.forwardRef((e,t)=>{const n=_v(LL,e.__scopeSelect),r=AF(LL,e.__scopeSelect),[c,f]=z.useState(!1),p=fa(t,r.onScrollButtonChange);return Ol(()=>{if(n.viewport&&n.isPositioned){let s=function(){const T=w.scrollTop>0;f(T)};const w=n.viewport;return s(),w.addEventListener("scroll",s),()=>w.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),c?o.jsx(cne,{...e,ref:p,onAutoScroll:()=>{const{viewport:s,selectedItem:w}=n;s&&w&&(s.scrollTop=s.scrollTop-w.offsetHeight)}}):null});one.displayName=LL;var zL="SelectScrollDownButton",lne=z.forwardRef((e,t)=>{const n=_v(zL,e.__scopeSelect),r=AF(zL,e.__scopeSelect),[c,f]=z.useState(!1),p=fa(t,r.onScrollButtonChange);return Ol(()=>{if(n.viewport&&n.isPositioned){let s=function(){const T=w.scrollHeight-w.clientHeight,E=Math.ceil(w.scrollTop)<T;f(E)};const w=n.viewport;return s(),w.addEventListener("scroll",s),()=>w.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),c?o.jsx(cne,{...e,ref:p,onAutoScroll:()=>{const{viewport:s,selectedItem:w}=n;s&&w&&(s.scrollTop=s.scrollTop+w.offsetHeight)}}):null});lne.displayName=zL;var cne=z.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...c}=e,f=_v("SelectScrollButton",n),p=z.useRef(null),s=YC(n),w=z.useCallback(()=>{p.current!==null&&(window.clearInterval(p.current),p.current=null)},[]);return z.useEffect(()=>()=>w(),[w]),Ol(()=>{s().find(E=>E.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[s]),o.jsx(Si.div,{"aria-hidden":!0,...c,ref:t,style:{flexShrink:0,...c.style},onPointerDown:Yr(c.onPointerDown,()=>{p.current===null&&(p.current=window.setInterval(r,50))}),onPointerMove:Yr(c.onPointerMove,()=>{f.onItemLeave?.(),p.current===null&&(p.current=window.setInterval(r,50))}),onPointerLeave:Yr(c.onPointerLeave,()=>{w()})})}),Oze="SelectSeparator",Dze=z.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return o.jsx(Si.div,{"aria-hidden":!0,...r,ref:t})});Dze.displayName=Oze;var FL="SelectArrow",kze=z.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,c=KC(n),f=xv(FL,n),p=_v(FL,n);return f.open&&p.position==="popper"?o.jsx(QE,{...c,...r,ref:t}):null});kze.displayName=FL;var Ize="SelectBubbleInput",une=z.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const c=z.useRef(null),f=fa(r,c),p=pze(t);return z.useEffect(()=>{const s=c.current;if(!s)return;const w=window.HTMLSelectElement.prototype,E=Object.getOwnPropertyDescriptor(w,"value").set;if(p!==t&&E){const N=new Event("change",{bubbles:!0});E.call(s,t),s.dispatchEvent(N)}},[p,t]),o.jsx(Si.select,{...n,style:{...uZ,...n.style},ref:f,defaultValue:t})});une.displayName=Ize;function dne(e){return e===""||e===void 0}function hne(e){const t=Ff(e),n=z.useRef(""),r=z.useRef(0),c=z.useCallback(p=>{const s=n.current+p;t(s),(function w(T){n.current=T,window.clearTimeout(r.current),T!==""&&(r.current=window.setTimeout(()=>w(""),1e3))})(s)},[t]),f=z.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return z.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,c,f]}function fne(e,t,n){const c=t.length>1&&Array.from(t).every(T=>T===t[0])?t[0]:t,f=n?e.indexOf(n):-1;let p=Lze(e,Math.max(f,0));c.length===1&&(p=p.filter(T=>T!==n));const w=p.find(T=>T.textValue.toLowerCase().startsWith(c.toLowerCase()));return w!==n?w:void 0}function Lze(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var zze=Vte,Fze=qte,Bze=Gte,Uze=Wte,Vze=Xte,$ze=Zte,qze=Qte,Hze=rne,Gze=ine,Wze=ane,Xze=one,Zze=lne;function Fs({...e}){return o.jsx(zze,{"data-slot":"select",...e})}function Bs({...e}){return o.jsx(Bze,{"data-slot":"select-value",...e})}function Us({className:e,size:t="default",children:n,...r}){return o.jsxs(Fze,{"data-slot":"select-trigger","data-size":t,className:Rn("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r,children:[n,o.jsx(Uze,{asChild:!0,children:o.jsx(LE,{className:"size-4 opacity-50"})})]})}function Vs({className:e,children:t,position:n="popper",...r}){return o.jsx(Vze,{children:o.jsxs($ze,{"data-slot":"select-content",className:Rn("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[o.jsx(Yze,{}),o.jsx(qze,{className:Rn("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),o.jsx(Kze,{})]})})}function Gn({className:e,children:t,...n}){return o.jsxs(Hze,{"data-slot":"select-item",className:Rn("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...n,children:[o.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:o.jsx(Wze,{children:o.jsx(IE,{className:"size-4"})})}),o.jsx(Gze,{children:t})]})}function Yze({className:e,...t}){return o.jsx(Xze,{"data-slot":"select-scroll-up-button",className:Rn("flex cursor-default items-center justify-center py-1",e),...t,children:o.jsx(hde,{className:"size-4"})})}function Kze({className:e,...t}){return o.jsx(Zze,{"data-slot":"select-scroll-down-button",className:Rn("flex cursor-default items-center justify-center py-1",e),...t,children:o.jsx(LE,{className:"size-4"})})}function Jze(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}Jze(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var PT=e=>typeof e=="number"&&!isNaN(e),c_=e=>typeof e=="string",Og=e=>typeof e=="function",Qze=e=>c_(e)||PT(e),BL=e=>c_(e)||Og(e)?e:null,eFe=(e,t)=>e===!1||PT(e)&&e>0?e:t,UL=e=>z.isValidElement(e)||c_(e)||Og(e)||PT(e);function tFe(e,t,n=300){let{scrollHeight:r,style:c}=e;requestAnimationFrame(()=>{c.minHeight="initial",c.height=r+"px",c.transition=`all ${n}ms`,requestAnimationFrame(()=>{c.height="0",c.padding="0",c.margin="0",setTimeout(t,n)})})}function nFe({enter:e,exit:t,appendPosition:n=!1,collapse:r=!0,collapseDuration:c=300}){return function({children:f,position:p,preventExitTransition:s,done:w,nodeRef:T,isIn:E,playToast:N}){let D=n?`${e}--${p}`:e,V=n?`${t}--${p}`:t,$=z.useRef(0);return z.useLayoutEffect(()=>{let B=T.current,F=D.split(" "),K=Y=>{Y.target===T.current&&(N(),B.removeEventListener("animationend",K),B.removeEventListener("animationcancel",K),$.current===0&&Y.type!=="animationcancel"&&B.classList.remove(...F))};B.classList.add(...F),B.addEventListener("animationend",K),B.addEventListener("animationcancel",K)},[]),z.useEffect(()=>{let B=T.current,F=()=>{B.removeEventListener("animationend",F),r?tFe(B,w,c):w()};E||(s?F():($.current=1,B.className+=` ${V}`,B.addEventListener("animationend",F)))},[E]),_e.createElement(_e.Fragment,null,f)}}function b9(e,t){return{content:pne(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function pne(e,t,n=!1){return z.isValidElement(e)&&!c_(e.type)?z.cloneElement(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:n}):Og(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:n}):e}function rFe({closeToast:e,theme:t,ariaLabel:n="close"}){return _e.createElement("button",{className:`Toastify__close-button Toastify__close-button--${t}`,type:"button",onClick:r=>{r.stopPropagation(),e(!0)},"aria-label":n},_e.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},_e.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function iFe({delay:e,isRunning:t,closeToast:n,type:r="default",hide:c,className:f,controlledProgress:p,progress:s,rtl:w,isIn:T,theme:E}){let N=c||p&&s===0,D={animationDuration:`${e}ms`,animationPlayState:t?"running":"paused"};p&&(D.transform=`scaleX(${s})`);let V=es("Toastify__progress-bar",p?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${E}`,`Toastify__progress-bar--${r}`,{"Toastify__progress-bar--rtl":w}),$=Og(f)?f({rtl:w,type:r,defaultClassName:V}):es(V,f),B={[p&&s>=1?"onTransitionEnd":"onAnimationEnd"]:p&&s<1?null:()=>{T&&n()}};return _e.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":N},_e.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${E} Toastify__progress-bar--${r}`}),_e.createElement("div",{role:"progressbar","aria-hidden":N?"true":"false","aria-label":"notification timer",className:$,style:D,...B}))}var sFe=1,mne=()=>`${sFe++}`;function aFe(e,t,n){let r=1,c=0,f=[],p=[],s=t,w=new Map,T=new Set,E=Y=>(T.add(Y),()=>T.delete(Y)),N=()=>{p=Array.from(w.values()),T.forEach(Y=>Y())},D=({containerId:Y,toastId:X,updateId:ae})=>{let Z=Y?Y!==e:e!==1,se=w.has(X)&&ae==null;return Z||se},V=(Y,X)=>{w.forEach(ae=>{var Z;(X==null||X===ae.props.toastId)&&((Z=ae.toggle)==null||Z.call(ae,Y))})},$=Y=>{var X,ae;(ae=(X=Y.props)==null?void 0:X.onClose)==null||ae.call(X,Y.removalReason),Y.isActive=!1},B=Y=>{if(Y==null)w.forEach($);else{let X=w.get(Y);X&&$(X)}N()},F=()=>{c-=f.length,f=[]},K=Y=>{var X,ae;let{toastId:Z,updateId:se}=Y.props,he=se==null;Y.staleId&&w.delete(Y.staleId),Y.isActive=!0,w.set(Z,Y),N(),n(b9(Y,he?"added":"updated")),he&&((ae=(X=Y.props).onOpen)==null||ae.call(X))};return{id:e,props:s,observe:E,toggle:V,removeToast:B,toasts:w,clearQueue:F,buildToast:(Y,X)=>{if(D(X))return;let{toastId:ae,updateId:Z,data:se,staleId:he,delay:ye}=X,Ce=Z==null;Ce&&c++;let Ve={...s,style:s.toastStyle,key:r++,...Object.fromEntries(Object.entries(X).filter(([$e,nt])=>nt!=null)),toastId:ae,updateId:Z,data:se,isIn:!1,className:BL(X.className||s.toastClassName),progressClassName:BL(X.progressClassName||s.progressClassName),autoClose:X.isLoading?!1:eFe(X.autoClose,s.autoClose),closeToast($e){w.get(ae).removalReason=$e,B(ae)},deleteToast(){let $e=w.get(ae);if($e!=null){if(n(b9($e,"removed")),w.delete(ae),c--,c<0&&(c=0),f.length>0){K(f.shift());return}N()}}};Ve.closeButton=s.closeButton,X.closeButton===!1||UL(X.closeButton)?Ve.closeButton=X.closeButton:X.closeButton===!0&&(Ve.closeButton=UL(s.closeButton)?s.closeButton:!0);let Re={content:Y,props:Ve,staleId:he};s.limit&&s.limit>0&&c>s.limit&&Ce?f.push(Re):PT(ye)?setTimeout(()=>{K(Re)},ye):K(Re)},setProps(Y){s=Y},setToggle:(Y,X)=>{let ae=w.get(Y);ae&&(ae.toggle=X)},isToastActive:Y=>{var X;return(X=w.get(Y))==null?void 0:X.isActive},getSnapshot:()=>p}}var Tu=new Map,qS=[],VL=new Set,oFe=e=>VL.forEach(t=>t(e)),gne=()=>Tu.size>0;function lFe(){qS.forEach(e=>vne(e.content,e.options)),qS=[]}var cFe=(e,{containerId:t})=>{var n;return(n=Tu.get(t||1))==null?void 0:n.toasts.get(e)};function yne(e,t){var n;if(t)return!!((n=Tu.get(t))!=null&&n.isToastActive(e));let r=!1;return Tu.forEach(c=>{c.isToastActive(e)&&(r=!0)}),r}function uFe(e){if(!gne()){qS=qS.filter(t=>e!=null&&t.options.toastId!==e);return}if(e==null||Qze(e))Tu.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=Tu.get(e.containerId);t?t.removeToast(e.id):Tu.forEach(n=>{n.removeToast(e.id)})}}var dFe=(e={})=>{Tu.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})};function vne(e,t){UL(e)&&(gne()||qS.push({content:e,options:t}),Tu.forEach(n=>{n.buildToast(e,t)}))}function hFe(e){var t;(t=Tu.get(e.containerId||1))==null||t.setToggle(e.id,e.fn)}function xne(e,t){Tu.forEach(n=>{(t==null||!(t!=null&&t.containerId)||t?.containerId===n.id)&&n.toggle(e,t?.id)})}function fFe(e){let t=e.containerId||1;return{subscribe(n){let r=aFe(t,e,oFe);Tu.set(t,r);let c=r.observe(n);return lFe(),()=>{c(),Tu.delete(t)}},setProps(n){var r;(r=Tu.get(t))==null||r.setProps(n)},getSnapshot(){var n;return(n=Tu.get(t))==null?void 0:n.getSnapshot()}}}function pFe(e){return VL.add(e),()=>{VL.delete(e)}}function mFe(e){return e&&(c_(e.toastId)||PT(e.toastId))?e.toastId:mne()}function MT(e,t){return vne(e,t),t.toastId}function JC(e,t){return{...t,type:t&&t.type||e,toastId:mFe(t)}}function QC(e){return(t,n)=>MT(t,JC(e,n))}function oo(e,t){return MT(e,JC("default",t))}oo.loading=(e,t)=>MT(e,JC("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t}));function gFe(e,{pending:t,error:n,success:r},c){let f;t&&(f=c_(t)?oo.loading(t,c):oo.loading(t.render,{...c,...t}));let p={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},s=(T,E,N)=>{if(E==null){oo.dismiss(f);return}let D={type:T,...p,...c,data:N},V=c_(E)?{render:E}:E;return f?oo.update(f,{...D,...V}):oo(V.render,{...D,...V}),N},w=Og(e)?e():e;return w.then(T=>s("success",r,T)).catch(T=>s("error",n,T)),w}oo.promise=gFe;oo.success=QC("success");oo.info=QC("info");oo.error=QC("error");oo.warning=QC("warning");oo.warn=oo.warning;oo.dark=(e,t)=>MT(e,JC("default",{theme:"dark",...t}));function yFe(e){uFe(e)}oo.dismiss=yFe;oo.clearWaitingQueue=dFe;oo.isActive=yne;oo.update=(e,t={})=>{let n=cFe(e,t);if(n){let{props:r,content:c}=n,f={delay:100,...r,...t,toastId:t.toastId||e,updateId:mne()};f.toastId!==e&&(f.staleId=e);let p=f.render||c;delete f.render,MT(p,f)}};oo.done=e=>{oo.update(e,{progress:1})};oo.onChange=pFe;oo.play=e=>xne(!0,e);oo.pause=e=>xne(!1,e);function vFe(e){var t;let{subscribe:n,getSnapshot:r,setProps:c}=z.useRef(fFe(e)).current;c(e);let f=(t=z.useSyncExternalStore(n,r,r))==null?void 0:t.slice();function p(s){if(!f)return[];let w=new Map;return e.newestOnTop&&f.reverse(),f.forEach(T=>{let{position:E}=T.props;w.has(E)||w.set(E,[]),w.get(E).push(T)}),Array.from(w,T=>s(T[0],T[1]))}return{getToastToRender:p,isToastActive:yne,count:f?.length}}function xFe(e){let[t,n]=z.useState(!1),[r,c]=z.useState(!1),f=z.useRef(null),p=z.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:s,pauseOnHover:w,closeToast:T,onClick:E,closeOnClick:N}=e;hFe({id:e.toastId,containerId:e.containerId,fn:n}),z.useEffect(()=>{if(e.pauseOnFocusLoss)return D(),()=>{V()}},[e.pauseOnFocusLoss]);function D(){document.hasFocus()||K(),window.addEventListener("focus",F),window.addEventListener("blur",K)}function V(){window.removeEventListener("focus",F),window.removeEventListener("blur",K)}function $(he){if(e.draggable===!0||e.draggable===he.pointerType){Y();let ye=f.current;p.canCloseOnClick=!0,p.canDrag=!0,ye.style.transition="none",e.draggableDirection==="x"?(p.start=he.clientX,p.removalDistance=ye.offsetWidth*(e.draggablePercent/100)):(p.start=he.clientY,p.removalDistance=ye.offsetHeight*(e.draggablePercent===80?e.draggablePercent*1.5:e.draggablePercent)/100)}}function B(he){let{top:ye,bottom:Ce,left:Ve,right:Re}=f.current.getBoundingClientRect();he.nativeEvent.type!=="touchend"&&e.pauseOnHover&&he.clientX>=Ve&&he.clientX<=Re&&he.clientY>=ye&&he.clientY<=Ce?K():F()}function F(){n(!0)}function K(){n(!1)}function Y(){p.didMove=!1,document.addEventListener("pointermove",ae),document.addEventListener("pointerup",Z)}function X(){document.removeEventListener("pointermove",ae),document.removeEventListener("pointerup",Z)}function ae(he){let ye=f.current;if(p.canDrag&&ye){p.didMove=!0,t&&K(),e.draggableDirection==="x"?p.delta=he.clientX-p.start:p.delta=he.clientY-p.start,p.start!==he.clientX&&(p.canCloseOnClick=!1);let Ce=e.draggableDirection==="x"?`${p.delta}px, var(--y)`:`0, calc(${p.delta}px + var(--y))`;ye.style.transform=`translate3d(${Ce},0)`,ye.style.opacity=`${1-Math.abs(p.delta/p.removalDistance)}`}}function Z(){X();let he=f.current;if(p.canDrag&&p.didMove&&he){if(p.canDrag=!1,Math.abs(p.delta)>p.removalDistance){c(!0),e.closeToast(!0),e.collapseAll();return}he.style.transition="transform 0.2s, opacity 0.2s",he.style.removeProperty("transform"),he.style.removeProperty("opacity")}}let se={onPointerDown:$,onPointerUp:B};return s&&w&&(se.onMouseEnter=K,e.stacked||(se.onMouseLeave=F)),N&&(se.onClick=he=>{E&&E(he),p.canCloseOnClick&&T(!0)}),{playToast:F,pauseToast:K,isRunning:t,preventExitTransition:r,toastRef:f,eventHandlers:se}}var _Fe=typeof window<"u"?z.useLayoutEffect:z.useEffect,eN=({theme:e,type:t,isLoading:n,...r})=>_e.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${t})`,...r});function bFe(e){return _e.createElement(eN,{...e},_e.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function wFe(e){return _e.createElement(eN,{...e},_e.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function SFe(e){return _e.createElement(eN,{...e},_e.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function TFe(e){return _e.createElement(eN,{...e},_e.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function AFe(){return _e.createElement("div",{className:"Toastify__spinner"})}var $L={info:wFe,warning:bFe,success:SFe,error:TFe,spinner:AFe},jFe=e=>e in $L;function EFe({theme:e,type:t,isLoading:n,icon:r}){let c=null,f={theme:e,type:t};return r===!1||(Og(r)?c=r({...f,isLoading:n}):z.isValidElement(r)?c=z.cloneElement(r,f):n?c=$L.spinner():jFe(t)&&(c=$L[t](f))),c}var CFe=e=>{let{isRunning:t,preventExitTransition:n,toastRef:r,eventHandlers:c,playToast:f}=xFe(e),{closeButton:p,children:s,autoClose:w,onClick:T,type:E,hideProgressBar:N,closeToast:D,transition:V,position:$,className:B,style:F,progressClassName:K,updateId:Y,role:X,progress:ae,rtl:Z,toastId:se,deleteToast:he,isIn:ye,isLoading:Ce,closeOnClick:Ve,theme:Re,ariaLabel:$e}=e,nt=es("Toastify__toast",`Toastify__toast-theme--${Re}`,`Toastify__toast--${E}`,{"Toastify__toast--rtl":Z},{"Toastify__toast--close-on-click":Ve}),Me=Og(B)?B({rtl:Z,position:$,type:E,defaultClassName:nt}):es(nt,B),rt=EFe(e),Ee=!!ae||!w,it={closeToast:D,type:E,theme:Re},et=null;return p===!1||(Og(p)?et=p(it):z.isValidElement(p)?et=z.cloneElement(p,it):et=rFe(it)),_e.createElement(V,{isIn:ye,done:he,position:$,preventExitTransition:n,nodeRef:r,playToast:f},_e.createElement("div",{id:se,tabIndex:0,onClick:T,"data-in":ye,className:Me,...c,style:F,ref:r,...ye&&{role:X,"aria-label":$e}},rt!=null&&_e.createElement("div",{className:es("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!Ce})},rt),pne(s,e,!t),et,!e.customProgressBar&&_e.createElement(iFe,{...Y&&!Ee?{key:`p-${Y}`}:{},rtl:Z,theme:Re,delay:w,isRunning:t,isIn:ye,closeToast:D,hide:N,type:E,className:K,controlledProgress:Ee,progress:ae||0})))},NFe=(e,t=!1)=>({enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}),PFe=nFe(NFe("bounce",!0)),MFe={position:"top-right",transition:PFe,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&e.code==="KeyT"};function _ne(e){let t={...MFe,...e},n=e.stacked,[r,c]=z.useState(!0),f=z.useRef(null),{getToastToRender:p,isToastActive:s,count:w}=vFe(t),{className:T,style:E,rtl:N,containerId:D,hotKeys:V}=t;function $(F){let K=es("Toastify__toast-container",`Toastify__toast-container--${F}`,{"Toastify__toast-container--rtl":N});return Og(T)?T({position:F,rtl:N,defaultClassName:K}):es(K,BL(T))}function B(){n&&(c(!0),oo.play())}return _Fe(()=>{var F;if(n){let K=f.current.querySelectorAll('[data-in="true"]'),Y=12,X=(F=t.position)==null?void 0:F.includes("top"),ae=0,Z=0;Array.from(K).reverse().forEach((se,he)=>{let ye=se;ye.classList.add("Toastify__toast--stacked"),he>0&&(ye.dataset.collapsed=`${r}`),ye.dataset.pos||(ye.dataset.pos=X?"top":"bot");let Ce=ae*(r?.2:1)+(r?0:Y*he);ye.style.setProperty("--y",`${X?Ce:Ce*-1}px`),ye.style.setProperty("--g",`${Y}`),ye.style.setProperty("--s",`${1-(r?Z:0)}`),ae+=ye.offsetHeight,Z+=.025})}},[r,w,n]),z.useEffect(()=>{function F(K){var Y;let X=f.current;V(K)&&((Y=X.querySelector('[tabIndex="0"]'))==null||Y.focus(),c(!1),oo.pause()),K.key==="Escape"&&(document.activeElement===X||X!=null&&X.contains(document.activeElement))&&(c(!0),oo.play())}return document.addEventListener("keydown",F),()=>{document.removeEventListener("keydown",F)}},[V]),_e.createElement("section",{ref:f,className:"Toastify",id:D,onMouseEnter:()=>{n&&(c(!1),oo.pause())},onMouseLeave:B,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},p((F,K)=>{let Y=K.length?{...E}:{...E,pointerEvents:"none"};return _e.createElement("div",{tabIndex:-1,className:$(F),"data-stacked":n,style:Y,key:`c-${F}`},K.map(({content:X,props:ae})=>_e.createElement(CFe,{...ae,stacked:n,collapseAll:B,isIn:s(ae.toastId,ae.containerId),key:`t-${ae.key}`},X)))}))}function RFe(){const{auth:e,loading:t}=z.useContext(Vh);if(t||!e)return o.jsx("div",{className:"min-h-screen bg-gray-50/50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary mx-auto"}),o.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading Competency Management System..."})]})});const n=()=>e?.role==="HR2 Admin"||e?.role==="hr2_admin"||e?.user_type==="HR2 Admin",r=()=>e?.role==="Employee",[c,f]=z.useState(!1),[p,s]=z.useState(""),[w,T]=z.useState(""),[E,N]=z.useState("all"),[D,V]=z.useState("profile"),[$,B]=z.useState([]),[F,K]=z.useState(null),[Y,X]=z.useState([]),[ae,Z]=z.useState([]),[se,he]=z.useState([]),[ye,Ce]=z.useState([]),[Ve,Re]=z.useState([]),[$e,nt]=z.useState(!1),[Me,rt]=z.useState(!1),[Ee,it]=z.useState(!1),et={employees:[{id:1,name:"John Doe",department:"IT",position:"Senior Developer",profilePhoto:"https://img.icons8.com/?size=100&id=LREuj015njcj&format=png&color=000000",competencies:[{skill:"JavaScript",level:"Advanced",proficiency:90,lastAssessed:"2025-09-15"},{skill:"React",level:"Advanced",proficiency:85,lastAssessed:"2025-09-10"},{skill:"Node.js",level:"Intermediate",proficiency:70,lastAssessed:"2025-09-05"},{skill:"Leadership",level:"Beginner",proficiency:40,lastAssessed:"2025-08-20"}],awards:[{title:"Employee of the Month",date:"2025-08-01",type:"Recognition"}]},{id:2,name:"Jane Smith",department:"Marketing",position:"Marketing Manager",profilePhoto:"https://img.icons8.com/?size=100&id=LREuj015njcj&format=png&color=000000",competencies:[{skill:"Digital Marketing",level:"Advanced",proficiency:88,lastAssessed:"2025-09-12"},{skill:"Project Management",level:"Advanced",proficiency:82,lastAssessed:"2025-09-10"},{skill:"Communication",level:"Advanced",proficiency:95,lastAssessed:"2025-09-08"},{skill:"Data Analysis",level:"Intermediate",proficiency:65,lastAssessed:"2025-09-05"}],awards:[{title:"Best Campaign Award",date:"2025-08-20",type:"Achievement"}]},{id:1,name:"John Doe",department:"IT",position:"Senior Developer",profilePhoto:"https://img.icons8.com/?size=100&id=LREuj015njcj&format=png&color=000000",competencies:[{skill:"JavaScript",level:"Advanced",proficiency:90,lastAssessed:"2025-09-15"},{skill:"React",level:"Advanced",proficiency:85,lastAssessed:"2025-09-10"},{skill:"Node.js",level:"Intermediate",proficiency:70,lastAssessed:"2025-09-05"},{skill:"Leadership",level:"Beginner",proficiency:40,lastAssessed:"2025-08-20"}],awards:[{title:"Employee of the Month",date:"2025-08-01",type:"Recognition"}]},{id:2,name:"Jane Smith",department:"Marketing",position:"Marketing Manager",profilePhoto:"https://img.icons8.com/?size=100&id=LREuj015njcj&format=png&color=000000",competencies:[{skill:"Digital Marketing",level:"Advanced",proficiency:88,lastAssessed:"2025-09-12"},{skill:"Project Management",level:"Advanced",proficiency:82,lastAssessed:"2025-09-10"},{skill:"Communication",level:"Advanced",proficiency:95,lastAssessed:"2025-09-08"},{skill:"Data Analysis",level:"Intermediate",proficiency:65,lastAssessed:"2025-09-05"}],awards:[{title:"Best Campaign Award",date:"2025-08-20",type:"Achievement"}]},{id:2,name:"Jane Smith",department:"Marketing",position:"Marketing Manager",profilePhoto:"https://img.icons8.com/?size=100&id=LREuj015njcj&format=png&color=000000",competencies:[{skill:"Digital Marketing",level:"Advanced",proficiency:88,lastAssessed:"2025-09-12"},{skill:"Project Management",level:"Advanced",proficiency:82,lastAssessed:"2025-09-10"},{skill:"Communication",level:"Advanced",proficiency:95,lastAssessed:"2025-09-08"},{skill:"Data Analysis",level:"Intermediate",proficiency:65,lastAssessed:"2025-09-05"}],awards:[{title:"Best Campaign Award",date:"2025-08-20",type:"Achievement"}]}],jobRoles:[{id:1,title:"Senior Developer",department:"IT",requiredSkills:[{skill:"JavaScript",requiredLevel:"Advanced",minProficiency:80},{skill:"React",requiredLevel:"Advanced",minProficiency:75}]},{id:2,title:"Marketing Manager",department:"Marketing",requiredSkills:[{skill:"Digital Marketing",requiredLevel:"Advanced",minProficiency:80},{skill:"Project Management",requiredLevel:"Advanced",minProficiency:75},{skill:"Communication",requiredLevel:"Advanced",minProficiency:85},{skill:"Data Analysis",requiredLevel:"Intermediate",minProficiency:65}]},{id:1,title:"Senior Developer",department:"IT",requiredSkills:[{skill:"JavaScript",requiredLevel:"Advanced",minProficiency:80},{skill:"React",requiredLevel:"Advanced",minProficiency:75}]},{id:1,title:"Senior Developer",department:"IT",requiredSkills:[{skill:"JavaScript",requiredLevel:"Advanced",minProficiency:80},{skill:"React",requiredLevel:"Advanced",minProficiency:75}]},{id:1,title:"Senior Developer",department:"IT",requiredSkills:[{skill:"JavaScript",requiredLevel:"Advanced",minProficiency:80},{skill:"React",requiredLevel:"Advanced",minProficiency:75},{skill:"JavaScript",requiredLevel:"Advanced",minProficiency:80},{skill:"React",requiredLevel:"Advanced",minProficiency:75},{skill:"JavaScript",requiredLevel:"Advanced",minProficiency:80},{skill:"React",requiredLevel:"Advanced",minProficiency:75}]}],assessments:[{id:1,employeeId:1,employeeName:"John Doe",assessmentType:"Manager Evaluation",assessor:"Sarah Johnson",date:"2025-09-15",status:"Completed",scores:[{skill:"JavaScript",score:90,feedback:"Excellent technical skills"},{skill:"Leadership",score:40,feedback:"Needs improvement in team management"}]},{id:2,employeeId:1,employeeName:"John Doe",assessmentType:"Self Assessment",assessor:"Self",date:"2025-09-10",status:"Completed",scores:[{skill:"React",score:85,feedback:"Confident with most React concepts"},{skill:"Node.js",score:70,feedback:"Good understanding, need more practice"}]},{id:1,employeeId:1,employeeName:"John Doe",assessmentType:"Manager Evaluation",assessor:"Sarah Johnson",date:"2025-09-15",status:"Completed",scores:[{skill:"JavaScript",score:90,feedback:"Excellent technical skills"},{skill:"Leadership",score:40,feedback:"Needs improvement in team management"}]},{id:2,employeeId:1,employeeName:"John Doe",assessmentType:"Self Assessment",assessor:"Self",date:"2025-09-10",status:"Completed",scores:[{skill:"React",score:85,feedback:"Confident with most React concepts"},{skill:"Node.js",score:70,feedback:"Good understanding, need more practice"}]},{id:1,employeeId:1,employeeName:"John Doe",assessmentType:"Manager Evaluation",assessor:"Sarah Johnson",date:"2025-09-15",status:"Completed",scores:[{skill:"JavaScript",score:90,feedback:"Excellent technical skills"},{skill:"Leadership",score:40,feedback:"Needs improvement in team management"}]},{id:1,employeeId:1,employeeName:"John Doe",assessmentType:"Manager Evaluation",assessor:"Sarah Johnson",date:"2025-09-15",status:"Completed",scores:[{skill:"JavaScript",score:90,feedback:"Excellent technical skills"},{skill:"Leadership",score:40,feedback:"Needs improvement in team management"}]}],recommendations:[{id:1,employeeId:1,type:"Training",title:"Leadership Development Program",description:"Recommended to improve leadership skills",priority:"High",estimatedDuration:"3 months",provider:"Internal Training"},{id:2,employeeId:1,type:"Role",title:"Team Lead Position",description:"Suitable for promotion after completing leadership training",priority:"Medium",estimatedDuration:"6 months",provider:"Internal Promotion"},{id:1,employeeId:1,type:"Training",title:"Leadership Development Program",description:"Recommended to improve leadership skills",priority:"High",estimatedDuration:"3 months",provider:"Internal Training"},{id:2,employeeId:1,type:"Role",title:"Team Lead Position",description:"Suitable for promotion after completing leadership training",priority:"Medium",estimatedDuration:"6 months",provider:"Internal Promotion"}]};z.useEffect(()=>{B(et.employees),Z(et.jobRoles),Ce(et.assessments),Re(et.recommendations),r()&&et.employees.length>0&&K(et.employees[0])},[e]);const mt=We=>{switch(We){case"Beginner":return"bg-red-100 text-red-800";case"Intermediate":return"bg-yellow-100 text-yellow-800";case"Advanced":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},He=(We,Je)=>!We||!Je?[]:Je.requiredSkills.map(jt=>{const Pt=We.competencies.find(Mt=>Mt.skill===jt.skill),Ot=Pt?Math.max(0,jt.minProficiency-Pt.proficiency):jt.minProficiency;return{skill:jt.skill,required:jt.minProficiency,current:Pt?.proficiency||0,gap:Ot,status:Ot===0?"Met":Ot<=20?"Close":"Gap"}}),pt=$.filter(We=>We.name.toLowerCase().includes(w.toLowerCase())||We.department.toLowerCase().includes(w.toLowerCase())||We.position.toLowerCase().includes(w.toLowerCase()));return o.jsxs("div",{className:"min-h-screen bg-gray-50/30",children:[o.jsx("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur",children:o.jsx("div",{className:"container flex h-12 items-center justify-between px-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(HW,{className:"h-5 w-5 text-primary"}),o.jsx("h1",{className:"text-lg font-semibold",children:"Competency Management"})]})})}),o.jsxs("div",{className:"container mx-auto px-4 py-6 space-y-6",children:[o.jsxs("section",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[o.jsx(ni,{className:"p-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Employees"}),o.jsx("p",{className:"text-2xl font-bold",children:$.length})]}),o.jsx(Hy,{className:"h-5 w-5 text-muted-foreground"})]})}),o.jsx(ni,{className:"p-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Job Roles"}),o.jsx("p",{className:"text-2xl font-bold",children:ae.length})]}),o.jsx(d6,{className:"h-5 w-5 text-muted-foreground"})]})}),o.jsx(ni,{className:"p-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Assessments"}),o.jsx("p",{className:"text-2xl font-bold",children:ye.length})]}),o.jsx(C1,{className:"h-5 w-5 text-muted-foreground"})]})}),o.jsx(ni,{className:"p-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Avg Proficiency"}),o.jsx("p",{className:"text-2xl font-bold",children:"85%"})]}),o.jsx(whe,{className:"h-5 w-5 text-muted-foreground"})]})})]}),o.jsx("section",{className:"space-y-4",children:o.jsxs(ni,{children:[o.jsxs(Ns,{children:[o.jsxs(us,{className:"flex items-center gap-2",children:[o.jsx(Xy,{className:"w-5 h-5 text-blue-600"}),"Employee Profiles"]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"relative flex-1 max-w-md",children:[o.jsx(nT,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),o.jsx(On,{placeholder:"Search employees...",value:w,onChange:We=>T(We.target.value),className:"pl-10"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs(kt,{variant:"outline",size:"sm",className:"gap-2",children:[o.jsx(Pde,{className:"w-4 h-4"}),"Filter"]}),n()&&o.jsxs(kt,{onClick:()=>nt(!0),variant:"default",size:"sm",className:"gap-2",children:[o.jsx(Au,{className:"w-4 h-4"}),"Add Skill"]})]})]})]}),o.jsx(qi,{className:"h-80 overflow-y-auto",children:o.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:pt.map(We=>o.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:We.profilePhoto,alt:We.name,className:"w-10 h-10 rounded-full object-cover"}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium text-sm",children:We.name}),o.jsx("p",{className:"text-xs text-muted-foreground",children:We.position})]})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"flex items-center gap-2",children:We.competencies.slice(0,2).map((Je,jt)=>o.jsxs("div",{className:"text-center",children:[o.jsx("span",{className:"text-xs text-muted-foreground",children:Je.skill}),o.jsxs("div",{className:"text-sm font-medium",children:[Je.proficiency,"%"]})]},jt))}),o.jsx(_i,{variant:"outline",className:"text-xs",children:We.department}),o.jsx(kt,{variant:"outline",size:"sm",children:"View"})]})]},We.id))})})]})}),o.jsx("section",{className:"space-y-4",children:o.jsxs(ni,{children:[o.jsx(Ns,{children:o.jsxs(us,{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(d6,{className:"w-5 h-5 text-green-600"}),"Role Requirements"]}),n()&&o.jsxs(kt,{onClick:()=>rt(!0),variant:"default",size:"sm",className:"gap-2",children:[o.jsx(Au,{className:"w-4 h-4"}),"Define Role"]})]})}),o.jsx(qi,{className:"h-96 overflow-y-auto",children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:ae.map(We=>o.jsxs(ni,{className:"p-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Kue,{className:"w-4 h-4 text-green-600"}),o.jsx("h3",{className:"font-semibold text-sm",children:We.title})]}),o.jsx(_i,{variant:"outline",className:"text-xs",children:We.department})]}),o.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[o.jsxs("div",{children:[o.jsxs("h4",{className:"font-medium mb-1 flex items-center gap-1 text-xs text-muted-foreground",children:[o.jsx(Wy,{className:"w-3 h-3 text-blue-600"}),"Skills (",We.requiredSkills.length,")"]}),o.jsx("div",{className:"space-y-1",children:We.requiredSkills.map((Je,jt)=>o.jsxs("div",{className:"p-1.5 bg-gray-50 rounded",children:[o.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[o.jsx("span",{className:"font-medium text-xs",children:Je.skill}),o.jsx(_i,{className:`${mt(Je.requiredLevel)} text-xs px-1 py-0`,children:Je.requiredLevel})]}),o.jsxs("div",{className:"text-xs text-muted-foreground mb-0.5",children:["Min: ",Je.minProficiency,"%"]}),o.jsx(Df,{value:Je.minProficiency,className:"h-1"})]},jt))})]}),F&&o.jsxs("div",{children:[o.jsxs("h4",{className:"font-medium mb-1 flex items-center gap-1 text-xs text-muted-foreground",children:[o.jsx(C1,{className:"w-3 h-3 text-purple-600"}),"Gap Analysis"]}),o.jsx("div",{className:"space-y-0.5",children:He(F,We).map((Je,jt)=>o.jsxs("div",{className:"flex items-center justify-between p-1.5 bg-white rounded border text-xs",children:[o.jsx("span",{className:"font-medium text-xs",children:Je.skill}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsxs("span",{className:"text-muted-foreground text-xs",children:[Je.current,"%/",Je.required,"%"]}),o.jsx(_i,{variant:Je.status==="Met"?"default":"destructive",className:"text-xs px-1 py-0",children:Je.status==="Met"?"✓":`-${Je.gap}%`})]})]},jt))})]})]}),n()&&o.jsx("div",{className:"flex gap-1 pt-2 border-t mt-2",children:o.jsxs(kt,{variant:"outline",size:"sm",className:"flex-1 text-xs gap-1",children:[o.jsx(Y1,{className:"w-3 h-3"}),"Edit"]})})]},We.id))})})]})}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsx("section",{className:"space-y-4",children:o.jsxs(ni,{children:[o.jsx(Ns,{children:o.jsx(us,{className:"flex items-center justify-between",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(C1,{className:"w-5 h-5 text-purple-600"}),"Assessment Results"]})})}),o.jsx(qi,{className:"h-80 overflow-y-auto",children:o.jsx("div",{className:"space-y-4",children:ye.map(We=>o.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:o.jsx(C1,{className:"w-4 h-4 text-purple-600"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium text-sm",children:We.employeeName}),o.jsxs("p",{className:"text-xs text-muted-foreground",children:[We.assessmentType," • ",We.assessor]})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx(_i,{variant:"outline",className:"text-xs mb-1",children:We.status}),o.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(We.date).toLocaleDateString()})]})]},We.id))})})]})}),o.jsx("section",{className:"space-y-4",children:o.jsxs(ni,{children:[o.jsx(Ns,{children:o.jsxs(us,{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ude,{className:"w-5 h-5 text-orange-600"}),"Development Recommendations"]}),o.jsxs(kt,{variant:"default",size:"sm",className:"gap-2",children:[o.jsx($p,{className:"w-4 h-4"}),"Export Report"]})]})}),o.jsx(qi,{className:"h-80 overflow-y-auto",children:o.jsx("div",{className:"grid grid-cols-1 gap-3",children:Ve.map(We=>o.jsxs("div",{className:"border rounded-lg p-3",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("h3",{className:"font-semibold text-sm flex items-center gap-2",children:[We.type==="Training"?o.jsx(s3,{className:"w-4 h-4 text-blue-600"}):o.jsx(K1,{className:"w-4 h-4 text-green-600"}),We.title]}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:We.description})]}),o.jsx(_i,{variant:"outline",className:"text-xs ml-2",children:We.priority})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2 text-xs",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-muted-foreground",children:"Duration:"}),o.jsx("p",{className:"font-medium",children:We.estimatedDuration})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-muted-foreground",children:"Provider:"}),o.jsx("p",{className:"font-medium",children:We.provider})]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(kt,{size:"sm",className:"flex-1 text-xs",children:"Accept"}),o.jsx(kt,{variant:"outline",size:"sm",className:"text-xs",children:"Details"})]})]},We.id))})})]})})]}),o.jsx(ds,{open:$e,onOpenChange:nt,children:o.jsxs(gs,{className:"max-w-md",children:[o.jsx(ys,{children:o.jsx(vs,{children:"Add Skill Assessment"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Employee"}),o.jsxs(Fs,{children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select employee"})}),o.jsx(Vs,{children:$.map(We=>o.jsx(Gn,{value:We.id.toString(),children:We.name},We.id))})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Skill"}),o.jsx(On,{placeholder:"Enter skill name"})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Proficiency Level"}),o.jsxs(Fs,{children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select level"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"beginner",children:"Beginner"}),o.jsx(Gn,{value:"intermediate",children:"Intermediate"}),o.jsx(Gn,{value:"advanced",children:"Advanced"})]})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Proficiency Score (%)"}),o.jsx(On,{type:"number",min:"0",max:"100",placeholder:"0-100"})]})]}),o.jsxs(Co,{children:[o.jsx(kt,{variant:"outline",onClick:()=>nt(!1),children:"Cancel"}),o.jsx(kt,{onClick:()=>nt(!1),children:"Add Skill"})]})]})}),o.jsx(ds,{open:Me,onOpenChange:rt,children:o.jsxs(gs,{className:"max-w-lg",children:[o.jsx(ys,{children:o.jsx(vs,{children:"Add Job Role"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Role Title"}),o.jsx(On,{placeholder:"Enter role title"})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Department"}),o.jsx(On,{placeholder:"Enter department"})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Required Skills"}),o.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Add skills and their required proficiency levels"}),o.jsxs(kt,{variant:"outline",size:"sm",className:"gap-1",children:[o.jsx(Au,{className:"w-3 h-3"}),"Add Skill Requirement"]})]})]}),o.jsxs(Co,{children:[o.jsx(kt,{variant:"outline",onClick:()=>rt(!1),children:"Cancel"}),o.jsx(kt,{onClick:()=>rt(!1),children:"Create Role"})]})]})}),o.jsx(ds,{open:Ee,onOpenChange:it,children:o.jsxs(gs,{className:"max-w-lg",children:[o.jsx(ys,{children:o.jsx(vs,{children:"New Assessment"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Employee"}),o.jsxs(Fs,{children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select employee"})}),o.jsx(Vs,{children:$.map(We=>o.jsx(Gn,{value:We.id.toString(),children:We.name},We.id))})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Assessment Type"}),o.jsxs(Fs,{children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select type"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"manager",children:"Manager Evaluation"}),o.jsx(Gn,{value:"peer",children:"Peer Review"}),o.jsx(Gn,{value:"self",children:"Self Assessment"})]})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Assessment Date"}),o.jsx(On,{type:"date"})]})]}),o.jsxs(Co,{children:[o.jsx(kt,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),o.jsx(kt,{onClick:()=>it(!1),children:"Create Assessment"})]})]})})]}),o.jsx(_ne,{position:"bottom-right"})]})}function Ec({className:e,...t}){return o.jsx("textarea",{"data-slot":"textarea",className:Rn("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}var tN="Tabs",[OFe,x$e]=Eu(tN,[rC]),bne=rC(),[DFe,jF]=OFe(tN),wne=z.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:c,defaultValue:f,orientation:p="horizontal",dir:s,activationMode:w="automatic",...T}=e,E=dT(s),[N,D]=zf({prop:r,onChange:c,defaultProp:f??"",caller:tN});return o.jsx(DFe,{scope:n,baseId:Ml(),value:N,onValueChange:D,orientation:p,dir:E,activationMode:w,children:o.jsx(Si.div,{dir:E,"data-orientation":p,...T,ref:t})})});wne.displayName=tN;var Sne="TabsList",Tne=z.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...c}=e,f=jF(Sne,n),p=bne(n);return o.jsx(DZ,{asChild:!0,...p,orientation:f.orientation,dir:f.dir,loop:r,children:o.jsx(Si.div,{role:"tablist","aria-orientation":f.orientation,...c,ref:t})})});Tne.displayName=Sne;var Ane="TabsTrigger",jne=z.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:c=!1,...f}=e,p=jF(Ane,n),s=bne(n),w=Nne(p.baseId,r),T=Pne(p.baseId,r),E=r===p.value;return o.jsx(kZ,{asChild:!0,...s,focusable:!c,active:E,children:o.jsx(Si.button,{type:"button",role:"tab","aria-selected":E,"aria-controls":T,"data-state":E?"active":"inactive","data-disabled":c?"":void 0,disabled:c,id:w,...f,ref:t,onMouseDown:Yr(e.onMouseDown,N=>{!c&&N.button===0&&N.ctrlKey===!1?p.onValueChange(r):N.preventDefault()}),onKeyDown:Yr(e.onKeyDown,N=>{[" ","Enter"].includes(N.key)&&p.onValueChange(r)}),onFocus:Yr(e.onFocus,()=>{const N=p.activationMode!=="manual";!E&&!c&&N&&p.onValueChange(r)})})})});jne.displayName=Ane;var Ene="TabsContent",Cne=z.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:c,children:f,...p}=e,s=jF(Ene,n),w=Nne(s.baseId,r),T=Pne(s.baseId,r),E=r===s.value,N=z.useRef(E);return z.useEffect(()=>{const D=requestAnimationFrame(()=>N.current=!1);return()=>cancelAnimationFrame(D)},[]),o.jsx(nd,{present:c||E,children:({present:D})=>o.jsx(Si.div,{"data-state":E?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":w,hidden:!D,id:T,tabIndex:0,...p,ref:t,style:{...e.style,animationDuration:N.current?"0s":void 0},children:D&&f})})});Cne.displayName=Ene;function Nne(e,t){return`${e}-trigger-${t}`}function Pne(e,t){return`${e}-content-${t}`}var kFe=wne,IFe=Tne,LFe=jne,zFe=Cne;function EF({className:e,...t}){return o.jsx(kFe,{"data-slot":"tabs",className:Rn("flex flex-col gap-2",e),...t})}function CF({className:e,...t}){return o.jsx(IFe,{"data-slot":"tabs-list",className:Rn("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...t})}function tv({className:e,...t}){return o.jsx(LFe,{"data-slot":"tabs-trigger",className:Rn("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function gE({className:e,...t}){return o.jsx(zFe,{"data-slot":"tabs-content",className:Rn("flex-1 outline-none",e),...t})}function FFe(){const{auth:e}=z.useContext(Vh),t=e?.role==="HR2 Admin",n=e?.role==="Trainer",r=e?.role==="Employee",c=()=>parseInt(e?.employee_id||localStorage.getItem("employeeId")||e?.id),[f,p]=z.useState([]),[s,w]=z.useState([]),[T,E]=z.useState([]),[N,D]=z.useState([]),[V,$]=z.useState([]),[B,F]=z.useState({}),[K,Y]=z.useState(!0),[X,ae]=z.useState(null),[Z,se]=z.useState(""),[he,ye]=z.useState(!1),[Ce,Ve]=z.useState(!1),[Re,$e]=z.useState(!1),[nt,Me]=z.useState(!1),[rt,Ee]=z.useState(!1),[it,et]=z.useState(!1),[mt,He]=z.useState(null),[pt,We]=z.useState(null),[Je,jt]=z.useState({title:"",description:"",category:"",level:"Beginner",schedule_date:"",instructor:"",objectives:"",meeting_link:"",assessment_link:""}),[Pt,Ot]=z.useState({title:"",description:"",courses:[],estimated_hours:""}),[Mt,an]=z.useState(null),[Jt,Cn]=z.useState(null);z.useEffect(()=>{(async()=>{if(e){Y(!0);try{const Fe=c();console.log("Loading LMS data for user:",Fe,"auth object:",e);const[jn,Xn,mr,Ur,yi]=await Promise.all([Ar.learning.courses.getAll(),Ar.learning.learningPlans.getAvailable(Fe),Ar.learning.learningPlans.getByUser(Fe),Ar.learning.dashboard.getLearningProgress(Fe),Ar.learning.progress.getByUser(Fe)]),Hi=(jn.data?.data||[]).map(xr=>({...xr,isEnrolled:xr.enrolled_users?.includes(Fe)||!1}));p(Hi),w(Xn.data?.data||[]),E(mr.data?.data||[]),F({totalCourses:Ur.data?.data?.totalCourses||0,completedCourses:Ur.data?.data?.completedCourses||0,inProgressCourses:Ur.data?.data?.inProgressCourses||0,overallProgress:Ur.data?.data?.overallProgress||0}),D(Ur.data?.data?.recentActivity||[]),$(yi.data?.data||[]),ae(null)}catch(Fe){console.error("Failed to load LMS data:",Fe),ae("Failed to load learning management data"),p(mockData.courseCatalog),E(mockData.learningPlans),w(mockData.availableLearningPlans||[]),F(mockData.progressStats),D(mockData.recentActivity)}finally{Y(!1)}}})()},[e]);const nr=B.completedCourses||0;B.totalCourses;const sn=B.overallProgress||0,zr=ze=>{const Fe=T.find(jn=>jn.id===ze);return Fe?{completed:Fe.completedCourses||0,total:Fe.totalCourses||0,percentage:Fe.progress||0}:{completed:0,total:0,percentage:0}},or=ze=>{switch(ze?.toLowerCase()){case"completed":return"default";case"in_progress":return"secondary";case"not_started":return"outline";default:return"outline"}},Rr=async()=>{if(!Je.title||!Je.description||!Je.category){Zt.error("Please fill in required fields (Title, Description, Category)");return}try{const ze={title:Je.title,description:Je.description,category:Je.category,level:Je.level,schedule_date:Je.schedule_date,instructor:Je.instructor,objectives:Je.objectives};if(Je.meeting_link.trim()&&(ze.meeting_link=Je.meeting_link.trim()),Je.assessment_link.trim()&&(ze.assessment_link=Je.assessment_link.trim()),(await Ar.learning.courses.create(ze)).data){Zt.success("Course created successfully"),ye(!1),jt({title:"",description:"",category:"",level:"Beginner",schedule_date:"",instructor:"",objectives:"",meeting_link:"",assessment_link:""});const jn=await Ar.learning.courses.getAll();p(jn.data?.data||[])}}catch(ze){console.error("Failed to create course:",ze),Zt.error("Failed to create course")}},qr=async()=>{if(!Pt.title||Pt.courses.length===0){Zt.error("Please fill in all required fields");return}try{if((await Ar.learning.learningPlans.create({title:Pt.title,description:Pt.description,courses:Pt.courses,estimated_hours:Pt.estimated_hours})).data){Zt.success("Learning plan created successfully"),Ve(!1),Ot({title:"",description:"",courses:[],estimated_hours:""});const Fe=c(),[jn,Xn]=await Promise.all([Ar.learning.learningPlans.getAvailable(Fe),Ar.learning.learningPlans.getByUser(Fe)]);w(jn.data?.data||[]),E(Xn.data?.data||[])}}catch(ze){console.error("Failed to create learning plan:",ze),Zt.error("Failed to create learning plan")}},Nn=async()=>{if(!Pt.title||Pt.courses.length===0){Zt.error("Please fill in all required fields");return}try{if((await Ar.learning.learningPlans.update(Jt.id,{title:Pt.title,description:Pt.description,courses:Pt.courses,estimated_hours:Pt.estimated_hours})).data){Zt.success("Learning plan updated successfully"),Me(!1),Cn(null),Ot({title:"",description:"",courses:[],estimated_hours:""});const Fe=c(),jn=await Ar.learning.learningPlans.getByUser(Fe);E(jn.data?.data||[])}}catch(ze){console.error("Failed to update learning plan:",ze),Zt.error("Failed to update learning plan")}},ci=ze=>{Ot({title:ze.title,description:ze.description,courses:ze.courses||[],estimated_hours:ze.estimated_hours||""}),Cn(ze),Me(!0)},ui=async ze=>{if(confirm("Are you sure you want to delete this learning plan?"))try{if((await Ar.learning.learningPlans.delete(ze)).data?.success){Zt.success("Learning plan deleted successfully");const jn=c(),Xn=await Ar.learning.learningPlans.getByUser(jn);E(Xn.data?.data||[])}else Zt.error("Failed to delete learning plan")}catch(Fe){console.error("Failed to delete learning plan:",Fe),Zt.error("Failed to delete learning plan")}},st=async ze=>{try{if((await Ar.learning.enrollment.enroll({course_id:ze,user_id:c(),source:"direct"})).data){Zt.success("Successfully enrolled in course");const jn=c(),[Xn,mr,Ur]=await Promise.all([Ar.learning.courses.getAll(),Ar.learning.dashboard.getLearningProgress(jn),Ar.learning.progress.getByUser(jn)]),yi=(Xn.data?.data||[]).map(Hi=>({...Hi,isEnrolled:Hi.enrolled_users?.includes(jn)||!1}));p(yi),F({totalCourses:mr.data?.data?.totalCourses||0,completedCourses:mr.data?.data?.completedCourses||0,inProgressCourses:mr.data?.data?.inProgressCourses||0,overallProgress:mr.data?.data?.overallProgress||0}),D(mr.data?.data?.recentActivity||[]),$(Ur.data?.data||[])}}catch(Fe){console.error("Failed to enroll in course:",Fe),Zt.error("Failed to enroll in course")}},qt=ze=>{an(ze),jt({title:ze.title,description:ze.description,category:ze.category,level:ze.level,schedule_date:ze.schedule_date||"",instructor:ze.instructor,objectives:ze.objectives,meeting_link:ze.meeting_link||"",assessment_link:ze.assessment_link||""}),$e(!0)},rn=ze=>{He(ze),Ee(!0)},Wn=ze=>{const Fe=f.find(Xn=>Xn.id===ze.course_id),jn={...ze,meeting_link:Fe?.meeting_link,assessment_link:Fe?.assessment_link};We(jn),et(!0)},Vt=async()=>{if(!Je.title||!Je.description||!Je.category){Zt.error("Please fill in required fields (Title, Description, Category)");return}try{const ze={title:Je.title,description:Je.description,category:Je.category,level:Je.level,schedule_date:Je.schedule_date,instructor:Je.instructor,objectives:Je.objectives};if(Je.meeting_link.trim()&&(ze.meeting_link=Je.meeting_link.trim()),Je.assessment_link.trim()&&(ze.assessment_link=Je.assessment_link.trim()),(await Ar.learning.courses.update(Mt.id,ze)).data){Zt.success("Course updated successfully"),$e(!1),an(null),jt({title:"",description:"",category:"",level:"Beginner",schedule_date:"",instructor:"",objectives:"",meeting_link:"",assessment_link:""});const jn=await Ar.learning.courses.getAll();p(jn.data?.data||[])}}catch(ze){console.error("Failed to update course:",ze),Zt.error("Failed to update course")}},un=async ze=>{if(confirm("Are you sure you want to delete this course?"))try{if((await Ar.learning.courses.delete(ze)).data){Zt.success("Course deleted successfully");const jn=await Ar.learning.courses.getAll();p(jn.data?.data||[])}}catch(Fe){console.error("Failed to delete course:",Fe),Zt.error("Failed to delete course")}},hr=async ze=>{if(confirm("Are you sure you want to unenroll from this course? Your progress will be lost."))try{if((await Ar.learning.enrollment.unenroll({user_id:c(),course_id:ze})).data){Zt.success("Successfully unenrolled from course");const jn=c(),[Xn,mr,Ur]=await Promise.all([Ar.learning.courses.getAll(),Ar.learning.dashboard.getLearningProgress(jn),Ar.learning.progress.getByUser(jn)]),yi=(Xn.data?.data||[]).map(Hi=>({...Hi,isEnrolled:Hi.enrolled_users?.includes(jn)||!1}));p(yi),F({totalCourses:mr.data?.data?.totalCourses||0,completedCourses:mr.data?.data?.completedCourses||0,inProgressCourses:mr.data?.data?.inProgressCourses||0,overallProgress:mr.data?.data?.overallProgress||0}),D(mr.data?.data?.recentActivity||[]),$(Ur.data?.data||[])}}catch(Fe){console.error("Failed to unenroll from course:",Fe),Zt.error("Failed to unenroll from course")}},$t=async ze=>{try{const Fe=parseInt(c());if((await Ar.learning.learningPlans.enroll(ze,Fe)).data){Zt.success("Successfully enrolled in learning plan! All courses have been added to your learning progress.");const[Xn,mr,Ur,yi,Hi]=await Promise.all([Ar.learning.learningPlans.getAvailable(Fe),Ar.learning.learningPlans.getByUser(Fe),Ar.learning.dashboard.getLearningProgress(Fe),Ar.learning.progress.getByUser(Fe),Ar.learning.courses.getAll()]);w(Xn.data?.data||[]),E(mr.data?.data||[]),F({totalCourses:Ur.data?.data?.totalCourses||0,completedCourses:Ur.data?.data?.completedCourses||0,inProgressCourses:Ur.data?.data?.inProgressCourses||0,overallProgress:Ur.data?.data?.overallProgress||0}),D(Ur.data?.data?.recentActivity||[]),$(yi.data?.data||[]);const xr=(Hi.data?.data||[]).map(dr=>({...dr,isEnrolled:dr.enrolled_users?.includes(Fe)||!1}));p(xr)}}catch(Fe){console.log("Error in handleEnrollInLearningPlan:",Fe),console.log("Error response:",Fe.response),console.log("Error status:",Fe.response?.status),Fe.response?.status===409?Zt.info("You are already enrolled in this learning plan."):(console.error("Failed to enroll in learning plan:",Fe),Zt.error("Failed to enroll in learning plan"))}},lr=async ze=>{try{const Fe=c();if((await Ar.learning.learningPlans.unenroll(ze,Fe)).data){Zt.success("Successfully unenrolled from learning plan.");const[Xn,mr,Ur,yi,Hi]=await Promise.all([Ar.learning.learningPlans.getAvailable(Fe),Ar.learning.learningPlans.getByUser(Fe),Ar.learning.dashboard.getLearningProgress(Fe),Ar.learning.progress.getByUser(Fe),Ar.learning.courses.getAll()]);w(Xn.data?.data||[]),E(mr.data?.data||[]),F({totalCourses:Ur.data?.data?.totalCourses||0,completedCourses:Ur.data?.data?.completedCourses||0,inProgressCourses:Ur.data?.data?.inProgressCourses||0,overallProgress:Ur.data?.data?.overallProgress||0}),D(Ur.data?.data?.recentActivity||[]),$(yi.data?.data||[]);const xr=(Hi.data?.data||[]).map(dr=>({...dr,isEnrolled:dr.enrolled_users?.includes(Fe)||!1}));p(xr)}}catch(Fe){console.error("Failed to unenroll from learning plan:",Fe),Zt.error("Failed to unenroll from learning plan")}};return K?o.jsx("div",{className:"min-h-screen bg-gray-50/30 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary mx-auto"}),o.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading Learning Management..."})]})}):X?o.jsx("div",{className:"min-h-screen bg-gray-50/30 flex items-center justify-center",children:o.jsxs("div",{className:"text-center max-w-md",children:[o.jsx("div",{className:"text-red-500 mb-4",children:o.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Error Loading Learning Management"}),o.jsx("p",{className:"text-gray-600 mb-4",children:X}),o.jsx(kt,{onClick:()=>window.location.reload(),children:"Try Again"})]})}):o.jsxs("div",{className:"min-h-screen bg-gray-50/30",children:[o.jsx("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur",children:o.jsx("div",{className:"container flex h-12 items-center justify-between px-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(s3,{className:"h-5 w-5 text-primary"}),o.jsx("h1",{className:"text-lg font-semibold",children:"Learning Management"})]})})}),o.jsxs("div",{className:"container mx-auto px-4 py-6 space-y-6",children:[o.jsxs(ni,{children:[o.jsx("div",{className:"p-4 border-b",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ck,{className:"w-5 h-5 text-amber-600"}),o.jsx("h2",{className:"text-lg font-semibold",children:"Course Catalog"}),o.jsxs("div",{className:"flex items-center gap-2 justify-end ml-auto",children:[o.jsxs("div",{className:"relative",children:[o.jsx(nT,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),o.jsx(On,{placeholder:"Search courses...",value:Z,onChange:ze=>se(ze.target.value),className:"pl-10 w-64 h-9"})]}),(t||n)&&o.jsx(ds,{open:he,onOpenChange:ye,children:o.jsx(kf,{asChild:!0,children:o.jsxs(kt,{size:"sm",children:[o.jsx(Au,{className:"w-4 h-4 mr-1"}),"New Course"]})})})]})]})}),o.jsxs(qi,{className:"p-4",children:[o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:(f||[]).filter(ze=>{const Fe=ze.title.toLowerCase().includes(Z.toLowerCase())||ze.description.toLowerCase().includes(Z.toLowerCase())||ze.category.toLowerCase().includes(Z.toLowerCase()),jn=ze.isEnrolled||N.some(mr=>mr.course_id===ze.id);return Fe&&(t||n||!jn)}).map(ze=>{ze.isEnrolled;const Fe=N.find(jn=>jn.course_id===ze.id);return o.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsx("h3",{className:"font-medium text-sm",children:ze.title}),o.jsxs("span",{className:"flex gap-1",children:[o.jsx(_i,{variant:"secondary",className:"text-xs",children:ze.category}),o.jsx(_i,{variant:"outline",className:"text-xs",children:ze.level})]})]}),o.jsx("p",{className:"text-xs text-muted-foreground mb-3 line-clamp-2",children:ze.description}),o.jsxs("div",{className:"space-y-2 mb-3",children:[o.jsx("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(Hp,{className:"w-3 h-3"}),ze.schedule_date?new Date(ze.schedule_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})+" - "+new Date(ze.schedule_date).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"Schedule TBD"]})}),Fe&&o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex items-center justify-between text-xs",children:[o.jsx("span",{children:"Progress"}),o.jsxs("span",{children:[Fe.progress,"%"]})]}),o.jsx(Df,{value:Fe.progress,className:"h-1"})]})]}),o.jsx("div",{className:"flex items-center justify-between mt-3 pt-3 border-t",children:t||n?o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(kt,{size:"sm",variant:"outline",onClick:()=>qt(ze),children:[o.jsx(Y1,{className:"w-3 h-3 mr-1"}),"Edit"]}),o.jsxs(kt,{size:"sm",variant:"destructive",onClick:()=>un(ze.id),children:[o.jsx(qA,{className:"w-3 h-3"}),"Delete"]})]}):o.jsx("div",{className:"flex flex-col gap-2 w-full",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(kt,{size:"sm",variant:"outline",onClick:()=>rn(ze),children:"View"}),r&&!ze.isEnrolled&&o.jsxs(kt,{size:"sm",onClick:()=>st(ze.id),children:[o.jsx(kh,{className:"w-3 h-3 mr-1"}),"Enroll"]})]}),r&&Fe&&Fe.status==="completed"&&o.jsxs(kt,{size:"sm",variant:"outline",children:[o.jsx(W0,{className:"w-3 h-3 mr-1"}),"Review"]})]})})})]},ze.id)})}),(f||[]).filter(ze=>{const Fe=ze.title.toLowerCase().includes(Z.toLowerCase())||ze.description.toLowerCase().includes(Z.toLowerCase())||ze.category.toLowerCase().includes(Z.toLowerCase()),jn=ze.isEnrolled||N.some(mr=>mr.course_id===ze.id);return Fe&&(t||n||!jn)}).length===0&&o.jsxs("div",{className:"text-center py-8 text-gray-500",children:[o.jsx(Ck,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),o.jsx("p",{className:"text-sm",children:"No courses available"}),o.jsx("p",{className:"text-xs",children:"Courses will appear here when created by administrators"})]})]})]}),o.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-1 gap-6",children:o.jsxs(ni,{children:[o.jsx("div",{className:"p-4 border-b",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(NA,{className:"w-5 h-5 text-purple-600"}),o.jsx("h2",{className:"text-lg font-semibold",children:"Learning Plans"}),(t||n)&&o.jsx(ds,{open:Ce,onOpenChange:Ve,children:o.jsx(kf,{asChild:!0,children:o.jsxs(kt,{size:"sm",className:"ml-auto",children:[o.jsx(Au,{className:"w-4 h-4 mr-1"}),"New Plan"]})})})]})}),o.jsx(qi,{className:"p-4",children:o.jsxs("div",{className:"space-y-3",children:[s.map(ze=>(zr(ze.id),o.jsxs("div",{className:"border rounded-lg p-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h3",{className:"font-medium text-sm",children:ze.title}),o.jsxs(_i,{variant:"secondary",className:"text-xs",children:[ze.courses?.length||0," courses"]})]}),o.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:ze.description}),o.jsxs("div",{className:"flex items-center justify-between",children:[ze.estimated_hours&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[o.jsx(Kp,{className:"h-3 w-3"}),o.jsxs("span",{children:["Estimated: ",ze.estimated_hours," hours"]})]}),o.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[!(t||n)&&o.jsxs(kt,{size:"sm",variant:"outline",className:"h-6 px-2 text-xs",onClick:()=>$t(ze.id),children:[o.jsx(kh,{className:"w-3 h-3 mr-1"}),"Apply"]}),(t||n)&&o.jsxs(o.Fragment,{children:[o.jsxs(kt,{size:"sm",variant:"outline",className:"h-7 px-2 text-xs",onClick:()=>ci(ze),children:[o.jsx(Y1,{className:"w-3 h-3 mr-1"}),"Edit"]}),o.jsxs(kt,{size:"sm",variant:"destructive",className:"h-7 px-2 text-xs",onClick:()=>ui(ze.id),children:[o.jsx(qA,{className:"w-3 h-3 mr-1"}),"Delete"]})]})]})]})]},ze.id))),s.length===0&&o.jsxs("div",{className:"text-center py-8 text-gray-500",children:[o.jsx(NA,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),o.jsx("p",{className:"text-sm",children:"No learning plans available"}),o.jsx("p",{className:"text-xs",children:"Learning plans will appear here when created by administrators"})]})]})})]})}),o.jsxs(ni,{children:[o.jsx("div",{className:"p-4 border-b",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(C1,{className:"w-5 h-5 text-blue-600"}),o.jsx("h2",{className:"text-lg font-semibold",children:"Learning Progress"})]})}),o.jsxs(qi,{className:"p-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"flex items-center justify-center gap-1 text-green-600 mb-1",children:[o.jsx(Wy,{className:"h-4 w-4"}),o.jsx("span",{className:"text-2xl font-bold",children:nr})]}),o.jsx("span",{className:"text-sm text-muted-foreground",children:"Completed"})]}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"flex items-center justify-center gap-1 text-yellow-600 mb-1",children:[o.jsx(Kp,{className:"h-4 w-4"}),o.jsx("span",{className:"text-2xl font-bold",children:B.inProgressCourses||0})]}),o.jsx("span",{className:"text-sm text-muted-foreground",children:"In Progress"})]}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"flex items-center justify-center gap-1 text-blue-600 mb-1",children:[o.jsx(W0,{className:"h-4 w-4"}),o.jsxs("span",{className:"text-2xl font-bold",children:[sn,"%"]})]}),o.jsx("span",{className:"text-sm text-muted-foreground",children:"Overall"})]})]}),o.jsxs(EF,{defaultValue:"courses",className:"w-full",children:[o.jsxs(CF,{className:"grid w-full grid-cols-2",children:[o.jsx(tv,{value:"courses",children:"Enrolled Courses"}),o.jsx(tv,{value:"plans",children:"Assigned Learning Plans"})]}),o.jsx(gE,{value:"courses",className:"mt-4",children:o.jsx("div",{className:"space-y-2",children:V.length>0?V.map(ze=>o.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`w-2 h-2 rounded-full ${ze.status==="completed"?"bg-green-500":ze.status==="in_progress"?"bg-yellow-500":"bg-gray-300"}`}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium",children:ze.course_title}),o.jsx("p",{className:"text-xs text-muted-foreground",children:(()=>{const jn=f.find(Xn=>Xn.title===ze.course_title)?.schedule_date;return jn?`Schedule: ${new Date(jn).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})} - ${new Date(jn).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:`Enrolled: ${new Date(ze.enrollment_date||ze.last_accessed||new Date).toLocaleDateString()}`})()})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(_i,{variant:or(ze.status),className:"text-xs",children:ze.status.replace("_"," ")}),o.jsxs("span",{className:"text-sm font-medium",children:[ze.progress,"%"]}),o.jsxs("div",{className:"flex gap-1 ml-2",children:[o.jsx(kt,{size:"sm",variant:"outline",className:"h-7 px-2 text-xs",onClick:()=>Wn(ze),children:"View"}),o.jsx(kt,{size:"sm",variant:"destructive",className:"h-7 px-2 text-xs",onClick:()=>hr(ze.course_id),children:"Unenroll"})]})]})]},ze.id)):o.jsxs("div",{className:"text-center py-8 text-gray-500",children:[o.jsx(kh,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),o.jsx("p",{className:"text-sm",children:"No enrolled courses yet"}),o.jsx("p",{className:"text-xs",children:"Enroll in courses from the catalog above"})]})})}),o.jsx(gE,{value:"plans",className:"mt-4",children:o.jsx("div",{className:"space-y-2",children:T.length>0?T.map(ze=>{const Fe=zr(ze.id);return o.jsxs("div",{className:"border rounded-lg p-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h3",{className:"font-medium text-sm",children:ze.title}),o.jsxs(_i,{variant:"secondary",className:"text-xs",children:[Fe.completed,"/",Fe.total]})]}),o.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:ze.description}),ze.estimated_hours&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground mb-3",children:[o.jsx(Kp,{className:"h-3 w-3"}),o.jsxs("span",{children:["Estimated: ",ze.estimated_hours," hours"]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between text-xs",children:[o.jsx("span",{children:"Progress"}),o.jsxs("span",{children:[Fe.percentage,"%"]})]}),o.jsx(Df,{value:Fe.percentage,className:"h-2"})]}),o.jsx("div",{className:"flex items-center justify-end mt-3 text-xs text-muted-foreground",children:Fe.percentage===100?o.jsx(_i,{variant:"default",className:"text-xs",children:"Completed"}):o.jsxs(kt,{size:"sm",variant:"destructive",className:"h-6 px-2 text-xs",onClick:()=>lr(ze.id),children:[o.jsx(bg,{className:"w-3 h-3 mr-1"}),"Cancel Apply"]})})]},ze.id)}):o.jsxs("div",{className:"text-center py-8 text-gray-500",children:[o.jsx(NA,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),o.jsx("p",{className:"text-sm",children:"No assigned learning plans"}),o.jsx("p",{className:"text-xs",children:"Learning plans will appear here when assigned"})]})})})]})]})]}),o.jsx(ds,{open:he,onOpenChange:ye,children:o.jsxs(gs,{className:"max-w-md",children:[o.jsxs(ys,{children:[o.jsx(vs,{children:"Create New Course"}),o.jsx(Cc,{children:"Add a new course to the learning catalog"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Course Title *"}),o.jsx(On,{placeholder:"Enter course title",value:Je.title,onChange:ze=>jt(Fe=>({...Fe,title:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Category *"}),o.jsxs(Fs,{value:Je.category,onValueChange:ze=>jt(Fe=>({...Fe,category:ze})),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select category"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Management",children:"Management"}),o.jsx(Gn,{value:"Leadership",children:"Leadership"}),o.jsx(Gn,{value:"Technical",children:"Technical"}),o.jsx(Gn,{value:"Compliance",children:"Compliance"}),o.jsx(Gn,{value:"Soft Skills",children:"Soft Skills"})]})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Level"}),o.jsxs(Fs,{value:Je.level,onValueChange:ze=>jt(Fe=>({...Fe,level:ze})),children:[o.jsx(Us,{children:o.jsx(Bs,{})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Beginner",children:"Beginner"}),o.jsx(Gn,{value:"Intermediate",children:"Intermediate"}),o.jsx(Gn,{value:"Advanced",children:"Advanced"})]})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Schedule Date"}),o.jsx(On,{type:"datetime-local",value:Je.schedule_date,onChange:ze=>jt(Fe=>({...Fe,schedule_date:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Instructor"}),o.jsx(On,{placeholder:"Enter instructor name",value:Je.instructor,onChange:ze=>jt(Fe=>({...Fe,instructor:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Description"}),o.jsx(Ec,{placeholder:"Enter course description",value:Je.description,onChange:ze=>jt(Fe=>({...Fe,description:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Learning Objectives"}),o.jsx(Ec,{placeholder:"Enter learning objectives",value:Je.objectives,onChange:ze=>jt(Fe=>({...Fe,objectives:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Meeting Link (Zoom/Google Meet)"}),o.jsx(On,{placeholder:"https://zoom.us/j/... or https://meet.google.com/...",value:Je.meeting_link,onChange:ze=>jt(Fe=>({...Fe,meeting_link:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Assessment Link (Google Forms)"}),o.jsx(On,{placeholder:"https://forms.google.com/...",value:Je.assessment_link,onChange:ze=>jt(Fe=>({...Fe,assessment_link:ze.target.value}))})]})]}),o.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[o.jsx(kt,{variant:"outline",onClick:()=>ye(!1),children:"Cancel"}),o.jsx(kt,{onClick:Rr,children:"Create Course"})]})]})}),o.jsx(ds,{open:Ce,onOpenChange:Ve,children:o.jsxs(gs,{className:"max-w-md",children:[o.jsxs(ys,{children:[o.jsx(vs,{children:"Create Learning Plan"}),o.jsx(Cc,{children:"Create a structured learning path with multiple courses"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Plan Title *"}),o.jsx(On,{placeholder:"Enter plan title",value:Pt.title,onChange:ze=>Ot(Fe=>({...Fe,title:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Description"}),o.jsx(Ec,{placeholder:"Enter plan description",value:Pt.description,onChange:ze=>Ot(Fe=>({...Fe,description:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Estimated Hours"}),o.jsx(On,{type:"number",placeholder:"e.g., 20",value:Pt.estimated_hours,onChange:ze=>Ot(Fe=>({...Fe,estimated_hours:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Select Courses *"}),o.jsx("div",{className:"max-h-40 overflow-y-auto border rounded-md p-2 space-y-2",children:(f||[]).slice(0,10).map(ze=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",id:`course-${ze.id}`,checked:Pt.courses.includes(ze.id),onChange:Fe=>{const jn=Fe.target.checked;Ot(Xn=>({...Xn,courses:jn?[...Xn.courses,ze.id]:Xn.courses.filter(mr=>mr!==ze.id)}))},className:"rounded"}),o.jsxs("label",{htmlFor:`course-${ze.id}`,className:"text-sm",children:[ze.title," (",ze.category,")"]})]},ze.id))}),Pt.courses.length===0&&o.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Please select at least one course"})]})]}),o.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[o.jsx(kt,{variant:"outline",onClick:()=>Ve(!1),children:"Cancel"}),o.jsx(kt,{onClick:qr,children:"Create Plan"})]})]})}),o.jsx(ds,{open:rt,onOpenChange:Ee,children:o.jsxs(gs,{className:"max-w-md",children:[o.jsxs(ys,{children:[o.jsx(vs,{children:mt?.title}),o.jsx(Cc,{children:"Course details and information"})]}),mt&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(_i,{variant:"secondary",children:mt.category}),o.jsx(_i,{variant:"outline",children:mt.level})]}),o.jsxs("div",{children:[o.jsx(bt,{className:"text-sm font-medium",children:"Description"}),o.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:mt.description})]}),mt.objectives&&o.jsxs("div",{children:[o.jsx(bt,{className:"text-sm font-medium",children:"Learning Objectives"}),o.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:mt.objectives})]}),o.jsxs("div",{className:"text-sm",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Schedule"}),o.jsxs("p",{className:"text-muted-foreground mt-1 flex items-center gap-1",children:[o.jsx(Hp,{className:"w-3 h-3"}),mt.schedule_date?new Date(mt.schedule_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})+" - "+new Date(mt.schedule_date).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"TBD"]})]}),o.jsxs("div",{className:"text-sm",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Enrolled"}),o.jsxs("p",{className:"text-muted-foreground mt-1 flex items-center gap-1",children:[o.jsx(Hy,{className:"w-3 h-3"}),mt.enrolledCount," students"]})]}),mt.instructor&&o.jsxs("div",{children:[o.jsx(bt,{className:"text-sm font-medium",children:"Instructor"}),o.jsx("p",{className:"text-muted-foreground mt-1",children:mt.instructor})]}),o.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[o.jsxs("div",{className:"text-xs text-muted-foreground",children:["Rating: ",mt.rating,"/5.0"]}),r&&!mt.isEnrolled&&o.jsxs(kt,{size:"sm",onClick:()=>{st(mt.id),Ee(!1)},children:[o.jsx(kh,{className:"w-3 h-3 mr-1"}),"Enroll in Course"]})]})]})]})}),o.jsx(ds,{open:it,onOpenChange:et,children:o.jsxs(gs,{className:"max-w-md",children:[o.jsxs(ys,{children:[o.jsx(vs,{children:pt?.course_title}),o.jsx(Cc,{children:"Your learning progress and course resources"})]}),pt&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(_i,{variant:or(pt.status),children:pt.status.replace("_"," ")}),o.jsxs("span",{className:"text-sm font-medium",children:[pt.progress,"% Complete"]})]}),o.jsxs("div",{children:[o.jsx(bt,{className:"text-sm font-medium",children:"Progress"}),o.jsx(Df,{value:pt.progress,className:"mt-2"})]}),o.jsxs("div",{className:"text-sm text-muted-foreground",children:[(()=>{const Fe=f.find(jn=>jn.title===pt.course_title)?.schedule_date;return o.jsx("p",{children:Fe?`Schedule: ${new Date(Fe).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})} - ${new Date(Fe).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:`Enrolled: ${new Date(pt.enrollment_date||pt.last_accessed||new Date).toLocaleDateString()}`})})(),pt.last_accessed&&o.jsxs("p",{children:["Last accessed: ",new Date(pt.last_accessed).toLocaleDateString()]})]}),o.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Course Resources"}),pt.meeting_link&&o.jsx("div",{className:"flex items-center gap-2",children:o.jsxs(kt,{size:"sm",variant:"outline",className:"w-full justify-start",onClick:()=>window.open(pt.meeting_link,"_blank"),children:[o.jsx(ehe,{className:"w-3 h-3 mr-2"}),"Join Meeting"]})}),pt.assessment_link&&o.jsx("div",{className:"flex items-center gap-2",children:o.jsxs(kt,{size:"sm",variant:"outline",className:"w-full justify-start",onClick:()=>window.open(pt.assessment_link,"_blank"),children:[o.jsx(Wy,{className:"w-3 h-3 mr-2"}),"Take Assessment"]})}),!pt.meeting_link&&!pt.assessment_link&&o.jsx("p",{className:"text-xs text-muted-foreground",children:"No resources available yet"})]}),o.jsx("div",{className:"flex justify-end gap-2 pt-2 border-t",children:o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>et(!1),children:"Close"})})]})]})}),o.jsx(ds,{open:Re,onOpenChange:$e,children:o.jsxs(gs,{className:"max-w-md",children:[o.jsxs(ys,{children:[o.jsx(vs,{children:"Edit Course"}),o.jsx(Cc,{children:"Update course information"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Course Title *"}),o.jsx(On,{placeholder:"Enter course title",value:Je.title,onChange:ze=>jt(Fe=>({...Fe,title:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Category *"}),o.jsxs(Fs,{value:Je.category,onValueChange:ze=>jt(Fe=>({...Fe,category:ze})),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select category"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Management",children:"Management"}),o.jsx(Gn,{value:"Leadership",children:"Leadership"}),o.jsx(Gn,{value:"Technical",children:"Technical"}),o.jsx(Gn,{value:"Compliance",children:"Compliance"}),o.jsx(Gn,{value:"Soft Skills",children:"Soft Skills"})]})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Level"}),o.jsxs(Fs,{value:Je.level,onValueChange:ze=>jt(Fe=>({...Fe,level:ze})),children:[o.jsx(Us,{children:o.jsx(Bs,{})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Beginner",children:"Beginner"}),o.jsx(Gn,{value:"Intermediate",children:"Intermediate"}),o.jsx(Gn,{value:"Advanced",children:"Advanced"})]})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Schedule Date"}),o.jsx(On,{type:"datetime-local",value:Je.schedule_date,onChange:ze=>jt(Fe=>({...Fe,schedule_date:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Instructor"}),o.jsx(On,{placeholder:"Enter instructor name",value:Je.instructor,onChange:ze=>jt(Fe=>({...Fe,instructor:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Description"}),o.jsx(Ec,{placeholder:"Enter course description",value:Je.description,onChange:ze=>jt(Fe=>({...Fe,description:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Learning Objectives"}),o.jsx(Ec,{placeholder:"Enter learning objectives",value:Je.objectives,onChange:ze=>jt(Fe=>({...Fe,objectives:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Meeting Link (Zoom/Google Meet)"}),o.jsx(On,{placeholder:"https://zoom.us/j/... or https://meet.google.com/...",value:Je.meeting_link,onChange:ze=>jt(Fe=>({...Fe,meeting_link:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Assessment Link (Google Forms)"}),o.jsx(On,{placeholder:"https://forms.google.com/...",value:Je.assessment_link,onChange:ze=>jt(Fe=>({...Fe,assessment_link:ze.target.value}))})]})]}),o.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[o.jsx(kt,{variant:"outline",onClick:()=>{$e(!1),an(null),jt({title:"",description:"",category:"",level:"Beginner",schedule_date:"",instructor:"",objectives:"",meeting_link:"",assessment_link:""})},children:"Cancel"}),o.jsx(kt,{onClick:Vt,children:"Update Course"})]})]})}),o.jsx(ds,{open:nt,onOpenChange:Me,children:o.jsxs(gs,{className:"max-w-md",children:[o.jsxs(ys,{children:[o.jsx(vs,{children:"Edit Learning Plan"}),o.jsx(Cc,{children:"Update the learning plan details and course selection"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Plan Title *"}),o.jsx(On,{placeholder:"Enter plan title",value:Pt.title,onChange:ze=>Ot(Fe=>({...Fe,title:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Description"}),o.jsx(Ec,{placeholder:"Enter plan description",value:Pt.description,onChange:ze=>Ot(Fe=>({...Fe,description:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Estimated Hours"}),o.jsx(On,{type:"number",placeholder:"e.g., 20",value:Pt.estimated_hours,onChange:ze=>Ot(Fe=>({...Fe,estimated_hours:ze.target.value}))})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Select Courses *"}),o.jsx("div",{className:"max-h-40 overflow-y-auto border rounded-md p-2 space-y-2",children:(f||[]).slice(0,10).map(ze=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",id:`edit-course-${ze.id}`,checked:Pt.courses.includes(ze.id),onChange:Fe=>{const jn=Fe.target.checked;Ot(Xn=>({...Xn,courses:jn?[...Xn.courses,ze.id]:Xn.courses.filter(mr=>mr!==ze.id)}))},className:"rounded"}),o.jsxs("label",{htmlFor:`edit-course-${ze.id}`,className:"text-sm",children:[ze.title," (",ze.category,")"]})]},ze.id))}),Pt.courses.length===0&&o.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Please select at least one course"})]})]}),o.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[o.jsx(kt,{variant:"outline",onClick:()=>{Me(!1),Cn(null),Ot({title:"",description:"",courses:[],estimated_hours:""})},children:"Cancel"}),o.jsx(kt,{onClick:Nn,children:"Update Plan"})]})]})}),o.jsx(KS,{})]})]})}const BFe=()=>{const{auth:e}=z.useContext(Vh),t=()=>e?.role==="HR2 Admin",n=()=>e?.role==="Trainer",r=()=>e?.employee_id||localStorage.getItem("employeeId")||e?.id,c=()=>e?.role==="Employee",[f,p]=z.useState([]),[s,w]=z.useState([]),[T,E]=z.useState([]),[N,D]=z.useState([]),[V,$]=z.useState({totalTrainings:0,enrolledTrainings:0,completedTrainings:0,upcomingSessions:0}),[B,F]=z.useState(""),[K,Y]=z.useState(""),[X,ae]=z.useState(""),[Z,se]=z.useState(""),[he,ye]=z.useState("upcoming"),[Ce,Ve]=z.useState(null),[Re,$e]=z.useState(!0),[nt,Me]=z.useState(!0),[rt,Ee]=z.useState(new Set),it={trainings:6e4,enrollments:3e4,applications:2e4},[et,mt]=z.useState(!1),[He,pt]=z.useState(!1),[We,Je]=z.useState(!1),[jt,Pt]=z.useState(!1),[Ot,Mt]=z.useState(!1),[an,Jt]=z.useState(!1),[Cn,nr]=z.useState(!1),[sn,zr]=z.useState(!1),[or,Rr]=z.useState(null),[qr,Nn]=z.useState(null),[ci,ui]=z.useState(null),[st,qt]=z.useState(null),[rn,Wn]=z.useState([]),[Vt,un]=z.useState({title:"",description:"",trainer:"",duration:"",topic:"",targetRole:"",startDate:"",endDate:"",maxParticipants:"",location:"",difficulty:"Beginner",format:"In-Person",prerequisites:"",objectives:""}),[hr,$t]=z.useState({notes:""}),[lr,ze]=z.useState({sessionTitle:"",sessionDescription:"",startDateTime:"",endDateTime:"",location:"",maxAttendees:""});z.useEffect(()=>{(async()=>{if(e){Ve(null);try{await Fe(!0),c()&&(await jn(!0),await Xn(!0),await mr(!0)),$e(!1)}catch(fe){console.error("Failed to load training data:",fe),Ve("Failed to load training data"),$e(!1)}}})()},[e]),z.useEffect(()=>{st&&sn&&Rt(st.id)},[st,sn]),z.useEffect(()=>{if(!e||!nt)return;const Q=setInterval(()=>{Fe()},it.trainings);let fe;c()&&(fe=setInterval(()=>{jn(),Xn(),mr()},it.enrollments));let Te;return(t()||n())&&(Te=setInterval(()=>{Fe()},it.applications)),()=>{clearInterval(Q),fe&&clearInterval(fe),Te&&clearInterval(Te)}},[e,nt]);const Fe=async(Q=!1)=>{try{const fe=await Ar.training.getAll({search:B,topic:K,role:X,date:Z});if(fe&&fe.data&&fe.data.length){const Te=fe.data.map(ke=>({...ke,title:ke.program_name||ke.title||"",topic:ke.target_skills||ke.topic||"",targetRole:ke.required_role||ke.targetRole||"",startDate:ke.start_date||ke.startDate||"",endDate:ke.end_date||ke.endDate||"",maxParticipants:ke.max_participants||ke.maxParticipants||0,enrolled:ke.enrolled_count||ke.enrolled||0,rating:ke.rating||ke.feedback_score||0}));p(Te)}else p([]);$(Te=>({...Te,totalTrainings:fe&&fe.data?fe.data.length:0}))}catch(fe){console.error("Failed to load training data:",fe),Q||Zt.error("Failed to load training data")}},jn=async(Q=!1)=>{try{const fe=await Ar.trainingApplications.getByEmployee(r());if(fe&&fe.data&&fe.data.length){const Te=fe.data.filter(ke=>ke.status!=="rejected"&&ke.status!=="completed"&&ke.status!=="cancelled");w(Te),Ee(new Set),$(ke=>({...ke,enrolledTrainings:Te.length,upcomingSessions:Te.filter(Oe=>Oe.status==="approved").length}))}else w([]),$(Te=>({...Te,enrolledTrainings:0,upcomingSessions:0}))}catch(fe){console.error("Failed to load enrollments:",fe),Q||Zt.error("Failed to load enrollments")}},Xn=async(Q=!1)=>{try{const fe=await Ar.trainingCompletions.getByEmployee(r());if(fe&&fe.data&&fe.data.length){const Te=fe.data.map(ke=>({id:ke.id,trainingName:ke.training?.program_name||ke.training?.title||"Unknown Training",completionDate:ke.completion_date,score:ke.score_percentage||0,grade:ke.grade||"N/A",competencies:Array.isArray(ke.competencies_gained)?ke.competencies_gained:ke.competencies_gained?JSON.parse(ke.competencies_gained):[],certificateId:ke.id,training:ke.training,application:ke.application}));E(Te)}else E([]);$(Te=>({...Te,completedTrainings:T.length}))}catch(fe){console.error("Failed to load completed trainings:",fe),Q||Zt.error("Failed to load completed trainings")}},mr=async(Q=!1)=>{try{const fe=await Ar.trainingFeedback.getByEmployee(r());fe&&fe.data&&fe.data.length?D(fe.data):D([])}catch(fe){console.error("Failed to load feedback data:",fe),Q||Zt.error("Failed to load feedback data")}},Ur=async()=>{if(!Vt.title||!Vt.duration||!Vt.topic){Zt.error("Please fill in all required fields");return}try{const Q=await Ar.training.create({title:Vt.title,description:Vt.description,objectives:Vt.objectives,trainer:Vt.trainer,duration:Vt.duration,topic:Vt.topic,targetRole:Vt.targetRole,prerequisites:Vt.prerequisites,startDate:Vt.startDate,endDate:Vt.endDate,maxParticipants:Vt.maxParticipants,location:Vt.location,difficulty:Vt.difficulty,format:Vt.format});Q.data&&Q.data.success?(Zt.success("Training created successfully"),mt(!1),un({title:"",description:"",trainer:"",duration:"",topic:"",targetRole:"",startDate:"",endDate:"",maxParticipants:"",location:"",difficulty:"Beginner",format:"In-Person",prerequisites:"",objectives:""}),Fe()):Zt.error(Q.data?.message||"Failed to create training")}catch(Q){console.error("Failed to create training:",Q),Zt.error("Failed to create training")}},yi=Q=>{ui(Q),un({title:Q.title,description:Q.description,trainer:Q.trainer,duration:Q.duration,topic:Q.topic,targetRole:Q.targetRole,startDate:Q.startDate,endDate:Q.endDate,maxParticipants:Q.maxParticipants,location:Q.location,difficulty:Q.difficulty,format:Q.format,prerequisites:Q.prerequisites||"",objectives:Q.objectives||""}),pt(!0)},Hi=async()=>{if(!Vt.title||!Vt.duration||!Vt.topic){Zt.error("Please fill in all required fields");return}try{const Q=await Ar.training.update(ci.id,{title:Vt.title,description:Vt.description,objectives:Vt.objectives,trainer:Vt.trainer,duration:Vt.duration,topic:Vt.topic,targetRole:Vt.targetRole,prerequisites:Vt.prerequisites,startDate:Vt.startDate,endDate:Vt.endDate,maxParticipants:Vt.maxParticipants,location:Vt.location,difficulty:Vt.difficulty,format:Vt.format});Q.data&&Q.data.success?(Zt.success("Training updated successfully"),pt(!1),ui(null),Fe()):Zt.error(Q.data?.message||"Failed to update training")}catch(Q){console.error("Failed to update training:",Q),Zt.error("Failed to update training")}},xr=async Q=>{if(confirm(`Are you sure you want to remove "${Q.title}" from the catalog? Employee training history will be preserved.`))try{const fe=await Ar.training.delete(Q.id);fe.data&&fe.data.success?(Zt.success("Training removed from catalog successfully"),Fe()):Zt.error(fe.data?.message||"Failed to remove training")}catch(fe){console.error("Failed to remove training:",fe),Zt.error("Failed to remove training")}},dr=Q=>{Rr(Q),Je(!0)},Ki=Q=>{Rr(Q),$t({notes:""}),Pt(!0)},Di=async()=>{try{const Q=parseInt(r()),fe=parseInt(or.id);console.log("Submitting enrollment with:",{training_id:fe,employee_id:Q,notes:hr.notes});const Te=await Ar.trainingApplications.apply({training_id:fe,employee_id:Q,notes:hr.notes});Te.data&&Te.data.success?(Zt.success("Training enrollment submitted successfully"),Pt(!1),Rr(null),$t({notes:""}),Ee(ke=>new Set([...ke,String(fe)])),jn()):Zt.error(Te.data?.error||"Failed to submit enrollment")}catch(Q){console.error("Failed to submit enrollment:",Q),Zt.error("Failed to submit enrollment")}},Ji=async Q=>{if(confirm("Are you sure you want to unenroll from this training?"))try{const fe=await Ar.trainingApplications.cancel(Q.id);fe.data&&fe.data.success?(Zt.success("Successfully unenrolled from training"),jn()):Zt.error(fe.data?.message||"Failed to unenroll")}catch(fe){console.error("Failed to unenroll:",fe),Zt.error("Failed to unenroll from training")}},bs=async Q=>{try{const fe=await Ar.trainingCalendar.sync(Q.id);fe.data&&fe.data.success?Zt.success("Training synced to calendar successfully"):Zt.error(fe.data?.message||"Failed to sync to calendar")}catch(fe){console.error("Failed to sync to calendar:",fe),Zt.error("Failed to sync to calendar")}},Ys=async Q=>{try{const fe=await Ar.certificates.download(Q.certificateId),Te=window.URL.createObjectURL(fe),ke=document.createElement("a");ke.style.display="none",ke.href=Te,ke.download=`certificate_${Q.trainingName.replace(/\s+/g,"_")}.pdf`,document.body.appendChild(ke),ke.click(),window.URL.revokeObjectURL(Te),Zt.success("Certificate downloaded successfully")}catch(fe){console.error("Failed to download certificate:",fe),Zt.error("Failed to download certificate")}},Vr=Q=>{qt(Q),zr(!0),Rt(Q.id)},Rt=async Q=>{try{const Te=(await Ar.trainingApplications.getAll()).data.filter(ke=>ke.training_id==Q&&ke.status!=="cancelled"&&ke.status!=="rejected"&&ke.status!=="completed");Wn(Te)}catch(fe){console.error("Failed to load enrolled participants:",fe),Zt.error("Failed to load enrolled participants"),Wn([])}},Jr=async(Q,fe,Te=null)=>{try{let ke;if(Te&&Te.training_id)ke=Te.training_id;else{const Et=rn.find(ht=>ht.id===Q);if(!Et){Zt.error("Application not found");return}ke=Et.training_id}const Oe={application_id:parseInt(Q),employee_id:parseInt(fe),training_id:parseInt(ke),completion_date:new Date().toISOString().split("T")[0],completion_notes:"Marked as completed by trainer/admin"},ut=await Ar.trainingCompletions.create(Oe);ut.data&&ut.data.success?(Zt.success("Participant marked as completed"),st&&Rt(st.id),jn()):Zt.error(ut.data?.message||"Failed to mark participant as completed")}catch(ke){console.error("Failed to mark participant as completed:",ke),Zt.error("Failed to mark participant as completed")}},xa=async Q=>{try{const fe=await Ar.trainingApplications.approve(Q);fe.data&&fe.data.success?(Zt.success("Application approved successfully"),st&&Rt(st.id)):Zt.error(fe.data?.message||"Failed to approve application")}catch(fe){console.error("Failed to approve application:",fe),Zt.error("Failed to approve application")}},ka=async Q=>{try{const fe=await Ar.trainingApplications.reject(Q);fe.data&&fe.data.success?(Zt.success("Application rejected successfully"),st&&Rt(st.id)):Zt.error(fe.data?.message||"Failed to reject application")}catch(fe){console.error("Failed to reject application:",fe),Zt.error("Failed to reject application")}},Dr=Q=>{if(rt.has(String(Q)))return"applied";const fe=s.find(ke=>String(ke.training_id)===String(Q));return fe&&fe.status!=="cancelled"?fe.status:T.find(ke=>String(ke.training?.id)===String(Q))?"completed":null},gt=f.filter(Q=>{const fe=Q.title||Q.program_name||"",Te=Q.topic||Q.target_skills||"",ke=Q.targetRole||Q.required_role||"",Oe=Q.startDate||Q.start_date||"";return fe.toLowerCase().includes(B.toLowerCase())&&(K===""||Te===K)&&(X===""||ke===X||ke==="All")&&(Z===""||Oe>=Z)&&Dr(Q.id)!=="completed"});return Re?o.jsx("div",{className:"min-h-screen bg-gray-50/30 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary mx-auto"}),o.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading Training Management..."})]})}):Ce?o.jsx("div",{className:"min-h-screen bg-gray-50/30 flex items-center justify-center",children:o.jsxs("div",{className:"text-center max-w-md",children:[o.jsx("div",{className:"text-red-500 mb-4",children:o.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),o.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Error Loading Training Management"}),o.jsx("p",{className:"text-gray-600 mb-4",children:Ce}),o.jsx(kt,{onClick:()=>window.location.reload(),variant:"outline",children:"Try Again"})]})}):o.jsxs("div",{className:"min-h-screen bg-gray-50/30",children:[o.jsx("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur",children:o.jsx("div",{className:"container flex h-12 items-center justify-between px-4",children:o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[o.jsx(qx,{className:"h-5 w-5 text-primary flex-shrink-0"}),o.jsx("h1",{className:"text-base sm:text-lg font-semibold truncate",children:"Training Management"})]})})}),o.jsxs("div",{className:"container mx-auto px-3 sm:px-4 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[o.jsxs(ni,{children:[o.jsx("div",{className:"p-3 sm:p-4 border-b",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ck,{className:"w-5 h-5 text-amber-600 flex-shrink-0"}),o.jsx("h2",{className:"text-lg font-semibold",children:"Training Catalog"})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-2 sm:justify-end sm:ml-auto",children:[o.jsxs("div",{className:"relative flex-1 sm:flex-initial",children:[o.jsx(nT,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),o.jsx(On,{placeholder:"Search trainings...",value:B,onChange:Q=>F(Q.target.value),className:"pl-10 w-full h-9"})]}),(t()||n())&&o.jsxs(kt,{size:"sm",onClick:()=>mt(!0),className:"whitespace-nowrap",children:[o.jsx(Au,{className:"w-4 h-4 mr-1"}),o.jsx("span",{className:"hidden xs:inline",children:"New Training"}),o.jsx("span",{className:"xs:hidden",children:"New"})]})]})]})}),o.jsx(qi,{className:"p-3 sm:p-4",children:o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-4",children:gt.length===0?o.jsx("div",{className:"col-span-full flex items-center justify-center py-12",children:o.jsxs("div",{className:"text-center",children:[o.jsx(kh,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-muted-foreground mb-2",children:"No Training Available"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:B||K||X||Z?"No trainings match your current filters. Try adjusting your search criteria.":"There are currently no trainings available. Check back later or contact your HR administrator."})]})}):gt.map(Q=>o.jsxs("div",{className:"border rounded-lg p-3 sm:p-4 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 mb-2",children:[o.jsx("h3",{className:"font-medium text-sm line-clamp-2 flex-1",children:Q.title}),o.jsxs("div",{className:"flex flex-wrap gap-1",children:[o.jsx(_i,{variant:"secondary",className:"text-xs",children:Q.format}),o.jsx(_i,{variant:"outline",className:"text-xs",children:Q.difficulty})]})]}),o.jsx("p",{className:"text-xs text-muted-foreground mb-3 line-clamp-2",children:Q.description}),o.jsx("div",{className:"space-y-2 mb-3",children:o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-muted-foreground",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Kp,{className:"w-3 h-3 flex-shrink-0"}),o.jsx("span",{className:"truncate",children:Q.duration})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(NA,{className:"w-3 h-3 flex-shrink-0"}),o.jsx("span",{className:"truncate",children:Q.topic})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Xy,{className:"w-3 h-3 flex-shrink-0"}),o.jsx("span",{className:"truncate",children:Q.trainer})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Hy,{className:"w-3 h-3 flex-shrink-0"}),o.jsxs("span",{className:"truncate",children:[Q.enrolled,"/",Q.maxParticipants]})]})]})}),o.jsx("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2 mt-3 pt-3 border-t",children:t()||n()?o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center sm:justify-start w-full",children:[o.jsxs(kt,{size:"sm",variant:"outline",onClick:()=>yi(Q),className:"flex-1 sm:flex-initial gap-1",children:[o.jsx(Y1,{className:"w-3 h-3"}),o.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),o.jsxs(kt,{size:"sm",variant:"destructive",onClick:()=>xr(Q),className:"flex-1 sm:flex-initial gap-1",children:[o.jsx(qA,{className:"w-3 h-3"}),o.jsx("span",{className:"hidden sm:inline",children:"Delete"})]})]}):o.jsx("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between w-full gap-2",children:o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full",children:[o.jsxs(kt,{size:"sm",variant:"outline",onClick:()=>dr(Q),className:"flex-1 gap-1",children:[o.jsx($A,{className:"w-3 h-3"}),o.jsx("span",{className:"hidden sm:inline",children:"View"})]}),c()&&o.jsxs(kt,{size:"sm",onClick:()=>Dr(Q.id)?null:Ki(Q),disabled:!!Dr(Q.id),className:"flex-1 gap-1",children:[o.jsx(kh,{className:"w-3 h-3"}),o.jsx("span",{className:"hidden sm:inline",children:Dr(Q.id)?"Enrolled":"Enroll"}),o.jsx("span",{className:"sm:hidden",children:Dr(Q.id)?"✓":"+"})]})]})})})]},Q.id))})})]}),o.jsxs(ni,{children:[o.jsx(Ns,{className:"pb-3 sm:pb-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(que,{className:"w-5 h-5 text-rose-600 flex-shrink-0"}),o.jsx(us,{className:"text-xl sm:text-2xl",children:"Training Status & History"})]}),o.jsxs("div",{className:"flex items-center space-x-1 rounded-lg bg-muted p-1 justify-start sm:justify-end sm:ml-auto",children:[o.jsxs(kt,{variant:he==="upcoming"?"default":"ghost",size:"sm",onClick:()=>ye("upcoming"),className:"text-xs sm:text-sm px-2 sm:px-3",children:[o.jsx("span",{className:"hidden sm:inline",children:"Upcoming Sessions"}),o.jsx("span",{className:"sm:hidden",children:"Upcoming"})]}),o.jsxs(kt,{variant:he==="completed"?"default":"ghost",size:"sm",onClick:()=>ye("completed"),className:"text-xs sm:text-sm px-2 sm:px-3",children:[o.jsx("span",{className:"hidden sm:inline",children:"Training History"}),o.jsx("span",{className:"sm:hidden",children:"History"})]})]})]})}),o.jsxs(qi,{className:"space-y-6",children:[he==="upcoming"&&o.jsxs(ni,{children:[o.jsx(Ns,{children:t()||n()?o.jsxs(us,{className:"flex item-center gap-2",children:[o.jsx(xde,{className:"w-5 h-5 text-cyan-600"}),"Manage Training Sessions"]}):o.jsxs(us,{className:"flex item-center gap-2",children:[o.jsx(a6,{className:"w-5 h-5 text-cyan-600"}),"Upcoming Training Sessions"]})}),o.jsx(qi,{children:t()||n()?f.length>0?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"block md:hidden space-y-3",children:f.map(Q=>o.jsx(ni,{className:"p-4",children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium text-sm",children:Q.program_name||Q.title||"Training Name Not Available"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:Q.trainer||"TBA"})]}),o.jsxs(_i,{variant:"secondary",className:"text-xs",children:[Q.enrolled_count||0," / ",Q.max_participants||"Unlimited"]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-muted-foreground",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Hp,{className:"w-3 h-3"}),o.jsx("span",{className:"truncate",children:Q.start_date?new Date(Q.start_date).toLocaleDateString():"Date TBA"})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Kp,{className:"w-3 h-3"}),o.jsx("span",{className:"truncate",children:Q.location||"Location TBA"})]})]}),o.jsxs(kt,{variant:"outline",size:"sm",className:"w-full gap-1",onClick:()=>Vr(Q),children:[o.jsx(Hy,{className:"w-4 h-4"}),"Manage Attendees"]})]})},Q.id))}),o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b",children:[o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Training Name"}),o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Date & Time"}),o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Location"}),o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Enrolled"}),o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Actions"})]})}),o.jsx("tbody",{children:f.map(Q=>o.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[o.jsxs("td",{className:"py-4 px-4",children:[o.jsx("div",{className:"font-medium",children:Q.program_name||Q.title||"Training Name Not Available"}),o.jsx("div",{className:"text-sm text-muted-foreground",children:Q.trainer||"TBA"})]}),o.jsx("td",{className:"py-4 px-4",children:o.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[o.jsx(Hp,{className:"w-4 h-4"}),Q.start_date?new Date(Q.start_date).toLocaleDateString()+" "+new Date(Q.start_date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Date TBA"]})}),o.jsx("td",{className:"py-4 px-4",children:o.jsx("div",{className:"text-sm text-muted-foreground",children:Q.location||"Location TBA"})}),o.jsx("td",{className:"py-4 px-4",children:o.jsxs(_i,{variant:"secondary",children:[Q.enrolled_count||0," / ",Q.max_participants||"Unlimited"]})}),o.jsx("td",{className:"py-4 px-4",children:o.jsxs(kt,{variant:"outline",size:"sm",className:"gap-1",onClick:()=>Vr(Q),children:[o.jsx(Hy,{className:"w-4 h-4"}),"Manage Attendees"]})})]},Q.id))})]})})]}):o.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[o.jsx(kh,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),o.jsx("p",{className:"text-lg font-medium",children:"No Trainings Available"}),o.jsx("p",{className:"text-sm",children:"No training sessions have been created yet."})]}):s.filter(Q=>Q.status&&Q.status.toLowerCase()!=="cancelled").length>0?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"block md:hidden space-y-3",children:s.filter(Q=>Q.status&&Q.status.toLowerCase()!=="cancelled").map(Q=>o.jsx(ni,{className:"p-4",children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium text-sm",children:Q.training?.program_name||Q.training?.title||Q.trainingName||"Training Name Not Available"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:Q.training?.trainer||"TBA"})]}),o.jsx(_i,{variant:"secondary",className:"text-xs",children:Q.status})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-muted-foreground",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Hp,{className:"w-3 h-3"}),o.jsx("span",{className:"truncate",children:Q.training?.start_date?new Date(Q.training.start_date).toLocaleDateString():Q.dateTime?new Date(Q.dateTime).toLocaleString():"Date TBA"})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Kp,{className:"w-3 h-3"}),o.jsx("span",{className:"truncate",children:Q.training?.location||Q.location||"Location TBA"})]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(kt,{variant:"outline",size:"sm",className:"flex-1 gap-1",onClick:()=>bs(Q),children:[o.jsx(s6,{className:"w-3 h-3"}),o.jsx("span",{className:"hidden sm:inline",children:"Sync"})]}),Q.status&&Q.status.toLowerCase()!=="cancelled"&&Q.status.toLowerCase()!=="completed"&&o.jsxs(kt,{variant:"destructive",size:"sm",className:"flex-1 gap-1",onClick:()=>Ji(Q),children:[o.jsx(bg,{className:"w-3 h-3"}),o.jsx("span",{className:"hidden sm:inline",children:"Unenroll"})]})]})]})},Q.id))}),o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b",children:[o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Training Name"}),o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Date & Time"}),o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Location"}),o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Status"}),o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Actions"})]})}),o.jsx("tbody",{children:s.filter(Q=>Q.status&&Q.status.toLowerCase()!=="cancelled").map(Q=>o.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[o.jsxs("td",{className:"py-4 px-4",children:[o.jsx("div",{className:"font-medium",children:Q.training?.program_name||Q.training?.title||Q.trainingName||"Training Name Not Available"}),o.jsx("div",{className:"text-sm text-muted-foreground",children:Q.training?.trainer||"TBA"})]}),o.jsx("td",{className:"py-4 px-4",children:o.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[o.jsx(Hp,{className:"w-4 h-4"}),Q.training?.start_date?new Date(Q.training.start_date).toLocaleDateString()+" "+new Date(Q.training.start_date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):Q.dateTime?new Date(Q.dateTime).toLocaleString():"Date TBA"]})}),o.jsx("td",{className:"py-4 px-4",children:o.jsx("div",{className:"text-sm text-muted-foreground",children:Q.training?.location||Q.location||"Location TBA"})}),o.jsxs("td",{className:"py-4 px-4",children:[" ",o.jsx(_i,{children:Q.status})," "]}),o.jsx("td",{className:"py-4 px-4",children:o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(kt,{variant:"outline",size:"sm",onClick:()=>bs(Q),children:[o.jsx(s6,{className:"w-4 h-4 mr-1"}),"Sync to Calendar"]}),Q.status&&Q.status.toLowerCase()!=="cancelled"&&Q.status.toLowerCase()!=="completed"&&o.jsxs(kt,{variant:"destructive",size:"sm",onClick:()=>Ji(Q),children:[o.jsx(bg,{className:"w-4 h-4 mr-1"}),"Unenroll"]})]})})]},Q.id))})]})})]}):o.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[o.jsx(a6,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),o.jsx("p",{className:"text-lg font-medium",children:"No Training Enrollments"}),o.jsx("p",{className:"text-sm",children:"You haven't enrolled in any training sessions yet."})]})})]}),he==="completed"&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[o.jsx(ni,{className:"p-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Completed"}),o.jsx("p",{className:"text-2xl font-bold",children:T.length})]}),o.jsx(Wy,{className:"h-5 w-5 text-green-600"})]})}),o.jsx(ni,{className:"p-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Certificates Earned"}),o.jsx("p",{className:"text-2xl font-bold",children:T.filter(Q=>Q.certificateId).length})]}),o.jsx(W0,{className:"h-5 w-5 text-amber-600"})]})}),o.jsx(ni,{className:"p-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Skills Updated"}),o.jsx("p",{className:"text-2xl font-bold",children:[...new Set(T.flatMap(Q=>Q.competencies))].length})]}),o.jsx(K1,{className:"h-5 w-5 text-blue-600"})]})})]}),o.jsxs(ni,{children:[o.jsx(Ns,{children:o.jsxs(us,{className:"flex items-center gap-2",children:[o.jsx(PA,{className:"w-5 h-5 text-slate-600"}),"Training History & Certificates"]})}),o.jsx(qi,{children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b",children:[o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Training Name"}),o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Completion Date"}),o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Performance"}),o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground hidden lg:table-cell",children:"Skills Acquired"}),o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Certificate"})]})}),o.jsx("tbody",{children:T.map(Q=>o.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[o.jsx("td",{className:"py-4 px-4",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Wy,{className:"w-4 h-4 text-green-600"}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:Q.trainingName}),o.jsxs("div",{className:"text-xs text-muted-foreground",children:["ID: ",Q.certificateId]})]})]})}),o.jsx("td",{className:"py-4 px-4",children:o.jsx("div",{className:"text-sm text-muted-foreground",children:new Date(Q.completionDate).toLocaleDateString()})}),o.jsx("td",{className:"py-4 px-4",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs(_i,{variant:"outline",className:"text-sm",children:[Q.score,"% - ",Q.grade]}),Q.score>=90&&o.jsx(Y2,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"})]})}),o.jsx("td",{className:"py-4 px-4 hidden lg:table-cell",children:o.jsx("div",{className:"flex flex-wrap gap-1",children:Q.competencies.map((fe,Te)=>o.jsx(_i,{variant:"secondary",className:"text-xs",children:fe},Te))})}),o.jsx("td",{className:"py-4 px-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[Q.certificateId&&o.jsxs(kt,{variant:"outline",size:"sm",className:"gap-1 w-full sm:w-auto",onClick:()=>Ys(Q),children:[o.jsx($p,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Certificate"})]}),o.jsxs(kt,{variant:"outline",size:"sm",className:"gap-1 w-full sm:w-auto",children:[o.jsx(W0,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Badge"})]})]})})]},Q.id))})]})})})]}),o.jsxs(ni,{children:[o.jsx(Ns,{children:o.jsxs(us,{className:"flex items-center gap-2",children:[o.jsx(K1,{className:"w-5 h-5 text-blue-600"}),"Skills Development Summary"]})}),o.jsx(qi,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-muted-foreground",children:"Your training history has enhanced the following competencies:"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:[...new Set(T.flatMap(Q=>Q.competencies))].map((Q,fe)=>o.jsx(_i,{variant:"default",className:"text-sm",children:Q},fe))}),o.jsx("div",{className:"pt-4 border-t",children:o.jsxs("p",{className:"text-sm text-muted-foreground",children:["Total unique skills developed: ",[...new Set(T.flatMap(Q=>Q.competencies))].length]})})]})})]})]})]})]}),o.jsxs(ni,{children:[o.jsx("div",{className:"p-4 border-b",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[o.jsx(Xde,{className:"w-5 h-5 text-orange-600"}),"Feedback & Evaluation"]}),o.jsxs(ds,{open:an,onOpenChange:Jt,children:[o.jsx(kf,{asChild:!0,children:o.jsxs(kt,{size:"sm",children:[o.jsx(Au,{className:"w-4 h-4"}),"Feedback"]})}),o.jsxs(gs,{children:[o.jsxs(ys,{children:[o.jsx(vs,{children:"Add Training Feedback"}),o.jsx(Cc,{children:"Share your feedback about a completed training session."})]}),o.jsxs("div",{className:"grid gap-4 py-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx("label",{htmlFor:"training-select",className:"text-sm font-medium",children:"Training"}),o.jsxs(Fs,{children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select a training"})}),o.jsx(Vs,{children:T.map(Q=>o.jsx(Gn,{value:Q.id.toString(),children:Q.trainingName},Q.id))})]})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx("label",{className:"text-sm font-medium",children:"Rating"}),o.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(Q=>o.jsx(kt,{variant:"ghost",size:"sm",className:"p-1 h-8 w-8",children:o.jsx(Y2,{className:"w-4 h-4"})},Q))})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx("label",{htmlFor:"feedback-text",className:"text-sm font-medium",children:"Feedback"}),o.jsx("textarea",{id:"feedback-text",placeholder:"Share your thoughts about the training...",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]})]}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx(kt,{variant:"outline",onClick:()=>Jt(!1),children:"Cancel"}),o.jsx(kt,{onClick:()=>Jt(!1),children:"Submit Feedback"})]})]})]})]})}),o.jsx(qi,{className:"p-4",children:o.jsx("div",{className:"space-y-3",children:N.map(Q=>o.jsxs("div",{className:"p-3 border rounded-lg",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("h3",{className:"font-medium text-sm flex items-center gap-2",children:[o.jsx(Gde,{className:"w-4 h-4 text-orange-500"}),Q.courseTitle]}),o.jsxs("div",{className:"flex items-center gap-1",children:[[...Array(5)].map((fe,Te)=>o.jsx(Y2,{className:`w-3 h-3 ${Te<Q.rating?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},Te)),o.jsxs("span",{className:"text-xs ml-1",children:[Q.rating,"/5"]})]})]}),o.jsxs("p",{className:"text-sm text-muted-foreground mb-2 italic line-clamp-2",children:['"',Q.feedback,'"']}),o.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[o.jsxs("span",{children:[Q.trainer," • ",new Date(Q.date).toLocaleDateString()]}),o.jsx(kt,{size:"sm",variant:"outline",className:"h-6 px-2",children:"Edit"})]})]},Q.id))})})]}),o.jsx(ds,{open:et,onOpenChange:mt,children:o.jsxs(gs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[o.jsxs(ys,{children:[o.jsx(vs,{children:"Create New Training"}),o.jsx(Cc,{children:"Create a new training program for employees to enroll in."})]}),o.jsxs("div",{className:"grid gap-4 py-4",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"title",children:"Training Title *"}),o.jsx(On,{id:"title",value:Vt.title,onChange:Q=>un({...Vt,title:Q.target.value}),placeholder:"Enter training title"})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"trainer",children:"Trainer"}),o.jsx(On,{id:"trainer",value:Vt.trainer,onChange:Q=>un({...Vt,trainer:Q.target.value}),placeholder:"Trainer name"})]})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"description",children:"Description"}),o.jsx(Ec,{id:"description",value:Vt.description,onChange:Q=>un({...Vt,description:Q.target.value}),placeholder:"Enter training description",className:"min-h-[80px]"})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"objectives",children:"Learning Objectives"}),o.jsx(Ec,{id:"objectives",value:Vt.objectives,onChange:Q=>un({...Vt,objectives:Q.target.value}),placeholder:"What will participants learn?",className:"min-h-[60px]"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"duration",children:"Duration *"}),o.jsx(On,{id:"duration",value:Vt.duration,onChange:Q=>un({...Vt,duration:Q.target.value}),placeholder:"e.g. 3 Days, 2 Weeks"})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"topic",children:"Topic *"}),o.jsxs(Fs,{value:Vt.topic,onValueChange:Q=>un({...Vt,topic:Q}),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select topic"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Leadership",children:"Leadership"}),o.jsx(Gn,{value:"Technical",children:"Technical"}),o.jsx(Gn,{value:"Compliance",children:"Compliance"}),o.jsx(Gn,{value:"Soft Skills",children:"Soft Skills"}),o.jsx(Gn,{value:"Safety",children:"Safety"})]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"format",children:"Format"}),o.jsxs(Fs,{value:Vt.format,onValueChange:Q=>un({...Vt,format:Q}),children:[o.jsx(Us,{children:o.jsx(Bs,{})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"In-Person",children:"In-Person"}),o.jsx(Gn,{value:"Online",children:"Online"}),o.jsx(Gn,{value:"Hybrid",children:"Hybrid"})]})]})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"difficulty",children:"Difficulty"}),o.jsxs(Fs,{value:Vt.difficulty,onValueChange:Q=>un({...Vt,difficulty:Q}),children:[o.jsx(Us,{children:o.jsx(Bs,{})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Beginner",children:"Beginner"}),o.jsx(Gn,{value:"Intermediate",children:"Intermediate"}),o.jsx(Gn,{value:"Advanced",children:"Advanced"})]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"maxParticipants",children:"Max Participants"}),o.jsx(On,{id:"maxParticipants",type:"number",value:Vt.maxParticipants,onChange:Q=>un({...Vt,maxParticipants:Q.target.value}),placeholder:"30"})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"targetRole",children:"Target Role"}),o.jsx(On,{id:"targetRole",value:Vt.targetRole,onChange:Q=>un({...Vt,targetRole:Q.target.value}),placeholder:"Manager, Developer, All"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"startDate",children:"Start Date"}),o.jsx(On,{id:"startDate",type:"date",value:Vt.startDate,onChange:Q=>un({...Vt,startDate:Q.target.value})})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"endDate",children:"End Date"}),o.jsx(On,{id:"endDate",type:"date",value:Vt.endDate,onChange:Q=>un({...Vt,endDate:Q.target.value})})]})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"location",children:"Location"}),o.jsx(On,{id:"location",value:Vt.location,onChange:Q=>un({...Vt,location:Q.target.value}),placeholder:"Conference Room A, Online Platform"})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"prerequisites",children:"Prerequisites"}),o.jsx(Ec,{id:"prerequisites",value:Vt.prerequisites,onChange:Q=>un({...Vt,prerequisites:Q.target.value}),placeholder:"Required skills or experience",className:"min-h-[60px]"})]})]}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx(kt,{variant:"outline",onClick:()=>mt(!1),children:"Cancel"}),o.jsx(kt,{onClick:Ur,children:"Create Training"})]})]})}),o.jsx(ds,{open:He,onOpenChange:pt,children:o.jsxs(gs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[o.jsxs(ys,{children:[o.jsx(vs,{children:"Edit Training"}),o.jsx(Cc,{children:"Update training information."})]}),o.jsxs("div",{className:"grid gap-4 py-4",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"edit-title",children:"Training Title *"}),o.jsx(On,{id:"edit-title",value:Vt.title,onChange:Q=>un({...Vt,title:Q.target.value}),placeholder:"Enter training title"})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"edit-trainer",children:"Trainer"}),o.jsx(On,{id:"edit-trainer",value:Vt.trainer,onChange:Q=>un({...Vt,trainer:Q.target.value}),placeholder:"Trainer name"})]})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"edit-description",children:"Description"}),o.jsx(Ec,{id:"edit-description",value:Vt.description,onChange:Q=>un({...Vt,description:Q.target.value}),placeholder:"Enter training description",className:"min-h-[80px]"})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"edit-objectives",children:"Learning Objectives"}),o.jsx(Ec,{id:"edit-objectives",value:Vt.objectives,onChange:Q=>un({...Vt,objectives:Q.target.value}),placeholder:"What will participants learn?",className:"min-h-[60px]"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"edit-duration",children:"Duration *"}),o.jsx(On,{id:"edit-duration",value:Vt.duration,onChange:Q=>un({...Vt,duration:Q.target.value}),placeholder:"e.g. 3 Days, 2 Weeks"})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"edit-topic",children:"Topic *"}),o.jsxs(Fs,{value:Vt.topic,onValueChange:Q=>un({...Vt,topic:Q}),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select topic"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Leadership",children:"Leadership"}),o.jsx(Gn,{value:"Technical",children:"Technical"}),o.jsx(Gn,{value:"Compliance",children:"Compliance"}),o.jsx(Gn,{value:"Soft Skills",children:"Soft Skills"}),o.jsx(Gn,{value:"Safety",children:"Safety"})]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"edit-format",children:"Format"}),o.jsxs(Fs,{value:Vt.format,onValueChange:Q=>un({...Vt,format:Q}),children:[o.jsx(Us,{children:o.jsx(Bs,{})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"In-Person",children:"In-Person"}),o.jsx(Gn,{value:"Online",children:"Online"}),o.jsx(Gn,{value:"Hybrid",children:"Hybrid"})]})]})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"edit-difficulty",children:"Difficulty"}),o.jsxs(Fs,{value:Vt.difficulty,onValueChange:Q=>un({...Vt,difficulty:Q}),children:[o.jsx(Us,{children:o.jsx(Bs,{})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Beginner",children:"Beginner"}),o.jsx(Gn,{value:"Intermediate",children:"Intermediate"}),o.jsx(Gn,{value:"Advanced",children:"Advanced"})]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"edit-maxParticipants",children:"Max Participants"}),o.jsx(On,{id:"edit-maxParticipants",type:"number",value:Vt.maxParticipants,onChange:Q=>un({...Vt,maxParticipants:Q.target.value}),placeholder:"30"})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"edit-targetRole",children:"Target Role"}),o.jsx(On,{id:"edit-targetRole",value:Vt.targetRole,onChange:Q=>un({...Vt,targetRole:Q.target.value}),placeholder:"Manager, Developer, All"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"edit-startDate",children:"Start Date"}),o.jsx(On,{id:"edit-startDate",type:"date",value:Vt.startDate,onChange:Q=>un({...Vt,startDate:Q.target.value})})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"edit-endDate",children:"End Date"}),o.jsx(On,{id:"edit-endDate",type:"date",value:Vt.endDate,onChange:Q=>un({...Vt,endDate:Q.target.value})})]})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"edit-location",children:"Location"}),o.jsx(On,{id:"edit-location",value:Vt.location,onChange:Q=>un({...Vt,location:Q.target.value}),placeholder:"Conference Room A, Online Platform"})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"edit-prerequisites",children:"Prerequisites"}),o.jsx(Ec,{id:"edit-prerequisites",value:Vt.prerequisites,onChange:Q=>un({...Vt,prerequisites:Q.target.value}),placeholder:"Required skills or experience",className:"min-h-[60px]"})]})]}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx(kt,{variant:"outline",onClick:()=>pt(!1),children:"Cancel"}),o.jsx(kt,{onClick:Hi,children:"Update Training"})]})]})}),o.jsx(ds,{open:We,onOpenChange:Je,children:o.jsxs(gs,{className:"max-w-2xl",children:[o.jsxs(ys,{children:[o.jsxs(vs,{className:"flex items-center gap-2",children:[o.jsx(kh,{className:"w-5 h-5"}),or?.title]}),o.jsx(Cc,{children:"View detailed information about this training program."})]}),or&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium mb-2",children:"Description"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:or.description})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium mb-1",children:"Trainer"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:or.trainer})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium mb-1",children:"Duration"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:or.duration})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium mb-1",children:"Format"}),o.jsx(_i,{variant:"secondary",children:or.format})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium mb-1",children:"Difficulty"}),o.jsx(_i,{variant:"outline",children:or.difficulty})]})]}),o.jsx("div",{className:"grid grid-cols-2 gap-4",children:o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium mb-1",children:"Enrollment"}),o.jsxs("p",{className:"text-sm text-muted-foreground",children:[or.enrolled,"/",or.maxParticipants," participants"]})]})}),or.startDate&&o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium mb-1",children:"Start Date"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(or.startDate).toLocaleDateString()})]}),or.location&&o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium mb-1",children:"Location"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:or.location})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[o.jsx(kt,{variant:"outline",onClick:()=>Je(!1),children:"Close"}),c()&&o.jsxs(kt,{onClick:()=>{Dr(or.id)||(Je(!1),Ki(or))},disabled:!!Dr(or.id),children:[o.jsx(kh,{className:"w-4 h-4 mr-1"}),Dr(or.id)?"Already Enrolled":"Enroll Now"]})]})]})]})}),o.jsx(ds,{open:jt,onOpenChange:Pt,children:o.jsxs(gs,{children:[o.jsxs(ys,{children:[o.jsx(vs,{children:"Enroll in Training"}),o.jsxs(Cc,{children:['Submit your enrollment request for "',or?.title,'".']})]}),o.jsx("div",{className:"grid gap-4 py-4",children:o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"enrollment-notes",children:"Notes (Optional)"}),o.jsx(Ec,{id:"enrollment-notes",value:hr.notes,onChange:Q=>$t({...hr,notes:Q.target.value}),placeholder:"Any additional information or reasons for enrollment...",className:"min-h-[80px]"})]})}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx(kt,{variant:"outline",onClick:()=>Pt(!1),children:"Cancel"}),o.jsx(kt,{onClick:Di,children:"Submit Enrollment"})]})]})}),o.jsx(ds,{open:an,onOpenChange:Jt,children:o.jsxs(gs,{children:[o.jsxs(ys,{children:[o.jsx(vs,{children:"Add Training Feedback"}),o.jsx(Cc,{children:"Share your feedback about a completed training session."})]}),o.jsxs("div",{className:"grid gap-4 py-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"training-select",children:"Training"}),o.jsxs(Fs,{children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select a training"})}),o.jsx(Vs,{children:T.map(Q=>o.jsx(Gn,{value:Q.id.toString(),children:Q.trainingName},Q.id))})]})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{children:"Rating"}),o.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(Q=>o.jsx(kt,{variant:"ghost",size:"sm",className:"p-1 h-8 w-8",children:o.jsx(Y2,{className:"w-4 h-4"})},Q))})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"feedback-text",children:"Feedback"}),o.jsx(Ec,{id:"feedback-text",placeholder:"Share your thoughts about the training...",className:"min-h-[80px]"})]})]}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx(kt,{variant:"outline",onClick:()=>Jt(!1),children:"Cancel"}),o.jsx(kt,{onClick:()=>Jt(!1),children:"Submit Feedback"})]})]})}),o.jsx(ds,{open:sn,onOpenChange:zr,children:o.jsxs(gs,{className:"w-[95vw] max-w-none max-h-[95vh] overflow-y-auto",style:{width:"95vw",maxWidth:"none"},children:[o.jsxs(ys,{children:[o.jsxs(vs,{className:"flex items-center gap-2",children:[o.jsx(Hy,{className:"w-5 h-5"}),"Manage Training Session: ",st?.program_name||st?.title]}),o.jsx(Cc,{children:"View all applicants and manage their training status."})]}),o.jsxs("div",{className:"space-y-4",children:[st&&o.jsx(ni,{children:o.jsx(qi,{className:"pt-4",children:o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-muted-foreground",children:"Trainer:"}),o.jsx("p",{children:st.trainer||"TBA"})]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-muted-foreground",children:"Date:"}),o.jsx("p",{children:st.start_date?new Date(st.start_date).toLocaleDateString():"TBA"})]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-muted-foreground",children:"Location:"}),o.jsx("p",{children:st.location||"TBA"})]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-muted-foreground",children:"Enrolled:"}),o.jsxs("p",{children:[rn.length," / ",st.max_participants||"Unlimited"]})]})]})})}),o.jsxs(ni,{children:[o.jsx(Ns,{children:o.jsx(us,{className:"text-lg",children:"Training Applicants"})}),o.jsx(qi,{children:rn.length>0?o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b",children:[o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Employee"}),o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Department"}),o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Applied Date"}),o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Status"}),o.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground",children:"Actions"})]})}),o.jsx("tbody",{children:rn.map(Q=>o.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[o.jsx("td",{className:"py-4 px-4",children:o.jsx("div",{className:"font-medium",children:Q.employee_name||Q.employee?.user?.name||Q.employee?.name||(Q.employee?.first_name&&Q.employee?.last_name?`${Q.employee.first_name} ${Q.employee.last_name}`.trim():`Employee ${Q.employee_id}`)})}),o.jsx("td",{className:"py-4 px-4",children:o.jsx("div",{className:"text-sm text-muted-foreground",children:Q.employee_department||Q.employee?.department||"N/A"})}),o.jsx("td",{className:"py-4 px-4",children:o.jsx("div",{className:"text-sm text-muted-foreground",children:Q.submitted_at?new Date(Q.submitted_at).toLocaleDateString():"N/A"})}),o.jsx("td",{className:"py-4 px-4",children:o.jsx(_i,{variant:"secondary",children:Q.status})}),o.jsx("td",{className:"py-4 px-4",children:o.jsx("div",{className:"flex gap-2",children:Q.status==="approved"?o.jsxs(kt,{size:"sm",onClick:()=>Jr(Q.id,Q.employee_id,Q),className:"gap-1",children:[o.jsx(Wy,{className:"w-4 h-4"}),"Mark Done"]}):Q.status==="applied"?o.jsxs(o.Fragment,{children:[o.jsxs(kt,{size:"sm",variant:"outline",onClick:()=>xa(Q.id),className:"gap-1",children:[o.jsx(Wy,{className:"w-4 h-4"}),"Approve"]}),o.jsxs(kt,{size:"sm",variant:"destructive",onClick:()=>ka(Q.id),className:"gap-1",children:[o.jsx(bg,{className:"w-4 h-4"}),"Reject"]})]}):o.jsx(_i,{variant:"secondary",children:Q.status})})})]},Q.id))})]})}):o.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[o.jsx(Hy,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),o.jsx("p",{className:"text-lg font-medium",children:"No Training Applicants"}),o.jsx("p",{className:"text-sm",children:"No one has applied for this training session yet."})]})})]})]}),o.jsx("div",{className:"flex justify-end gap-2",children:o.jsx(kt,{variant:"outline",onClick:()=>zr(!1),children:"Close"})})]})}),o.jsx(KS,{position:"bottom-right"})]})]})};function UFe(){const{auth:e,loading:t}=z.useContext(Vh);if(t||!e)return o.jsx("div",{className:"min-h-screen bg-gray-50/50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary mx-auto"}),o.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading Succession Planning System..."})]})});const n=()=>e?.role==="HR2 Admin"||e?.role==="hr2_admin"||e?.user_type==="HR2 Admin",[r,c]=z.useState(!1),[f,p]=z.useState(""),[s,w]=z.useState(""),[T,E]=z.useState("all"),[N,D]=z.useState("talent-pool"),[V,$]=z.useState([]),[B,F]=z.useState([]),[K,Y]=z.useState([]),[X,ae]=z.useState({}),[Z,se]=z.useState(!1),[he,ye]=z.useState(!1),[Ce,Ve]=z.useState(!1),Re={talentPool:[{id:1,name:"Sarah Johnson",currentRole:"Senior Manager",department:"Operations",readinessLevel:"Ready Now",readinessScore:95,potentialRoles:["Director of Operations","VP Operations"],leadershipScore:88,performanceRating:"Outstanding",profilePhoto:"https://img.icons8.com/?size=100&id=LREuj015njcj&format=png&color=000000",riskLevel:"Low",lastAssessment:"2025-09-10",keyStrengths:["Strategic Thinking","Team Leadership","Change Management"],developmentAreas:["Financial Acumen","Digital Transformation"]},{id:2,name:"Michael Chen",currentRole:"Team Lead",department:"Technology",readinessLevel:"1-2 years",readinessScore:75,potentialRoles:["IT Manager","Tech Director"],leadershipScore:72,performanceRating:"Exceeds Expectations",profilePhoto:"https://img.icons8.com/?size=100&id=LREuj015njcj&format=png&color=000000",riskLevel:"Medium",lastAssessment:"2025-09-05",keyStrengths:["Technical Excellence","Innovation","Problem Solving"],developmentAreas:["People Management","Communication"]},{id:3,name:"Emily Rodriguez",currentRole:"Assistant Manager",department:"Marketing",readinessLevel:"3+ years",readinessScore:60,potentialRoles:["Marketing Manager","Brand Director"],leadershipScore:65,performanceRating:"Meets Expectations",profilePhoto:"https://img.icons8.com/?size=100&id=LREuj015njcj&format=png&color=000000",riskLevel:"High",lastAssessment:"2025-08-28",keyStrengths:["Creativity","Market Analysis","Campaign Management"],developmentAreas:["Leadership Skills","Strategic Planning","Team Building"]},{id:4,name:"Sarah Johnson",currentRole:"Senior Manager",department:"Operations",readinessLevel:"Ready Now",readinessScore:95,potentialRoles:["Director of Operations","VP Operations"],leadershipScore:88,performanceRating:"Outstanding",profilePhoto:"https://img.icons8.com/?size=100&id=LREuj015njcj&format=png&color=000000",riskLevel:"Low",lastAssessment:"2025-09-10",keyStrengths:["Strategic Thinking","Team Leadership","Change Management"],developmentAreas:["Financial Acumen","Digital Transformation"]},{id:5,name:"Michael Chen",currentRole:"Team Lead",department:"Technology",readinessLevel:"1-2 years",readinessScore:75,potentialRoles:["IT Manager","Tech Director"],leadershipScore:72,performanceRating:"Exceeds Expectations",profilePhoto:"https://img.icons8.com/?size=100&id=LREuj015njcj&format=png&color=000000",riskLevel:"Medium",lastAssessment:"2025-09-05",keyStrengths:["Technical Excellence","Innovation","Problem Solving"],developmentAreas:["People Management","Communication"]},{id:6,name:"Emily Rodriguez",currentRole:"Assistant Manager",department:"Marketing",readinessLevel:"3+ years",readinessScore:60,potentialRoles:["Marketing Manager","Brand Director"],leadershipScore:65,performanceRating:"Meets Expectations",profilePhoto:"https://img.icons8.com/?size=100&id=LREuj015njcj&format=png&color=000000",riskLevel:"High",lastAssessment:"2025-08-28",keyStrengths:["Creativity","Market Analysis","Campaign Management"],developmentAreas:["Leadership Skills","Strategic Planning","Team Building"]},{id:7,name:"Sarah Johnson",currentRole:"Senior Manager",department:"Operations",readinessLevel:"Ready Now",readinessScore:95,potentialRoles:["Director of Operations","VP Operations"],leadershipScore:88,performanceRating:"Outstanding",profilePhoto:"https://img.icons8.com/?size=100&id=LREuj015njcj&format=png&color=000000",riskLevel:"Low",lastAssessment:"2025-09-10",keyStrengths:["Strategic Thinking","Team Leadership","Change Management"],developmentAreas:["Financial Acumen","Digital Transformation"]},{id:8,name:"Michael Chen",currentRole:"Team Lead",department:"Technology",readinessLevel:"1-2 years",readinessScore:75,potentialRoles:["IT Manager","Tech Director"],leadershipScore:72,performanceRating:"Exceeds Expectations",profilePhoto:"https://img.icons8.com/?size=100&id=LREuj015njcj&format=png&color=000000",riskLevel:"Medium",lastAssessment:"2025-09-05",keyStrengths:["Technical Excellence","Innovation","Problem Solving"],developmentAreas:["People Management","Communication"]}],leadershipPipeline:[{id:1,position:"Chief Executive Officer",currentHolder:"Robert Wilson",level:"C-Suite",successors:[{name:"Sarah Johnson",readiness:"Ready Now",probability:85},{name:"David Kim",readiness:"1-2 years",probability:70}],criticalityScore:100,vacancyRisk:"Low"},{id:2,position:"VP of Technology",currentHolder:"Jennifer Lee",level:"Executive",successors:[{name:"Michael Chen",readiness:"1-2 years",probability:80},{name:"Alex Thompson",readiness:"2-3 years",probability:65}],criticalityScore:90,vacancyRisk:"Medium"},{id:3,position:"Director of Marketing",currentHolder:"VACANT",level:"Director",successors:[{name:"Emily Rodriguez",readiness:"3+ years",probability:60},{name:"Mark Stevens",readiness:"Ready Now",probability:75}],criticalityScore:85,vacancyRisk:"High"}],developmentPlans:[{id:1,employeeId:1,employeeName:"Sarah Johnson",targetRole:"Chief Executive Officer",planType:"Executive Leadership Track",status:"In Progress",startDate:"2025-01-15",expectedCompletion:"2025-12-31",progress:65,activities:[{type:"Training",title:"Strategic Leadership Program",status:"Completed",dueDate:"2025-03-15"},{type:"Coaching",title:"Executive Coaching Sessions",status:"In Progress",dueDate:"2025-10-01"},{type:"Project",title:"Cross-Functional Initiative Lead",status:"In Progress",dueDate:"2025-11-30"},{type:"Mentorship",title:"CEO Mentorship Program",status:"Scheduled",dueDate:"2025-12-15"}],mentor:"Robert Wilson",competencyGaps:["Financial Strategy","Board Relations"]},{id:2,employeeId:2,employeeName:"Michael Chen",targetRole:"VP of Technology",planType:"Technical Leadership Track",status:"In Progress",startDate:"2025-02-01",expectedCompletion:"2026-06-30",progress:40,activities:[{type:"Training",title:"People Management Certification",status:"In Progress",dueDate:"2025-11-01"},{type:"Project",title:"Department Restructuring Lead",status:"Scheduled",dueDate:"2025-12-31"},{type:"Mentorship",title:"CTO Shadowing Program",status:"In Progress",dueDate:"2026-03-01"}],mentor:"Jennifer Lee",competencyGaps:["Team Leadership","Budget Management"]}],analytics:{totalTalentPool:12,readyNow:3,readyIn1to2Years:5,readyIn3PlusYears:4,criticalRolesCovered:75,averageReadinessScore:73,highRiskPositions:2,turnoverRisk:{low:8,medium:3,high:1}}},$e=[{month:"Jan",readyNow:2,ready1to2Years:4,ready3PlusYears:6,coverage:65},{month:"Feb",readyNow:3,ready1to2Years:4,ready3PlusYears:5,coverage:68},{month:"Mar",readyNow:2,ready1to2Years:5,ready3PlusYears:5,coverage:70},{month:"Apr",readyNow:3,ready1to2Years:5,ready3PlusYears:4,coverage:72},{month:"May",readyNow:4,ready1to2Years:5,ready3PlusYears:3,coverage:74},{month:"Jun",readyNow:3,ready1to2Years:5,ready3PlusYears:4,coverage:75}];z.useEffect(()=>{$(Re.talentPool),F(Re.leadershipPipeline),Y(Re.developmentPlans),ae(Re.analytics)},[e]);const nt=V.filter(Me=>Me.name.toLowerCase().includes(s.toLowerCase())||Me.currentRole.toLowerCase().includes(s.toLowerCase())||Me.department.toLowerCase().includes(s.toLowerCase()));return o.jsxs("div",{className:"min-h-screen bg-gray-50/30",children:[o.jsx("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur",children:o.jsx("div",{className:"container flex h-12 items-center justify-between px-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(rhe,{className:"h-5 w-5 text-primary"}),o.jsx("h1",{className:"text-lg font-semibold",children:"Succession Planning"})]})})}),o.jsxs("div",{className:"container mx-auto px-4 py-6 space-y-6",children:[o.jsxs("section",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[o.jsx(ni,{className:"p-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Talent Pool"}),o.jsx("p",{className:"text-2xl font-bold",children:X.totalTalentPool||0})]}),o.jsx(Hy,{className:"h-5 w-5 text-muted-foreground"})]})}),o.jsx(ni,{className:"p-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Ready Now"}),o.jsx("p",{className:"text-2xl font-bold",children:X.readyNow||0})]}),o.jsx(Wy,{className:"h-5 w-5 text-muted-foreground"})]})}),o.jsx(ni,{className:"p-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"1-2 Years"}),o.jsx("p",{className:"text-2xl font-bold",children:X.readyIn1to2Years||0})]}),o.jsx(Kp,{className:"h-5 w-5 text-muted-foreground"})]})}),o.jsx(ni,{className:"p-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"3+ Years"}),o.jsx("p",{className:"text-2xl font-bold",children:X.readyIn3PlusYears||0})]}),o.jsx(Hp,{className:"h-5 w-5 text-muted-foreground"})]})}),o.jsx(ni,{className:"p-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Coverage"}),o.jsxs("p",{className:"text-2xl font-bold",children:[X.criticalRolesCovered||0,"%"]})]}),o.jsx(dhe,{className:"h-5 w-5 text-muted-foreground"})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs(ni,{className:"lg:col-span-2",children:[o.jsx("div",{className:"p-4 border-b",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[o.jsx(gde,{className:"w-5 h-5 text-yellow-600"}),"Talent Pool"]}),n()&&o.jsxs(kt,{onClick:()=>se(!0),variant:"default",size:"sm",className:"gap-2",children:[o.jsx(Au,{className:"w-4 h-4"}),"Add Talent"]})]})}),o.jsxs(qi,{className:"p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"relative flex-1 max-w-md",children:[o.jsx(nT,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),o.jsx(On,{placeholder:"Search talent...",value:s,onChange:Me=>w(Me.target.value),className:"pl-10"})]}),o.jsxs(Fs,{value:T,onValueChange:E,children:[o.jsx(Us,{className:"w-36",children:o.jsx(Bs,{placeholder:"Filter by readiness"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"all",children:"All Levels"}),o.jsx(Gn,{value:"ready-now",children:"Ready Now"}),o.jsx(Gn,{value:"1-2-years",children:"1-2 Years"}),o.jsx(Gn,{value:"3-plus-years",children:"3+ Years"})]})]})]}),o.jsx("div",{className:"h-96 overflow-y-auto grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:nt.map(Me=>o.jsx(ni,{className:"p-4 hover:shadow-md transition-shadow",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsxs(tj,{className:"w-12 h-12",children:[o.jsx(nj,{src:Me.profilePhoto,alt:Me.name}),o.jsx(rj,{children:Me.name.split(" ").map(rt=>rt[0]).join("")})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-sm truncate",children:Me.name}),o.jsx("p",{className:"text-xs text-muted-foreground truncate",children:Me.currentRole})]}),o.jsx(_i,{variant:"outline",className:"text-xs",children:Me.readinessLevel})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-xs text-muted-foreground",children:"Readiness"}),o.jsxs("span",{className:"text-sm font-medium",children:[Me.readinessScore,"%"]})]}),o.jsx(Df,{value:Me.readinessScore,className:"h-2"}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-xs text-muted-foreground",children:"Leadership"}),o.jsxs("span",{className:"text-sm font-medium",children:[Me.leadershipScore,"%"]})]}),o.jsx(Df,{value:Me.leadershipScore,className:"h-2"})]}),o.jsxs("div",{className:"flex gap-2 mt-3",children:[o.jsx(kt,{variant:"outline",size:"sm",className:"flex-1 text-xs",children:"View"}),n()&&o.jsx(kt,{variant:"outline",size:"sm",className:"text-xs",children:"Edit"})]})]})]})},Me.id))})]})]}),o.jsxs(ni,{children:[o.jsx("div",{className:"p-4 border-b",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[o.jsx(Sde,{className:"w-5 h-5 text-yellow-600"}),"Leadership Pipeline"]}),n()&&o.jsxs(kt,{onClick:()=>Ve(!0),variant:"default",size:"sm",className:"gap-2",children:[o.jsx(Au,{className:"w-4 h-4"}),"Add Successor"]})]})}),o.jsx(qi,{className:"p-4",children:o.jsx("div",{className:"space-y-4 h-80 overflow-y-auto",children:B.map(Me=>o.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg",children:o.jsx(W0,{className:"w-4 h-4 text-yellow-600"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium text-sm",children:Me.position}),o.jsxs("p",{className:"text-xs text-muted-foreground",children:["Current: ",Me.currentHolder]})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[Me.criticalityScore,"%"]}),o.jsx(_i,{variant:"outline",className:"text-xs",children:Me.vacancyRisk})]})]},Me.id))})})]}),o.jsxs(ni,{children:[o.jsx("div",{className:"p-4 border-b",children:o.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[o.jsx(HW,{className:"w-5 h-5 text-purple-600"}),"Competency Insights"]})}),o.jsx(qi,{className:"p-4",children:o.jsx("div",{className:"space-y-3 h-80 overflow-y-auto",children:V.slice(0,6).map(Me=>o.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs(tj,{className:"w-10 h-10",children:[o.jsx(nj,{src:Me.profilePhoto,alt:Me.name}),o.jsx(rj,{className:"text-xs",children:Me.name.split(" ").map(rt=>rt[0]).join("")})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium text-sm",children:Me.name}),o.jsx("p",{className:"text-xs text-muted-foreground",children:Me.currentRole})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"text-right",children:[o.jsxs("div",{className:"text-sm font-medium",children:[Me.leadershipScore,"%"]}),o.jsx(Df,{value:Me.leadershipScore,className:"w-16 h-2"})]}),o.jsx(_i,{variant:"outline",className:"text-xs",children:Me.performanceRating})]})]},Me.id))})})]}),o.jsxs(ni,{children:[o.jsx("div",{className:"p-4 border-b",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[o.jsx(she,{className:"w-5 h-5 text-green-600"}),"Development Plans"]}),n()&&o.jsxs(kt,{onClick:()=>ye(!0),variant:"default",size:"sm",className:"gap-2",children:[o.jsx(Au,{className:"w-4 h-4"}),"Create Plan"]})]})}),o.jsx(qi,{className:"p-4",children:o.jsx("div",{className:"space-y-4 h-80 overflow-y-auto",children:K.map(Me=>o.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg",children:o.jsx(Xue,{className:"w-4 h-4 text-green-600"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium text-sm",children:Me.employeeName}),o.jsxs("p",{className:"text-xs text-muted-foreground",children:["Target: ",Me.targetRole]})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx(_i,{variant:"outline",className:"mb-1 text-xs",children:Me.status}),o.jsxs("div",{className:"text-sm font-medium text-green-600",children:[Me.progress,"%"]}),o.jsx(Df,{value:Me.progress,className:"w-16 h-2"})]})]},Me.id))})})]}),o.jsxs(ni,{children:[o.jsx("div",{className:"p-4 border-b",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[o.jsx(ide,{className:"w-5 h-5 text-blue-600"}),"Analytics"]}),o.jsxs(kt,{variant:"default",size:"sm",className:"gap-2",children:[o.jsx($p,{className:"w-4 h-4"}),"Export Report"]})]})}),o.jsxs(qi,{className:"p-4",children:[o.jsx("div",{className:"h-64 w-full",children:o.jsx(Fz,{width:"100%",height:"100%",children:o.jsxs(J3e,{data:$e,children:[o.jsx(bF,{strokeDasharray:"3 3"}),o.jsx(Zb,{dataKey:"month",tick:{fontSize:12},axisLine:!1,tickLine:!1}),o.jsx(NT,{tick:{fontSize:12},axisLine:!1,tickLine:!1}),o.jsx(Dh,{contentStyle:{backgroundColor:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"12px"}}),o.jsx(Qy,{wrapperStyle:{fontSize:"12px",paddingTop:"10px"}}),o.jsx(Ky,{type:"monotone",dataKey:"readyNow",stroke:"#10b981",strokeWidth:2,name:"Ready Now",dot:{fill:"#10b981",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#10b981",strokeWidth:2}}),o.jsx(Ky,{type:"monotone",dataKey:"ready1to2Years",stroke:"#f59e0b",strokeWidth:2,name:"1-2 Years",dot:{fill:"#f59e0b",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#f59e0b",strokeWidth:2}}),o.jsx(Ky,{type:"monotone",dataKey:"ready3PlusYears",stroke:"#ef4444",strokeWidth:2,name:"3+ Years",dot:{fill:"#ef4444",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#ef4444",strokeWidth:2}}),o.jsx(Ky,{type:"monotone",dataKey:"coverage",stroke:"#8b5cf6",strokeWidth:2,name:"Role Coverage %",dot:{fill:"#8b5cf6",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#8b5cf6",strokeWidth:2}})]})})}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4 pt-4 border-t",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:X.readyNow||0}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Ready Now"})]}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[X.criticalRolesCovered||0,"%"]}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Coverage"})]})]})]})]})]}),o.jsx(ds,{open:Z,onOpenChange:se,children:o.jsxs(gs,{className:"max-w-md",children:[o.jsx(ys,{children:o.jsx(vs,{children:"Add to Talent Pool"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Employee"}),o.jsxs(Fs,{children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select employee"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"1",children:"John Smith"}),o.jsx(Gn,{value:"2",children:"Jane Doe"})]})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Readiness Level"}),o.jsxs(Fs,{children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select readiness"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"ready-now",children:"Ready Now"}),o.jsx(Gn,{value:"1-2-years",children:"1-2 Years"}),o.jsx(Gn,{value:"3-plus-years",children:"3+ Years"})]})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Target Role"}),o.jsx(On,{placeholder:"Enter target role"})]})]}),o.jsxs(Co,{children:[o.jsx(kt,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),o.jsx(kt,{onClick:()=>se(!1),children:"Add to Pool"})]})]})}),o.jsx(ds,{open:he,onOpenChange:ye,children:o.jsxs(gs,{className:"max-w-lg",children:[o.jsx(ys,{children:o.jsx(vs,{children:"Create Development Plan"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Employee"}),o.jsxs(Fs,{children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select employee"})}),o.jsx(Vs,{children:V.map(Me=>o.jsx(Gn,{value:Me.id.toString(),children:Me.name},Me.id))})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Target Role"}),o.jsx(On,{placeholder:"Enter target role"})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Plan Type"}),o.jsxs(Fs,{children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select plan type"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"executive",children:"Executive Leadership Track"}),o.jsx(Gn,{value:"technical",children:"Technical Leadership Track"}),o.jsx(Gn,{value:"functional",children:"Functional Leadership Track"})]})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Mentor"}),o.jsx(On,{placeholder:"Assign mentor"})]})]}),o.jsxs(Co,{children:[o.jsx(kt,{variant:"outline",onClick:()=>ye(!1),children:"Cancel"}),o.jsx(kt,{onClick:()=>ye(!1),children:"Create Plan"})]})]})}),o.jsx(ds,{open:Ce,onOpenChange:Ve,children:o.jsxs(gs,{className:"max-w-md",children:[o.jsx(ys,{children:o.jsx(vs,{children:"Add Successor"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Position"}),o.jsxs(Fs,{children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select position"})}),o.jsx(Vs,{children:B.map(Me=>o.jsx(Gn,{value:Me.id.toString(),children:Me.position},Me.id))})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Successor"}),o.jsxs(Fs,{children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select successor"})}),o.jsx(Vs,{children:V.map(Me=>o.jsx(Gn,{value:Me.id.toString(),children:Me.name},Me.id))})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Success Probability (%)"}),o.jsx(On,{type:"number",min:"0",max:"100",placeholder:"0-100"})]})]}),o.jsxs(Co,{children:[o.jsx(kt,{variant:"outline",onClick:()=>Ve(!1),children:"Cancel"}),o.jsx(kt,{onClick:()=>Ve(!1),children:"Add Successor"})]})]})})]}),o.jsx(_ne,{position:"bottom-right"})]})}function Pc({className:e,...t}){return o.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:o.jsx("table",{"data-slot":"table",className:Rn("w-full caption-bottom text-sm",e),...t})})}function Mc({className:e,...t}){return o.jsx("thead",{"data-slot":"table-header",className:Rn("[&_tr]:border-b",e),...t})}function Rc({className:e,...t}){return o.jsx("tbody",{"data-slot":"table-body",className:Rn("[&_tr:last-child]:border-0",e),...t})}function zi({className:e,...t}){return o.jsx("tr",{"data-slot":"table-row",className:Rn("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function vr({className:e,...t}){return o.jsx("th",{"data-slot":"table-head",className:Rn("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function qn({className:e,...t}){return o.jsx("td",{"data-slot":"table-cell",className:Rn("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function VFe({className:e,...t}){return o.jsx("caption",{"data-slot":"table-caption",className:Rn("text-muted-foreground mt-4 text-sm",e),...t})}function $Fe(){const t=z.useContext(Vh)?.auth,[n,r]=z.useState({leaveBalance:15,pendingRequests:2,upcomingTrainings:3,completedTrainings:8}),[c,f]=z.useState([{id:1,type:"Travel",amount:1250,status:"Pending",date:"2025-09-15",receipt:"receipt1.pdf"},{id:2,type:"Meals",amount:450,status:"Approved",date:"2025-09-10",receipt:"receipt2.pdf"}]),[p,s]=z.useState([]),[w,T]=z.useState(()=>{try{let je=localStorage.getItem("hr2_reimbursementHistory");const ot=je?JSON.parse(je):[];return console.log("Loaded reimbursement history from localStorage:",ot),ot}catch(je){return console.error("Error loading reimbursement history from localStorage:",je),[]}}),[E,N]=z.useState({type:"",amount:"",date:"",description:"",receipt:null}),[D,V]=z.useState(!1),[$,B]=z.useState(!1),[F,K]=z.useState(!1),[Y,X]=z.useState(!1),[ae,Z]=z.useState(null),[se,he]=z.useState([]),[ye,Ce]=z.useState([]),[Ve,Re]=z.useState(()=>{try{let je=localStorage.getItem("hr2_leaveRequestHistory");if(!je){const vn=localStorage.getItem("leaveRequestHistory");vn&&(je=vn,localStorage.setItem("hr2_leaveRequestHistory",je),console.log("Migrated leave request history from individual to shared storage"))}const ot=je?JSON.parse(je):[];return console.log("Loaded shared leave request history from localStorage:",ot),console.log("Shared leave request history length:",ot.length),ot}catch(je){return console.error("Error loading shared leave request history from localStorage:",je),[]}}),[$e,nt]=z.useState(()=>{try{let je=localStorage.getItem("hr2_timesheetAdjustmentHistory");if(!je){const vn=localStorage.getItem("timesheetAdjustmentHistory");vn&&(je=vn,localStorage.setItem("hr2_timesheetAdjustmentHistory",je),console.log("Migrated timesheet adjustment history from individual to shared storage"))}const ot=je?JSON.parse(je):[];return console.log("Loaded shared timesheet adjustment history from localStorage:",ot),console.log("Shared timesheet adjustment history length:",ot.length),ot}catch(je){return console.error("Error loading shared timesheet adjustment history from localStorage:",je),[]}}),[Me,rt]=z.useState([{id:1,title:"Leave Request Approved",message:"Your vacation leave has been approved",date:"2025-09-18",type:"success"},{id:2,title:"Training Reminder",message:"React Development course starts tomorrow",date:"2025-09-17",type:"info"}]),Ee=async()=>{if(!ci.type||!ci.start||!ci.end||!ci.reason){Zt.error("Please fill in all leave fields.");return}if(!st){Zt.error("Employee information not loaded. Please refresh the page.");return}try{const je={employee_id:st,type:ci.type,start:ci.start,end:ci.end,reason:ci.reason},ot=await Ar.leaveRequests.create(je);Zt.success("Leave request submitted!"),ui({type:"",start:"",end:"",reason:""}),Gi(!1),console.log("About to refresh leave requests after submission, employeeId:",st),await to()}catch(je){Zt.error(je.response?.data?.message||je.message||"Failed to submit leave request")}},it=async je=>{if(confirm("Are you sure you want to cancel this leave request?"))try{await Ar.leaveRequests.delete(je),Zt.success("Leave request cancelled successfully!"),to()}catch(ot){Zt.error(ot.response?.data?.message||"Failed to cancel leave request")}},et=je=>{di(je),Fi({status:"",admin_notes:""}),ws(!0)},mt=async()=>{if(console.log("handleManageRequest called with status:",wr.status),console.log("currentManagingRequest:",fr),console.log("currentManagingRequest keys:",fr?Object.keys(fr):"null"),console.log("currentManagingRequest employee:",fr?.employee),console.log("isHR2Admin:",xr),!fr||!wr.status){Zt.error("Please select an action (Accept or Deny)");return}try{if(await Ar.leaveRequests.updateStatus(fr.id,{status:wr.status,admin_notes:wr.admin_notes||null}),wr.status==="Approved"||wr.status==="Rejected"||wr.status==="Accepted"||wr.status==="Denied"){console.log("Status check passed for leave request. Status:",wr.status,"isHR2Admin:",xr);const je={...fr,status:wr.status,admin_notes:wr.admin_notes||null,processed_at:new Date().toISOString(),employee_name:Va(fr.employee)};console.log("Adding leave request to history:",je),Re(ot=>{const vn=[je,...ot];return console.log("Updated leave request history:",vn),vn}),xr&&(console.log("Removing leave request from main table, current requests:",qr.length),Nn(ot=>ot.filter(vn=>vn.id!==fr.id)))}else console.log("Status check failed for leave request. Status:",wr.status);Zt.success(`Leave request ${wr.status.toLowerCase()}ed successfully!`),ws(!1),di(null),Fi({status:"",admin_notes:""}),to()}catch(je){Zt.error(je.response?.data?.message||"Failed to update leave request")}},He=je=>{di(je),Fi({status:"",admin_notes:""}),ca(!0)},pt=async()=>{if(console.log("handleManageTimesheetDialog called with status:",wr.status),console.log("currentManagingRequest:",fr),console.log("currentManagingRequest keys:",fr?Object.keys(fr):"null"),console.log("currentManagingRequest employee:",fr?.employee),console.log("isHR2Admin:",xr),!fr||!wr.status){Zt.error("Please select an action (Accept or Deny)");return}try{if(await Ar.timesheetAdjustments.updateStatus(fr.id,{status:wr.status,admin_notes:wr.admin_notes}),wr.status==="Approved"||wr.status==="Rejected"){console.log("Status check passed for timesheet adjustment dialog. Status:",wr.status,"isHR2Admin:",xr);const je={...fr,status:wr.status,admin_notes:wr.admin_notes||null,processed_at:new Date().toISOString(),employee_name:Va(fr.employee)};console.log("Adding timesheet adjustment to history from dialog:",je),nt(ot=>{const vn=[je,...ot];return console.log("Updated timesheet adjustment history from dialog:",vn),vn}),xr&&(console.log("Removing timesheet adjustment from main table from dialog, current requests:",ye.length),Ce(ot=>ot.filter(vn=>vn.id!==fr.id)))}else console.log("Status check failed for timesheet adjustment dialog. Status:",wr.status);Zt.success(`Timesheet adjustment request ${wr.status.toLowerCase()}d successfully`),ca(!1),di(null),Fi({status:"",admin_notes:""}),Je()}catch(je){Zt.error(je.response?.data?.message||"Failed to update timesheet adjustment request")}},We=async()=>{if(console.log("=== TIMESHEET ADJUSTMENT SUBMISSION TO BACKEND START ==="),console.log("Form data:",ts),console.log("Employee ID:",st),console.log("User roles - isHR2Admin:",xr,"isEmployee:",dr),!ts.date||!ts.newTimeIn||!ts.newTimeOut||!ts.reason){console.error("Validation failed: Missing required fields",{date:ts.date,newTimeIn:ts.newTimeIn,newTimeOut:ts.newTimeOut,reason:ts.reason}),Zt.error("Please fill in all timesheet adjustment fields.");return}if(!/^\d{4}-\d{2}-\d{2}$/.test(ts.date)){console.error("Validation failed: Invalid date format:",ts.date),Zt.error("Please select a valid date.");return}if(!st||isNaN(parseInt(st))){console.error("Validation failed: Invalid employee ID:",st),Zt.error("Employee information not loaded correctly. Please refresh the page.");return}const ot=/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/;if(!ot.test(ts.newTimeIn)||!ot.test(ts.newTimeOut)){console.error("Validation failed: Invalid time format",{newTimeIn:ts.newTimeIn,newTimeOut:ts.newTimeOut}),Zt.error("Please enter times in HH:MM format (e.g., 09:00, 17:30).");return}const vn=ts.newTimeIn,Sr=ts.newTimeOut;if(vn>=Sr){console.error("Validation failed: End time must be after start time"),Zt.error("End time must be after start time.");return}try{const gr={employee_id:parseInt(st),date:ts.date,new_time_in:ts.newTimeIn,new_time_out:ts.newTimeOut,reason:ts.reason};console.log("Submitting timesheet adjustment to backend:",gr);const Zn=await Ar.timesheetAdjustments.create(gr);console.log("Backend response:",Zn),Zt.success("Timesheet adjustment request submitted successfully!"),dc({date:"",newTimeIn:"",newTimeOut:"",reason:""}),hc(!1),Je(),console.log("=== TIMESHEET ADJUSTMENT SUBMISSION TO BACKEND COMPLETE ===")}catch(gr){console.error("Error submitting timesheet adjustment to backend:",gr),console.error("Error response:",gr.response?.data);const Zn=gr.response?.data?.error||gr.response?.data?.message||gr.message||"Failed to submit timesheet adjustment";Zt.error(Zn)}},Je=async()=>{try{if(console.log("Current employeeId:",st),console.log("Current userRole:",yi),console.log("isHR2Admin:",xr,"isEmployee:",dr),xr){console.log("Admin view: Loading ONLY PENDING timesheet adjustment requests from backend...");const ot=(await Ar.timesheetAdjustments.getAll()).data||[];console.log("All timesheet adjustment requests from backend:",ot);const vn=ot.filter(Sr=>Sr.status==="Pending");console.log("Filtered pending timesheet adjustment requests:",vn),vn.sort((Sr,gr)=>new Date(gr.submitted_at)-new Date(Sr.submitted_at)),Ce(vn),console.log("HR2 Admin - Final loaded PENDING adjustment requests:",vn),ot.length>0}else if(st){console.log("Employee view: Loading personal timesheet adjustment requests from backend for employeeId:",st);const ot=(await Ar.timesheetAdjustments.getByEmployee(st)).data||[];Ce(ot),console.log("Employee - Loaded saved adjustment requests:",ot),await jt(st)}else console.log("No employeeId available, cannot load timesheet adjustment requests"),Ce([]),he([]);console.log("=== FINISHED LOADING TIMESHEET ADJUSTMENT REQUESTS FROM BACKEND ===")}catch(je){console.error("Failed to load timesheet adjustment requests from backend:",je),Zt.error("Failed to load timesheet adjustment requests from server"),Ce([])}},jt=async je=>{try{console.log("Loading employee timesheet from backend for:",je);const vn=(await Ar.timesheetAdjustments.getByEmployee(je,{status:"Approved"})).data||[];console.log("Approved adjustments from backend:",vn);const Sr=vn.map(gr=>({id:gr.id,date:gr.date,timeIn:gr.new_time_in,timeOut:gr.new_time_out,overtime:Pt(gr.new_time_in,gr.new_time_out),status:"Complete",approved_at:gr.approved_at||gr.submitted_at}));Sr.sort((gr,Zn)=>new Date(Zn.date)-new Date(gr.date)),console.log("Loaded timesheet entries from approved adjustments:",Sr),he(Sr),Sr.length>0?console.log(`Employee ${je} has ${Sr.length} approved timesheet entries`):console.log(`No approved timesheet entries found for employee ${je}`)}catch(ot){console.error("Error loading employee timesheet from backend:",ot),he([])}},Pt=(je,ot)=>{try{const[vn,Sr]=je.split(":").map(Number),[gr,Zn]=ot.split(":").map(Number),Mo=vn*60+Sr,no=gr*60+Zn-Mo,La=480;if(no>La){const ta=no-La,Ta=Math.floor(ta/60),kl=ta%60;return Ta>0?`${Ta}h ${kl}m`:`${kl}m`}return"0h"}catch(vn){return console.error("Error calculating overtime:",vn),"0h"}},Ot=je=>{try{if(!je||typeof je!="string")return"N/A";const[ot,vn]=je.split(":").map(Number),Sr=ot>=12?"PM":"AM";return`${ot%12||12}:${vn.toString().padStart(2,"0")} ${Sr}`}catch(ot){return console.error("Error formatting time:",ot),je||"N/A"}},Mt=async()=>{try{if(console.log("loadReimbursementRequests called - employeeId:",st,"userRole:",yi,"isHR2Admin:",xr),xr){console.log("Admin view: Loading ONLY PENDING reimbursement requests from backend...");const ot=(await Ar.reimbursements.getAll()).data||[];console.log("All reimbursement requests from backend:",ot);const vn=ot.filter(Sr=>Sr.status==="Pending");console.log("Filtered pending reimbursement requests:",vn),vn.sort((Sr,gr)=>new Date(gr.submitted_at)-new Date(Sr.submitted_at)),s(vn),console.log("HR2 Admin - Final loaded PENDING reimbursement requests:",vn)}else if(st){console.log("Employee view: Loading personal reimbursement requests from backend for employeeId:",st);const ot=(await Ar.reimbursements.getByEmployee(st)).data||[];s(ot),console.log("Employee - Loaded reimbursement requests:",ot)}else console.log("No employeeId available, cannot load reimbursement requests"),s([]);console.log("=== FINISHED LOADING REIMBURSEMENT REQUESTS FROM BACKEND ===")}catch(je){console.error("Failed to load reimbursement requests from backend:",je),Zt.error("Failed to load reimbursement requests from server"),s([])}},an=async()=>{if(console.log("=== REIMBURSEMENT SUBMISSION TO BACKEND START ==="),console.log("Form data:",E),console.log("Employee ID:",st),!E.type||!E.amount||!E.date||!E.description||!E.receipt){console.error("Validation failed: Missing required fields"),Zt.error("Please fill in all required fields, including uploading a receipt.");return}if(!st||isNaN(parseInt(st))){console.error("Validation failed: Invalid employee ID:",st),Zt.error("Employee information not loaded correctly. Please refresh the page.");return}const je=parseFloat(E.amount);if(isNaN(je)||je<=0){console.error("Validation failed: Invalid amount:",E.amount),Zt.error("Please enter a valid amount greater than 0.");return}try{const ot=new FormData;ot.append("employee_id",parseInt(st)),ot.append("type",E.type),ot.append("amount",je),ot.append("date",E.date),ot.append("description",E.description),E.receipt&&ot.append("receipt",E.receipt),console.log("Submitting reimbursement to backend with FormData");const vn=await Ar.reimbursements.create(ot);console.log("Backend response:",vn),Zt.success("Reimbursement request submitted successfully!"),N({type:"",amount:"",date:"",description:"",receipt:null}),V(!1),Mt(),console.log("=== REIMBURSEMENT SUBMISSION TO BACKEND COMPLETE ===")}catch(ot){console.error("Error submitting reimbursement to backend:",ot),console.error("Error response:",ot.response?.data);const vn=ot.response?.data?.error||ot.response?.data?.message||ot.message||"Failed to submit reimbursement";Zt.error(vn)}},Jt=async je=>{if(confirm("Are you sure you want to cancel this reimbursement request?"))try{console.log("=== CANCELLING REIMBURSEMENT REQUEST ==="),console.log("Request ID:",je);const ot=await Ar.reimbursements.delete(je);console.log("Backend delete response:",ot),Mt(),Zt.success("Reimbursement request cancelled successfully!"),console.log("=== REIMBURSEMENT CANCELLATION COMPLETE ===")}catch(ot){console.error("Failed to cancel reimbursement request:",ot);const vn=ot.response?.data?.error||ot.response?.data?.message||ot.message||"Failed to cancel reimbursement request";Zt.error(vn)}},Cn=je=>{di(je),Fi({status:"",admin_notes:""}),B(!0)},nr=async()=>{if(console.log("handleManageReimbursementDialog called with status:",wr.status),console.log("currentManagingRequest:",fr),!fr||!wr.status){Zt.error("Please select an action (Approve or Reject)");return}try{if(await Ar.reimbursements.updateStatus(fr.id,{status:wr.status,admin_notes:wr.admin_notes}),wr.status==="Approved"||wr.status==="Rejected"){console.log("Status check passed for reimbursement dialog. Status:",wr.status,"isHR2Admin:",xr);const je={...fr,status:wr.status,admin_notes:wr.admin_notes||null,processed_at:new Date().toISOString(),employee_name:Va(fr.employee)};console.log("Adding reimbursement to history from dialog:",je),T(ot=>{const vn=[je,...ot];return console.log("Updated reimbursement history from dialog:",vn),vn}),xr&&(console.log("Removing reimbursement from main table from dialog, current requests:",p.length),s(ot=>ot.filter(vn=>vn.id!==fr.id)))}else console.log("Status check failed for reimbursement dialog. Status:",wr.status);Zt.success(`Reimbursement request ${wr.status.toLowerCase()}d successfully`),B(!1),di(null),Fi({status:"",admin_notes:""}),Mt()}catch(je){Zt.error(je.response?.data?.message||"Failed to update reimbursement request")}},sn=async()=>{try{console.log("Loading reimbursement history from backend for HR2 Admin");const[je,ot]=await Promise.all([Ar.reimbursements.getApproved(),Ar.reimbursements.getRejected()]),vn=je.data||[],Sr=ot.data||[],gr=[...vn,...Sr].map(Zn=>({...Zn,employee_name:Va(Zn.employee),processed_at:Zn.updated_at||Zn.processed_at}));console.log("Loaded reimbursement history from backend:",gr),T(gr)}catch(je){console.error("Failed to load reimbursement history from backend:",je),console.log("Falling back to localStorage for reimbursement history")}},zr=je=>{je.receipt_path?(Z(je),X(!0)):Zt.info("No receipt uploaded for this reimbursement request")},or=async je=>{if(confirm("Are you sure you want to cancel this timesheet adjustment request?"))try{console.log("=== CANCELLING TIMESHEET ADJUSTMENT REQUEST ==="),console.log("Request ID:",je);const ot=await Ar.timesheetAdjustments.delete(je);console.log("Backend delete response:",ot),Je(),Zt.success("Timesheet adjustment request cancelled successfully!"),console.log("=== TIMESHEET ADJUSTMENT CANCELLATION COMPLETE ===")}catch(ot){console.error("Failed to cancel timesheet adjustment request:",ot);const vn=ot.response?.data?.error||ot.response?.data?.message||ot.message||"Failed to cancel timesheet adjustment request";Zt.error(vn)}},Rr=async(je,ot)=>{console.log("handleManageTimesheetRequest called with request:",je,"status:",ot),console.log("Request object keys:",Object.keys(je)),console.log("Request employee data:",je.employee),console.log("isHR2Admin:",xr);try{console.log(`=== UPDATING TIMESHEET ADJUSTMENT REQUEST STATUS TO ${ot} ===`),console.log("Request:",je);const vn=await Ar.timesheetAdjustments.updateStatus(je.id,{status:ot});if(console.log("Backend update response:",vn),ot==="Approved"||ot==="Rejected"){console.log("Status check passed for timesheet adjustment. Status:",ot,"isHR2Admin:",xr);const Sr={...je,status:ot,admin_notes:null,processed_at:new Date().toISOString(),employee_name:Va(je.employee)};console.log("Adding timesheet adjustment to history:",Sr),nt(gr=>{const Zn=[Sr,...gr];return console.log("Updated timesheet adjustment history:",Zn),Zn}),xr&&(console.log("Removing timesheet adjustment from main table, current requests:",ye.length),Ce(gr=>gr.filter(Zn=>Zn.id!==je.id)))}else console.log("Status check failed for timesheet adjustment. Status:",ot);ot==="Approved"&&(console.log("Request approved - updating employee timesheet for:",je.employee_id),await jt(je.employee_id)),Je(),Zt.success(`Timesheet adjustment request ${ot.toLowerCase()}d successfully!`),console.log("=== TIMESHEET ADJUSTMENT STATUS UPDATE COMPLETE ===")}catch(vn){console.error("Failed to update timesheet adjustment request:",vn);const Sr=vn.response?.data?.error||vn.response?.data?.message||vn.message||"Failed to update timesheet adjustment request";Zt.error(Sr)}},[qr,Nn]=z.useState([]),[ci,ui]=z.useState({type:"",start:"",end:"",reason:""}),[st,qt]=z.useState(null),[rn,Wn]=z.useState(null),Vt=t?.id||localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")||"{}").id:localStorage.getItem("employeeId");console.log("Component initialized - currentUser:",t,"loggedInEmployeeId:",Vt);const[un,hr]=z.useState(""),[$t,lr]=z.useState(null),[ze,Fe]=z.useState([]),[jn,Xn]=z.useState([]),[mr,Ur]=z.useState([]),[yi,Hi]=z.useState(null),xr=yi==="HR2 Admin",dr=yi==="Employee";console.log("User role state:",yi,"isHR2Admin:",xr);const[Ki,Di]=z.useState(!1),[Ji,bs]=z.useState({first_name:"",last_name:"",department:"",position:"",email:"",phone:"",address:"",birthday:"",civil_status:"",emergency_contact:"",hire_date:"",manager:"",employee_status:"Active",profile_photo_url:""}),[Ys,Vr]=z.useState({first_name:"",last_name:"",email:"",password:"",roles:"Employee"}),[Rt,Jr]=z.useState({first_name:"",last_name:"",email:"",role:"Employee",original_email:""}),[xa,ka]=z.useState(!0),[Dr,gt]=z.useState(!1),[Q,fe]=z.useState(!1),[Te,ke]=z.useState(null),[Oe,ut]=z.useState(""),[Et,ht]=z.useState(""),[St,nn]=z.useState(!1),[Kt,ir]=z.useState(!1),[br,pr]=z.useState(!1),[Qr,Gr]=z.useState(null),[Wr,Gi]=z.useState(!1),[ai,ws]=z.useState(!1),[Ks,ca]=z.useState(!1),[fr,di]=z.useState(null),[wr,Fi]=z.useState({status:"",admin_notes:""}),[rs,Js]=z.useState(!1),[Na,Ia]=z.useState(!1),[id,Ua]=z.useState(!1),[ts,dc]=z.useState({date:"",newTimeIn:"",newTimeOut:"",reason:""}),[Dl,hc]=z.useState(!1),Nu=z.useRef(null),[ru,fc]=z.useState(null),[Xa,sd]=z.useState(1),co=10;Math.ceil((Array.isArray(jn)?jn.length:0)/co);const zo=async()=>{try{return await Ar.users.getCombinedEmployees(),!0}catch(je){return console.error("HR2 service check failed:",je),Zt.error("HR2 service is not available. Please contact administrator."),!1}},Za=async je=>{if(!je){lr(null),ka(!1);return}ka(!0),console.log("Loading profile for user ID:",je,"Employees loaded:",ze.length),lr(null),bs({first_name:"",last_name:"",department:"",position:"",email:"",phone:"",address:"",birthday:"",civil_status:"",emergency_contact:"",hire_date:"",manager:"",employee_status:"Active",profile_photo_url:"",roles:""});try{console.log("Employees array:",ze);const ot=ze.find(vn=>String(vn.id)===String(je));if(console.log("Found user for ID",je,":",ot),console.log("Found user:",ot),ot&&ot.employee_data){const vn=ot.employee_data.id;console.log("Found employee data for user",je,"-> employee ID:",vn);try{const gr=(await Ar.employees.getById(vn)).data;console.log("Got employee data from HR2:",gr);const Zn={id:gr.id,first_name:gr.first_name||"",last_name:gr.last_name||"",email:gr.email||"",department:gr.department||"",position:gr.position||"",phone:gr.phone||"",address:gr.address||"",birthday:gr.birthday||"",civil_status:gr.civil_status||"",emergency_contact:gr.emergency_contact||"",hire_date:gr.hire_date||"",manager:gr.manager||"",employee_status:gr.employee_status||"Active",profile_photo_url:gr.profile_photo_url||"",roles:gr.roles||""};lr(Zn),bs(Zn),qt(vn),Wn(je),console.log("Loaded profile for employee:",vn,"auth user:",je,Zn),ka(!1);return}catch(Sr){console.log("Employee API failed, using combined employee data:",Sr.message)}}if(ot){console.log("Using combined employee data for user:",je);const vn={id:ot.id,first_name:ot.first_name||"",last_name:ot.last_name||"",email:ot.email||"",department:ot.employee_data?.department||ot.department||"",position:ot.employee_data?.position||ot.position||"",phone:ot.employee_data?.phone||ot.phone||"",address:ot.employee_data?.address||ot.address||"",birthday:ot.employee_data?.birthday||ot.birthday||"",civil_status:ot.employee_data?.civil_status||ot.civil_status||"",emergency_contact:ot.employee_data?.emergency_contact||ot.emergency_contact||"",hire_date:ot.employee_data?.hire_date||ot.hire_date||"",manager:ot.employee_data?.manager||ot.manager||"",employee_status:ot.employee_data?.employee_status||ot.employee_status||"Active",profile_photo_url:ot.employee_data?.profile_photo_url||ot.profile_photo_url||"",roles:ot.employee_data?.roles||ot.roles||""};lr(vn),bs(vn),qt(ot.employee_data?.id||ot.id),console.log("Loaded profile from combined data for user:",je,"employeeId set to:",ot.employee_data?.id||ot.id),ka(!1);return}if(ze.length===0){console.log("Employees not loaded yet, waiting..."),setTimeout(()=>Za(je),1e3);return}console.log("No profile found for user:",je),Zt.error("Profile not found. Please contact HR administrator."),lr(null),ka(!1)}catch(ot){console.error("Error loading profile:",ot),Zt.error("Failed to load profile. Please try again."),lr(null),ka(!1)}},Zo=async()=>{try{const je=await Ar.users.getCombinedEmployees(),ot=je.value||je.data||je;Array.isArray(ot)?(Fe(ot),Xn(ot)):(console.warn("Unexpected response format from combined employees:",je),Fe([]),Xn([]))}catch(je){console.log("Combined employees failed, falling back to auth users:",je.message);try{const ot=await r6();if(Array.isArray(ot)){const vn=ot.map(Sr=>({id:Sr.id,name:Sr.name||"",email:Sr.email||"",first_name:Sr.name?.split(" ")[0]||Sr.name||"",last_name:Sr.name?.split(" ").slice(1).join(" ")||"",department:"",position:"",employee_data:null}));Fe(vn),Xn(vn)}else Fe([]),Xn([])}catch(ot){console.error("Failed to load any employee data:",ot),Zt.error("Failed to load employee list. Please check your connection."),Fe([]),Xn([])}}},Po=async()=>{try{const je=await r6();if(Array.isArray(je)){const ot=je.map(vn=>({...vn,first_name:vn.first_name||vn.name?.split(" ")[0]||vn.name||"",last_name:vn.last_name||vn.name?.split(" ").slice(1).join(" ")||""}));Ur(ot)}else console.warn("Unexpected response format from getUsers:",je),Ur([])}catch(je){console.error("Failed to load user accounts:",je),Zt.error("Failed to load user accounts. Please check your connection."),Ur([])}},to=async()=>{console.log("loadLeaveRequests called - employeeId:",st,"userRole:",yi,"isHR2Admin:",xr);try{if(xr){console.log("User is HR2 Admin, loading ONLY PENDING leave requests for management");const ot=await Ar.leaveRequests.getAll();console.log("getAll response:",ot);const Sr=(ot.data||[]).filter(gr=>gr.status==="Pending");console.log("Filtered pending leave requests for admin:",Sr),Nn(Sr),console.log("Loaded pending leave requests for admin:",Sr.length,"requests");return}if(st){console.log("Loading employee-specific requests for employeeId:",st);const ot=await Ar.leaveRequests.getByEmployee(st);console.log("getByEmployee response:",ot),Nn(ot.data||[]),console.log("Loaded employee leave requests:",ot.data);return}console.log("No employeeId available, trying to load all requests as fallback");const je=await Ar.leaveRequests.getAll();console.log("getAll fallback response:",je),Nn(je.data||[]),console.log("Loaded all leave requests as fallback:",je.data)}catch(je){if(console.log("Error loading leave requests:",je),xr&&st&&(je.response?.status===403||je.response?.status===401)){console.log("HR2 Admin access to all requests failed, trying employee-specific requests");try{const ot=await Ar.leaveRequests.getByEmployee(st);console.log("HR2 Admin fallback getByEmployee response:",ot),Nn(ot.data||[]),console.log("Loaded HR2 Admin employee leave requests as fallback:",ot.data)}catch(ot){console.log("HR2 Admin fallback also failed:",ot),Nn([])}}else if(st&&(je.response?.status===403||je.response?.status===401)){console.log("Admin access failed, trying employee-specific requests");try{const ot=await Ar.leaveRequests.getByEmployee(st);console.log("Fallback getByEmployee response:",ot),Nn(ot.data||[]),console.log("Loaded employee leave requests as fallback:",ot.data)}catch(ot){console.log("Fallback also failed:",ot),Nn([])}}else Nn([])}},Pu=async()=>{try{const je=t?.id||Vt;if(console.log("fetchUserRole called - currentUser:",t,"userId:",je),console.log("userAccounts available:",mr.length,"employees available:",ze.length),je){const ot=mr.find(vn=>String(vn.id)===String(je));if(console.log("Found user in userAccounts:",ot),ot&&ot.role)Hi(ot.role),console.log("User role set to:",ot.role),ot.role==="HR2 Admin"&&(console.log("HR2 Admin role detected, loading all timesheet adjustment requests"),Je());else try{console.log("Fetching user from API for ID:",je);const vn=await n6(je);console.log("User data from API:",vn),vn&&vn.role?(Hi(vn.role),console.log("User role fetched from API:",vn.role),vn.role==="HR2 Admin"&&(console.log("HR2 Admin role detected from API, loading all timesheet adjustment requests"),Je())):(Hi("Employee"),console.log("User role defaulted to Employee - no role in API response"))}catch(vn){console.error("Failed to fetch user role from API:",vn),Hi("Employee")}}else Hi("Employee"),console.log("User role defaulted to Employee - no user ID")}catch(je){console.error("Error determining user role:",je),Hi("Employee")}},ml=async()=>{try{console.log("Loading leave request history from backend for HR2 Admin");const[je,ot]=await Promise.all([Ar.leaveRequests.getApproved(),Ar.leaveRequests.getDenied()]),vn=je.data||[],Sr=ot.data||[],gr=[...vn,...Sr].map(Zn=>({...Zn,employee_name:Va(Zn.employee),processed_at:Zn.updated_at||Zn.processed_at,status:Zn.status==="Accepted"?"Approved":Zn.status==="Denied"?"Rejected":Zn.status}));console.log("Loaded leave request history from backend:",gr),Re(gr)}catch(je){console.error("Failed to load leave request history from backend:",je),console.log("Falling back to localStorage for leave request history")}},pc=async()=>{try{console.log("Loading timesheet adjustment history from backend for HR2 Admin");const[je,ot]=await Promise.all([Ar.timesheetAdjustments.getApproved(),Ar.timesheetAdjustments.getRejected()]),vn=je.data||[],Sr=ot.data||[],gr=[...vn,...Sr].map(Zn=>({...Zn,employee_name:Va(Zn.employee),processed_at:Zn.updated_at||Zn.processed_at}));console.log("Loaded timesheet adjustment history from backend:",gr),nt(gr)}catch(je){console.error("Failed to load timesheet adjustment history from backend:",je),console.log("Falling back to localStorage for timesheet adjustment history")}};z.useEffect(()=>{(async()=>{if(!await zo()){ut("HR2 service is not available. Please contact administrator."),ka(!1);return}await Zo(),await Po(),ka(!1)})()},[]),z.useEffect(()=>{ze.length>0&&Pu()},[ze.length]),z.useEffect(()=>{mr.length>0&&Pu()},[mr.length]),z.useEffect(()=>{t?.id&&ze.length>0&&(console.log("Loading profile for:",t.id,"with",ze.length,"employees loaded"),Za(t.id))},[t?.id,ze.length]),z.useEffect(()=>{const je=async()=>{const vn=await bi();Di(vn)};je();const ot=setInterval(je,3e4);return()=>clearInterval(ot)},[]),z.useEffect(()=>{const je=setInterval(()=>{(st||xr)&&!Wr&&!Dl&&!ai&&!Ks&&!$&&(console.log("Data refreshed automatically"),to(),Je(),Mt())},6e4);return()=>clearInterval(je)},[st,xr,Wr,Dl,ai,Ks,$]),z.useEffect(()=>{const je=()=>{!document.hidden&&(st||xr)&&!Wr&&!Dl&&!ai&&!Ks&&!$&&(console.log("Data refreshed automatically on visibility change"),to(),Je(),Mt())};return document.addEventListener("visibilitychange",je),()=>document.removeEventListener("visibilitychange",je)},[st,xr,Wr,Dl,ai,Ks,$]),z.useEffect(()=>{console.log("useEffect triggered for loadLeaveRequests - employeeId:",st,"userRole:",yi,"isHR2Admin:",xr),st||xr?(console.log("Calling loadLeaveRequests because employeeId is set or user is HR2 Admin"),to()):console.log("Not calling loadLeaveRequests because neither employeeId nor HR2 Admin role is set")},[st,yi]),z.useEffect(()=>{console.log("useEffect triggered for loadTimesheetAdjustmentRequests - employeeId:",st,"userRole:",yi,"isHR2Admin:",xr),st||xr?(console.log("Calling loadTimesheetAdjustmentRequests because employeeId is set or user is HR2 Admin"),Je()):console.log("Not calling loadTimesheetAdjustmentRequests because neither employeeId nor HR2 Admin role is set")},[st,yi]),z.useEffect(()=>{xr&&(ml(),pc())},[xr]),z.useEffect(()=>{try{console.log("Saving shared leave request history to localStorage:",Ve),localStorage.setItem("hr2_leaveRequestHistory",JSON.stringify(Ve)),console.log("Shared leave request history saved to localStorage successfully")}catch(je){console.error("Error saving shared leave request history to localStorage:",je)}},[Ve]),z.useEffect(()=>{try{console.log("Saving shared timesheet adjustment history to localStorage:",$e),localStorage.setItem("hr2_timesheetAdjustmentHistory",JSON.stringify($e)),console.log("Shared timesheet adjustment history saved to localStorage successfully")}catch(je){console.error("Error saving shared timesheet adjustment history to localStorage:",je)}},[$e]),z.useEffect(()=>{try{console.log("Saving reimbursement history to localStorage:",w),localStorage.setItem("hr2_reimbursementHistory",JSON.stringify(w)),console.log("Reimbursement history saved to localStorage successfully")}catch(je){console.error("Error saving reimbursement history to localStorage:",je)}},[w]),z.useEffect(()=>{if(xr){const je=setInterval(()=>{Je()},1e4);return()=>clearInterval(je)}},[xr]),z.useEffect(()=>{const je=ot=>{console.log("Received timesheet adjustment submission event:",ot.detail),xr&&(console.log("Admin detected - refreshing timesheet adjustment requests"),Je())};return window.addEventListener("timesheetAdjustmentSubmitted",je),()=>{window.removeEventListener("timesheetAdjustmentSubmitted",je)}},[xr]),z.useEffect(()=>{console.log("useEffect triggered for loadReimbursementRequests - employeeId:",st,"userRole:",yi,"isHR2Admin:",xr),(st||xr)&&(console.log("Calling loadReimbursementRequests"),Mt())},[st,yi]),z.useEffect(()=>{xr&&(ml(),pc(),sn())},[xr]);const Va=je=>{if(!je)return"";let ot=je.last_name||"";return je.first_name&&(ot=je.first_name+" "+ot),ot.trim()},nl=je=>{if(!je)return"N/A";try{const ot=new Date(je),vn=(ot.getMonth()+1).toString().padStart(2,"0"),Sr=ot.getDate().toString().padStart(2,"0"),gr=ot.getFullYear();return`${vn}-${Sr}-${gr}`}catch{return"N/A"}},ad=(je,ot)=>{if(!je||je.length===0){Zt.error("No data to export");return}const vn=Object.keys(je[0]),Sr=[vn.join(","),...je.map(ua=>vn.map(no=>{const La=ua[no];return typeof La=="string"&&(La.includes(",")||La.includes('"'))?`"${La.replace(/"/g,'""')}"`:La||""}).join(","))].join(`
`),gr=new Blob([Sr],{type:"text/csv;charset=utf-8;"}),Zn=document.createElement("a"),Mo=URL.createObjectURL(gr);Zn.setAttribute("href",Mo),Zn.setAttribute("download",`${ot}_${new Date().toISOString().split("T")[0]}.csv`),Zn.style.visibility="hidden",document.body.appendChild(Zn),Zn.click(),document.body.removeChild(Zn),Zt.success("CSV exported successfully")},wo=(je,ot)=>bs(vn=>({...vn,[je]:ot})),$a=je=>{const{name:ot,value:vn}=je.target;Vr(Sr=>({...Sr,[ot]:vn}))},rl=je=>{const{name:ot,value:vn}=je.target;Jr(Sr=>({...Sr,[ot]:vn}))},Ql=je=>{Gr(je);let ot="",vn="";if(je.employee_data)ot=je.employee_data.first_name||"",vn=je.employee_data.last_name||"";else{const Sr=(je.name||"").trim().split(" ");ot=Sr[0]||"",vn=Sr.slice(1).join(" ")||""}Jr({first_name:ot,last_name:vn,email:je.email||"",role:je.role||"Employee",original_email:je.email||""}),pr(!0)},gl=async()=>{nn(!0),ut("");try{if(!Ys.first_name||!Ys.last_name||!Ys.email||!Ys.password){Zt.error("Please fill in all required fields.");return}const ot={name:[Ys.first_name,Ys.last_name].filter(Boolean).join(" ").trim(),email:Ys.email,password:Ys.password,role:Ys.roles},vn=await Wd.post("/register",ot),Sr={first_name:Ys.first_name,last_name:Ys.last_name,email:Ys.email,roles:Ys.roles,hire_date:new Date().toISOString().split("T")[0],employee_status:"Active"};try{await Ar.employees.create(Sr),console.log("HR2 employee record created successfully")}catch(Zn){console.error("Failed to create HR2 employee record:",Zn),Zt.warning("Account created but HR2 employee record may not be synced. Please contact administrator.")}Zt.success("Account created successfully!"),Vr({first_name:"",last_name:"",email:"",password:"",roles:"Employee"}),await Po(),await Zo();const gr=Oe.response?.data?.message||Oe.response?.data?.error||Oe.message||"Failed to create account";Zt.error(gr)}finally{nn(!1)}},qh=async je=>{if(!Qr||String(Qr.id)!==String(je)){Zt.error("Edit session mismatch. Please try again."),pr(!1);return}nn(!0);try{if(!Rt.first_name||!Rt.last_name||!Rt.role){Zt.error("Please fill in all required fields.");return}if(Rt.email!==Rt.original_email&&!Rt.email){Zt.error("Please provide an email address.");return}const vn={name:[Rt.first_name,Rt.last_name].filter(Boolean).join(" ").trim(),role:Rt.role};Rt.email!==Rt.original_email&&(vn.email=Rt.email),console.log("Sending update data to auth API:",vn),await Wd.put(`/users/${je}`,vn);try{const Sr=ze.find(Zn=>String(Zn.id)===String(je)),gr=Sr?.employee_data?.id||Sr?.id;if(gr){const Zn={first_name:Rt.first_name,last_name:Rt.last_name,email:Rt.email,roles:Rt.role};await Ar.employees.update(gr,Zn),console.log("HR2 employee record updated successfully")}}catch(Sr){console.error("HR2 sync failed:",Sr)}Zt.success("Account updated successfully!"),pr(!1),Gr(null),Jr({first_name:"",last_name:"",email:"",role:"Employee",original_email:""}),await Po(),await Zo(),String(je)===String(t?.id)&&await Za(t?.id)}catch(ot){if(console.error("Error updating account:",ot),ot.response?.status===422){const vn=ot.response?.data?.errors||ot.response?.data;if(typeof vn=="object"){const Sr=Object.values(vn).flat();Zt.error(Sr.join(", ")||"Validation failed")}else Zt.error(ot.response?.data?.message||"Validation failed")}else Zt.error(ot.response?.data?.message||"Failed to update account")}finally{nn(!1)}},Kd=async je=>{if(confirm("Are you sure you want to delete this account? This action cannot be undone.")){nn(!0);try{await Wd.delete(`/users/${je}`),Zt.success("Account deleted successfully!");try{const ot=ze.find(Sr=>String(Sr.id)===String(je)),vn=ot?.employee_data?.id||ot?.id;vn&&(await Ar.employees.update(vn,{employee_status:"Inactive"}),console.log("HR2 employee record marked as inactive"))}catch(ot){console.error("HR2 deactivation failed:",ot)}await Po(),await Zo()}catch(ot){console.error("Error deleting account:",ot),Zt.error(ot.response?.data?.message||"Failed to delete account")}finally{nn(!1)}}},Mu=async()=>{nn(!0);try{const je={...Ji};delete je.profile_photo_url;const ot={};Object.keys(je).forEach(ta=>{const Ta=je[ta];ta==="first_name"||ta==="last_name"||ta==="email"?ot[ta]=Ta||"":(Ta!==""||ta==="roles")&&(ot[ta]=Ta)}),ot.first_name||(ot.first_name=Ji.first_name||""),ot.last_name||(ot.last_name=Ji.last_name||""),ot.email||(ot.email=Ji.email||"");const vn=[ot.first_name,ot.last_name].filter(Boolean),Sr={},gr=vn.join(" ").trim();gr&&(Sr.name=gr),ot.email&&ot.email.trim()&&(Sr.email=ot.email.trim()),ot.roles&&ot.roles.trim()&&(Sr.role=ot.roles.trim());const Zn={...ot};delete Zn.roles,console.log("Sending auth data:",Sr),console.log("Sending hr2 data:",Zn),console.log("Employee ID:",st);let Mo=rn;if(!Mo)try{Mo=(await n6()).id,console.log("Got current auth user ID:",Mo)}catch(ta){console.error("Failed to get current user:",ta),Zt.error("Unable to identify current user for update"),nn(!1);return}if(Object.keys(Sr).length>0)try{await Ar.users.updateUser(Mo,Sr),console.log("Auth update successful")}catch(ta){console.error("Auth update failed:",ta);const Ta=ta.response?.data?.message||ta.response?.data?.error||ta.message||"";if(Ta.toLowerCase().includes("email has been taken")||Ta.toLowerCase().includes("email already exists")||Ta.toLowerCase().includes("duplicate entry"))console.log("Email validation error detected, continuing with HR2 update only"),Zt.warning("Email validation issue detected. Updating employee record only.");else{Zt.error("Failed to update user information: "+Ta);return}}else console.log("No auth data to update");let ua,no=!1;const La=st||t?.id;if(!La){Zt.error("Employee ID not available. Please refresh the page and try again."),nn(!1);return}try{console.log("Attempting to update employee with ID:",La),ua=await Ar.employees.update(La,Zn),console.log("HR2 Update successful:",ua),no=!0}catch(ta){if(console.log("Update error caught:",ta.response?.status),ta.response?.status===404){console.log("Employee not found, creating new employee record...");try{const Ta={...Zn,auth_user_id:Mo,user_id:Mo,first_name:ot.first_name||"Unknown",last_name:ot.last_name||"User",email:ot.email||"",department:Zn.department||"General",position:Zn.position||"Employee",hire_date:Zn.hire_date||new Date().toISOString().split("T")[0],employee_status:Zn.employee_status||"Active"};console.log("Creating employee with data:",Ta),ua=await Ar.employees.create(Ta),console.log("Employee created successfully:",ua),Zt.success("Employee profile created successfully."),no=!0,ua.data&&ua.data.id&&qt(ua.data.id)}catch(Ta){console.error("Failed to create employee:",Ta);const kl=Ta.response?.data?.message||Ta.response?.data?.error||"Failed to create employee profile.";Zt.error(kl),nn(!1);return}}else{const Ta=ta.response?.data?.message||ta.response?.data?.error||"Failed to update employee profile.";Zt.error(Ta),nn(!1);return}}no&&Zt.success("Employee profile updated successfully."),await Zo(),await Po(),await Za(La),fe(!1),ir(!1),ke(null)}catch(je){console.error("Update error:",je);const ot=je.response?.data?.message||je.response?.data?.error||je.message||"Failed to update employee";Zt.error(ot)}finally{nn(!1)}},bi=async()=>{try{return(await fetch("http://127.0.0.1:8092/api/hr2/employees",{method:"HEAD",headers:{"Content-Type":"application/json"}})).ok}catch{return!1}},yl=async je=>{const ot=je.target.files[0];if(ot)try{nn(!0);const vn=new FormData;vn.append("profile_photo",ot);const Sr=t?.id||st;if(!Sr){Zt.error("Unable to identify user for photo upload");return}const gr=await Ar.employees.uploadPhoto(Sr,vn);gr.profile_photo_url?(bs(Zn=>({...Zn,profile_photo_url:gr.profile_photo_url})),$t&&lr(Zn=>({...Zn,profile_photo_url:gr.profile_photo_url})),Zt.success("Profile photo updated successfully!")):Zt.error("Failed to upload profile photo")}catch(vn){console.error("Photo upload error:",vn),Zt.error("Failed to upload profile photo")}finally{nn(!1)}},mc=Xa*co,gc=mc-co;return Array.isArray(jn)&&jn.slice(gc,mc),xa?o.jsx("div",{className:"min-h-screen bg-gray-50/30 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary mx-auto"}),o.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading Employee Self-Service..."})]})}):Oe?o.jsx("div",{className:"min-h-screen bg-gray-50/30 flex items-center justify-center",children:o.jsxs("div",{className:"text-center max-w-md",children:[o.jsx("div",{className:"text-red-500 mb-4",children:o.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Error Loading Employee Self-Service"}),o.jsx("p",{className:"text-gray-600 mb-4",children:Oe}),o.jsx(kt,{onClick:()=>window.location.reload(),children:"Try Again"})]})}):o.jsxs("div",{className:"min-h-screen",children:[o.jsx("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:o.jsx("div",{className:"container flex h-12 items-center justify-between px-4",children:o.jsx("div",{className:"flex items-center gap-3",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Xy,{className:"h-6 w-6 text-primary"}),o.jsx("h1",{className:"text-lg font-semibold",children:"Employee Self-Service"})]})})})}),o.jsxs("div",{className:"container mx-auto px-6 py-8 space-y-8",children:[o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs(ni,{className:"hover:shadow-md transition-shadow",children:[o.jsxs(Ns,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(us,{className:"text-sm font-medium",children:"Leave Balance"}),o.jsx(Hp,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(qi,{children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.leaveBalance}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Days remaining"})]})]}),o.jsxs(ni,{className:"hover:shadow-md transition-shadow",children:[o.jsxs(Ns,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(us,{className:"text-sm font-medium",children:"Upcoming Trainings"}),o.jsx(kh,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(qi,{children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.upcomingTrainings}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs(ni,{className:"hover:shadow-md transition-shadow",children:[o.jsxs(Ns,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(us,{className:"text-sm font-medium",children:"Pending Requests"}),o.jsx(Kp,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(qi,{children:[o.jsx("div",{className:"text-2xl font-bold text-orange-600",children:n.pendingRequests}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting approval"})]})]}),o.jsxs(ni,{className:"hover:shadow-md transition-shadow",children:[o.jsxs(Ns,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(us,{className:"text-sm font-medium",children:"Completed Trainings"}),o.jsx(W0,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(qi,{children:[o.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n.completedTrainings}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"This year"})]})]})]}),o.jsx("div",{className:"w-106",children:o.jsxs(ni,{className:"hover:shadow-md transition-shadow h-full",children:[o.jsx(Ns,{children:o.jsxs(us,{className:"flex items-center gap-2",children:[o.jsx(K1,{className:"w-5 h-5 text-blue-600"}),"Competency Profile"]})}),o.jsx(qi,{children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",children:"Leadership"}),o.jsx(_i,{variant:"secondary",className:"bg-blue-100 text-blue-800 hover:bg-blue-200",children:"Advanced"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",children:"Technical Skills"}),o.jsx(_i,{variant:"secondary",className:"bg-green-100 text-green-800 hover:bg-green-200",children:"Intermediate"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",children:"Communication"}),o.jsx(_i,{variant:"secondary",className:"bg-purple-100 text-purple-800 hover:bg-purple-200",children:"Expert"})]})]})})]})}),o.jsx("div",{className:"w-106 ml-37",children:o.jsxs(ni,{className:"hover:shadow-md transition-shadow w-full h-full",children:[o.jsx(Ns,{children:o.jsxs(us,{className:"flex items-center gap-2",children:[o.jsx(Kp,{className:"w-5 h-5 text-green-600"}),xr?"Timesheet Adjustments":"Recent Timesheet"]})}),o.jsx(qi,{children:xr?o.jsx("div",{className:"space-y-3 max-h-48 overflow-y-auto",children:ye.length>0?ye.slice(0,3).map(je=>o.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-muted/50 transition-colors",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"text-sm font-medium",children:je.employee?`${je.employee.first_name} ${je.employee.last_name}`:"Unknown Employee"}),o.jsxs("div",{className:"text-xs text-muted-foreground",children:[new Date(je.date).toLocaleDateString()," • ",je.new_time_in," - ",je.new_time_out]}),o.jsx(_i,{variant:je.status==="Approved"?"default":je.status==="Rejected"?"destructive":"secondary",className:"text-xs mt-1",children:je.status})]}),o.jsx("div",{className:"flex gap-1",children:je.status==="Pending"&&o.jsxs(o.Fragment,{children:[o.jsx(kt,{size:"sm",onClick:()=>Rr(je,"Approved"),className:"bg-green-600 hover:bg-green-700 text-white h-6 px-2",children:"✓"}),o.jsx(kt,{size:"sm",variant:"destructive",onClick:()=>Rr(je,"Rejected"),className:"h-6 px-2",children:"✗"})]})})]},je.id)):o.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"No adjustment requests yet"})}):o.jsx("div",{className:"space-y-3",children:se.slice(0,3).map(je=>o.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-muted/50 transition-colors",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium",children:je.date}),o.jsxs("div",{className:"text-xs text-muted-foreground",children:[je.timeIn," - ",je.timeOut]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-sm font-medium",children:je.overtime}),o.jsx(_i,{variant:je.status==="Complete"?"default":"secondary",className:"text-xs",children:je.status})]})]},je.id))})})]})})]}),o.jsxs(ni,{className:"hover:shadow-md transition-shadow",children:[o.jsx(Ns,{children:o.jsxs(us,{className:"flex items-center gap-2",children:[o.jsx(Xy,{className:"w-5 h-5 text-purple-600"}),"Personal Information"]})}),o.jsxs(qi,{children:[!xa&&$t?o.jsxs("div",{className:"flex gap-6",children:[o.jsxs("div",{className:"flex flex-col items-center space-y-4 min-w-[200px]",children:[o.jsx("div",{className:"w-32 h-32 rounded-full bg-gray-200 overflow-hidden",children:o.jsx("img",{src:$t.profile_photo_url||"https://imgur.com/gallery/empty-profile-BgI2COR#Yrf0E0C",alt:"Profile",className:"w-full h-full object-cover"})}),(dr||xr)&&o.jsxs(o.Fragment,{children:[o.jsxs(kt,{variant:"outline",onClick:()=>Nu.current.click(),size:"sm",children:[o.jsx(The,{className:"w-4 h-4 mr-1"}),"Upload Photo"]}),o.jsx(On,{type:"file",ref:Nu,onChange:yl,className:"hidden"})]})]}),o.jsx("div",{className:"flex-1",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(bt,{htmlFor:"newAccountFirstName",children:"First Name"}),o.jsx(On,{id:"newAccountFirstName",value:Ji.first_name||"",onChange:je=>wo("first_name",je.target.value)})]}),o.jsxs("div",{children:[o.jsx(bt,{htmlFor:"last_name",children:"Last Name"}),o.jsx(On,{id:"last_name",value:Ji.last_name||"",onChange:je=>wo("last_name",je.target.value)})]}),o.jsxs("div",{children:[o.jsx(bt,{htmlFor:"email",children:"Email"}),o.jsx(On,{id:"email",type:"email",value:Ji.email||"",onChange:je=>wo("email",je.target.value)})]}),o.jsxs("div",{children:[o.jsx(bt,{htmlFor:"phone",children:"Phone"}),o.jsx(On,{id:"phone",value:Ji.phone||"",onChange:je=>wo("phone",je.target.value)})]}),o.jsxs("div",{children:[o.jsx(bt,{htmlFor:"address",children:"Address"}),o.jsx(On,{id:"address",value:Ji.address||"",onChange:je=>wo("address",je.target.value)})]}),o.jsxs("div",{children:[o.jsx(bt,{htmlFor:"manager",children:"Manager"}),o.jsx(On,{id:"manager",value:Ji.manager||"",onChange:je=>wo("manager",je.target.value)})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(bt,{htmlFor:"department",children:"Department"}),o.jsx(On,{id:"department",value:Ji.department||"",onChange:je=>wo("department",je.target.value)})]}),o.jsxs("div",{children:[o.jsx(bt,{htmlFor:"position",children:"Position"}),o.jsx(On,{id:"position",value:Ji.position||"",onChange:je=>wo("position",je.target.value)})]}),o.jsxs("div",{children:[o.jsx(bt,{htmlFor:"birthday",children:"Birthday"}),o.jsx(On,{id:"birthday",type:"date",value:Ji.birthday||"",onChange:je=>wo("birthday",je.target.value)})]}),o.jsxs("div",{children:[o.jsx(bt,{htmlFor:"civil_status",children:"Civil Status"}),o.jsx(On,{id:"civil_status",value:Ji.civil_status||"",onChange:je=>wo("civil_status",je.target.value)})]}),o.jsxs("div",{children:[o.jsx(bt,{htmlFor:"emergency_contact",children:"Emergency Contact"}),o.jsx(On,{id:"emergency_contact",value:Ji.emergency_contact||"",onChange:je=>wo("emergency_contact",je.target.value)})]}),o.jsxs("div",{children:[o.jsx(bt,{htmlFor:"hire_date",children:"Hire Date"}),o.jsx(On,{id:"hire_date",type:"date",value:Ji.hire_date||"",onChange:je=>wo("hire_date",je.target.value)})]})]})]})})]}):o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-muted-foreground",children:"Loading profile information..."})}),o.jsx("div",{className:"flex justify-end mt-6",children:o.jsx(kt,{onClick:Mu,disabled:St,size:"sm",children:St?"Saving...":"Save Changes"})})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs(ni,{children:[o.jsx(Ns,{children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{children:[dr&&o.jsxs(us,{className:"flex items-center gap-2",children:[o.jsx(lhe,{className:"w-5 h-5 text-orange-600"}),"Leave Requests"]}),xr&&o.jsxs(us,{className:"flex items-center gap-2",children:[o.jsx(c6,{className:"w-6 h-6 text-orange-600"}),"Manage Leave Requests"]})]}),o.jsxs("div",{className:"flex gap-2",children:[xr&&o.jsxs(kt,{variant:"outline",size:"sm",onClick:()=>{console.log("Opening leave history dialog"),console.log("Current leaveRequestHistory:",Ve),console.log("leaveRequestHistory length:",Ve.length),Ia(!0)},className:"gap-2",children:[o.jsx(wx,{className:"w-4 h-4"}),"History"]}),o.jsxs(ds,{open:Wr,onOpenChange:Gi,children:[dr&&o.jsx(kf,{asChild:!0,children:o.jsxs(kt,{className:"gap-2",onClick:()=>Gi(!0),children:[o.jsx(Au,{className:"w-4 h-4"}),"New Leave Request"]})}),o.jsxs(gs,{children:[o.jsx(ys,{children:o.jsx(vs,{children:"Submit Leave Request"})}),o.jsxs("div",{className:"grid gap-4 py-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"leaveType",children:"Leave Type"}),o.jsxs(Fs,{value:ci.type,onValueChange:je=>ui(ot=>({...ot,type:je})),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select leave type"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Vacation",children:"Vacation Leave"}),o.jsx(Gn,{value:"Sick",children:"Sick Leave"}),o.jsx(Gn,{value:"Emergency",children:"Emergency Leave"}),o.jsx(Gn,{value:"Personal",children:"Personal Leave"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"startDate",children:"Start Date"}),o.jsx(On,{id:"startDate",type:"date",value:ci.start,onChange:je=>ui(ot=>({...ot,start:je.target.value}))})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"endDate",children:"End Date"}),o.jsx(On,{id:"endDate",type:"date",value:ci.end,onChange:je=>ui(ot=>({...ot,end:je.target.value}))})]})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"reason",children:"Reason"}),o.jsx("textarea",{id:"reason",placeholder:"Please provide a reason for your leave request",value:ci.reason,onChange:je=>ui(ot=>({...ot,reason:je.target.value})),className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]})]}),o.jsx(Co,{children:o.jsx(kt,{onClick:Ee,children:"Submit Request"})})]})]})]})]})}),o.jsx(qi,{children:o.jsx("div",{className:"space-y-4 max-h-85 overflow-y-auto rounded-md p-2",children:Array.isArray(qr)&&qr.length>0?qr.map(je=>o.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-medium",children:je.type}),o.jsxs("div",{className:"text-sm text-muted-foreground",children:[new Date(je.start).toLocaleDateString()," - ",new Date(je.end).toLocaleDateString()]}),je.reason&&o.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:je.reason})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(_i,{variant:je.status==="Accepted"?"default":je.status==="Denied"?"destructive":"secondary",children:je.status}),je.status==="Pending"&&xr&&o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>et(je),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:o.jsx(qx,{className:"w-4 h-4"})}),je.status==="Pending"&&!xr&&o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>it(je.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:o.jsx(bg,{className:"w-4 h-4"})})]})]},je.id)):o.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No leave requests submitted yet"})})})]}),o.jsxs(ni,{children:[o.jsx(Ns,{children:o.jsxs("div",{className:"flex justify-between items-center",children:[dr&&o.jsxs(us,{className:"flex items-center gap-2",children:[o.jsx(Kp,{className:"w-5 h-5 text-blue-600"}),"Overtime & Timesheet Adjustments"]}),xr&&o.jsxs(us,{className:"flex items-center gap-2",children:[o.jsx(c6,{className:"w-6 h-6 text-blue-600"}),"Manage Adjustment Requests"]}),o.jsxs("div",{className:"flex gap-2",children:[xr&&o.jsxs(kt,{variant:"outline",size:"sm",onClick:()=>{console.log("Opening timesheet history dialog"),console.log("Current timesheetAdjustmentHistory:",$e),console.log("timesheetAdjustmentHistory length:",$e.length),Ua(!0)},className:"gap-2",children:[o.jsx(wx,{className:"w-4 h-4"}),"History"]}),!xr&&o.jsxs(ds,{open:Dl,onOpenChange:hc,children:[o.jsx(kf,{asChild:!0,children:o.jsxs(kt,{variant:"default",size:"sm",children:[o.jsx(Au,{className:"w-4 h-4 mr-2"}),"Request Adjustment"]})}),o.jsxs(gs,{children:[o.jsx(ys,{children:o.jsx(vs,{children:"Timesheet Adjustment Request"})}),o.jsxs("div",{className:"grid gap-4 py-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"adjustmentDate",children:"Date"}),o.jsx(On,{id:"adjustmentDate",type:"date",value:ts.date,onChange:je=>dc(ot=>({...ot,date:je.target.value}))})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"newTimeIn",children:"New Time In"}),o.jsx(On,{id:"newTimeIn",type:"time",value:ts.newTimeIn,onChange:je=>dc(ot=>({...ot,newTimeIn:je.target.value}))})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"newTimeOut",children:"New Time Out"}),o.jsx(On,{id:"newTimeOut",type:"time",value:ts.newTimeOut,onChange:je=>dc(ot=>({...ot,newTimeOut:je.target.value}))})]})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"adjustmentReason",children:"Reason"}),o.jsx("textarea",{id:"adjustmentReason",placeholder:"Please explain the reason for this adjustment",value:ts.reason,onChange:je=>dc(ot=>({...ot,reason:je.target.value})),className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]})]}),o.jsx(Co,{children:o.jsx(kt,{onClick:We,children:"Submit Request"})})]})]})]})]})}),o.jsx(qi,{children:o.jsx("div",{className:"space-y-4 max-h-85 overflow-y-auto rounded-md p-2",children:ye.length>0?ye.map(je=>o.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-medium",children:xr?`Requested by ${je.employee?`${je.employee.first_name} ${je.employee.last_name}`:"Unknown Employee"}`:"Adjustment Request"}),o.jsxs("div",{className:"text-sm text-muted-foreground",children:["Date: ",new Date(je.date).toLocaleDateString()]}),o.jsxs("div",{className:"text-sm text-muted-foreground",children:["Requested Time: ",Ot(je.new_time_in||je.newTimeIn)," - ",Ot(je.new_time_out||je.newTimeOut)]}),o.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Reason: ",je.reason]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(_i,{variant:je.status==="Approved"?"default":je.status==="Rejected"?"destructive":"secondary",children:je.status}),je.status==="Pending"&&xr&&o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>He(je),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:o.jsx(qx,{className:"w-4 h-4"})}),je.status==="Pending"&&!xr&&o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>or(je.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:o.jsx(bg,{className:"w-4 h-4"})})]})]},je.id)):o.jsx("div",{className:"text-center py-8 text-muted-foreground",children:xr?"No timesheet adjustment requests from employees yet":"No timesheet adjustment requests submitted yet"})})})]})]}),o.jsxs(ni,{children:[o.jsx(Ns,{children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{children:[dr&&o.jsxs(us,{className:"flex items-center gap-2",children:[o.jsx(Nhe,{className:"w-5 h-5 text-green-600"}),"Expense Reimbursements"]}),xr&&o.jsxs(us,{className:"flex items-center gap-2",children:[o.jsx(Dde,{className:"w-5 h-5 text-green-600"}),"Manage Reimbursements"]})]}),o.jsxs("div",{className:"flex gap-2",children:[xr&&o.jsxs(kt,{variant:"outline",size:"sm",onClick:()=>{console.log("Opening reimbursement history dialog"),console.log("Current reimbursementHistory:",w),console.log("reimbursementHistory length:",w.length),K(!0)},className:"gap-2",children:[o.jsx(wx,{className:"w-4 h-4"}),"History"]}),!xr&&o.jsxs(ds,{open:D,onOpenChange:V,children:[o.jsx(kf,{asChild:!0,children:o.jsxs(kt,{className:"gap-2",children:[o.jsx(Au,{className:"w-4 h-4"}),"New Expense"]})}),o.jsxs(gs,{children:[o.jsx(ys,{children:o.jsx(vs,{children:"Submit Expense Reimbursement"})}),o.jsxs("div",{className:"grid gap-4 py-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"expenseType",children:"Expense Type"}),o.jsxs(Fs,{value:E.type,onValueChange:je=>N(ot=>({...ot,type:je})),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select expense type"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Travel",children:"Travel"}),o.jsx(Gn,{value:"Meals",children:"Meals"}),o.jsx(Gn,{value:"Office Supplies",children:"Office Supplies"}),o.jsx(Gn,{value:"Training",children:"Training"}),o.jsx(Gn,{value:"Transportation",children:"Transportation"}),o.jsx(Gn,{value:"Other",children:"Other"})]})]})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"expenseAmount",children:"Amount"}),o.jsx(On,{id:"expenseAmount",type:"number",step:"0.01",placeholder:"0.00",value:E.amount,onChange:je=>N(ot=>({...ot,amount:je.target.value}))})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"expenseDate",children:"Date"}),o.jsx(On,{id:"expenseDate",type:"date",value:E.date,onChange:je=>N(ot=>({...ot,date:je.target.value}))})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"expenseDescription",children:"Description"}),o.jsx("textarea",{id:"expenseDescription",placeholder:"Describe the expense",value:E.description,onChange:je=>N(ot=>({...ot,description:je.target.value})),className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"receiptUpload",children:"Receipt (Required)"}),o.jsx(On,{id:"receiptUpload",type:"file",accept:"image/*,.pdf",onChange:je=>N(ot=>({...ot,receipt:je.target.files[0]}))})]})]}),o.jsx(Co,{children:o.jsx(kt,{onClick:an,children:"Submit Expense"})})]})]})]})]})}),o.jsx(qi,{children:o.jsx("div",{className:"space-y-4 max-h-85 overflow-y-auto rounded-md p-2",children:p.length>0?p.map(je=>o.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-medium",children:xr?`Requested by ${je.employee?`${je.employee.first_name} ${je.employee.last_name}`:"Unknown Employee"}`:je.type}),o.jsx("div",{className:"text-sm text-muted-foreground",children:xr?`Type: ${je.type}`:""}),o.jsxs("div",{className:"text-sm text-muted-foreground",children:["Date: ",new Date(je.date).toLocaleDateString()]}),o.jsxs("div",{className:"text-sm text-muted-foreground",children:["Amount: ₱",parseFloat(je.amount).toFixed(2)]}),o.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:je.description})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(_i,{variant:je.status==="Approved"?"default":je.status==="Rejected"?"destructive":"secondary",children:je.status}),dr&&je.receipt_path&&o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>zr(je),className:"text-green-600 hover:text-green-700 hover:bg-green-50",title:"View Receipt",children:o.jsx($A,{className:"w-4 h-4"})}),je.status==="Pending"&&xr&&o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>Cn(je),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:o.jsx(qx,{className:"w-4 h-4"})}),je.status==="Pending"&&!xr&&o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>Jt(je.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:o.jsx(bg,{className:"w-4 h-4"})})]})]},je.id)):o.jsx("div",{className:"text-center py-8 text-muted-foreground",children:xr?"No reimbursement requests from employees yet":"No reimbursement requests submitted yet"})})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs(ni,{children:[o.jsx(Ns,{children:o.jsxs(us,{className:"flex items-center gap-2",children:[o.jsx(kh,{className:"w-5 h-5 text-blue-600"}),"My Learning Plans"]})}),o.jsx(qi,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"p-3 border rounded-lg",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h3",{className:"font-medium",children:"Employee Onboarding Program"}),o.jsx(_i,{variant:"secondary",children:"Mandatory"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{children:"Progress"}),o.jsx("span",{children:"75%"})]}),o.jsx(Df,{value:75,className:"h-2"}),o.jsx("div",{className:"text-xs text-muted-foreground",children:"Due: Oct 15, 2025 • 6/8 modules completed"})]})]}),o.jsxs("div",{className:"p-3 border rounded-lg",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h3",{className:"font-medium",children:"Leadership Development"}),o.jsx(_i,{variant:"outline",children:"Role-based"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{children:"Progress"}),o.jsx("span",{children:"30%"})]}),o.jsx(Df,{value:30,className:"h-2"}),o.jsx("div",{className:"text-xs text-muted-foreground",children:"Due: Nov 20, 2025 • 3/10 modules completed"})]})]})]})})]}),o.jsxs(ni,{children:[o.jsx(Ns,{children:o.jsxs(us,{className:"flex items-center gap-2",children:[o.jsx(s3,{className:"w-5 h-5 text-purple-600"}),"Available Trainings"]})}),o.jsx(qi,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"p-3 border rounded-lg hover:bg-muted/50 cursor-pointer",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsx("h3",{className:"font-medium",children:"Advanced Project Management"}),o.jsx(_i,{variant:"outline",children:"Available"})]}),o.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Master advanced project management techniques and methodologies."}),o.jsxs("div",{className:"flex items-center justify-between text-xs",children:[o.jsx("span",{children:"3 Days • Leadership"}),o.jsx(kt,{size:"sm",children:"Enroll"})]})]}),o.jsxs("div",{className:"p-3 border rounded-lg hover:bg-muted/50 cursor-pointer",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsx("h3",{className:"font-medium",children:"React Development Fundamentals"}),o.jsx(_i,{variant:"outline",children:"Available"})]}),o.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Learn modern React development with hooks and best practices."}),o.jsxs("div",{className:"flex items-center justify-between text-xs",children:[o.jsx("span",{children:"2 Weeks • Technical"}),o.jsx(kt,{size:"sm",children:"Enroll"})]})]})]})})]})]}),o.jsxs(ni,{children:[o.jsx(Ns,{children:o.jsxs(us,{className:"flex items-center gap-2",children:[o.jsx(K1,{className:"w-5 h-5 text-indigo-600"}),"Performance History"]})}),o.jsx(qi,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:"4.8"}),o.jsx("div",{className:"text-sm text-muted-foreground",children:"Average Rating"})]}),o.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:"12"}),o.jsx("div",{className:"text-sm text-muted-foreground",children:"Reviews Completed"})]}),o.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"95%"}),o.jsx("div",{className:"text-sm text-muted-foreground",children:"Goals Achieved"})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("h4",{className:"font-medium",children:"Recent Performance Reviews"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"p-3 border rounded-lg",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h3",{className:"font-medium",children:"Q3 2025 Performance Review"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(_i,{variant:"default",children:"4.9/5"}),o.jsxs(kt,{variant:"outline",size:"sm",children:[o.jsx($p,{className:"w-4 h-4 mr-2"}),"View"]})]})]}),o.jsx("p",{className:"text-sm text-muted-foreground",children:'"Excellent performance in project delivery and team leadership. Consistently exceeds expectations."'}),o.jsx("div",{className:"text-xs text-muted-foreground mt-2",children:"Reviewed by: Sarah Johnson • September 15, 2025"})]}),o.jsxs("div",{className:"p-3 border rounded-lg",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h3",{className:"font-medium",children:"Q2 2025 Performance Review"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(_i,{variant:"default",children:"4.7/5"}),o.jsxs(kt,{variant:"outline",size:"sm",children:[o.jsx($p,{className:"w-4 h-4 mr-2"}),"View"]})]})]}),o.jsx("p",{className:"text-sm text-muted-foreground",children:'"Strong technical skills and problem-solving abilities. Good progress in leadership development."'}),o.jsx("div",{className:"text-xs text-muted-foreground mt-2",children:"Reviewed by: Mike Chen • June 20, 2025"})]})]})]})]})})]}),xr&&o.jsxs(ni,{className:"hover:shadow-md transition-shadow",children:[o.jsx(Ns,{children:o.jsxs(us,{className:"flex items-center gap-2",children:[o.jsx(f6,{className:"w-5 h-5 text-blue-600"}),"Account Management"]})}),o.jsx(qi,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"flex justify-between items-center",children:o.jsxs(ds,{children:[o.jsx(kf,{asChild:!0,children:o.jsxs(kt,{className:"gap-2",children:[o.jsx(f6,{className:"w-4 h-4"}),"Create Account"]})}),o.jsxs(gs,{className:"max-w-md",children:[o.jsx(ys,{children:o.jsx(vs,{children:"Create New Account"})}),o.jsxs("div",{className:"grid gap-4 py-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"newAccountFirstName",children:"First Name"}),o.jsx(On,{id:"newAccountFirstName",name:"first_name",placeholder:"John",value:Ys.first_name,onChange:$a})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"newAccountLastName",children:"Last Name"}),o.jsx(On,{id:"newAccountLastName",name:"last_name",placeholder:"Doe",value:Ys.last_name,onChange:$a})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"newAccountEmail",children:"Email"}),o.jsx(On,{id:"newAccountEmail",name:"email",type:"email",placeholder:"john.doe@company.com",value:Ys.email,onChange:$a})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"newAccountPassword",children:"Password"}),o.jsx(On,{id:"newAccountPassword",name:"password",type:"password",placeholder:"Enter password",value:Ys.password,onChange:$a})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"newAccountRole",children:"Role"}),o.jsxs(Fs,{name:"roles",value:Ys.roles,onValueChange:je=>$a({target:{name:"roles",value:je}}),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select role"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Employee",children:"Employee"}),o.jsx(Gn,{value:"HR2 Admin",children:"HR2 Admin"}),o.jsx(Gn,{value:"Trainer",children:"Trainer"})]})]})]})]}),o.jsx(Co,{children:o.jsx(kt,{onClick:gl,disabled:St,children:St?"Creating...":"Create Account"})})]})]})}),o.jsx("div",{className:"border rounded-lg",children:o.jsxs(Pc,{children:[o.jsx(Mc,{children:o.jsxs(zi,{children:[o.jsx(vr,{children:"Name"}),o.jsx(vr,{children:"Email"}),o.jsx(vr,{children:"Role"}),o.jsx(vr,{children:"Actions"})]})}),o.jsx(Rc,{children:mr.length>0?mr.map(je=>{ze.find(gr=>gr.email===je.email||String(gr.id)===String(je.id));let ot="";const vn=[je.first_name,je.last_name].filter(Boolean);if(vn.length>0&&(ot=vn.join(" ")),!ot){const gr=ze.find(Zn=>Zn.email===je.email||String(Zn.id)===String(je.id));if(gr){const Zn=[gr.first_name,gr.last_name].filter(Boolean);Zn.length>0&&(ot=Zn.join(" "))}}ot||(ot=je.name||"Unknown User");const Sr=br&&Qr&&Qr.id===je.id;return o.jsxs(zi,{children:[o.jsx(qn,{className:"font-medium",children:ot}),o.jsx(qn,{children:je.email}),o.jsx(qn,{children:o.jsx(_i,{variant:"outline",children:je.role||"Employee"})}),o.jsx(qn,{children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>Ql(je),children:o.jsx(Y1,{className:"w-4 h-4"})}),Sr&&o.jsx(ds,{open:!0,onOpenChange:pr,children:o.jsxs(gs,{className:"max-w-md",children:[o.jsx(ys,{children:o.jsx(vs,{children:"Edit Account"})}),o.jsxs("div",{className:"grid gap-4 py-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"editAccountFirstName",children:"First Name"}),o.jsx(On,{id:"editAccountFirstName",name:"first_name",value:Rt.first_name,onChange:rl})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"editAccountLastName",children:"Last Name"}),o.jsx(On,{id:"editAccountLastName",name:"last_name",value:Rt.last_name,onChange:rl})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"editAccountEmail",children:"Email"}),o.jsx(On,{id:"editAccountEmail",name:"email",type:"email",value:Rt.email,onChange:rl})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"editAccountRole",children:"Role"}),o.jsxs(Fs,{name:"role",value:Rt.role,onValueChange:gr=>rl({target:{name:"role",value:gr}}),children:[o.jsx(Us,{children:o.jsx(Bs,{})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Employee",children:"Employee"}),o.jsx(Gn,{value:"HR2 Admin",children:"HR2 Admin"}),o.jsx(Gn,{value:"Trainer",children:"Trainer"})]})]})]})]}),o.jsx(Co,{children:o.jsx(kt,{onClick:()=>qh(je.id),disabled:St,children:St?"Saving...":"Save Changes"})})]})}),o.jsx(kt,{variant:"destructive",size:"sm",onClick:()=>Kd(je.id),children:o.jsx(qA,{className:"w-4 h-4"})})]})})]},je.id)}):o.jsx(zi,{children:o.jsx(qn,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No user accounts found"})})})]})})]})})]})]}),o.jsx(ds,{open:ai,onOpenChange:ws,children:o.jsxs(gs,{children:[o.jsx(ys,{children:o.jsx(vs,{children:"Manage Leave Request"})}),fr&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[o.jsx("h4",{className:"font-medium mb-2",children:"Request Details"}),o.jsxs("div",{className:"space-y-1 text-sm",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Employee:"})," ",fr.employee?.first_name," ",fr.employee?.last_name]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Type:"})," ",fr.type]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Duration:"})," ",new Date(fr.start).toLocaleDateString()," - ",new Date(fr.end).toLocaleDateString()]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Reason:"})," ",fr.reason||"Not provided"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Status:"})," ",o.jsx(_i,{variant:"secondary",children:fr.status})]})]})]}),o.jsxs("div",{className:"grid gap-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"manageAction",children:"Action"}),o.jsxs(Fs,{value:wr.status,onValueChange:je=>Fi(ot=>({...ot,status:je})),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select action"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Accepted",children:"Accept Request"}),o.jsx(Gn,{value:"Denied",children:"Deny Request"})]})]})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"adminNotes",children:"Admin Notes (Optional)"}),o.jsx("textarea",{id:"adminNotes",placeholder:"Add any notes or comments about this decision",value:wr.admin_notes,onChange:je=>Fi(ot=>({...ot,admin_notes:je.target.value})),className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]})]})]}),o.jsxs(Co,{children:[o.jsx(kt,{variant:"outline",onClick:()=>ws(!1),children:"Cancel"}),o.jsx(kt,{onClick:mt,disabled:!wr.status,children:wr.status==="Accepted"?"Accept Request":wr.status==="Denied"?"Deny Request":"Update Request"})]})]})}),o.jsx(ds,{open:rs,onOpenChange:Js,children:o.jsxs(gs,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[o.jsx(ys,{children:o.jsx(vs,{children:"Manage All Leave Requests"})}),o.jsx("div",{className:"space-y-4",children:Array.isArray(qr)&&qr.filter(je=>je.status==="Pending").length>0?o.jsx("div",{className:"space-y-4",children:qr.filter(je=>je.status==="Pending").map(je=>o.jsx("div",{className:"p-4 border rounded-lg bg-muted/20",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1 space-y-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"font-medium",children:[je.employee?.first_name," ",je.employee?.last_name]}),o.jsx(_i,{variant:"outline",children:je.type}),o.jsx(_i,{variant:"secondary",children:je.status})]}),o.jsxs("div",{className:"text-sm text-muted-foreground",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Department:"})," ",je.employee?.department||"Not specified"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Email:"})," ",je.employee?.email]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Duration:"})," ",new Date(je.start).toLocaleDateString()," - ",new Date(je.end).toLocaleDateString()]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Reason:"})," ",je.reason||"Not provided"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Submitted:"})," ",new Date(je.created_at).toLocaleDateString()]})]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(kt,{size:"sm",onClick:()=>{di(je),Fi({status:"Accepted",admin_notes:""}),Js(!1),ws(!0)},className:"bg-green-600 hover:bg-green-700 text-white",children:"Accept"}),o.jsx(kt,{size:"sm",variant:"destructive",onClick:()=>{di(je),Fi({status:"Denied",admin_notes:""}),Js(!1),ws(!0)},children:"Deny"}),o.jsx(kt,{size:"sm",variant:"outline",onClick:()=>{di(je),Fi({status:"",admin_notes:""}),Js(!1),ws(!0)},children:"Review"})]})]})},je.id))}):o.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No pending leave requests to manage"})}),o.jsx(Co,{children:o.jsx(kt,{variant:"outline",onClick:()=>Js(!1),children:"Close"})})]})}),o.jsx(ds,{open:Ks,onOpenChange:ca,children:o.jsxs(gs,{children:[o.jsx(ys,{children:o.jsx(vs,{children:"Manage Timesheet Adjustment Request"})}),fr&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[o.jsx("h4",{className:"font-medium mb-2",children:"Request Details"}),o.jsxs("div",{className:"space-y-1 text-sm",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Employee:"})," ",fr.employee?.first_name," ",fr.employee?.last_name]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Date:"})," ",new Date(fr.date).toLocaleDateString()]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Requested Time:"})," ",Ot(fr.new_time_in||fr.newTimeIn)," - ",Ot(fr.new_time_out||fr.newTimeOut)]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Reason:"})," ",fr.reason||"Not provided"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Status:"})," ",o.jsx(_i,{variant:"secondary",children:fr.status})]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Submitted:"})," ",new Date(fr.submitted_at).toLocaleDateString()]})]})]}),o.jsxs("div",{className:"grid gap-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"manageTimesheetAction",children:"Action"}),o.jsxs(Fs,{value:wr.status,onValueChange:je=>Fi(ot=>({...ot,status:je})),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select action"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Approved",children:"Approve Request"}),o.jsx(Gn,{value:"Rejected",children:"Reject Request"})]})]})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"manageTimesheetNotes",children:"Admin Notes (Optional)"}),o.jsx("textarea",{id:"manageTimesheetNotes",placeholder:"Add any notes or comments...",value:wr.admin_notes,onChange:je=>Fi(ot=>({...ot,admin_notes:je.target.value})),className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]})]}),o.jsxs(Co,{children:[o.jsx(kt,{variant:"outline",onClick:()=>ca(!1),children:"Cancel"}),o.jsx(kt,{onClick:pt,disabled:!wr.status,children:wr.status==="Approved"?"Approve":wr.status==="Rejected"?"Reject":"Submit"})]})]})]})}),o.jsx(ds,{open:$,onOpenChange:B,children:o.jsxs(gs,{children:[o.jsx(ys,{children:o.jsx(vs,{children:"Manage Reimbursement Request"})}),fr&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[o.jsx("h4",{className:"font-medium mb-2",children:"Request Details"}),o.jsxs("div",{className:"space-y-1 text-sm",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Employee:"})," ",fr.employee?.first_name," ",fr.employee?.last_name]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Type:"})," ",fr.type]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Amount:"})," ₱",parseFloat(fr.amount).toFixed(2)]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Date:"})," ",new Date(fr.date).toLocaleDateString()]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Description:"})," ",fr.description||"Not provided"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Status:"})," ",o.jsx(_i,{variant:"secondary",children:fr.status})]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Submitted:"})," ",new Date(fr.submitted_at).toLocaleDateString()]}),fr.receipt_path&&o.jsx("div",{className:"mt-2",children:o.jsxs(kt,{variant:"outline",size:"sm",onClick:()=>zr(fr),className:"text-green-600 hover:text-green-700 hover:bg-green-50 gap-2",children:[o.jsx($A,{className:"w-4 h-4"}),"View Receipt"]})})]})]}),o.jsxs("div",{className:"grid gap-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"manageReimbursementAction",children:"Action"}),o.jsxs(Fs,{value:wr.status,onValueChange:je=>Fi(ot=>({...ot,status:je})),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select action"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Approved",children:"Approve Request"}),o.jsx(Gn,{value:"Rejected",children:"Reject Request"})]})]})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(bt,{htmlFor:"manageReimbursementNotes",children:"Admin Notes (Optional)"}),o.jsx("textarea",{id:"manageReimbursementNotes",placeholder:"Add any notes or comments...",value:wr.admin_notes,onChange:je=>Fi(ot=>({...ot,admin_notes:je.target.value})),className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]})]}),o.jsxs(Co,{children:[o.jsx(kt,{variant:"outline",onClick:()=>B(!1),children:"Cancel"}),o.jsx(kt,{onClick:nr,disabled:!wr.status,children:wr.status==="Approved"?"Approve":wr.status==="Rejected"?"Reject":"Submit"})]})]})]})}),o.jsx(ds,{open:Na,onOpenChange:Ia,children:o.jsxs(gs,{className:"w-[95vw] max-w-none max-h-[80vh] overflow-y-auto",style:{width:"95vw",maxWidth:"none"},children:[o.jsx(ys,{children:o.jsx(vs,{children:"Leave Request History"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{className:"text-sm text-muted-foreground",children:["Total Records: ",Ve.length]}),o.jsxs(kt,{onClick:()=>ad(Ve,"leave_request_history"),variant:"outline",size:"sm",className:"gap-2",children:[o.jsx($p,{className:"w-4 h-4"}),"Export CSV"]})]}),o.jsx("div",{className:"border rounded-lg overflow-x-auto",children:o.jsxs(Pc,{className:"min-w-full",children:[o.jsx(Mc,{children:o.jsxs(zi,{children:[o.jsx(vr,{className:"min-w-[120px]",children:"Employee"}),o.jsx(vr,{className:"min-w-[100px]",children:"Leave Type"}),o.jsx(vr,{className:"min-w-[100px]",children:"Start Date"}),o.jsx(vr,{className:"min-w-[100px]",children:"End Date"}),o.jsx(vr,{className:"min-w-[80px]",children:"Status"}),o.jsx(vr,{className:"min-w-[150px]",children:"Reason"}),o.jsx(vr,{className:"min-w-[150px]",children:"Admin Notes"}),o.jsx(vr,{className:"min-w-[120px]",children:"Processed Date"})]})}),o.jsx(Rc,{children:Ve.length===0?o.jsx(zi,{children:o.jsx(qn,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No history records found"})}):Ve.map((je,ot)=>o.jsxs(zi,{children:[o.jsx(qn,{children:je.employee_name||"N/A"}),o.jsx(qn,{children:je.type}),o.jsx(qn,{children:nl(je.start)}),o.jsx(qn,{children:nl(je.end)}),o.jsx(qn,{children:o.jsx(_i,{variant:je.status==="Approved"?"default":"destructive",children:je.status})}),o.jsx(qn,{children:je.reason}),o.jsx(qn,{children:je.admin_notes||"N/A"}),o.jsx(qn,{children:nl(je.processed_at||je.updated_at)})]},ot))})]})})]})]})}),o.jsx(ds,{open:id,onOpenChange:Ua,children:o.jsxs(gs,{className:"w-[95vw] max-w-none max-h-[80vh] overflow-y-auto",style:{width:"95vw",maxWidth:"none"},children:[o.jsx(ys,{children:o.jsx(vs,{children:"Timesheet Adjustment History"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{className:"text-sm text-muted-foreground",children:["Total Records: ",$e.length]}),o.jsxs(kt,{onClick:()=>ad($e,"timesheet_adjustment_history"),variant:"outline",size:"sm",className:"gap-2",children:[o.jsx($p,{className:"w-4 h-4"}),"Export CSV"]})]}),o.jsx("div",{className:"border rounded-lg overflow-x-auto",children:o.jsxs(Pc,{className:"min-w-full",children:[o.jsx(Mc,{children:o.jsxs(zi,{children:[o.jsx(vr,{className:"min-w-[120px]",children:"Employee"}),o.jsx(vr,{className:"min-w-[100px]",children:"Date"}),o.jsx(vr,{className:"min-w-[120px]",children:"Requested Time In"}),o.jsx(vr,{className:"min-w-[120px]",children:"Requested Time Out"}),o.jsx(vr,{className:"min-w-[80px]",children:"Status"}),o.jsx(vr,{className:"min-w-[150px]",children:"Reason"}),o.jsx(vr,{className:"min-w-[150px]",children:"Admin Notes"}),o.jsx(vr,{className:"min-w-[120px]",children:"Processed Date"})]})}),o.jsx(Rc,{children:$e.length===0?o.jsx(zi,{children:o.jsx(qn,{colSpan:10,className:"text-center py-8 text-muted-foreground",children:"No history records found"})}):$e.map((je,ot)=>o.jsxs(zi,{children:[o.jsx(qn,{children:je.employee_name||"N/A"}),o.jsx(qn,{children:nl(je.date)}),o.jsx(qn,{children:Ot(je.newTimeIn||je.new_time_in)}),o.jsx(qn,{children:Ot(je.newTimeOut||je.new_time_out)}),o.jsx(qn,{children:o.jsx(_i,{variant:je.status==="Approved"?"default":"destructive",children:je.status})}),o.jsx(qn,{children:je.reason}),o.jsx(qn,{children:je.admin_notes||"N/A"}),o.jsx(qn,{children:nl(je.processed_at||je.updated_at)})]},ot))})]})})]})]})}),o.jsx(ds,{open:F,onOpenChange:K,children:o.jsxs(gs,{className:"w-[95vw] max-w-none max-h-[80vh] overflow-y-auto",style:{width:"95vw",maxWidth:"none"},children:[o.jsx(ys,{children:o.jsx(vs,{children:"Reimbursement History"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{className:"text-sm text-muted-foreground",children:["Total Records: ",w.length]}),o.jsxs(kt,{onClick:()=>ad(w,"reimbursement_history"),variant:"outline",size:"sm",className:"gap-2",children:[o.jsx($p,{className:"w-4 h-4"}),"Export CSV"]})]}),o.jsx("div",{className:"border rounded-lg overflow-x-auto",children:o.jsxs(Pc,{className:"min-w-full",children:[o.jsx(Mc,{children:o.jsxs(zi,{children:[o.jsx(vr,{className:"min-w-[120px]",children:"Employee"}),o.jsx(vr,{className:"min-w-[100px]",children:"Expense Type"}),o.jsx(vr,{className:"min-w-[80px]",children:"Amount"}),o.jsx(vr,{className:"min-w-[100px]",children:"Date"}),o.jsx(vr,{className:"min-w-[80px]",children:"Status"}),o.jsx(vr,{className:"min-w-[150px]",children:"Description"}),o.jsx(vr,{className:"min-w-[150px]",children:"Admin Notes"}),o.jsx(vr,{className:"min-w-[120px]",children:"Processed Date"}),o.jsx(vr,{className:"min-w-[80px]",children:"Receipt"})]})}),o.jsx(Rc,{children:w.length===0?o.jsx(zi,{children:o.jsx(qn,{colSpan:9,className:"text-center py-8 text-muted-foreground",children:"No history records found"})}):w.map((je,ot)=>o.jsxs(zi,{children:[o.jsx(qn,{children:je.employee_name||"N/A"}),o.jsx(qn,{children:je.type}),o.jsxs(qn,{children:["₱",parseFloat(je.amount).toFixed(2)]}),o.jsx(qn,{children:nl(je.date)}),o.jsx(qn,{children:o.jsx(_i,{variant:je.status==="Approved"?"default":"destructive",children:je.status})}),o.jsx(qn,{children:je.description}),o.jsx(qn,{children:je.admin_notes||"N/A"}),o.jsx(qn,{children:nl(je.processed_at||je.updated_at)}),o.jsx(qn,{children:je.receipt_path&&o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>zr(je),className:"text-green-600 hover:text-green-700 hover:bg-green-50",title:"View Receipt",children:o.jsx(wx,{className:"w-4 h-4"})})})]},ot))})]})})]})]})}),o.jsx(ds,{open:Y,onOpenChange:X,children:o.jsxs(gs,{className:"w-screen max-w-4xl max-h-[80vh] overflow-y-auto",children:[o.jsx(ys,{children:o.jsx(vs,{children:"View Receipt"})}),o.jsx("div",{className:"space-y-4",children:ae&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Expense Type:"})," ",ae.type]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Amount:"})," ₱",parseFloat(ae.amount).toFixed(2)]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Date:"})," ",nl(ae.date)]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Status:"}),o.jsx(_i,{variant:ae.status==="Approved"?"default":ae.status==="Rejected"?"destructive":"secondary",className:"ml-2",children:ae.status})]})]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Description:"})," ",ae.description]}),o.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[o.jsx("h4",{className:"font-medium mb-2",children:"Receipt File"}),ae.receipt_path?o.jsx("div",{className:"space-y-2",children:ae.receipt_path.toLowerCase().endsWith(".pdf")?o.jsxs("div",{className:"text-center",children:[o.jsx(wx,{className:"w-16 h-16 mx-auto text-red-500 mb-2"}),o.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"PDF Document"}),o.jsxs(kt,{variant:"outline",onClick:()=>{const je=[`${Ar.backendBase}/storage/${ae.receipt_path}`,`http://127.0.0.1:8092/storage/${ae.receipt_path}`,`http://localhost:8092/storage/${ae.receipt_path}`];for(const ot of je)try{window.open(ot,"_blank");break}catch(vn){console.error("Failed to open:",ot,vn)}},className:"gap-2",children:[o.jsx($p,{className:"w-4 h-4"}),"Download PDF"]})]}):o.jsxs("div",{className:"text-center",children:[o.jsx("img",{src:`${Ar.backendBase}/storage/${ae.receipt_path}`,alt:"Receipt",className:"max-w-full max-h-96 mx-auto rounded-lg shadow-md",onError:je=>{console.error("Primary URL failed:",je.target.src);const ot=[`${Ar.backendBase}/storage/app/public/reimbursements/${ae.receipt_path}`,`http://127.0.0.1:8092/storage/${ae.receipt_path}`,`http://localhost:8092/storage/${ae.receipt_path}`];let vn=0;(()=>{vn<ot.length?(je.target.src=ot[vn],console.log("Trying alternative URL:",ot[vn]),vn++):(console.error("All URLs failed"),je.target.style.display="none",je.target.nextSibling.style.display="block")})()},onLoad:()=>console.log("Image loaded successfully")}),o.jsxs("div",{style:{display:"none"},className:"text-center py-8",children:[o.jsx(wx,{className:"w-16 h-16 mx-auto text-gray-400 mb-2"}),o.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Unable to preview image"}),o.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["File: ",ae.receipt_path]}),o.jsxs(kt,{variant:"outline",onClick:()=>{const je=[`${Ar.backendBase}/storage/${ae.receipt_path}`,`http://127.0.0.1:8092/storage/${ae.receipt_path}`,`http://localhost:8092/storage/${ae.receipt_path}`];for(const ot of je)try{window.open(ot,"_blank");break}catch(vn){console.error("Failed to open:",ot,vn)}},className:"gap-2 mt-2",children:[o.jsx($p,{className:"w-4 h-4"}),"Download File"]})]})]})}):o.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[o.jsx(wx,{className:"w-16 h-16 mx-auto mb-2"}),"No receipt file available"]})]})]})})]})}),o.jsx(KS,{position:"bottom-right"})]})}const qFe={light:"",dark:".dark"},Mne=z.createContext(null);function HFe(){const e=z.useContext(Mne);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}function GFe({id:e,className:t,children:n,config:r,...c}){const f=z.useId(),p=`chart-${e||f.replace(/:/g,"")}`;return o.jsx(Mne.Provider,{value:{config:r},children:o.jsxs("div",{"data-slot":"chart","data-chart":p,className:Rn("[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",t),...c,children:[o.jsx(WFe,{id:p,config:r}),o.jsx(Fz,{children:n})]})})}const WFe=({id:e,config:t})=>{const n=Object.entries(t).filter(([,r])=>r.theme||r.color);return n.length?o.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(qFe).map(([r,c])=>`
${c} [data-chart=${e}] {
${n.map(([f,p])=>{const s=p.theme?.[r]||p.color;return s?`  --color-${f}: ${s};`:null}).join(`
`)}
}
`).join(`
`)}}):null},XFe=Dh;function ZFe({active:e,payload:t,className:n,indicator:r="dot",hideLabel:c=!1,hideIndicator:f=!1,label:p,labelFormatter:s,labelClassName:w,formatter:T,color:E,nameKey:N,labelKey:D}){const{config:V}=HFe(),$=z.useMemo(()=>{if(c||!t?.length)return null;const[F]=t,K=`${D||F?.dataKey||F?.name||"value"}`,Y=w9(V,F,K),X=!D&&typeof p=="string"?V[p]?.label||p:Y?.label;return s?o.jsx("div",{className:Rn("font-medium",w),children:s(X,t)}):X?o.jsx("div",{className:Rn("font-medium",w),children:X}):null},[p,s,t,c,w,V,D]);if(!e||!t?.length)return null;const B=t.length===1&&r!=="dot";return o.jsxs("div",{className:Rn("border-border/50 bg-background grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl",n),children:[B?null:$,o.jsx("div",{className:"grid gap-1.5",children:t.filter(F=>F.type!=="none").map((F,K)=>{const Y=`${N||F.name||F.dataKey||"value"}`,X=w9(V,F,Y),ae=E||F.payload.fill||F.color;return o.jsx("div",{className:Rn("[&>svg]:text-muted-foreground flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5",r==="dot"&&"items-center"),children:T&&F?.value!==void 0&&F.name?T(F.value,F.name,F,K,F.payload):o.jsxs(o.Fragment,{children:[X?.icon?o.jsx(X.icon,{}):!f&&o.jsx("div",{className:Rn("shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)",{"h-2.5 w-2.5":r==="dot","w-1":r==="line","w-0 border-[1.5px] border-dashed bg-transparent":r==="dashed","my-0.5":B&&r==="dashed"}),style:{"--color-bg":ae,"--color-border":ae}}),o.jsxs("div",{className:Rn("flex flex-1 justify-between leading-none",B?"items-end":"items-center"),children:[o.jsxs("div",{className:"grid gap-1.5",children:[B?$:null,o.jsx("span",{className:"text-muted-foreground",children:X?.label||F.name})]}),F.value&&o.jsx("span",{className:"text-foreground font-mono font-medium tabular-nums",children:F.value.toLocaleString()})]})]})},F.dataKey)})})]})}function w9(e,t,n){if(typeof t!="object"||t===null)return;const r="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let c=n;return n in t&&typeof t[n]=="string"?c=t[n]:r&&n in r&&typeof r[n]=="string"&&(c=r[n]),c in e?e[c]:e[n]}const YFe={total:{label:"Reservations",color:"hsl(var(--chart-1))"}};function KFe({data:e}){return o.jsx(GFe,{config:YFe,className:"w-full h-full",children:o.jsxs(eze,{accessibilityLayer:!0,data:e,margin:{left:0,right:0},children:[o.jsx(bF,{vertical:!1}),o.jsx(Zb,{dataKey:"day",tickLine:!1,axisLine:!1,tickMargin:100,tickFormatter:t=>new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),o.jsx(XFe,{cursor:!1,content:o.jsx(ZFe,{})}),o.jsx("defs",{children:o.jsxs("linearGradient",{id:"fillTotal",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"5%",stopColor:"var(--vivid-neon-pink)",stopOpacity:.8}),o.jsx("stop",{offset:"95%",stopColor:"var(--vivid-indigo)",stopOpacity:.1})]})}),o.jsx(vv,{dataKey:"total",type:"natural",fill:"url(#fillTotal)",fillOpacity:.4,stroke:"var(--vivid-neon-pink)"})]})})}var ck={exports:{}};/*!
 * Pusher JavaScript Library v8.4.0
 * https://pusher.com/
 *
 * Copyright 2020, Pusher
 * Released under the MIT licence.
 */var S9;function JFe(){return S9||(S9=1,(function(e,t){(function(r,c){e.exports=c()})(window,function(){return(function(n){var r={};function c(f){if(r[f])return r[f].exports;var p=r[f]={i:f,l:!1,exports:{}};return n[f].call(p.exports,p,p.exports,c),p.l=!0,p.exports}return c.m=n,c.c=r,c.d=function(f,p,s){c.o(f,p)||Object.defineProperty(f,p,{enumerable:!0,get:s})},c.r=function(f){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(f,"__esModule",{value:!0})},c.t=function(f,p){if(p&1&&(f=c(f)),p&8||p&4&&typeof f=="object"&&f&&f.__esModule)return f;var s=Object.create(null);if(c.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:f}),p&2&&typeof f!="string")for(var w in f)c.d(s,w,(function(T){return f[T]}).bind(null,w));return s},c.n=function(f){var p=f&&f.__esModule?function(){return f.default}:function(){return f};return c.d(p,"a",p),p},c.o=function(f,p){return Object.prototype.hasOwnProperty.call(f,p)},c.p="",c(c.s=2)})([(function(n,r,c){var f=this&&this.__extends||(function(){var B=function(F,K){return B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Y,X){Y.__proto__=X}||function(Y,X){for(var ae in X)X.hasOwnProperty(ae)&&(Y[ae]=X[ae])},B(F,K)};return function(F,K){B(F,K);function Y(){this.constructor=F}F.prototype=K===null?Object.create(K):(Y.prototype=K.prototype,new Y)}})();Object.defineProperty(r,"__esModule",{value:!0});var p=256,s=(function(){function B(F){F===void 0&&(F="="),this._paddingCharacter=F}return B.prototype.encodedLength=function(F){return this._paddingCharacter?(F+2)/3*4|0:(F*8+5)/6|0},B.prototype.encode=function(F){for(var K="",Y=0;Y<F.length-2;Y+=3){var X=F[Y]<<16|F[Y+1]<<8|F[Y+2];K+=this._encodeByte(X>>>18&63),K+=this._encodeByte(X>>>12&63),K+=this._encodeByte(X>>>6&63),K+=this._encodeByte(X>>>0&63)}var ae=F.length-Y;if(ae>0){var X=F[Y]<<16|(ae===2?F[Y+1]<<8:0);K+=this._encodeByte(X>>>18&63),K+=this._encodeByte(X>>>12&63),ae===2?K+=this._encodeByte(X>>>6&63):K+=this._paddingCharacter||"",K+=this._paddingCharacter||""}return K},B.prototype.maxDecodedLength=function(F){return this._paddingCharacter?F/4*3|0:(F*6+7)/8|0},B.prototype.decodedLength=function(F){return this.maxDecodedLength(F.length-this._getPaddingLength(F))},B.prototype.decode=function(F){if(F.length===0)return new Uint8Array(0);for(var K=this._getPaddingLength(F),Y=F.length-K,X=new Uint8Array(this.maxDecodedLength(Y)),ae=0,Z=0,se=0,he=0,ye=0,Ce=0,Ve=0;Z<Y-4;Z+=4)he=this._decodeChar(F.charCodeAt(Z+0)),ye=this._decodeChar(F.charCodeAt(Z+1)),Ce=this._decodeChar(F.charCodeAt(Z+2)),Ve=this._decodeChar(F.charCodeAt(Z+3)),X[ae++]=he<<2|ye>>>4,X[ae++]=ye<<4|Ce>>>2,X[ae++]=Ce<<6|Ve,se|=he&p,se|=ye&p,se|=Ce&p,se|=Ve&p;if(Z<Y-1&&(he=this._decodeChar(F.charCodeAt(Z)),ye=this._decodeChar(F.charCodeAt(Z+1)),X[ae++]=he<<2|ye>>>4,se|=he&p,se|=ye&p),Z<Y-2&&(Ce=this._decodeChar(F.charCodeAt(Z+2)),X[ae++]=ye<<4|Ce>>>2,se|=Ce&p),Z<Y-3&&(Ve=this._decodeChar(F.charCodeAt(Z+3)),X[ae++]=Ce<<6|Ve,se|=Ve&p),se!==0)throw new Error("Base64Coder: incorrect characters for decoding");return X},B.prototype._encodeByte=function(F){var K=F;return K+=65,K+=25-F>>>8&6,K+=51-F>>>8&-75,K+=61-F>>>8&-15,K+=62-F>>>8&3,String.fromCharCode(K)},B.prototype._decodeChar=function(F){var K=p;return K+=(42-F&F-44)>>>8&-p+F-43+62,K+=(46-F&F-48)>>>8&-p+F-47+63,K+=(47-F&F-58)>>>8&-p+F-48+52,K+=(64-F&F-91)>>>8&-p+F-65+0,K+=(96-F&F-123)>>>8&-p+F-97+26,K},B.prototype._getPaddingLength=function(F){var K=0;if(this._paddingCharacter){for(var Y=F.length-1;Y>=0&&F[Y]===this._paddingCharacter;Y--)K++;if(F.length<4||K>2)throw new Error("Base64Coder: incorrect padding")}return K},B})();r.Coder=s;var w=new s;function T(B){return w.encode(B)}r.encode=T;function E(B){return w.decode(B)}r.decode=E;var N=(function(B){f(F,B);function F(){return B!==null&&B.apply(this,arguments)||this}return F.prototype._encodeByte=function(K){var Y=K;return Y+=65,Y+=25-K>>>8&6,Y+=51-K>>>8&-75,Y+=61-K>>>8&-13,Y+=62-K>>>8&49,String.fromCharCode(Y)},F.prototype._decodeChar=function(K){var Y=p;return Y+=(44-K&K-46)>>>8&-p+K-45+62,Y+=(94-K&K-96)>>>8&-p+K-95+63,Y+=(47-K&K-58)>>>8&-p+K-48+52,Y+=(64-K&K-91)>>>8&-p+K-65+0,Y+=(96-K&K-123)>>>8&-p+K-97+26,Y},F})(s);r.URLSafeCoder=N;var D=new N;function V(B){return D.encode(B)}r.encodeURLSafe=V;function $(B){return D.decode(B)}r.decodeURLSafe=$,r.encodedLength=function(B){return w.encodedLength(B)},r.maxDecodedLength=function(B){return w.maxDecodedLength(B)},r.decodedLength=function(B){return w.decodedLength(B)}}),(function(n,r,c){Object.defineProperty(r,"__esModule",{value:!0});var f="utf8: invalid string",p="utf8: invalid source encoding";function s(E){for(var N=new Uint8Array(w(E)),D=0,V=0;V<E.length;V++){var $=E.charCodeAt(V);$<128?N[D++]=$:$<2048?(N[D++]=192|$>>6,N[D++]=128|$&63):$<55296?(N[D++]=224|$>>12,N[D++]=128|$>>6&63,N[D++]=128|$&63):(V++,$=($&1023)<<10,$|=E.charCodeAt(V)&1023,$+=65536,N[D++]=240|$>>18,N[D++]=128|$>>12&63,N[D++]=128|$>>6&63,N[D++]=128|$&63)}return N}r.encode=s;function w(E){for(var N=0,D=0;D<E.length;D++){var V=E.charCodeAt(D);if(V<128)N+=1;else if(V<2048)N+=2;else if(V<55296)N+=3;else if(V<=57343){if(D>=E.length-1)throw new Error(f);D++,N+=4}else throw new Error(f)}return N}r.encodedLength=w;function T(E){for(var N=[],D=0;D<E.length;D++){var V=E[D];if(V&128){var $=void 0;if(V<224){if(D>=E.length)throw new Error(p);var B=E[++D];if((B&192)!==128)throw new Error(p);V=(V&31)<<6|B&63,$=128}else if(V<240){if(D>=E.length-1)throw new Error(p);var B=E[++D],F=E[++D];if((B&192)!==128||(F&192)!==128)throw new Error(p);V=(V&15)<<12|(B&63)<<6|F&63,$=2048}else if(V<248){if(D>=E.length-2)throw new Error(p);var B=E[++D],F=E[++D],K=E[++D];if((B&192)!==128||(F&192)!==128||(K&192)!==128)throw new Error(p);V=(V&15)<<18|(B&63)<<12|(F&63)<<6|K&63,$=65536}else throw new Error(p);if(V<$||V>=55296&&V<=57343)throw new Error(p);if(V>=65536){if(V>1114111)throw new Error(p);V-=65536,N.push(String.fromCharCode(55296|V>>10)),V=56320|V&1023}}N.push(String.fromCharCode(V))}return N.join("")}r.decode=T}),(function(n,r,c){n.exports=c(3).default}),(function(n,r,c){c.r(r);class f{constructor(oe,xe){this.lastId=0,this.prefix=oe,this.name=xe}create(oe){this.lastId++;var xe=this.lastId,lt=this.prefix+xe,vt=this.name+"["+xe+"]",An=!1,Nr=function(){An||(oe.apply(null,arguments),An=!0)};return this[xe]=Nr,{number:xe,id:lt,name:vt,callback:Nr}}remove(oe){delete this[oe.number]}}var p=new f("_pusher_script_","Pusher.ScriptReceivers"),s={VERSION:"8.4.0",PROTOCOL:7,wsPort:80,wssPort:443,wsPath:"",httpHost:"sockjs.pusher.com",httpPort:80,httpsPort:443,httpPath:"/pusher",stats_host:"stats.pusher.com",authEndpoint:"/pusher/auth",authTransport:"ajax",activityTimeout:12e4,pongTimeout:3e4,unavailableTimeout:1e4,userAuthentication:{endpoint:"/pusher/user-auth",transport:"ajax"},channelAuthorization:{endpoint:"/pusher/auth",transport:"ajax"},cdn_http:"http://js.pusher.com",cdn_https:"https://js.pusher.com",dependency_suffix:""},w=s;class T{constructor(oe){this.options=oe,this.receivers=oe.receivers||p,this.loading={}}load(oe,xe,lt){var vt=this;if(vt.loading[oe]&&vt.loading[oe].length>0)vt.loading[oe].push(lt);else{vt.loading[oe]=[lt];var An=Zn.createScriptRequest(vt.getPath(oe,xe)),Nr=vt.receivers.create(function(Xr){if(vt.receivers.remove(Nr),vt.loading[oe]){var Ti=vt.loading[oe];delete vt.loading[oe];for(var Ms=function(Pa){Pa||An.cleanup()},$s=0;$s<Ti.length;$s++)Ti[$s](Xr,Ms)}});An.send(Nr)}}getRoot(oe){var xe,lt=Zn.getDocument().location.protocol;return oe&&oe.useTLS||lt==="https:"?xe=this.options.cdn_https:xe=this.options.cdn_http,xe.replace(/\/*$/,"")+"/"+this.options.version}getPath(oe,xe){return this.getRoot(xe)+"/"+oe+this.options.suffix+".js"}}var E=new f("_pusher_dependencies","Pusher.DependenciesReceivers"),N=new T({cdn_http:w.cdn_http,cdn_https:w.cdn_https,version:w.VERSION,suffix:w.dependency_suffix,receivers:E});const D={baseUrl:"https://pusher.com",urls:{authenticationEndpoint:{path:"/docs/channels/server_api/authenticating_users"},authorizationEndpoint:{path:"/docs/channels/server_api/authorizing-users/"},javascriptQuickStart:{path:"/docs/javascript_quick_start"},triggeringClientEvents:{path:"/docs/client_api_guide/client_events#trigger-events"},encryptedChannelSupport:{fullUrl:"https://github.com/pusher/pusher-js/tree/cc491015371a4bde5743d1c87a0fbac0feb53195#encrypted-channel-support"}}};var $={buildLogSuffix:function(ve){const oe="See:",xe=D.urls[ve];if(!xe)return"";let lt;return xe.fullUrl?lt=xe.fullUrl:xe.path&&(lt=D.baseUrl+xe.path),lt?`${oe} ${lt}`:""}},B;(function(ve){ve.UserAuthentication="user-authentication",ve.ChannelAuthorization="channel-authorization"})(B||(B={}));class F extends Error{constructor(oe){super(oe),Object.setPrototypeOf(this,new.target.prototype)}}class K extends Error{constructor(oe){super(oe),Object.setPrototypeOf(this,new.target.prototype)}}class Y extends Error{constructor(oe){super(oe),Object.setPrototypeOf(this,new.target.prototype)}}class X extends Error{constructor(oe){super(oe),Object.setPrototypeOf(this,new.target.prototype)}}class ae extends Error{constructor(oe){super(oe),Object.setPrototypeOf(this,new.target.prototype)}}class Z extends Error{constructor(oe){super(oe),Object.setPrototypeOf(this,new.target.prototype)}}class se extends Error{constructor(oe){super(oe),Object.setPrototypeOf(this,new.target.prototype)}}class he extends Error{constructor(oe){super(oe),Object.setPrototypeOf(this,new.target.prototype)}}class ye extends Error{constructor(oe,xe){super(xe),this.status=oe,Object.setPrototypeOf(this,new.target.prototype)}}var Ve=function(ve,oe,xe,lt,vt){const An=Zn.createXHR();An.open("POST",xe.endpoint,!0),An.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var Nr in xe.headers)An.setRequestHeader(Nr,xe.headers[Nr]);if(xe.headersProvider!=null){let Xr=xe.headersProvider();for(var Nr in Xr)An.setRequestHeader(Nr,Xr[Nr])}return An.onreadystatechange=function(){if(An.readyState===4)if(An.status===200){let Xr,Ti=!1;try{Xr=JSON.parse(An.responseText),Ti=!0}catch{vt(new ye(200,`JSON returned from ${lt.toString()} endpoint was invalid, yet status code was 200. Data was: ${An.responseText}`),null)}Ti&&vt(null,Xr)}else{let Xr="";switch(lt){case B.UserAuthentication:Xr=$.buildLogSuffix("authenticationEndpoint");break;case B.ChannelAuthorization:Xr=`Clients must be authorized to join private or presence channels. ${$.buildLogSuffix("authorizationEndpoint")}`;break}vt(new ye(An.status,`Unable to retrieve auth string from ${lt.toString()} endpoint - received status: ${An.status} from ${xe.endpoint}. ${Xr}`),null)}},An.send(oe),An};function Re(ve){return it(rt(ve))}var $e=String.fromCharCode,nt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Me=function(ve){var oe=ve.charCodeAt(0);return oe<128?ve:oe<2048?$e(192|oe>>>6)+$e(128|oe&63):$e(224|oe>>>12&15)+$e(128|oe>>>6&63)+$e(128|oe&63)},rt=function(ve){return ve.replace(/[^\x00-\x7F]/g,Me)},Ee=function(ve){var oe=[0,2,1][ve.length%3],xe=ve.charCodeAt(0)<<16|(ve.length>1?ve.charCodeAt(1):0)<<8|(ve.length>2?ve.charCodeAt(2):0),lt=[nt.charAt(xe>>>18),nt.charAt(xe>>>12&63),oe>=2?"=":nt.charAt(xe>>>6&63),oe>=1?"=":nt.charAt(xe&63)];return lt.join("")},it=window.btoa||function(ve){return ve.replace(/[\s\S]{1,3}/g,Ee)};class et{constructor(oe,xe,lt,vt){this.clear=xe,this.timer=oe(()=>{this.timer&&(this.timer=vt(this.timer))},lt)}isRunning(){return this.timer!==null}ensureAborted(){this.timer&&(this.clear(this.timer),this.timer=null)}}var mt=et;function He(ve){window.clearTimeout(ve)}function pt(ve){window.clearInterval(ve)}class We extends mt{constructor(oe,xe){super(setTimeout,He,oe,function(lt){return xe(),null})}}class Je extends mt{constructor(oe,xe){super(setInterval,pt,oe,function(lt){return xe(),lt})}}var jt={now(){return Date.now?Date.now():new Date().valueOf()},defer(ve){return new We(0,ve)},method(ve,...oe){var xe=Array.prototype.slice.call(arguments,1);return function(lt){return lt[ve].apply(lt,xe.concat(arguments))}}},Pt=jt;function Ot(ve,...oe){for(var xe=0;xe<oe.length;xe++){var lt=oe[xe];for(var vt in lt)lt[vt]&&lt[vt].constructor&&lt[vt].constructor===Object?ve[vt]=Ot(ve[vt]||{},lt[vt]):ve[vt]=lt[vt]}return ve}function Mt(){for(var ve=["Pusher"],oe=0;oe<arguments.length;oe++)typeof arguments[oe]=="string"?ve.push(arguments[oe]):ve.push(Wn(arguments[oe]));return ve.join(" : ")}function an(ve,oe){var xe=Array.prototype.indexOf;if(ve===null)return-1;if(xe&&ve.indexOf===xe)return ve.indexOf(oe);for(var lt=0,vt=ve.length;lt<vt;lt++)if(ve[lt]===oe)return lt;return-1}function Jt(ve,oe){for(var xe in ve)Object.prototype.hasOwnProperty.call(ve,xe)&&oe(ve[xe],xe,ve)}function Cn(ve){var oe=[];return Jt(ve,function(xe,lt){oe.push(lt)}),oe}function nr(ve){var oe=[];return Jt(ve,function(xe){oe.push(xe)}),oe}function sn(ve,oe,xe){for(var lt=0;lt<ve.length;lt++)oe.call(xe||window,ve[lt],lt,ve)}function zr(ve,oe){for(var xe=[],lt=0;lt<ve.length;lt++)xe.push(oe(ve[lt],lt,ve,xe));return xe}function or(ve,oe){var xe={};return Jt(ve,function(lt,vt){xe[vt]=oe(lt)}),xe}function Rr(ve,oe){oe=oe||function(vt){return!!vt};for(var xe=[],lt=0;lt<ve.length;lt++)oe(ve[lt],lt,ve,xe)&&xe.push(ve[lt]);return xe}function qr(ve,oe){var xe={};return Jt(ve,function(lt,vt){(oe&&oe(lt,vt,ve,xe)||lt)&&(xe[vt]=lt)}),xe}function Nn(ve){var oe=[];return Jt(ve,function(xe,lt){oe.push([lt,xe])}),oe}function ci(ve,oe){for(var xe=0;xe<ve.length;xe++)if(oe(ve[xe],xe,ve))return!0;return!1}function ui(ve,oe){for(var xe=0;xe<ve.length;xe++)if(!oe(ve[xe],xe,ve))return!1;return!0}function st(ve){return or(ve,function(oe){return typeof oe=="object"&&(oe=Wn(oe)),encodeURIComponent(Re(oe.toString()))})}function qt(ve){var oe=qr(ve,function(lt){return lt!==void 0}),xe=zr(Nn(st(oe)),Pt.method("join","=")).join("&");return xe}function rn(ve){var oe=[],xe=[];return(function lt(vt,An){var Nr,Xr,Ti;switch(typeof vt){case"object":if(!vt)return null;for(Nr=0;Nr<oe.length;Nr+=1)if(oe[Nr]===vt)return{$ref:xe[Nr]};if(oe.push(vt),xe.push(An),Object.prototype.toString.apply(vt)==="[object Array]")for(Ti=[],Nr=0;Nr<vt.length;Nr+=1)Ti[Nr]=lt(vt[Nr],An+"["+Nr+"]");else{Ti={};for(Xr in vt)Object.prototype.hasOwnProperty.call(vt,Xr)&&(Ti[Xr]=lt(vt[Xr],An+"["+JSON.stringify(Xr)+"]"))}return Ti;case"number":case"string":case"boolean":return vt}})(ve,"$")}function Wn(ve){try{return JSON.stringify(ve)}catch{return JSON.stringify(rn(ve))}}class Vt{constructor(){this.globalLog=oe=>{window.console&&window.console.log&&window.console.log(oe)}}debug(...oe){this.log(this.globalLog,oe)}warn(...oe){this.log(this.globalLogWarn,oe)}error(...oe){this.log(this.globalLogError,oe)}globalLogWarn(oe){window.console&&window.console.warn?window.console.warn(oe):this.globalLog(oe)}globalLogError(oe){window.console&&window.console.error?window.console.error(oe):this.globalLogWarn(oe)}log(oe,...xe){var lt=Mt.apply(this,arguments);Yo.log?Yo.log(lt):Yo.logToConsole&&oe.bind(this)(lt)}}var un=new Vt,hr=function(ve,oe,xe,lt,vt){(xe.headers!==void 0||xe.headersProvider!=null)&&un.warn(`To send headers with the ${lt.toString()} request, you must use AJAX, rather than JSONP.`);var An=ve.nextAuthCallbackID.toString();ve.nextAuthCallbackID++;var Nr=ve.getDocument(),Xr=Nr.createElement("script");ve.auth_callbacks[An]=function($s){vt(null,$s)};var Ti="Pusher.auth_callbacks['"+An+"']";Xr.src=xe.endpoint+"?callback="+encodeURIComponent(Ti)+"&"+oe;var Ms=Nr.getElementsByTagName("head")[0]||Nr.documentElement;Ms.insertBefore(Xr,Ms.firstChild)},$t=hr;class lr{constructor(oe){this.src=oe}send(oe){var xe=this,lt="Error loading "+xe.src;xe.script=document.createElement("script"),xe.script.id=oe.id,xe.script.src=xe.src,xe.script.type="text/javascript",xe.script.charset="UTF-8",xe.script.addEventListener?(xe.script.onerror=function(){oe.callback(lt)},xe.script.onload=function(){oe.callback(null)}):xe.script.onreadystatechange=function(){(xe.script.readyState==="loaded"||xe.script.readyState==="complete")&&oe.callback(null)},xe.script.async===void 0&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(xe.errorScript=document.createElement("script"),xe.errorScript.id=oe.id+"_error",xe.errorScript.text=oe.name+"('"+lt+"');",xe.script.async=xe.errorScript.async=!1):xe.script.async=!0;var vt=document.getElementsByTagName("head")[0];vt.insertBefore(xe.script,vt.firstChild),xe.errorScript&&vt.insertBefore(xe.errorScript,xe.script.nextSibling)}cleanup(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.script=null,this.errorScript=null}}class ze{constructor(oe,xe){this.url=oe,this.data=xe}send(oe){if(!this.request){var xe=qt(this.data),lt=this.url+"/"+oe.number+"?"+xe;this.request=Zn.createScriptRequest(lt),this.request.send(oe)}}cleanup(){this.request&&this.request.cleanup()}}var Fe=function(ve,oe){return function(xe,lt){var vt="http"+(oe?"s":"")+"://",An=vt+(ve.host||ve.options.host)+ve.options.path,Nr=Zn.createJSONPRequest(An,xe),Xr=Zn.ScriptReceivers.create(function(Ti,Ms){p.remove(Xr),Nr.cleanup(),Ms&&Ms.host&&(ve.host=Ms.host),lt&&lt(Ti,Ms)});Nr.send(Xr)}},jn={name:"jsonp",getAgent:Fe},Xn=jn;function mr(ve,oe,xe){var lt=ve+(oe.useTLS?"s":""),vt=oe.useTLS?oe.hostTLS:oe.hostNonTLS;return lt+"://"+vt+xe}function Ur(ve,oe){var xe="/app/"+ve,lt="?protocol="+w.PROTOCOL+"&client=js&version="+w.VERSION+(oe?"&"+oe:"");return xe+lt}var yi={getInitial:function(ve,oe){var xe=(oe.httpPath||"")+Ur(ve,"flash=false");return mr("ws",oe,xe)}},Hi={getInitial:function(ve,oe){var xe=(oe.httpPath||"/pusher")+Ur(ve);return mr("http",oe,xe)}},xr={getInitial:function(ve,oe){return mr("http",oe,oe.httpPath||"/pusher")},getPath:function(ve,oe){return Ur(ve)}};class dr{constructor(){this._callbacks={}}get(oe){return this._callbacks[Ki(oe)]}add(oe,xe,lt){var vt=Ki(oe);this._callbacks[vt]=this._callbacks[vt]||[],this._callbacks[vt].push({fn:xe,context:lt})}remove(oe,xe,lt){if(!oe&&!xe&&!lt){this._callbacks={};return}var vt=oe?[Ki(oe)]:Cn(this._callbacks);xe||lt?this.removeCallback(vt,xe,lt):this.removeAllCallbacks(vt)}removeCallback(oe,xe,lt){sn(oe,function(vt){this._callbacks[vt]=Rr(this._callbacks[vt]||[],function(An){return xe&&xe!==An.fn||lt&&lt!==An.context}),this._callbacks[vt].length===0&&delete this._callbacks[vt]},this)}removeAllCallbacks(oe){sn(oe,function(xe){delete this._callbacks[xe]},this)}}function Ki(ve){return"_"+ve}class Di{constructor(oe){this.callbacks=new dr,this.global_callbacks=[],this.failThrough=oe}bind(oe,xe,lt){return this.callbacks.add(oe,xe,lt),this}bind_global(oe){return this.global_callbacks.push(oe),this}unbind(oe,xe,lt){return this.callbacks.remove(oe,xe,lt),this}unbind_global(oe){return oe?(this.global_callbacks=Rr(this.global_callbacks||[],xe=>xe!==oe),this):(this.global_callbacks=[],this)}unbind_all(){return this.unbind(),this.unbind_global(),this}emit(oe,xe,lt){for(var vt=0;vt<this.global_callbacks.length;vt++)this.global_callbacks[vt](oe,xe);var An=this.callbacks.get(oe),Nr=[];if(lt?Nr.push(xe,lt):xe&&Nr.push(xe),An&&An.length>0)for(var vt=0;vt<An.length;vt++)An[vt].fn.apply(An[vt].context||window,Nr);else this.failThrough&&this.failThrough(oe,xe);return this}}class Ji extends Di{constructor(oe,xe,lt,vt,An){super(),this.initialize=Zn.transportConnectionInitializer,this.hooks=oe,this.name=xe,this.priority=lt,this.key=vt,this.options=An,this.state="new",this.timeline=An.timeline,this.activityTimeout=An.activityTimeout,this.id=this.timeline.generateUniqueID()}handlesActivityChecks(){return!!this.hooks.handlesActivityChecks}supportsPing(){return!!this.hooks.supportsPing}connect(){if(this.socket||this.state!=="initialized")return!1;var oe=this.hooks.urls.getInitial(this.key,this.options);try{this.socket=this.hooks.getSocket(oe,this.options)}catch(xe){return Pt.defer(()=>{this.onError(xe),this.changeState("closed")}),!1}return this.bindListeners(),un.debug("Connecting",{transport:this.name,url:oe}),this.changeState("connecting"),!0}close(){return this.socket?(this.socket.close(),!0):!1}send(oe){return this.state==="open"?(Pt.defer(()=>{this.socket&&this.socket.send(oe)}),!0):!1}ping(){this.state==="open"&&this.supportsPing()&&this.socket.ping()}onOpen(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0}onError(oe){this.emit("error",{type:"WebSocketError",error:oe}),this.timeline.error(this.buildTimelineMessage({error:oe.toString()}))}onClose(oe){oe?this.changeState("closed",{code:oe.code,reason:oe.reason,wasClean:oe.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0}onMessage(oe){this.emit("message",oe)}onActivity(){this.emit("activity")}bindListeners(){this.socket.onopen=()=>{this.onOpen()},this.socket.onerror=oe=>{this.onError(oe)},this.socket.onclose=oe=>{this.onClose(oe)},this.socket.onmessage=oe=>{this.onMessage(oe)},this.supportsPing()&&(this.socket.onactivity=()=>{this.onActivity()})}unbindListeners(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))}changeState(oe,xe){this.state=oe,this.timeline.info(this.buildTimelineMessage({state:oe,params:xe})),this.emit(oe,xe)}buildTimelineMessage(oe){return Ot({cid:this.id},oe)}}class bs{constructor(oe){this.hooks=oe}isSupported(oe){return this.hooks.isSupported(oe)}createConnection(oe,xe,lt,vt){return new Ji(this.hooks,oe,xe,lt,vt)}}var Ys=new bs({urls:yi,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return!!Zn.getWebSocketAPI()},isSupported:function(){return!!Zn.getWebSocketAPI()},getSocket:function(ve){return Zn.createWebSocket(ve)}}),Vr={urls:Hi,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return!0}},Rt=Ot({getSocket:function(ve){return Zn.HTTPFactory.createStreamingSocket(ve)}},Vr),Jr=Ot({getSocket:function(ve){return Zn.HTTPFactory.createPollingSocket(ve)}},Vr),xa={isSupported:function(){return Zn.isXHRSupported()}},ka=new bs(Ot({},Rt,xa)),Dr=new bs(Ot({},Jr,xa)),gt={ws:Ys,xhr_streaming:ka,xhr_polling:Dr},Q=gt,fe=new bs({file:"sockjs",urls:xr,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return window.SockJS!==void 0},getSocket:function(ve,oe){return new window.SockJS(ve,null,{js_path:N.getPath("sockjs",{useTLS:oe.useTLS}),ignore_null_origin:oe.ignoreNullOrigin})},beforeOpen:function(ve,oe){ve.send(JSON.stringify({path:oe}))}}),Te={isSupported:function(ve){var oe=Zn.isXDRSupported(ve.useTLS);return oe}},ke=new bs(Ot({},Rt,Te)),Oe=new bs(Ot({},Jr,Te));Q.xdr_streaming=ke,Q.xdr_polling=Oe,Q.sockjs=fe;var ut=Q;class Et extends Di{constructor(){super();var oe=this;window.addEventListener!==void 0&&(window.addEventListener("online",function(){oe.emit("online")},!1),window.addEventListener("offline",function(){oe.emit("offline")},!1))}isOnline(){return window.navigator.onLine===void 0?!0:window.navigator.onLine}}var ht=new Et;class St{constructor(oe,xe,lt){this.manager=oe,this.transport=xe,this.minPingDelay=lt.minPingDelay,this.maxPingDelay=lt.maxPingDelay,this.pingDelay=void 0}createConnection(oe,xe,lt,vt){vt=Ot({},vt,{activityTimeout:this.pingDelay});var An=this.transport.createConnection(oe,xe,lt,vt),Nr=null,Xr=function(){An.unbind("open",Xr),An.bind("closed",Ti),Nr=Pt.now()},Ti=Ms=>{if(An.unbind("closed",Ti),Ms.code===1002||Ms.code===1003)this.manager.reportDeath();else if(!Ms.wasClean&&Nr){var $s=Pt.now()-Nr;$s<2*this.maxPingDelay&&(this.manager.reportDeath(),this.pingDelay=Math.max($s/2,this.minPingDelay))}};return An.bind("open",Xr),An}isSupported(oe){return this.manager.isAlive()&&this.transport.isSupported(oe)}}const nn={decodeMessage:function(ve){try{var oe=JSON.parse(ve.data),xe=oe.data;if(typeof xe=="string")try{xe=JSON.parse(oe.data)}catch{}var lt={event:oe.event,channel:oe.channel,data:xe};return oe.user_id&&(lt.user_id=oe.user_id),lt}catch(vt){throw{type:"MessageParseError",error:vt,data:ve.data}}},encodeMessage:function(ve){return JSON.stringify(ve)},processHandshake:function(ve){var oe=nn.decodeMessage(ve);if(oe.event==="pusher:connection_established"){if(!oe.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:oe.data.socket_id,activityTimeout:oe.data.activity_timeout*1e3}}else{if(oe.event==="pusher:error")return{action:this.getCloseAction(oe.data),error:this.getCloseError(oe.data)};throw"Invalid handshake"}},getCloseAction:function(ve){return ve.code<4e3?ve.code>=1002&&ve.code<=1004?"backoff":null:ve.code===4e3?"tls_only":ve.code<4100?"refused":ve.code<4200?"backoff":ve.code<4300?"retry":"refused"},getCloseError:function(ve){return ve.code!==1e3&&ve.code!==1001?{type:"PusherError",data:{code:ve.code,message:ve.reason||ve.message}}:null}};var Kt=nn;class ir extends Di{constructor(oe,xe){super(),this.id=oe,this.transport=xe,this.activityTimeout=xe.activityTimeout,this.bindListeners()}handlesActivityChecks(){return this.transport.handlesActivityChecks()}send(oe){return this.transport.send(oe)}send_event(oe,xe,lt){var vt={event:oe,data:xe};return lt&&(vt.channel=lt),un.debug("Event sent",vt),this.send(Kt.encodeMessage(vt))}ping(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})}close(){this.transport.close()}bindListeners(){var oe={message:lt=>{var vt;try{vt=Kt.decodeMessage(lt)}catch(An){this.emit("error",{type:"MessageParseError",error:An,data:lt.data})}if(vt!==void 0){switch(un.debug("Event recd",vt),vt.event){case"pusher:error":this.emit("error",{type:"PusherError",data:vt.data});break;case"pusher:ping":this.emit("ping");break;case"pusher:pong":this.emit("pong");break}this.emit("message",vt)}},activity:()=>{this.emit("activity")},error:lt=>{this.emit("error",lt)},closed:lt=>{xe(),lt&&lt.code&&this.handleCloseEvent(lt),this.transport=null,this.emit("closed")}},xe=()=>{Jt(oe,(lt,vt)=>{this.transport.unbind(vt,lt)})};Jt(oe,(lt,vt)=>{this.transport.bind(vt,lt)})}handleCloseEvent(oe){var xe=Kt.getCloseAction(oe),lt=Kt.getCloseError(oe);lt&&this.emit("error",lt),xe&&this.emit(xe,{action:xe,error:lt})}}class br{constructor(oe,xe){this.transport=oe,this.callback=xe,this.bindListeners()}close(){this.unbindListeners(),this.transport.close()}bindListeners(){this.onMessage=oe=>{this.unbindListeners();var xe;try{xe=Kt.processHandshake(oe)}catch(lt){this.finish("error",{error:lt}),this.transport.close();return}xe.action==="connected"?this.finish("connected",{connection:new ir(xe.id,this.transport),activityTimeout:xe.activityTimeout}):(this.finish(xe.action,{error:xe.error}),this.transport.close())},this.onClosed=oe=>{this.unbindListeners();var xe=Kt.getCloseAction(oe)||"backoff",lt=Kt.getCloseError(oe);this.finish(xe,{error:lt})},this.transport.bind("message",this.onMessage),this.transport.bind("closed",this.onClosed)}unbindListeners(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)}finish(oe,xe){this.callback(Ot({transport:this.transport,action:oe},xe))}}class pr{constructor(oe,xe){this.timeline=oe,this.options=xe||{}}send(oe,xe){this.timeline.isEmpty()||this.timeline.send(Zn.TimelineTransport.getAgent(this,oe),xe)}}class Qr extends Di{constructor(oe,xe){super(function(lt,vt){un.debug("No callbacks on "+oe+" for "+lt)}),this.name=oe,this.pusher=xe,this.subscribed=!1,this.subscriptionPending=!1,this.subscriptionCancelled=!1}authorize(oe,xe){return xe(null,{auth:""})}trigger(oe,xe){if(oe.indexOf("client-")!==0)throw new F("Event '"+oe+"' does not start with 'client-'");if(!this.subscribed){var lt=$.buildLogSuffix("triggeringClientEvents");un.warn(`Client event triggered before channel 'subscription_succeeded' event . ${lt}`)}return this.pusher.send_event(oe,xe,this.name)}disconnect(){this.subscribed=!1,this.subscriptionPending=!1}handleEvent(oe){var xe=oe.event,lt=oe.data;if(xe==="pusher_internal:subscription_succeeded")this.handleSubscriptionSucceededEvent(oe);else if(xe==="pusher_internal:subscription_count")this.handleSubscriptionCountEvent(oe);else if(xe.indexOf("pusher_internal:")!==0){var vt={};this.emit(xe,lt,vt)}}handleSubscriptionSucceededEvent(oe){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):this.emit("pusher:subscription_succeeded",oe.data)}handleSubscriptionCountEvent(oe){oe.data.subscription_count&&(this.subscriptionCount=oe.data.subscription_count),this.emit("pusher:subscription_count",oe.data)}subscribe(){this.subscribed||(this.subscriptionPending=!0,this.subscriptionCancelled=!1,this.authorize(this.pusher.connection.socket_id,(oe,xe)=>{oe?(this.subscriptionPending=!1,un.error(oe.toString()),this.emit("pusher:subscription_error",Object.assign({},{type:"AuthError",error:oe.message},oe instanceof ye?{status:oe.status}:{}))):this.pusher.send_event("pusher:subscribe",{auth:xe.auth,channel_data:xe.channel_data,channel:this.name})}))}unsubscribe(){this.subscribed=!1,this.pusher.send_event("pusher:unsubscribe",{channel:this.name})}cancelSubscription(){this.subscriptionCancelled=!0}reinstateSubscription(){this.subscriptionCancelled=!1}}class Gr extends Qr{authorize(oe,xe){return this.pusher.config.channelAuthorizer({channelName:this.name,socketId:oe},xe)}}class Wr{constructor(){this.reset()}get(oe){return Object.prototype.hasOwnProperty.call(this.members,oe)?{id:oe,info:this.members[oe]}:null}each(oe){Jt(this.members,(xe,lt)=>{oe(this.get(lt))})}setMyID(oe){this.myID=oe}onSubscription(oe){this.members=oe.presence.hash,this.count=oe.presence.count,this.me=this.get(this.myID)}addMember(oe){return this.get(oe.user_id)===null&&this.count++,this.members[oe.user_id]=oe.user_info,this.get(oe.user_id)}removeMember(oe){var xe=this.get(oe.user_id);return xe&&(delete this.members[oe.user_id],this.count--),xe}reset(){this.members={},this.count=0,this.myID=null,this.me=null}}var Gi=function(ve,oe,xe,lt){function vt(An){return An instanceof xe?An:new xe(function(Nr){Nr(An)})}return new(xe||(xe=Promise))(function(An,Nr){function Xr($s){try{Ms(lt.next($s))}catch(Pa){Nr(Pa)}}function Ti($s){try{Ms(lt.throw($s))}catch(Pa){Nr(Pa)}}function Ms($s){$s.done?An($s.value):vt($s.value).then(Xr,Ti)}Ms((lt=lt.apply(ve,oe||[])).next())})};class ai extends Gr{constructor(oe,xe){super(oe,xe),this.members=new Wr}authorize(oe,xe){super.authorize(oe,(lt,vt)=>Gi(this,void 0,void 0,function*(){if(!lt)if(vt=vt,vt.channel_data!=null){var An=JSON.parse(vt.channel_data);this.members.setMyID(An.user_id)}else if(yield this.pusher.user.signinDonePromise,this.pusher.user.user_data!=null)this.members.setMyID(this.pusher.user.user_data.id);else{let Nr=$.buildLogSuffix("authorizationEndpoint");un.error(`Invalid auth response for channel '${this.name}', expected 'channel_data' field. ${Nr}, or the user should be signed in.`),xe("Invalid auth response");return}xe(lt,vt)}))}handleEvent(oe){var xe=oe.event;if(xe.indexOf("pusher_internal:")===0)this.handleInternalEvent(oe);else{var lt=oe.data,vt={};oe.user_id&&(vt.user_id=oe.user_id),this.emit(xe,lt,vt)}}handleInternalEvent(oe){var xe=oe.event,lt=oe.data;switch(xe){case"pusher_internal:subscription_succeeded":this.handleSubscriptionSucceededEvent(oe);break;case"pusher_internal:subscription_count":this.handleSubscriptionCountEvent(oe);break;case"pusher_internal:member_added":var vt=this.members.addMember(lt);this.emit("pusher:member_added",vt);break;case"pusher_internal:member_removed":var An=this.members.removeMember(lt);An&&this.emit("pusher:member_removed",An);break}}handleSubscriptionSucceededEvent(oe){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):(this.members.onSubscription(oe.data),this.emit("pusher:subscription_succeeded",this.members))}disconnect(){this.members.reset(),super.disconnect()}}var ws=c(1),Ks=c(0);class ca extends Gr{constructor(oe,xe,lt){super(oe,xe),this.key=null,this.nacl=lt}authorize(oe,xe){super.authorize(oe,(lt,vt)=>{if(lt){xe(lt,vt);return}let An=vt.shared_secret;if(!An){xe(new Error(`No shared_secret key in auth payload for encrypted channel: ${this.name}`),null);return}this.key=Object(Ks.decode)(An),delete vt.shared_secret,xe(null,vt)})}trigger(oe,xe){throw new Z("Client events are not currently supported for encrypted channels")}handleEvent(oe){var xe=oe.event,lt=oe.data;if(xe.indexOf("pusher_internal:")===0||xe.indexOf("pusher:")===0){super.handleEvent(oe);return}this.handleEncryptedEvent(xe,lt)}handleEncryptedEvent(oe,xe){if(!this.key){un.debug("Received encrypted event before key has been retrieved from the authEndpoint");return}if(!xe.ciphertext||!xe.nonce){un.error("Unexpected format for encrypted event, expected object with `ciphertext` and `nonce` fields, got: "+xe);return}let lt=Object(Ks.decode)(xe.ciphertext);if(lt.length<this.nacl.secretbox.overheadLength){un.error(`Expected encrypted event ciphertext length to be ${this.nacl.secretbox.overheadLength}, got: ${lt.length}`);return}let vt=Object(Ks.decode)(xe.nonce);if(vt.length<this.nacl.secretbox.nonceLength){un.error(`Expected encrypted event nonce length to be ${this.nacl.secretbox.nonceLength}, got: ${vt.length}`);return}let An=this.nacl.secretbox.open(lt,vt,this.key);if(An===null){un.debug("Failed to decrypt an event, probably because it was encrypted with a different key. Fetching a new key from the authEndpoint..."),this.authorize(this.pusher.connection.socket_id,(Nr,Xr)=>{if(Nr){un.error(`Failed to make a request to the authEndpoint: ${Xr}. Unable to fetch new key, so dropping encrypted event`);return}if(An=this.nacl.secretbox.open(lt,vt,this.key),An===null){un.error("Failed to decrypt event with new key. Dropping encrypted event");return}this.emit(oe,this.getDataToEmit(An))});return}this.emit(oe,this.getDataToEmit(An))}getDataToEmit(oe){let xe=Object(ws.decode)(oe);try{return JSON.parse(xe)}catch{return xe}}}class fr extends Di{constructor(oe,xe){super(),this.state="initialized",this.connection=null,this.key=oe,this.options=xe,this.timeline=this.options.timeline,this.usingTLS=this.options.useTLS,this.errorCallbacks=this.buildErrorCallbacks(),this.connectionCallbacks=this.buildConnectionCallbacks(this.errorCallbacks),this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var lt=Zn.getNetwork();lt.bind("online",()=>{this.timeline.info({netinfo:"online"}),(this.state==="connecting"||this.state==="unavailable")&&this.retryIn(0)}),lt.bind("offline",()=>{this.timeline.info({netinfo:"offline"}),this.connection&&this.sendActivityCheck()}),this.updateStrategy()}connect(){if(!(this.connection||this.runner)){if(!this.strategy.isSupported()){this.updateState("failed");return}this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()}}send(oe){return this.connection?this.connection.send(oe):!1}send_event(oe,xe,lt){return this.connection?this.connection.send_event(oe,xe,lt):!1}disconnect(){this.disconnectInternally(),this.updateState("disconnected")}isUsingTLS(){return this.usingTLS}startConnecting(){var oe=(xe,lt)=>{xe?this.runner=this.strategy.connect(0,oe):lt.action==="error"?(this.emit("error",{type:"HandshakeError",error:lt.error}),this.timeline.error({handshakeError:lt.error})):(this.abortConnecting(),this.handshakeCallbacks[lt.action](lt))};this.runner=this.strategy.connect(0,oe)}abortConnecting(){this.runner&&(this.runner.abort(),this.runner=null)}disconnectInternally(){if(this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection){var oe=this.abandonConnection();oe.close()}}updateStrategy(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,useTLS:this.usingTLS})}retryIn(oe){this.timeline.info({action:"retry",delay:oe}),oe>0&&this.emit("connecting_in",Math.round(oe/1e3)),this.retryTimer=new We(oe||0,()=>{this.disconnectInternally(),this.connect()})}clearRetryTimer(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)}setUnavailableTimer(){this.unavailableTimer=new We(this.options.unavailableTimeout,()=>{this.updateState("unavailable")})}clearUnavailableTimer(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()}sendActivityCheck(){this.stopActivityCheck(),this.connection.ping(),this.activityTimer=new We(this.options.pongTimeout,()=>{this.timeline.error({pong_timed_out:this.options.pongTimeout}),this.retryIn(0)})}resetActivityCheck(){this.stopActivityCheck(),this.connection&&!this.connection.handlesActivityChecks()&&(this.activityTimer=new We(this.activityTimeout,()=>{this.sendActivityCheck()}))}stopActivityCheck(){this.activityTimer&&this.activityTimer.ensureAborted()}buildConnectionCallbacks(oe){return Ot({},oe,{message:xe=>{this.resetActivityCheck(),this.emit("message",xe)},ping:()=>{this.send_event("pusher:pong",{})},activity:()=>{this.resetActivityCheck()},error:xe=>{this.emit("error",xe)},closed:()=>{this.abandonConnection(),this.shouldRetry()&&this.retryIn(1e3)}})}buildHandshakeCallbacks(oe){return Ot({},oe,{connected:xe=>{this.activityTimeout=Math.min(this.options.activityTimeout,xe.activityTimeout,xe.connection.activityTimeout||1/0),this.clearUnavailableTimer(),this.setConnection(xe.connection),this.socket_id=this.connection.id,this.updateState("connected",{socket_id:this.socket_id})}})}buildErrorCallbacks(){let oe=xe=>lt=>{lt.error&&this.emit("error",{type:"WebSocketError",error:lt.error}),xe(lt)};return{tls_only:oe(()=>{this.usingTLS=!0,this.updateStrategy(),this.retryIn(0)}),refused:oe(()=>{this.disconnect()}),backoff:oe(()=>{this.retryIn(1e3)}),retry:oe(()=>{this.retryIn(0)})}}setConnection(oe){this.connection=oe;for(var xe in this.connectionCallbacks)this.connection.bind(xe,this.connectionCallbacks[xe]);this.resetActivityCheck()}abandonConnection(){if(this.connection){this.stopActivityCheck();for(var oe in this.connectionCallbacks)this.connection.unbind(oe,this.connectionCallbacks[oe]);var xe=this.connection;return this.connection=null,xe}}updateState(oe,xe){var lt=this.state;if(this.state=oe,lt!==oe){var vt=oe;vt==="connected"&&(vt+=" with new socket ID "+xe.socket_id),un.debug("State changed",lt+" -> "+vt),this.timeline.info({state:oe,params:xe}),this.emit("state_change",{previous:lt,current:oe}),this.emit(oe,xe)}}shouldRetry(){return this.state==="connecting"||this.state==="connected"}}class di{constructor(){this.channels={}}add(oe,xe){return this.channels[oe]||(this.channels[oe]=wr(oe,xe)),this.channels[oe]}all(){return nr(this.channels)}find(oe){return this.channels[oe]}remove(oe){var xe=this.channels[oe];return delete this.channels[oe],xe}disconnect(){Jt(this.channels,function(oe){oe.disconnect()})}}function wr(ve,oe){if(ve.indexOf("private-encrypted-")===0){if(oe.config.nacl)return rs.createEncryptedChannel(ve,oe,oe.config.nacl);let xe="Tried to subscribe to a private-encrypted- channel but no nacl implementation available",lt=$.buildLogSuffix("encryptedChannelSupport");throw new Z(`${xe}. ${lt}`)}else{if(ve.indexOf("private-")===0)return rs.createPrivateChannel(ve,oe);if(ve.indexOf("presence-")===0)return rs.createPresenceChannel(ve,oe);if(ve.indexOf("#")===0)throw new K('Cannot create a channel with name "'+ve+'".');return rs.createChannel(ve,oe)}}var Fi={createChannels(){return new di},createConnectionManager(ve,oe){return new fr(ve,oe)},createChannel(ve,oe){return new Qr(ve,oe)},createPrivateChannel(ve,oe){return new Gr(ve,oe)},createPresenceChannel(ve,oe){return new ai(ve,oe)},createEncryptedChannel(ve,oe,xe){return new ca(ve,oe,xe)},createTimelineSender(ve,oe){return new pr(ve,oe)},createHandshake(ve,oe){return new br(ve,oe)},createAssistantToTheTransportManager(ve,oe,xe){return new St(ve,oe,xe)}},rs=Fi;class Js{constructor(oe){this.options=oe||{},this.livesLeft=this.options.lives||1/0}getAssistant(oe){return rs.createAssistantToTheTransportManager(this,oe,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})}isAlive(){return this.livesLeft>0}reportDeath(){this.livesLeft-=1}}class Na{constructor(oe,xe){this.strategies=oe,this.loop=!!xe.loop,this.failFast=!!xe.failFast,this.timeout=xe.timeout,this.timeoutLimit=xe.timeoutLimit}isSupported(){return ci(this.strategies,Pt.method("isSupported"))}connect(oe,xe){var lt=this.strategies,vt=0,An=this.timeout,Nr=null,Xr=(Ti,Ms)=>{Ms?xe(null,Ms):(vt=vt+1,this.loop&&(vt=vt%lt.length),vt<lt.length?(An&&(An=An*2,this.timeoutLimit&&(An=Math.min(An,this.timeoutLimit))),Nr=this.tryStrategy(lt[vt],oe,{timeout:An,failFast:this.failFast},Xr)):xe(!0))};return Nr=this.tryStrategy(lt[vt],oe,{timeout:An,failFast:this.failFast},Xr),{abort:function(){Nr.abort()},forceMinPriority:function(Ti){oe=Ti,Nr&&Nr.forceMinPriority(Ti)}}}tryStrategy(oe,xe,lt,vt){var An=null,Nr=null;return lt.timeout>0&&(An=new We(lt.timeout,function(){Nr.abort(),vt(!0)})),Nr=oe.connect(xe,function(Xr,Ti){Xr&&An&&An.isRunning()&&!lt.failFast||(An&&An.ensureAborted(),vt(Xr,Ti))}),{abort:function(){An&&An.ensureAborted(),Nr.abort()},forceMinPriority:function(Xr){Nr.forceMinPriority(Xr)}}}}class Ia{constructor(oe){this.strategies=oe}isSupported(){return ci(this.strategies,Pt.method("isSupported"))}connect(oe,xe){return id(this.strategies,oe,function(lt,vt){return function(An,Nr){if(vt[lt].error=An,An){Ua(vt)&&xe(!0);return}sn(vt,function(Xr){Xr.forceMinPriority(Nr.transport.priority)}),xe(null,Nr)}})}}function id(ve,oe,xe){var lt=zr(ve,function(vt,An,Nr,Xr){return vt.connect(oe,xe(An,Xr))});return{abort:function(){sn(lt,ts)},forceMinPriority:function(vt){sn(lt,function(An){An.forceMinPriority(vt)})}}}function Ua(ve){return ui(ve,function(oe){return!!oe.error})}function ts(ve){!ve.error&&!ve.aborted&&(ve.abort(),ve.aborted=!0)}class dc{constructor(oe,xe,lt){this.strategy=oe,this.transports=xe,this.ttl=lt.ttl||1800*1e3,this.usingTLS=lt.useTLS,this.timeline=lt.timeline}isSupported(){return this.strategy.isSupported()}connect(oe,xe){var lt=this.usingTLS,vt=hc(lt),An=vt&&vt.cacheSkipCount?vt.cacheSkipCount:0,Nr=[this.strategy];if(vt&&vt.timestamp+this.ttl>=Pt.now()){var Xr=this.transports[vt.transport];Xr&&(["ws","wss"].includes(vt.transport)||An>3?(this.timeline.info({cached:!0,transport:vt.transport,latency:vt.latency}),Nr.push(new Na([Xr],{timeout:vt.latency*2+1e3,failFast:!0}))):An++)}var Ti=Pt.now(),Ms=Nr.pop().connect(oe,function $s(Pa,Ru){Pa?(ru(lt),Nr.length>0?(Ti=Pt.now(),Ms=Nr.pop().connect(oe,$s)):xe(Pa)):(Nu(lt,Ru.transport.name,Pt.now()-Ti,An),xe(null,Ru))});return{abort:function(){Ms.abort()},forceMinPriority:function($s){oe=$s,Ms&&Ms.forceMinPriority($s)}}}}function Dl(ve){return"pusherTransport"+(ve?"TLS":"NonTLS")}function hc(ve){var oe=Zn.getLocalStorage();if(oe)try{var xe=oe[Dl(ve)];if(xe)return JSON.parse(xe)}catch{ru(ve)}return null}function Nu(ve,oe,xe,lt){var vt=Zn.getLocalStorage();if(vt)try{vt[Dl(ve)]=Wn({timestamp:Pt.now(),transport:oe,latency:xe,cacheSkipCount:lt})}catch{}}function ru(ve){var oe=Zn.getLocalStorage();if(oe)try{delete oe[Dl(ve)]}catch{}}class fc{constructor(oe,{delay:xe}){this.strategy=oe,this.options={delay:xe}}isSupported(){return this.strategy.isSupported()}connect(oe,xe){var lt=this.strategy,vt,An=new We(this.options.delay,function(){vt=lt.connect(oe,xe)});return{abort:function(){An.ensureAborted(),vt&&vt.abort()},forceMinPriority:function(Nr){oe=Nr,vt&&vt.forceMinPriority(Nr)}}}}class Xa{constructor(oe,xe,lt){this.test=oe,this.trueBranch=xe,this.falseBranch=lt}isSupported(){var oe=this.test()?this.trueBranch:this.falseBranch;return oe.isSupported()}connect(oe,xe){var lt=this.test()?this.trueBranch:this.falseBranch;return lt.connect(oe,xe)}}class sd{constructor(oe){this.strategy=oe}isSupported(){return this.strategy.isSupported()}connect(oe,xe){var lt=this.strategy.connect(oe,function(vt,An){An&&lt.abort(),xe(vt,An)});return lt}}function co(ve){return function(){return ve.isSupported()}}var zo=function(ve,oe,xe){var lt={};function vt(kc,Xf,xl,Uo,nh){var Ya=xe(ve,kc,Xf,xl,Uo,nh);return lt[kc]=Ya,Ya}var An=Object.assign({},oe,{hostNonTLS:ve.wsHost+":"+ve.wsPort,hostTLS:ve.wsHost+":"+ve.wssPort,httpPath:ve.wsPath}),Nr=Object.assign({},An,{useTLS:!0}),Xr=Object.assign({},oe,{hostNonTLS:ve.httpHost+":"+ve.httpPort,hostTLS:ve.httpHost+":"+ve.httpsPort,httpPath:ve.httpPath}),Ti={loop:!0,timeout:15e3,timeoutLimit:6e4},Ms=new Js({minPingDelay:1e4,maxPingDelay:ve.activityTimeout}),$s=new Js({lives:2,minPingDelay:1e4,maxPingDelay:ve.activityTimeout}),Pa=vt("ws","ws",3,An,Ms),Ru=vt("wss","ws",3,Nr,Ms),Bo=vt("sockjs","sockjs",1,Xr),vc=vt("xhr_streaming","xhr_streaming",1,Xr,$s),uo=vt("xdr_streaming","xdr_streaming",1,Xr,$s),Ou=vt("xhr_polling","xhr_polling",1,Xr),ei=vt("xdr_polling","xdr_polling",1,Xr),Fn=new Na([Pa],Ti),Ll=new Na([Ru],Ti),Pr=new Na([Bo],Ti),aa=new Na([new Xa(co(vc),vc,uo)],Ti),Dc=new Na([new Xa(co(Ou),Ou,ei)],Ti),_r=new Na([new Xa(co(aa),new Ia([aa,new fc(Dc,{delay:4e3})]),Dc)],Ti),xc=new Xa(co(_r),_r,Pr),su;return oe.useTLS?su=new Ia([Fn,new fc(xc,{delay:2e3})]):su=new Ia([Fn,new fc(Ll,{delay:2e3}),new fc(xc,{delay:5e3})]),new dc(new sd(new Xa(co(Pa),su,xc)),lt,{ttl:18e5,timeline:oe.timeline,useTLS:oe.useTLS})},Za=zo,Zo=(function(){var ve=this;ve.timeline.info(ve.buildTimelineMessage({transport:ve.name+(ve.options.useTLS?"s":"")})),ve.hooks.isInitialized()?ve.changeState("initialized"):ve.hooks.file?(ve.changeState("initializing"),N.load(ve.hooks.file,{useTLS:ve.options.useTLS},function(oe,xe){ve.hooks.isInitialized()?(ve.changeState("initialized"),xe(!0)):(oe&&ve.onError(oe),ve.onClose(),xe(!1))})):ve.onClose()}),Po={getRequest:function(ve){var oe=new window.XDomainRequest;return oe.ontimeout=function(){ve.emit("error",new Y),ve.close()},oe.onerror=function(xe){ve.emit("error",xe),ve.close()},oe.onprogress=function(){oe.responseText&&oe.responseText.length>0&&ve.onChunk(200,oe.responseText)},oe.onload=function(){oe.responseText&&oe.responseText.length>0&&ve.onChunk(200,oe.responseText),ve.emit("finished",200),ve.close()},oe},abortRequest:function(ve){ve.ontimeout=ve.onerror=ve.onprogress=ve.onload=null,ve.abort()}},to=Po;const Pu=256*1024;class ml extends Di{constructor(oe,xe,lt){super(),this.hooks=oe,this.method=xe,this.url=lt}start(oe){this.position=0,this.xhr=this.hooks.getRequest(this),this.unloader=()=>{this.close()},Zn.addUnloadListener(this.unloader),this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader&&this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.send(oe)}close(){this.unloader&&(Zn.removeUnloadListener(this.unloader),this.unloader=null),this.xhr&&(this.hooks.abortRequest(this.xhr),this.xhr=null)}onChunk(oe,xe){for(;;){var lt=this.advanceBuffer(xe);if(lt)this.emit("chunk",{status:oe,data:lt});else break}this.isBufferTooLong(xe)&&this.emit("buffer_too_long")}advanceBuffer(oe){var xe=oe.slice(this.position),lt=xe.indexOf(`
`);return lt!==-1?(this.position+=lt+1,xe.slice(0,lt)):null}isBufferTooLong(oe){return this.position===oe.length&&oe.length>Pu}}var pc;(function(ve){ve[ve.CONNECTING=0]="CONNECTING",ve[ve.OPEN=1]="OPEN",ve[ve.CLOSED=3]="CLOSED"})(pc||(pc={}));var Va=pc,nl=1;class ad{constructor(oe,xe){this.hooks=oe,this.session=gl(1e3)+"/"+qh(8),this.location=wo(xe),this.readyState=Va.CONNECTING,this.openStream()}send(oe){return this.sendRaw(JSON.stringify([oe]))}ping(){this.hooks.sendHeartbeat(this)}close(oe,xe){this.onClose(oe,xe,!0)}sendRaw(oe){if(this.readyState===Va.OPEN)try{return Zn.createSocketRequest("POST",rl($a(this.location,this.session))).start(oe),!0}catch{return!1}else return!1}reconnect(){this.closeStream(),this.openStream()}onClose(oe,xe,lt){this.closeStream(),this.readyState=Va.CLOSED,this.onclose&&this.onclose({code:oe,reason:xe,wasClean:lt})}onChunk(oe){if(oe.status===200){this.readyState===Va.OPEN&&this.onActivity();var xe,lt=oe.data.slice(0,1);switch(lt){case"o":xe=JSON.parse(oe.data.slice(1)||"{}"),this.onOpen(xe);break;case"a":xe=JSON.parse(oe.data.slice(1)||"[]");for(var vt=0;vt<xe.length;vt++)this.onEvent(xe[vt]);break;case"m":xe=JSON.parse(oe.data.slice(1)||"null"),this.onEvent(xe);break;case"h":this.hooks.onHeartbeat(this);break;case"c":xe=JSON.parse(oe.data.slice(1)||"[]"),this.onClose(xe[0],xe[1],!0);break}}}onOpen(oe){this.readyState===Va.CONNECTING?(oe&&oe.hostname&&(this.location.base=Ql(this.location.base,oe.hostname)),this.readyState=Va.OPEN,this.onopen&&this.onopen()):this.onClose(1006,"Server lost session",!0)}onEvent(oe){this.readyState===Va.OPEN&&this.onmessage&&this.onmessage({data:oe})}onActivity(){this.onactivity&&this.onactivity()}onError(oe){this.onerror&&this.onerror(oe)}openStream(){this.stream=Zn.createSocketRequest("POST",rl(this.hooks.getReceiveURL(this.location,this.session))),this.stream.bind("chunk",oe=>{this.onChunk(oe)}),this.stream.bind("finished",oe=>{this.hooks.onFinished(this,oe)}),this.stream.bind("buffer_too_long",()=>{this.reconnect()});try{this.stream.start()}catch(oe){Pt.defer(()=>{this.onError(oe),this.onClose(1006,"Could not start streaming",!1)})}}closeStream(){this.stream&&(this.stream.unbind_all(),this.stream.close(),this.stream=null)}}function wo(ve){var oe=/([^\?]*)\/*(\??.*)/.exec(ve);return{base:oe[1],queryString:oe[2]}}function $a(ve,oe){return ve.base+"/"+oe+"/xhr_send"}function rl(ve){var oe=ve.indexOf("?")===-1?"?":"&";return ve+oe+"t="+ +new Date+"&n="+nl++}function Ql(ve,oe){var xe=/(https?:\/\/)([^\/:]+)((\/|:)?.*)/.exec(ve);return xe[1]+oe+xe[3]}function gl(ve){return Zn.randomInt(ve)}function qh(ve){for(var oe=[],xe=0;xe<ve;xe++)oe.push(gl(32).toString(32));return oe.join("")}var Kd=ad,Mu={getReceiveURL:function(ve,oe){return ve.base+"/"+oe+"/xhr_streaming"+ve.queryString},onHeartbeat:function(ve){ve.sendRaw("[]")},sendHeartbeat:function(ve){ve.sendRaw("[]")},onFinished:function(ve,oe){ve.onClose(1006,"Connection interrupted ("+oe+")",!1)}},bi=Mu,yl={getReceiveURL:function(ve,oe){return ve.base+"/"+oe+"/xhr"+ve.queryString},onHeartbeat:function(){},sendHeartbeat:function(ve){ve.sendRaw("[]")},onFinished:function(ve,oe){oe===200?ve.reconnect():ve.onClose(1006,"Connection interrupted ("+oe+")",!1)}},mc=yl,gc={getRequest:function(ve){var oe=Zn.getXHRAPI(),xe=new oe;return xe.onreadystatechange=xe.onprogress=function(){switch(xe.readyState){case 3:xe.responseText&&xe.responseText.length>0&&ve.onChunk(xe.status,xe.responseText);break;case 4:xe.responseText&&xe.responseText.length>0&&ve.onChunk(xe.status,xe.responseText),ve.emit("finished",xe.status),ve.close();break}},xe},abortRequest:function(ve){ve.onreadystatechange=null,ve.abort()}},je=gc,ot={createStreamingSocket(ve){return this.createSocket(bi,ve)},createPollingSocket(ve){return this.createSocket(mc,ve)},createSocket(ve,oe){return new Kd(ve,oe)},createXHR(ve,oe){return this.createRequest(je,ve,oe)},createRequest(ve,oe,xe){return new ml(ve,oe,xe)}},vn=ot;vn.createXDR=function(ve,oe){return this.createRequest(to,ve,oe)};var Sr=vn,gr={nextAuthCallbackID:1,auth_callbacks:{},ScriptReceivers:p,DependenciesReceivers:E,getDefaultStrategy:Za,Transports:ut,transportConnectionInitializer:Zo,HTTPFactory:Sr,TimelineTransport:Xn,getXHRAPI(){return window.XMLHttpRequest},getWebSocketAPI(){return window.WebSocket||window.MozWebSocket},setup(ve){window.Pusher=ve;var oe=()=>{this.onDocumentBody(ve.ready)};window.JSON?oe():N.load("json2",{},oe)},getDocument(){return document},getProtocol(){return this.getDocument().location.protocol},getAuthorizers(){return{ajax:Ve,jsonp:$t}},onDocumentBody(ve){document.body?ve():setTimeout(()=>{this.onDocumentBody(ve)},0)},createJSONPRequest(ve,oe){return new ze(ve,oe)},createScriptRequest(ve){return new lr(ve)},getLocalStorage(){try{return window.localStorage}catch{return}},createXHR(){return this.getXHRAPI()?this.createXMLHttpRequest():this.createMicrosoftXHR()},createXMLHttpRequest(){var ve=this.getXHRAPI();return new ve},createMicrosoftXHR(){return new ActiveXObject("Microsoft.XMLHTTP")},getNetwork(){return ht},createWebSocket(ve){var oe=this.getWebSocketAPI();return new oe(ve)},createSocketRequest(ve,oe){if(this.isXHRSupported())return this.HTTPFactory.createXHR(ve,oe);if(this.isXDRSupported(oe.indexOf("https:")===0))return this.HTTPFactory.createXDR(ve,oe);throw"Cross-origin HTTP requests are not supported"},isXHRSupported(){var ve=this.getXHRAPI();return!!ve&&new ve().withCredentials!==void 0},isXDRSupported(ve){var oe=ve?"https:":"http:",xe=this.getProtocol();return!!window.XDomainRequest&&xe===oe},addUnloadListener(ve){window.addEventListener!==void 0?window.addEventListener("unload",ve,!1):window.attachEvent!==void 0&&window.attachEvent("onunload",ve)},removeUnloadListener(ve){window.addEventListener!==void 0?window.removeEventListener("unload",ve,!1):window.detachEvent!==void 0&&window.detachEvent("onunload",ve)},randomInt(ve){return Math.floor(function(){return(window.crypto||window.msCrypto).getRandomValues(new Uint32Array(1))[0]/Math.pow(2,32)}()*ve)}},Zn=gr,Mo;(function(ve){ve[ve.ERROR=3]="ERROR",ve[ve.INFO=6]="INFO",ve[ve.DEBUG=7]="DEBUG"})(Mo||(Mo={}));var ua=Mo;class no{constructor(oe,xe,lt){this.key=oe,this.session=xe,this.events=[],this.options=lt||{},this.sent=0,this.uniqueID=0}log(oe,xe){oe<=this.options.level&&(this.events.push(Ot({},xe,{timestamp:Pt.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())}error(oe){this.log(ua.ERROR,oe)}info(oe){this.log(ua.INFO,oe)}debug(oe){this.log(ua.DEBUG,oe)}isEmpty(){return this.events.length===0}send(oe,xe){var lt=Ot({session:this.session,bundle:this.sent+1,key:this.key,lib:"js",version:this.options.version,cluster:this.options.cluster,features:this.options.features,timeline:this.events},this.options.params);return this.events=[],oe(lt,(vt,An)=>{vt||this.sent++,xe&&xe(vt,An)}),!0}generateUniqueID(){return this.uniqueID++,this.uniqueID}}class La{constructor(oe,xe,lt,vt){this.name=oe,this.priority=xe,this.transport=lt,this.options=vt||{}}isSupported(){return this.transport.isSupported({useTLS:this.options.useTLS})}connect(oe,xe){if(this.isSupported()){if(this.priority<oe)return ta(new X,xe)}else return ta(new he,xe);var lt=!1,vt=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),An=null,Nr=function(){vt.unbind("initialized",Nr),vt.connect()},Xr=function(){An=rs.createHandshake(vt,function(Pa){lt=!0,$s(),xe(null,Pa)})},Ti=function(Pa){$s(),xe(Pa)},Ms=function(){$s();var Pa;Pa=Wn(vt),xe(new ae(Pa))},$s=function(){vt.unbind("initialized",Nr),vt.unbind("open",Xr),vt.unbind("error",Ti),vt.unbind("closed",Ms)};return vt.bind("initialized",Nr),vt.bind("open",Xr),vt.bind("error",Ti),vt.bind("closed",Ms),vt.initialize(),{abort:()=>{lt||($s(),An?An.close():vt.close())},forceMinPriority:Pa=>{lt||this.priority<Pa&&(An?An.close():vt.close())}}}}function ta(ve,oe){return Pt.defer(function(){oe(ve)}),{abort:function(){},forceMinPriority:function(){}}}const{Transports:Ta}=Zn;var kl=function(ve,oe,xe,lt,vt,An){var Nr=Ta[xe];if(!Nr)throw new se(xe);var Xr=(!ve.enabledTransports||an(ve.enabledTransports,oe)!==-1)&&(!ve.disabledTransports||an(ve.disabledTransports,oe)===-1),Ti;return Xr?(vt=Object.assign({ignoreNullOrigin:ve.ignoreNullOrigin},vt),Ti=new La(oe,lt,An?An.getAssistant(Nr):Nr,vt)):Ti=yc,Ti},yc={isSupported:function(){return!1},connect:function(ve,oe){var xe=Pt.defer(function(){oe(new he)});return{abort:function(){xe.ensureAborted()},forceMinPriority:function(){}}}};function Fo(ve){if(ve==null)throw"You must pass an options object";if(ve.cluster==null)throw"Options object must provide a cluster";"disableStats"in ve&&un.warn("The disableStats option is deprecated in favor of enableStats")}const Jd=(ve,oe)=>{var xe="socket_id="+encodeURIComponent(ve.socketId);for(var lt in oe.params)xe+="&"+encodeURIComponent(lt)+"="+encodeURIComponent(oe.params[lt]);if(oe.paramsProvider!=null){let vt=oe.paramsProvider();for(var lt in vt)xe+="&"+encodeURIComponent(lt)+"="+encodeURIComponent(vt[lt])}return xe};var od=ve=>{if(typeof Zn.getAuthorizers()[ve.transport]>"u")throw`'${ve.transport}' is not a recognized auth transport`;return(oe,xe)=>{const lt=Jd(oe,ve);Zn.getAuthorizers()[ve.transport](Zn,lt,ve,B.UserAuthentication,xe)}};const vl=(ve,oe)=>{var xe="socket_id="+encodeURIComponent(ve.socketId);xe+="&channel_name="+encodeURIComponent(ve.channelName);for(var lt in oe.params)xe+="&"+encodeURIComponent(lt)+"="+encodeURIComponent(oe.params[lt]);if(oe.paramsProvider!=null){let vt=oe.paramsProvider();for(var lt in vt)xe+="&"+encodeURIComponent(lt)+"="+encodeURIComponent(vt[lt])}return xe};var Qd=ve=>{if(typeof Zn.getAuthorizers()[ve.transport]>"u")throw`'${ve.transport}' is not a recognized auth transport`;return(oe,xe)=>{const lt=vl(oe,ve);Zn.getAuthorizers()[ve.transport](Zn,lt,ve,B.ChannelAuthorization,xe)}};const pm=(ve,oe,xe)=>{const lt={authTransport:oe.transport,authEndpoint:oe.endpoint,auth:{params:oe.params,headers:oe.headers}};return(vt,An)=>{const Nr=ve.channel(vt.channelName);xe(Nr,lt).authorize(vt.socketId,An)}};function ns(ve,oe){let xe={activityTimeout:ve.activityTimeout||w.activityTimeout,cluster:ve.cluster,httpPath:ve.httpPath||w.httpPath,httpPort:ve.httpPort||w.httpPort,httpsPort:ve.httpsPort||w.httpsPort,pongTimeout:ve.pongTimeout||w.pongTimeout,statsHost:ve.statsHost||w.stats_host,unavailableTimeout:ve.unavailableTimeout||w.unavailableTimeout,wsPath:ve.wsPath||w.wsPath,wsPort:ve.wsPort||w.wsPort,wssPort:ve.wssPort||w.wssPort,enableStats:Vg(ve),httpHost:Hh(ve),useTLS:yr(ve),wsHost:eh(ve),userAuthenticator:Gh(ve),channelAuthorizer:Il(ve,oe)};return"disabledTransports"in ve&&(xe.disabledTransports=ve.disabledTransports),"enabledTransports"in ve&&(xe.enabledTransports=ve.enabledTransports),"ignoreNullOrigin"in ve&&(xe.ignoreNullOrigin=ve.ignoreNullOrigin),"timelineParams"in ve&&(xe.timelineParams=ve.timelineParams),"nacl"in ve&&(xe.nacl=ve.nacl),xe}function Hh(ve){return ve.httpHost?ve.httpHost:ve.cluster?`sockjs-${ve.cluster}.pusher.com`:w.httpHost}function eh(ve){return ve.wsHost?ve.wsHost:Ug(ve.cluster)}function Ug(ve){return`ws-${ve}.pusher.com`}function yr(ve){return Zn.getProtocol()==="https:"?!0:ve.forceTLS!==!1}function Vg(ve){return"enableStats"in ve?ve.enableStats:"disableStats"in ve?!ve.disableStats:!1}function Gh(ve){const oe=Object.assign(Object.assign({},w.userAuthentication),ve.userAuthentication);return"customHandler"in oe&&oe.customHandler!=null?oe.customHandler:od(oe)}function ld(ve,oe){let xe;return"channelAuthorization"in ve?xe=Object.assign(Object.assign({},w.channelAuthorization),ve.channelAuthorization):(xe={transport:ve.authTransport||w.authTransport,endpoint:ve.authEndpoint||w.authEndpoint},"auth"in ve&&("params"in ve.auth&&(xe.params=ve.auth.params),"headers"in ve.auth&&(xe.headers=ve.auth.headers)),"authorizer"in ve&&(xe.customHandler=pm(oe,xe,ve.authorizer))),xe}function Il(ve,oe){const xe=ld(ve,oe);return"customHandler"in xe&&xe.customHandler!=null?xe.customHandler:Qd(xe)}class Wh extends Di{constructor(oe){super(function(xe,lt){un.debug(`No callbacks on watchlist events for ${xe}`)}),this.pusher=oe,this.bindWatchlistInternalEvent()}handleEvent(oe){oe.data.events.forEach(xe=>{this.emit(xe.name,xe)})}bindWatchlistInternalEvent(){this.pusher.connection.bind("message",oe=>{var xe=oe.event;xe==="pusher_internal:watchlist_events"&&this.handleEvent(oe)})}}function th(){let ve,oe;return{promise:new Promise((lt,vt)=>{ve=lt,oe=vt}),resolve:ve,reject:oe}}var cr=th;class Qi extends Di{constructor(oe){super(function(xe,lt){un.debug("No callbacks on user for "+xe)}),this.signin_requested=!1,this.user_data=null,this.serverToUserChannel=null,this.signinDonePromise=null,this._signinDoneResolve=null,this._onAuthorize=(xe,lt)=>{if(xe){un.warn(`Error during signin: ${xe}`),this._cleanup();return}this.pusher.send_event("pusher:signin",{auth:lt.auth,user_data:lt.user_data})},this.pusher=oe,this.pusher.connection.bind("state_change",({previous:xe,current:lt})=>{xe!=="connected"&&lt==="connected"&&this._signin(),xe==="connected"&&lt!=="connected"&&(this._cleanup(),this._newSigninPromiseIfNeeded())}),this.watchlist=new Wh(oe),this.pusher.connection.bind("message",xe=>{var lt=xe.event;lt==="pusher:signin_success"&&this._onSigninSuccess(xe.data),this.serverToUserChannel&&this.serverToUserChannel.name===xe.channel&&this.serverToUserChannel.handleEvent(xe)})}signin(){this.signin_requested||(this.signin_requested=!0,this._signin())}_signin(){this.signin_requested&&(this._newSigninPromiseIfNeeded(),this.pusher.connection.state==="connected"&&this.pusher.config.userAuthenticator({socketId:this.pusher.connection.socket_id},this._onAuthorize))}_onSigninSuccess(oe){try{this.user_data=JSON.parse(oe.user_data)}catch{un.error(`Failed parsing user data after signin: ${oe.user_data}`),this._cleanup();return}if(typeof this.user_data.id!="string"||this.user_data.id===""){un.error(`user_data doesn't contain an id. user_data: ${this.user_data}`),this._cleanup();return}this._signinDoneResolve(),this._subscribeChannels()}_subscribeChannels(){const oe=xe=>{xe.subscriptionPending&&xe.subscriptionCancelled?xe.reinstateSubscription():!xe.subscriptionPending&&this.pusher.connection.state==="connected"&&xe.subscribe()};this.serverToUserChannel=new Qr(`#server-to-user-${this.user_data.id}`,this.pusher),this.serverToUserChannel.bind_global((xe,lt)=>{xe.indexOf("pusher_internal:")===0||xe.indexOf("pusher:")===0||this.emit(xe,lt)}),oe(this.serverToUserChannel)}_cleanup(){this.user_data=null,this.serverToUserChannel&&(this.serverToUserChannel.unbind_all(),this.serverToUserChannel.disconnect(),this.serverToUserChannel=null),this.signin_requested&&this._signinDoneResolve()}_newSigninPromiseIfNeeded(){if(!this.signin_requested||this.signinDonePromise&&!this.signinDonePromise.done)return;const{promise:oe,resolve:xe}=cr();oe.done=!1;const lt=()=>{oe.done=!0};oe.then(lt).catch(lt),this.signinDonePromise=oe,this._signinDoneResolve=xe}}class ri{static ready(){ri.isReady=!0;for(var oe=0,xe=ri.instances.length;oe<xe;oe++)ri.instances[oe].connect()}static getClientFeatures(){return Cn(qr({ws:Zn.Transports.ws},function(oe){return oe.isSupported({})}))}constructor(oe,xe){iu(oe),Fo(xe),this.key=oe,this.config=ns(xe,this),this.channels=rs.createChannels(),this.global_emitter=new Di,this.sessionID=Zn.randomInt(1e9),this.timeline=new no(this.key,this.sessionID,{cluster:this.config.cluster,features:ri.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:ua.INFO,version:w.VERSION}),this.config.enableStats&&(this.timelineSender=rs.createTimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/"+Zn.TimelineTransport.name}));var lt=vt=>Zn.getDefaultStrategy(this.config,vt,kl);this.connection=rs.createConnectionManager(this.key,{getStrategy:lt,timeline:this.timeline,activityTimeout:this.config.activityTimeout,pongTimeout:this.config.pongTimeout,unavailableTimeout:this.config.unavailableTimeout,useTLS:!!this.config.useTLS}),this.connection.bind("connected",()=>{this.subscribeAll(),this.timelineSender&&this.timelineSender.send(this.connection.isUsingTLS())}),this.connection.bind("message",vt=>{var An=vt.event,Nr=An.indexOf("pusher_internal:")===0;if(vt.channel){var Xr=this.channel(vt.channel);Xr&&Xr.handleEvent(vt)}Nr||this.global_emitter.emit(vt.event,vt.data)}),this.connection.bind("connecting",()=>{this.channels.disconnect()}),this.connection.bind("disconnected",()=>{this.channels.disconnect()}),this.connection.bind("error",vt=>{un.warn(vt)}),ri.instances.push(this),this.timeline.info({instances:ri.instances.length}),this.user=new Qi(this),ri.isReady&&this.connect()}channel(oe){return this.channels.find(oe)}allChannels(){return this.channels.all()}connect(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var oe=this.connection.isUsingTLS(),xe=this.timelineSender;this.timelineSenderTimer=new Je(6e4,function(){xe.send(oe)})}}disconnect(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)}bind(oe,xe,lt){return this.global_emitter.bind(oe,xe,lt),this}unbind(oe,xe,lt){return this.global_emitter.unbind(oe,xe,lt),this}bind_global(oe){return this.global_emitter.bind_global(oe),this}unbind_global(oe){return this.global_emitter.unbind_global(oe),this}unbind_all(oe){return this.global_emitter.unbind_all(),this}subscribeAll(){var oe;for(oe in this.channels.channels)this.channels.channels.hasOwnProperty(oe)&&this.subscribe(oe)}subscribe(oe){var xe=this.channels.add(oe,this);return xe.subscriptionPending&&xe.subscriptionCancelled?xe.reinstateSubscription():!xe.subscriptionPending&&this.connection.state==="connected"&&xe.subscribe(),xe}unsubscribe(oe){var xe=this.channels.find(oe);xe&&xe.subscriptionPending?xe.cancelSubscription():(xe=this.channels.remove(oe),xe&&xe.subscribed&&xe.unsubscribe())}send_event(oe,xe,lt){return this.connection.send_event(oe,xe,lt)}shouldUseTLS(){return this.config.useTLS}signin(){this.user.signin()}}ri.instances=[],ri.isReady=!1,ri.logToConsole=!1,ri.Runtime=Zn,ri.ScriptReceivers=Zn.ScriptReceivers,ri.DependenciesReceivers=Zn.DependenciesReceivers,ri.auth_callbacks=Zn.auth_callbacks;var Yo=r.default=ri;function iu(ve){if(ve==null)throw"You must pass your app key when you instantiate Pusher."}Zn.setup(ri)})])})})(ck)),ck.exports}var QFe=JFe();const eBe=Ca(QFe),Ef={};class NF{listenForWhisper(t,n){return this.listen(".client-"+t,n)}notification(t){return this.listen(".Illuminate\\Notifications\\Events\\BroadcastNotificationCreated",t)}stopListeningForWhisper(t,n){return this.stopListening(".client-"+t,n)}}class Rne{constructor(t){this.namespace=t}format(t){return[".","\\"].includes(t.charAt(0))?t.substring(1):(this.namespace&&(t=this.namespace+"."+t),t.replace(/\./g,"\\"))}setNamespace(t){this.namespace=t}}function tBe(e){try{new e}catch(t){if(t instanceof Error&&t.message.includes("is not a constructor"))return!1}return!0}let PF=class extends NF{constructor(t,n,r){super(),this.name=n,this.pusher=t,this.options=r,this.eventFormatter=new Rne(this.options.namespace),this.subscribe()}subscribe(){this.subscription=this.pusher.subscribe(this.name)}unsubscribe(){this.pusher.unsubscribe(this.name)}listen(t,n){return this.on(this.eventFormatter.format(t),n),this}listenToAll(t){return this.subscription.bind_global((n,r)=>{if(n.startsWith("pusher:"))return;let c=String(this.options.namespace??"").replace(/\./g,"\\"),f=n.startsWith(c)?n.substring(c.length+1):"."+n;t(f,r)}),this}stopListening(t,n){return n?this.subscription.unbind(this.eventFormatter.format(t),n):this.subscription.unbind(this.eventFormatter.format(t)),this}stopListeningToAll(t){return t?this.subscription.unbind_global(t):this.subscription.unbind_global(),this}subscribed(t){return this.on("pusher:subscription_succeeded",()=>{t()}),this}error(t){return this.on("pusher:subscription_error",n=>{t(n)}),this}on(t,n){return this.subscription.bind(t,n),this}};class One extends PF{whisper(t,n){return this.pusher.channels.channels[this.name].trigger(`client-${t}`,n),this}}class nBe extends PF{whisper(t,n){return this.pusher.channels.channels[this.name].trigger(`client-${t}`,n),this}}let rBe=class extends One{here(t){return this.on("pusher:subscription_succeeded",n=>{t(Object.keys(n.members).map(r=>n.members[r]))}),this}joining(t){return this.on("pusher:member_added",n=>{t(n.info)}),this}whisper(t,n){return this.pusher.channels.channels[this.name].trigger(`client-${t}`,n),this}leaving(t){return this.on("pusher:member_removed",n=>{t(n.info)}),this}};class Dne extends NF{constructor(t,n,r){super(),this.events={},this.listeners={},this.name=n,this.socket=t,this.options=r,this.eventFormatter=new Rne(this.options.namespace),this.subscribe()}subscribe(){this.socket.emit("subscribe",{channel:this.name,auth:this.options.auth||{}})}unsubscribe(){this.unbind(),this.socket.emit("unsubscribe",{channel:this.name,auth:this.options.auth||{}})}listen(t,n){return this.on(this.eventFormatter.format(t),n),this}stopListening(t,n){return this.unbindEvent(this.eventFormatter.format(t),n),this}subscribed(t){return this.on("connect",n=>{t(n)}),this}error(t){return this}on(t,n){return this.listeners[t]=this.listeners[t]||[],this.events[t]||(this.events[t]=(r,c)=>{this.name===r&&this.listeners[t]&&this.listeners[t].forEach(f=>f(c))},this.socket.on(t,this.events[t])),this.listeners[t].push(n),this}unbind(){Object.keys(this.events).forEach(t=>{this.unbindEvent(t)})}unbindEvent(t,n){this.listeners[t]=this.listeners[t]||[],n&&(this.listeners[t]=this.listeners[t].filter(r=>r!==n)),(!n||this.listeners[t].length===0)&&(this.events[t]&&(this.socket.removeListener(t,this.events[t]),delete this.events[t]),delete this.listeners[t])}}class kne extends Dne{whisper(t,n){return this.socket.emit("client event",{channel:this.name,event:`client-${t}`,data:n}),this}}let iBe=class extends kne{here(t){return this.on("presence:subscribed",n=>{t(n.map(r=>r.user_info))}),this}joining(t){return this.on("presence:joining",n=>t(n.user_info)),this}whisper(t,n){return this.socket.emit("client event",{channel:this.name,event:`client-${t}`,data:n}),this}leaving(t){return this.on("presence:leaving",n=>t(n.user_info)),this}};class yE extends NF{subscribe(){}unsubscribe(){}listen(t,n){return this}listenToAll(t){return this}stopListening(t,n){return this}subscribed(t){return this}error(t){return this}on(t,n){return this}}let Ine=class extends yE{whisper(t,n){return this}},sBe=class extends yE{whisper(t,n){return this}};class aBe extends Ine{here(t){return this}joining(t){return this}whisper(t,n){return this}leaving(t){return this}}const Lne=class zne{constructor(t){this.setOptions(t),this.connect()}setOptions(t){this.options={...zne._defaultOptions,...t,broadcaster:t.broadcaster};let n=this.csrfToken();n&&(this.options.auth.headers["X-CSRF-TOKEN"]=n,this.options.userAuthentication.headers["X-CSRF-TOKEN"]=n),n=this.options.bearerToken,n&&(this.options.auth.headers.Authorization="Bearer "+n,this.options.userAuthentication.headers.Authorization="Bearer "+n)}csrfToken(){var t,n;return typeof window<"u"&&(t=window.Laravel)!=null&&t.csrfToken?window.Laravel.csrfToken:this.options.csrfToken?this.options.csrfToken:typeof document<"u"&&typeof document.querySelector=="function"?((n=document.querySelector('meta[name="csrf-token"]'))==null?void 0:n.getAttribute("content"))??null:null}};Lne._defaultOptions={auth:{headers:{}},authEndpoint:"/broadcasting/auth",userAuthentication:{endpoint:"/broadcasting/user-auth",headers:{}},csrfToken:null,bearerToken:null,host:null,key:null,namespace:"App.Events"};let MF=Lne;class bA extends MF{constructor(){super(...arguments),this.channels={}}connect(){if(typeof this.options.client<"u")this.pusher=this.options.client;else if(this.options.Pusher)this.pusher=new this.options.Pusher(this.options.key,this.options);else if(typeof window<"u"&&typeof window.Pusher<"u")this.pusher=new window.Pusher(this.options.key,this.options);else throw new Error("Pusher client not found. Should be globally available or passed via options.client")}signin(){this.pusher.signin()}listen(t,n,r){return this.channel(t).listen(n,r)}channel(t){return this.channels[t]||(this.channels[t]=new PF(this.pusher,t,this.options)),this.channels[t]}privateChannel(t){return this.channels["private-"+t]||(this.channels["private-"+t]=new One(this.pusher,"private-"+t,this.options)),this.channels["private-"+t]}encryptedPrivateChannel(t){return this.channels["private-encrypted-"+t]||(this.channels["private-encrypted-"+t]=new nBe(this.pusher,"private-encrypted-"+t,this.options)),this.channels["private-encrypted-"+t]}presenceChannel(t){return this.channels["presence-"+t]||(this.channels["presence-"+t]=new rBe(this.pusher,"presence-"+t,this.options)),this.channels["presence-"+t]}leave(t){[t,"private-"+t,"private-encrypted-"+t,"presence-"+t].forEach(n=>{this.leaveChannel(n)})}leaveChannel(t){this.channels[t]&&(this.channels[t].unsubscribe(),delete this.channels[t])}socketId(){return this.pusher.connection.socket_id}disconnect(){this.pusher.disconnect()}}let oBe=class extends MF{constructor(){super(...arguments),this.channels={}}connect(){let t=this.getSocketIO();this.socket=t(this.options.host??void 0,this.options),this.socket.io.on("reconnect",()=>{Object.values(this.channels).forEach(n=>{n.subscribe()})})}getSocketIO(){if(typeof this.options.client<"u")return this.options.client;if(typeof window<"u"&&typeof window.io<"u")return window.io;throw new Error("Socket.io client not found. Should be globally available or passed via options.client")}listen(t,n,r){return this.channel(t).listen(n,r)}channel(t){return this.channels[t]||(this.channels[t]=new Dne(this.socket,t,this.options)),this.channels[t]}privateChannel(t){return this.channels["private-"+t]||(this.channels["private-"+t]=new kne(this.socket,"private-"+t,this.options)),this.channels["private-"+t]}presenceChannel(t){return this.channels["presence-"+t]||(this.channels["presence-"+t]=new iBe(this.socket,"presence-"+t,this.options)),this.channels["presence-"+t]}leave(t){[t,"private-"+t,"presence-"+t].forEach(n=>{this.leaveChannel(n)})}leaveChannel(t){this.channels[t]&&(this.channels[t].unsubscribe(),delete this.channels[t])}socketId(){return this.socket.id}disconnect(){this.socket.disconnect()}};class T9 extends MF{constructor(){super(...arguments),this.channels={}}connect(){}listen(t,n,r){return new yE}channel(t){return new yE}privateChannel(t){return new Ine}encryptedPrivateChannel(t){return new sBe}presenceChannel(t){return new aBe}leave(t){}leaveChannel(t){}socketId(){return"fake-socket-id"}disconnect(){}}class lBe{constructor(t){this.options=t,this.connect(),this.options.withoutInterceptors||this.registerInterceptors()}channel(t){return this.connector.channel(t)}connect(){if(this.options.broadcaster==="reverb")this.connector=new bA({...this.options,cluster:""});else if(this.options.broadcaster==="pusher")this.connector=new bA(this.options);else if(this.options.broadcaster==="ably")this.connector=new bA({...this.options,cluster:"",broadcaster:"pusher"});else if(this.options.broadcaster==="socket.io")this.connector=new oBe(this.options);else if(this.options.broadcaster==="null")this.connector=new T9(this.options);else if(typeof this.options.broadcaster=="function"&&tBe(this.options.broadcaster))this.connector=new this.options.broadcaster(this.options);else throw new Error(`Broadcaster ${typeof this.options.broadcaster} ${String(this.options.broadcaster)} is not supported.`)}disconnect(){this.connector.disconnect()}join(t){return this.connector.presenceChannel(t)}leave(t){this.connector.leave(t)}leaveChannel(t){this.connector.leaveChannel(t)}leaveAllChannels(){for(const t in this.connector.channels)this.leaveChannel(t)}listen(t,n,r){return this.connector.listen(t,n,r)}private(t){return this.connector.privateChannel(t)}encryptedPrivate(t){if(this.connectorSupportsEncryptedPrivateChannels(this.connector))return this.connector.encryptedPrivateChannel(t);throw new Error(`Broadcaster ${typeof this.options.broadcaster} ${String(this.options.broadcaster)} does not support encrypted private channels.`)}connectorSupportsEncryptedPrivateChannels(t){return t instanceof bA||t instanceof T9}socketId(){return this.connector.socketId()}registerInterceptors(){typeof Vue<"u"&&Vue!=null&&Vue.http&&this.registerVueRequestInterceptor(),typeof axios=="function"&&this.registerAxiosRequestInterceptor(),typeof jQuery=="function"&&this.registerjQueryAjaxSetup(),typeof Turbo=="object"&&this.registerTurboRequestInterceptor()}registerVueRequestInterceptor(){Vue.http.interceptors.push((t,n)=>{this.socketId()&&t.headers.set("X-Socket-ID",this.socketId()),n()})}registerAxiosRequestInterceptor(){axios.interceptors.request.use(t=>(this.socketId()&&(t.headers["X-Socket-Id"]=this.socketId()),t))}registerjQueryAjaxSetup(){typeof jQuery.ajax<"u"&&jQuery.ajaxPrefilter((t,n,r)=>{this.socketId()&&r.setRequestHeader("X-Socket-Id",this.socketId())})}registerTurboRequestInterceptor(){document.addEventListener("turbo:before-fetch-request",t=>{t.detail.fetchOptions.headers["X-Socket-Id"]=this.socketId()})}}let I0=null,k1=null;const cBe=()=>{if(I0)return I0;if(!k1)throw new Error("Echo has not been configured. Please call `configureEcho()`.");return k1.Pusher??(k1.Pusher=eBe),I0=new lBe(k1),I0},Fne=e=>{k1={...{reverb:{broadcaster:"reverb",key:void 0,wsHost:void 0,wsPort:void 0,wssPort:void 0,forceTLS:!0,enabledTransports:["ws","wss"]},pusher:{broadcaster:"pusher",key:void 0,cluster:void 0,forceTLS:!0,wsHost:void 0,wsPort:void 0,wssPort:void 0,enabledTransports:["ws","wss"]},"socket.io":{broadcaster:"socket.io",host:void 0},null:{broadcaster:"null"},ably:{broadcaster:"pusher",key:void 0,wsHost:"realtime-pusher.ably.io",wsPort:443,disableStats:!0,encrypted:!0}}[e.broadcaster],...e},I0&&(I0=null)},qL=()=>cBe(),uBe=e=>Array.isArray(e)?e:[e],Jy={},dBe=e=>{const t=qL();return e.visibility==="presence"?t.join(e.name):e.visibility==="private"?t.private(e.name):t.channel(e.name)},hBe=(e,t)=>{Jy[e.id]&&(Jy[e.id].count-=1,!(Jy[e.id].count>0)&&(t?qL().leave(e.name):qL().leaveChannel(e.id),delete Jy[e.id]))},A9=e=>{if(Jy[e.id])return Jy[e.id].count+=1,Jy[e.id].connection;const t=dBe(e);return Jy[e.id]={count:1,connection:t},t},fBe=(e,t=[],n=()=>{},r=[],c="private")=>{const f={name:e,id:["private","presence"].includes(c)?`${c}-${e}`:e,visibility:c},p=z.useCallback(n,r),s=z.useRef(!1),w=z.useRef(!1),T=z.useRef(A9(f)),E=uBe(t),N=z.useCallback(()=>{s.current&&(E.forEach($=>{T.current.stopListening($,p)}),s.current=!1)},r),D=z.useCallback(()=>{s.current||(E.forEach($=>{T.current.listen($,p)}),s.current=!0)},r),V=z.useCallback(($=!1)=>{N(),hBe(f,$)},r);return z.useEffect(()=>(w.current&&(T.current=A9(f)),w.current=!0,D(),V),r),{leaveChannel:V,leave:()=>V(!0),stopListening:N,listen:D,channel:()=>T.current}},Kb=(e,t=[],n=()=>{},r=[])=>fBe(e,t,n,r,"public"),Qa={broadcast:{config:()=>Fne({broadcaster:"ably",key:"P4gHEA.Cx6WMg"})},dashboard:{index:()=>Ho.get("/api/dashboard")},vehicles:{all:(e={})=>Ho.get("/api/vehicles/all",{params:e}),list:(e={})=>Ho.get("/api/vehicles",{params:e}),details:(e={})=>Ho.get("/api/vehicles/details",{params:e}),register:e=>Ho.post("/api/vehicles/register",e),update:e=>Ho.put("/api/vehicles/change",e),updateStatus:e=>Ho.put("/api/vehicles/change/status",e),changeImage:e=>Ho.post("/api/vehicles/change/image",e,{headers:{"Content-Type":"multipart/form-data"}})},vdocuments:{get:(e={})=>Ho.get("/api/vdocuments/get",{params:e}),upload:e=>Ho.post("/api/vdocuments/upload",e,{headers:{"Content-Type":"multipart/form-data"}})},reservations:{list:(e={})=>Ho.get("/api/reserve",{params:e}),details:e=>Ho.post("/api/reserve/details",e),submit:e=>Ho.post("/api/reserve/submit",e),costDetails:e=>Ho.get("/api/reserve/details/cost",{params:{id:e}}),approve:e=>Ho.put("/api/reserve/approve",e),reject:e=>Ho.put("/api/reserve/cancel",e)},drivers:{list:(e={})=>Ho.get("/api/drivers",{params:e}),getDrivers:()=>Ho.get("/api/drivers/getDrivers"),dialogDrivers:(e={})=>Ho.get("/api/drivers/dialogDrivers",{params:e}),driverDetails:(e={})=>Ho.get("/api/drivers/details",{params:e})},dispatches:{list:(e={})=>Ho.get("/api/dispatches",{params:e}),details:(e={})=>Ho.get("/api/dispatches/details",{params:e}),start:e=>Ho.post("/api/dispatches/start",{id:e})}};function Bne(e,t,n="id",r=!0){const c=e.findIndex(f=>f[n]===t[n]);if(c!==-1){if(r){const f=[...e];return f[c]={...f[c],...t},f}return e.map(f=>f[n]===t[n]?t:f)}return console.log(e),[t,...e]}function pBe(){const[e,t]=z.useState(),[n,r]=z.useState(),c=z.useCallback(()=>{r(!0),Qa.dashboard.index().then(f=>{console.log(f),t(f.data)}).catch(f=>{console.error("Error fetching dashboard data:",f)}).finally(()=>{r(!1)})},[]);return z.useEffect(()=>{c()},[c]),o.jsxs(ju.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex flex-col gap-3 h-full",children:[o.jsxs("div",{className:"mb-2",children:[o.jsx("h1",{className:"text-1xl font-bold",children:"JOLI Travel and Tours"}),o.jsx("h2",{className:"text-3xl font-medium",children:"Logistics 2 - Fleet Management"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 h-full w-full",children:[o.jsx("div",{className:"col-span-1 md:col-span-2 lg:col-span-4",children:o.jsxs(ni,{className:"rounded-md",children:[o.jsxs(Ns,{children:[o.jsx(us,{className:"text-3xl",children:"Reservation Trend"}),o.jsx(Nc,{children:"Last 30 days"})]}),o.jsx(qi,{className:" p-4 h-64",children:o.jsx(KFe,{data:e?.reservation_trends})})]})}),o.jsxs(ni,{className:"rounded-md h-full min-h-40 col-span-1",children:[o.jsxs(Ns,{children:[o.jsx(us,{className:"text-2xl",children:"Ongoing Dispatches"}),o.jsx(Nc,{})]}),o.jsx(qi,{children:e?.ongoing_dispatches?.length>0?o.jsx("div",{className:"flex flex-col",children:e?.ongoing_dispatches?.map((f,p)=>o.jsxs(o.Fragment,{children:[o.jsx(Yl,{to:`/logisticsII/dispatch/${f?.batch_number}`,className:"p-2",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{children:f?.driver}),o.jsx("span",{children:f?.status})]})},p),o.jsx(Oc,{})]}))}):o.jsx("div",{className:"p-2 text-muted-foreground",children:"No ongoing dispatches"})})]}),o.jsxs(ni,{className:"rounded-md h-full min-h-40 col-span-1",children:[o.jsxs(Ns,{children:[o.jsx(us,{className:"text-2xl",children:"Expiring Documents"}),o.jsx(Nc,{})]}),o.jsx(qi,{children:e?.document_expirations?.length>0?o.jsx("div",{className:"flex flex-col",children:e?.document_expirations?.map((f,p)=>o.jsx("div",{className:"p-2 border-b",children:o.jsxs(Yl,{to:`/logisticsII/vehicles/${f?.uuid}`,className:"flex justify-between items-center",children:[o.jsx("span",{children:f?.document_name}),o.jsx("span",{children:f?.expiry_date})]})},p))}):o.jsx("div",{className:"p-2 text-muted-foreground",children:"No expiring documents"})})]}),o.jsxs(ni,{className:"rounded-md h-full min-h-40 col-span-1",children:[o.jsxs(Ns,{children:[o.jsx(us,{className:"text-2xl",children:"Driver Updates"}),o.jsx(Nc,{})]}),o.jsx(qi,{})]}),o.jsxs(ni,{className:"rounded-md h-full min-h-40 col-span-1",children:[o.jsxs(Ns,{children:[o.jsx(us,{className:"text-2xl",children:"Vehicle Updates"}),o.jsx(Nc,{})]}),o.jsx(qi,{})]})]})]})}var nN="Popover",[Une,j$e]=Eu(nN,[uv]),RT=uv(),[mBe,bv]=Une(nN),Vne=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:c,onOpenChange:f,modal:p=!1}=e,s=RT(t),w=z.useRef(null),[T,E]=z.useState(!1),[N,D]=zf({prop:r,defaultProp:c??!1,onChange:f,caller:nN});return o.jsx(KE,{...s,children:o.jsx(mBe,{scope:t,contentId:Ml(),triggerRef:w,open:N,onOpenChange:D,onOpenToggle:z.useCallback(()=>D(V=>!V),[D]),hasCustomAnchor:T,onCustomAnchorAdd:z.useCallback(()=>E(!0),[]),onCustomAnchorRemove:z.useCallback(()=>E(!1),[]),modal:p,children:n})})};Vne.displayName=nN;var $ne="PopoverAnchor",gBe=z.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,c=bv($ne,n),f=RT(n),{onCustomAnchorAdd:p,onCustomAnchorRemove:s}=c;return z.useEffect(()=>(p(),()=>s()),[p,s]),o.jsx(lT,{...f,...r,ref:t})});gBe.displayName=$ne;var qne="PopoverTrigger",Hne=z.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,c=bv(qne,n),f=RT(n),p=fa(t,c.triggerRef),s=o.jsx(Si.button,{type:"button","aria-haspopup":"dialog","aria-expanded":c.open,"aria-controls":c.contentId,"data-state":Yne(c.open),...r,ref:p,onClick:Yr(e.onClick,c.onOpenToggle)});return c.hasCustomAnchor?s:o.jsx(lT,{asChild:!0,...f,children:s})});Hne.displayName=qne;var RF="PopoverPortal",[yBe,vBe]=Une(RF,{forceMount:void 0}),Gne=e=>{const{__scopePopover:t,forceMount:n,children:r,container:c}=e,f=bv(RF,t);return o.jsx(yBe,{scope:t,forceMount:n,children:o.jsx(nd,{present:n||f.open,children:o.jsx(kb,{asChild:!0,container:c,children:r})})})};Gne.displayName=RF;var Ab="PopoverContent",Wne=z.forwardRef((e,t)=>{const n=vBe(Ab,e.__scopePopover),{forceMount:r=n.forceMount,...c}=e,f=bv(Ab,e.__scopePopover);return o.jsx(nd,{present:r||f.open,children:f.modal?o.jsx(_Be,{...c,ref:t}):o.jsx(bBe,{...c,ref:t})})});Wne.displayName=Ab;var xBe=nv("PopoverContent.RemoveScroll"),_Be=z.forwardRef((e,t)=>{const n=bv(Ab,e.__scopePopover),r=z.useRef(null),c=fa(t,r),f=z.useRef(!1);return z.useEffect(()=>{const p=r.current;if(p)return VE(p)},[]),o.jsx(sT,{as:xBe,allowPinchZoom:!0,children:o.jsx(Xne,{...e,ref:c,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Yr(e.onCloseAutoFocus,p=>{p.preventDefault(),f.current||n.triggerRef.current?.focus()}),onPointerDownOutside:Yr(e.onPointerDownOutside,p=>{const s=p.detail.originalEvent,w=s.button===0&&s.ctrlKey===!0,T=s.button===2||w;f.current=T},{checkForDefaultPrevented:!1}),onFocusOutside:Yr(e.onFocusOutside,p=>p.preventDefault(),{checkForDefaultPrevented:!1})})})}),bBe=z.forwardRef((e,t)=>{const n=bv(Ab,e.__scopePopover),r=z.useRef(!1),c=z.useRef(!1);return o.jsx(Xne,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:f=>{e.onCloseAutoFocus?.(f),f.defaultPrevented||(r.current||n.triggerRef.current?.focus(),f.preventDefault()),r.current=!1,c.current=!1},onInteractOutside:f=>{e.onInteractOutside?.(f),f.defaultPrevented||(r.current=!0,f.detail.originalEvent.type==="pointerdown"&&(c.current=!0));const p=f.target;n.triggerRef.current?.contains(p)&&f.preventDefault(),f.detail.originalEvent.type==="focusin"&&c.current&&f.preventDefault()}})}),Xne=z.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:c,onCloseAutoFocus:f,disableOutsidePointerEvents:p,onEscapeKeyDown:s,onPointerDownOutside:w,onFocusOutside:T,onInteractOutside:E,...N}=e,D=bv(Ab,n),V=RT(n);return BE(),o.jsx(iT,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:c,onUnmountAutoFocus:f,children:o.jsx(Db,{asChild:!0,disableOutsidePointerEvents:p,onInteractOutside:E,onEscapeKeyDown:s,onPointerDownOutside:w,onFocusOutside:T,onDismiss:()=>D.onOpenChange(!1),children:o.jsx(JE,{"data-state":Yne(D.open),role:"dialog",id:D.contentId,...V,...N,ref:t,style:{...N.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Zne="PopoverClose",wBe=z.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,c=bv(Zne,n);return o.jsx(Si.button,{type:"button",...r,ref:t,onClick:Yr(e.onClick,()=>c.onOpenChange(!1))})});wBe.displayName=Zne;var SBe="PopoverArrow",TBe=z.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,c=RT(n);return o.jsx(QE,{...c,...r,ref:t})});TBe.displayName=SBe;function Yne(e){return e?"open":"closed"}var ABe=Vne,jBe=Hne,EBe=Gne,CBe=Wne;function OT({...e}){return o.jsx(ABe,{"data-slot":"popover",...e})}function DT({...e}){return o.jsx(jBe,{"data-slot":"popover-trigger",...e})}function kT({className:e,align:t="center",sideOffset:n=4,...r}){return o.jsx(EBe,{children:o.jsx(CBe,{"data-slot":"popover-content",align:t,sideOffset:n,className:Rn("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...r})})}var j9=1,NBe=.9,PBe=.8,MBe=.17,uk=.1,dk=.999,RBe=.9999,OBe=.99,DBe=/[\\\/_+.#"@\[\(\{&]/,kBe=/[\\\/_+.#"@\[\(\{&]/g,IBe=/[\s-]/,Kne=/[\s-]/g;function HL(e,t,n,r,c,f,p){if(f===t.length)return c===e.length?j9:OBe;var s=`${c},${f}`;if(p[s]!==void 0)return p[s];for(var w=r.charAt(f),T=n.indexOf(w,c),E=0,N,D,V,$;T>=0;)N=HL(e,t,n,r,T+1,f+1,p),N>E&&(T===c?N*=j9:DBe.test(e.charAt(T-1))?(N*=PBe,V=e.slice(c,T-1).match(kBe),V&&c>0&&(N*=Math.pow(dk,V.length))):IBe.test(e.charAt(T-1))?(N*=NBe,$=e.slice(c,T-1).match(Kne),$&&c>0&&(N*=Math.pow(dk,$.length))):(N*=MBe,c>0&&(N*=Math.pow(dk,T-c))),e.charAt(T)!==t.charAt(f)&&(N*=RBe)),(N<uk&&n.charAt(T-1)===r.charAt(f+1)||r.charAt(f+1)===r.charAt(f)&&n.charAt(T-1)!==r.charAt(f))&&(D=HL(e,t,n,r,T+1,f+2,p),D*uk>N&&(N=D*uk)),N>E&&(E=N),T=n.indexOf(w,T+1);return p[s]=E,E}function E9(e){return e.toLowerCase().replace(Kne," ")}function LBe(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,HL(e,t,E9(e),E9(t),0,0,{})}var w1='[cmdk-group=""]',hk='[cmdk-group-items=""]',zBe='[cmdk-group-heading=""]',Jne='[cmdk-item=""]',C9=`${Jne}:not([aria-disabled="true"])`,GL="cmdk-item-select",w0="data-value",FBe=(e,t,n)=>LBe(e,t,n),Qne=z.createContext(void 0),IT=()=>z.useContext(Qne),ere=z.createContext(void 0),OF=()=>z.useContext(ere),tre=z.createContext(void 0),nre=z.forwardRef((e,t)=>{let n=S0(()=>{var We,Je;return{search:"",value:(Je=(We=e.value)!=null?We:e.defaultValue)!=null?Je:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=S0(()=>new Set),c=S0(()=>new Map),f=S0(()=>new Map),p=S0(()=>new Set),s=rre(e),{label:w,children:T,value:E,onValueChange:N,filter:D,shouldFilter:V,loop:$,disablePointerSelection:B=!1,vimBindings:F=!0,...K}=e,Y=Ml(),X=Ml(),ae=Ml(),Z=z.useRef(null),se=YBe();u_(()=>{if(E!==void 0){let We=E.trim();n.current.value=We,he.emit()}},[E]),u_(()=>{se(6,nt)},[]);let he=z.useMemo(()=>({subscribe:We=>(p.current.add(We),()=>p.current.delete(We)),snapshot:()=>n.current,setState:(We,Je,jt)=>{var Pt,Ot,Mt,an;if(!Object.is(n.current[We],Je)){if(n.current[We]=Je,We==="search")$e(),Ve(),se(1,Re);else if(We==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let Jt=document.getElementById(ae);Jt?Jt.focus():(Pt=document.getElementById(Y))==null||Pt.focus()}if(se(7,()=>{var Jt;n.current.selectedItemId=(Jt=Me())==null?void 0:Jt.id,he.emit()}),jt||se(5,nt),((Ot=s.current)==null?void 0:Ot.value)!==void 0){let Jt=Je??"";(an=(Mt=s.current).onValueChange)==null||an.call(Mt,Jt);return}}he.emit()}},emit:()=>{p.current.forEach(We=>We())}}),[]),ye=z.useMemo(()=>({value:(We,Je,jt)=>{var Pt;Je!==((Pt=f.current.get(We))==null?void 0:Pt.value)&&(f.current.set(We,{value:Je,keywords:jt}),n.current.filtered.items.set(We,Ce(Je,jt)),se(2,()=>{Ve(),he.emit()}))},item:(We,Je)=>(r.current.add(We),Je&&(c.current.has(Je)?c.current.get(Je).add(We):c.current.set(Je,new Set([We]))),se(3,()=>{$e(),Ve(),n.current.value||Re(),he.emit()}),()=>{f.current.delete(We),r.current.delete(We),n.current.filtered.items.delete(We);let jt=Me();se(4,()=>{$e(),jt?.getAttribute("id")===We&&Re(),he.emit()})}),group:We=>(c.current.has(We)||c.current.set(We,new Set),()=>{f.current.delete(We),c.current.delete(We)}),filter:()=>s.current.shouldFilter,label:w||e["aria-label"],getDisablePointerSelection:()=>s.current.disablePointerSelection,listId:Y,inputId:ae,labelId:X,listInnerRef:Z}),[]);function Ce(We,Je){var jt,Pt;let Ot=(Pt=(jt=s.current)==null?void 0:jt.filter)!=null?Pt:FBe;return We?Ot(We,n.current.search,Je):0}function Ve(){if(!n.current.search||s.current.shouldFilter===!1)return;let We=n.current.filtered.items,Je=[];n.current.filtered.groups.forEach(Pt=>{let Ot=c.current.get(Pt),Mt=0;Ot.forEach(an=>{let Jt=We.get(an);Mt=Math.max(Jt,Mt)}),Je.push([Pt,Mt])});let jt=Z.current;rt().sort((Pt,Ot)=>{var Mt,an;let Jt=Pt.getAttribute("id"),Cn=Ot.getAttribute("id");return((Mt=We.get(Cn))!=null?Mt:0)-((an=We.get(Jt))!=null?an:0)}).forEach(Pt=>{let Ot=Pt.closest(hk);Ot?Ot.appendChild(Pt.parentElement===Ot?Pt:Pt.closest(`${hk} > *`)):jt.appendChild(Pt.parentElement===jt?Pt:Pt.closest(`${hk} > *`))}),Je.sort((Pt,Ot)=>Ot[1]-Pt[1]).forEach(Pt=>{var Ot;let Mt=(Ot=Z.current)==null?void 0:Ot.querySelector(`${w1}[${w0}="${encodeURIComponent(Pt[0])}"]`);Mt?.parentElement.appendChild(Mt)})}function Re(){let We=rt().find(jt=>jt.getAttribute("aria-disabled")!=="true"),Je=We?.getAttribute(w0);he.setState("value",Je||void 0)}function $e(){var We,Je,jt,Pt;if(!n.current.search||s.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let Ot=0;for(let Mt of r.current){let an=(Je=(We=f.current.get(Mt))==null?void 0:We.value)!=null?Je:"",Jt=(Pt=(jt=f.current.get(Mt))==null?void 0:jt.keywords)!=null?Pt:[],Cn=Ce(an,Jt);n.current.filtered.items.set(Mt,Cn),Cn>0&&Ot++}for(let[Mt,an]of c.current)for(let Jt of an)if(n.current.filtered.items.get(Jt)>0){n.current.filtered.groups.add(Mt);break}n.current.filtered.count=Ot}function nt(){var We,Je,jt;let Pt=Me();Pt&&(((We=Pt.parentElement)==null?void 0:We.firstChild)===Pt&&((jt=(Je=Pt.closest(w1))==null?void 0:Je.querySelector(zBe))==null||jt.scrollIntoView({block:"nearest"})),Pt.scrollIntoView({block:"nearest"}))}function Me(){var We;return(We=Z.current)==null?void 0:We.querySelector(`${Jne}[aria-selected="true"]`)}function rt(){var We;return Array.from(((We=Z.current)==null?void 0:We.querySelectorAll(C9))||[])}function Ee(We){let Je=rt()[We];Je&&he.setState("value",Je.getAttribute(w0))}function it(We){var Je;let jt=Me(),Pt=rt(),Ot=Pt.findIndex(an=>an===jt),Mt=Pt[Ot+We];(Je=s.current)!=null&&Je.loop&&(Mt=Ot+We<0?Pt[Pt.length-1]:Ot+We===Pt.length?Pt[0]:Pt[Ot+We]),Mt&&he.setState("value",Mt.getAttribute(w0))}function et(We){let Je=Me(),jt=Je?.closest(w1),Pt;for(;jt&&!Pt;)jt=We>0?XBe(jt,w1):ZBe(jt,w1),Pt=jt?.querySelector(C9);Pt?he.setState("value",Pt.getAttribute(w0)):it(We)}let mt=()=>Ee(rt().length-1),He=We=>{We.preventDefault(),We.metaKey?mt():We.altKey?et(1):it(1)},pt=We=>{We.preventDefault(),We.metaKey?Ee(0):We.altKey?et(-1):it(-1)};return z.createElement(Si.div,{ref:t,tabIndex:-1,...K,"cmdk-root":"",onKeyDown:We=>{var Je;(Je=K.onKeyDown)==null||Je.call(K,We);let jt=We.nativeEvent.isComposing||We.keyCode===229;if(!(We.defaultPrevented||jt))switch(We.key){case"n":case"j":{F&&We.ctrlKey&&He(We);break}case"ArrowDown":{He(We);break}case"p":case"k":{F&&We.ctrlKey&&pt(We);break}case"ArrowUp":{pt(We);break}case"Home":{We.preventDefault(),Ee(0);break}case"End":{We.preventDefault(),mt();break}case"Enter":{We.preventDefault();let Pt=Me();if(Pt){let Ot=new Event(GL);Pt.dispatchEvent(Ot)}}}}},z.createElement("label",{"cmdk-label":"",htmlFor:ye.inputId,id:ye.labelId,style:JBe},w),rN(e,We=>z.createElement(ere.Provider,{value:he},z.createElement(Qne.Provider,{value:ye},We))))}),BBe=z.forwardRef((e,t)=>{var n,r;let c=Ml(),f=z.useRef(null),p=z.useContext(tre),s=IT(),w=rre(e),T=(r=(n=w.current)==null?void 0:n.forceMount)!=null?r:p?.forceMount;u_(()=>{if(!T)return s.item(c,p?.id)},[T]);let E=ire(c,f,[e.value,e.children,f],e.keywords),N=OF(),D=ov(se=>se.value&&se.value===E.current),V=ov(se=>T||s.filter()===!1?!0:se.search?se.filtered.items.get(c)>0:!0);z.useEffect(()=>{let se=f.current;if(!(!se||e.disabled))return se.addEventListener(GL,$),()=>se.removeEventListener(GL,$)},[V,e.onSelect,e.disabled]);function $(){var se,he;B(),(he=(se=w.current).onSelect)==null||he.call(se,E.current)}function B(){N.setState("value",E.current,!0)}if(!V)return null;let{disabled:F,value:K,onSelect:Y,forceMount:X,keywords:ae,...Z}=e;return z.createElement(Si.div,{ref:Ag(f,t),...Z,id:c,"cmdk-item":"",role:"option","aria-disabled":!!F,"aria-selected":!!D,"data-disabled":!!F,"data-selected":!!D,onPointerMove:F||s.getDisablePointerSelection()?void 0:B,onClick:F?void 0:$},e.children)}),UBe=z.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:c,...f}=e,p=Ml(),s=z.useRef(null),w=z.useRef(null),T=Ml(),E=IT(),N=ov(V=>c||E.filter()===!1?!0:V.search?V.filtered.groups.has(p):!0);u_(()=>E.group(p),[]),ire(p,s,[e.value,e.heading,w]);let D=z.useMemo(()=>({id:p,forceMount:c}),[c]);return z.createElement(Si.div,{ref:Ag(s,t),...f,"cmdk-group":"",role:"presentation",hidden:N?void 0:!0},n&&z.createElement("div",{ref:w,"cmdk-group-heading":"","aria-hidden":!0,id:T},n),rN(e,V=>z.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?T:void 0},z.createElement(tre.Provider,{value:D},V))))}),VBe=z.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,c=z.useRef(null),f=ov(p=>!p.search);return!n&&!f?null:z.createElement(Si.div,{ref:Ag(c,t),...r,"cmdk-separator":"",role:"separator"})}),$Be=z.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,c=e.value!=null,f=OF(),p=ov(T=>T.search),s=ov(T=>T.selectedItemId),w=IT();return z.useEffect(()=>{e.value!=null&&f.setState("search",e.value)},[e.value]),z.createElement(Si.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":w.listId,"aria-labelledby":w.labelId,"aria-activedescendant":s,id:w.inputId,type:"text",value:c?e.value:p,onChange:T=>{c||f.setState("search",T.target.value),n?.(T.target.value)}})}),qBe=z.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...c}=e,f=z.useRef(null),p=z.useRef(null),s=ov(T=>T.selectedItemId),w=IT();return z.useEffect(()=>{if(p.current&&f.current){let T=p.current,E=f.current,N,D=new ResizeObserver(()=>{N=requestAnimationFrame(()=>{let V=T.offsetHeight;E.style.setProperty("--cmdk-list-height",V.toFixed(1)+"px")})});return D.observe(T),()=>{cancelAnimationFrame(N),D.unobserve(T)}}},[]),z.createElement(Si.div,{ref:Ag(f,t),...c,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":s,"aria-label":r,id:w.listId},rN(e,T=>z.createElement("div",{ref:Ag(p,w.listInnerRef),"cmdk-list-sizer":""},T)))}),HBe=z.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:c,contentClassName:f,container:p,...s}=e;return z.createElement(qE,{open:n,onOpenChange:r},z.createElement(HE,{container:p},z.createElement(GE,{"cmdk-overlay":"",className:c}),z.createElement(WE,{"aria-label":e.label,"cmdk-dialog":"",className:f},z.createElement(nre,{ref:t,...s}))))}),GBe=z.forwardRef((e,t)=>ov(n=>n.filtered.count===0)?z.createElement(Si.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),WBe=z.forwardRef((e,t)=>{let{progress:n,children:r,label:c="Loading...",...f}=e;return z.createElement(Si.div,{ref:t,...f,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":c},rN(e,p=>z.createElement("div",{"aria-hidden":!0},p)))}),Jb=Object.assign(nre,{List:qBe,Item:BBe,Input:$Be,Group:UBe,Separator:VBe,Dialog:HBe,Empty:GBe,Loading:WBe});function XBe(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function ZBe(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function rre(e){let t=z.useRef(e);return u_(()=>{t.current=e}),t}var u_=typeof window>"u"?z.useEffect:z.useLayoutEffect;function S0(e){let t=z.useRef();return t.current===void 0&&(t.current=e()),t}function ov(e){let t=OF(),n=()=>e(t.snapshot());return z.useSyncExternalStore(t.subscribe,n,n)}function ire(e,t,n,r=[]){let c=z.useRef(),f=IT();return u_(()=>{var p;let s=(()=>{var T;for(let E of n){if(typeof E=="string")return E.trim();if(typeof E=="object"&&"current"in E)return E.current?(T=E.current.textContent)==null?void 0:T.trim():c.current}})(),w=r.map(T=>T.trim());f.value(e,s,w),(p=t.current)==null||p.setAttribute(w0,s),c.current=s}),c}var YBe=()=>{let[e,t]=z.useState(),n=S0(()=>new Map);return u_(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,c)=>{n.current.set(r,c),t({})}};function KBe(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function rN({asChild:e,children:t},n){return e&&z.isValidElement(t)?z.cloneElement(KBe(t),{ref:t.ref},n(t.props.children)):n(t)}var JBe={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function DF({className:e,...t}){return o.jsx(Jb,{"data-slot":"command",className:Rn("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...t})}function kF({className:e,...t}){return o.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[o.jsx(nT,{className:"size-4 shrink-0 opacity-50"}),o.jsx(Jb.Input,{"data-slot":"command-input",className:Rn("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...t})]})}function IF({className:e,...t}){return o.jsx(Jb.List,{"data-slot":"command-list",className:Rn("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...t})}function LF({...e}){return o.jsx(Jb.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function zF({className:e,...t}){return o.jsx(Jb.Group,{"data-slot":"command-group",className:Rn("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...t})}function FF({className:e,...t}){return o.jsx(Jb.Item,{"data-slot":"command-item",className:Rn("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function sre({value:e,onChange:t,startYear:n,endYear:r,descending:c=!0,placeholder:f="Select year",className:p,defaultValue:s,disabled:w}){const[T,E]=z.useState(!1),N=new Date().getFullYear(),D=n??1800,V=r??N,$=z.useMemo(()=>{const F=[];for(let K=D;K<=V;K++)F.push(K);return c?F.reverse():F},[D,V,c]),B=e??s??f;return o.jsxs(OT,{open:T,onOpenChange:E,children:[o.jsx(DT,{asChild:!0,children:o.jsxs(kt,{variant:"outline",role:"combobox","aria-expanded":T,className:Rn(p,"w-full justify-between"),disabled:w,children:[B,o.jsx(zE,{className:"ml-2 h-4 w-4 opacity-50"})]})}),o.jsx(kT,{className:"p-0",onWheel:F=>F.stopPropagation(),children:o.jsxs(DF,{children:[o.jsx(kF,{placeholder:"Search year..."}),o.jsxs(IF,{className:"max-h-[200px] overflow-y-scroll",children:[o.jsx(LF,{children:"No year found."}),o.jsx(zF,{children:$.map(F=>o.jsxs(FF,{value:F.toString(),onSelect:()=>{t?.(F),E(!1)},children:[o.jsx(IE,{className:Rn("mr-2 h-4 w-4",e===F?"opacity-100":"opacity-0")}),F]},F))})]})]})})]})}function N9({}){const{register:e,handleSubmit:t,control:n,reset:r,formState:{errors:c,isSubmitting:f}}=dv({}),[p,s]=z.useState(!1),w=async T=>{const E=new FormData;Object.entries(T).forEach(([N,D])=>{N!=="image"&&E.append(N,D??"")}),T.image?.[0]&&E.append("image",T.image[0]);try{const N=await Qa.vehicles.register(E,{headers:{"Content-Type":"multipart/form-data"}});N.status===200&&(s(!1),r(),Zt.success(N.data.message??"Vehicle registered successfully!",{position:"top-center"}))}catch(N){console.log(N),N.response?.status===422?Zt.error(N.response.data.message||"Validation error",{position:"top-center"}):N.response?.status===500?Zt.error("Server Error",{position:"top-center"}):Zt.error("Network error",{position:"top-center"})}};return o.jsxs(ds,{open:p,onOpenChange:s,children:[o.jsx(kf,{asChild:!0,children:o.jsx(kt,{onClick:()=>s(!0),children:"Register"})}),o.jsx(gs,{className:"sm:max-w-[425px]",children:o.jsxs("form",{onSubmit:t(w),children:[o.jsxs(ys,{className:"mb-3",children:[o.jsx(vs,{children:"Register Vehicle"}),o.jsx(Cc,{children:"Fill all the fields, click register when you're done."})]}),o.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(bt,{children:"Vehicle Identification Number (VIN)"}),c.vin&&o.jsx(Jc,{className:"text-red-500",children:c.vin.message})]}),o.jsx(On,{...e("vin",{required:"VIN is required!",minLength:{value:17,message:"VIN must contain 17 characters!"},maxLength:{value:17,message:"VIN must contain 17 characters!"}}),type:"text",className:c.vin?"border-red-500 focus-visible:ring-red-300":""})]}),o.jsxs("div",{className:"flex gap-2 mb-3",children:[o.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(bt,{children:"Brand"}),c.make&&o.jsx(Jc,{className:"text-red-500",children:c.make.message})]}),o.jsx(On,{...e("make",{required:"Brand is required!"}),type:"text",className:c.make?"border-red-500 focus-visible:ring-red-300":""})]}),o.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(bt,{children:"Model"}),c.model&&o.jsx(Jc,{className:"text-red-500",children:c.model.message})]}),o.jsx(On,{...e("model",{required:"Model is required!"}),type:"text",className:c.model?"border-red-500 focus-visible:ring-red-300":""})]})]}),o.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(bt,{children:"Year"}),c.year&&o.jsx(Jc,{className:"text-red-500",children:c.year.message})]}),o.jsx(Qx,{name:"year",control:n,rules:{required:"Year is required!"},render:({field:T})=>o.jsx(sre,{startYear:1980,value:T.value,onChange:E=>T.onChange(E),className:c.year?"border-red-500 focus-visible:ring-red-300":""})})]}),o.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(bt,{children:"Type"}),c.type&&o.jsx(Jc,{className:"text-red-500",children:c.type.message})]}),o.jsx(On,{...e("type",{rules:{required:"Type is required!"}})})]}),o.jsxs("div",{className:"flex gap-2 mb-3",children:[o.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[o.jsx(bt,{children:"Height (m)"}),o.jsx(On,{...e("height",{required:"Height is required!",valueAsNumber:!0,min:{value:.5,message:"Too small"},max:{value:10,message:"Too large"}}),type:"number",step:"0.01",placeholder:"e.g. 1.75",className:c.height?"border-red-500 focus-visible:ring-red-300":""})]}),o.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[o.jsx(bt,{children:"Width (m)"}),o.jsx(On,{...e("width",{required:"Width is required!",valueAsNumber:!0,min:{value:.5,message:"Too small"},max:{value:5,message:"Too large"}}),type:"number",step:"0.01",placeholder:"e.g. 1.85",className:c.width?"border-red-500 focus-visible:ring-red-300":""})]})]}),o.jsxs("div",{className:"flex gap-2 mb-3",children:[o.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(bt,{children:"Capacity (kg)"}),c.capacity&&o.jsx(Jc,{className:"text-red-500",children:c.capacity.message})]}),o.jsx(On,{...e("capacity",{required:"Capacity is required!"}),type:"number",placeholder:"Weight in kg",className:c.capacity?"border-red-500 focus-visible:ring-red-300":""})]}),o.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(bt,{children:"Seats"}),c.seats&&o.jsx(Jc,{className:"text-red-500",children:c.seats.message})]}),o.jsx(On,{...e("seats",{required:"Seats is required!"}),type:"number",placeholder:"Number of passenger seats",className:c.seats?"border-red-500 focus-visible:ring-red-300":""})]})]}),o.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(bt,{children:"Fuel Efficiency (L/100km)"}),c.fuel_efficiency&&o.jsx(Jc,{className:"text-red-500",children:c.fuel_efficiency.message})]}),o.jsx(On,{...e("fuel_efficiency",{required:"Fuel efficiency is required!"}),type:"number",step:"0.01",placeholder:"e.g. 2",className:c.fuel_efficiency?"border-red-500 focus-visible:ring-red-300":""})]}),o.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(bt,{children:"Vehicle Image (optional)"}),c.image&&o.jsx(Jc,{className:"text-red-500",children:c.image.message})]}),o.jsx(On,{...e("image"),type:"file",accept:"image/*",className:c.image?"border-red-500 focus-visible:ring-red-300":""})]}),o.jsxs(Co,{children:[o.jsx(hze,{asChild:!0,children:o.jsx(kt,{variant:"outline",children:"Cancel"})}),o.jsx(kt,{disabled:f,type:"submit",children:f?"Submitting...":"Register"})]})]})})]})}function QBe({className:e,...t}){return o.jsx("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:Rn("mx-auto flex w-full justify-center",e),...t})}function e4e({className:e,...t}){return o.jsx("ul",{"data-slot":"pagination-content",className:Rn("flex flex-row items-center gap-1",e),...t})}function fk({...e}){return o.jsx("li",{"data-slot":"pagination-item",...e})}function BF({className:e,isActive:t,size:n="icon",...r}){return o.jsx(Yl,{"aria-current":t?"page":void 0,"data-slot":"pagination-link","data-active":t,className:Rn(X0({variant:t?"outline":"ghost",size:n}),e),...r})}function t4e({className:e,...t}){return o.jsxs(BF,{"aria-label":"Go to previous page",size:"default",className:Rn("gap-1 px-2.5 sm:pl-2.5",e),...t,children:[o.jsx(WW,{}),o.jsx("span",{className:"hidden sm:block",children:"Previous"})]})}function n4e({className:e,...t}){return o.jsxs(BF,{"aria-label":"Go to next page",size:"default",className:Rn("gap-1 px-2.5 sm:pr-2.5",e),...t,children:[o.jsx("span",{className:"hidden sm:block",children:"Next"}),o.jsx(Mb,{})]})}function r4e({className:e,...t}){return o.jsxs("span",{"aria-hidden":!0,"data-slot":"pagination-ellipsis",className:Rn("flex size-9 items-center justify-center",e),...t,children:[o.jsx(jde,{className:"size-4"}),o.jsx("span",{className:"sr-only",children:"More pages"})]})}function i4e(e,t){const r=[],c=[];let f;for(let p=1;p<=t;p++)(p===1||p===t||p>=e-2&&p<=e+2)&&r.push(p);for(let p of r)f&&(p-f===2?c.push(f+1):p-f!==1&&c.push(o.jsx(r4e,{}))),c.push(p),f=p;return c}function iN({totalPage:e,page:t,setPage:n}){return o.jsx(QBe,{children:o.jsxs(e4e,{children:[o.jsx(fk,{children:o.jsx(t4e,{to:"#",onClick:r=>{r.preventDefault(),n(c=>Math.max(c-1,1))},"aria-disabled":t===1})}),i4e(t,e).map((r,c)=>o.jsx(fk,{children:r==="..."?o.jsx("span",{className:"px-2",children:"..."}):o.jsx(BF,{to:"#",onClick:f=>{f.preventDefault(),n(r)},isActive:t===r,children:r})},c)),o.jsx(fk,{children:o.jsx(n4e,{to:"#",onClick:r=>{r.preventDefault(),n(c=>Math.min(c+1,e))},"aria-disabled":t===e})})]})})}Qa.broadcast.config();function S1({setSearch:e,text:t}){return o.jsx(kt,{className:"rounded-full min-w-[100px]",variant:"outline",onClick:()=>{t=="All"?e(""):e(t)},children:t})}function s4e(){const[e,t]=z.useState([]),[n,r]=z.useState(1),[c,f]=z.useState(),[p,s]=z.useState(""),[w,T]=z.useState(!1),E=z.useCallback(()=>{Qa.vehicles.list({page:n,q:p||void 0}).then(N=>{let D=N.data.vehicles;console.log(D),t(D.data||[]),f(D.last_page)}).catch(N=>{w||(Zt.error("Error fetching vehicles"),T(!0))})},[n,p]);return z.useEffect(()=>{let N=setTimeout(E,300);return()=>{clearTimeout(N)}},[E]),Kb("vehicle_channel","VehicleEvents",N=>{t(D=>Bne(D,N.record,"uuid"))}),o.jsx(ju.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"h-full",children:o.jsxs("div",{className:"flex flex-col flex-2 h-full gap-2",children:[o.jsxs("div",{className:"flex-4/5",children:[o.jsxs("div",{className:"flex mb-3 gap-2",children:[o.jsx(On,{placeholder:"Search VIN, Status, Brand, and Model",value:p,onChange:N=>s(N.target.value)}),o.jsx(N9,{})]}),o.jsxs("div",{className:"flex gap-2 mb-3 overflow-x-auto",children:[o.jsx(S1,{setSearch:s,text:"All"}),o.jsx(S1,{setSearch:s,text:"Available"}),o.jsx(S1,{setSearch:s,text:"Reserved"}),o.jsx(S1,{setSearch:s,text:"Under Maintenance"}),o.jsx(S1,{setSearch:s,text:"Retired"})]}),e.length>0?o.jsx("div",{className:"max-h-full min-h-96 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-2",children:e.map((N,D)=>o.jsx(Yl,{to:N.uuid,children:o.jsx("div",{className:"border shadow rounded-md h-48 col-span-1 hover:scale-105 bg-background transition-all delay-75 ease-in-out",children:o.jsxs("div",{className:"h-full w-full flex",children:[o.jsx("div",{className:"flex-1 w-1/2",children:o.jsx("img",{src:N.image_url,className:"w-full h-full object-cover rounded-md",alt:"Vehicle",loading:"lazy"})}),o.jsxs("div",{className:"flex-1 p-2 space-y-2",children:[o.jsxs("div",{className:"container justify-between space-x-1 space-y-1",children:[o.jsx(_i,{className:"py-1 items-center",children:o.jsx(bt,{children:N.make})}),o.jsx(_i,{className:N.status==="Under Maintenance"?"py-1 bg-red-500":N.status==="Retired"?"py-1 bg-gray-500":N.status==="Available"?"py-1 bg-green-700":N.status==="Reserved"?"py-1 bg-amber-600":"py-1",children:o.jsx(bt,{children:N.status})})]}),o.jsxs(bt,{children:["Model: ",o.jsx(bt,{children:N.model})]}),o.jsxs(bt,{children:["Type: ",o.jsx(bt,{children:N.type})]}),o.jsxs(bt,{children:["Capacity: ",o.jsxs(bt,{children:[N.capacity," Kg"]})]}),o.jsxs(bt,{children:["Seats: ",o.jsx(bt,{children:N.seats})]}),o.jsxs(bt,{children:["Fuel Efficiency: ",o.jsxs(bt,{children:[N.fuel_efficiency," L/100km"]})]})]})]})})},D))}):o.jsx("div",{className:"flex w-full justify-center max-h-full min-h-96 items-center",children:o.jsxs("div",{className:"flex flex-col justify-center space-y-4",children:[o.jsx("h1",{className:"text-center font-medium text-gray-400 text-shadow text-xl",children:"No vehicle records yet. Do you want to create?"}),o.jsx("div",{className:"w-min mx-auto",children:o.jsx(N9,{})})]})})]}),o.jsx(iN,{totalPage:c,page:n,setPage:r,className:"flex-2/12"})]})})}const are=6048e5,a4e=864e5,P9=Symbol.for("constructDateFrom");function Kl(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&P9 in e?e[P9](t):e instanceof Date?new e.constructor(t):new Date(t)}function eo(e,t){return Kl(t||e,e)}function ore(e,t,n){const r=eo(e,n?.in);return isNaN(t)?Kl(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function lre(e,t,n){const r=eo(e,n?.in);if(isNaN(t))return Kl(e,NaN);if(!t)return r;const c=r.getDate(),f=Kl(e,r.getTime());f.setMonth(r.getMonth()+t+1,0);const p=f.getDate();return c>=p?f:(r.setFullYear(f.getFullYear(),f.getMonth(),c),r)}let o4e={};function LT(){return o4e}function jb(e,t){const n=LT(),r=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,c=eo(e,t?.in),f=c.getDay(),p=(f<r?7:0)+f-r;return c.setDate(c.getDate()-p),c.setHours(0,0,0,0),c}function HS(e,t){return jb(e,{...t,weekStartsOn:1})}function cre(e,t){const n=eo(e,t?.in),r=n.getFullYear(),c=Kl(n,0);c.setFullYear(r+1,0,4),c.setHours(0,0,0,0);const f=HS(c),p=Kl(n,0);p.setFullYear(r,0,4),p.setHours(0,0,0,0);const s=HS(p);return n.getTime()>=f.getTime()?r+1:n.getTime()>=s.getTime()?r:r-1}function M9(e){const t=eo(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Qb(e,...t){const n=Kl.bind(null,t.find(r=>typeof r=="object"));return t.map(n)}function GS(e,t){const n=eo(e,t?.in);return n.setHours(0,0,0,0),n}function ure(e,t,n){const[r,c]=Qb(n?.in,e,t),f=GS(r),p=GS(c),s=+f-M9(f),w=+p-M9(p);return Math.round((s-w)/a4e)}function l4e(e,t){const n=cre(e,t),r=Kl(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),HS(r)}function c4e(e,t,n){return ore(e,t*7,n)}function u4e(e,t,n){return lre(e,t*12,n)}function d4e(e,t){let n,r=t?.in;return e.forEach(c=>{!r&&typeof c=="object"&&(r=Kl.bind(null,c));const f=eo(c,r);(!n||n<f||isNaN(+f))&&(n=f)}),Kl(r,n||NaN)}function h4e(e,t){let n,r=t?.in;return e.forEach(c=>{!r&&typeof c=="object"&&(r=Kl.bind(null,c));const f=eo(c,r);(!n||n>f||isNaN(+f))&&(n=f)}),Kl(r,n||NaN)}function f4e(e,t,n){const[r,c]=Qb(n?.in,e,t);return+GS(r)==+GS(c)}function dre(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function p4e(e){return!(!dre(e)&&typeof e!="number"||isNaN(+eo(e)))}function m4e(e,t,n){const[r,c]=Qb(n?.in,e,t),f=r.getFullYear()-c.getFullYear(),p=r.getMonth()-c.getMonth();return f*12+p}function g4e(e,t){const n=eo(e,t?.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function y4e(e,t){const[n,r]=Qb(e,t.start,t.end);return{start:n,end:r}}function v4e(e,t){const{start:n,end:r}=y4e(t?.in,e);let c=+n>+r;const f=c?+n:+r,p=c?r:n;p.setHours(0,0,0,0),p.setDate(1);let s=1;const w=[];for(;+p<=f;)w.push(Kl(n,p)),p.setMonth(p.getMonth()+s);return c?w.reverse():w}function x4e(e,t){const n=eo(e,t?.in);return n.setDate(1),n.setHours(0,0,0,0),n}function _4e(e,t){const n=eo(e,t?.in),r=n.getFullYear();return n.setFullYear(r+1,0,0),n.setHours(23,59,59,999),n}function hre(e,t){const n=eo(e,t?.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function fre(e,t){const n=LT(),r=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,c=eo(e,t?.in),f=c.getDay(),p=(f<r?-7:0)+6-(f-r);return c.setDate(c.getDate()+p),c.setHours(23,59,59,999),c}function b4e(e,t){return fre(e,{...t,weekStartsOn:1})}const w4e={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},S4e=(e,t,n)=>{let r;const c=w4e[e];return typeof c=="string"?r=c:t===1?r=c.one:r=c.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function pk(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const T4e={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},A4e={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},j4e={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},E4e={date:pk({formats:T4e,defaultWidth:"full"}),time:pk({formats:A4e,defaultWidth:"full"}),dateTime:pk({formats:j4e,defaultWidth:"full"})},C4e={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},N4e=(e,t,n,r)=>C4e[e];function T1(e){return(t,n)=>{const r=n?.context?String(n.context):"standalone";let c;if(r==="formatting"&&e.formattingValues){const p=e.defaultFormattingWidth||e.defaultWidth,s=n?.width?String(n.width):p;c=e.formattingValues[s]||e.formattingValues[p]}else{const p=e.defaultWidth,s=n?.width?String(n.width):e.defaultWidth;c=e.values[s]||e.values[p]}const f=e.argumentCallback?e.argumentCallback(t):t;return c[f]}}const P4e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},M4e={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},R4e={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},O4e={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},D4e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},k4e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},I4e=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},L4e={ordinalNumber:I4e,era:T1({values:P4e,defaultWidth:"wide"}),quarter:T1({values:M4e,defaultWidth:"wide",argumentCallback:e=>e-1}),month:T1({values:R4e,defaultWidth:"wide"}),day:T1({values:O4e,defaultWidth:"wide"}),dayPeriod:T1({values:D4e,defaultWidth:"wide",formattingValues:k4e,defaultFormattingWidth:"wide"})};function A1(e){return(t,n={})=>{const r=n.width,c=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],f=t.match(c);if(!f)return null;const p=f[0],s=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],w=Array.isArray(s)?F4e(s,N=>N.test(p)):z4e(s,N=>N.test(p));let T;T=e.valueCallback?e.valueCallback(w):w,T=n.valueCallback?n.valueCallback(T):T;const E=t.slice(p.length);return{value:T,rest:E}}}function z4e(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function F4e(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function B4e(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const c=r[0],f=t.match(e.parsePattern);if(!f)return null;let p=e.valueCallback?e.valueCallback(f[0]):f[0];p=n.valueCallback?n.valueCallback(p):p;const s=t.slice(c.length);return{value:p,rest:s}}}const U4e=/^(\d+)(th|st|nd|rd)?/i,V4e=/\d+/i,$4e={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},q4e={any:[/^b/i,/^(a|c)/i]},H4e={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},G4e={any:[/1/i,/2/i,/3/i,/4/i]},W4e={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},X4e={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Z4e={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Y4e={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},K4e={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},J4e={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Q4e={ordinalNumber:B4e({matchPattern:U4e,parsePattern:V4e,valueCallback:e=>parseInt(e,10)}),era:A1({matchPatterns:$4e,defaultMatchWidth:"wide",parsePatterns:q4e,defaultParseWidth:"any"}),quarter:A1({matchPatterns:H4e,defaultMatchWidth:"wide",parsePatterns:G4e,defaultParseWidth:"any",valueCallback:e=>e+1}),month:A1({matchPatterns:W4e,defaultMatchWidth:"wide",parsePatterns:X4e,defaultParseWidth:"any"}),day:A1({matchPatterns:Z4e,defaultMatchWidth:"wide",parsePatterns:Y4e,defaultParseWidth:"any"}),dayPeriod:A1({matchPatterns:K4e,defaultMatchWidth:"any",parsePatterns:J4e,defaultParseWidth:"any"})},UF={code:"en-US",formatDistance:S4e,formatLong:E4e,formatRelative:N4e,localize:L4e,match:Q4e,options:{weekStartsOn:0,firstWeekContainsDate:1}};function e5e(e,t){const n=eo(e,t?.in);return ure(n,hre(n))+1}function pre(e,t){const n=eo(e,t?.in),r=+HS(n)-+l4e(n);return Math.round(r/are)+1}function mre(e,t){const n=eo(e,t?.in),r=n.getFullYear(),c=LT(),f=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??c.firstWeekContainsDate??c.locale?.options?.firstWeekContainsDate??1,p=Kl(t?.in||e,0);p.setFullYear(r+1,0,f),p.setHours(0,0,0,0);const s=jb(p,t),w=Kl(t?.in||e,0);w.setFullYear(r,0,f),w.setHours(0,0,0,0);const T=jb(w,t);return+n>=+s?r+1:+n>=+T?r:r-1}function t5e(e,t){const n=LT(),r=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,c=mre(e,t),f=Kl(t?.in||e,0);return f.setFullYear(c,0,r),f.setHours(0,0,0,0),jb(f,t)}function gre(e,t){const n=eo(e,t?.in),r=+jb(n,t)-+t5e(n,t);return Math.round(r/are)+1}function Wa(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const By={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return Wa(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):Wa(n+1,2)},d(e,t){return Wa(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return Wa(e.getHours()%12||12,t.length)},H(e,t){return Wa(e.getHours(),t.length)},m(e,t){return Wa(e.getMinutes(),t.length)},s(e,t){return Wa(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),c=Math.trunc(r*Math.pow(10,n-3));return Wa(c,t.length)}},b0={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},R9={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),c=r>0?r:1-r;return n.ordinalNumber(c,{unit:"year"})}return By.y(e,t)},Y:function(e,t,n,r){const c=mre(e,r),f=c>0?c:1-c;if(t==="YY"){const p=f%100;return Wa(p,2)}return t==="Yo"?n.ordinalNumber(f,{unit:"year"}):Wa(f,t.length)},R:function(e,t){const n=cre(e);return Wa(n,t.length)},u:function(e,t){const n=e.getFullYear();return Wa(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return Wa(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return Wa(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return By.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return Wa(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const c=gre(e,r);return t==="wo"?n.ordinalNumber(c,{unit:"week"}):Wa(c,t.length)},I:function(e,t,n){const r=pre(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):Wa(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):By.d(e,t)},D:function(e,t,n){const r=e5e(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):Wa(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const c=e.getDay(),f=(c-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(f);case"ee":return Wa(f,2);case"eo":return n.ordinalNumber(f,{unit:"day"});case"eee":return n.day(c,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(c,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(c,{width:"short",context:"formatting"});case"eeee":default:return n.day(c,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const c=e.getDay(),f=(c-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(f);case"cc":return Wa(f,t.length);case"co":return n.ordinalNumber(f,{unit:"day"});case"ccc":return n.day(c,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(c,{width:"narrow",context:"standalone"});case"cccccc":return n.day(c,{width:"short",context:"standalone"});case"cccc":default:return n.day(c,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),c=r===0?7:r;switch(t){case"i":return String(c);case"ii":return Wa(c,t.length);case"io":return n.ordinalNumber(c,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const c=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(c,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(c,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(c,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let c;switch(r===12?c=b0.noon:r===0?c=b0.midnight:c=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(c,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(c,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(c,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let c;switch(r>=17?c=b0.evening:r>=12?c=b0.afternoon:r>=4?c=b0.morning:c=b0.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(c,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(c,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return By.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):By.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):Wa(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):Wa(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):By.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):By.s(e,t)},S:function(e,t){return By.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return D9(r);case"XXXX":case"XX":return Mx(r);case"XXXXX":case"XXX":default:return Mx(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return D9(r);case"xxxx":case"xx":return Mx(r);case"xxxxx":case"xxx":default:return Mx(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+O9(r,":");case"OOOO":default:return"GMT"+Mx(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+O9(r,":");case"zzzz":default:return"GMT"+Mx(r,":")}},t:function(e,t,n){const r=Math.trunc(+e/1e3);return Wa(r,t.length)},T:function(e,t,n){return Wa(+e,t.length)}};function O9(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),c=Math.trunc(r/60),f=r%60;return f===0?n+String(c):n+String(c)+t+Wa(f,2)}function D9(e,t){return e%60===0?(e>0?"-":"+")+Wa(Math.abs(e)/60,2):Mx(e,t)}function Mx(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),c=Wa(Math.trunc(r/60),2),f=Wa(r%60,2);return n+c+t+f}const k9=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},yre=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},n5e=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],c=n[2];if(!c)return k9(e,t);let f;switch(r){case"P":f=t.dateTime({width:"short"});break;case"PP":f=t.dateTime({width:"medium"});break;case"PPP":f=t.dateTime({width:"long"});break;case"PPPP":default:f=t.dateTime({width:"full"});break}return f.replace("{{date}}",k9(r,t)).replace("{{time}}",yre(c,t))},r5e={p:yre,P:n5e},i5e=/^D+$/,s5e=/^Y+$/,a5e=["D","DD","YY","YYYY"];function o5e(e){return i5e.test(e)}function l5e(e){return s5e.test(e)}function c5e(e,t,n){const r=u5e(e,t,n);if(console.warn(r),a5e.includes(e))throw new RangeError(r)}function u5e(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const d5e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,h5e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,f5e=/^'([^]*?)'?$/,p5e=/''/g,m5e=/[a-zA-Z]/;function lv(e,t,n){const r=LT(),c=n?.locale??r.locale??UF,f=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,p=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,s=eo(e,n?.in);if(!p4e(s))throw new RangeError("Invalid time value");let w=t.match(h5e).map(E=>{const N=E[0];if(N==="p"||N==="P"){const D=r5e[N];return D(E,c.formatLong)}return E}).join("").match(d5e).map(E=>{if(E==="''")return{isToken:!1,value:"'"};const N=E[0];if(N==="'")return{isToken:!1,value:g5e(E)};if(R9[N])return{isToken:!0,value:E};if(N.match(m5e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");return{isToken:!1,value:E}});c.localize.preprocessor&&(w=c.localize.preprocessor(s,w));const T={firstWeekContainsDate:f,weekStartsOn:p,locale:c};return w.map(E=>{if(!E.isToken)return E.value;const N=E.value;(!n?.useAdditionalWeekYearTokens&&l5e(N)||!n?.useAdditionalDayOfYearTokens&&o5e(N))&&c5e(N,t,String(e));const D=R9[N[0]];return D(s,N,c.localize,T)}).join("")}function g5e(e){const t=e.match(f5e);return t?t[1].replace(p5e,"'"):e}function y5e(e,t){const n=eo(e,t?.in),r=n.getFullYear(),c=n.getMonth(),f=Kl(n,0);return f.setFullYear(r,c+1,0),f.setHours(0,0,0,0),f.getDate()}function v5e(e,t){return eo(e,t?.in).getMonth()}function x5e(e,t){return eo(e,t?.in).getFullYear()}function _5e(e,t){return+eo(e)>+eo(t)}function b5e(e,t){return+eo(e)<+eo(t)}function w5e(e,t,n){const[r,c]=Qb(n?.in,e,t);return r.getFullYear()===c.getFullYear()&&r.getMonth()===c.getMonth()}function S5e(e,t,n){const[r,c]=Qb(n?.in,e,t);return r.getFullYear()===c.getFullYear()}function T5e(e,t,n){const r=eo(e,n?.in),c=r.getFullYear(),f=r.getDate(),p=Kl(e,0);p.setFullYear(c,t,15),p.setHours(0,0,0,0);const s=y5e(p);return r.setMonth(t,Math.min(f,s)),r}function A5e(e,t,n){const r=eo(e,n?.in);return isNaN(+r)?Kl(e,NaN):(r.setFullYear(t),r)}var Wf="Accordion",j5e=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[VF,E5e,C5e]=nC(Wf),[sN,E$e]=Eu(Wf,[C5e,KW]),$F=KW(),vre=_e.forwardRef((e,t)=>{const{type:n,...r}=e,c=r,f=r;return o.jsx(VF.Provider,{scope:e.__scopeAccordion,children:n==="multiple"?o.jsx(R5e,{...f,ref:t}):o.jsx(M5e,{...c,ref:t})})});vre.displayName=Wf;var[xre,N5e]=sN(Wf),[_re,P5e]=sN(Wf,{collapsible:!1}),M5e=_e.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:c=()=>{},collapsible:f=!1,...p}=e,[s,w]=zf({prop:n,defaultProp:r??"",onChange:c,caller:Wf});return o.jsx(xre,{scope:e.__scopeAccordion,value:_e.useMemo(()=>s?[s]:[],[s]),onItemOpen:w,onItemClose:_e.useCallback(()=>f&&w(""),[f,w]),children:o.jsx(_re,{scope:e.__scopeAccordion,collapsible:f,children:o.jsx(bre,{...p,ref:t})})})}),R5e=_e.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:c=()=>{},...f}=e,[p,s]=zf({prop:n,defaultProp:r??[],onChange:c,caller:Wf}),w=_e.useCallback(E=>s((N=[])=>[...N,E]),[s]),T=_e.useCallback(E=>s((N=[])=>N.filter(D=>D!==E)),[s]);return o.jsx(xre,{scope:e.__scopeAccordion,value:p,onItemOpen:w,onItemClose:T,children:o.jsx(_re,{scope:e.__scopeAccordion,collapsible:!0,children:o.jsx(bre,{...f,ref:t})})})}),[O5e,aN]=sN(Wf),bre=_e.forwardRef((e,t)=>{const{__scopeAccordion:n,disabled:r,dir:c,orientation:f="vertical",...p}=e,s=_e.useRef(null),w=fa(s,t),T=E5e(n),N=dT(c)==="ltr",D=Yr(e.onKeyDown,V=>{if(!j5e.includes(V.key))return;const $=V.target,B=T().filter(ye=>!ye.ref.current?.disabled),F=B.findIndex(ye=>ye.ref.current===$),K=B.length;if(F===-1)return;V.preventDefault();let Y=F;const X=0,ae=K-1,Z=()=>{Y=F+1,Y>ae&&(Y=X)},se=()=>{Y=F-1,Y<X&&(Y=ae)};switch(V.key){case"Home":Y=X;break;case"End":Y=ae;break;case"ArrowRight":f==="horizontal"&&(N?Z():se());break;case"ArrowDown":f==="vertical"&&Z();break;case"ArrowLeft":f==="horizontal"&&(N?se():Z());break;case"ArrowUp":f==="vertical"&&se();break}const he=Y%K;B[he].ref.current?.focus()});return o.jsx(O5e,{scope:n,disabled:r,direction:c,orientation:f,children:o.jsx(VF.Slot,{scope:n,children:o.jsx(Si.div,{...p,"data-orientation":f,ref:w,onKeyDown:r?void 0:D})})})}),vE="AccordionItem",[D5e,qF]=sN(vE),wre=_e.forwardRef((e,t)=>{const{__scopeAccordion:n,value:r,...c}=e,f=aN(vE,n),p=N5e(vE,n),s=$F(n),w=Ml(),T=r&&p.value.includes(r)||!1,E=f.disabled||e.disabled;return o.jsx(D5e,{scope:n,open:T,disabled:E,triggerId:w,children:o.jsx(Yhe,{"data-orientation":f.orientation,"data-state":Cre(T),...s,...c,ref:t,disabled:E,open:T,onOpenChange:N=>{N?p.onItemOpen(r):p.onItemClose(r)}})})});wre.displayName=vE;var Sre="AccordionHeader",Tre=_e.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,c=aN(Wf,n),f=qF(Sre,n);return o.jsx(Si.h3,{"data-orientation":c.orientation,"data-state":Cre(f.open),"data-disabled":f.disabled?"":void 0,...r,ref:t})});Tre.displayName=Sre;var WL="AccordionTrigger",Are=_e.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,c=aN(Wf,n),f=qF(WL,n),p=P5e(WL,n),s=$F(n);return o.jsx(VF.ItemSlot,{scope:n,children:o.jsx(Khe,{"aria-disabled":f.open&&!p.collapsible||void 0,"data-orientation":c.orientation,id:f.triggerId,...s,...r,ref:t})})});Are.displayName=WL;var jre="AccordionContent",Ere=_e.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,c=aN(Wf,n),f=qF(jre,n),p=$F(n);return o.jsx(Jhe,{role:"region","aria-labelledby":f.triggerId,"data-orientation":c.orientation,...p,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});Ere.displayName=jre;function Cre(e){return e?"open":"closed"}var k5e=vre,I5e=wre,L5e=Tre,z5e=Are,F5e=Ere;function B5e({...e}){return o.jsx(k5e,{"data-slot":"accordion",...e})}function U5e({className:e,...t}){return o.jsx(I5e,{"data-slot":"accordion-item",className:Rn("border-b last:border-b-0",e),...t})}function V5e({className:e,children:t,...n}){return o.jsx(L5e,{className:"flex",children:o.jsxs(z5e,{"data-slot":"accordion-trigger",className:Rn("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",e),...n,children:[t,o.jsx(LE,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function $5e({className:e,children:t,...n}){return o.jsx(F5e,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...n,children:o.jsx("div",{className:Rn("pt-0 pb-4",e),children:t})})}var Nre="AlertDialog",[q5e,C$e]=Eu(Nre,[jX]),zg=jX(),Pre=e=>{const{__scopeAlertDialog:t,...n}=e,r=zg(t);return o.jsx(qE,{...r,...n,modal:!0})};Pre.displayName=Nre;var H5e="AlertDialogTrigger",Mre=z.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,c=zg(n);return o.jsx(VX,{...c,...r,ref:t})});Mre.displayName=H5e;var G5e="AlertDialogPortal",Rre=e=>{const{__scopeAlertDialog:t,...n}=e,r=zg(t);return o.jsx(HE,{...r,...n})};Rre.displayName=G5e;var W5e="AlertDialogOverlay",Ore=z.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,c=zg(n);return o.jsx(GE,{...c,...r,ref:t})});Ore.displayName=W5e;var H0="AlertDialogContent",[X5e,Z5e]=q5e(H0),Y5e=ZW("AlertDialogContent"),Dre=z.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:r,...c}=e,f=zg(n),p=z.useRef(null),s=fa(t,p),w=z.useRef(null);return o.jsx(Hpe,{contentName:H0,titleName:kre,docsSlug:"alert-dialog",children:o.jsx(X5e,{scope:n,cancelRef:w,children:o.jsxs(WE,{role:"alertdialog",...f,...c,ref:s,onOpenAutoFocus:Yr(c.onOpenAutoFocus,T=>{T.preventDefault(),w.current?.focus({preventScroll:!0})}),onPointerDownOutside:T=>T.preventDefault(),onInteractOutside:T=>T.preventDefault(),children:[o.jsx(Y5e,{children:r}),o.jsx(J5e,{contentRef:p})]})})})});Dre.displayName=H0;var kre="AlertDialogTitle",Ire=z.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,c=zg(n);return o.jsx(p3,{...c,...r,ref:t})});Ire.displayName=kre;var Lre="AlertDialogDescription",zre=z.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,c=zg(n);return o.jsx(m3,{...c,...r,ref:t})});zre.displayName=Lre;var K5e="AlertDialogAction",Fre=z.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,c=zg(n);return o.jsx(aT,{...c,...r,ref:t})});Fre.displayName=K5e;var Bre="AlertDialogCancel",Ure=z.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,{cancelRef:c}=Z5e(Bre,n),f=zg(n),p=fa(t,c);return o.jsx(aT,{...f,...r,ref:p})});Ure.displayName=Bre;var J5e=({contentRef:e})=>{const t=`\`${H0}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${H0}\` by passing a \`${Lre}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${H0}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return z.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},Q5e=Pre,e6e=Mre,t6e=Rre,n6e=Ore,r6e=Dre,i6e=Fre,s6e=Ure,a6e=Ire,o6e=zre;function xE({...e}){return o.jsx(Q5e,{"data-slot":"alert-dialog",...e})}function _E({...e}){return o.jsx(e6e,{"data-slot":"alert-dialog-trigger",...e})}function l6e({...e}){return o.jsx(t6e,{"data-slot":"alert-dialog-portal",...e})}function c6e({className:e,...t}){return o.jsx(n6e,{"data-slot":"alert-dialog-overlay",className:Rn("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function bE({className:e,...t}){return o.jsxs(l6e,{children:[o.jsx(c6e,{}),o.jsx(r6e,{"data-slot":"alert-dialog-content",className:Rn("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...t})]})}function wE({className:e,...t}){return o.jsx("div",{"data-slot":"alert-dialog-header",className:Rn("flex flex-col gap-2 text-center sm:text-left",e),...t})}function SE({className:e,...t}){return o.jsx("div",{"data-slot":"alert-dialog-footer",className:Rn("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function TE({className:e,...t}){return o.jsx(a6e,{"data-slot":"alert-dialog-title",className:Rn("text-lg font-semibold",e),...t})}function AE({className:e,...t}){return o.jsx(o6e,{"data-slot":"alert-dialog-description",className:Rn("text-muted-foreground text-sm",e),...t})}function I9({className:e,...t}){return o.jsx(i6e,{className:Rn(X0(),e),...t})}function jE({className:e,...t}){return o.jsx(s6e,{className:Rn(X0({variant:"outline"}),e),...t})}function u6e(e,t,n="long"){return new Intl.DateTimeFormat("en-US",{hour:"numeric",timeZone:e,timeZoneName:n}).format(t).split(/\s/g).slice(2).join(" ")}const d6e={},I1={};function Vx(e,t){try{const r=(d6e[e]||=new Intl.DateTimeFormat("en-US",{timeZone:e,timeZoneName:"longOffset"}).format)(t).split("GMT")[1];return r in I1?I1[r]:L9(r,r.split(":"))}catch{if(e in I1)return I1[e];const n=e?.match(h6e);return n?L9(e,n.slice(1)):NaN}}const h6e=/([+-]\d\d):?(\d\d)?/;function L9(e,t){const n=+(t[0]||0),r=+(t[1]||0),c=+(t[2]||0)/60;return I1[e]=n*60+r>0?n*60+r+c:n*60-r-c}class Yp extends Date{constructor(...t){super(),t.length>1&&typeof t[t.length-1]=="string"&&(this.timeZone=t.pop()),this.internal=new Date,isNaN(Vx(this.timeZone,this))?this.setTime(NaN):t.length?typeof t[0]=="number"&&(t.length===1||t.length===2&&typeof t[1]!="number")?this.setTime(t[0]):typeof t[0]=="string"?this.setTime(+new Date(t[0])):t[0]instanceof Date?this.setTime(+t[0]):(this.setTime(+new Date(...t)),Vre(this),XL(this)):this.setTime(Date.now())}static tz(t,...n){return n.length?new Yp(...n,t):new Yp(Date.now(),t)}withTimeZone(t){return new Yp(+this,t)}getTimezoneOffset(){const t=-Vx(this.timeZone,this);return t>0?Math.floor(t):Math.ceil(t)}setTime(t){return Date.prototype.setTime.apply(this,arguments),XL(this),+this}[Symbol.for("constructDateFrom")](t){return new Yp(+new Date(t),this.timeZone)}}const z9=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(e=>{if(!z9.test(e))return;const t=e.replace(z9,"$1UTC");Yp.prototype[t]&&(e.startsWith("get")?Yp.prototype[e]=function(){return this.internal[t]()}:(Yp.prototype[e]=function(){return Date.prototype[t].apply(this.internal,arguments),f6e(this),+this},Yp.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),XL(this),+this}))});function XL(e){e.internal.setTime(+e),e.internal.setUTCSeconds(e.internal.getUTCSeconds()-Math.round(-Vx(e.timeZone,e)*60))}function f6e(e){Date.prototype.setFullYear.call(e,e.internal.getUTCFullYear(),e.internal.getUTCMonth(),e.internal.getUTCDate()),Date.prototype.setHours.call(e,e.internal.getUTCHours(),e.internal.getUTCMinutes(),e.internal.getUTCSeconds(),e.internal.getUTCMilliseconds()),Vre(e)}function Vre(e){const t=Vx(e.timeZone,e),n=t>0?Math.floor(t):Math.ceil(t),r=new Date(+e);r.setUTCHours(r.getUTCHours()-1);const c=-new Date(+e).getTimezoneOffset(),f=-new Date(+r).getTimezoneOffset(),p=c-f,s=Date.prototype.getHours.apply(e)!==e.internal.getUTCHours();p&&s&&e.internal.setUTCMinutes(e.internal.getUTCMinutes()+p);const w=c-n;w&&Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+w);const T=new Date(+e);T.setUTCSeconds(0);const E=c>0?T.getSeconds():(T.getSeconds()-60)%60,N=Math.round(-(Vx(e.timeZone,e)*60))%60;(N||E)&&(e.internal.setUTCSeconds(e.internal.getUTCSeconds()+N),Date.prototype.setUTCSeconds.call(e,Date.prototype.getUTCSeconds.call(e)+N+E));const D=Vx(e.timeZone,e),V=D>0?Math.floor(D):Math.ceil(D),B=-new Date(+e).getTimezoneOffset()-V,F=V!==n,K=B-w;if(F&&K){Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+K);const Y=Vx(e.timeZone,e),X=Y>0?Math.floor(Y):Math.ceil(Y),ae=V-X;ae&&(e.internal.setUTCMinutes(e.internal.getUTCMinutes()+ae),Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+ae))}}class Qc extends Yp{static tz(t,...n){return n.length?new Qc(...n,t):new Qc(Date.now(),t)}toISOString(){const[t,n,r]=this.tzComponents(),c=`${t}${n}:${r}`;return this.internal.toISOString().slice(0,-1)+c}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[t,n,r,c]=this.internal.toUTCString().split(" ");return`${t?.slice(0,-1)} ${r} ${n} ${c}`}toTimeString(){const t=this.internal.toUTCString().split(" ")[4],[n,r,c]=this.tzComponents();return`${t} GMT${n}${r}${c} (${u6e(this.timeZone,this)})`}toLocaleString(t,n){return Date.prototype.toLocaleString.call(this,t,{...n,timeZone:n?.timeZone||this.timeZone})}toLocaleDateString(t,n){return Date.prototype.toLocaleDateString.call(this,t,{...n,timeZone:n?.timeZone||this.timeZone})}toLocaleTimeString(t,n){return Date.prototype.toLocaleTimeString.call(this,t,{...n,timeZone:n?.timeZone||this.timeZone})}tzComponents(){const t=this.getTimezoneOffset(),n=t>0?"-":"+",r=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),c=String(Math.abs(t)%60).padStart(2,"0");return[n,r,c]}withTimeZone(t){return new Qc(+this,t)}[Symbol.for("constructDateFrom")](t){return new Qc(+new Date(t),this.timeZone)}}var Vi;(function(e){e.Root="root",e.Chevron="chevron",e.Day="day",e.DayButton="day_button",e.CaptionLabel="caption_label",e.Dropdowns="dropdowns",e.Dropdown="dropdown",e.DropdownRoot="dropdown_root",e.Footer="footer",e.MonthGrid="month_grid",e.MonthCaption="month_caption",e.MonthsDropdown="months_dropdown",e.Month="month",e.Months="months",e.Nav="nav",e.NextMonthButton="button_next",e.PreviousMonthButton="button_previous",e.Week="week",e.Weeks="weeks",e.Weekday="weekday",e.Weekdays="weekdays",e.WeekNumber="week_number",e.WeekNumberHeader="week_number_header",e.YearsDropdown="years_dropdown"})(Vi||(Vi={}));var Go;(function(e){e.disabled="disabled",e.hidden="hidden",e.outside="outside",e.focused="focused",e.today="today"})(Go||(Go={}));var If;(function(e){e.range_end="range_end",e.range_middle="range_middle",e.range_start="range_start",e.selected="selected"})(If||(If={}));var $d;(function(e){e.weeks_before_enter="weeks_before_enter",e.weeks_before_exit="weeks_before_exit",e.weeks_after_enter="weeks_after_enter",e.weeks_after_exit="weeks_after_exit",e.caption_after_enter="caption_after_enter",e.caption_after_exit="caption_after_exit",e.caption_before_enter="caption_before_enter",e.caption_before_exit="caption_before_exit"})($d||($d={}));const F9=5,p6e=4;function m6e(e,t){const n=t.startOfMonth(e),r=n.getDay()>0?n.getDay():7,c=t.addDays(e,-r+1),f=t.addDays(c,F9*7-1);return t.getMonth(e)===t.getMonth(f)?F9:p6e}function $re(e,t){const n=t.startOfMonth(e),r=n.getDay();return r===1?n:r===0?t.addDays(n,-6):t.addDays(n,-1*(r-1))}function g6e(e,t){const n=$re(e,t),r=m6e(e,t);return t.addDays(n,r*7-1)}class Fg{constructor(t,n){this.Date=Date,this.today=()=>this.overrides?.today?this.overrides.today():this.options.timeZone?Qc.tz(this.options.timeZone):new this.Date,this.newDate=(r,c,f)=>this.overrides?.newDate?this.overrides.newDate(r,c,f):this.options.timeZone?new Qc(r,c,f,this.options.timeZone):new Date(r,c,f),this.addDays=(r,c)=>this.overrides?.addDays?this.overrides.addDays(r,c):ore(r,c),this.addMonths=(r,c)=>this.overrides?.addMonths?this.overrides.addMonths(r,c):lre(r,c),this.addWeeks=(r,c)=>this.overrides?.addWeeks?this.overrides.addWeeks(r,c):c4e(r,c),this.addYears=(r,c)=>this.overrides?.addYears?this.overrides.addYears(r,c):u4e(r,c),this.differenceInCalendarDays=(r,c)=>this.overrides?.differenceInCalendarDays?this.overrides.differenceInCalendarDays(r,c):ure(r,c),this.differenceInCalendarMonths=(r,c)=>this.overrides?.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(r,c):m4e(r,c),this.eachMonthOfInterval=r=>this.overrides?.eachMonthOfInterval?this.overrides.eachMonthOfInterval(r):v4e(r),this.endOfBroadcastWeek=r=>this.overrides?.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(r):g6e(r,this),this.endOfISOWeek=r=>this.overrides?.endOfISOWeek?this.overrides.endOfISOWeek(r):b4e(r),this.endOfMonth=r=>this.overrides?.endOfMonth?this.overrides.endOfMonth(r):g4e(r),this.endOfWeek=(r,c)=>this.overrides?.endOfWeek?this.overrides.endOfWeek(r,c):fre(r,this.options),this.endOfYear=r=>this.overrides?.endOfYear?this.overrides.endOfYear(r):_4e(r),this.format=(r,c,f)=>{const p=this.overrides?.format?this.overrides.format(r,c,this.options):lv(r,c,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(p):p},this.getISOWeek=r=>this.overrides?.getISOWeek?this.overrides.getISOWeek(r):pre(r),this.getMonth=(r,c)=>this.overrides?.getMonth?this.overrides.getMonth(r,this.options):v5e(r,this.options),this.getYear=(r,c)=>this.overrides?.getYear?this.overrides.getYear(r,this.options):x5e(r,this.options),this.getWeek=(r,c)=>this.overrides?.getWeek?this.overrides.getWeek(r,this.options):gre(r,this.options),this.isAfter=(r,c)=>this.overrides?.isAfter?this.overrides.isAfter(r,c):_5e(r,c),this.isBefore=(r,c)=>this.overrides?.isBefore?this.overrides.isBefore(r,c):b5e(r,c),this.isDate=r=>this.overrides?.isDate?this.overrides.isDate(r):dre(r),this.isSameDay=(r,c)=>this.overrides?.isSameDay?this.overrides.isSameDay(r,c):f4e(r,c),this.isSameMonth=(r,c)=>this.overrides?.isSameMonth?this.overrides.isSameMonth(r,c):w5e(r,c),this.isSameYear=(r,c)=>this.overrides?.isSameYear?this.overrides.isSameYear(r,c):S5e(r,c),this.max=r=>this.overrides?.max?this.overrides.max(r):d4e(r),this.min=r=>this.overrides?.min?this.overrides.min(r):h4e(r),this.setMonth=(r,c)=>this.overrides?.setMonth?this.overrides.setMonth(r,c):T5e(r,c),this.setYear=(r,c)=>this.overrides?.setYear?this.overrides.setYear(r,c):A5e(r,c),this.startOfBroadcastWeek=(r,c)=>this.overrides?.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(r,this):$re(r,this),this.startOfDay=r=>this.overrides?.startOfDay?this.overrides.startOfDay(r):GS(r),this.startOfISOWeek=r=>this.overrides?.startOfISOWeek?this.overrides.startOfISOWeek(r):HS(r),this.startOfMonth=r=>this.overrides?.startOfMonth?this.overrides.startOfMonth(r):x4e(r),this.startOfWeek=(r,c)=>this.overrides?.startOfWeek?this.overrides.startOfWeek(r,this.options):jb(r,this.options),this.startOfYear=r=>this.overrides?.startOfYear?this.overrides.startOfYear(r):hre(r),this.options={locale:UF,...t},this.overrides=n}getDigitMap(){const{numerals:t="latn"}=this.options,n=new Intl.NumberFormat("en-US",{numberingSystem:t}),r={};for(let c=0;c<10;c++)r[c.toString()]=n.format(c);return r}replaceDigits(t){const n=this.getDigitMap();return t.replace(/\d/g,r=>n[r]||r)}formatNumber(t){return this.replaceDigits(t.toString())}}const hm=new Fg;class qre{constructor(t,n,r=hm){this.date=t,this.displayMonth=n,this.outside=!!(n&&!r.isSameMonth(t,n)),this.dateLib=r}isEqualTo(t){return this.dateLib.isSameDay(t.date,this.date)&&this.dateLib.isSameMonth(t.displayMonth,this.displayMonth)}}class y6e{constructor(t,n){this.date=t,this.weeks=n}}class v6e{constructor(t,n){this.days=n,this.weekNumber=t}}function vg(e,t,n=!1,r=hm){let{from:c,to:f}=e;const{differenceInCalendarDays:p,isSameDay:s}=r;return c&&f?(p(f,c)<0&&([c,f]=[f,c]),p(t,c)>=(n?1:0)&&p(f,t)>=(n?1:0)):!n&&f?s(f,t):!n&&c?s(c,t):!1}function Hre(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function HF(e){return!!(e&&typeof e=="object"&&"from"in e)}function Gre(e){return!!(e&&typeof e=="object"&&"after"in e)}function Wre(e){return!!(e&&typeof e=="object"&&"before"in e)}function Xre(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Zre(e,t){return Array.isArray(e)&&e.every(t.isDate)}function xg(e,t,n=hm){const r=Array.isArray(t)?t:[t],{isSameDay:c,differenceInCalendarDays:f,isAfter:p}=n;return r.some(s=>{if(typeof s=="boolean")return s;if(n.isDate(s))return c(e,s);if(Zre(s,n))return s.includes(e);if(HF(s))return vg(s,e,!1,n);if(Xre(s))return Array.isArray(s.dayOfWeek)?s.dayOfWeek.includes(e.getDay()):s.dayOfWeek===e.getDay();if(Hre(s)){const w=f(s.before,e),T=f(s.after,e),E=w>0,N=T<0;return p(s.before,s.after)?N&&E:E||N}return Gre(s)?f(e,s.after)>0:Wre(s)?f(s.before,e)>0:typeof s=="function"?s(e):!1})}function x6e(e,t,n,r,c){const{disabled:f,hidden:p,modifiers:s,showOutsideDays:w,broadcastCalendar:T,today:E}=t,{isSameDay:N,isSameMonth:D,startOfMonth:V,isBefore:$,endOfMonth:B,isAfter:F}=c,K=n&&V(n),Y=r&&B(r),X={[Go.focused]:[],[Go.outside]:[],[Go.disabled]:[],[Go.hidden]:[],[Go.today]:[]},ae={};for(const Z of e){const{date:se,displayMonth:he}=Z,ye=!!(he&&!D(se,he)),Ce=!!(K&&$(se,K)),Ve=!!(Y&&F(se,Y)),Re=!!(f&&xg(se,f,c)),$e=!!(p&&xg(se,p,c))||Ce||Ve||!T&&!w&&ye||T&&w===!1&&ye,nt=N(se,E??c.today());ye&&X.outside.push(Z),Re&&X.disabled.push(Z),$e&&X.hidden.push(Z),nt&&X.today.push(Z),s&&Object.keys(s).forEach(Me=>{const rt=s?.[Me];rt&&xg(se,rt,c)&&(ae[Me]?ae[Me].push(Z):ae[Me]=[Z])})}return Z=>{const se={[Go.focused]:!1,[Go.disabled]:!1,[Go.hidden]:!1,[Go.outside]:!1,[Go.today]:!1},he={};for(const ye in X){const Ce=X[ye];se[ye]=Ce.some(Ve=>Ve===Z)}for(const ye in ae)he[ye]=ae[ye].some(Ce=>Ce===Z);return{...se,...he}}}function _6e(e,t,n={}){return Object.entries(e).filter(([,c])=>c===!0).reduce((c,[f])=>(n[f]?c.push(n[f]):t[Go[f]]?c.push(t[Go[f]]):t[If[f]]&&c.push(t[If[f]]),c),[t[Vi.Day]])}function b6e(e){return _e.createElement("button",{...e})}function w6e(e){return _e.createElement("span",{...e})}function S6e(e){const{size:t=24,orientation:n="left",className:r}=e;return _e.createElement("svg",{className:r,width:t,height:t,viewBox:"0 0 24 24"},n==="up"&&_e.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),n==="down"&&_e.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),n==="left"&&_e.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),n==="right"&&_e.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function T6e(e){const{day:t,modifiers:n,...r}=e;return _e.createElement("td",{...r})}function A6e(e){const{day:t,modifiers:n,...r}=e,c=_e.useRef(null);return _e.useEffect(()=>{n.focused&&c.current?.focus()},[n.focused]),_e.createElement("button",{ref:c,...r})}function j6e(e){const{options:t,className:n,components:r,classNames:c,...f}=e,p=[c[Vi.Dropdown],n].join(" "),s=t?.find(({value:w})=>w===f.value);return _e.createElement("span",{"data-disabled":f.disabled,className:c[Vi.DropdownRoot]},_e.createElement(r.Select,{className:p,...f},t?.map(({value:w,label:T,disabled:E})=>_e.createElement(r.Option,{key:w,value:w,disabled:E},T))),_e.createElement("span",{className:c[Vi.CaptionLabel],"aria-hidden":!0},s?.label,_e.createElement(r.Chevron,{orientation:"down",size:18,className:c[Vi.Chevron]})))}function E6e(e){return _e.createElement("div",{...e})}function C6e(e){return _e.createElement("div",{...e})}function N6e(e){const{calendarMonth:t,displayIndex:n,...r}=e;return _e.createElement("div",{...r},e.children)}function P6e(e){const{calendarMonth:t,displayIndex:n,...r}=e;return _e.createElement("div",{...r})}function M6e(e){return _e.createElement("table",{...e})}function R6e(e){return _e.createElement("div",{...e})}const Yre=z.createContext(void 0);function zT(){const e=z.useContext(Yre);if(e===void 0)throw new Error("useDayPicker() must be used within a custom component.");return e}function O6e(e){const{components:t}=zT();return _e.createElement(t.Dropdown,{...e})}function D6e(e){const{onPreviousClick:t,onNextClick:n,previousMonth:r,nextMonth:c,...f}=e,{components:p,classNames:s,labels:{labelPrevious:w,labelNext:T}}=zT(),E=z.useCallback(D=>{c&&n?.(D)},[c,n]),N=z.useCallback(D=>{r&&t?.(D)},[r,t]);return _e.createElement("nav",{...f},_e.createElement(p.PreviousMonthButton,{type:"button",className:s[Vi.PreviousMonthButton],tabIndex:r?void 0:-1,"aria-disabled":r?void 0:!0,"aria-label":w(r),onClick:N},_e.createElement(p.Chevron,{disabled:r?void 0:!0,className:s[Vi.Chevron],orientation:"left"})),_e.createElement(p.NextMonthButton,{type:"button",className:s[Vi.NextMonthButton],tabIndex:c?void 0:-1,"aria-disabled":c?void 0:!0,"aria-label":T(c),onClick:E},_e.createElement(p.Chevron,{disabled:c?void 0:!0,orientation:"right",className:s[Vi.Chevron]})))}function k6e(e){const{components:t}=zT();return _e.createElement(t.Button,{...e})}function I6e(e){return _e.createElement("option",{...e})}function L6e(e){const{components:t}=zT();return _e.createElement(t.Button,{...e})}function z6e(e){const{rootRef:t,...n}=e;return _e.createElement("div",{...n,ref:t})}function F6e(e){return _e.createElement("select",{...e})}function B6e(e){const{week:t,...n}=e;return _e.createElement("tr",{...n})}function U6e(e){return _e.createElement("th",{...e})}function V6e(e){return _e.createElement("thead",{"aria-hidden":!0},_e.createElement("tr",{...e}))}function $6e(e){const{week:t,...n}=e;return _e.createElement("th",{...n})}function q6e(e){return _e.createElement("th",{...e})}function H6e(e){return _e.createElement("tbody",{...e})}function G6e(e){const{components:t}=zT();return _e.createElement(t.Dropdown,{...e})}const W6e=Object.freeze(Object.defineProperty({__proto__:null,Button:b6e,CaptionLabel:w6e,Chevron:S6e,Day:T6e,DayButton:A6e,Dropdown:j6e,DropdownNav:E6e,Footer:C6e,Month:N6e,MonthCaption:P6e,MonthGrid:M6e,Months:R6e,MonthsDropdown:O6e,Nav:D6e,NextMonthButton:k6e,Option:I6e,PreviousMonthButton:L6e,Root:z6e,Select:F6e,Week:B6e,WeekNumber:$6e,WeekNumberHeader:q6e,Weekday:U6e,Weekdays:V6e,Weeks:H6e,YearsDropdown:G6e},Symbol.toStringTag,{value:"Module"}));function X6e(e){return{...W6e,...e}}function Z6e(e){const t={"data-mode":e.mode??void 0,"data-required":"required"in e?e.required:void 0,"data-multiple-months":e.numberOfMonths&&e.numberOfMonths>1||void 0,"data-week-numbers":e.showWeekNumber||void 0,"data-broadcast-calendar":e.broadcastCalendar||void 0,"data-nav-layout":e.navLayout||void 0};return Object.entries(e).forEach(([n,r])=>{n.startsWith("data-")&&(t[n]=r)}),t}function GF(){const e={};for(const t in Vi)e[Vi[t]]=`rdp-${Vi[t]}`;for(const t in Go)e[Go[t]]=`rdp-${Go[t]}`;for(const t in If)e[If[t]]=`rdp-${If[t]}`;for(const t in $d)e[$d[t]]=`rdp-${$d[t]}`;return e}function Kre(e,t,n){return(n??new Fg(t)).format(e,"LLLL y")}const Y6e=Kre;function K6e(e,t,n){return(n??new Fg(t)).format(e,"d")}function J6e(e,t=hm){return t.format(e,"LLLL")}function Q6e(e,t=hm){return e<10?t.formatNumber(`0${e.toLocaleString()}`):t.formatNumber(`${e.toLocaleString()}`)}function eUe(){return""}function tUe(e,t,n){return(n??new Fg(t)).format(e,"cccccc")}function Jre(e,t=hm){return t.format(e,"yyyy")}const nUe=Jre,rUe=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:Kre,formatDay:K6e,formatMonthCaption:Y6e,formatMonthDropdown:J6e,formatWeekNumber:Q6e,formatWeekNumberHeader:eUe,formatWeekdayName:tUe,formatYearCaption:nUe,formatYearDropdown:Jre},Symbol.toStringTag,{value:"Module"}));function iUe(e){return e?.formatMonthCaption&&!e.formatCaption&&(e.formatCaption=e.formatMonthCaption),e?.formatYearCaption&&!e.formatYearDropdown&&(e.formatYearDropdown=e.formatYearCaption),{...rUe,...e}}function sUe(e,t,n,r,c){const{startOfMonth:f,startOfYear:p,endOfYear:s,eachMonthOfInterval:w,getMonth:T}=c;return w({start:p(e),end:s(e)}).map(D=>{const V=r.formatMonthDropdown(D,c),$=T(D),B=t&&D<f(t)||n&&D>f(n)||!1;return{value:$,label:V,disabled:B}})}function aUe(e,t={},n={}){let r={...t?.[Vi.Day]};return Object.entries(e).filter(([,c])=>c===!0).forEach(([c])=>{r={...r,...n?.[c]}}),r}function oUe(e,t,n){const r=e.today(),c=t?e.startOfISOWeek(r):e.startOfWeek(r),f=[];for(let p=0;p<7;p++){const s=e.addDays(c,p);f.push(s)}return f}function lUe(e,t,n,r){if(!e||!t)return;const{startOfYear:c,endOfYear:f,addYears:p,getYear:s,isBefore:w,isSameYear:T}=r,E=c(e),N=f(t),D=[];let V=E;for(;w(V,N)||T(V,N);)D.push(V),V=p(V,1);return D.map($=>{const B=n.formatYearDropdown($,r);return{value:s($),label:B,disabled:!1}})}function Qre(e,t,n){return(n??new Fg(t)).format(e,"LLLL y")}const cUe=Qre;function uUe(e,t,n,r){let c=(r??new Fg(n)).format(e,"PPPP");return t?.today&&(c=`Today, ${c}`),c}function eie(e,t,n,r){let c=(r??new Fg(n)).format(e,"PPPP");return t.today&&(c=`Today, ${c}`),t.selected&&(c=`${c}, selected`),c}const dUe=eie;function hUe(){return""}function fUe(e){return"Choose the Month"}function pUe(e){return"Go to the Next Month"}function mUe(e){return"Go to the Previous Month"}function gUe(e,t,n){return(n??new Fg(t)).format(e,"cccc")}function yUe(e,t){return`Week ${e}`}function vUe(e){return"Week Number"}function xUe(e){return"Choose the Year"}const _Ue=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:cUe,labelDay:dUe,labelDayButton:eie,labelGrid:Qre,labelGridcell:uUe,labelMonthDropdown:fUe,labelNav:hUe,labelNext:pUe,labelPrevious:mUe,labelWeekNumber:yUe,labelWeekNumberHeader:vUe,labelWeekday:gUe,labelYearDropdown:xUe},Symbol.toStringTag,{value:"Module"})),FT=e=>e instanceof HTMLElement?e:null,mk=e=>[...e.querySelectorAll("[data-animated-month]")??[]],bUe=e=>FT(e.querySelector("[data-animated-month]")),gk=e=>FT(e.querySelector("[data-animated-caption]")),yk=e=>FT(e.querySelector("[data-animated-weeks]")),wUe=e=>FT(e.querySelector("[data-animated-nav]")),SUe=e=>FT(e.querySelector("[data-animated-weekdays]"));function TUe(e,t,{classNames:n,months:r,focused:c,dateLib:f}){const p=z.useRef(null),s=z.useRef(r),w=z.useRef(!1);z.useLayoutEffect(()=>{const T=s.current;if(s.current=r,!t||!e.current||!(e.current instanceof HTMLElement)||r.length===0||T.length===0||r.length!==T.length)return;const E=f.isSameMonth(r[0].date,T[0].date),N=f.isAfter(r[0].date,T[0].date),D=N?n[$d.caption_after_enter]:n[$d.caption_before_enter],V=N?n[$d.weeks_after_enter]:n[$d.weeks_before_enter],$=p.current,B=e.current.cloneNode(!0);if(B instanceof HTMLElement?(mk(B).forEach(X=>{if(!(X instanceof HTMLElement))return;const ae=bUe(X);ae&&X.contains(ae)&&X.removeChild(ae);const Z=gk(X);Z&&Z.classList.remove(D);const se=yk(X);se&&se.classList.remove(V)}),p.current=B):p.current=null,w.current||E||c)return;const F=$ instanceof HTMLElement?mk($):[],K=mk(e.current);if(K&&K.every(Y=>Y instanceof HTMLElement)&&F&&F.every(Y=>Y instanceof HTMLElement)){w.current=!0,e.current.style.isolation="isolate";const Y=wUe(e.current);Y&&(Y.style.zIndex="1"),K.forEach((X,ae)=>{const Z=F[ae];if(!Z)return;X.style.position="relative",X.style.overflow="hidden";const se=gk(X);se&&se.classList.add(D);const he=yk(X);he&&he.classList.add(V);const ye=()=>{w.current=!1,e.current&&(e.current.style.isolation=""),Y&&(Y.style.zIndex=""),se&&se.classList.remove(D),he&&he.classList.remove(V),X.style.position="",X.style.overflow="",X.contains(Z)&&X.removeChild(Z)};Z.style.pointerEvents="none",Z.style.position="absolute",Z.style.overflow="hidden",Z.setAttribute("aria-hidden","true");const Ce=SUe(Z);Ce&&(Ce.style.opacity="0");const Ve=gk(Z);Ve&&(Ve.classList.add(N?n[$d.caption_before_exit]:n[$d.caption_after_exit]),Ve.addEventListener("animationend",ye));const Re=yk(Z);Re&&Re.classList.add(N?n[$d.weeks_before_exit]:n[$d.weeks_after_exit]),X.insertBefore(Z,X.firstChild)})}})}function AUe(e,t,n,r){const c=e[0],f=e[e.length-1],{ISOWeek:p,fixedWeeks:s,broadcastCalendar:w}=n??{},{addDays:T,differenceInCalendarDays:E,differenceInCalendarMonths:N,endOfBroadcastWeek:D,endOfISOWeek:V,endOfMonth:$,endOfWeek:B,isAfter:F,startOfBroadcastWeek:K,startOfISOWeek:Y,startOfWeek:X}=r,ae=w?K(c,r):p?Y(c):X(c),Z=w?D(f):p?V($(f)):B($(f)),se=E(Z,ae),he=N(f,c)+1,ye=[];for(let Re=0;Re<=se;Re++){const $e=T(ae,Re);if(t&&F($e,t))break;ye.push($e)}const Ve=(w?35:42)*he;if(s&&ye.length<Ve){const Re=Ve-ye.length;for(let $e=0;$e<Re;$e++){const nt=T(ye[ye.length-1],1);ye.push(nt)}}return ye}function jUe(e){const t=[];return e.reduce((n,r)=>{const c=r.weeks.reduce((f,p)=>[...f,...p.days],t);return[...n,...c]},t)}function EUe(e,t,n,r){const{numberOfMonths:c=1}=n,f=[];for(let p=0;p<c;p++){const s=r.addMonths(e,p);if(t&&s>t)break;f.push(s)}return f}function B9(e,t,n,r){const{month:c,defaultMonth:f,today:p=r.today(),numberOfMonths:s=1}=e;let w=c||f||p;const{differenceInCalendarMonths:T,addMonths:E,startOfMonth:N}=r;if(n&&T(n,w)<s-1){const D=-1*(s-1);w=E(n,D)}return t&&T(w,t)<0&&(w=t),N(w)}function CUe(e,t,n,r){const{addDays:c,endOfBroadcastWeek:f,endOfISOWeek:p,endOfMonth:s,endOfWeek:w,getISOWeek:T,getWeek:E,startOfBroadcastWeek:N,startOfISOWeek:D,startOfWeek:V}=r,$=e.reduce((B,F)=>{const K=n.broadcastCalendar?N(F,r):n.ISOWeek?D(F):V(F),Y=n.broadcastCalendar?f(F):n.ISOWeek?p(s(F)):w(s(F)),X=t.filter(he=>he>=K&&he<=Y),ae=n.broadcastCalendar?35:42;if(n.fixedWeeks&&X.length<ae){const he=t.filter(ye=>{const Ce=ae-X.length;return ye>Y&&ye<=c(Y,Ce)});X.push(...he)}const Z=X.reduce((he,ye)=>{const Ce=n.ISOWeek?T(ye):E(ye),Ve=he.find($e=>$e.weekNumber===Ce),Re=new qre(ye,F,r);return Ve?Ve.days.push(Re):he.push(new v6e(Ce,[Re])),he},[]),se=new y6e(F,Z);return B.push(se),B},[]);return n.reverseMonths?$.reverse():$}function NUe(e,t){let{startMonth:n,endMonth:r}=e;const{startOfYear:c,startOfDay:f,startOfMonth:p,endOfMonth:s,addYears:w,endOfYear:T,newDate:E,today:N}=t,{fromYear:D,toYear:V,fromMonth:$,toMonth:B}=e;!n&&$&&(n=$),!n&&D&&(n=t.newDate(D,0,1)),!r&&B&&(r=B),!r&&V&&(r=E(V,11,31));const F=e.captionLayout==="dropdown"||e.captionLayout==="dropdown-years";return n?n=p(n):D?n=E(D,0,1):!n&&F&&(n=c(w(e.today??N(),-100))),r?r=s(r):V?r=E(V,11,31):!r&&F&&(r=T(e.today??N())),[n&&f(n),r&&f(r)]}function PUe(e,t,n,r){if(n.disableNavigation)return;const{pagedNavigation:c,numberOfMonths:f=1}=n,{startOfMonth:p,addMonths:s,differenceInCalendarMonths:w}=r,T=c?f:1,E=p(e);if(!t)return s(E,T);if(!(w(t,e)<f))return s(E,T)}function MUe(e,t,n,r){if(n.disableNavigation)return;const{pagedNavigation:c,numberOfMonths:f}=n,{startOfMonth:p,addMonths:s,differenceInCalendarMonths:w}=r,T=c?f??1:1,E=p(e);if(!t)return s(E,-T);if(!(w(E,t)<=0))return s(E,-T)}function RUe(e){const t=[];return e.reduce((n,r)=>[...n,...r.weeks],t)}function oN(e,t){const[n,r]=z.useState(e);return[t===void 0?n:t,r]}function OUe(e,t){const[n,r]=NUe(e,t),{startOfMonth:c,endOfMonth:f}=t,p=B9(e,n,r,t),[s,w]=oN(p,e.month?p:void 0);z.useEffect(()=>{const se=B9(e,n,r,t);w(se)},[e.timeZone]);const T=EUe(s,r,e,t),E=AUe(T,e.endMonth?f(e.endMonth):void 0,e,t),N=CUe(T,E,e,t),D=RUe(N),V=jUe(N),$=MUe(s,n,e,t),B=PUe(s,r,e,t),{disableNavigation:F,onMonthChange:K}=e,Y=se=>D.some(he=>he.days.some(ye=>ye.isEqualTo(se))),X=se=>{if(F)return;let he=c(se);n&&he<c(n)&&(he=c(n)),r&&he>c(r)&&(he=c(r)),w(he),K?.(he)};return{months:N,weeks:D,days:V,navStart:n,navEnd:r,previousMonth:$,nextMonth:B,goToMonth:X,goToDay:se=>{Y(se)||X(se.date)}}}var Vp;(function(e){e[e.Today=0]="Today",e[e.Selected=1]="Selected",e[e.LastFocused=2]="LastFocused",e[e.FocusedModifier=3]="FocusedModifier"})(Vp||(Vp={}));function U9(e){return!e[Go.disabled]&&!e[Go.hidden]&&!e[Go.outside]}function DUe(e,t,n,r){let c,f=-1;for(const p of e){const s=t(p);U9(s)&&(s[Go.focused]&&f<Vp.FocusedModifier?(c=p,f=Vp.FocusedModifier):r?.isEqualTo(p)&&f<Vp.LastFocused?(c=p,f=Vp.LastFocused):n(p.date)&&f<Vp.Selected?(c=p,f=Vp.Selected):s[Go.today]&&f<Vp.Today&&(c=p,f=Vp.Today))}return c||(c=e.find(p=>U9(t(p)))),c}function kUe(e,t,n,r,c,f,p){const{ISOWeek:s,broadcastCalendar:w}=f,{addDays:T,addMonths:E,addWeeks:N,addYears:D,endOfBroadcastWeek:V,endOfISOWeek:$,endOfWeek:B,max:F,min:K,startOfBroadcastWeek:Y,startOfISOWeek:X,startOfWeek:ae}=p;let se={day:T,week:N,month:E,year:D,startOfWeek:he=>w?Y(he,p):s?X(he):ae(he),endOfWeek:he=>w?V(he):s?$(he):B(he)}[e](n,t==="after"?1:-1);return t==="before"&&r?se=F([r,se]):t==="after"&&c&&(se=K([c,se])),se}function tie(e,t,n,r,c,f,p,s=0){if(s>365)return;const w=kUe(e,t,n.date,r,c,f,p),T=!!(f.disabled&&xg(w,f.disabled,p)),E=!!(f.hidden&&xg(w,f.hidden,p)),N=w,D=new qre(w,N,p);return!T&&!E?D:tie(e,t,D,r,c,f,p,s+1)}function IUe(e,t,n,r,c){const{autoFocus:f}=e,[p,s]=z.useState(),w=DUe(t.days,n,r||(()=>!1),p),[T,E]=z.useState(f?w:void 0);return{isFocusTarget:B=>!!w?.isEqualTo(B),setFocused:E,focused:T,blur:()=>{s(T),E(void 0)},moveFocus:(B,F)=>{if(!T)return;const K=tie(B,F,T,t.navStart,t.navEnd,e,c);K&&(t.goToDay(K),E(K))}}}function LUe(e,t){const{selected:n,required:r,onSelect:c}=e,[f,p]=oN(n,c?n:void 0),s=c?n:f,{isSameDay:w}=t,T=V=>s?.some($=>w($,V))??!1,{min:E,max:N}=e;return{selected:s,select:(V,$,B)=>{let F=[...s??[]];if(T(V)){if(s?.length===E||r&&s?.length===1)return;F=s?.filter(K=>!w(K,V))}else s?.length===N?F=[V]:F=[...F,V];return c||p(F),c?.(F,V,$,B),F},isSelected:T}}function zUe(e,t,n=0,r=0,c=!1,f=hm){const{from:p,to:s}=t||{},{isSameDay:w,isAfter:T,isBefore:E}=f;let N;if(!p&&!s)N={from:e,to:n>0?void 0:e};else if(p&&!s)w(p,e)?c?N={from:p,to:void 0}:N=void 0:E(e,p)?N={from:e,to:p}:N={from:p,to:e};else if(p&&s)if(w(p,e)&&w(s,e))c?N={from:p,to:s}:N=void 0;else if(w(p,e))N={from:p,to:n>0?void 0:e};else if(w(s,e))N={from:e,to:n>0?void 0:e};else if(E(e,p))N={from:e,to:s};else if(T(e,p))N={from:p,to:e};else if(T(e,s))N={from:p,to:e};else throw new Error("Invalid range");if(N?.from&&N?.to){const D=f.differenceInCalendarDays(N.to,N.from);r>0&&D>r?N={from:e,to:void 0}:n>1&&D<n&&(N={from:e,to:void 0})}return N}function FUe(e,t,n=hm){const r=Array.isArray(t)?t:[t];let c=e.from;const f=n.differenceInCalendarDays(e.to,e.from),p=Math.min(f,6);for(let s=0;s<=p;s++){if(r.includes(c.getDay()))return!0;c=n.addDays(c,1)}return!1}function V9(e,t,n=hm){return vg(e,t.from,!1,n)||vg(e,t.to,!1,n)||vg(t,e.from,!1,n)||vg(t,e.to,!1,n)}function BUe(e,t,n=hm){const r=Array.isArray(t)?t:[t];if(r.filter(s=>typeof s!="function").some(s=>typeof s=="boolean"?s:n.isDate(s)?vg(e,s,!1,n):Zre(s,n)?s.some(w=>vg(e,w,!1,n)):HF(s)?s.from&&s.to?V9(e,{from:s.from,to:s.to},n):!1:Xre(s)?FUe(e,s.dayOfWeek,n):Hre(s)?n.isAfter(s.before,s.after)?V9(e,{from:n.addDays(s.after,1),to:n.addDays(s.before,-1)},n):xg(e.from,s,n)||xg(e.to,s,n):Gre(s)||Wre(s)?xg(e.from,s,n)||xg(e.to,s,n):!1))return!0;const p=r.filter(s=>typeof s=="function");if(p.length){let s=e.from;const w=n.differenceInCalendarDays(e.to,e.from);for(let T=0;T<=w;T++){if(p.some(E=>E(s)))return!0;s=n.addDays(s,1)}}return!1}function UUe(e,t){const{disabled:n,excludeDisabled:r,selected:c,required:f,onSelect:p}=e,[s,w]=oN(c,p?c:void 0),T=p?c:s;return{selected:T,select:(D,V,$)=>{const{min:B,max:F}=e,K=D?zUe(D,T,B,F,f,t):void 0;return r&&n&&K?.from&&K.to&&BUe({from:K.from,to:K.to},n,t)&&(K.from=D,K.to=void 0),p||w(K),p?.(K,D,V,$),K},isSelected:D=>T&&vg(T,D,!1,t)}}function VUe(e,t){const{selected:n,required:r,onSelect:c}=e,[f,p]=oN(n,c?n:void 0),s=c?n:f,{isSameDay:w}=t;return{selected:s,select:(N,D,V)=>{let $=N;return!r&&s&&s&&w(N,s)&&($=void 0),c||p($),c?.($,N,D,V),$},isSelected:N=>s?w(s,N):!1}}function $Ue(e,t){const n=VUe(e,t),r=LUe(e,t),c=UUe(e,t);switch(e.mode){case"single":return n;case"multiple":return r;case"range":return c;default:return}}function qUe(e){let t=e;t.timeZone&&(t={...e},t.today&&(t.today=new Qc(t.today,t.timeZone)),t.month&&(t.month=new Qc(t.month,t.timeZone)),t.defaultMonth&&(t.defaultMonth=new Qc(t.defaultMonth,t.timeZone)),t.startMonth&&(t.startMonth=new Qc(t.startMonth,t.timeZone)),t.endMonth&&(t.endMonth=new Qc(t.endMonth,t.timeZone)),t.mode==="single"&&t.selected?t.selected=new Qc(t.selected,t.timeZone):t.mode==="multiple"&&t.selected?t.selected=t.selected?.map(dr=>new Qc(dr,t.timeZone)):t.mode==="range"&&t.selected&&(t.selected={from:t.selected.from?new Qc(t.selected.from,t.timeZone):void 0,to:t.selected.to?new Qc(t.selected.to,t.timeZone):void 0}));const{components:n,formatters:r,labels:c,dateLib:f,locale:p,classNames:s}=z.useMemo(()=>{const dr={...UF,...t.locale};return{dateLib:new Fg({locale:dr,weekStartsOn:t.broadcastCalendar?1:t.weekStartsOn,firstWeekContainsDate:t.firstWeekContainsDate,useAdditionalWeekYearTokens:t.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:t.useAdditionalDayOfYearTokens,timeZone:t.timeZone,numerals:t.numerals},t.dateLib),components:X6e(t.components),formatters:iUe(t.formatters),labels:{..._Ue,...t.labels},locale:dr,classNames:{...GF(),...t.classNames}}},[t.locale,t.broadcastCalendar,t.weekStartsOn,t.firstWeekContainsDate,t.useAdditionalWeekYearTokens,t.useAdditionalDayOfYearTokens,t.timeZone,t.numerals,t.dateLib,t.components,t.formatters,t.labels,t.classNames]),{captionLayout:w,mode:T,navLayout:E,numberOfMonths:N=1,onDayBlur:D,onDayClick:V,onDayFocus:$,onDayKeyDown:B,onDayMouseEnter:F,onDayMouseLeave:K,onNextClick:Y,onPrevClick:X,showWeekNumber:ae,styles:Z}=t,{formatCaption:se,formatDay:he,formatMonthDropdown:ye,formatWeekNumber:Ce,formatWeekNumberHeader:Ve,formatWeekdayName:Re,formatYearDropdown:$e}=r,nt=OUe(t,f),{days:Me,months:rt,navStart:Ee,navEnd:it,previousMonth:et,nextMonth:mt,goToMonth:He}=nt,pt=x6e(Me,t,Ee,it,f),{isSelected:We,select:Je,selected:jt}=$Ue(t,f)??{},{blur:Pt,focused:Ot,isFocusTarget:Mt,moveFocus:an,setFocused:Jt}=IUe(t,nt,pt,We??(()=>!1),f),{labelDayButton:Cn,labelGridcell:nr,labelGrid:sn,labelMonthDropdown:zr,labelNav:or,labelPrevious:Rr,labelNext:qr,labelWeekday:Nn,labelWeekNumber:ci,labelWeekNumberHeader:ui,labelYearDropdown:st}=c,qt=z.useMemo(()=>oUe(f,t.ISOWeek),[f,t.ISOWeek]),rn=T!==void 0||V!==void 0,Wn=z.useCallback(()=>{et&&(He(et),X?.(et))},[et,He,X]),Vt=z.useCallback(()=>{mt&&(He(mt),Y?.(mt))},[He,mt,Y]),un=z.useCallback((dr,Ki)=>Di=>{Di.preventDefault(),Di.stopPropagation(),Jt(dr),Je?.(dr.date,Ki,Di),V?.(dr.date,Ki,Di)},[Je,V,Jt]),hr=z.useCallback((dr,Ki)=>Di=>{Jt(dr),$?.(dr.date,Ki,Di)},[$,Jt]),$t=z.useCallback((dr,Ki)=>Di=>{Pt(),D?.(dr.date,Ki,Di)},[Pt,D]),lr=z.useCallback((dr,Ki)=>Di=>{const Ji={ArrowLeft:[Di.shiftKey?"month":"day",t.dir==="rtl"?"after":"before"],ArrowRight:[Di.shiftKey?"month":"day",t.dir==="rtl"?"before":"after"],ArrowDown:[Di.shiftKey?"year":"week","after"],ArrowUp:[Di.shiftKey?"year":"week","before"],PageUp:[Di.shiftKey?"year":"month","before"],PageDown:[Di.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(Ji[Di.key]){Di.preventDefault(),Di.stopPropagation();const[bs,Ys]=Ji[Di.key];an(bs,Ys)}B?.(dr.date,Ki,Di)},[an,B,t.dir]),ze=z.useCallback((dr,Ki)=>Di=>{F?.(dr.date,Ki,Di)},[F]),Fe=z.useCallback((dr,Ki)=>Di=>{K?.(dr.date,Ki,Di)},[K]),jn=z.useCallback(dr=>Ki=>{const Di=Number(Ki.target.value),Ji=f.setMonth(f.startOfMonth(dr),Di);He(Ji)},[f,He]),Xn=z.useCallback(dr=>Ki=>{const Di=Number(Ki.target.value),Ji=f.setYear(f.startOfMonth(dr),Di);He(Ji)},[f,He]),{className:mr,style:Ur}=z.useMemo(()=>({className:[s[Vi.Root],t.className].filter(Boolean).join(" "),style:{...Z?.[Vi.Root],...t.style}}),[s,t.className,t.style,Z]),yi=Z6e(t),Hi=z.useRef(null);TUe(Hi,!!t.animate,{classNames:s,months:rt,focused:Ot,dateLib:f});const xr={dayPickerProps:t,selected:jt,select:Je,isSelected:We,months:rt,nextMonth:mt,previousMonth:et,goToMonth:He,getModifiers:pt,components:n,classNames:s,styles:Z,labels:c,formatters:r};return _e.createElement(Yre.Provider,{value:xr},_e.createElement(n.Root,{rootRef:t.animate?Hi:void 0,className:mr,style:Ur,dir:t.dir,id:t.id,lang:t.lang,nonce:t.nonce,title:t.title,role:t.role,"aria-label":t["aria-label"],...yi},_e.createElement(n.Months,{className:s[Vi.Months],style:Z?.[Vi.Months]},!t.hideNavigation&&!E&&_e.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:s[Vi.Nav],style:Z?.[Vi.Nav],"aria-label":or(),onPreviousClick:Wn,onNextClick:Vt,previousMonth:et,nextMonth:mt}),rt.map((dr,Ki)=>{const Di=sUe(dr.date,Ee,it,r,f),Ji=lUe(Ee,it,r,f);return _e.createElement(n.Month,{"data-animated-month":t.animate?"true":void 0,className:s[Vi.Month],style:Z?.[Vi.Month],key:Ki,displayIndex:Ki,calendarMonth:dr},E==="around"&&!t.hideNavigation&&Ki===0&&_e.createElement(n.PreviousMonthButton,{type:"button",className:s[Vi.PreviousMonthButton],tabIndex:et?void 0:-1,"aria-disabled":et?void 0:!0,"aria-label":Rr(et),onClick:Wn,"data-animated-button":t.animate?"true":void 0},_e.createElement(n.Chevron,{disabled:et?void 0:!0,className:s[Vi.Chevron],orientation:t.dir==="rtl"?"right":"left"})),_e.createElement(n.MonthCaption,{"data-animated-caption":t.animate?"true":void 0,className:s[Vi.MonthCaption],style:Z?.[Vi.MonthCaption],calendarMonth:dr,displayIndex:Ki},w?.startsWith("dropdown")?_e.createElement(n.DropdownNav,{className:s[Vi.Dropdowns],style:Z?.[Vi.Dropdowns]},w==="dropdown"||w==="dropdown-months"?_e.createElement(n.MonthsDropdown,{className:s[Vi.MonthsDropdown],"aria-label":zr(),classNames:s,components:n,disabled:!!t.disableNavigation,onChange:jn(dr.date),options:Di,style:Z?.[Vi.Dropdown],value:f.getMonth(dr.date)}):_e.createElement("span",null,ye(dr.date,f)),w==="dropdown"||w==="dropdown-years"?_e.createElement(n.YearsDropdown,{className:s[Vi.YearsDropdown],"aria-label":st(f.options),classNames:s,components:n,disabled:!!t.disableNavigation,onChange:Xn(dr.date),options:Ji,style:Z?.[Vi.Dropdown],value:f.getYear(dr.date)}):_e.createElement("span",null,$e(dr.date,f)),_e.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},se(dr.date,f.options,f))):_e.createElement(n.CaptionLabel,{className:s[Vi.CaptionLabel],role:"status","aria-live":"polite"},se(dr.date,f.options,f))),E==="around"&&!t.hideNavigation&&Ki===N-1&&_e.createElement(n.NextMonthButton,{type:"button",className:s[Vi.NextMonthButton],tabIndex:mt?void 0:-1,"aria-disabled":mt?void 0:!0,"aria-label":qr(mt),onClick:Vt,"data-animated-button":t.animate?"true":void 0},_e.createElement(n.Chevron,{disabled:mt?void 0:!0,className:s[Vi.Chevron],orientation:t.dir==="rtl"?"left":"right"})),Ki===N-1&&E==="after"&&!t.hideNavigation&&_e.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:s[Vi.Nav],style:Z?.[Vi.Nav],"aria-label":or(),onPreviousClick:Wn,onNextClick:Vt,previousMonth:et,nextMonth:mt}),_e.createElement(n.MonthGrid,{role:"grid","aria-multiselectable":T==="multiple"||T==="range","aria-label":sn(dr.date,f.options,f)||void 0,className:s[Vi.MonthGrid],style:Z?.[Vi.MonthGrid]},!t.hideWeekdays&&_e.createElement(n.Weekdays,{"data-animated-weekdays":t.animate?"true":void 0,className:s[Vi.Weekdays],style:Z?.[Vi.Weekdays]},ae&&_e.createElement(n.WeekNumberHeader,{"aria-label":ui(f.options),className:s[Vi.WeekNumberHeader],style:Z?.[Vi.WeekNumberHeader],scope:"col"},Ve()),qt.map((bs,Ys)=>_e.createElement(n.Weekday,{"aria-label":Nn(bs,f.options,f),className:s[Vi.Weekday],key:Ys,style:Z?.[Vi.Weekday],scope:"col"},Re(bs,f.options,f)))),_e.createElement(n.Weeks,{"data-animated-weeks":t.animate?"true":void 0,className:s[Vi.Weeks],style:Z?.[Vi.Weeks]},dr.weeks.map((bs,Ys)=>_e.createElement(n.Week,{className:s[Vi.Week],key:bs.weekNumber,style:Z?.[Vi.Week],week:bs},ae&&_e.createElement(n.WeekNumber,{week:bs,style:Z?.[Vi.WeekNumber],"aria-label":ci(bs.weekNumber,{locale:p}),className:s[Vi.WeekNumber],scope:"row",role:"rowheader"},Ce(bs.weekNumber,f)),bs.days.map(Vr=>{const{date:Rt}=Vr,Jr=pt(Vr);if(Jr[Go.focused]=!Jr.hidden&&!!Ot?.isEqualTo(Vr),Jr[If.selected]=We?.(Rt)||Jr.selected,HF(jt)){const{from:gt,to:Q}=jt;Jr[If.range_start]=!!(gt&&Q&&f.isSameDay(Rt,gt)),Jr[If.range_end]=!!(gt&&Q&&f.isSameDay(Rt,Q)),Jr[If.range_middle]=vg(jt,Rt,!0,f)}const xa=aUe(Jr,Z,t.modifiersStyles),ka=_6e(Jr,s,t.modifiersClassNames),Dr=!rn&&!Jr.hidden?nr(Rt,Jr,f.options,f):void 0;return _e.createElement(n.Day,{key:`${f.format(Rt,"yyyy-MM-dd")}_${f.format(Vr.displayMonth,"yyyy-MM")}`,day:Vr,modifiers:Jr,className:ka.join(" "),style:xa,role:"gridcell","aria-selected":Jr.selected||void 0,"aria-label":Dr,"data-day":f.format(Rt,"yyyy-MM-dd"),"data-month":Vr.outside?f.format(Rt,"yyyy-MM"):void 0,"data-selected":Jr.selected||void 0,"data-disabled":Jr.disabled||void 0,"data-hidden":Jr.hidden||void 0,"data-outside":Vr.outside||void 0,"data-focused":Jr.focused||void 0,"data-today":Jr.today||void 0},!Jr.hidden&&rn?_e.createElement(n.DayButton,{className:s[Vi.DayButton],style:Z?.[Vi.DayButton],type:"button",day:Vr,modifiers:Jr,disabled:Jr.disabled||void 0,tabIndex:Mt(Vr)?0:-1,"aria-label":Cn(Rt,Jr,f.options,f),onClick:un(Vr,Jr),onBlur:$t(Vr,Jr),onFocus:hr(Vr,Jr),onKeyDown:lr(Vr,Jr),onMouseEnter:ze(Vr,Jr),onMouseLeave:Fe(Vr,Jr)},he(Rt,f.options,f)):!Jr.hidden&&he(Vr.date,f.options,f))}))))))})),t.footer&&_e.createElement(n.Footer,{className:s[Vi.Footer],style:Z?.[Vi.Footer],role:"status","aria-live":"polite"},t.footer)))}function nie({className:e,classNames:t,showOutsideDays:n=!0,captionLayout:r="label",buttonVariant:c="ghost",formatters:f,components:p,...s}){const w=GF();return o.jsx(qUe,{showOutsideDays:n,className:Rn("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,e),captionLayout:r,formatters:{formatMonthDropdown:T=>T.toLocaleString("default",{month:"short"}),...f},classNames:{root:Rn("w-fit",w.root),months:Rn("flex gap-4 flex-col md:flex-row relative",w.months),month:Rn("flex flex-col w-full gap-4",w.month),nav:Rn("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",w.nav),button_previous:Rn(X0({variant:c}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",w.button_previous),button_next:Rn(X0({variant:c}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",w.button_next),month_caption:Rn("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",w.month_caption),dropdowns:Rn("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",w.dropdowns),dropdown_root:Rn("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",w.dropdown_root),dropdown:Rn("absolute bg-popover inset-0 opacity-0",w.dropdown),caption_label:Rn("select-none font-medium",r==="label"?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",w.caption_label),table:"w-full border-collapse",weekdays:Rn("flex",w.weekdays),weekday:Rn("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",w.weekday),week:Rn("flex w-full mt-2",w.week),week_number_header:Rn("select-none w-(--cell-size)",w.week_number_header),week_number:Rn("text-[0.8rem] select-none text-muted-foreground",w.week_number),day:Rn("relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",w.day),range_start:Rn("rounded-l-md bg-accent",w.range_start),range_middle:Rn("rounded-none",w.range_middle),range_end:Rn("rounded-r-md bg-accent",w.range_end),today:Rn("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",w.today),outside:Rn("text-muted-foreground aria-selected:text-muted-foreground",w.outside),disabled:Rn("text-muted-foreground opacity-50",w.disabled),hidden:Rn("invisible",w.hidden),...t},components:{Root:({className:T,rootRef:E,...N})=>o.jsx("div",{"data-slot":"calendar",ref:E,className:Rn(T),...N}),Chevron:({className:T,orientation:E,...N})=>E==="left"?o.jsx(WW,{className:Rn("size-4",T),...N}):E==="right"?o.jsx(Mb,{className:Rn("size-4",T),...N}):o.jsx(LE,{className:Rn("size-4",T),...N}),DayButton:HUe,WeekNumber:({children:T,...E})=>o.jsx("td",{...E,children:o.jsx("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:T})}),...p},...s})}function HUe({className:e,day:t,modifiers:n,...r}){const c=GF(),f=z.useRef(null);return z.useEffect(()=>{n.focused&&f.current?.focus()},[n.focused]),o.jsx(kt,{ref:f,variant:"ghost",size:"icon","data-day":t.date.toLocaleDateString(),"data-selected-single":n.selected&&!n.range_start&&!n.range_end&&!n.range_middle,"data-range-start":n.range_start,"data-range-end":n.range_end,"data-range-middle":n.range_middle,className:Rn("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",c.day,e),...r})}function $9({value:e,onChange:t}){return o.jsxs(OT,{children:[o.jsx(DT,{asChild:!0,children:o.jsxs(kt,{variant:"outline","data-empty":!e,className:"data-[empty=true]:text-muted-foreground w-full justify-start text-left font-normal",children:[o.jsx(Hp,{}),e?lv(e,"PPP"):o.jsx("span",{children:"Pick a date"})]})}),o.jsx(kT,{className:"w-auto p-0",children:o.jsx(nie,{mode:"single",selected:e,onSelect:t,initialFocus:!0})})]})}function GUe({item:e}){const{register:t,handleSubmit:n,control:r,reset:c,formState:{errors:f,isSubmitting:p}}=dv({});z.useEffect(()=>{e&&c({id:e.id,vin:e.vin,make:e.make,model:e.model,year:e.year,type:e.type,capacity:e.capacity,seats:e.seats,fuel_efficiency:e.fuel_efficiency,height:e.height,width:e.width,status:e.status})},[e,c]);const[s,w]=z.useState(!1),T=async N=>{try{let D=await Qa.vehicles.update(N);D.status===200&&(Zt.success(D.data,{position:"top-center"}),w(!1))}catch(D){D.response?.status===422?Zt.error(D.response.data.message):Zt.error("Server Error")}},E=()=>{c({id:e.id,vin:e.vin,make:e.make,model:e.model,year:e.year,type:e.type,capacity:e.capacity,seats:e.seats,fuel_efficiency:e.fuel_efficiency,height:e.height,width:e.width,status:e.status}),w(!1)};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"w-full py-2 px-6 flex justify-between",children:[o.jsx("h2",{className:"text-2xl mb-0 font-medium",children:"Details"}),s?o.jsxs("div",{className:"flex justify-between gap-2",children:[o.jsx(kt,{type:"submit",form:"vehicle_form",disabled:p,children:p?"Saving...":"Save Changes"}),o.jsx(kt,{variant:"outline",type:"button",onClick:E,disabled:p,children:"Cancel"})]}):o.jsx(kt,{type:"button",onClick:()=>w(!0),children:"Edit"})]}),o.jsx(Oc,{}),o.jsx("div",{className:"py-3 px-8",children:o.jsxs("form",{onSubmit:n(T),id:"vehicle_form",children:[o.jsx("input",{...t("id"),type:"hidden"}),o.jsxs("div",{className:"grid gap-3 mb-3",children:[o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsx(bt,{children:"VIN"}),o.jsx(On,{...t("vin",{required:"VIN is required",minLength:{value:17,message:"VIN must be 17 characters"},maxLength:{value:17,message:"VIN must be 17 characters"}}),type:"text",disabled:!s}),f.vin&&o.jsx("p",{className:"text-red-500",children:f.vin.message})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("div",{className:"flex flex-col flex-1",children:[o.jsx(bt,{children:"Brand"}),o.jsx(On,{...t("make",{required:"Brand is required!"}),type:"text",disabled:!s}),f.make&&o.jsx("p",{className:"text-red-500",children:f.make.message})]}),o.jsxs("div",{className:"flex flex-col flex-1",children:[o.jsx(bt,{children:"Model"}),o.jsx(On,{...t("model",{required:"Model is required!"}),type:"text",disabled:!s}),f.model&&o.jsx("p",{className:"text-red-500",children:f.model.message})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Year"}),o.jsx(Qx,{name:"year",control:r,rules:{required:"Year is required!"},render:({field:N})=>o.jsx(sre,{startYear:1990,value:N.value?.toString(),onChange:D=>N.onChange(String(D)),disabled:!s})}),f.year&&o.jsx("p",{className:"text-red-500",children:f.year.message})]}),o.jsx("div",{className:"flex gap-2",children:o.jsxs("div",{className:"flex flex-col flex-1",children:[o.jsx(bt,{children:"Type"}),o.jsx(On,{...t("type",{required:"Type is required!"}),disabled:!s,className:"w-full"}),f.type&&o.jsx("p",{className:"text-red-500",children:f.type.message})]})}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("div",{className:"flex flex-col flex-1",children:[o.jsx(bt,{children:"Capacity (kg)"}),o.jsx(On,{...t("capacity"),type:"number",disabled:!s}),f.capacity&&o.jsx("p",{className:"text-red-500",children:f.capacity.message})]}),o.jsxs("div",{className:"flex flex-col flex-1",children:[o.jsx(bt,{children:"Seats"}),o.jsx(On,{...t("seats"),type:"number",disabled:!s}),f.seats&&o.jsx("p",{className:"text-red-500",children:f.seats.message})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Fuel Efficiency (L/100km)"}),o.jsx(On,{...t("fuel_efficiency",{required:"Required"}),type:"number",step:"0.01",disabled:!s}),f.fuel_efficiency&&o.jsx("p",{className:"text-red-500",children:f.fuel_efficiency.message})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("div",{className:"flex flex-col flex-1",children:[o.jsx(bt,{children:"Height (m)"}),o.jsx(On,{...t("height"),type:"number",step:"0.01",disabled:!s}),f.height&&o.jsx("p",{className:"text-red-500",children:f.height.message})]}),o.jsxs("div",{className:"flex flex-col flex-1",children:[o.jsx(bt,{children:"Width (m)"}),o.jsx(On,{...t("width"),type:"number",step:"0.01",disabled:!s}),f.width&&o.jsx("p",{className:"text-red-500",children:f.width.message})]})]})]})]})})]})}function WUe({id:e}){const{register:t,handleSubmit:n,reset:r,formState:{errors:c,isSubmitting:f}}=dv({}),p=async s=>{if(!s.id)return;if(!s.image||s.image.length===0){Zt.error("Please select an image to upload");return}const w=new FormData;w.append("id",s.id),w.append("image",s.image[0]),console.log(s);try{const T=await Qa.vehicles.changeImage(w);Zt.success("Image uploaded successfully!"),r()}catch(T){console.error(T),Zt.error(T.response?.data?.message||"Failed to upload image")}};return o.jsxs(ds,{children:[o.jsx(kf,{asChild:!0,children:o.jsx(kt,{children:"Edit"})}),o.jsxs(gs,{children:[o.jsxs(ys,{children:[o.jsx(vs,{children:"Upload an Image"}),o.jsx(Cc,{children:"Image size should be less than 2MB"})]}),o.jsxs("form",{onSubmit:n(p),children:[o.jsx("input",{...t("id",{rules:{required:!0}}),type:"hidden",defaultValue:e}),o.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(bt,{children:"Vehicle Image"}),c.image&&o.jsx(Jc,{className:"text-red-500",children:c.image.message})]}),o.jsx(On,{...t("image",{rules:{required:"Image is required"}}),type:"file",accept:"image/*",className:c.image?"border-red-500 focus-visible:ring-red-300":""})]}),o.jsx(kt,{type:"submit",disabled:f,children:f?"Uploading":"Upload"})]})]})]})}function XUe({id:e}){const{register:t,handleSubmit:n,reset:r,setValue:c,control:f,formState:{errors:p,isSubmitting:s}}=dv(),w=async T=>{const E=new FormData;E.append("vehicle_id",e),E.append("document_type",T.document_type),E.append("document_name",T.document_name),T.provider&&E.append("provider",T.provider),T.issue_date&&E.append("issue_date",T.issue_date),T.expiry_date&&E.append("expiry_date",T.expiry_date),T.document_file?.[0]&&E.append("document_file",T.document_file[0]);try{(await Qa.vdocuments.upload(E)).status===200&&(Zt.success("Document uploaded successfully"),r())}catch(N){N.response?.status===422?Zt.error(N.response.data.message||"Validation failed"):Zt.error("Upload failed")}};return o.jsxs(ds,{children:[o.jsx(kf,{asChild:!0,children:o.jsx(kt,{children:"Add"})}),o.jsxs(gs,{children:[o.jsxs(ys,{children:[o.jsx(vs,{children:"Upload document"}),o.jsx(Cc,{children:"Supported formats: PDF, DOC/DOCX, Images (jpg/png)."})]}),o.jsxs("form",{onSubmit:n(w),className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx(bt,{className:"mb-2",children:"Document Type"}),o.jsxs(Fs,{onValueChange:T=>c("document_type",T),className:"w-full",children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select type"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Registration",children:"Registration"}),o.jsx(Gn,{value:"Insurance",children:"Insurance"}),o.jsx(Gn,{value:"Inspection",children:"Inspection"}),o.jsx(Gn,{value:"Other",children:"Other"})]})]}),p.document_type&&o.jsx("p",{className:"text-red-500",children:p.document_type.message})]}),o.jsxs("div",{className:"w-full",children:[o.jsx(bt,{className:"mb-2",children:"Document Name"}),o.jsx(On,{...t("document_name",{required:"Document name is required"}),type:"text"}),p.document_name&&o.jsx("p",{className:"text-red-500",children:p.document_name.message})]}),o.jsxs("div",{children:[o.jsx(bt,{className:"mb-2",children:"Provider"}),o.jsx(On,{...t("provider"),type:"text"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx(bt,{className:"mb-2",children:"Issue Date"}),o.jsx(Qx,{name:"issue_date",control:f,render:({field:T})=>o.jsx($9,{className:"w-full",value:T.value?new Date(T.value):void 0,onChange:E=>T.onChange(E?E.toISOString().split("T")[0]:"")})}),p.issue_date&&o.jsx("p",{className:"text-red-500",children:p.issue_date.message})]}),o.jsxs("div",{className:"flex-1",children:[o.jsx(bt,{className:"mb-2",children:"Expiry Date"}),o.jsx(Qx,{name:"expiry_date",control:f,render:({field:T})=>o.jsx($9,{value:T.value?new Date(T.value):void 0,onChange:E=>T.onChange(E?E.toISOString().split("T")[0]:"")})}),p.expiry_date&&o.jsx("p",{className:"text-red-500",children:p.expiry_date.message})]})]}),o.jsxs("div",{className:"",children:[o.jsx(bt,{className:"mb-2",children:"Upload File"}),o.jsx(On,{...t("document_file",{required:"File is required"}),type:"file",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png"}),p.document_file&&o.jsx("p",{className:"text-red-500",children:p.document_file.message})]}),o.jsx("div",{className:"flex justify-end gap-2",children:o.jsx(kt,{type:"submit",disabled:s,children:s?"Uploading...":"Submit"})})]})]})]})}function ZUe({id:e}){Qa.broadcast.config();const[t,n]=z.useState(),r=z.useCallback(()=>{e&&Qa.vdocuments.get({vehicle_id:e}).then(c=>{n(c.data.documents)}).catch(c=>{console.log(c)})},[e]);return z.useEffect(()=>{r()},[r]),Kb("vehicle_document_channel","VehicleDocumentEvents",c=>{c.record&&n(f=>c.action==="deleted"?f.filter(p=>p.id!==c.record.id):Bne(f,c.record,"id"))}),o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"w-full py-2 px-6 flex justify-between",children:[o.jsx("h2",{className:"text-2xl mb-0 font-medium",children:"Documents"}),o.jsx(XUe,{id:e})]}),o.jsx(Oc,{}),o.jsx("div",{className:"py-4 px-8",children:!t||t.length===0?o.jsx("div",{className:"p-4",children:o.jsx("p",{className:"block text-center font-medium text-xl text-secondary-foreground",children:"No vehicle documents found."})}):o.jsx(B5e,{type:"single",collapsible:!0,className:"w-full",children:t.map((c,f)=>o.jsxs(U5e,{value:`item-${f}`,children:[o.jsx(V5e,{className:"flex justify-between px-2 py-1",children:o.jsxs("div",{className:"flex gap-2",children:[o.jsx(_i,{children:c.document_type}),o.jsx("h2",{className:"mb-0 font-medium",children:c.document_name})]})}),o.jsxs($5e,{className:"px-4 py-2 space-y-1",children:[o.jsx("div",{className:"flex",children:o.jsxs(bt,{children:["Provider ",o.jsx(bt,{className:"font-normal",children:c.provider})]})}),o.jsx("div",{className:"flex",children:o.jsxs(bt,{children:["Issue Date: ",o.jsx(bt,{className:"font-normal",children:lv(c.issue_date,"PPP")})]})}),o.jsx("div",{className:"flex",children:o.jsxs(bt,{children:["Expiry Date: ",o.jsx(bt,{className:"font-normal",children:lv(c.expiry_date,"PPP")})]})}),o.jsxs("div",{className:"flex",children:[o.jsx(bt,{children:"File: "}),o.jsx("a",{href:c.document_url,target:"_blank",className:"px-4 decoration-1",children:c.document_file.replace("vehicle_documents/","")})]})]})]},f))})})]})}function YUe({item:e}){return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-full py-2 px-6 flex justify-between",children:o.jsx("h2",{className:"text-2xl mb-0 font-medium",children:"Maintenance Details"})}),o.jsx(Oc,{}),o.jsxs("div",{className:"py-4 px-8",children:[o.jsx("h4",{children:"Last Maintenance Date: 9/24/2025"}),o.jsx("h4",{children:"Overall Status: Good"}),o.jsx("h4",{children:"Known Issues: None"}),o.jsx("h4",{children:"Verified By: Logistics 1"})]})]})}function q9({id:e,main_message:t,message:n,buttonTitle:r,type:c,status:f}){const{handleSubmit:p,formState:{isSubmitting:s}}=dv(),[w,T]=z.useState(!1),E=async()=>{const N={id:e,status:f};await Qa.vehicles.updateStatus(N).then(D=>{D.status==200&&Zt.success("Request Sent"),T(!1)}).catch(D=>{Zt.error("Something went wrong"),console.log(D.message)})};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-full py-2 px-6 flex justify-between",children:o.jsx("h2",{className:"text-2xl mb-0 font-medium",children:"Danger Zone"})}),o.jsxs("div",{className:"flex w-full items-center justify-between px-6 py-4 rounded-md border",children:[o.jsx("p",{className:"text-sm leading-relaxed max-w-[70%]",children:t}),o.jsxs(xE,{open:w,onOpenChange:T,children:[o.jsx(_E,{asChild:!0,children:o.jsx(kt,{className:(c==="danger"?"bg-destructive ":"")+"ml-6 shrink-0 px-4 py-2",children:r})}),o.jsx(bE,{children:o.jsxs("form",{onSubmit:p(E),children:[o.jsxs(wE,{children:[o.jsx(TE,{children:"Are you absolutely sure?"}),o.jsx(AE,{children:n})]}),o.jsxs(SE,{children:[o.jsx(jE,{type:"button",children:"Cancel"}),o.jsx(kt,{type:"submit",variant:"destructive",disabled:s,children:s?"Processing...":"Continue"})]})]})})]})]})]})}Qa.broadcast.config();function KUe(){const{uuid:e}=NE(),[t,n]=z.useState(),[r,c]=z.useState(!1),[f,p]=z.useState(!1),s=z.useCallback(()=>{!e&&!Qa||Qa.vehicles.details({uuid:e}).then(E=>{console.log(E.data.record),n(E.data.record)}).catch(E=>{f||(Zt.error("Failed to vehicle details"),p(!0))}).finally(()=>c(!1))},[e,f,Qa]);return z.useEffect(()=>{c(!0),e&&s()},[s]),Kb("vehicle_channel","VehicleEvents",E=>{const N=E.record;N&&N.uuid===e&&n(D=>({...D,...N}))}),r&&!t?o.jsxs("div",{className:"p-4 space-y-2",children:[o.jsx(ko,{className:"h-6 w-1/3"}),o.jsx(ko,{className:"h-6 w-2/3"}),o.jsx(ko,{className:"h-48 w-full"})]}):t?o.jsxs(ju.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"w-full mb-16",children:[o.jsxs("div",{className:"w-full relative max-h-[200px] h-1/4 mb-2",children:[o.jsx("img",{src:t.image_url,alt:"",className:"h-full w-full object-contain z-10",loading:"lazy"}),o.jsx("div",{className:"absolute bottom-10 right-10",children:o.jsx(WUe,{id:t.id})}),o.jsxs("div",{className:"absolute top-10 left-10",children:[o.jsx(_i,{children:o.jsx("h2",{className:"text-xl mb-0",children:t?.status})}),o.jsx("h1",{className:"text-3xl mb-0",children:t?.vin})]})]}),o.jsx("div",{className:"flex-1 border rounded-md shadow max-h-dvh mb-5",children:o.jsx(YUe,{item:t})}),o.jsx("div",{className:"flex-1 border rounded-md shadow max-h-dvh mb-5",children:o.jsx(GUe,{item:t})}),o.jsx("div",{className:"flex-1 border rounded-md shadow max-h-dvh mb-5",children:t?.id?o.jsx(ZUe,{id:t.id}):o.jsx(o.Fragment,{})}),o.jsx("div",{className:"flex-1 border rounded-md shadow max-h-dvh mb-5",children:t?.status!=="Retired"&&t?.status!=="Reserved"?o.jsx(q9,{id:t.id,main_message:"This will prevent the system from suggesting the vehicles in any trip.",message:"Are you sure you want to retire this vehicle? This will prevent the system from suggesting the vehicles in any trip.",buttonTitle:"Retire",type:"danger",status:"Retired"}):t?.status==="Retired"?o.jsx(q9,{id:t.id,main_message:"Make this vehicle available again, system will include it in trip vehicles.",message:"Are you sure to make this vehicle available again?",buttonTitle:"Enable",type:"normal",status:"Available"}):o.jsx("div",{className:"flex w-full items-center justify-between px-6 py-4 rounded-md border",children:o.jsx("p",{className:"text-sm leading-relaxed max-w-[70%]",children:"This is danger zone, Nothing to show to you, come back later"})})})]}):o.jsx("div",{className:"p-4",children:o.jsx("p",{className:"block text-center font-medium text-4xl text-secondary",children:"No vehicle details found."})})}function rie({list:e=[],recordName:t="record",columns:n=[]}){const r=c=>{if(c==null)return"";const f=new Date(c);return!isNaN(f.getTime())&&typeof c=="string"&&/\d{4}-\d{2}-\d{2}/.test(c)?lv(f,"PPpp"):c};return o.jsxs(Pc,{children:[e.length===0&&o.jsxs(VFe,{children:["No ",t," found in the records."]}),o.jsx(Mc,{children:o.jsx(zi,{children:n.map((c,f)=>o.jsx(vr,{className:c.cellClassName||"",children:c.title},f))})}),o.jsx(Rc,{children:e.map((c,f)=>o.jsx(ju.tr,{initial:{opacity:0},animate:{opacity:1},transition:{delay:f*.05},children:n.map((p,s)=>{const w=p.render?p.render(c):c[p.accessor];return o.jsx(qn,{className:p.cellClassName||"",children:r(w)},s)})},f))})]})}Qa.broadcast.config();const JUe=[{title:"Batch",accessor:"batch_number",cellClassName:"font-medium h-1"},{title:"Requestor",accessor:"requestor_uuid",cellClassName:"h-1"},{title:"Status",accessor:"status",cellClassName:"h-1"},{title:"Created",accessor:"created_at",cellClassName:"h-1"},{render:e=>o.jsx(Yl,{to:`${e.batch_number}`,children:o.jsx(kt,{variant:"",size:"sm",children:o.jsx(Mb,{})})})}];function QUe(){const[e,t]=z.useState(),[n,r]=z.useState(1),[c,f]=z.useState(),[p,s]=z.useState(""),w=z.useCallback(()=>{Qa.reservations.list({q:p||void 0}).then(T=>{let E=T.data.reservations;t(E.data||[]),f(E.last_page)}).catch(()=>{Zt.error("Error fetching reservations",{position:"top-center"})})},[n,p]);return z.useEffect(()=>{let T=setTimeout(w,300);return()=>{clearTimeout(T)}},[w]),z.useEffect(()=>{let T=setInterval(w,2e3);return()=>{clearInterval(T)}},[w]),Kb("reservation_channel","ReservationUpdates",T=>{let E=T.reservations;t(N=>N.find(V=>V.id===E.id)?N.map(V=>V.id===E.id?E:V):[...N,E])}),o.jsx(ju.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex gap-2 h-full px-4",children:o.jsxs("div",{className:"flex flex-col flex-2 h-full",children:[o.jsxs("div",{className:"flex-4/5",children:[o.jsxs("div",{className:"flex mb-3 gap-2",children:[o.jsx(On,{placeholder:"Search Reservations",value:p,onChange:T=>s(T.target.value)}),o.jsx(Yl,{to:"make",children:o.jsx(kt,{children:"Make Reservation"})})]}),o.jsx("div",{className:"min-h-96",children:o.jsx(rie,{list:e,recordName:"reservations",columns:JUe})})]}),o.jsx(iN,{className:"flex-2/12",totalPage:c,page:n,setPage:r})]})})}function eVe(){const[e,t]=z.useState([]),[n,r]=z.useState(1),[c,f]=z.useState(1),[p,s]=z.useState(""),w=z.useCallback(()=>{Qa.dispatches.list({page:n,q:p||void 0}).then(T=>{const E=T.data.dispatches;t(E),f(E.last_page||1)}).catch(()=>{Zt.error("Error fetching dispatch records",{position:"top-center"})})},[n,p]);return z.useEffect(()=>{const T=setTimeout(w,300);return()=>clearTimeout(T)},[w]),z.useEffect(()=>{const T=setInterval(w,5e3);return()=>clearInterval(T)},[w]),console.log(e),o.jsxs(ju.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex flex-col gap-4 h-full px-4",children:[o.jsxs("div",{className:"flex-4/5",children:[o.jsx("div",{className:"flex mb-3 gap-2",children:o.jsx(On,{placeholder:"Search Dispatch",value:p,onChange:T=>s(T.target.value)})}),o.jsx("div",{className:"flex flex-col gap-6 min-h-96",children:e.length===0?o.jsx("p",{className:"text-gray-500 text-center",children:"No dispatch records found."}):e.map(T=>o.jsxs("div",{className:"border rounded p-4 shadow-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("h3",{className:"font-bold mb-2 text-lg",children:T.batch_number}),o.jsx(Yl,{to:T.batch_number,children:o.jsx(kt,{children:o.jsx(Iue,{})})})]}),o.jsx("div",{className:"space-y-1",children:T.reservations&&T.reservations.length>0?T.reservations.map(E=>o.jsxs("div",{className:"px-4 py-2 flex w-full rounded-md p-2",children:[o.jsx(bt,{className:"font-light flex-1",children:E.dispatch_uuid}),o.jsx("div",{className:"flex-1",children:o.jsx(_i,{className:"rounded-full p-2 w-[100px]",children:E.dispatch_status})})]},E.dispatch_id)):o.jsx("p",{className:"text-gray-500",children:"No reservations in this batch."})})]},T.batch_number))})]}),o.jsx(iN,{totalPage:c,page:n,setPage:r,className:"flex-2/12"})]})}function tVe({cost:e,distance:t,duration:n}){return o.jsxs("div",{className:"flex w-full gap-2",children:[o.jsxs(ni,{className:"flex-1 rounded-md bg-card/80 backdrop-blur-md",children:[o.jsxs(Ns,{className:"flex-grow",children:[o.jsx(us,{children:"Dispatch spend"}),o.jsx(Nc,{children:"Live dispatch cost"})]}),o.jsxs(qi,{children:[o.jsx(bt,{className:"text-xl text-gray-500",children:"Philippine Peso"}),o.jsx(bt,{className:"text-3xl font-semibold",children:e??"N/A"})]})]}),o.jsxs(ni,{className:"flex-1 rounded-md bg-card/80 backdrop-blur-md",children:[o.jsxs(Ns,{className:"flex-grow",children:[o.jsx(us,{children:"Travel Distance"}),o.jsx(Nc,{children:"Live distance taken"})]}),o.jsxs(qi,{children:[o.jsx(bt,{className:"text-xl text-gray-500",children:"Kilometer"}),o.jsx(bt,{className:"text-3xl font-semibold",children:t??"N/A"})]})]}),o.jsxs(ni,{className:"flex-1 rounded-md bg-card/80 backdrop-blur-md",children:[o.jsxs(Ns,{className:"flex-grow",children:[o.jsx(us,{children:"Travel Duration"}),o.jsx(Nc,{children:"Live duration taken"})]}),o.jsxs(qi,{children:[o.jsx(bt,{className:"text-xl text-gray-500",children:"Minutes"}),o.jsx(bt,{className:"text-3xl font-semibold",children:n??"N/A"})]})]})]})}function nVe(){const{batch_number:e}=NE(),[t,n]=z.useState(),[r,c]=z.useState(!1),[f,p]=z.useState(!1);return o.jsx(ju.div,{className:"flex flex-col h-full w-full px-4 pb-4",children:r?o.jsx("div",{className:"w-full h-full px-4",children:o.jsx(ko,{})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"h-[70vh]"}),o.jsx("div",{className:"flex flex-col gap-2 w-full",children:o.jsx(tVe,{})})]})})}function H9(e){const t=D=>String(D).padStart(2,"0"),n=e.getFullYear(),r=t(e.getMonth()+1),c=t(e.getDate()),f=t(e.getHours()),p=t(e.getMinutes()),s=t(e.getSeconds()),w=-e.getTimezoneOffset(),T=w>=0?"+":"-",E=t(Math.floor(Math.abs(w)/60)),N=t(Math.abs(w)%60);return`${n}-${r}-${c}T${f}:${p}:${s}${T}${E}:${N}`}function j1(e){return e?/[Z+\-]\d{2}(:?\d{2})?$/.test(e)||e.endsWith("Z")?new Date(e):/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}$/.test(e)?new Date(`${e}:00`):new Date(e):null}function G9({control:e,name:t,label:n,min:r,max:c,className:f,rules:p}){return o.jsxs("div",{className:Rn("flex flex-col gap-2 mb-3",f),children:[o.jsx(bt,{htmlFor:t,className:"font-normal text-secondary-foreground",children:n}),o.jsx(Qx,{name:t,rules:p,control:e,render:({field:s})=>o.jsxs(OT,{children:[o.jsx(DT,{asChild:!0,children:o.jsxs(kt,{variant:"outline",className:Rn("w-full justify-start text-left font-normal",!s.value&&"text-muted-foreground"),children:[o.jsx(Hp,{className:"mr-2 h-4 w-4"}),s.value?(()=>{const w=j1(s.value);return w&&!isNaN(w)?lv(w,"PPP p"):"Pick a date & time"})():o.jsx("span",{children:"Pick a date & time"})]})}),o.jsxs(kT,{className:"w-auto p-0",children:[o.jsx(nie,{mode:"single",selected:s.value?j1(s.value):void 0,onSelect:w=>{if(!w)return;const T=s.value?j1(s.value):new Date,E=T&&!isNaN(T)?T:new Date;w.setHours(E.getHours(),E.getMinutes(),E.getSeconds()||0,0),s.onChange(H9(w))},disabled:w=>r&&w<new Date(r)||c&&w>new Date(c)}),o.jsx("div",{className:"flex items-center justify-center p-3 border-t",children:o.jsx("input",{type:"time",className:"border rounded px-2 py-1 text-sm",value:s.value?(()=>{const w=j1(s.value);return w&&!isNaN(w)?`${String(w.getHours()).padStart(2,"0")}:${String(w.getMinutes()).padStart(2,"0")}`:"00:00"})():"00:00",onChange:w=>{const T=s.value?j1(s.value):new Date,N=T&&!isNaN(T)?T:new Date,[D,V]=w.target.value.split(":");N.setHours(+D,+V,N.getSeconds()||0,0),s.onChange(H9(N))}})})]})]})})]})}const Tc=[];for(let e=0;e<256;++e)Tc.push((e+256).toString(16).slice(1));function rVe(e,t=0){return(Tc[e[t+0]]+Tc[e[t+1]]+Tc[e[t+2]]+Tc[e[t+3]]+"-"+Tc[e[t+4]]+Tc[e[t+5]]+"-"+Tc[e[t+6]]+Tc[e[t+7]]+"-"+Tc[e[t+8]]+Tc[e[t+9]]+"-"+Tc[e[t+10]]+Tc[e[t+11]]+Tc[e[t+12]]+Tc[e[t+13]]+Tc[e[t+14]]+Tc[e[t+15]]).toLowerCase()}let vk;const iVe=new Uint8Array(16);function sVe(){if(!vk){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");vk=crypto.getRandomValues.bind(crypto)}return vk(iVe)}const aVe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),W9={randomUUID:aVe};function oVe(e,t,n){e=e||{};const r=e.random??e.rng?.()??sVe();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,rVe(r)}function lVe(e,t,n){return W9.randomUUID&&!e?W9.randomUUID():oVe(e)}const X9="pk.eyJ1IjoiY2hyaXN0aWFubWFwYm94Y29tIiwiYSI6ImNtZXJ1bTcweTBhYjcya3EwZjloOG5vMjIifQ.KPbfNzCPPimuiUecFEZxCA";function cVe({label:e,name:t,register:n,setValue:r,errors:c,className:f}){const[p,s]=z.useState(""),[w,T]=z.useState([]),[E,N]=z.useState(null),[D,V]=z.useState(!1),[$,B]=z.useState(!1),[F,K]=z.useState(!1),[Y,X]=z.useState(-1),[ae]=z.useState(()=>lVe()),Z=async Ce=>{if(!Ce||Ce.length<3){T([]);return}B(!0);try{const Ve=await $r.get("https://api.mapbox.com/search/searchbox/v1/suggest",{params:{q:Ce,access_token:X9,session_token:ae,limit:5,proximity:"121.0437,14.6760",country:"ph"}});console.log(Ve.data.suggestions),T(Ve.data.suggestions||[]),X(-1)}catch(Ve){console.error("Mapbox suggest error:",Ve)}finally{B(!1)}},se=async Ce=>{try{const Re=(await $r.get(`https://api.mapbox.com/search/searchbox/v1/retrieve/${Ce.mapbox_id}`,{params:{access_token:X9,session_token:ae}})).data.features[0];if(!Re)return;let $e="";Re.properties?.name&&Re.properties?.full_address?$e=`${Re.properties.name}, ${Re.properties.full_address}`:Re.properties?.name?$e=Re.properties.name:$e=Re.properties?.full_address||"";const nt=Re.geometry?.coordinates||[],[Me,rt]=nt;s($e),T([]),V(!0),r(t,{address_name:$e,longitude:Me,latitude:rt})}catch(Ve){console.error("Mapbox retrieve error:",Ve)}},he=Ce=>{const Ve=Ce.target.value;s(Ve),V(!1),r(t,""),E&&clearTimeout(E),N(setTimeout(()=>Z(Ve),300))},ye=Ce=>{!F||w.length===0||(Ce.key==="ArrowDown"?(Ce.preventDefault(),X(Ve=>(Ve+1)%w.length)):Ce.key==="ArrowUp"?(Ce.preventDefault(),X(Ve=>Ve<=0?w.length-1:Ve-1)):Ce.key==="Enter"&&Y>=0&&(Ce.preventDefault(),se(w[Y])))};return o.jsxs("div",{className:"relative flex flex-col gap-2 w-full",children:[o.jsx(bt,{className:"font-normal text-secondary-foreground",children:e}),o.jsxs("div",{className:"relative",children:[o.jsx(On,{...n(t,{required:"Address is required"}),placeholder:e,value:p,onChange:he,onKeyDown:ye,onFocus:()=>{K(!0),Z(p)},onBlur:()=>setTimeout(()=>K(!1),200),autoComplete:"off",className:f}),$&&o.jsx($de,{className:"absolute right-2 top-2.5 h-4 w-4 animate-spin text-gray-400"})]}),!D&&p&&o.jsx(Jc,{className:"text-red-500 text-xs",children:"Please select a valid address from suggestions"}),c[t]&&o.jsx(Jc,{className:"text-red-500 text-xs",children:c[t].message}),F&&w.length>0&&o.jsx("div",{className:Rn("absolute top-full left-0 z-10 w-full rounded-md mt-1 max-h-56 bg-white overflow-y-auto border shadow-sm"),children:o.jsx("ul",{children:w.map((Ce,Ve)=>o.jsx("li",{className:Rn("p-2 cursor-pointer text-sm hover:bg-gray-100",Y===Ve&&"bg-gray-100 font-medium"),onMouseDown:()=>se(Ce),children:Ce.name&&Ce.full_address?`${Ce.name}, ${Ce.full_address}`:Ce.name?`${Ce.name}`:Ce.full_address},Ce.mapbox_id||Ve))})})]})}function uVe(){const{auth:e}=z.useContext(Vh),t=d_(),{control:n,handleSubmit:r,watch:c,register:f,formState:{errors:p,isSubmitting:s},setValue:w}=dv({defaultValues:{vehicle_ids:[{vehicle_id:""}],trip_plan:[]}}),{fields:T,append:E,remove:N}=sU({control:n,name:"vehicle_ids"}),{fields:D,append:V,remove:$}=sU({control:n,name:"trip_plan"}),[B,F]=z.useState([]),[K,Y]=z.useState(null);z.useEffect(()=>{(async()=>{try{const Ce=await Qa.vehicles.all({q:"Available"});console.log(Ce),Ce.status===200&&F(Ce.data?.vehicles||[])}catch{Zt.error("Failed to fetch available vehicles")}})()},[]);const X=c("vehicle_ids").filter(ye=>ye.vehicle_id).map(ye=>ye.vehicle_id),ae=c("trip_plan"),Z=new Date;Z.setDate(Z.getDate()+1),Z.setHours(0,0,0,0);const se=Z.toISOString().slice(0,16),he=async ye=>{if(X.length===0){Zt.error("Please select at least 1 vehicle",{position:"top-center"});return}if(ae.length<2||ae.some(Ve=>!Ve.latitude||!Ve.longitude)){Zt.error("Please provide at least 2 valid locations");return}const Ce={...ye,requestor_uuid:e.uuid,vehicle_ids:ye.vehicle_ids.map(Ve=>Ve.vehicle_id),trip_plan:ye.trip_plan.map((Ve,Re)=>({sequence:Re+1,address_name:Ve.address_name,latitude:Ve.latitude,longitude:Ve.longitude}))};try{const Ve=await Qa.reservations.submit(Ce);Ve.status===200&&(Zt.success("Reservation submitted!"),e.role==="LogisticsII Admin"?t(`/logisticsII/reservation/${Ve.data.batch_number}`):t("/logisticsII/success"))}catch(Ve){Zt.error(`Reservation failed: ${Ve.response.data}`)}};return o.jsx("div",{className:"px-1",children:o.jsxs("form",{onSubmit:r(he),className:"flex flex-col gap-4",children:[o.jsx("input",{type:"hidden",...f("requestor_uuid"),defaultValue:e.uuid}),o.jsxs("div",{className:"flex flex-col gap-4",children:[o.jsx(bt,{className:"font-medium",children:"Vehicles"}),T.map((ye,Ce)=>o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Qx,{name:`vehicle_ids.${Ce}.vehicle_id`,control:n,rules:{required:"Vehicle is required"},render:({field:Ve})=>o.jsxs(OT,{open:K===Ce,onOpenChange:Re=>Y(Re?Ce:null),children:[o.jsx(DT,{asChild:!0,children:o.jsxs(kt,{variant:"outline",role:"combobox",className:"flex-1 justify-between",children:[Ve.value?`${B.find(Re=>Re.id===Ve.value)?.type} (${B.find(Re=>Re.id===Ve.value)?.capacity})`:"Select Vehicle...",o.jsx(zE,{className:"ml-2 h-4 w-4 opacity-50"})]})}),o.jsx(kT,{className:"w-[200px] p-0",children:o.jsxs(DF,{children:[o.jsx(kF,{placeholder:"Search Vehicle..."}),o.jsxs(IF,{children:[o.jsx(LF,{children:"No Vehicle found."}),o.jsx(zF,{children:B.map(Re=>o.jsxs(FF,{disabled:X.includes(Re.id),value:Re.id,onSelect:()=>{Ve.onChange(Re.id),Y(null)},children:[o.jsx(IE,{className:Rn("mr-2 h-4 w-4",Ve.value===Re.id?"opacity-100":"opacity-0")}),Re.type," (",Re.vin,")"]},Re.id))})]})]})})]})}),T.length>1&&o.jsx(kt,{type:"button",variant:"ghost",size:"icon",onClick:()=>N(Ce),children:o.jsx(h6,{className:"h-4 w-4 text-red-500"})})]},ye.id)),o.jsxs(kt,{type:"button",variant:"secondary",onClick:()=>E({vehicle_id:""}),children:[o.jsx(Au,{className:"h-4 w-4 mr-1"})," Add Vehicle"]})]}),o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsx(bt,{className:"font-medium",children:"Date & Time"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("div",{className:"flex-1 w-full",children:[o.jsx(G9,{control:n,rules:{required:"Start Time"},className:"w-full",name:"start_dt",min:se,label:"Start Time"}),p.start_dt&&o.jsx(Jc,{className:"text-red-500",children:p.start_dt.message})]}),o.jsxs("div",{className:"flex-1 w-full",children:[o.jsx(G9,{control:n,rules:{required:"Start Time"},className:"w-full",name:"end_dt",min:c("start_dt"),label:"End Time"}),p.end_dt&&o.jsx(Jc,{className:"text-red-500",children:p.end_dt.message})]})]})]}),o.jsxs("div",{className:"flex flex-col gap-4 w-full",children:[o.jsx(bt,{className:"font-medium",children:"Trip Plan (Locations)"}),D.map((ye,Ce)=>o.jsxs("div",{className:"flex items-center gap-2 w-full",children:[o.jsx(cVe,{className:"w-full flex-1",name:`trip_plan.${Ce}`,label:`Location ${Ce+1}`,setValue:w,register:f,errors:p}),D.length>1&&o.jsx(kt,{type:"button",variant:"ghost",size:"icon",onClick:()=>$(Ce),children:o.jsx(h6,{className:"h-4 w-4 text-red-500"})})]},ye.id)),o.jsxs(kt,{type:"button",variant:"secondary",onClick:()=>V({address_name:"",latitude:"",longitude:""}),children:[o.jsx(Au,{className:"h-4 w-4 mr-1"})," Add Location"]})]}),o.jsxs("div",{children:[o.jsx(bt,{className:"font-medium",children:"Purpose"}),o.jsx(Qx,{name:"purpose",control:n,render:({field:ye})=>o.jsx(Ec,{className:"break-all",...ye})})]}),o.jsx(kt,{disabled:s,type:"submit",children:"Submit Reservation"})]})})}function dVe(){return o.jsx(ju.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex gap-2 h-full px-4",children:o.jsxs("div",{className:"flex flex-col w-full",children:[o.jsx(bt,{className:"text-xl mb-2",children:"Make Reservation"}),o.jsx("section",{children:o.jsx(uVe,{})})]})})}function hVe({record:e,onApprove:t,onReject:n,isSubmitting:r,setIsSubmitting:c}){return o.jsxs(ni,{className:"flex-1 py-4 rounded-md bg-card/80 backdrop-blur-md",children:[o.jsx(Ns,{children:o.jsxs(us,{className:"flex justify-between items-center",children:[o.jsxs("span",{className:"font-bold text-2xl tracking-tight",children:["RESERVATION ",o.jsx("span",{className:"text-primary",children:e?.batch_number})]}),e?.status==="Pending"&&e?.assignments?.length>0?o.jsxs("div",{className:"flex gap-2 items-center h-full",children:[o.jsxs(xE,{children:[o.jsx(_E,{asChild:!0,children:o.jsx(kt,{disabled:r,size:"sm",children:r?"Submitting":"Approve"})}),o.jsxs(bE,{children:[o.jsxs(wE,{children:[o.jsx(TE,{children:"Approve Reservation"}),o.jsx(AE,{children:"Are you sure you want to approve this reservation?"})]}),o.jsxs(SE,{children:[o.jsx(jE,{disabled:r,children:"Cancel"}),o.jsx(I9,{disabled:r,onClick:()=>t(c),children:r?"Submitting":"Approve"})]})]})]}),o.jsxs(xE,{children:[o.jsx(_E,{asChild:!0,children:o.jsx(kt,{variant:"destructive",disabled:r,size:"sm",children:r?"Submitting":"Reject"})}),o.jsxs(bE,{children:[o.jsxs(wE,{children:[o.jsx(TE,{children:"Reject Reservation"}),o.jsx(AE,{children:"Are you sure you want to reject this reservation?"})]}),o.jsxs(SE,{children:[o.jsx(jE,{disabled:r,children:"Cancel"}),o.jsx(I9,{disabled:r,onClick:()=>n(c),children:r?"Submitting":"Reject"})]})]})]})]}):o.jsx(_i,{className:`rounded-full py-2 px-3 flex items-center text-base font-semibold ${e?.status==="Rejected"?"bg-destructive":e?.status==="Confirmed"?"bg-green-700":""}`,children:e?.status})]})}),o.jsxs(qi,{children:[o.jsx("div",{className:"mb-4 grid grid-cols-1 gap-2",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx(bt,{className:"text-muted-foreground font-semibold",children:"Requested By:"}),o.jsx("span",{className:"font-bold text-primary",children:e?.requestor_uuid})]})}),o.jsxs("div",{className:"my-4 w-full",children:[o.jsx(bt,{className:"font-semibold text-lg",children:"Date and Time"}),o.jsx(Oc,{className:"my-2"}),o.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx(bt,{className:"text-muted-foreground font-medium",children:"Start:"}),o.jsx("span",{className:"font-bold",children:e?.start_date?lv(new Date(e.start_date),"PPp"):"N/A"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx(bt,{className:"text-muted-foreground font-medium",children:"End:"}),o.jsx("span",{className:"font-bold",children:e?.end_date?lv(new Date(e.end_date),"PPp"):"N/A"})]})]})]}),o.jsxs("div",{className:"my-4 w-full",children:[o.jsx(bt,{className:"font-semibold text-lg",children:"Trip Routes"}),o.jsx(Oc,{className:"my-2"}),o.jsx("div",{className:"flex flex-col gap-3 w-full",children:e?.trip_routes?.length>0?e.trip_routes.map((f,p)=>o.jsx("div",{className:"flex flex-col gap-1",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx(bt,{className:"text-muted-foreground font-medium",children:p===0?"Start":p===e.trip_routes.length-1?"End":`Stop ${p}`}),o.jsx("span",{className:"font-bold text-primary",children:f.full_address})]})},f.id)):o.jsx(bt,{className:"text-gray-500",children:"No trip routes available"})})]})]})]})}function fVe({onSelect:e,assignments:t,defaultValue:n}){const[r,c]=z.useState(!1),[f,p]=z.useState([]),[s,w]=z.useState(null);return z.useEffect(()=>{let T;return T=setInterval(async()=>{try{const N=await Qa.drivers.dialogDrivers({q:"Available"});N.status===200&&p(N.data?.drivers||[])}catch(N){console.error("Failed to fetch drivers",N)}},5e3),()=>clearInterval(T)},[]),o.jsxs(OT,{open:r,onOpenChange:c,children:[o.jsx(DT,{asChild:!0,children:o.jsxs(kt,{variant:"outline",role:"combobox","aria-expanded":r,className:"w-full justify-between",children:[o.jsx("span",{className:"truncate",children:n||(s?f.find(T=>T.id===s)?.name:"Select Driver...")}),o.jsx(zE,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),o.jsx(kT,{className:"w-[250px] p-0 max-h-[30vh]",children:o.jsxs(DF,{children:[o.jsx(kF,{placeholder:"Search driver..."}),o.jsxs(IF,{children:[o.jsx(LF,{children:"No driver found."}),o.jsx(zF,{children:f.map(T=>o.jsxs(FF,{value:T.id,disabled:t?.some(E=>E.driver_uuid===T.uuid)||n,onSelect:()=>{w(T.id),c(!1),e?.(T)},children:[o.jsx(IE,{className:Rn("mr-2 h-4 w-4",s===T.id?"opacity-100":"opacity-0")}),T.name," (",T.status,")"]},T.id))})]})]})})]})}function pVe({record:e,assignments:t,onAssign:n}){return o.jsxs(ni,{className:"w-full bg-card/80 backdrop-blur-md rounded-md",children:[o.jsxs(Ns,{children:[o.jsx(us,{children:"Vehicles and Drivers"}),o.jsx(Nc,{children:"Please assign drivers to the vehicles below."})]}),o.jsx(qi,{children:e?.assignments?.map((r,c)=>o.jsxs("div",{className:"flex justify-end h-48 lg:max-w-xl border",children:[o.jsx("div",{className:"w-full h-full flex-1",children:o.jsx("img",{src:r.image_url,className:"w-full h-full object-cover rounded-md",alt:"Vehicle",loading:"lazy"})}),o.jsx(Oc,{orientation:"vertical"}),o.jsxs("div",{className:"flex flex-1 flex-col p-2 gap-2",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsxs("h3",{className:"font-semibold",children:["Type: ",r.type]}),o.jsx(_i,{children:r.vehicle_status})]}),o.jsxs("h3",{className:"font-semibold",children:["Capacity: ",r.capacity]}),e.status==="Rejected"?null:r.driver_name?o.jsxs("h3",{className:"font-semibold",children:["Driver: ",r.driver_name]}):o.jsx(fVe,{assignments:t,onSelect:f=>n(r.vehicle_id,f.uuid),defaultValue:r.driver_name})]})]},c))})]})}function mVe({totalCost:e,totalDistance:t,totalDuration:n}){return o.jsxs("div",{className:"flex w-full gap-2",children:[o.jsxs(ni,{className:"flex-1 rounded-md bg-card/80 backdrop-blur-md",children:[o.jsxs(Ns,{className:"flex-grow",children:[o.jsx(us,{children:"Estimated Cost"}),o.jsx(Nc,{children:"Pre-trip estimated cost"})]}),o.jsxs(qi,{children:[o.jsx(bt,{className:"text-xl text-gray-500",children:"Philippine Peso"}),o.jsx(bt,{className:"text-3xl font-semibold",children:e??"N/A"})]})]}),o.jsxs(ni,{className:"flex-1 rounded-md bg-card/80 backdrop-blur-md",children:[o.jsxs(Ns,{className:"flex-grow",children:[o.jsx(us,{children:"Travel Distance"}),o.jsx(Nc,{children:"Total distance"})]}),o.jsxs(qi,{children:[o.jsx(bt,{className:"text-xl text-gray-500",children:"Kilometer"}),o.jsx(bt,{className:"text-3xl font-semibold",children:t??"N/A"})]})]}),o.jsxs(ni,{className:"flex-1 rounded-md bg-card/80 backdrop-blur-md",children:[o.jsxs(Ns,{className:"flex-grow",children:[o.jsx(us,{children:"Travel Duration"}),o.jsx(Nc,{children:"Total duration"})]}),o.jsxs(qi,{children:[o.jsx(bt,{className:"text-xl text-gray-500",children:"Minutes"}),o.jsx(bt,{className:"text-3xl font-semibold",children:n??"N/A"})]})]})]})}var BA={exports:{}},gVe=BA.exports,Z9;function yVe(){return Z9||(Z9=1,(function(e,t){(function(n,r){e.exports=r()})(gVe,(function(){var n,r,c;function f(s,w){if(!n)n=w;else if(!r)r=w;else{var T="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk); self.onerror = null;",E={};n(E),c=w(E),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(c.workerUrl=window.URL.createObjectURL(new Blob([T],{type:"text/javascript"})))}}f(["exports"],(function(s){var w=1e-6,T=typeof Float32Array<"u"?Float32Array:Array;function E(u,i){var l=i[0],h=i[1],g=i[2],x=i[3],b=l*x-g*h;return b?(u[0]=x*(b=1/b),u[1]=-h*b,u[2]=-g*b,u[3]=l*b,u):null}function N(){var u=new T(9);return T!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[5]=0,u[6]=0,u[7]=0),u[0]=1,u[4]=1,u[8]=1,u}function D(u,i){var l=i[0],h=i[1],g=i[2],x=i[3],b=i[4],j=i[5],M=i[6],R=i[7],L=i[8];return u[0]=b*L-j*R,u[1]=g*R-h*L,u[2]=h*j-g*b,u[3]=j*M-x*L,u[4]=l*L-g*M,u[5]=g*x-l*j,u[6]=x*R-b*M,u[7]=h*M-l*R,u[8]=l*b-h*x,u}function V(u,i,l){var h=i[0],g=i[1],x=i[2],b=i[3],j=i[4],M=i[5],R=i[6],L=i[7],U=i[8],q=l[0],ee=l[1],te=l[2],le=l[3],ue=l[4],ge=l[5],Se=l[6],we=l[7],Pe=l[8];return u[0]=q*h+ee*b+te*R,u[1]=q*g+ee*j+te*L,u[2]=q*x+ee*M+te*U,u[3]=le*h+ue*b+ge*R,u[4]=le*g+ue*j+ge*L,u[5]=le*x+ue*M+ge*U,u[6]=Se*h+we*b+Pe*R,u[7]=Se*g+we*j+Pe*L,u[8]=Se*x+we*M+Pe*U,u}function $(){var u=new T(16);return T!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u}function B(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function F(u,i){var l=i[0],h=i[1],g=i[2],x=i[3],b=i[4],j=i[5],M=i[6],R=i[7],L=i[8],U=i[9],q=i[10],ee=i[11],te=i[12],le=i[13],ue=i[14],ge=i[15],Se=l*j-h*b,we=l*M-g*b,Pe=l*R-x*b,tt=h*M-g*j,Ke=h*R-x*j,Qe=g*R-x*M,dt=L*le-U*te,ft=L*ue-q*te,Ft=L*ge-ee*te,xt=U*ue-q*le,Wt=U*ge-ee*le,bn=q*ge-ee*ue,tn=Se*bn-we*Wt+Pe*xt+tt*Ft-Ke*ft+Qe*dt;return tn?(u[0]=(j*bn-M*Wt+R*xt)*(tn=1/tn),u[1]=(g*Wt-h*bn-x*xt)*tn,u[2]=(le*Qe-ue*Ke+ge*tt)*tn,u[3]=(q*Ke-U*Qe-ee*tt)*tn,u[4]=(M*Ft-b*bn-R*ft)*tn,u[5]=(l*bn-g*Ft+x*ft)*tn,u[6]=(ue*Pe-te*Qe-ge*we)*tn,u[7]=(L*Qe-q*Pe+ee*we)*tn,u[8]=(b*Wt-j*Ft+R*dt)*tn,u[9]=(h*Ft-l*Wt-x*dt)*tn,u[10]=(te*Ke-le*Pe+ge*Se)*tn,u[11]=(U*Pe-L*Ke-ee*Se)*tn,u[12]=(j*ft-b*xt-M*dt)*tn,u[13]=(l*xt-h*ft+g*dt)*tn,u[14]=(le*we-te*tt-ue*Se)*tn,u[15]=(L*tt-U*we+q*Se)*tn,u):null}function K(u,i,l){var h=i[0],g=i[1],x=i[2],b=i[3],j=i[4],M=i[5],R=i[6],L=i[7],U=i[8],q=i[9],ee=i[10],te=i[11],le=i[12],ue=i[13],ge=i[14],Se=i[15],we=l[0],Pe=l[1],tt=l[2],Ke=l[3];return u[0]=we*h+Pe*j+tt*U+Ke*le,u[1]=we*g+Pe*M+tt*q+Ke*ue,u[2]=we*x+Pe*R+tt*ee+Ke*ge,u[3]=we*b+Pe*L+tt*te+Ke*Se,u[4]=(we=l[4])*h+(Pe=l[5])*j+(tt=l[6])*U+(Ke=l[7])*le,u[5]=we*g+Pe*M+tt*q+Ke*ue,u[6]=we*x+Pe*R+tt*ee+Ke*ge,u[7]=we*b+Pe*L+tt*te+Ke*Se,u[8]=(we=l[8])*h+(Pe=l[9])*j+(tt=l[10])*U+(Ke=l[11])*le,u[9]=we*g+Pe*M+tt*q+Ke*ue,u[10]=we*x+Pe*R+tt*ee+Ke*ge,u[11]=we*b+Pe*L+tt*te+Ke*Se,u[12]=(we=l[12])*h+(Pe=l[13])*j+(tt=l[14])*U+(Ke=l[15])*le,u[13]=we*g+Pe*M+tt*q+Ke*ue,u[14]=we*x+Pe*R+tt*ee+Ke*ge,u[15]=we*b+Pe*L+tt*te+Ke*Se,u}function Y(u,i,l){var h,g,x,b,j,M,R,L,U,q,ee,te,le=l[0],ue=l[1],ge=l[2];return i===u?(u[12]=i[0]*le+i[4]*ue+i[8]*ge+i[12],u[13]=i[1]*le+i[5]*ue+i[9]*ge+i[13],u[14]=i[2]*le+i[6]*ue+i[10]*ge+i[14],u[15]=i[3]*le+i[7]*ue+i[11]*ge+i[15]):(g=i[1],x=i[2],b=i[3],j=i[4],M=i[5],R=i[6],L=i[7],U=i[8],q=i[9],ee=i[10],te=i[11],u[0]=h=i[0],u[1]=g,u[2]=x,u[3]=b,u[4]=j,u[5]=M,u[6]=R,u[7]=L,u[8]=U,u[9]=q,u[10]=ee,u[11]=te,u[12]=h*le+j*ue+U*ge+i[12],u[13]=g*le+M*ue+q*ge+i[13],u[14]=x*le+R*ue+ee*ge+i[14],u[15]=b*le+L*ue+te*ge+i[15]),u}function X(u,i,l){var h=l[0],g=l[1],x=l[2];return u[0]=i[0]*h,u[1]=i[1]*h,u[2]=i[2]*h,u[3]=i[3]*h,u[4]=i[4]*g,u[5]=i[5]*g,u[6]=i[6]*g,u[7]=i[7]*g,u[8]=i[8]*x,u[9]=i[9]*x,u[10]=i[10]*x,u[11]=i[11]*x,u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15],u}function ae(u,i,l){var h=Math.sin(l),g=Math.cos(l),x=i[4],b=i[5],j=i[6],M=i[7],R=i[8],L=i[9],U=i[10],q=i[11];return i!==u&&(u[0]=i[0],u[1]=i[1],u[2]=i[2],u[3]=i[3],u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15]),u[4]=x*g+R*h,u[5]=b*g+L*h,u[6]=j*g+U*h,u[7]=M*g+q*h,u[8]=R*g-x*h,u[9]=L*g-b*h,u[10]=U*g-j*h,u[11]=q*g-M*h,u}function Z(u,i,l){var h=Math.sin(l),g=Math.cos(l),x=i[0],b=i[1],j=i[2],M=i[3],R=i[8],L=i[9],U=i[10],q=i[11];return i!==u&&(u[4]=i[4],u[5]=i[5],u[6]=i[6],u[7]=i[7],u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15]),u[0]=x*g-R*h,u[1]=b*g-L*h,u[2]=j*g-U*h,u[3]=M*g-q*h,u[8]=x*h+R*g,u[9]=b*h+L*g,u[10]=j*h+U*g,u[11]=M*h+q*g,u}function se(u,i,l){var h=Math.sin(l),g=Math.cos(l),x=i[0],b=i[1],j=i[2],M=i[3],R=i[4],L=i[5],U=i[6],q=i[7];return i!==u&&(u[8]=i[8],u[9]=i[9],u[10]=i[10],u[11]=i[11],u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15]),u[0]=x*g+R*h,u[1]=b*g+L*h,u[2]=j*g+U*h,u[3]=M*g+q*h,u[4]=R*g-x*h,u[5]=L*g-b*h,u[6]=U*g-j*h,u[7]=q*g-M*h,u}function he(u,i){return u[0]=i[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=i[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=i[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function ye(u,i,l){var h,g,x,b=l[0],j=l[1],M=l[2],R=Math.hypot(b,j,M);return R<w?null:(b*=R=1/R,j*=R,M*=R,h=Math.sin(i),g=Math.cos(i),u[0]=b*b*(x=1-g)+g,u[1]=j*b*x+M*h,u[2]=M*b*x-j*h,u[3]=0,u[4]=b*j*x-M*h,u[5]=j*j*x+g,u[6]=M*j*x+b*h,u[7]=0,u[8]=b*M*x+j*h,u[9]=j*M*x-b*h,u[10]=M*M*x+g,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u)}function Ce(u,i){var l=i[0],h=i[1],g=i[2],x=i[3],b=l+l,j=h+h,M=g+g,R=l*b,L=h*b,U=h*j,q=g*b,ee=g*j,te=g*M,le=x*b,ue=x*j,ge=x*M;return u[0]=1-U-te,u[1]=L+ge,u[2]=q-ue,u[3]=0,u[4]=L-ge,u[5]=1-R-te,u[6]=ee+le,u[7]=0,u[8]=q+ue,u[9]=ee-le,u[10]=1-R-U,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}Math.hypot||(Math.hypot=function(){for(var u=0,i=arguments.length;i--;)u+=arguments[i]*arguments[i];return Math.sqrt(u)});var Ve=K;function Re(){var u=new T(3);return T!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u}function $e(u){var i=new T(3);return i[0]=u[0],i[1]=u[1],i[2]=u[2],i}function nt(u){return Math.hypot(u[0],u[1],u[2])}function Me(u,i,l){var h=new T(3);return h[0]=u,h[1]=i,h[2]=l,h}function rt(u,i,l,h){return u[0]=i,u[1]=l,u[2]=h,u}function Ee(u,i,l){return u[0]=i[0]+l[0],u[1]=i[1]+l[1],u[2]=i[2]+l[2],u}function it(u,i,l){return u[0]=i[0]-l[0],u[1]=i[1]-l[1],u[2]=i[2]-l[2],u}function et(u,i,l){return u[0]=i[0]*l[0],u[1]=i[1]*l[1],u[2]=i[2]*l[2],u}function mt(u,i,l){return u[0]=Math.min(i[0],l[0]),u[1]=Math.min(i[1],l[1]),u[2]=Math.min(i[2],l[2]),u}function He(u,i,l){return u[0]=Math.max(i[0],l[0]),u[1]=Math.max(i[1],l[1]),u[2]=Math.max(i[2],l[2]),u}function pt(u,i,l){return u[0]=i[0]*l,u[1]=i[1]*l,u[2]=i[2]*l,u}function We(u,i,l,h){return u[0]=i[0]+l[0]*h,u[1]=i[1]+l[1]*h,u[2]=i[2]+l[2]*h,u}function Je(u,i){var l=i[0]-u[0],h=i[1]-u[1],g=i[2]-u[2];return l*l+h*h+g*g}function jt(u){var i=u[0],l=u[1],h=u[2];return i*i+l*l+h*h}function Pt(u,i){return u[0]=-i[0],u[1]=-i[1],u[2]=-i[2],u}function Ot(u,i){var l=i[0],h=i[1],g=i[2],x=l*l+h*h+g*g;return x>0&&(x=1/Math.sqrt(x)),u[0]=i[0]*x,u[1]=i[1]*x,u[2]=i[2]*x,u}function Mt(u,i){return u[0]*i[0]+u[1]*i[1]+u[2]*i[2]}function an(u,i,l){var h=i[0],g=i[1],x=i[2],b=l[0],j=l[1],M=l[2];return u[0]=g*M-x*j,u[1]=x*b-h*M,u[2]=h*j-g*b,u}function Jt(u,i,l,h){var g=i[0],x=i[1],b=i[2];return u[0]=g+h*(l[0]-g),u[1]=x+h*(l[1]-x),u[2]=b+h*(l[2]-b),u}function Cn(u,i,l){var h=i[0],g=i[1],x=i[2],b=l[3]*h+l[7]*g+l[11]*x+l[15];return u[0]=(l[0]*h+l[4]*g+l[8]*x+l[12])/(b=b||1),u[1]=(l[1]*h+l[5]*g+l[9]*x+l[13])/b,u[2]=(l[2]*h+l[6]*g+l[10]*x+l[14])/b,u}function nr(u,i,l){var h=i[0],g=i[1],x=i[2];return u[0]=h*l[0]+g*l[3]+x*l[6],u[1]=h*l[1]+g*l[4]+x*l[7],u[2]=h*l[2]+g*l[5]+x*l[8],u}function sn(u,i,l){var h=l[0],g=l[1],x=l[2],b=i[0],j=i[1],M=i[2],R=g*M-x*j,L=x*b-h*M,U=h*j-g*b,q=g*U-x*L,ee=x*R-h*U,te=h*L-g*R,le=2*l[3];return L*=le,U*=le,ee*=2,te*=2,u[0]=b+(R*=le)+(q*=2),u[1]=j+L+ee,u[2]=M+U+te,u}function zr(u){return u[0]=0,u[1]=0,u[2]=0,u}function or(u,i){return u[0]===i[0]&&u[1]===i[1]&&u[2]===i[2]}var Rr=it,qr=et,Nn=nt;function ci(){var u=new T(4);return T!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0,u[3]=0),u}function ui(u,i,l){return u[0]=i[0]*l,u[1]=i[1]*l,u[2]=i[2]*l,u[3]=i[3]*l,u}function st(u,i){var l=i[0],h=i[1],g=i[2],x=i[3],b=l*l+h*h+g*g+x*x;return b>0&&(b=1/Math.sqrt(b)),u[0]=l*b,u[1]=h*b,u[2]=g*b,u[3]=x*b,u}function qt(u,i,l){var h=i[0],g=i[1],x=i[2],b=i[3];return u[0]=l[0]*h+l[4]*g+l[8]*x+l[12]*b,u[1]=l[1]*h+l[5]*g+l[9]*x+l[13]*b,u[2]=l[2]*h+l[6]*g+l[10]*x+l[14]*b,u[3]=l[3]*h+l[7]*g+l[11]*x+l[15]*b,u}function rn(){var u=new T(4);return T!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u[3]=1,u}function Wn(u){return u[0]=0,u[1]=0,u[2]=0,u[3]=1,u}function Vt(u,i,l){l*=.5;var h=i[0],g=i[1],x=i[2],b=i[3],j=Math.sin(l),M=Math.cos(l);return u[0]=h*M+b*j,u[1]=g*M+x*j,u[2]=x*M-g*j,u[3]=b*M-h*j,u}function un(u,i,l){l*=.5;var h=i[0],g=i[1],x=i[2],b=i[3],j=Math.sin(l),M=Math.cos(l);return u[0]=h*M-x*j,u[1]=g*M+b*j,u[2]=x*M+h*j,u[3]=b*M-g*j,u}Re(),ci();var hr,$t,lr,ze=st,Fe=(hr=Re(),$t=Me(1,0,0),lr=Me(0,1,0),function(u,i,l){var h=Mt(i,l);return h<-.999999?(an(hr,$t,i),Nn(hr)<1e-6&&an(hr,lr,i),Ot(hr,hr),(function(g,x,b){b*=.5;var j=Math.sin(b);g[0]=j*x[0],g[1]=j*x[1],g[2]=j*x[2],g[3]=Math.cos(b)})(u,hr,Math.PI),u):h>.999999?(u[0]=0,u[1]=0,u[2]=0,u[3]=1,u):(an(hr,i,l),u[0]=hr[0],u[1]=hr[1],u[2]=hr[2],u[3]=1+h,ze(u,u))});function jn(){var u=new T(2);return T!=Float32Array&&(u[0]=0,u[1]=0),u}function Xn(u,i){var l=new T(2);return l[0]=u,l[1]=i,l}function mr(u,i,l){return u[0]=i[0]+l[0],u[1]=i[1]+l[1],u}function Ur(u,i,l){return u[0]=i[0]-l[0],u[1]=i[1]-l[1],u}function yi(u,i,l){return u[0]=i[0]*l,u[1]=i[1]*l,u}function Hi(u){return Math.hypot(u[0],u[1])}function xr(u,i){var l=i[0],h=i[1],g=l*l+h*h;return g>0&&(g=1/Math.sqrt(g)),u[0]=i[0]*g,u[1]=i[1]*g,u}function dr(u,i){return u[0]*i[0]+u[1]*i[1]}rn(),rn(),N();var Ki,Di,Ji=Ur;function bs(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}jn();var Ys=(function(){if(Di)return Ki;function u(i,l,h,g){this.cx=3*i,this.bx=3*(h-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(g-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=l,this.p2x=h,this.p2y=g}return Di=1,Ki=u,u.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,l){if(l===void 0&&(l=1e-6),i<0)return 0;if(i>1)return 1;for(var h=i,g=0;g<8;g++){var x=this.sampleCurveX(h)-i;if(Math.abs(x)<l)return h;var b=this.sampleCurveDerivativeX(h);if(Math.abs(b)<1e-6)break;h-=x/b}var j=0,M=1;for(h=i,g=0;g<20&&(x=this.sampleCurveX(h),!(Math.abs(x-i)<l));g++)i>x?j=h:M=h,h=.5*(M-j)+j;return h},solve:function(i,l){return this.sampleCurveY(this.solveCurveX(i,l))}},Ki})(),Vr=bs(Ys);function Rt(u,i){this.x=u,this.y=i}function Jr(u,i){if(Array.isArray(u)){if(!Array.isArray(i)||u.length!==i.length)return!1;for(let l=0;l<u.length;l++)if(!Jr(u[l],i[l]))return!1;return!0}if(typeof u=="object"&&u!==null&&i!==null){if(typeof i!="object"||Object.keys(u).length!==Object.keys(i).length)return!1;for(const l in u)if(!Jr(u[l],i[l]))return!1;return!0}return u===i}Rt.prototype={clone(){return new Rt(this.x,this.y)},add(u){return this.clone()._add(u)},sub(u){return this.clone()._sub(u)},multByPoint(u){return this.clone()._multByPoint(u)},divByPoint(u){return this.clone()._divByPoint(u)},mult(u){return this.clone()._mult(u)},div(u){return this.clone()._div(u)},rotate(u){return this.clone()._rotate(u)},rotateAround(u,i){return this.clone()._rotateAround(u,i)},matMult(u){return this.clone()._matMult(u)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(u){return this.x===u.x&&this.y===u.y},dist(u){return Math.sqrt(this.distSqr(u))},distSqr(u){const i=u.x-this.x,l=u.y-this.y;return i*i+l*l},angle(){return Math.atan2(this.y,this.x)},angleTo(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith(u){return this.angleWithSep(u.x,u.y)},angleWithSep(u,i){return Math.atan2(this.x*i-this.y*u,this.x*u+this.y*i)},_matMult(u){const i=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=i,this},_add(u){return this.x+=u.x,this.y+=u.y,this},_sub(u){return this.x-=u.x,this.y-=u.y,this},_mult(u){return this.x*=u,this.y*=u,this},_div(u){return this.x/=u,this.y/=u,this},_multByPoint(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint(u){return this.x/=u.x,this.y/=u.y,this},_unit(){return this._div(this.mag()),this},_perp(){const u=this.y;return this.y=this.x,this.x=-u,this},_rotate(u){const i=Math.cos(u),l=Math.sin(u),h=l*this.x+i*this.y;return this.x=i*this.x-l*this.y,this.y=h,this},_rotateAround(u,i){const l=Math.cos(u),h=Math.sin(u),g=i.y+h*(this.x-i.x)+l*(this.y-i.y);return this.x=i.x+l*(this.x-i.x)-h*(this.y-i.y),this.y=g,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:Rt},Rt.convert=function(u){if(u instanceof Rt)return u;if(Array.isArray(u))return new Rt(+u[0],+u[1]);if(u.x!==void 0&&u.y!==void 0)return new Rt(+u.x,+u.y);throw new Error("Expected [x, y] or {x, y} point format")};const xa=Math.PI/180,ka=180/Math.PI;function Dr(u){return u*xa}function gt(u){return u*ka}const Q=[[0,0],[1,0],[1,1],[0,1]];function fe(u){if(u<=0)return 0;if(u>=1)return 1;const i=u*u,l=i*u;return 4*(u<.5?l:3*(u-i)+l-.75)}function Te(u,i,l,h){const g=new Vr(u,i,l,h);return function(x){return g.solve(x)}}const ke=Te(.25,.1,.25,1);function Oe(u,i,l){return Math.min(l,Math.max(i,u))}function ut(u,i,l){return(l=Oe((l-u)/(i-u),0,1))*l*(3-2*l)}function Et(u,i,l){const h=l-i,g=((u-i)%h+h)%h+i;return g===i?l:g}function ht(u,i,l){if(!u.length)return l(null,[]);let h=u.length;const g=new Array(u.length);let x=null;u.forEach(((b,j)=>{i(b,((M,R)=>{M&&(x=M),g[j]=R,--h==0&&l(x,g)}))}))}function St(u,...i){for(const l of i)for(const h in l)u[h]=l[h];return u}let nn=1;function Kt(){return nn++}function ir(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))}function br(u,i){u.forEach((l=>{i[l]&&(i[l]=i[l].bind(i))}))}function pr(u,i,l){const h={};for(const g in u)h[g]=i.call(this,u[g],g,u);return h}function Qr(u,i,l){const h={};for(const g in u)i.call(this,u[g],g,u)&&(h[g]=u[g]);return h}function Gr(u){return Array.isArray(u)?u.map(Gr):typeof u=="object"&&u?pr(u,Gr):u}function Wr(u,i){for(let l=0;l<u.length;l++)if(i.indexOf(u[l])>=0)return!0;return!1}const Gi={};function ai(u){Gi[u]||(typeof console<"u"&&console.warn(u),Gi[u]=!0)}function ws(u,i,l){return(l.y-u.y)*(i.x-u.x)>(i.y-u.y)*(l.x-u.x)}function Ks(u){let i=0;for(let l,h,g=0,x=u.length,b=x-1;g<x;b=g++)l=u[g],h=u[b],i+=(h.x-l.x)*(l.y+h.y);return i}function ca([u,i,l]){const h=Dr(i+90),g=Dr(l);return{x:u*Math.cos(h)*Math.sin(g),y:u*Math.sin(h)*Math.sin(g),z:u*Math.cos(g),azimuthal:i,polar:l}}function fr(u){return(typeof self<"u"||u!==void 0)&&typeof WorkerGlobalScope<"u"&&(u!==void 0?u:self)instanceof WorkerGlobalScope}function di(u){const i={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((l,h,g,x)=>{const b=g||x;return i[h]=!b||b.toLowerCase(),""})),i["max-age"]){const l=parseInt(i["max-age"],10);isNaN(l)?delete i["max-age"]:i["max-age"]=l}return i}let wr=null;function Fi(u,i){return[u[4*i],u[4*i+1],u[4*i+2],u[4*i+3]]}function rs(u,i,l,h){for(;i<l;){const g=i+l>>1;u[g]<h?i=g+1:l=g}return i}function Js(u,i,l,h){for(;i<l;){const g=i+l>>1;u[g]<=h?i=g+1:l=g}return i}function Na(u){return u>0?1/(1.001-u):1+u}function Ia(u){return u>0?1-1/(1.001-u):-u}function id(u,i,l){return(u-i.min)*(l.max-l.min)/(i.max-i.min)+l.min}const Ua={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Ua.API_URL)return null;try{const u=new URL(Ua.API_URL);return u.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":u.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",BUILDING_GEN_URL:"https://api.mapbox.com/mapbox-gl-js/building-gen/building_gen_v1.2.1.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function ts(u){return Ua.API_URL_REGEX.test(u)}function dc(u){return Ua.API_SPRITE_REGEX.test(u)}let Dl,hc,Nu,ru,fc,Xa;function sd(){return Dl==null&&(Dl=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Dl}const co={now:()=>ru!==void 0?ru:performance.now(),setNow(u){ru=u},restoreNow(){ru=void 0},frame(u){const i=requestAnimationFrame(u);return{cancel:()=>cancelAnimationFrame(i)}},getImageData(u,i=0){const{width:l,height:h}=u;fc||(fc=document.createElement("canvas"));const g=fc.getContext("2d",{willReadFrequently:!0});if(!g)throw new Error("failed to create canvas 2d context");return(l>fc.width||h>fc.height)&&(fc.width=l,fc.height=h),g.clearRect(-i,-i,l+2*i,h+2*i),g.drawImage(u,0,0,l,h),g.getImageData(-i,-i,l+2*i,h+2*i)},resolveURL:u=>(hc||(hc=document.createElement("a")),hc.href=u,hc.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Nu==null&&(Nu=window.matchMedia("(prefers-reduced-motion: reduce)")),Nu.matches)},hasCanvasFingerprintNoise(){if(Xa!==void 0)return Xa;if(!sd())return Xa=!1,!1;const u=new OffscreenCanvas(85,1),i=u.getContext("2d",{willReadFrequently:!0});let l=0;for(let g=0;g<u.width;++g)i.fillStyle=`rgba(${l++},${l++},${l++}, 255)`,i.fillRect(g,0,1,1);const h=i.getImageData(0,0,u.width,u.height);l=0;for(let g=0;g<h.data.length;++g)if(g%4!=3&&l++!==h.data[g])return Xa=!0,!0;return Xa=!1,!1}};function zo(u,i){const l=u.indexOf("?");if(l<0)return`${u}?${new URLSearchParams(i).toString()}`;const h=new URLSearchParams(u.slice(l));for(const g in i)h.set(g,i[g]);return`${u.slice(0,l)}?${h.toString()}`}function Za(u,i={persistentParams:[]}){const l=u.indexOf("?");if(l<0)return u;const h=new URLSearchParams,g=new URLSearchParams(u.slice(l));for(const b of i.persistentParams){const j=g.get(b);j&&h.set(b,j)}const x=h.toString();return`${u.slice(0,l)}${x.length>0?`?${x}`:""}`}const Zo="mapbox-tiles";let Po=500,to=50;const Pu=["language","worldview","jobid"];let ml,pc;function Va(){try{return caches}catch{}}function nl(){const u=Va();u&&ml==null&&(ml=u.open(Zo))}let ad=1/0;const wo={supported:!1,testSupport:function(u){!Ql&&rl&&(gl?Kd(u):$a=u)}};let $a,rl,Ql=!1,gl=!1;const qh=typeof self<"u"?self:{};function Kd(u){const i=u.createTexture();u.bindTexture(u.TEXTURE_2D,i);try{if(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,rl),u.isContextLost())return;wo.supported=!0}catch{}u.deleteTexture(i),Ql=!0}qh.document&&(rl=qh.document.createElement("img"),rl.onload=function(){$a&&Kd($a),$a=null,gl=!0},rl.onerror=function(){Ql=!0,$a=null},rl.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Mu={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Mu);class bi extends Error{constructor(i,l,h){l===401&&ts(h)&&(i+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(i),this.status=l,this.url=h}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const yl=fr()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,mc=function(u,i){if(!(/^file:/.test(l=u.url)||/^file:/.test(yl())&&!/^\w+:/.test(l))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return(function(h,g){const x=new AbortController,b=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:yl(),referrerPolicy:h.referrerPolicy,signal:x.signal});let j=!1,M=!1;const R=(L=b.url).indexOf("sku=")>0&&ts(L);var L;h.type==="json"&&b.headers.set("Accept","application/json");const U=(ee,te,le)=>{if(M)return;if(ee&&ee.message!=="SecurityError"&&ai(ee.toString()),te&&le)return q(te);const ue=Date.now();fetch(b).then((ge=>{if(ge.ok){const Se=R?ge.clone():null;return q(ge,Se,ue)}return g(new bi(ge.statusText,ge.status,h.url))})).catch((ge=>{ge.name!=="AbortError"&&g(new Error(`${ge.message} ${h.url}`))}))},q=(ee,te,le)=>{(h.type==="arrayBuffer"?ee.arrayBuffer():h.type==="json"?ee.json():ee.text()).then((ue=>{M||(te&&le&&(function(ge,Se,we){if(nl(),ml==null)return;const Pe=di(Se.headers.get("Cache-Control")||"");if(Pe["no-store"])return;const tt={status:Se.status,statusText:Se.statusText,headers:new Headers};Se.headers.forEach(((dt,ft)=>tt.headers.set(ft,dt))),Pe["max-age"]&&tt.headers.set("Expires",new Date(we+1e3*Pe["max-age"]).toUTCString());const Ke=tt.headers.get("Expires");if(!Ke||new Date(Ke).getTime()-we<42e4)return;let Qe=Za(ge.url,{persistentParams:Pu});if(Se.status===206){const dt=ge.headers.get("Range");if(!dt)return;tt.status=200,Qe=zo(Qe,{range:dt})}(function(dt,ft){if(pc===void 0)try{new Response(new ReadableStream),pc=!0}catch{pc=!1}pc?ft(dt.body):dt.blob().then(ft).catch((Ft=>ai(Ft.message)))})(Se,(dt=>{const ft=new Response((Ft=Se.status)!==200&&Ft!==404&&[101,103,204,205,304].includes(Ft)?null:dt,tt);var Ft;nl(),ml?.then((xt=>xt.put(Qe,ft))).catch((xt=>ai(xt.message)))}))})(b,te,le),j=!0,g(null,ue,ee.headers.get("Cache-Control"),ee.headers.get("Expires")))})).catch((ue=>{M||g(new Error(ue.message))}))};return R?(function(ee,te){if(nl(),ml==null)return te(null);ml.then((le=>{let ue=Za(ee.url,{persistentParams:Pu});const ge=ee.headers.get("Range");ge&&(ue=zo(ue,{range:ge})),le.match(ue).then((Se=>{const we=(function(Pe){if(!Pe)return!1;const tt=new Date(Pe.headers.get("Expires")||0),Ke=di(Pe.headers.get("Cache-Control")||"");return Number(tt)>Date.now()&&!Ke["no-cache"]})(Se);le.delete(ue).catch(te),we&&le.put(ue,Se.clone()).catch(te),te(null,Se,we)})).catch(te)})).catch(te)})(b,U):U(null,null),{cancel:()=>{M=!0,j||x.abort()}}})(u,i);if(fr(self)&&self.worker.actor)return self.worker.actor.send("getResource",u,i,void 0,!0)}var l;return(function(h,g){const x=new XMLHttpRequest;x.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(x.responseType="arraybuffer");for(const b in h.headers)x.setRequestHeader(b,h.headers[b]);return h.type==="json"&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials=h.credentials==="include",x.onerror=()=>{g(new Error(x.statusText))},x.onload=()=>{if((x.status>=200&&x.status<300||x.status===0)&&x.response!==null){let b=x.response;if(h.type==="json")try{b=JSON.parse(x.response)}catch(j){return g(j)}g(null,b,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else g(new bi(x.statusText,x.status,h.url))},x.send(h.body),{cancel:()=>x.abort()}})(u,i)},gc=function(u,i){return mc(St(u,{type:"arrayBuffer"}),i)};function je(u){const i=document.createElement("a");return i.href=u,i.protocol===location.protocol&&i.host===location.host}const ot="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let vn,Sr;vn=[],Sr=0;const gr=function(u,i){if(wo.supported&&(u.headers||(u.headers={}),u.headers.accept="image/webp,*/*"),Sr>=Ua.MAX_PARALLEL_IMAGE_REQUESTS){const x={requestParameters:u,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return vn.push(x),x}Sr++;let l=!1;const h=()=>{if(!l)for(l=!0,Sr--;vn.length&&Sr<Ua.MAX_PARALLEL_IMAGE_REQUESTS;){const x=vn.shift(),{requestParameters:b,callback:j,cancelled:M}=x;M||(x.cancel=gr(b,j).cancel)}},g=gc(u,((x,b,j,M)=>{h(),x?i(x):b&&(self.createImageBitmap?(function(R,L){const U=new Blob([new Uint8Array(R)],{type:"image/png"});createImageBitmap(U).then((q=>{L(null,q)})).catch((q=>{L(new Error(`Could not load image because of ${q.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))})(b,((R,L)=>i(R,L,j,M))):(function(R,L){const U=new Image;U.onload=()=>{L(null,U),URL.revokeObjectURL(U.src),U.onload=null,requestAnimationFrame((()=>{U.src=ot}))},U.onerror=()=>L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const q=new Blob([new Uint8Array(R)],{type:"image/png"});U.src=R.byteLength?URL.createObjectURL(q):ot})(b,((R,L)=>i(R,L,j,M))))}));return{cancel:()=>{g.cancel(),h()}}};var Zn,Mo,ua,no={exports:{}},La={exports:{}},ta={exports:{}},Ta=(function(){if(ua)return no.exports;ua=1;var u=(Zn||(Zn=1,La.exports=function(l,h){var g,x,b,j,M,R,L,U;for(x=l.length-(g=3&l.length),b=h,M=3432918353,R=461845907,U=0;U<x;)L=255&l.charCodeAt(U)|(255&l.charCodeAt(++U))<<8|(255&l.charCodeAt(++U))<<16|(255&l.charCodeAt(++U))<<24,++U,b=27492+(65535&(j=5*(65535&(b=(b^=L=(65535&(L=(L=(65535&L)*M+(((L>>>16)*M&65535)<<16)&4294967295)<<15|L>>>17))*R+(((L>>>16)*R&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(j>>>16)&65535)<<16);switch(L=0,g){case 3:L^=(255&l.charCodeAt(U+2))<<16;case 2:L^=(255&l.charCodeAt(U+1))<<8;case 1:b^=L=(65535&(L=(L=(65535&(L^=255&l.charCodeAt(U)))*M+(((L>>>16)*M&65535)<<16)&4294967295)<<15|L>>>17))*R+(((L>>>16)*R&65535)<<16)&4294967295}return b^=l.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}),La.exports),i=(Mo||(Mo=1,ta.exports=function(l,h){for(var g,x=l.length,b=h^x,j=0;x>=4;)g=1540483477*(65535&(g=255&l.charCodeAt(j)|(255&l.charCodeAt(++j))<<8|(255&l.charCodeAt(++j))<<16|(255&l.charCodeAt(++j))<<24))+((1540483477*(g>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),x-=4,++j;switch(x){case 3:b^=(255&l.charCodeAt(j+2))<<16;case 2:b^=(255&l.charCodeAt(j+1))<<8;case 1:b=1540483477*(65535&(b^=255&l.charCodeAt(j)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}),ta.exports);return no.exports=u,no.exports.murmur3=u,no.exports.murmur2=i,no.exports})(),kl=bs(Ta);class yc{constructor(i,...l){St(this,l[0]||{}),this.type=i}}class Fo extends yc{constructor(i,l={}){super("error",St({error:i},l))}}function Jd(u,i,l){l[u]&&l[u].indexOf(i)!==-1||(l[u]=l[u]||[],l[u].push(i))}function fm(u,i,l){if(l&&l[u]){const h=l[u].indexOf(i);h!==-1&&l[u].splice(h,1)}}class od{on(i,l){return this._listeners=this._listeners||{},Jd(i,l,this._listeners),this}off(i,l){return fm(i,l,this._listeners),fm(i,l,this._oneTimeListeners),this}once(i,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},Jd(i,l,this._oneTimeListeners),this):new Promise((h=>{this.once(i,h)}))}fire(i,l){const h=typeof i=="string"?new yc(i,l):i,g=h.type;if(this.listens(g)){h.target=this;const x=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];for(const M of x)M.call(this,h);const b=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];for(const M of b)fm(g,M,this._oneTimeListeners),M.call(this,h);const j=this._eventedParent;j&&(St(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),j.fire(h))}else h instanceof Fo&&console.error(h.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,l){return this._eventedParent=i,this._eventedParentData=l,this}}class vl{constructor(i){typeof i=="string"?this.name=i:(this.name=i.name,this.iconsetId=i.iconsetId)}static from(i){return new vl(i)}static toString(i){return i.iconsetId?`${i.name}${i.iconsetId}`:i.name}static parse(i){const[l,h]=i.split("");return new vl({name:l,iconsetId:h})}static isEqual(i,l){return i.name===l.name&&i.iconsetId===l.iconsetId}toString(){return vl.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var Bg,Qd={},pm=(function(){if(Bg)return Qd;Bg=1;var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(x){return(x=Math.round(x))<0?0:x>255?255:x}function l(x){return i(x[x.length-1]==="%"?parseFloat(x)/100*255:parseInt(x))}function h(x){return(b=x[x.length-1]==="%"?parseFloat(x)/100:parseFloat(x))<0?0:b>1?1:b;var b}function g(x,b,j){return j<0?j+=1:j>1&&(j-=1),6*j<1?x+(b-x)*j*6:2*j<1?b:3*j<2?x+(b-x)*(2/3-j)*6:x}try{Qd.parseCSSColor=function(x){var b,j=x.replace(/ /g,"").toLowerCase();if(j in u)return u[j].slice();if(j[0]==="#")return j.length===4?(b=parseInt(j.substr(1),16))>=0&&b<=4095?[(3840&b)>>4|(3840&b)>>8,240&b|(240&b)>>4,15&b|(15&b)<<4,1]:null:j.length===7&&(b=parseInt(j.substr(1),16))>=0&&b<=16777215?[(16711680&b)>>16,(65280&b)>>8,255&b,1]:null;var M=j.indexOf("("),R=j.indexOf(")");if(M!==-1&&R+1===j.length){var L=j.substr(0,M),U=j.substr(M+1,R-(M+1)).split(","),q=1;switch(L){case"rgba":if(U.length!==4)return null;q=h(U.pop());case"rgb":return U.length!==3?null:[l(U[0]),l(U[1]),l(U[2]),q];case"hsla":if(U.length!==4)return null;q=h(U.pop());case"hsl":if(U.length!==3)return null;var ee=(parseFloat(U[0])%360+360)%360/360,te=h(U[1]),le=h(U[2]),ue=le<=.5?le*(te+1):le+te-le*te,ge=2*le-ue;return[i(255*g(ge,ue,ee+1/3)),i(255*g(ge,ue,ee)),i(255*g(ge,ue,ee-1/3)),q];default:return null}}return null}}catch{}return Qd})();class ns{constructor(i,l,h,g=1){this.r=i,this.g=l,this.b=h,this.a=g}static parse(i){if(!i)return;if(i instanceof ns)return i;if(typeof i!="string")return;const l=pm.parseCSSColor(i);return l?new ns(l[0]/255,l[1]/255,l[2]/255,l[3]):void 0}toString(){const[i,l,h,g]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*i)},${Math.round(255*l)},${Math.round(255*h)},${g})`}toNonPremultipliedRenderColor(i){const{r:l,g:h,b:g,a:x}=this;return new eh(i,l,h,g,x)}toPremultipliedRenderColor(i){const{r:l,g:h,b:g,a:x}=this;return new Ug(i,l*x,h*x,g*x,x)}clone(){return new ns(this.r,this.g,this.b,this.a)}}class Hh{constructor(i,l,h,g,x,b=!1){if(this.premultiplied=!1,this.premultiplied=b,i){const j=i.image.height,M=j*j;this.premultiplied?(l=x===0?0:l/x*(j-1),h=x===0?0:h/x*(j-1),g=x===0?0:g/x*(j-1)):(l*=j-1,h*=j-1,g*=j-1);const R=Math.floor(l),L=Math.floor(h),U=Math.floor(g),q=Math.ceil(l),ee=Math.ceil(h),te=Math.ceil(g),le=l-R,ue=h-L,ge=g-U,Se=i.image.data,we=4*(R+L*M+U*j),Pe=4*(R+L*M+te*j),tt=4*(R+ee*M+U*j),Ke=4*(R+ee*M+te*j),Qe=4*(q+L*M+U*j),dt=4*(q+L*M+te*j),ft=4*(q+ee*M+U*j),Ft=4*(q+ee*M+te*j);if(we<0||Ft>=Se.length)throw new Error("out of range");this.r=yr(yr(yr(Se[we],Se[Pe],ge),yr(Se[tt],Se[Ke],ge),ue),yr(yr(Se[Qe],Se[dt],ge),yr(Se[ft],Se[Ft],ge),ue),le)/255*(this.premultiplied?x:1),this.g=yr(yr(yr(Se[we+1],Se[Pe+1],ge),yr(Se[tt+1],Se[Ke+1],ge),ue),yr(yr(Se[Qe+1],Se[dt+1],ge),yr(Se[ft+1],Se[Ft+1],ge),ue),le)/255*(this.premultiplied?x:1),this.b=yr(yr(yr(Se[we+2],Se[Pe+2],ge),yr(Se[tt+2],Se[Ke+2],ge),ue),yr(yr(Se[Qe+2],Se[dt+2],ge),yr(Se[ft+2],Se[Ft+2],ge),ue),le)/255*(this.premultiplied?x:1),this.a=x}else this.r=l,this.g=h,this.b=g,this.a=x}toArray(){const{r:i,g:l,b:h,a:g}=this;return[255*i,255*l,255*h,g]}toHslaArray(){let{r:i,g:l,b:h,a:g}=this;if(this.premultiplied){if(g===0)return[0,0,0,0];i/=g,l/=g,h/=g}const x=Math.min(Math.max(i,0),1),b=Math.min(Math.max(l,0),1),j=Math.min(Math.max(h,0),1),M=Math.min(x,b,j),R=Math.max(x,b,j),L=(M+R)/2;if(M===R)return[0,0,100*L,g];const U=R-M,q=L>.5?U/(2-R-M):U/(R+M);let ee=0;return R===x?ee=(b-j)/U+(b<j?6:0):R===b?ee=(j-x)/U+2:R===j&&(ee=(x-b)/U+4),ee*=60,[Math.min(Math.max(ee,0),360),Math.min(Math.max(100*q,0),100),Math.min(Math.max(100*L,0),100),g]}toArray01(){const{r:i,g:l,b:h,a:g}=this;return[i,l,h,g]}toArray01Scaled(i){const{r:l,g:h,b:g}=this;return[l*i,h*i,g*i]}toArray01Linear(){const{r:i,g:l,b:h,a:g}=this;return[Math.pow(i,2.2),Math.pow(l,2.2),Math.pow(h,2.2),g]}}class eh extends Hh{constructor(i,l,h,g,x){super(i,l,h,g,x,!1)}}class Ug extends Hh{constructor(i,l,h,g,x){super(i,l,h,g,x,!0)}}function yr(u,i,l){return u*(1-l)+i*l}function Vg(u,i,l){return u.map(((h,g)=>yr(h,i[g],l)))}ns.black=new ns(0,0,0,1),ns.white=new ns(1,1,1,1),ns.transparent=new ns(0,0,0,0),ns.red=new ns(1,0,0,1),ns.blue=new ns(0,0,1,1);var Gh=Object.freeze({__proto__:null,array:Vg,color:function(u,i,l){return new ns(yr(u.r,i.r,l),yr(u.g,i.g,l),yr(u.b,i.b,l),yr(u.a,i.a,l))},number:yr});function ld(u,...i){for(const l of i)for(const h in l)u[h]=l[h];return u}class Il extends Error{constructor(i,l){super(l),this.message=l,this.key=i}}class Wh{constructor(i,l=[]){this.parent=i,this.bindings={};for(const[h,g]of l)this.bindings[h]=g}concat(i){return new Wh(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const th={kind:"null"},cr={kind:"number"},Qi={kind:"string"},ri={kind:"boolean"},Yo={kind:"color"},iu={kind:"object"},ve={kind:"value"},oe={kind:"collator"},xe={kind:"formatted"},lt={kind:"resolvedImage"};function vt(u,i){return{kind:"array",itemType:u,N:i}}function An(u){if(u.kind==="array"){const i=An(u.itemType);return typeof u.N=="number"?`array<${i}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${i}>`}return u.kind}const Nr=[th,cr,Qi,ri,Yo,xe,iu,vt(ve),lt];function Xr(u,i){if(i.kind==="error")return null;if(u.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!Xr(u.itemType,i.itemType))&&(typeof u.N!="number"||u.N===i.N))return null}else{if(u.kind===i.kind)return null;if(u.kind==="value"){for(const l of Nr)if(!Xr(l,i))return null}}return`Expected ${An(u)} but found ${An(i)} instead.`}function Ti(u,i){return i.some((l=>l.kind===u.kind))}function Ms(u,i){return i.some((l=>l==="null"?u===null:l==="array"?Array.isArray(u):l==="object"?u&&!Array.isArray(u)&&typeof u=="object":l===typeof u))}function $s(u,i){return u.kind==="array"&&i.kind==="array"?u.N===i.N&&$s(u.itemType,i.itemType):u.kind===i.kind}class Pa{constructor(i,l,h){this.sensitivity=i?l?"variant":"case":l?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,l){return this.collator.compare(i,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ru{constructor(i,l,h,g,x){this.text=i.normalize?i.normalize():i,this.image=l,this.scale=h,this.fontStack=g,this.textColor=x}}class Bo{constructor(i){this.sections=i}static fromString(i){return new Bo([new Ru(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((i=>i.text.length!==0||!!i.image&&i.image.hasPrimary()))}static factory(i){return i instanceof Bo?i:Bo.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map((i=>i.text)).join("")}serialize(){const i=["format"];for(const l of this.sections){if(l.image){const g=l.image.getPrimary().id.toString();i.push(["image",g]);continue}i.push(l.text);const h={};l.fontStack&&(h["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(h["font-scale"]=l.scale),l.textColor&&(h["text-color"]=["rgba"].concat(l.textColor.toNonPremultipliedRenderColor(null).toArray())),i.push(h)}return i}}class vc{constructor(i,l={}){if(this.id=vl.from(i),this.options=Object.assign({},l),l.transform){const{a:h,b:g,c:x,d:b,e:j,f:M}=l.transform;this.options.transform=new DOMMatrix([h,g,x,b,j,M])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:i,b:l,c:h,d:g,e:x,f:b}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:i,b:l,c:h,d:g,e:x,f:b}})}static parse(i){let l,h,g,x;try{({name:l,iconsetId:h,params:g,transform:x}=JSON.parse(i)||{})}catch{return null}if(!l)return null;const{a:b,b:j,c:M,d:R,e:L,f:U}=x||{};return new vc({name:l,iconsetId:h},{params:g,transform:new DOMMatrix([b,j,M,R,L,U])})}scaleSelf(i,l){return this.options.transform.scaleSelf(i,l),this}}class uo{constructor(i,l,h,g,x=!1){this.primaryId=vl.from(i),this.primaryOptions=l,h&&(this.secondaryId=vl.from(h)),this.secondaryOptions=g,this.available=x}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new vc(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new vc(this.secondaryId,this.secondaryOptions):null}static from(i){return typeof i=="string"?uo.build({name:i}):i}static build(i,l,h,g){return!i||typeof i=="object"&&!("name"in i)?null:new uo(i,h,l,g)}}function Ou(u,i,l,h){return typeof u=="number"&&u>=0&&u<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof l=="number"&&l>=0&&l<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[u,i,l,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[u,i,l,h]:[u,i,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ei(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof ns||u instanceof Pa||u instanceof Bo||u instanceof uo)return!0;if(Array.isArray(u)){for(const i of u)if(!ei(i))return!1;return!0}if(typeof u=="object"){for(const i in u)if(!ei(u[i]))return!1;return!0}return!1}function Fn(u){if(u===null)return th;if(typeof u=="string")return Qi;if(typeof u=="boolean")return ri;if(typeof u=="number")return cr;if(u instanceof ns)return Yo;if(u instanceof Pa)return oe;if(u instanceof Bo)return xe;if(u instanceof uo)return lt;if(Array.isArray(u)){const i=u.length;let l;for(const h of u){const g=Fn(h);if(l){if(l===g)continue;l=ve;break}l=g}return vt(l||ve,i)}return iu}function Ll(u){const i=typeof u;return u===null?"":i==="string"||i==="number"||i==="boolean"?String(u):u instanceof Bo||u instanceof uo||u instanceof ns?u.toString():JSON.stringify(u)}class Pr{constructor(i,l){this.type=i,this.value=l}static parse(i,l){if(i.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!ei(i[1]))return l.error("invalid value");const h=i[1];let g=Fn(h);const x=l.expectedType;return g.kind!=="array"||g.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(g=x),new Pr(g,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ns?["rgba"].concat(this.value.toNonPremultipliedRenderColor(null).toArray()):this.value instanceof Bo?this.value.serialize():this.value}}class aa{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}const Dc={string:Qi,number:cr,boolean:ri,object:iu};class _r{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");let h,g=1;const x=i[0];if(x==="array"){let j,M;if(i.length>2){const R=i[1];if(typeof R!="string"||!(R in Dc)||R==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);j=Dc[R],g++}else j=ve;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return l.error('The length argument to "array" must be a positive integer literal',2);M=i[2],g++}h=vt(j,M)}else h=Dc[x];const b=[];for(;g<i.length;g++){const j=l.parse(i[g],g,ve);if(!j)return null;b.push(j)}return new _r(h,b)}evaluate(i){for(let l=0;l<this.args.length;l++){const h=this.args[l].evaluate(i);if(!Xr(this.type,Fn(h)))return h;if(l===this.args.length-1)throw new aa(`The expression ${JSON.stringify(this.args[l].serialize())} evaluated to ${An(Fn(h))} but was expected to be of type ${An(this.type)}.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every((i=>i.outputDefined()))}serialize(){const i=this.type,l=[i.kind];if(i.kind==="array"){const h=i.itemType;if(h.kind==="string"||h.kind==="number"||h.kind==="boolean"){l.push(h.kind);const g=i.N;(typeof g=="number"||this.args.length>1)&&l.push(g)}}return l.concat(this.args.map((h=>h.serialize())))}}class xc{constructor(i){this.type=xe,this.sections=i}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");const h=i[1];if(!Array.isArray(h)&&typeof h=="object")return l.error("First argument must be an image or text section.");const g=[];let x=!1;for(let b=1;b<=i.length-1;++b){const j=i[b];if(x&&typeof j=="object"&&!Array.isArray(j)){x=!1;let M=null;if(j["font-scale"]&&(M=l.parseObjectValue(j["font-scale"],b,"font-scale",cr),!M))return null;let R=null;if(j["text-font"]&&(R=l.parseObjectValue(j["text-font"],b,"text-font",vt(Qi)),!R))return null;let L=null;if(j["text-color"]&&(L=l.parseObjectValue(j["text-color"],b,"text-color",Yo),!L))return null;const U=g[g.length-1];U.scale=M,U.font=R,U.textColor=L}else{const M=l.parse(i[b],b,ve);if(!M)return null;const R=M.type.kind;if(R!=="string"&&R!=="value"&&R!=="null"&&R!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,g.push({content:M,scale:null,font:null,textColor:null})}}return new xc(g)}evaluate(i){return new Bo(this.sections.map((l=>{const h=l.content.evaluate(i);return $s(Fn(h),lt)?new Ru("",h,null,null,null):new Ru(Ll(h),null,l.scale?l.scale.evaluate(i):null,l.font?l.font.evaluate(i).join(","):null,l.textColor?l.textColor.evaluate(i):null)})))}eachChild(i){for(const l of this.sections)i(l.content),l.scale&&i(l.scale),l.font&&i(l.font),l.textColor&&i(l.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const l of this.sections){i.push(l.content.serialize());const h={};l.scale&&(h["font-scale"]=l.scale.serialize()),l.font&&(h["text-font"]=l.font.serialize()),l.textColor&&(h["text-color"]=l.textColor.serialize()),i.push(h)}return i}}class su{constructor(i,l,h,g){this._imageWarnHistory={},this.type=lt,this.namePrimary=i,this.nameSecondary=l,h&&(this.paramsPrimary=h.params,this.iconsetIdPrimary=h.iconset?h.iconset.id:void 0),g&&(this.paramsSecondary=g.params,this.iconsetIdSecondary=g.iconset?g.iconset.id:void 0)}static parse(i,l){if(i.length<2)return l.error("Expected two or more arguments.");let h=1;const g=[];function x(){if(h<i.length){const j=l.parse(i[h],h++,Qi);return j?(g.push({image:j,options:{}}),!0):(l.error(g.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function b(){if(h<i.length){const M=i[h];if((j=M)===null||typeof j!="object"||Array.isArray(j))return!0;const R=M.params,L=M.iconset,U=l.concat(h);if(!R&&!L)return h++,!0;if(R){if(typeof R!="object"||R.constructor!==Object)return U.error('Image options "params" should be an object'),!1;const q={},ee=U.concat(void 0,"params");for(const te in R){if(!te)return ee.error("Image parameter name should be non-empty"),!1;const le=ee.concat(void 0,te).parse(R[te],void 0,Yo,void 0,{typeAnnotation:"coerce"});if(!le)return!1;q[te]=le}g[g.length-1].options.params=q}if(L){if(typeof L!="object"||L.constructor!==Object)return U.error('Image options "iconset" should be an object'),!1;if(!L.id)return U.error('Image options "iconset" should have an "id" property'),!1;g[g.length-1].options.iconset=L}return h++,!0}var j;return!0}for(let j=0;j<2;j++)if(!x()||!b())return;return new su(g[0].image,g[1]?g[1].image:void 0,g[0].options,g[1]?g[1].options:void 0)}evaluateParams(i,l){const h={};if(l){for(const g in l)if(l[g])try{h[g]=l[g].evaluate(i)}catch{continue}if(Object.keys(h).length!==0)return{params:h}}}evaluate(i){const l={name:this.namePrimary.evaluate(i),iconsetId:this.iconsetIdPrimary},h=this.nameSecondary?{name:this.nameSecondary.evaluate(i),iconsetId:this.iconsetIdSecondary}:void 0,g=uo.build(l,h,this.paramsPrimary?this.evaluateParams(i,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(i,this.paramsSecondary):void 0);if(g&&i.availableImages){const x=g.getPrimary().id;if(g.available=i.availableImages.some((b=>vl.isEqual(b,x))),g.available){const b=g.getSecondary()?g.getSecondary().id:null;b&&(g.available=i.availableImages.some((j=>vl.isEqual(j,b))))}}return g}eachChild(i){if(i(this.namePrimary),this.paramsPrimary)for(const l in this.paramsPrimary)this.paramsPrimary[l]&&i(this.paramsPrimary[l]);if(this.nameSecondary&&(i(this.nameSecondary),this.paramsSecondary))for(const l in this.paramsSecondary)this.paramsSecondary[l]&&i(this.paramsSecondary[l])}outputDefined(){return!1}serializeOptions(i,l){const h={};if(l&&(h.iconset={id:l}),i){h.params={};for(const g in i)i[g]&&(h.params[g]=i[g].serialize())}return Object.keys(h).length>0?h:void 0}serialize(){const i=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const l=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);l&&i.push(l)}if(this.nameSecondary&&(i.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const l=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);l&&i.push(l)}return i}}function kc(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}const Xf={"to-boolean":ri,"to-color":Yo,"to-number":cr,"to-string":Qi};class xl{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");const h=i[0],g=[];let x=th;if(h==="to-array"){if(!Array.isArray(i[1]))return null;const b=i[1].length;if(l.expectedType){if(l.expectedType.kind!=="array")return l.error(`Expected ${l.expectedType.kind} but found array.`);x=vt(l.expectedType.itemType,b)}else{if(!(b>0&&ei(i[1][0])))return null;x=vt(Fn(i[1][0]),b)}for(let j=0;j<b;j++){const M=i[1][j];let R;if(kc(M)==="array")R=l.parse(M,void 0,x.itemType);else{const L=kc(M);if(L!==x.itemType.kind)return l.error(`Expected ${x.itemType.kind} but found ${L}.`);R=l.registry.literal.parse(["literal",M===void 0?null:M],l)}if(!R)return null;g.push(R)}}else{if((h==="to-boolean"||h==="to-string")&&i.length!==2)return l.error("Expected one argument.");x=Xf[h];for(let b=1;b<i.length;b++){const j=l.parse(i[b],b,ve);if(!j)return null;g.push(j)}}return new xl(x,g)}evaluate(i){if(this.type.kind==="boolean")return!!this.args[0].evaluate(i);if(this.type.kind==="color"){let l,h;for(const g of this.args){if(l=g.evaluate(i),h=null,l instanceof ns)return l;if(typeof l=="string"){const x=i.parseColor(l);if(x)return x}else if(Array.isArray(l)&&(h=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Ou(l[0],l[1],l[2],l[3]),!h))return new ns(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new aa(h||`Could not parse color from value '${typeof l=="string"?l:String(JSON.stringify(l))}'`)}if(this.type.kind==="number"){let l=null;for(const h of this.args){if(l=h.evaluate(i),l===null)return 0;const g=Number(l);if(!isNaN(g))return g}throw new aa(`Could not convert ${JSON.stringify(l)} to number.`)}return this.type.kind==="formatted"?Bo.fromString(Ll(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?uo.build(Ll(this.args[0].evaluate(i))):this.type.kind==="array"?this.args.map((l=>l.evaluate(i))):Ll(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every((i=>i.outputDefined()))}serialize(){if(this.type.kind==="formatted")return new xc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new su(this.args[0]).serialize();const i=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild((l=>{i.push(l.serialize())})),i}}const Uo=["Unknown","Point","LineString","Polygon"];class nh{constructor(i,l){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=i,this.options=l}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Uo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(i){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,l=this.featureDistanceData.scale,{x:h,y:g}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(h*l-i[0])+this.featureDistanceData.bearing[1]*(g*l-i[1])}return 0}parseColor(i){let l=this._parseColorCache[i];return l||(l=this._parseColorCache[i]=ns.parse(i)),l}getConfig(i){return this.options?this.options.get(i):null}}class Ya{constructor(i,l,h,g,x){this.name=i,this.type=l,this._evaluate=h,this.args=g,this._overloadIndex=x}evaluate(i){if(!this._evaluate){const l=Ya.definitions[this.name];this._evaluate=Array.isArray(l)?l[2]:l.overloads[this._overloadIndex][1]}return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((i=>i.serialize())))}static parse(i,l){const h=i[0],g=Ya.definitions[h];if(!g)return l.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(g)?g[0]:g.type,b=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,j=[];let M=null,R=-1;for(const[L,U]of b){if(Array.isArray(L)&&L.length!==i.length-1)continue;j.push(L),R++,M=new bm(l.registry,l.path,null,l.scope,void 0,l._scope,l.options);const q=[];let ee=!1;for(let te=1;te<i.length;te++){const le=i[te],ue=Array.isArray(L)?L[te-1]:L.type,ge=M.parse(le,1+q.length,ue);if(!ge){ee=!0;break}q.push(ge)}if(!ee)if(Array.isArray(L)&&L.length!==q.length)M.error(`Expected ${L.length} arguments, but found ${q.length} instead.`);else{for(let te=0;te<q.length;te++){const le=Array.isArray(L)?L[te]:L.type,ue=q[te];M.concat(te+1).checkSubtype(le,ue.type)}if(M.errors.length===0)return new Ya(h,x,U,q,R)}}if(j.length===1)l.errors.push(...M.errors);else{const L=(j.length?j:b.map((([q])=>q))).map(wv).join(" | "),U=[];for(let q=1;q<i.length;q++){const ee=l.parse(i[q],1+U.length);if(!ee)return null;U.push(An(ee.type))}l.error(`Expected arguments of type ${L}, but found (${U.join(", ")}) instead.`)}return null}static register(i,l){Ya.definitions=l;for(const h in l)i[h]=Ya}}function wv(u){return Array.isArray(u)?`(${u.map(An).join(", ")})`:`(${An(u.type)}...)`}class Du{constructor(i,l,h){this.type=oe,this.locale=h,this.caseSensitive=i,this.diacriticSensitive=l}static parse(i,l){if(i.length!==2)return l.error("Expected one argument.");const h=i[1];if(typeof h!="object"||Array.isArray(h))return l.error("Collator options argument must be an object.");const g=h["case-sensitive"]===void 0?l.parse(!1,1,ri):l.parseObjectValue(h["case-sensitive"],1,"case-sensitive",ri);if(!g)return null;const x=h["diacritic-sensitive"]===void 0?l.parse(!1,1,ri):l.parseObjectValue(h["diacritic-sensitive"],1,"diacritic-sensitive",ri);if(!x)return null;let b=null;return h.locale&&(b=l.parseObjectValue(h.locale,1,"locale",Qi),!b)?null:new Du(g,x,b)}evaluate(i){return new Pa(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}function il(u,i,l=0,h=u.length-1,g=ew){for(;h>l;){if(h-l>600){const M=h-l+1,R=i-l+1,L=Math.log(M),U=.5*Math.exp(2*L/3),q=.5*Math.sqrt(L*U*(M-U)/M)*(R-M/2<0?-1:1);il(u,i,Math.max(l,Math.floor(i-R*U/M+q)),Math.min(h,Math.floor(i+(M-R)*U/M+q)),g)}const x=u[i];let b=l,j=h;for(mm(u,l,i),g(u[h],x)>0&&mm(u,l,h);b<j;){for(mm(u,b,j),b++,j--;g(u[b],x)<0;)b++;for(;g(u[j],x)>0;)j--}g(u[l],x)===0?mm(u,l,j):(j++,mm(u,j,h)),j<=i&&(l=j+1),i<=j&&(h=j-1)}}function mm(u,i,l){const h=u[i];u[i]=u[l],u[l]=h}function ew(u,i){return u<i?-1:u>i?1:0}function _c(u){let i=0;for(let l,h,g=0,x=u.length,b=x-1;g<x;b=g++)l=u[g],h=u[b],i+=(h.x-l.x)*(l.y+h.y);return i}function Ic(u,i){u[0]=Math.min(u[0],i[0]),u[1]=Math.min(u[1],i[1]),u[2]=Math.max(u[2],i[0]),u[3]=Math.max(u[3],i[1])}function Xh(u,i){return!(u[0]<=i[0]||u[2]>=i[2]||u[1]<=i[1]||u[3]>=i[3])}function rh(u,i,l){const h=u[0]-i[0],g=u[1]-i[1],x=u[0]-l[0],b=u[1]-l[1];return h*b-x*g==0&&h*x<=0&&g*b<=0}function Zh(u,i,l=!1){let h=!1;for(let j=0,M=i.length;j<M;j++){const R=i[j];for(let L=0,U=R.length,q=U-1;L<U;q=L++){const ee=R[q],te=R[L];if(rh(u,ee,te))return l;(x=ee)[1]>(g=u)[1]!=(b=te)[1]>g[1]&&g[0]<(b[0]-x[0])*(g[1]-x[1])/(b[1]-x[1])+x[0]&&(h=!h)}}var g,x,b;return h}function Sv(u,i,l,h){const g=h[0]-l[0],x=h[1]-l[1],b=(u[0]-l[0])*x-g*(u[1]-l[1]),j=(i[0]-l[0])*x-g*(i[1]-l[1]);return b>0&&j<0||b<0&&j>0}function Zf(u,i,l,h){return(g=[h[0]-l[0],h[1]-l[1]])[0]*(x=[i[0]-u[0],i[1]-u[1]])[1]-g[1]*x[0]!=0&&!(!Sv(u,i,l,h)||!Sv(l,h,u,i));var g,x}function Tv(u){const i=new Rt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),l=new Rt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const h of u[0])i.x>h.x&&(i.x=h.x),i.y>h.y&&(i.y=h.y),l.x<h.x&&(l.x=h.x),l.y<h.y&&(l.y=h.y);return{min:i,max:l}}const bc=8192;function Av(u,i){const l=(180+u[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,g=Math.pow(2,i.z);return[Math.round(l*g*bc),Math.round(h*g*bc)]}function Yf(u,i){for(let l=0;l<i.length;l++)if(Zh(u,i[l]))return!0;return!1}function jv(u,i,l){for(const h of l)for(let g=0,x=h.length,b=x-1;g<x;b=g++)if(Zf(u,i,h[b],h[g]))return!0;return!1}function Ev(u,i){for(let l=0;l<u.length;++l)if(!Zh(u[l],i))return!1;for(let l=0;l<u.length-1;++l)if(jv(u[l],u[l+1],i))return!1;return!0}function ih(u,i){for(let l=0;l<i.length;l++)if(Ev(u,i[l]))return!0;return!1}function sh(u,i,l){const h=[];for(let g=0;g<u.length;g++){const x=[];for(let b=0;b<u[g].length;b++){const j=Av(u[g][b],l);Ic(i,j),x.push(j)}h.push(x)}return h}function ku(u,i,l){const h=[];for(let g=0;g<u.length;g++){const x=sh(u[g],i,l);h.push(x)}return h}function Cv(u,i,l,h){if(u[0]<l[0]||u[0]>l[2]){const g=.5*h;let x=u[0]-l[0]>g?-h:l[0]-u[0]>g?h:0;x===0&&(x=u[0]-l[2]>g?-h:l[2]-u[0]>g?h:0),u[0]+=x}Ic(i,u)}function ah(u,i,l,h){const g=Math.pow(2,h.z)*bc,x=[h.x*bc,h.y*bc],b=[];if(!u)return b;for(const j of u)for(const M of j){const R=[M.x+x[0],M.y+x[1]];Cv(R,i,l,g),b.push(R)}return b}function gm(u,i,l,h){const g=Math.pow(2,h.z)*bc,x=[h.x*bc,h.y*bc],b=[];if(!u)return b;for(const M of u){const R=[];for(const L of M){const U=[L.x+x[0],L.y+x[1]];Ic(i,U),R.push(U)}b.push(R)}if(i[2]-i[0]<=g/2){(j=i)[0]=j[1]=1/0,j[2]=j[3]=-1/0;for(const M of b)for(const R of M)Cv(R,i,l,g)}var j;return b}class cd{constructor(i,l){this.type=ri,this.geojson=i,this.geometries=l}static parse(i,l){if(i.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(ei(i[1])){const h=i[1];if(h.type==="FeatureCollection")for(let g=0;g<h.features.length;++g){const x=h.features[g].geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new cd(h,h.features[g].geometry)}else if(h.type==="Feature"){const g=h.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new cd(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new cd(h,h)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return(function(l,h){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],b=l.canonicalID();if(!b)return!1;if(h.type==="Polygon"){const j=sh(h.coordinates,x,b),M=ah(l.geometry(),g,x,b);if(!Xh(g,x))return!1;for(const R of M)if(!Zh(R,j))return!1}if(h.type==="MultiPolygon"){const j=ku(h.coordinates,x,b),M=ah(l.geometry(),g,x,b);if(!Xh(g,x))return!1;for(const R of M)if(!Yf(R,j))return!1}return!0})(i,this.geometries);if(i.geometryType()==="LineString")return(function(l,h){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],b=l.canonicalID();if(!b)return!1;if(h.type==="Polygon"){const j=sh(h.coordinates,x,b),M=gm(l.geometry(),g,x,b);if(!Xh(g,x))return!1;for(const R of M)if(!Ev(R,j))return!1}if(h.type==="MultiPolygon"){const j=ku(h.coordinates,x,b),M=gm(l.geometry(),g,x,b);if(!Xh(g,x))return!1;for(const R of M)if(!ih(R,j))return!1}return!0})(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Kf={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Lc=1/298.257223563,Nv=Lc*(2-Lc),Jf=Math.PI/180;class Yh{static fromTile(i,l,h){const g=Math.PI*(1-2*(i+.5)/Math.pow(2,l)),x=Math.atan(.5*(Math.exp(g)-Math.exp(-g)))/Jf;return new Yh(x,h)}static get units(){return Kf}constructor(i,l){if(i===void 0)throw new Error("No latitude given.");if(l&&!Kf[l])throw new Error(`Unknown unit ${l}. Use one of: ${Object.keys(Kf).join(", ")}`);const h=6378.137*Jf*(l?Kf[l]:1),g=Math.cos(i*Jf),x=1/(1-Nv*(1-g*g)),b=Math.sqrt(x);this.kx=h*b*g,this.ky=h*b*x*(1-Nv)}distance(i,l){const h=ro(i[0]-l[0])*this.kx,g=(i[1]-l[1])*this.ky;return Math.sqrt(h*h+g*g)}bearing(i,l){const h=ro(l[0]-i[0])*this.kx;return Math.atan2(h,(l[1]-i[1])*this.ky)/Jf}destination(i,l,h){const g=h*Jf;return this.offset(i,Math.sin(g)*l,Math.cos(g)*l)}offset(i,l,h){return[i[0]+l/this.kx,i[1]+h/this.ky]}lineDistance(i){let l=0;for(let h=0;h<i.length-1;h++)l+=this.distance(i[h],i[h+1]);return l}area(i){let l=0;for(let h=0;h<i.length;h++){const g=i[h];for(let x=0,b=g.length,j=b-1;x<b;j=x++)l+=ro(g[x][0]-g[j][0])*(g[x][1]+g[j][1])*(h?-1:1)}return Math.abs(l)/2*this.kx*this.ky}along(i,l){let h=0;if(l<=0)return i[0];for(let g=0;g<i.length-1;g++){const x=i[g],b=i[g+1],j=this.distance(x,b);if(h+=j,h>l)return Qf(x,b,(l-(h-j))/j)}return i[i.length-1]}pointToSegmentDistance(i,l,h){let[g,x]=l,b=ro(h[0]-g)*this.kx,j=(h[1]-x)*this.ky;if(b!==0||j!==0){const M=(ro(i[0]-g)*this.kx*b+(i[1]-x)*this.ky*j)/(b*b+j*j);M>1?(g=h[0],x=h[1]):M>0&&(g+=b/this.kx*M,x+=j/this.ky*M)}return b=ro(i[0]-g)*this.kx,j=(i[1]-x)*this.ky,Math.sqrt(b*b+j*j)}pointOnLine(i,l){let h=1/0,g=i[0][0],x=i[0][1],b=0,j=0;for(let M=0;M<i.length-1;M++){let R=i[M][0],L=i[M][1],U=ro(i[M+1][0]-R)*this.kx,q=(i[M+1][1]-L)*this.ky,ee=0;U===0&&q===0||(ee=(ro(l[0]-R)*this.kx*U+(l[1]-L)*this.ky*q)/(U*U+q*q),ee>1?(R=i[M+1][0],L=i[M+1][1]):ee>0&&(R+=U/this.kx*ee,L+=q/this.ky*ee)),U=ro(l[0]-R)*this.kx,q=(l[1]-L)*this.ky;const te=U*U+q*q;te<h&&(h=te,g=R,x=L,b=M,j=ee)}return{point:[g,x],index:b,t:Math.max(0,Math.min(1,j))}}lineSlice(i,l,h){let g=this.pointOnLine(h,i),x=this.pointOnLine(h,l);if(g.index>x.index||g.index===x.index&&g.t>x.t){const R=g;g=x,x=R}const b=[g.point],j=g.index+1,M=x.index;!$g(h[j],b[0])&&j<=M&&b.push(h[j]);for(let R=j+1;R<=M;R++)b.push(h[R]);return $g(h[M],x.point)||b.push(x.point),b}lineSliceAlong(i,l,h){let g=0;const x=[];for(let b=0;b<h.length-1;b++){const j=h[b],M=h[b+1],R=this.distance(j,M);if(g+=R,g>i&&x.length===0&&x.push(Qf(j,M,(i-(g-R))/R)),g>=l)return x.push(Qf(j,M,(l-(g-R))/R)),x;g>i&&x.push(M)}return x}bufferPoint(i,l){const h=l/this.ky,g=l/this.kx;return[i[0]-g,i[1]-h,i[0]+g,i[1]+h]}bufferBBox(i,l){const h=l/this.ky,g=l/this.kx;return[i[0]-g,i[1]-h,i[2]+g,i[3]+h]}insideBBox(i,l){return ro(i[0]-l[0])>=0&&ro(i[0]-l[2])<=0&&i[1]>=l[1]&&i[1]<=l[3]}}function $g(u,i){return u[0]===i[0]&&u[1]===i[1]}function Qf(u,i,l){const h=ro(i[0]-u[0]);return[u[0]+h*l,u[1]+(i[1]-u[1])*l]}function ro(u){for(;u<-180;)u+=360;for(;u>180;)u-=360;return u}class ym{constructor(i=[],l=((h,g)=>h<g?-1:h>g?1:0)){if(this.data=i,this.length=this.data.length,this.compare=l,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:l,compare:h}=this,g=l[i];for(;i>0;){const x=i-1>>1,b=l[x];if(h(g,b)>=0)break;l[i]=b,i=x}l[i]=g}_down(i){const{data:l,compare:h}=this,g=this.length>>1,x=l[i];for(;i<g;){let b=1+(i<<1);const j=b+1;if(j<this.length&&h(l[j],l[b])<0&&(b=j),h(l[b],x)>=0)break;l[i]=l[b],i=b}l[i]=x}}var mn=8192;function ec(u,i){return i.dist-u.dist}const ud=100,ep=50;function oh(u){const i=[1/0,1/0,-1/0,-1/0];if(i.length!==u.length)return!1;for(let l=0;l<i.length;l++)if(i[l]!==u[l])return!1;return!0}function Iu(u){return u[1]-u[0]+1}function tc(u,i){const l=u[1]>=u[0]&&u[1]<i;return l||console.warn("Distance Expression: Index is out of range"),l}function dd(u,i){if(u[0]>u[1])return[null,null];const l=Iu(u);if(i){if(l===2)return[u,null];const h=Math.floor(l/2);return[[u[0],u[0]+h],[u[0]+h,u[1]]]}{if(l===1)return[u,null];const h=Math.floor(l/2)-1;return[[u[0],u[0]+h],[u[0]+h+1,u[1]]]}}function hd(u,i){const l=[1/0,1/0,-1/0,-1/0];if(!tc(i,u.length))return l;for(let h=i[0];h<=i[1];++h)Ic(l,u[h]);return l}function lh(u){const i=[1/0,1/0,-1/0,-1/0];for(let l=0;l<u.length;++l)for(let h=0;h<u[l].length;++h)Ic(i,u[l][h]);return i}function _l(u,i,l){if(oh(u)||oh(i))return NaN;let h=0,g=0;return u[2]<i[0]&&(h=i[0]-u[2]),u[0]>i[2]&&(h=u[0]-i[2]),u[1]>i[3]&&(g=u[1]-i[3]),u[3]<i[1]&&(g=i[1]-u[3]),l.distance([0,0],[h,g])}function Pi(u){return 360*u-180}function wc(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function vm(u,i){const l=Math.pow(2,i.z),h=(u.y/mn+i.y)/l;return[Pi((u.x/mn+i.x)/l),wc(h)]}function fd(u,i){const l=[];for(let h=0;h<u.length;++h)l.push(vm(u[h],i));return l}function qg(u,i,l){const h=l.pointOnLine(i,u).point;return l.distance(u,h)}function xm(u,i,l,h,g){const x=l.slice(h[0],h[1]+1);let b=1/0;for(let j=i[0];j<=i[1];++j)if((b=Math.min(b,qg(u[j],x,g)))===0)return 0;return b}function Ss(u,i,l,h,g){const x=Math.min(g.pointToSegmentDistance(u,l,h),g.pointToSegmentDistance(i,l,h)),b=Math.min(g.pointToSegmentDistance(l,u,i),g.pointToSegmentDistance(h,u,i));return Math.min(x,b)}function Pv(u,i,l,h,g){if(!tc(i,u.length)||!tc(h,l.length))return NaN;let x=1/0;for(let b=i[0];b<i[1];++b)for(let j=h[0];j<h[1];++j){if(Zf(u[b],u[b+1],l[j],l[j+1]))return 0;x=Math.min(x,Ss(u[b],u[b+1],l[j],l[j+1],g))}return x}function Mv(u,i,l,h,g){if(!tc(i,u.length)||!tc(h,l.length))return NaN;let x=1/0;for(let b=i[0];b<=i[1];++b)for(let j=h[0];j<=h[1];++j)if((x=Math.min(x,g.distance(u[b],l[j])))===0)return x;return x}function tp(u,i,l){if(Zh(u,i,!0))return 0;let h=1/0;for(const g of i){const x=g.length;if(x<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(g[0]!==g[x-1]&&(h=Math.min(h,l.pointToSegmentDistance(u,g[x-1],g[0])))===0||(h=Math.min(h,qg(u,g,l)))===0)return h}return h}function np(u,i,l,h){if(!tc(i,u.length))return NaN;for(let x=i[0];x<=i[1];++x)if(Zh(u[x],l,!0))return 0;let g=1/0;for(let x=i[0];x<i[1];++x)for(const b of l)for(let j=0,M=b.length,R=M-1;j<M;R=j++){if(Zf(u[x],u[x+1],b[R],b[j]))return 0;g=Math.min(g,Ss(u[x],u[x+1],b[R],b[j],h))}return g}function _m(u,i){for(const l of u)for(let h=0;h<=l.length-1;++h)if(Zh(l[h],i,!0))return!0;return!1}function Hg(u,i,l,h=1/0){const g=lh(u),x=lh(i);if(h!==1/0&&_l(g,x,l)>=h)return h;if(Xh(g,x)){if(_m(u,i))return 0}else if(_m(i,u))return 0;let b=h;for(const j of u)for(let M=0,R=j.length,L=R-1;M<R;L=M++)for(const U of i)for(let q=0,ee=U.length,te=ee-1;q<ee;te=q++){if(Zf(j[L],j[M],U[te],U[q]))return 0;b=Math.min(b,Ss(j[L],j[M],U[te],U[q],l))}return b}function zl(u,i,l,h,g,x,b){if(x===null||b===null)return;const j=_l(hd(h,x),hd(g,b),l);j<i&&u.push({dist:j,range1:x,range2:b})}function zc(u,i,l,h,g=1/0){let x=Math.min(h.distance(u[0],l[0][0]),g);if(x===0)return x;const b=new ym([{dist:0,range1:[0,u.length-1],range2:[0,0]}],ec),j=i?ep:ud,M=lh(l);for(;b.length;){const R=b.pop();if(R.dist>=x)continue;const L=R.range1;if(Iu(L)<=j){if(!tc(L,u.length))return NaN;if(i){const U=np(u,L,l,h);if((x=Math.min(x,U))===0)return x}else for(let U=L[0];U<=L[1];++U){const q=tp(u[U],l,h);if((x=Math.min(x,q))===0)return x}}else{const U=dd(L,i);if(U[0]!==null){const q=_l(hd(u,U[0]),M,h);q<x&&b.push({dist:q,range1:U[0],range2:[0,0]})}if(U[1]!==null){const q=_l(hd(u,U[1]),M,h);q<x&&b.push({dist:q,range1:U[1],range2:[0,0]})}}}return x}function ch(u,i,l,h,g,x=1/0){let b=Math.min(x,g.distance(u[0],l[0]));if(b===0)return b;const j=new ym([{dist:0,range1:[0,u.length-1],range2:[0,l.length-1]}],ec),M=i?ep:ud,R=h?ep:ud;for(;j.length;){const L=j.pop();if(L.dist>=b)continue;const U=L.range1,q=L.range2;if(Iu(U)<=M&&Iu(q)<=R){if(!tc(U,u.length)||!tc(q,l.length))return NaN;if(i&&h?b=Math.min(b,Pv(u,U,l,q,g)):i||h?i&&!h?b=Math.min(b,xm(l,q,u,U,g)):!i&&h&&(b=Math.min(b,xm(u,U,l,q,g))):b=Math.min(b,Mv(u,U,l,q,g)),b===0)return b}else{const ee=dd(U,i),te=dd(q,h);zl(j,b,g,u,l,ee[0],te[0]),zl(j,b,g,u,l,ee[0],te[1]),zl(j,b,g,u,l,ee[1],te[0]),zl(j,b,g,u,l,ee[1],te[1])}}return b}function au(u,i,l,h,g=1/0){let x=g;const b=hd(u,[0,u.length-1]);for(const j of l)if(!(x!==1/0&&_l(b,hd(j,[0,j.length-1]),h)>=x)&&(x=Math.min(x,ch(u,i,j,!0,h,x)),x===0))return x;return x}function Fc(u,i,l,h,g=1/0){let x=g;const b=hd(u,[0,u.length-1]);for(const j of l){if(x!==1/0&&_l(b,lh(j),h)>=x)continue;const M=zc(u,i,j,h,x);if(isNaN(M))return M;if((x=Math.min(x,M))===0)return x}return x}function pd(u){return u==="Point"||u==="MultiPoint"||u==="LineString"||u==="MultiLineString"||u==="Polygon"||u==="MultiPolygon"}class uh{constructor(i,l){this.type=cr,this.geojson=i,this.geometries=l}static parse(i,l){if(i.length!==2)return l.error(`'distance' expression requires either one argument, but found ' ${i.length-1} instead.`);if(ei(i[1])){const h=i[1];if(h.type==="FeatureCollection"){for(let g=0;g<h.features.length;++g)if(pd(h.features[g].geometry.type))return new uh(h,h.features[g].geometry)}else if(h.type==="Feature"){if(pd(h.geometry.type))return new uh(h,h.geometry)}else if(pd(h.type))return new uh(h,h)}return l.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(i){const l=i.geometry(),h=i.canonicalID();if(l!=null&&h!=null){if(i.geometryType()==="Point")return(function(g,x,b){const j=[];for(const R of g)for(const L of R)j.push(vm(L,x));const M=new Yh(j[0][1],"meters");return b.type==="Point"||b.type==="MultiPoint"||b.type==="LineString"?ch(j,!1,b.type==="Point"?[b.coordinates]:b.coordinates,b.type==="LineString",M):b.type==="MultiLineString"?au(j,!1,b.coordinates,M):b.type==="Polygon"||b.type==="MultiPolygon"?Fc(j,!1,b.type==="Polygon"?[b.coordinates]:b.coordinates,M):null})(l,h,this.geometries);if(i.geometryType()==="LineString")return(function(g,x,b){const j=[];for(const R of g){const L=[];for(const U of R)L.push(vm(U,x));j.push(L)}const M=new Yh(j[0][0][1],"meters");if(b.type==="Point"||b.type==="MultiPoint"||b.type==="LineString")return au(b.type==="Point"?[b.coordinates]:b.coordinates,b.type==="LineString",j,M);if(b.type==="MultiLineString"){let R=1/0;for(let L=0;L<b.coordinates.length;L++){const U=au(b.coordinates[L],!0,j,M,R);if(isNaN(U))return U;if((R=Math.min(R,U))===0)return R}return R}if(b.type==="Polygon"||b.type==="MultiPolygon"){let R=1/0;for(let L=0;L<j.length;L++){const U=Fc(j[L],!0,b.type==="Polygon"?[b.coordinates]:b.coordinates,M,R);if(isNaN(U))return U;if((R=Math.min(R,U))===0)return R}return R}return null})(l,h,this.geometries);if(i.geometryType()==="Polygon")return(function(g,x,b){const j=[];for(const R of(function(L,U){const q=L.length;if(q<=1)return[L];const ee=[];let te,le;for(let ue=0;ue<q;ue++){const ge=_c(L[ue]);ge!==0&&(L[ue].area=Math.abs(ge),le===void 0&&(le=ge<0),le===ge<0?(te&&ee.push(te),te=[L[ue]]):te.push(L[ue]))}return te&&ee.push(te),ee})(g)){const L=[];for(let U=0;U<R.length;++U)L.push(fd(R[U],x));j.push(L)}const M=new Yh(j[0][0][0][1],"meters");if(b.type==="Point"||b.type==="MultiPoint"||b.type==="LineString")return Fc(b.type==="Point"?[b.coordinates]:b.coordinates,b.type==="LineString",j,M);if(b.type==="MultiLineString"){let R=1/0;for(let L=0;L<b.coordinates.length;L++){const U=Fc(b.coordinates[L],!0,j,M,R);if(isNaN(U))return U;if((R=Math.min(R,U))===0)return R}return R}return b.type==="Polygon"||b.type==="MultiPolygon"?(function(R,L,U){let q=1/0;for(const ee of R)for(const te of L){const le=Hg(ee,te,U,q);if(isNaN(le))return le;if((q=Math.min(q,le))===0)return q}return q})(b.type==="Polygon"?[b.coordinates]:b.coordinates,j,M):null})(l,h,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function dh(u){if(u instanceof Ya&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof cd||u instanceof uh)return!1;if(u instanceof hh)return u.featureConstant;let i=!0;return u.eachChild((l=>{i&&!dh(l)&&(i=!1)})),i}function rp(u){if(u instanceof Ya&&u.name==="feature-state")return!1;let i=!0;return u.eachChild((l=>{i&&!rp(l)&&(i=!1)})),i}function Ko(u){if(u instanceof hh)return new Set([u.key]);let i=new Set;return u.eachChild((l=>{i=new Set([...i,...Ko(l)])})),i}function Ma(u,i){if(u instanceof Ya&&i.indexOf(u.name)>=0)return!1;let l=!0;return u.eachChild((h=>{l&&!Ma(h,i)&&(l=!1)})),l}function oa(u,i,l){return[u,i,l].filter(Boolean).join("")}function md(u,i){switch(u){case"string":return Ll(i);case"number":return+i;case"boolean":return!!i;case"color":return ns.parse(i);case"formatted":return Bo.fromString(Ll(i));case"resolvedImage":return uo.build(Ll(i))}return i}function ou(u,i,l,h){return h!==void 0&&(u=h*Math.round(u/h)),i!==void 0&&u<i&&(u=i),l!==void 0&&u>l&&(u=l),u}class hh{constructor(i,l,h,g=!1){this.type=i,this.key=l,this.scope=h,this.featureConstant=g}static parse(i,l){let h=l.expectedType;if(h==null&&(h=ve),i.length<2||i.length>3)return l.error("Invalid number of arguments for 'config' expression.");const g=l.parse(i[1],1);if(!(g instanceof Pr))return l.error("Key name of 'config' expression must be a string literal.");let x,b=!0;const j=Ll(g.value);if(i.length>=3){const M=l.parse(i[2],2);if(!(M instanceof Pr))return l.error("Scope of 'config' expression must be a string literal.");x=Ll(M.value)}if(l.options){const M=oa(j,x,l._scope),R=l.options.get(M);R&&(b=dh(R.value||R.default))}return new hh(h,j,x,b)}evaluate(i){const l=oa(this.key,this.scope,i.scope),h=i.getConfig(l);if(!h)return null;const{type:g,value:x,values:b,minValue:j,maxValue:M,stepValue:R}=h,L=h.default.evaluate(i);let U=L;if(x){const q=i.scope;i.scope=(q||"").split("").slice(1).join(""),U=x.evaluate(i),i.scope=q}return g&&(U=md(g,U)),U===void 0||j===void 0&&M===void 0&&R===void 0||(typeof U=="number"?U=ou(U,j,M,R):Array.isArray(U)&&(U=U.map((q=>typeof q=="number"?ou(q,j,M,R):q)))),x!==void 0&&U!==void 0&&b&&!b.includes(U)&&(U=L,g&&(U=md(g,U))),(g&&g!==this.type||U!==void 0&&!$s(Fn(U),this.type))&&(U=md(this.type.kind,U)),U}eachChild(){}outputDefined(){return!1}serialize(){const i=["config",this.key];return this.scope&&i.concat(this.scope),i}}class Lu{constructor(i,l){this.type=l.type,this.name=i,this.boundExpression=l}static parse(i,l){if(i.length!==2||typeof i[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const h=i[1];return l.scope.has(h)?new Lu(h,l.scope.get(h)):l.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class bm{constructor(i,l=[],h,g=new Wh,x=[],b,j){this.registry=i,this.path=l,this.key=l.map((M=>typeof M=="string"?`['${M}']`:`[${M}]`)).join(""),this.scope=g,this.errors=x,this.expectedType=h,this._scope=b,this.options=j}parse(i,l,h,g,x={}){return l||h?this.concat(l,null,h,g)._parse(i,x):this._parse(i,x)}parseObjectValue(i,l,h,g,x,b={}){return this.concat(l,h,g,x)._parse(i,b)}_parse(i,l){function h(g,x,b){return b==="assert"?new _r(x,[g]):b==="coerce"?new xl(x,[g]):g}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=typeof i[0]=="string"?this.registry[i[0]]:void 0;if(g){let x=g.parse(i,this);if(!x)return null;if(this.expectedType){const b=this.expectedType,j=x.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||j.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||j.kind!=="value"&&j.kind!=="string"){if(this.checkSubtype(b,j))return null}else x=h(x,b,l.typeAnnotation||"coerce");else x=h(x,b,l.typeAnnotation||"assert")}if(!(x instanceof Pr)&&x.type.kind!=="resolvedImage"&&Gg(x)){const b=new nh(this._scope,this.options);try{x=new Pr(x.type,x.evaluate(b))}catch(j){return this.error(j.message),null}}return x}return xl.parse(["to-array",i],this)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,l,h,g){let x=typeof i=="number"?this.path.concat(i):this.path;x=typeof l=="string"?x.concat(l):x;const b=g?this.scope.concat(g):this.scope;return new bm(this.registry,x,h||null,b,this.errors,this._scope,this.options)}error(i,...l){const h=`${this.key}${l.map((g=>`[${g}]`)).join("")}`;this.errors.push(new Il(h,i))}checkSubtype(i,l){const h=Xr(i,l);return h&&this.error(h),h}}function Gg(u){if(u instanceof Lu)return Gg(u.boundExpression);if(u instanceof Ya&&u.name==="error"||u instanceof Du||u instanceof cd||u instanceof uh||u instanceof hh)return!1;const i=u instanceof xl||u instanceof _r;let l=!0;return u.eachChild((h=>{l=i?l&&Gg(h):l&&h instanceof Pr})),!!l&&dh(u)&&Ma(u,["zoom","heatmap-density","worldview","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function fh(u,i){const l=u.length-1;let h,g,x=0,b=l,j=0;for(;x<=b;)if(j=Math.floor((x+b)/2),h=u[j],g=u[j+1],h<=i){if(j===l||i<g)return j;x=j+1}else{if(!(h>i))throw new aa("Input is not a number.");b=j-1}return 0}class gd{constructor(i,l,h){this.type=i,this.input=l,this.labels=[],this.outputs=[];for(const[g,x]of h)this.labels.push(g),this.outputs.push(x)}static parse(i,l){if(i.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return l.error("Expected an even number of arguments.");const h=l.parse(i[1],1,cr);if(!h)return null;const g=[];let x=null;l.expectedType&&l.expectedType.kind!=="value"&&(x=l.expectedType);for(let b=1;b<i.length;b+=2){const j=b===1?-1/0:i[b],M=i[b+1],R=b,L=b+1;if(typeof j!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(g.length&&g[g.length-1][0]>=j)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',R);const U=l.parse(M,L,x);if(!U)return null;x=x||U.type,g.push([j,U])}return new gd(x,h,g)}evaluate(i){const l=this.labels,h=this.outputs;if(l.length===1)return h[0].evaluate(i);const g=this.input.evaluate(i);if(g<=l[0])return h[0].evaluate(i);const x=l.length;return g>=l[x-1]?h[x-1].evaluate(i):h[fh(l,g)].evaluate(i)}eachChild(i){i(this.input);for(const l of this.outputs)i(l)}outputDefined(){return this.outputs.every((i=>i.outputDefined()))}serialize(){const i=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&i.push(this.labels[l]),i.push(this.outputs[l].serialize());return i}}const Rv=.95047,ip=1.08883,Wg=4/29,Bc=6/29,zu=3*Bc*Bc,Fu=Bc*Bc*Bc,yd=Math.PI/180,Xg=180/Math.PI;function wm(u){return u>Fu?Math.pow(u,1/3):u/zu+Wg}function Kh(u){return u>Bc?u*u*u:zu*(u-Wg)}function sp(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function Bu(u){return(u/=255)<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function Jo(u){const i=Bu(u.r),l=Bu(u.g),h=Bu(u.b),g=wm((.4124564*i+.3575761*l+.1804375*h)/Rv),x=wm((.2126729*i+.7151522*l+.072175*h)/1);return{l:116*x-16,a:500*(g-x),b:200*(x-wm((.0193339*i+.119192*l+.9503041*h)/ip)),alpha:u.a}}function Uu(u){let i=(u.l+16)/116,l=isNaN(u.a)?i:i+u.a/500,h=isNaN(u.b)?i:i-u.b/200;return i=1*Kh(i),l=Rv*Kh(l),h=ip*Kh(h),new ns(sp(3.2404542*l-1.5371385*i-.4985314*h),sp(-.969266*l+1.8760108*i+.041556*h),sp(.0556434*l-.2040259*i+1.0572252*h),u.alpha)}function Ov(u,i,l){const h=i-u;return u+l*(h>180||h<-180?h-360*Math.round(h/360):h)}const ap={forward:Jo,reverse:Uu,interpolate:function(u,i,l){return{l:yr(u.l,i.l,l),a:yr(u.a,i.a,l),b:yr(u.b,i.b,l),alpha:yr(u.alpha,i.alpha,l)}}},Sm={forward:function(u){const{l:i,a:l,b:h}=Jo(u),g=Math.atan2(h,l)*Xg;return{h:g<0?g+360:g,c:Math.sqrt(l*l+h*h),l:i,alpha:u.a}},reverse:function(u){const i=u.h*yd,l=u.c;return Uu({l:u.l,a:Math.cos(i)*l,b:Math.sin(i)*l,alpha:u.alpha})},interpolate:function(u,i,l){return{h:Ov(u.h,i.h,l),c:yr(u.c,i.c,l),l:yr(u.l,i.l,l),alpha:yr(u.alpha,i.alpha,l)}}};var Zg=Object.freeze({__proto__:null,hcl:Sm,lab:ap});class na{constructor(i,l,h,g,x){this.type=i,this.operator=l,this.interpolation=h,this.input=g,this.labels=[],this.outputs=[];for(const[b,j]of x)this.labels.push(b),this.outputs.push(j)}static interpolationFactor(i,l,h,g){let x=0;if(i.name==="exponential")x=Tm(l,i.base,h,g);else if(i.name==="linear")x=Tm(l,1,h,g);else if(i.name==="cubic-bezier"){const b=i.controlPoints;x=new Vr(b[0],b[1],b[2],b[3]).solve(Tm(l,1,h,g))}return x}static parse(i,l){let[h,g,x,...b]=i;if(!Array.isArray(g)||g.length===0)return l.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const R=g[1];if(typeof R!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:R}}else{if(g[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const R=g.slice(1);if(R.length!==4||R.some((L=>typeof L!="number"||L<0||L>1)))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:R}}}if(i.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length-1>3&&(i.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(x=l.parse(x,2,cr),!x)return null;const j=[];let M=null;h==="interpolate-hcl"||h==="interpolate-lab"?M=Yo:l.expectedType&&l.expectedType.kind!=="value"&&(M=l.expectedType);for(let R=0;R<b.length;R+=2){const L=b[R],U=b[R+1],q=R+3,ee=R+4;if(typeof L!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(j.length&&j[j.length-1][0]>=L)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',q);const te=l.parse(U,ee,M);if(!te)return null;M=M||te.type,j.push([L,te])}return M.kind==="number"||M.kind==="color"||M.kind==="array"&&M.itemType.kind==="number"&&typeof M.N=="number"?new na(M,h,g,x,j):l.error(`Type ${An(M)} is not interpolatable.`)}evaluate(i){const l=this.labels,h=this.outputs;if(l.length===1)return h[0].evaluate(i);const g=this.input.evaluate(i);if(g<=l[0])return h[0].evaluate(i);const x=l.length;if(g>=l[x-1])return h[x-1].evaluate(i);const b=fh(l,g),j=na.interpolationFactor(this.interpolation,g,l[b],l[b+1]),M=h[b].evaluate(i),R=h[b+1].evaluate(i);return this.operator==="interpolate"?Gh[this.type.kind.toLowerCase()](M,R,j):this.operator==="interpolate-hcl"?Sm.reverse(Sm.interpolate(Sm.forward(M),Sm.forward(R),j)):ap.reverse(ap.interpolate(ap.forward(M),ap.forward(R),j))}eachChild(i){i(this.input);for(const l of this.outputs)i(l)}outputDefined(){return this.outputs.every((i=>i.outputDefined()))}serialize(){let i;i=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const l=[this.operator,i,this.input.serialize()];for(let h=0;h<this.labels.length;h++)l.push(this.labels[h],this.outputs[h].serialize());return l}}function Tm(u,i,l,h){const g=h-l,x=u-l;return g===0?0:i===1?x/g:(Math.pow(i,x)-1)/(Math.pow(i,g)-1)}class ph{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expectected at least one argument.");let h=null;const g=l.expectedType;g&&g.kind!=="value"&&(h=g);const x=[];for(const j of i.slice(1)){const M=l.parse(j,1+x.length,h,void 0,{typeAnnotation:"omit"});if(!M)return null;h=h||M.type,x.push(M)}const b=g&&x.some((j=>Xr(g,j.type)));return new ph(b?ve:h,x)}evaluate(i){let l,h=null,g=0;for(const x of this.args){if(g++,h=x.evaluate(i),h&&h instanceof uo&&!h.available&&(l||(l=h),h=null,g===this.args.length))return l;if(h!==null)break}return h}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every((i=>i.outputDefined()))}serialize(){const i=["coalesce"];return this.eachChild((l=>{i.push(l.serialize())})),i}}class vd{constructor(i,l){this.type=l.type,this.bindings=[].concat(i),this.result=l}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const l of this.bindings)i(l[1]);i(this.result)}static parse(i,l){if(i.length<4)return l.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const h=[];for(let x=1;x<i.length-1;x+=2){const b=i[x];if(typeof b!="string")return l.error(`Expected string, but found ${typeof b} instead.`,x);if(/[^a-zA-Z0-9_]/.test(b))return l.error("Variable names must contain only alphanumeric characters or '_'.",x);const j=l.parse(i[x+1],x+1);if(!j)return null;h.push([b,j])}const g=l.parse(i[i.length-1],i.length-1,l.expectedType,h);return g?new vd(h,g):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[l,h]of this.bindings)i.push(l,h.serialize());return i.push(this.result.serialize()),i}}class op{constructor(i,l,h){this.type=i,this.index=l,this.input=h}static parse(i,l){if(i.length!==3)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=l.parse(i[1],1,cr),g=l.parse(i[2],2,vt(l.expectedType||ve));return h&&g?new op(g.type.itemType,h,g):null}evaluate(i){const l=this.index.evaluate(i),h=this.input.evaluate(i);if(l<0)throw new aa(`Array index out of bounds: ${l} < 0.`);if(l>=h.length)throw new aa(`Array index out of bounds: ${l} > ${h.length-1}.`);if(l!==Math.floor(l))throw new aa(`Array index must be an integer, but found ${l} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return h[l]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class mh{constructor(i,l,h){this.type=i,this.index=l,this.input=h}static parse(i,l){if(i.length!==3)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=l.parse(i[1],1,cr),g=l.parse(i[2],2,vt(l.expectedType||ve));return h&&g?new mh(g.type.itemType,h,g):null}evaluate(i){const l=this.index.evaluate(i),h=this.input.evaluate(i);if(l<0)throw new aa(`Array index out of bounds: ${l} < 0.`);if(l>h.length-1)throw new aa(`Array index out of bounds: ${l} > ${h.length-1}.`);if(l===Math.floor(l))return h[l];const g=Math.floor(l),x=Math.ceil(l),b=h[g],j=h[x];if(typeof b!="number"||typeof j!="number")throw new aa(`Cannot interpolate between non-number values at index ${l}.`);const M=l-g;return b*(1-M)+j*M}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class gh{constructor(i,l){this.type=ri,this.needle=i,this.haystack=l}static parse(i,l){if(i.length!==3)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=l.parse(i[1],1,ve),g=l.parse(i[2],2,ve);return h&&g?Ti(h.type,[ri,Qi,cr,th,ve])?new gh(h,g):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${An(h.type)} instead`):null}evaluate(i){const l=this.needle.evaluate(i),h=this.haystack.evaluate(i);if(h==null)return!1;if(!Ms(l,["boolean","string","number","null"]))throw new aa(`Expected first argument to be of type boolean, string, number or null, but found ${An(Fn(l))} instead.`);if(!Ms(h,["string","array"]))throw new aa(`Expected second argument to be of type array or string, but found ${An(Fn(h))} instead.`);return h.indexOf(l)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Yg{constructor(i,l,h){this.type=cr,this.needle=i,this.haystack=l,this.fromIndex=h}static parse(i,l){if(i.length<=2||i.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const h=l.parse(i[1],1,ve),g=l.parse(i[2],2,ve);if(!h||!g)return null;if(!Ti(h.type,[ri,Qi,cr,th,ve]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${An(h.type)} instead`);if(i.length===4){const x=l.parse(i[3],3,cr);return x?new Yg(h,g,x):null}return new Yg(h,g)}evaluate(i){const l=this.needle.evaluate(i),h=this.haystack.evaluate(i);if(!Ms(l,["boolean","string","number","null"]))throw new aa(`Expected first argument to be of type boolean, string, number or null, but found ${An(Fn(l))} instead.`);if(!Ms(h,["string","array"]))throw new aa(`Expected second argument to be of type array or string, but found ${An(Fn(h))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(i);return h.indexOf(l,g)}return h.indexOf(l)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Am{constructor(i,l,h,g,x,b){this.inputType=i,this.type=l,this.input=h,this.cases=g,this.outputs=x,this.otherwise=b}static parse(i,l){if(i.length<5)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return l.error("Expected an even number of arguments.");let h,g;l.expectedType&&l.expectedType.kind!=="value"&&(g=l.expectedType);const x={},b=[];for(let R=2;R<i.length-1;R+=2){let L=i[R];const U=i[R+1];Array.isArray(L)||(L=[L]);const q=l.concat(R);if(L.length===0)return q.error("Expected at least one branch label.");for(const te of L){if(typeof te!="number"&&typeof te!="string")return q.error("Branch labels must be numbers or strings.");if(typeof te=="number"&&Math.abs(te)>Number.MAX_SAFE_INTEGER)return q.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof te=="number"&&Math.floor(te)!==te)return q.error("Numeric branch labels must be integer values.");if(h){if(q.checkSubtype(h,Fn(te)))return null}else h=Fn(te);if(x[String(te)]!==void 0)return q.error("Branch labels must be unique.");x[String(te)]=b.length}const ee=l.parse(U,R,g);if(!ee)return null;g=g||ee.type,b.push(ee)}const j=l.parse(i[1],1,ve);if(!j)return null;const M=l.parse(i[i.length-1],i.length-1,g);return M?j.type.kind!=="value"&&l.concat(1).checkSubtype(h,j.type)?null:new Am(h,g,j,x,b,M):null}evaluate(i){const l=this.input.evaluate(i);return($s(Fn(l),this.inputType)&&this.outputs[this.cases[l]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every((i=>i.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),h=[],g={};for(const b of l){const j=g[this.cases[b]];j===void 0?(g[this.cases[b]]=h.length,h.push([this.cases[b],[b]])):h[j][1].push(b)}const x=b=>this.inputType.kind==="number"?Number(b):b;for(const[b,j]of h)i.push(j.length===1?x(j[0]):j.map(x)),i.push(this.outputs[b].serialize());return i.push(this.otherwise.serialize()),i}}class Kg{constructor(i,l,h){this.type=i,this.branches=l,this.otherwise=h}static parse(i,l){if(i.length<4)return l.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return l.error("Expected an odd number of arguments.");let h;l.expectedType&&l.expectedType.kind!=="value"&&(h=l.expectedType);const g=[];for(let b=1;b<i.length-1;b+=2){const j=l.parse(i[b],b,ri);if(!j)return null;const M=l.parse(i[b+1],b+1,h);if(!M)return null;g.push([j,M]),h=h||M.type}const x=l.parse(i[i.length-1],i.length-1,h);return x?new Kg(h,g,x):null}evaluate(i){for(const[l,h]of this.branches)if(l.evaluate(i))return h.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[l,h]of this.branches)i(l),i(h);i(this.otherwise)}outputDefined(){return this.branches.every((([i,l])=>l.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild((l=>{i.push(l.serialize())})),i}}class yh{constructor(i,l,h,g){this.type=i,this.input=l,this.beginIndex=h,this.endIndex=g}static parse(i,l){if(i.length<=2||i.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const h=l.parse(i[1],1,ve),g=l.parse(i[2],2,cr);if(!h||!g)return null;if(!Ti(h.type,[vt(ve),Qi,ve]))return l.error(`Expected first argument to be of type array or string, but found ${An(h.type)} instead`);if(i.length===4){const x=l.parse(i[3],3,cr);return x?new yh(h.type,h,g,x):null}return new yh(h.type,h,g)}evaluate(i){const l=this.input.evaluate(i),h=this.beginIndex.evaluate(i);if(!Ms(l,["string","array"]))throw new aa(`Expected first argument to be of type array or string, but found ${An(Fn(l))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(i);return l.slice(h,g)}return l.slice(h)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}class xd{constructor(i,l){this.type=vt(Qi),this.str=i,this.delimiter=l}static parse(i,l){if(i.length!==3)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=l.parse(i[1],1,Qi),g=l.parse(i[2],2,Qi);return h&&g?new xd(h,g):void 0}evaluate(i){const l=this.str.evaluate(i),h=this.delimiter.evaluate(i);return l.split(h)}eachChild(i){i(this.str),i(this.delimiter)}outputDefined(){return!1}serialize(){return["split",this.str.serialize(),this.delimiter.serialize()]}}function jm(u,i){return u==="=="||u==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function Em(u,i,l,h){return h.compare(i,l)===0}function Jh(u,i,l){const h=u!=="=="&&u!=="!=";return class iie{constructor(x,b,j){this.type=ri,this.lhs=x,this.rhs=b,this.collator=j,this.hasUntypedArgument=x.type.kind==="value"||b.type.kind==="value"}static parse(x,b){if(x.length!==3&&x.length!==4)return b.error("Expected two or three arguments.");const j=x[0];let M=b.parse(x[1],1,ve);if(!M)return null;if(!jm(j,M.type))return b.concat(1).error(`"${j}" comparisons are not supported for type '${An(M.type)}'.`);let R=b.parse(x[2],2,ve);if(!R)return null;if(!jm(j,R.type))return b.concat(2).error(`"${j}" comparisons are not supported for type '${An(R.type)}'.`);if(M.type.kind!==R.type.kind&&M.type.kind!=="value"&&R.type.kind!=="value")return b.error(`Cannot compare types '${An(M.type)}' and '${An(R.type)}'.`);h&&(M.type.kind==="value"&&R.type.kind!=="value"?M=new _r(R.type,[M]):M.type.kind!=="value"&&R.type.kind==="value"&&(R=new _r(M.type,[R])));let L=null;if(x.length===4){if(M.type.kind!=="string"&&R.type.kind!=="string"&&M.type.kind!=="value"&&R.type.kind!=="value")return b.error("Cannot use collator to compare non-string types.");if(L=b.parse(x[3],3,oe),!L)return null}return new iie(M,R,L)}evaluate(x){const b=this.lhs.evaluate(x),j=this.rhs.evaluate(x);if(h&&this.hasUntypedArgument){const M=Fn(b),R=Fn(j);if(M.kind!==R.kind||M.kind!=="string"&&M.kind!=="number")throw new aa(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${M.kind}, ${R.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const M=Fn(b),R=Fn(j);if(M.kind!=="string"||R.kind!=="string")return i(x,b,j)}return this.collator?l(x,b,j,this.collator.evaluate(x)):i(x,b,j)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}serialize(){const x=[u];return this.eachChild((b=>{x.push(b.serialize())})),x}}}const lp=Jh("==",(function(u,i,l){return i===l}),Em),Dv=Jh("!=",(function(u,i,l){return i!==l}),(function(u,i,l,h){return!Em(0,i,l,h)})),Jg=Jh("<",(function(u,i,l){return i<l}),(function(u,i,l,h){return h.compare(i,l)<0})),kv=Jh(">",(function(u,i,l){return i>l}),(function(u,i,l,h){return h.compare(i,l)>0})),x_=Jh("<=",(function(u,i,l){return i<=l}),(function(u,i,l,h){return h.compare(i,l)<=0})),Qh=Jh(">=",(function(u,i,l){return i>=l}),(function(u,i,l,h){return h.compare(i,l)>=0}));class Qg{constructor(i,l,h,g,x,b){this.type=Qi,this.number=i,this.locale=l,this.currency=h,this.unit=g,this.minFractionDigits=x,this.maxFractionDigits=b}static parse(i,l){if(i.length!==3)return l.error("Expected two arguments.");const h=l.parse(i[1],1,cr);if(!h)return null;const g=i[2];if(typeof g!="object"||Array.isArray(g))return l.error("NumberFormat options argument must be an object.");let x=null;if(g.locale&&(x=l.parseObjectValue(g.locale,2,"locale",Qi),!x))return null;let b=null;if(g.currency&&(b=l.parseObjectValue(g.currency,2,"currency",Qi),!b))return null;let j=null;if(g.unit&&(j=l.parseObjectValue(g.unit,2,"unit",Qi),!j))return null;let M=null;if(g["min-fraction-digits"]&&(M=l.parseObjectValue(g["min-fraction-digits"],2,"min-fraction-digits",cr),!M))return null;let R=null;return g["max-fraction-digits"]&&(R=l.parseObjectValue(g["max-fraction-digits"],2,"max-fraction-digits",cr),!R)?null:new Qg(h,x,b,j,M,R)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(i):void 0,unit:this.unit?this.unit.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.unit&&i(this.unit),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.unit&&(i.unit=this.unit.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class ef{constructor(i){this.type=cr,this.input=i}static parse(i,l){if(i.length!==2)return l.error(`Expected 1 argument, but found ${i.length-1} instead.`);const h=l.parse(i[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${An(h.type)} instead.`):new ef(h):null}evaluate(i){const l=this.input.evaluate(i);if(typeof l=="string"||Array.isArray(l))return l.length;throw new aa(`Expected value to be of type string or array, but found ${An(Fn(l))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild((l=>{i.push(l.serialize())})),i}}function Iv(u){return function(){u=1831565813+(u|=0)|0;let i=Math.imul(u^u>>>15,1|u);return i=i+Math.imul(i^i>>>7,61|i)^i,((i^i>>>14)>>>0)/4294967296}}const tf={"==":lp,"!=":Dv,">":kv,"<":Jg,">=":Qh,"<=":x_,array:_r,at:op,"at-interpolated":mh,boolean:_r,case:Kg,coalesce:ph,collator:Du,format:xc,image:su,in:gh,"index-of":Yg,interpolate:na,"interpolate-hcl":na,"interpolate-lab":na,length:ef,let:vd,literal:Pr,match:Am,number:_r,"number-format":Qg,object:_r,slice:yh,step:gd,string:_r,"to-boolean":xl,"to-color":xl,"to-number":xl,"to-string":xl,var:Lu,within:cd,distance:uh,config:hh,split:xd};function Vu(u,[i,l,h,g]){i=i.evaluate(u),l=l.evaluate(u),h=h.evaluate(u);const x=g?g.evaluate(u):1,b=Ou(i,l,h,x);if(b)throw new aa(b);return new ns(i/255,l/255,h/255,x)}function ey(u,[i,l,h,g]){i=i.evaluate(u),l=l.evaluate(u),h=h.evaluate(u);const x=g?g.evaluate(u):1,b=(function(R,L,U,q){return typeof R=="number"&&R>=0&&R<=360?typeof L=="number"&&L>=0&&L<=100&&typeof U=="number"&&U>=0&&U<=100?q===void 0||typeof q=="number"&&q>=0&&q<=1?null:`Invalid hsla value [${[R,L,U,q].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof q=="number"?[R,L,U,q]:[R,L,U]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof q=="number"?[R,L,U,q]:[R,L,U]).join(", ")}]: 'h' must be between 0 and 360.`})(i,l,h,x);if(b)throw new aa(b);const j=`hsla(${i}, ${l}%, ${h}%, ${x})`,M=ns.parse(j);if(!M)throw new aa(`Failed to parse HSLA color: ${j}`);return M}function ty(u,i){return u in i}function lu(u,i){const l=i[u];return l===void 0?null:l}function Fl(u){return{type:u}}function nf(u){return{result:"success",value:u}}function $u(u){return{result:"error",value:u}}function qu(u,i){return!!u&&!!u.parameters&&u.parameters.indexOf(i)>-1}function vh(u){return u["property-type"]==="data-driven"}function cp(u){return qu(u.expression,"measure-light")}function Lv(u){return qu(u.expression,"zoom")}function Cm(u){return!!u.expression&&u.expression.interpolated}function _d(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function Nm(u){return u}function ny(u,i){const l=i.type==="color",h=u.stops&&typeof u.stops[0][0]=="object",g=h||!(h||u.property!==void 0),x=u.type||(Cm(i)?"exponential":"interval");if(l&&((u=ld({},u)).stops&&(u.stops=u.stops.map((R=>[R[0],ns.parse(R[1])]))),u.default=ns.parse(u.default?u.default:i.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!Zg[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let b,j,M;if(x==="exponential")b=Ts;else if(x==="interval")b=wd;else if(x==="categorical"){b=Pm,j=Object.create(null);for(const R of u.stops)j[R[0]]=R[1];M=typeof u.stops[0][0]}else{if(x!=="identity")throw new Error(`Unknown function type "${x}"`);b=qs}if(h){const R={},L=[];for(let ee=0;ee<u.stops.length;ee++){const te=u.stops[ee],le=te[0].zoom;R[le]===void 0&&(R[le]={zoom:le,type:u.type,property:u.property,default:u.default,stops:[]},L.push(le)),R[le].stops.push([te[0].value,te[1]])}const U=[];for(const ee of L)U.push([R[ee].zoom,ny(R[ee],i)]);const q={name:"linear"};return{kind:"composite",interpolationType:q,interpolationFactor:na.interpolationFactor.bind(void 0,q),zoomStops:U.map((ee=>ee[0])),evaluate:({zoom:ee},te)=>Ts({stops:U,base:u.base},i,ee).evaluate(ee,te)}}if(g){const R=x==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:R,interpolationFactor:na.interpolationFactor.bind(void 0,R),zoomStops:u.stops.map((L=>L[0])),evaluate:({zoom:L})=>b(u,i,L,j,M)}}return{kind:"source",evaluate(R,L){const U=L&&L.properties?L.properties[u.property]:void 0;return U===void 0?bd(u.default,i.default):b(u,i,U,j,M)}}}function bd(u,i,l){return u!==void 0?u:i!==void 0?i:l!==void 0?l:void 0}function Pm(u,i,l,h,g){return bd(typeof l===g?h[l]:void 0,u.default,i.default)}function wd(u,i,l){if(kc(l)!=="number")return bd(u.default,i.default);const h=u.stops.length;if(h===1||l<=u.stops[0][0])return u.stops[0][1];if(l>=u.stops[h-1][0])return u.stops[h-1][1];const g=fh(u.stops.map((x=>x[0])),l);return u.stops[g][1]}function Ts(u,i,l){const h=u.base!==void 0?u.base:1;if(kc(l)!=="number")return bd(u.default,i.default);const g=u.stops.length;if(g===1||l<=u.stops[0][0])return u.stops[0][1];if(l>=u.stops[g-1][0])return u.stops[g-1][1];const x=fh(u.stops.map((L=>L[0])),l),b=(function(L,U,q,ee){const te=ee-q,le=L-q;return te===0?0:U===1?le/te:(Math.pow(U,le)-1)/(Math.pow(U,te)-1)})(l,h,u.stops[x][0],u.stops[x+1][0]),j=u.stops[x][1],M=u.stops[x+1][1];let R=Gh[i.type]||Nm;if(u.colorSpace&&u.colorSpace!=="rgb"){const L=Zg[u.colorSpace];R=(U,q)=>L.reverse(L.interpolate(L.forward(U),L.forward(q),b))}return typeof j.evaluate=="function"?{evaluate(...L){const U=j.evaluate.apply(void 0,L),q=M.evaluate.apply(void 0,L);if(U!==void 0&&q!==void 0)return R(U,q,b)}}:R(j,M,b)}function qs(u,i,l){return i.type==="color"?l=ns.parse(l):i.type==="formatted"?l=Bo.fromString(l.toString()):i.type==="resolvedImage"?l=uo.build(l.toString()):kc(l)===i.type||i.type==="enum"&&i.values[l]||(l=void 0),bd(l,u.default,i.default)}Ya.register(tf,{error:[{kind:"error"},[Qi],(u,[i])=>{throw new aa(i.evaluate(u))}],typeof:[Qi,[ve],(u,[i])=>An(Fn(i.evaluate(u)))],"to-rgba":[vt(cr,4),[Yo],(u,[i])=>i.evaluate(u).toNonPremultipliedRenderColor(null).toArray()],"to-hsla":[vt(cr,4),[Yo],(u,[i])=>i.evaluate(u).toNonPremultipliedRenderColor(null).toHslaArray()],rgb:[Yo,[cr,cr,cr],Vu],rgba:[Yo,[cr,cr,cr,cr],Vu],hsl:[Yo,[cr,cr,cr],ey],hsla:[Yo,[cr,cr,cr,cr],ey],has:{type:ri,overloads:[[[Qi],(u,[i])=>ty(i.evaluate(u),u.properties())],[[Qi,iu],(u,[i,l])=>ty(i.evaluate(u),l.evaluate(u))]]},get:{type:ve,overloads:[[[Qi],(u,[i])=>lu(i.evaluate(u),u.properties())],[[Qi,iu],(u,[i,l])=>lu(i.evaluate(u),l.evaluate(u))]]},"feature-state":[ve,[Qi],(u,[i])=>lu(i.evaluate(u),u.featureState||{})],properties:[iu,[],u=>u.properties()],"geometry-type":[Qi,[],u=>u.geometryType()],worldview:[Qi,[],u=>u.globals.worldview||""],id:[ve,[],u=>u.id()],zoom:[cr,[],u=>u.globals.zoom],pitch:[cr,[],u=>u.globals.pitch||0],"distance-from-center":[cr,[],u=>u.distanceFromCenter()],"measure-light":[cr,[Qi],(u,[i])=>u.measureLight(i.evaluate(u))],"heatmap-density":[cr,[],u=>u.globals.heatmapDensity||0],"line-progress":[cr,[],u=>u.globals.lineProgress||0],"raster-value":[cr,[],u=>u.globals.rasterValue||0],"raster-particle-speed":[cr,[],u=>u.globals.rasterParticleSpeed||0],"sky-radial-progress":[cr,[],u=>u.globals.skyRadialProgress||0],accumulated:[ve,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[cr,Fl(cr),(u,i)=>{let l=0;for(const h of i)l+=h.evaluate(u);return l}],"*":[cr,Fl(cr),(u,i)=>{let l=1;for(const h of i)l*=h.evaluate(u);return l}],"-":{type:cr,overloads:[[[cr,cr],(u,[i,l])=>i.evaluate(u)-l.evaluate(u)],[[cr],(u,[i])=>-i.evaluate(u)]]},"/":[cr,[cr,cr],(u,[i,l])=>i.evaluate(u)/l.evaluate(u)],"%":[cr,[cr,cr],(u,[i,l])=>i.evaluate(u)%l.evaluate(u)],ln2:[cr,[],()=>Math.LN2],pi:[cr,[],()=>Math.PI],e:[cr,[],()=>Math.E],"^":[cr,[cr,cr],(u,[i,l])=>Math.pow(i.evaluate(u),l.evaluate(u))],sqrt:[cr,[cr],(u,[i])=>Math.sqrt(i.evaluate(u))],log10:[cr,[cr],(u,[i])=>Math.log(i.evaluate(u))/Math.LN10],ln:[cr,[cr],(u,[i])=>Math.log(i.evaluate(u))],log2:[cr,[cr],(u,[i])=>Math.log(i.evaluate(u))/Math.LN2],sin:[cr,[cr],(u,[i])=>Math.sin(i.evaluate(u))],cos:[cr,[cr],(u,[i])=>Math.cos(i.evaluate(u))],tan:[cr,[cr],(u,[i])=>Math.tan(i.evaluate(u))],asin:[cr,[cr],(u,[i])=>Math.asin(i.evaluate(u))],acos:[cr,[cr],(u,[i])=>Math.acos(i.evaluate(u))],atan:[cr,[cr],(u,[i])=>Math.atan(i.evaluate(u))],min:[cr,Fl(cr),(u,i)=>Math.min(...i.map((l=>l.evaluate(u))))],max:[cr,Fl(cr),(u,i)=>Math.max(...i.map((l=>l.evaluate(u))))],abs:[cr,[cr],(u,[i])=>Math.abs(i.evaluate(u))],round:[cr,[cr],(u,[i])=>{const l=i.evaluate(u);return l<0?-Math.round(-l):Math.round(l)}],floor:[cr,[cr],(u,[i])=>Math.floor(i.evaluate(u))],ceil:[cr,[cr],(u,[i])=>Math.ceil(i.evaluate(u))],"filter-==":[ri,[Qi,ve],(u,[i,l])=>u.properties()[i.value]===l.value],"filter-id-==":[ri,[ve],(u,[i])=>u.id()===i.value],"filter-type-==":[ri,[Qi],(u,[i])=>u.geometryType()===i.value],"filter-<":[ri,[Qi,ve],(u,[i,l])=>{const h=u.properties()[i.value],g=l.value;return typeof h==typeof g&&h<g}],"filter-id-<":[ri,[ve],(u,[i])=>{const l=u.id(),h=i.value;return typeof l==typeof h&&l<h}],"filter->":[ri,[Qi,ve],(u,[i,l])=>{const h=u.properties()[i.value],g=l.value;return typeof h==typeof g&&h>g}],"filter-id->":[ri,[ve],(u,[i])=>{const l=u.id(),h=i.value;return typeof l==typeof h&&l>h}],"filter-<=":[ri,[Qi,ve],(u,[i,l])=>{const h=u.properties()[i.value],g=l.value;return typeof h==typeof g&&h<=g}],"filter-id-<=":[ri,[ve],(u,[i])=>{const l=u.id(),h=i.value;return typeof l==typeof h&&l<=h}],"filter->=":[ri,[Qi,ve],(u,[i,l])=>{const h=u.properties()[i.value],g=l.value;return typeof h==typeof g&&h>=g}],"filter-id->=":[ri,[ve],(u,[i])=>{const l=u.id(),h=i.value;return typeof l==typeof h&&l>=h}],"filter-has":[ri,[ve],(u,[i])=>i.value in u.properties()],"filter-has-id":[ri,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[ri,[vt(Qi)],(u,[i])=>i.value.indexOf(u.geometryType())>=0],"filter-id-in":[ri,[vt(ve)],(u,[i])=>i.value.indexOf(u.id())>=0],"filter-in-small":[ri,[Qi,vt(ve)],(u,[i,l])=>l.value.indexOf(u.properties()[i.value])>=0],"filter-in-large":[ri,[Qi,vt(ve)],(u,[i,l])=>(function(h,g,x,b){for(;x<=b;){const j=x+b>>1;if(g[j]===h)return!0;g[j]>h?b=j-1:x=j+1}return!1})(u.properties()[i.value],l.value,0,l.value.length-1)],all:{type:ri,overloads:[[[ri,ri],(u,[i,l])=>i.evaluate(u)&&l.evaluate(u)],[Fl(ri),(u,i)=>{for(const l of i)if(!l.evaluate(u))return!1;return!0}]]},any:{type:ri,overloads:[[[ri,ri],(u,[i,l])=>i.evaluate(u)||l.evaluate(u)],[Fl(ri),(u,i)=>{for(const l of i)if(l.evaluate(u))return!0;return!1}]]},"!":[ri,[ri],(u,[i])=>!i.evaluate(u)],"is-supported-script":[ri,[Qi],(u,[i])=>{const l=u.globals&&u.globals.isSupportedScript;return!l||l(i.evaluate(u))}],upcase:[Qi,[Qi],(u,[i])=>i.evaluate(u).toUpperCase()],downcase:[Qi,[Qi],(u,[i])=>i.evaluate(u).toLowerCase()],concat:[Qi,Fl(ve),(u,i)=>i.map((l=>Ll(l.evaluate(u)))).join("")],"resolved-locale":[Qi,[oe],(u,[i])=>i.evaluate(u).resolvedLocale()],random:[cr,[cr,cr,ve],(u,i)=>{const[l,h,g]=i.map((b=>b.evaluate(u)));if(l>h||l===h)return l;let x;if(typeof g=="string")x=(function(b){let j=0;if(b.length===0)return j;for(let M=0;M<b.length;M++)j=(j<<5)-j+b.charCodeAt(M),j|=0;return j})(g);else{if(typeof g!="number")throw new aa(`Invalid seed input: ${g}`);x=g}return l+Iv(x)()*(h-l)}]});class ho{constructor(i,l,h,g){this.expression=i,this._warningHistory={},this._evaluator=new nh(h,g),this._defaultValue=l?(function(x){return x.type==="color"&&(_d(x.default)||Array.isArray(x.default))?new ns(0,0,0,0):x.type==="color"?ns.parse(x.default)||null:x.default===void 0?null:x.default})(l):null,this._enumValues=l&&l.type==="enum"?l.values:null,this.configDependencies=Ko(i)}evaluateWithoutErrorHandling(i,l,h,g,x,b,j,M){return this._evaluator.globals=i,this._evaluator.feature=l,this._evaluator.featureState=h,this._evaluator.canonical=g||null,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=b,this._evaluator.featureTileCoord=j||null,this._evaluator.featureDistanceData=M||null,this.expression.evaluate(this._evaluator)}evaluate(i,l,h,g,x,b,j,M){this._evaluator.globals=i,this._evaluator.feature=l||null,this._evaluator.featureState=h||null,this._evaluator.canonical=g||null,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=b||null,this._evaluator.featureTileCoord=j||null,this._evaluator.featureDistanceData=M||null;try{const R=this.expression.evaluate(this._evaluator);if(R==null||typeof R=="number"&&R!=R)return this._defaultValue;if(this._enumValues&&!(R in this._enumValues))throw new aa(`Expected value to be one of ${Object.keys(this._enumValues).map((L=>JSON.stringify(L))).join(", ")}, but found ${JSON.stringify(R)} instead.`);return R}catch(R){return this._warningHistory[R.message]||(this._warningHistory[R.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${R.message}`)),this._defaultValue}}}function up(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in tf}function Uc(u,i,l,h){const g=new bm(tf,[],i?(function(b){const j={color:Yo,string:Qi,number:cr,enum:Qi,boolean:ri,formatted:xe,resolvedImage:lt};return b.type==="array"?vt(j[b.value]||ve,b.length):j[b.type]})(i):void 0,void 0,void 0,l,h),x=g.parse(u,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return x?nf(new ho(x,i,l,h)):$u(g.errors)}class Hu{constructor(i,l,h,g){this.kind=i,this._styleExpression=l,this.isLightConstant=h,this.isLineProgressConstant=g,this.isStateDependent=i!=="constant"&&!rp(l.expression),this.configDependencies=Ko(l.expression)}evaluateWithoutErrorHandling(i,l,h,g,x,b){return this._styleExpression.evaluateWithoutErrorHandling(i,l,h,g,x,b)}evaluate(i,l,h,g,x,b){return this._styleExpression.evaluate(i,l,h,g,x,b)}}class cu{constructor(i,l,h,g,x,b){this.kind=i,this.zoomStops=h,this._styleExpression=l,this.isStateDependent=i!=="camera"&&!rp(l.expression),this.isLightConstant=x,this.isLineProgressConstant=b,this.configDependencies=Ko(l.expression),this.interpolationType=g}evaluateWithoutErrorHandling(i,l,h,g,x,b){return this._styleExpression.evaluateWithoutErrorHandling(i,l,h,g,x,b)}evaluate(i,l,h,g,x,b){return this._styleExpression.evaluate(i,l,h,g,x,b)}interpolationFactor(i,l,h){return this.interpolationType?na.interpolationFactor(this.interpolationType,i,l,h):0}}function rf(u,i,l,h){if((u=Uc(u,i,l,h)).result==="error")return u;const g=u.value.expression,x=dh(g);if(!x&&!vh(i))return $u([new Il("","data expressions not supported")]);const b=Ma(g,["zoom","pitch","distance-from-center"]);if(!b&&!Lv(i))return $u([new Il("","zoom expressions not supported")]);const j=Ma(g,["measure-light"]);if(!j&&!cp(i))return $u([new Il("","measure-light expression not supported")]);const M=Ma(g,["line-progress"]);if(!M&&!(function(U){return qu(U.expression,"line-progress")})(i))return $u([new Il("","line-progress expression not supported")]);const R=i.expression&&i.expression.relaxZoomRestriction,L=Mm(g);return L||b||R?L instanceof Il?$u([L]):L instanceof na&&!Cm(i)?$u([new Il("",'"interpolate" expressions cannot be used with this property')]):nf(L?new cu(x&&M?"camera":"composite",u.value,L.labels,L instanceof na?L.interpolation:void 0,j,M):new Hu(x&&M?"constant":"source",u.value,j,M)):$u([new Il("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Vc{constructor(i,l){this._parameters=i,this._specification=l,ld(this,ny(this._parameters,this._specification))}static deserialize(i){return new Vc(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function Mm(u){let i=null;if(u instanceof vd)i=Mm(u.result);else if(u instanceof ph){for(const l of u.args)if(i=Mm(l),i)break}else(u instanceof gd||u instanceof na)&&u.input instanceof Ya&&u.input.name==="zoom"&&(i=u);return i instanceof Il||u.eachChild((l=>{const h=Mm(l);h instanceof Il?i=h:i&&h&&i!==h&&(i=new Il("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),i}var io,ry,Rm=(function(){if(ry)return io;ry=1,io=i;var u=3;function i(l,h,g){var x=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var b=new Int32Array(this.arrayBuffer);l=b[0],this.d=(h=b[1])+2*(g=b[2]);for(var j=0;j<this.d*this.d;j++){var M=b[u+j],R=b[u+j+1];x.push(M===R?null:b.subarray(M,R))}var L=b[u+x.length+1];this.keys=b.subarray(b[u+x.length],L),this.bboxes=b.subarray(L),this.insert=this._insertReadonly}else{this.d=h+2*g;for(var U=0;U<this.d*this.d;U++)x.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=l,this.padding=g,this.scale=h/l,this.uid=0;var q=g/h*l;this.min=-q,this.max=l+q}return i.prototype.insert=function(l,h,g,x,b){this._forEachCell(h,g,x,b,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(x),this.bboxes.push(b)},i.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},i.prototype._insertCell=function(l,h,g,x,b,j){this.cells[b].push(j)},i.prototype.query=function(l,h,g,x,b){var j=this.min,M=this.max;if(l<=j&&h<=j&&M<=g&&M<=x&&!b)return Array.prototype.slice.call(this.keys);var R=[];return this._forEachCell(l,h,g,x,this._queryCell,R,{},b),R},i.prototype._queryCell=function(l,h,g,x,b,j,M,R){var L=this.cells[b];if(L!==null)for(var U=this.keys,q=this.bboxes,ee=0;ee<L.length;ee++){var te=L[ee];if(M[te]===void 0){var le=4*te;(R?R(q[le+0],q[le+1],q[le+2],q[le+3]):l<=q[le+2]&&h<=q[le+3]&&g>=q[le+0]&&x>=q[le+1])?(M[te]=!0,j.push(U[te])):M[te]=!1}}},i.prototype._forEachCell=function(l,h,g,x,b,j,M,R){for(var L=this._convertToCellCoord(l),U=this._convertToCellCoord(h),q=this._convertToCellCoord(g),ee=this._convertToCellCoord(x),te=L;te<=q;te++)for(var le=U;le<=ee;le++){var ue=this.d*le+te;if((!R||R(this._convertFromCellCoord(te),this._convertFromCellCoord(le),this._convertFromCellCoord(te+1),this._convertFromCellCoord(le+1)))&&b.call(this,l,h,g,x,ue,j,M,R))return}},i.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},i.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},i.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,h=u+this.cells.length+1+1,g=0,x=0;x<this.cells.length;x++)g+=this.cells[x].length;var b=new Int32Array(h+g+this.keys.length+this.bboxes.length);b[0]=this.extent,b[1]=this.n,b[2]=this.padding;for(var j=h,M=0;M<l.length;M++){var R=l[M];b[u+M]=j,b.set(R,j),j+=R.length}return b[u+l.length]=j,b.set(this.keys,j),b[u+l.length+1]=j+=this.keys.length,b.set(this.bboxes,j),j+=this.bboxes.length,b.buffer},io})(),Sd=bs(Rm);const dp={};function Hn(u,i,l={}){Object.defineProperty(u,"_classRegistryKey",{value:i,writable:!1}),dp[i]={klass:u,omit:l.omit||[]}}Hn(Object,"Object"),Sd.serialize=function(u,i){const l=u.toArrayBuffer();return i&&i.add(l),{buffer:l}},Sd.deserialize=function(u){return new Sd(u.buffer)},Object.defineProperty(Sd,"name",{value:"Grid"}),Hn(Sd,"Grid"),delete Rt.prototype.constructor,typeof DOMMatrix<"u"&&Hn(DOMMatrix,"DOMMatrix"),Hn(ns,"Color"),Hn(Error,"Error"),Hn(Bo,"Formatted"),Hn(Ru,"FormattedSection"),Hn(bi,"AJAXError"),Hn(uo,"ResolvedImage"),Hn(Vc,"StylePropertyFunction"),Hn(ho,"StyleExpression",{omit:["_evaluator"]}),Hn(vl,"ImageId"),Hn(vc,"ImageVariant"),Hn(cu,"ZoomDependentExpression"),Hn(Hu,"ZoomConstantExpression"),Hn(Ya,"CompoundExpression",{omit:["_evaluate"]});for(const u in tf)dp[tf[u]._classRegistryKey]||Hn(tf[u],`Expression${u}`);function hp(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function sf(u){return self.ImageBitmap&&u instanceof ImageBitmap}function uu(u,i){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp)return u;if(hp(u)||sf(u))return i&&i.add(u),u;if(ArrayBuffer.isView(u))return i&&i.add(u.buffer),u;if(u instanceof ImageData)return i&&i.add(u.data.buffer),u;if(Array.isArray(u)){const l=[];for(const h of u)l.push(uu(h,i));return l}if(u instanceof Map){const l={$name:"Map",entries:[]};for(const[h,g]of u.entries())l.entries.push(uu(h),uu(g,i));return l}if(u instanceof Set){const l={$name:"Set"};let h=0;for(const g of u.values())l[++h]=uu(g);return l}if(u instanceof DOMMatrix){const l={$name:"DOMMatrix"},h=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const g of h)l[g]=u[g];return l}if(typeof u=="bigint")return{$name:"BigInt",value:u.toString()};if(typeof u=="object"){const l=u.constructor,h=l._classRegistryKey;if(!h)throw new Error(`Can't serialize object of unregistered class "${l.name}".`);const g=l.serialize?l.serialize(u,i):{};if(!l.serialize){for(const x in u)u.hasOwnProperty(x)&&(dp[h].omit.indexOf(x)>=0||(g[x]=uu(u[x],i)));u instanceof Error&&(g.message=u.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(g.$name=h),g}throw new Error("can't serialize object of type "+typeof u)}function Aa(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||hp(u)||sf(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(Aa);if(typeof u=="object"){const i=u.$name||"Object";if(i==="Map"){const g=u.entries||[],x=new Map;for(let b=0;b<g.length;b+=2)x.set(Aa(g[b]),Aa(g[b+1]));return x}if(i==="Set"){const g=new Set;for(const x of Object.keys(u))x!=="$name"&&g.add(Aa(u[x]));return g}if(i==="DOMMatrix"){let g;return g=u.is2D?[u.a,u.b,u.c,u.d,u.e,u.f]:[u.m11,u.m12,u.m13,u.m14,u.m21,u.m22,u.m23,u.m24,u.m31,u.m32,u.m33,u.m34,u.m41,u.m42,u.m43,u.m44],new DOMMatrix(g)}if(i==="BigInt")return BigInt(u.value);const{klass:l}=dp[i];if(!l)throw new Error(`Can't deserialize unregistered class "${i}".`);if(l.deserialize)return l.deserialize(u);const h=Object.create(l.prototype);for(const g of Object.keys(u))g!=="$name"&&(h[g]=Aa(u[g]));return h}throw new Error("can't deserialize object of type "+typeof u)}const sr={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519,Osage:u=>u>=66736&&u<=66815,"CJK Unified Ideographs Extension B":u=>u>=131072&&u<=173791};function Om(u){for(const i of u)if(fp(i.charCodeAt(0)))return!0;return!1}function Dm(u){for(const i of u)if(!iy(i.charCodeAt(0)))return!1;return!0}function iy(u){return!(sr.Arabic(u)||sr["Arabic Supplement"](u)||sr["Arabic Extended-A"](u)||sr["Arabic Presentation Forms-A"](u)||sr["Arabic Presentation Forms-B"](u))}function fp(u){return!(u!==746&&u!==747&&(u<4352||!(sr["Bopomofo Extended"](u)||sr.Bopomofo(u)||sr["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||sr["CJK Compatibility Ideographs"](u)||sr["CJK Compatibility"](u)||sr["CJK Radicals Supplement"](u)||sr["CJK Strokes"](u)||!(!sr["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||sr["CJK Unified Ideographs Extension A"](u)||sr["CJK Unified Ideographs"](u)||sr["Enclosed CJK Letters and Months"](u)||sr["Hangul Compatibility Jamo"](u)||sr["Hangul Jamo Extended-A"](u)||sr["Hangul Jamo Extended-B"](u)||sr["Hangul Jamo"](u)||sr["Hangul Syllables"](u)||sr.Hiragana(u)||sr["Ideographic Description Characters"](u)||sr.Kanbun(u)||sr["Kangxi Radicals"](u)||sr["Katakana Phonetic Extensions"](u)||sr.Katakana(u)&&u!==12540||!(!sr["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!sr["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||sr["Unified Canadian Aboriginal Syllabics"](u)||sr["Unified Canadian Aboriginal Syllabics Extended"](u)||sr["Vertical Forms"](u)||sr["Yijing Hexagram Symbols"](u)||sr["Yi Syllables"](u)||sr["Yi Radicals"](u))))}function $c(u){return!(fp(u)||(function(i){return!!(sr["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||sr["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||sr["Letterlike Symbols"](i)||sr["Number Forms"](i)||sr["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||sr["Control Pictures"](i)&&i!==9251||sr["Optical Character Recognition"](i)||sr["Enclosed Alphanumerics"](i)||sr["Geometric Shapes"](i)||sr["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||sr["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||sr["CJK Symbols and Punctuation"](i)||sr.Katakana(i)||sr["Private Use Area"](i)||sr["CJK Compatibility Forms"](i)||sr["Small Form Variants"](i)||sr["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)})(u))}function km(u){return sr.Arabic(u)||sr["Arabic Supplement"](u)||sr["Arabic Extended-A"](u)||sr["Arabic Presentation Forms-A"](u)||sr["Arabic Presentation Forms-B"](u)}function pp(u){return u>=1424&&u<=2303||sr["Arabic Presentation Forms-A"](u)||sr["Arabic Presentation Forms-B"](u)}function zv(u,i){return!(!i&&pp(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||sr.Khmer(u))}function __(u){for(const i of u)if(pp(i.charCodeAt(0)))return!0;return!1}const Bl={unavailable:"unavailable",deferred:"deferred",loading:"loading",parsing:"parsing",parsed:"parsed",loaded:"loaded",error:"error"};let sy=null,sl=Bl.unavailable,Td=null;const Fv=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(sl=Bl.error),sy&&sy(u)};function Im(){ay.fire(new yc("pluginStateChange",{pluginStatus:sl,pluginURL:Td}))}const ay=new od,Bv=function(){return sl},Uv=function(){if(sl!==Bl.deferred||!Td)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");sl=Bl.loading,Im(),Td&&gc({url:Td},(u=>{u?Fv(u):(sl=Bl.loaded,Im())}))},du={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>sl===Bl.loaded||du.applyArabicShaping!=null,isLoading:()=>sl===Bl.loading,setState(u){sl=u.pluginStatus,Td=u.pluginURL},isParsing:()=>sl===Bl.parsing,isParsed:()=>sl===Bl.parsed,getPluginURL:()=>Td};class hs{constructor(i,l){this.zoom=i,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch,this.brightness=l.brightness,this.worldview=l.worldview):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(i){return(function(l,h){for(const g of l)if(!zv(g.charCodeAt(0),h))return!1;return!0})(i,du.isLoaded())}}class af{constructor(i,l,h,g){this.property=i,this.value=l,this.expression=(function(x,b,j,M){if(_d(x))return new Vc(x,b);if(up(x)||Array.isArray(x)&&x.length>0){const R=rf(x,b,j,M);if(R.result==="error")throw new Error(R.value.map((L=>`${L.key}: ${L.message}`)).join(", "));return R.value}{let R=x;return typeof x=="string"&&b.type==="color"&&(R=ns.parse(x)),{kind:"constant",configDependencies:new Set,evaluate:()=>R}}})(l===void 0?i.specification.default:l,i.specification,h,g)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,l,h){return this.property.possiblyEvaluate(this,i,l,h)}}class Lm{constructor(i,l,h){this.property=i,this.value=new af(i,void 0,l,h)}transitioned(i,l){return new Vv(this.property,this.value,l,St({},i.transition,this.transition),i.now)}untransitioned(){return new Vv(this.property,this.value,null,{},0)}}class mp{constructor(i,l,h){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues),this._scope=l,this._options=h,this.configDependencies=new Set}getValue(i){return Gr(this._values[i].value.value)}setValue(i,l){this._values.hasOwnProperty(i)||(this._values[i]=new Lm(this._values[i].property,this._scope,this._options)),this._values[i].value=new af(this._values[i].property,l===null?void 0:Gr(l),this._scope,this._options),this._values[i].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[i].value.expression.configDependencies]))}setTransitionOrValue(i,l){l&&(this._options=l);const h=this._properties.properties;if(i)for(const g in i){const x=i[g];if(g.endsWith("-transition")){const b=g.slice(0,-11);h[b]&&this.setTransition(b,x)}else h.hasOwnProperty(g)&&this.setValue(g,x)}}getTransition(i){return Gr(this._values[i].transition)}setTransition(i,l){this._values.hasOwnProperty(i)||(this._values[i]=new Lm(this._values[i].property)),this._values[i].transition=Gr(l)||void 0}serialize(){const i={};for(const l of Object.keys(this._values)){const h=this.getValue(l);h!==void 0&&(i[l]=h);const g=this.getTransition(l);g!==void 0&&(i[`${l}-transition`]=g)}return i}transitioned(i,l){const h=new $v(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].transitioned(i,l._values[g]);return h}untransitioned(){const i=new $v(this._properties);for(const l of Object.keys(this._values))i._values[l]=this._values[l].untransitioned();return i}}class Vv{constructor(i,l,h,g,x){const b=g.delay||0,j=g.duration||0;x=x||0,this.property=i,this.value=l,this.begin=x+b,this.end=this.begin+j,i.specification.transition&&(g.delay||g.duration)&&(this.prior=h)}possiblyEvaluate(i,l,h){const g=i.now||0,x=this.value.possiblyEvaluate(i,l,h),b=this.prior;if(b){if(g>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(g<this.begin)return b.possiblyEvaluate(i,l,h);{const j=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(i,l,h),x,fe(j))}}return x}}class $v{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,l,h){const g=new qc(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(i,l,h);return g}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class Ad{constructor(i,l,h){this._properties=i,this._values=Object.create(i.defaultPropertyValues),this._scope=l,this._options=h,this.configDependencies=new Set}getValue(i){return Gr(this._values[i].value)}setValue(i,l){this._values[i]=new af(this._values[i].property,l===null?void 0:Gr(l),this._scope,this._options),this._values[i].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[i].expression.configDependencies]))}serialize(){const i={};for(const l of Object.keys(this._values)){const h=this.getValue(l);h!==void 0&&(i[l]=h)}return i}possiblyEvaluate(i,l,h){const g=new qc(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(i,l,h);return g}}class of{constructor(i,l,h){this.property=i,this.value=l,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,l,h,g){return this.property.evaluate(this.value,this.parameters,i,l,h,g)}}class qc{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class fn{constructor(i){this.specification=i}possiblyEvaluate(i,l){return i.expression.evaluate(l)}interpolate(i,l,h){const g=Gh[this.specification.type];return g?g(i,l,h):i}}class Ln{constructor(i,l){this.specification=i,this.overrides=l}possiblyEvaluate(i,l,h,g){return new of(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(l,null,{},h,g)}:i.expression,l)}interpolate(i,l,h){if(i.value.kind!=="constant"||l.value.kind!=="constant")return i;if(i.value.value===void 0||l.value.value===void 0)return new of(this,{kind:"constant",value:void 0},i.parameters);const g=Gh[this.specification.type];return g?new of(this,{kind:"constant",value:g(i.value.value,l.value.value,h)},i.parameters):i}evaluate(i,l,h,g,x,b){return i.kind==="constant"?i.value:i.evaluate(l,h,g,x,b)}}class lf{constructor(i){this.specification=i}possiblyEvaluate(i,l,h,g){return!!i.expression.evaluate(l,null,{},h,g)}interpolate(){return!1}}class ra{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const l=new hs(0,{});for(const h in i){const g=i[h];g.specification.overridable&&this.overridableProperties.push(h);const x=this.defaultPropertyValues[h]=new af(g,void 0),b=this.defaultTransitionablePropertyValues[h]=new Lm(g);this.defaultTransitioningPropertyValues[h]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=x.possiblyEvaluate(l)}}}Hn(Ln,"DataDrivenProperty"),Hn(fn,"DataConstantProperty"),Hn(lf,"ColorRampProperty");var yt=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"},"appearances":{"type":"array","value":"appearance","supported-layer-types":["symbol"]}},"appearance":{"condition":{"type":"expression"},"name":{"type":"string"},"properties":{"type":"*"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-facade":{"type":"boolean","default":false,"expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-facade-floors":{"type":"number","minimum":1,"maximum":200,"default":3,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-window":{"type":"array","length":2,"value":"number","minimum":0.1,"maximum":1,"default":[0.9,0.9],"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"appearance":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"parameters":[]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","use-theme":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-facade-emissive-chance":{"type":"number","default":0.35,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["measure-light","zoom"]}},"building-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-gradient":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"use-theme":true,"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"use-theme":true,"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white","use-theme":true},"sky-atmosphere-color":{"type":"color","default":"white","use-theme":true},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"use-theme":true,"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function qv(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function gp(u){if(Array.isArray(u))return u.map(gp);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const i={};for(const l in u)i[l]=gp(u[l]);return i}return qv(u)}function yp(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const i of u.slice(1))if(!yp(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}function cf(u,i="",l=null,h="fill"){if(u==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};yp(u)||(u=Bm(u));const g=u;let x=!0;try{x=(function(L){if(!xh(L))return L;let U=gp(L);return zm(U),U=oy(U),U})(g)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(g,null,2)}
        `)}let b=null,j=null;if(h!=="background"&&h!=="sky"&&h!=="slot"){j=yt[`filter_${h}`];const L=Uc(x,j,i,l);if(L.result==="error")throw new Error(L.value.map((U=>`${U.key}: ${U.message}`)).join(", "));b=(U,q,ee)=>L.value.evaluate(U,q,{},ee)}let M=null,R=null;if(x!==g){const L=Uc(g,j,i,l);if(L.result==="error")throw new Error(L.value.map((U=>`${U.key}: ${U.message}`)).join(", "));M=(U,q,ee,te,le)=>L.value.evaluate(U,q,{},ee,void 0,void 0,te,le),R=!dh(L.value.expression)}return{filter:b,dynamicFilter:M||void 0,needGeometry:Fm(x),needFeature:!!R}}function oy(u){if(!Array.isArray(u))return u;const i=(function(l){if(hu.has(l[0])){for(let h=1;h<l.length;h++)if(xh(l[h]))return!0}return l})(u);return i===!0?i:i.map((l=>oy(l)))}function zm(u){let i=!1;const l=[];if(u[0]==="case"){for(let h=1;h<u.length-1;h+=2)i=i||xh(u[h]),l.push(u[h+1]);l.push(u[u.length-1])}else if(u[0]==="match"){i=i||xh(u[1]);for(let h=2;h<u.length-1;h+=2)l.push(u[h+1]);l.push(u[u.length-1])}else if(u[0]==="step"){i=i||xh(u[1]);for(let h=1;h<u.length-1;h+=2)l.push(u[h+1])}i&&(u.length=0,u.push("any",...l));for(let h=1;h<u.length;h++)zm(u[h])}function xh(u){if(!Array.isArray(u))return!1;if((i=u[0])==="pitch"||i==="distance-from-center")return!0;var i;for(let l=1;l<u.length;l++)if(xh(u[l]))return!0;return!1}const hu=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function b_(u,i){return u<i?-1:u>i?1:0}function Fm(u){if(!Array.isArray(u))return!1;if(u[0]==="within"||u[0]==="distance")return!0;for(let i=1;i<u.length;i++)if(Fm(u[i]))return!0;return!1}function Bm(u){if(!u)return!0;const i=u[0];return u.length<=1?i!=="any":i==="=="?ly(u[1],u[2],"=="):i==="!="?Um(ly(u[1],u[2],"==")):i==="<"||i===">"||i==="<="||i===">="?ly(u[1],u[2],i):i==="any"?(l=u.slice(1),["any"].concat(l.map(Bm))):i==="all"?["all"].concat(u.slice(1).map(Bm)):i==="none"?["all"].concat(u.slice(1).map(Bm).map(Um)):i==="in"?w_(u[1],u.slice(2)):i==="!in"?Um(w_(u[1],u.slice(2))):i==="has"?cy(u[1]):i!=="!has"||Um(cy(u[1]));var l}function ly(u,i,l){switch(u){case"$type":return[`filter-type-${l}`,i];case"$id":return[`filter-id-${l}`,i];default:return[`filter-${l}`,u,i]}}function w_(u,i){if(i.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some((l=>typeof l!=typeof i[0]))?["filter-in-large",u,["literal",i.sort(b_)]]:["filter-in-small",u,["literal",i]]}}function cy(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function Um(u){return["!",u]}const vp="";function _h(u,i){return i?`${u}${vp}${i}`:u}const Hv="-transition",S_=new Set(["fill","line","background","hillshade","raster"]);class al extends od{constructor(i,l,h,g,x){if(super(),this.id=i.id,this.fqid=_h(this.id,h),this.type=i.type,this.scope=h,this.lut=g,this.options=x,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,i.type!=="custom"){if(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type&&i.type!=="background"&&i.type!=="sky"&&i.type!=="slot"){this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter;const b=Uc(this.filter,yt[`filter_${i.type}`]);b.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...b.value.configDependencies]))}if(i.slot&&(this.slot=i.slot),l.layout&&(this._unevaluatedLayout=new Ad(l.layout,this.scope,x),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),l.paint){this._transitionablePaint=new mp(l.paint,this.scope,x);for(const b in i.paint)this.setPaintProperty(b,i.paint[b]);for(const b in i.layout)this.setLayoutProperty(b,i.layout[b]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new qc(l.paint)}}}onAdd(i){}onRemove(i){}isDraped(i){return!this.is3D(!0)&&S_.has(this.type)}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,l){if(this.type==="custom"&&i==="visibility")return void(this.visibility=l);const h=this._unevaluatedLayout;h._properties.properties[i]&&(h.setValue(i,l),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),i==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(i){return i.endsWith(Hv)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,l){const h=this._transitionablePaint,g=h._properties.properties;if(i.endsWith(Hv)){const U=i.slice(0,-11);return g[U]&&h.setTransition(U,l||void 0),!1}if(!g[i])return!1;const x=h._values[i],b=x.value.isDataDriven(),j=x.value;h.setValue(i,l),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),this._handleSpecialPaintPropertyUpdate(i);const M=h._values[i].value,R=M.isDataDriven(),L=i.endsWith("pattern")||i==="line-dasharray";return R||b||L||this._handleOverridablePaintPropertyUpdate(i,j,M)}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getDefaultProgramParams(i,l,h){return null}_handleOverridablePaintPropertyUpdate(i,l,h){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)}serialize(){return Qr({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},((i,l)=>!(i===void 0||l==="layout"&&!Object.keys(i).length||l==="paint"&&!Object.keys(i).length)))}is3D(i){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}_clear(){}isStateDependent(){for(const i in this.paint._values){const l=this.paint.get(i);if(l instanceof of&&vh(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}compileFilter(i){this._filterCompiled||(this._featureFilter=cf(this.filter,this.scope,i),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(i){this._stats&&(i.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(i){}queryIntersectsFeature(i,l,h,g,x,b,j,M,R){}}const tw={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class xp{constructor(i,l){this._structArray=i,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class As{constructor(){this.capacity=-1,this.resize(0)}static serialize(i,l){return i._trim(),l&&l.add(i.arrayBuffer),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const l=Object.create(this.prototype);return l.arrayBuffer=i.arrayBuffer,l.length=i.length,l.capacity=i.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...i){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...i){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ai(u,i=1){let l=0,h=0;return{members:u.map((g=>{const x=tw[g.type].BYTES_PER_ELEMENT,b=l=_p(l,Math.max(i,x)),j=g.components||1;return h=Math.max(h,x),l+=x*j,{name:g.name,type:g.type,components:j,offset:b}})),size:_p(l,Math.max(h,i)),alignment:i}}function _p(u,i){return Math.ceil(u/i)*i}class bl extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l){const h=this.length;return this.resize(h+1),this.emplace(h,i,l)}emplace(i,l,h){const g=2*i;return this.int16[g+0]=l,this.int16[g+1]=h,i}}bl.prototype.bytesPerElement=4,Hn(bl,"StructArrayLayout2i4");class uf extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,h)}emplace(i,l,h,g){const x=3*i;return this.int16[x+0]=l,this.int16[x+1]=h,this.int16[x+2]=g,i}}uf.prototype.bytesPerElement=6,Hn(uf,"StructArrayLayout3i6");class jd extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h,g){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,h,g)}emplace(i,l,h,g,x){const b=4*i;return this.int16[b+0]=l,this.int16[b+1]=h,this.int16[b+2]=g,this.int16[b+3]=x,i}}jd.prototype.bytesPerElement=8,Hn(jd,"StructArrayLayout4i8");class bh extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.float32[1*i+0]=l,i}}bh.prototype.bytesPerElement=4,Hn(bh,"StructArrayLayout1f4");class uy extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,h)}emplace(i,l,h,g){const x=4*i,b=2*i;return this.int16[x+0]=l,this.int16[x+1]=h,this.float32[b+1]=g,i}}uy.prototype.bytesPerElement=8,Hn(uy,"StructArrayLayout2i1f8");class Gv extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,h)}emplace(i,l,h,g){const x=4*i;return this.int16[x+0]=l,this.int16[x+1]=h,this.int16[x+2]=g,i}}Gv.prototype.bytesPerElement=8,Hn(Gv,"StructArrayLayout3i8");class Ed extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x){const b=this.length;return this.resize(b+1),this.emplace(b,i,l,h,g,x)}emplace(i,l,h,g,x,b){const j=5*i;return this.int16[j+0]=l,this.int16[j+1]=h,this.int16[j+2]=g,this.int16[j+3]=x,this.int16[j+4]=b,i}}Ed.prototype.bytesPerElement=10,Hn(Ed,"StructArrayLayout5i10");class wh extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x,b,j){const M=this.length;return this.resize(M+1),this.emplace(M,i,l,h,g,x,b,j)}emplace(i,l,h,g,x,b,j,M){const R=6*i,L=12*i,U=3*i;return this.int16[R+0]=l,this.int16[R+1]=h,this.uint8[L+4]=g,this.uint8[L+5]=x,this.uint8[L+6]=b,this.uint8[L+7]=j,this.float32[U+2]=M,i}}wh.prototype.bytesPerElement=12,Hn(wh,"StructArrayLayout2i4ub1f12");class wl extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,h)}emplace(i,l,h,g){const x=3*i;return this.float32[x+0]=l,this.float32[x+1]=h,this.float32[x+2]=g,i}}wl.prototype.bytesPerElement=12,Hn(wl,"StructArrayLayout3f12");class Hc extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x){const b=this.length;return this.resize(b+1),this.emplace(b,i,l,h,g,x)}emplace(i,l,h,g,x,b){const j=6*i,M=3*i;return this.uint16[j+0]=l,this.uint16[j+1]=h,this.uint16[j+2]=g,this.uint16[j+3]=x,this.float32[M+2]=b,i}}Hc.prototype.bytesPerElement=12,Hn(Hc,"StructArrayLayout4ui1f12");class Cd extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,h,g){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,h,g)}emplace(i,l,h,g,x){const b=4*i;return this.uint16[b+0]=l,this.uint16[b+1]=h,this.uint16[b+2]=g,this.uint16[b+3]=x,i}}Cd.prototype.bytesPerElement=8,Hn(Cd,"StructArrayLayout4ui8");class Vm extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x,b){const j=this.length;return this.resize(j+1),this.emplace(j,i,l,h,g,x,b)}emplace(i,l,h,g,x,b,j){const M=6*i;return this.int16[M+0]=l,this.int16[M+1]=h,this.int16[M+2]=g,this.int16[M+3]=x,this.int16[M+4]=b,this.int16[M+5]=j,i}}Vm.prototype.bytesPerElement=12,Hn(Vm,"StructArrayLayout6i12");class $m extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x,b,j,M,R,L,U,q){const ee=this.length;return this.resize(ee+1),this.emplace(ee,i,l,h,g,x,b,j,M,R,L,U,q)}emplace(i,l,h,g,x,b,j,M,R,L,U,q,ee){const te=12*i;return this.int16[te+0]=l,this.int16[te+1]=h,this.int16[te+2]=g,this.int16[te+3]=x,this.uint16[te+4]=b,this.uint16[te+5]=j,this.uint16[te+6]=M,this.uint16[te+7]=R,this.int16[te+8]=L,this.int16[te+9]=U,this.int16[te+10]=q,this.int16[te+11]=ee,i}}$m.prototype.bytesPerElement=24,Hn($m,"StructArrayLayout4i4ui4i24");class fu extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x,b){const j=this.length;return this.resize(j+1),this.emplace(j,i,l,h,g,x,b)}emplace(i,l,h,g,x,b,j){const M=10*i,R=5*i;return this.int16[M+0]=l,this.int16[M+1]=h,this.int16[M+2]=g,this.float32[R+2]=x,this.float32[R+3]=b,this.float32[R+4]=j,i}}fu.prototype.bytesPerElement=20,Hn(fu,"StructArrayLayout3i3f20");class Nd extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,g){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,h,g)}emplace(i,l,h,g,x){const b=4*i;return this.float32[b+0]=l,this.float32[b+1]=h,this.float32[b+2]=g,this.float32[b+3]=x,i}}Nd.prototype.bytesPerElement=16,Hn(Nd,"StructArrayLayout4f16");class nc extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint32[1*i+0]=l,i}}nc.prototype.bytesPerElement=4,Hn(nc,"StructArrayLayout1ul4");class Vo extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l){const h=this.length;return this.resize(h+1),this.emplace(h,i,l)}emplace(i,l,h){const g=2*i;return this.uint16[g+0]=l,this.uint16[g+1]=h,i}}Vo.prototype.bytesPerElement=4,Hn(Vo,"StructArrayLayout2ui4");class Gu extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x,b,j,M,R,L,U,q,ee){const te=this.length;return this.resize(te+1),this.emplace(te,i,l,h,g,x,b,j,M,R,L,U,q,ee)}emplace(i,l,h,g,x,b,j,M,R,L,U,q,ee,te){const le=20*i,ue=10*i;return this.int16[le+0]=l,this.int16[le+1]=h,this.int16[le+2]=g,this.int16[le+3]=x,this.int16[le+4]=b,this.float32[ue+3]=j,this.float32[ue+4]=M,this.float32[ue+5]=R,this.float32[ue+6]=L,this.int16[le+14]=U,this.uint32[ue+8]=q,this.uint16[le+18]=ee,this.uint16[le+19]=te,i}}Gu.prototype.bytesPerElement=40,Hn(Gu,"StructArrayLayout5i4f1i1ul2ui40");class qm extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x,b,j){const M=this.length;return this.resize(M+1),this.emplace(M,i,l,h,g,x,b,j)}emplace(i,l,h,g,x,b,j,M){const R=8*i;return this.int16[R+0]=l,this.int16[R+1]=h,this.int16[R+2]=g,this.int16[R+4]=x,this.int16[R+5]=b,this.int16[R+6]=j,this.int16[R+7]=M,i}}qm.prototype.bytesPerElement=16,Hn(qm,"StructArrayLayout3i2i2i16");class Sc extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x){const b=this.length;return this.resize(b+1),this.emplace(b,i,l,h,g,x)}emplace(i,l,h,g,x,b){const j=4*i,M=8*i;return this.float32[j+0]=l,this.float32[j+1]=h,this.float32[j+2]=g,this.int16[M+6]=x,this.int16[M+7]=b,i}}Sc.prototype.bytesPerElement=16,Hn(Sc,"StructArrayLayout2f1f2i16");class rc extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x,b){const j=this.length;return this.resize(j+1),this.emplace(j,i,l,h,g,x,b)}emplace(i,l,h,g,x,b,j){const M=20*i,R=5*i;return this.uint8[M+0]=l,this.uint8[M+1]=h,this.float32[R+1]=g,this.float32[R+2]=x,this.float32[R+3]=b,this.float32[R+4]=j,i}}rc.prototype.bytesPerElement=20,Hn(rc,"StructArrayLayout2ub4f20");class ki extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,h){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,h)}emplace(i,l,h,g){const x=3*i;return this.uint16[x+0]=l,this.uint16[x+1]=h,this.uint16[x+2]=g,i}}ki.prototype.bytesPerElement=6,Hn(ki,"StructArrayLayout3ui6");class Pd extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x,b,j,M,R,L,U,q,ee,te,le,ue,ge,Se,we,Pe,tt){const Ke=this.length;return this.resize(Ke+1),this.emplace(Ke,i,l,h,g,x,b,j,M,R,L,U,q,ee,te,le,ue,ge,Se,we,Pe,tt)}emplace(i,l,h,g,x,b,j,M,R,L,U,q,ee,te,le,ue,ge,Se,we,Pe,tt,Ke){const Qe=30*i,dt=15*i,ft=60*i;return this.int16[Qe+0]=l,this.int16[Qe+1]=h,this.int16[Qe+2]=g,this.float32[dt+2]=x,this.float32[dt+3]=b,this.uint16[Qe+8]=j,this.uint16[Qe+9]=M,this.uint32[dt+5]=R,this.uint32[dt+6]=L,this.uint32[dt+7]=U,this.uint16[Qe+16]=q,this.uint16[Qe+17]=ee,this.uint16[Qe+18]=te,this.float32[dt+10]=le,this.float32[dt+11]=ue,this.uint8[ft+48]=ge,this.uint8[ft+49]=Se,this.uint8[ft+50]=we,this.uint32[dt+13]=Pe,this.int16[Qe+28]=tt,this.uint8[ft+58]=Ke,i}}Pd.prototype.bytesPerElement=60,Hn(Pd,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Hm extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x,b,j,M,R,L,U,q,ee,te,le,ue,ge,Se,we,Pe,tt,Ke,Qe,dt,ft,Ft,xt,Wt,bn,tn,dn,xn,Lt){const hn=this.length;return this.resize(hn+1),this.emplace(hn,i,l,h,g,x,b,j,M,R,L,U,q,ee,te,le,ue,ge,Se,we,Pe,tt,Ke,Qe,dt,ft,Ft,xt,Wt,bn,tn,dn,xn,Lt)}emplace(i,l,h,g,x,b,j,M,R,L,U,q,ee,te,le,ue,ge,Se,we,Pe,tt,Ke,Qe,dt,ft,Ft,xt,Wt,bn,tn,dn,xn,Lt,hn){const Tt=20*i,zt=40*i,wn=80*i;return this.float32[Tt+0]=l,this.float32[Tt+1]=h,this.int16[zt+4]=g,this.int16[zt+5]=x,this.int16[zt+6]=b,this.int16[zt+7]=j,this.int16[zt+8]=M,this.int16[zt+9]=R,this.int16[zt+10]=L,this.int16[zt+11]=U,this.int16[zt+12]=q,this.uint16[zt+13]=ee,this.uint16[zt+14]=te,this.uint16[zt+15]=le,this.uint16[zt+16]=ue,this.uint16[zt+17]=ge,this.uint16[zt+18]=Se,this.uint16[zt+19]=we,this.uint16[zt+20]=Pe,this.uint16[zt+21]=tt,this.uint16[zt+22]=Ke,this.uint16[zt+23]=Qe,this.uint16[zt+24]=dt,this.uint16[zt+25]=ft,this.uint16[zt+26]=Ft,this.uint16[zt+27]=xt,this.uint32[Tt+14]=Wt,this.float32[Tt+15]=bn,this.float32[Tt+16]=tn,this.float32[Tt+17]=dn,this.float32[Tt+18]=xn,this.uint8[wn+76]=Lt,this.uint16[zt+39]=hn,i}}Hm.prototype.bytesPerElement=80,Hn(Hm,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class Gm extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x,b){const j=this.length;return this.resize(j+1),this.emplace(j,i,l,h,g,x,b)}emplace(i,l,h,g,x,b,j){const M=6*i;return this.float32[M+0]=l,this.float32[M+1]=h,this.float32[M+2]=g,this.float32[M+3]=x,this.float32[M+4]=b,this.float32[M+5]=j,i}}Gm.prototype.bytesPerElement=24,Hn(Gm,"StructArrayLayout6f24");class Sh extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x){const b=this.length;return this.resize(b+1),this.emplace(b,i,l,h,g,x)}emplace(i,l,h,g,x,b){const j=5*i;return this.float32[j+0]=l,this.float32[j+1]=h,this.float32[j+2]=g,this.float32[j+3]=x,this.float32[j+4]=b,i}}Sh.prototype.bytesPerElement=20,Hn(Sh,"StructArrayLayout5f20");class dy extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x,b,j){const M=this.length;return this.resize(M+1),this.emplace(M,i,l,h,g,x,b,j)}emplace(i,l,h,g,x,b,j,M){const R=7*i;return this.float32[R+0]=l,this.float32[R+1]=h,this.float32[R+2]=g,this.float32[R+3]=x,this.float32[R+4]=b,this.float32[R+5]=j,this.float32[R+6]=M,i}}dy.prototype.bytesPerElement=28,Hn(dy,"StructArrayLayout7f28");class pu extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x,b,j,M,R,L,U){const q=this.length;return this.resize(q+1),this.emplace(q,i,l,h,g,x,b,j,M,R,L,U)}emplace(i,l,h,g,x,b,j,M,R,L,U,q){const ee=11*i;return this.float32[ee+0]=l,this.float32[ee+1]=h,this.float32[ee+2]=g,this.float32[ee+3]=x,this.float32[ee+4]=b,this.float32[ee+5]=j,this.float32[ee+6]=M,this.float32[ee+7]=R,this.float32[ee+8]=L,this.float32[ee+9]=U,this.float32[ee+10]=q,i}}pu.prototype.bytesPerElement=44,Hn(pu,"StructArrayLayout11f44");class bp extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x,b,j,M,R){const L=this.length;return this.resize(L+1),this.emplace(L,i,l,h,g,x,b,j,M,R)}emplace(i,l,h,g,x,b,j,M,R,L){const U=9*i;return this.float32[U+0]=l,this.float32[U+1]=h,this.float32[U+2]=g,this.float32[U+3]=x,this.float32[U+4]=b,this.float32[U+5]=j,this.float32[U+6]=M,this.float32[U+7]=R,this.float32[U+8]=L,i}}bp.prototype.bytesPerElement=36,Hn(bp,"StructArrayLayout9f36");class Md extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l){const h=this.length;return this.resize(h+1),this.emplace(h,i,l)}emplace(i,l,h){const g=2*i;return this.float32[g+0]=l,this.float32[g+1]=h,i}}Md.prototype.bytesPerElement=8,Hn(Md,"StructArrayLayout2f8");class hy extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,h,g){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,h,g)}emplace(i,l,h,g,x){const b=6*i;return this.uint32[3*i+0]=l,this.uint16[b+2]=h,this.uint16[b+3]=g,this.uint16[b+4]=x,i}}hy.prototype.bytesPerElement=12,Hn(hy,"StructArrayLayout1ul3ui12");class fy extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint16[1*i+0]=l,i}}fy.prototype.bytesPerElement=2,Hn(fy,"StructArrayLayout1ui2");class df extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x,b,j,M,R,L,U,q,ee,te,le,ue){const ge=this.length;return this.resize(ge+1),this.emplace(ge,i,l,h,g,x,b,j,M,R,L,U,q,ee,te,le,ue)}emplace(i,l,h,g,x,b,j,M,R,L,U,q,ee,te,le,ue,ge){const Se=16*i;return this.float32[Se+0]=l,this.float32[Se+1]=h,this.float32[Se+2]=g,this.float32[Se+3]=x,this.float32[Se+4]=b,this.float32[Se+5]=j,this.float32[Se+6]=M,this.float32[Se+7]=R,this.float32[Se+8]=L,this.float32[Se+9]=U,this.float32[Se+10]=q,this.float32[Se+11]=ee,this.float32[Se+12]=te,this.float32[Se+13]=le,this.float32[Se+14]=ue,this.float32[Se+15]=ge,i}}df.prototype.bytesPerElement=64,Hn(df,"StructArrayLayout16f64");class hf extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,g,x,b,j){const M=this.length;return this.resize(M+1),this.emplace(M,i,l,h,g,x,b,j)}emplace(i,l,h,g,x,b,j,M){const R=10*i,L=5*i;return this.uint16[R+0]=l,this.uint16[R+1]=h,this.uint16[R+2]=g,this.uint16[R+3]=x,this.float32[L+2]=b,this.float32[L+3]=j,this.float32[L+4]=M,i}}hf.prototype.bytesPerElement=20,Hn(hf,"StructArrayLayout4ui3f20");class Wm extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.int16[1*i+0]=l,i}}Wm.prototype.bytesPerElement=2,Hn(Wm,"StructArrayLayout1i2");class Xm extends As{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint8[1*i+0]=l,i}}Xm.prototype.bytesPerElement=1,Hn(Xm,"StructArrayLayout1ub1");class py extends xp{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}py.prototype.size=40;class T_ extends Gu{get(i){return new py(this,i)}}Hn(T_,"CollisionBoxArray");class Zm extends xp{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}Zm.prototype.size=60;class fo extends Pd{get(i){return new Zm(this,i)}}Hn(fo,"PlacedSymbolArray");class $o extends xp{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(i){this._structArray.uint32[this._pos4+14]=i}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(i){this._structArray.float32[this._pos4+18]=i}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}$o.prototype.size=80;class Wv extends Hm{get(i){return new $o(this,i)}}Hn(Wv,"SymbolInstanceArray");class my extends bh{getoffsetX(i){return this.float32[1*i+0]}}Hn(my,"GlyphOffsetArray");class Xv extends bl{getx(i){return this.int16[2*i+0]}gety(i){return this.int16[2*i+1]}}Hn(Xv,"SymbolLineVertexArray");class Ym extends xp{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Ym.prototype.size=12;class Zv extends hy{get(i){return new Ym(this,i)}}Hn(Zv,"FeatureIndexArray");class Km extends Vo{geta_centroid_pos0(i){return this.uint16[2*i+0]}geta_centroid_pos1(i){return this.uint16[2*i+1]}}Hn(Km,"FillExtrusionCentroidArray");class gy extends xp{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}gy.prototype.size=6;class Yv extends uf{get(i){return new gy(this,i)}}Hn(Yv,"FillExtrusionWallArray");const Kv=Ai([{name:"a_pos",components:2,type:"Int16"}],4),A_=Ai([{name:"a_circle_z_offset",components:1,type:"Float32"}],4),Jv=Ai([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Hs{constructor(i=[]){this.segments=i}_prepareSegment(i,l,h,g){let x=this.segments[this.segments.length-1];return i>Hs.MAX_VERTEX_ARRAY_LENGTH&&ai(`Max vertices per segment is ${Hs.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!x||x.vertexLength+i>Hs.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==g)&&(x={vertexOffset:l,primitiveOffset:h,vertexLength:0,primitiveLength:0},g!==void 0&&(x.sortKey=g),this.segments.push(x)),x}prepareSegment(i,l,h,g){return this._prepareSegment(i,l.length,h.length,g)}get(){return this.segments}destroy(){for(const i of this.segments)for(const l in i.vaos)i.vaos[l].destroy()}static simpleSegment(i,l,h,g){return new Hs([{vertexOffset:i,primitiveOffset:l,vertexLength:h,primitiveLength:g,vaos:{},sortKey:0}])}}function yy(u,i){return 256*(u=Oe(Math.floor(u),0,255))+Oe(Math.floor(i),0,255)}Hs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Hn(Hs,"SegmentVector");const j_=Ai([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Jm=Ai([{name:"a_pattern_b",components:4,type:"Uint16"}]),vy=Ai([{name:"a_dash",components:4,type:"Uint16"}]);class ff{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(i,l,h,g){this.ids.push(wp(i)),this.positions.push(l,h,g)}eachPosition(i,l){const h=wp(i);let g=0,x=this.ids.length-1;for(;g<x;){const b=g+x>>1;this.ids[b]>=h?x=b:g=b+1}for(;this.ids[g]===h;)l(this.positions[3*g],this.positions[3*g+1],this.positions[3*g+2]),g++}static serialize(i,l){const h=new Float64Array(i.ids),g=new Uint32Array(i.positions);return Qm(h,g,0,h.length-1),l&&(l.add(h.buffer),l.add(g.buffer)),{ids:h,positions:g}}static deserialize(i){const l=new ff;let h;l.ids=i.ids,l.positions=i.positions;for(const g of l.ids)g!==h&&l.uniqueIds.push(g),h=g;return l.indexed=!0,l}}function wp(u){const i=+u;return!isNaN(i)&&Number.MIN_SAFE_INTEGER<=i&&i<=Number.MAX_SAFE_INTEGER?i:kl(String(u))}function Qm(u,i,l,h){for(;l<h;){const g=u[l+h>>1];let x=l-1,b=h+1;for(;;){do x++;while(u[x]<g);do b--;while(u[b]>g);if(x>=b)break;eg(u,x,b),eg(i,3*x,3*b),eg(i,3*x+1,3*b+1),eg(i,3*x+2,3*b+2)}b-l<h-b?(Qm(u,i,l,b),l=b+1):(Qm(u,i,b+1,h),h=b)}}function eg(u,i,l){const h=u[i];u[i]=u[l],u[l]=h}Hn(ff,"FeaturePositionMap");class Ro{constructor(i){this.gl=i.gl,this.initialized=!1}fetchUniformLocation(i,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(i,l),this.initialized=!0),!!this.location}set(i,l,h){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Sp extends Ro{constructor(i){super(i),this.current=0}set(i,l,h){this.fetchUniformLocation(i,l)&&this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}}class Ra extends Ro{constructor(i){super(i),this.current=0}set(i,l,h){this.fetchUniformLocation(i,l)&&this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class mu extends Ro{constructor(i){super(i),this.current=[0,0]}set(i,l,h){this.fetchUniformLocation(i,l)&&(h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1])))}}class ic extends Ro{constructor(i){super(i),this.current=[0,0,0]}set(i,l,h){this.fetchUniformLocation(i,l)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2])))}}class Tp extends Ro{constructor(i){super(i),this.current=[0,0,0,0]}set(i,l,h){this.fetchUniformLocation(i,l)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3])))}}class Ap extends Ro{constructor(i){super(i),this.current=ns.transparent.toPremultipliedRenderColor(null)}set(i,l,h){this.fetchUniformLocation(i,l)&&(h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a)))}}const jp=new Float32Array(16);class Oa extends Ro{constructor(i){super(i),this.current=jp}set(i,l,h){if(this.fetchUniformLocation(i,l)){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let g=1;g<16;g++)if(h[g]!==this.current[g]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}}}const nw=new Float32Array(9),E_=new Float32Array(4);class xy extends Ro{constructor(i){super(i),this.current=E_}set(i,l,h){if(this.fetchUniformLocation(i,l)){for(let g=0;g<4;g++)if(h[g]!==this.current[g]){this.current=h,this.gl.uniformMatrix2fv(this.location,!1,h);break}}}}function pf(u){return[yy(255*u.r,255*u.g),yy(255*u.b,255*u.a)]}class Gc{constructor(i,l,h,g){this.value=i,this.uniformNames=l.map((x=>`u_${x}`)),this.type=h,this.context=g}setUniform(i,l,h,g,x){const b=g.constantOr(this.value);l.set(i,x,b instanceof ns?b.toPremultipliedRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):b)}getBinding(i,l){return this.type==="color"?new Ap(i):new Ra(i)}}class mf{constructor(i,l){this.uniformNames=l.map((h=>`u_${h}`)),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(i,l){this.pixelRatio=i.pixelRatio||1,this.pattern=i.tl.concat(i.br),this.patternTransition=l?l.tl.concat(l.br):this.pattern}setUniform(i,l,h,g,x){let b=null;x!=="u_pattern"&&x!=="u_dash"||(b=this.pattern),x==="u_pattern_b"&&(b=this.patternTransition),x==="u_pixel_ratio"&&(b=this.pixelRatio),b&&l.set(i,x,b)}getBinding(i,l){return l==="u_pattern"||l==="u_pattern_b"||l==="u_dash"?new Tp(i):new Ra(i)}}class Wu{constructor(i,l,h,g){this.expression=i,this.type=h,this.maxValue=0,this.paintVertexAttributes=l.map((x=>({name:`a_${x}`,type:"Float32",components:h==="color"?2:1,offset:0}))),this.paintVertexArray=new g}populatePaintArray(i,l,h,g,x,b,j,M){const R=this.paintVertexArray.length,L=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new hs(0,{brightness:b,worldview:M}),l,{},x,g,j):this.expression.kind==="constant"&&this.expression.value,U=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new hs(0,{brightness:b,worldview:M}),l,{},x,g,j):this.lutExpression.value)==="none";this.paintVertexArray.resize(i),this._setPaintValue(R,i,L,U?null:this.context.lut)}updatePaintArray(i,l,h,g,x,b,j,M){const R=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:j,worldview:M},h,g,void 0,x):this.expression.kind==="constant"&&this.expression.value,L=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new hs(0,{brightness:j,worldview:M}),h,g,void 0,x):this.lutExpression.value)==="none";this._setPaintValue(i,l,R,L?null:this.context.lut)}_setPaintValue(i,l,h,g){if(this.type==="color"){const x=pf(h.toPremultipliedRenderColor(g));for(let b=i;b<l;b++)this.paintVertexArray.emplace(b,x[0],x[1])}else{for(let x=i;x<l;x++)this.paintVertexArray.emplace(x,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Sl{constructor(i,l,h,g,x,b){this.expression=i,this.uniformNames=l.map((j=>`u_${j}_t`)),this.type=h,this.useIntegerZoom=g,this.context=x,this.maxValue=0,this.paintVertexAttributes=l.map((j=>({name:`a_${j}`,type:"Float32",components:h==="color"?4:2,offset:0}))),this.paintVertexArray=new b}populatePaintArray(i,l,h,g,x,b,j,M){const R=this.expression.evaluate(new hs(this.context.zoom,{brightness:b,worldview:M}),l,{},x,g,j),L=this.expression.evaluate(new hs(this.context.zoom+1,{brightness:b,worldview:M}),l,{},x,g,j),U=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new hs(0,{brightness:b,worldview:M}),l,{},x,g,j):this.lutExpression.value)==="none",q=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(q,i,R,L,U?null:this.context.lut)}updatePaintArray(i,l,h,g,x,b,j,M){const R=this.expression.evaluate({zoom:this.context.zoom,brightness:j,worldview:M},h,g,void 0,x),L=this.expression.evaluate({zoom:this.context.zoom+1,brightness:j,worldview:M},h,g,void 0,x),U=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new hs(0,{brightness:j,worldview:M}),h,g,void 0,x):this.lutExpression.value)==="none";this._setPaintValue(i,l,R,L,U?null:this.context.lut)}_setPaintValue(i,l,h,g,x){if(this.type==="color"){const b=pf(h.toPremultipliedRenderColor(x)),j=pf(h.toPremultipliedRenderColor(x));for(let M=i;M<l;M++)this.paintVertexArray.emplace(M,b[0],b[1],j[0],j[1])}else{for(let b=i;b<l;b++)this.paintVertexArray.emplace(b,h,g);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(g))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,l,h,g,x){const b=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,j=Oe(this.expression.interpolationFactor(b,this.context.zoom,this.context.zoom+1),0,1);l.set(i,x,j)}getBinding(i,l){return new Ra(i)}}class po{constructor(i,l,h,g,x){this.expression=i,this.layerId=x,this.paintVertexAttributes=(h==="array"?vy:j_).members;for(let b=0;b<l.length;++b);this.paintVertexArray=new g,this.paintTransitionVertexArray=new Cd}populatePaintArray(i,l,h,g){const x=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValues(x,i,l.patterns&&l.patterns[this.layerId],h)}updatePaintArray(i,l,h,g,x,b,j){this._setPaintValues(i,l,h.patterns&&h.patterns[this.layerId],b)}_setPaintValues(i,l,h,g){if(!g||!h)return;const x=g[h[0]],b=g[h[1]];if(x){if(x){const{tl:j,br:M,pixelRatio:R}=x;for(let L=i;L<l;L++)this.paintVertexArray.emplace(L,j[0],j[1],M[0],M[1],R)}if(b){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:j,br:M}=b;for(let R=i;R<l;R++)this.paintTransitionVertexArray.emplace(R,j[0],j[1],M[0],M[1])}}}upload(i){const l=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,l)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=i.createVertexBuffer(this.paintTransitionVertexArray,Jm.members,l))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class ol{constructor(i,l,h=(()=>!0)){this.binders={},this._buffers=[],this.context=l;const g=[];for(const x in i.paint._values){const b=i.paint.get(x);if(x.endsWith("-use-theme")||!h(x)||!(b instanceof of&&vh(b.property.specification)))continue;const j=Qv(x,i.type),M=b.value,R=b.property.specification.type,L=!!b.property.useIntegerZoom,U=x==="line-dasharray"||x.endsWith("pattern"),q=i.paint.get(`${x}-use-theme`),ee=x==="line-dasharray"&&i.layout.get("line-cap").value.kind!=="constant"||q&&q.value.kind!=="constant";if(M.kind!=="constant"||ee)if(M.kind==="source"||ee||U){const te=tx(x,R,"source");this.binders[x]=U?new po(M,j,R,te,i.id):new Wu(M,j,R,te),g.push(`/a_${x}`)}else{const te=tx(x,R,"composite");this.binders[x]=new Sl(M,j,R,L,l,te),g.push(`/z_${x}`)}else this.binders[x]=U?new mf(M.value,j):new Gc(M.value,j,R,l),g.push(`/u_${x}`);q&&(this.binders[x].lutExpression=q.value)}this.cacheKey=g.sort().join("")}getMaxValue(i){const l=this.binders[i];return l instanceof Wu||l instanceof Sl?l.maxValue:0}populatePaintArrays(i,l,h,g,x,b,j,M){for(const R in this.binders){const L=this.binders[R];L.context=this.context,(L instanceof Wu||L instanceof Sl||L instanceof po)&&L.populatePaintArray(i,l,h,g,x,b,j,M)}}setConstantPatternPositions(i,l){for(const h in this.binders){const g=this.binders[h];g instanceof mf&&g.setConstantPatternPositions(i,l)}}getPatternTransitionVertexBuffer(i){const l=this.binders[i];return l instanceof po?l.paintTransitionVertexBuffer:null}updatePaintArrays(i,l,h,g,x,b,j,M,R,L){let U=!1;const q=Object.keys(i),ee=q.length!==0&&!M,te=ee?q:l.uniqueIds;this.context.lut=x.lut;for(const le in this.binders){const ue=this.binders[le];if(ue.context=this.context,(ue instanceof Wu||ue instanceof Sl||ue instanceof po)&&ue.expression&&ue.expression.kind&&ue.expression.kind!=="constant"&&(ue.expression.isStateDependent===!0||ue.expression.isLightConstant===!1)){const ge=x.paint.get(le);ue.expression=ge.value;for(const Se of te){const we=i[Se.toString()];l.eachPosition(Se,((Pe,tt,Ke)=>{const Qe=g.feature(Pe);ue.updatePaintArray(tt,Ke,Qe,we,b,j,R,L)}))}if(!ee)for(const Se of h.uniqueIds){const we=i[Se.toString()];h.eachPosition(Se,((Pe,tt,Ke)=>{const Qe=g.feature(Pe);ue.updatePaintArray(tt,Ke,Qe,we,b,j,R,L)}))}U=!0}}return U}defines(){const i=[];for(const l in this.binders){const h=this.binders[l];(h instanceof Gc||h instanceof mf)&&i.push(...h.uniformNames.map((g=>`#define HAS_UNIFORM_${g}`)))}return i}getBinderAttributes(){const i=[];for(const l in this.binders){const h=this.binders[l];if(h instanceof Wu||h instanceof Sl||h instanceof po)for(let g=0;g<h.paintVertexAttributes.length;g++)i.push(h.paintVertexAttributes[g].name);if(h instanceof po)for(let g=0;g<Jm.members.length;g++)i.push(Jm.members[g].name)}return i}getBinderUniforms(){const i=[];for(const l in this.binders){const h=this.binders[l];if(h instanceof Gc||h instanceof mf||h instanceof Sl)for(const g of h.uniformNames)i.push(g)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i){const l=[];for(const h in this.binders){const g=this.binders[h];if(g instanceof Gc||g instanceof mf||g instanceof Sl)for(const x of g.uniformNames)l.push({name:x,property:h,binding:g.getBinding(i,x)})}return l}setUniforms(i,l,h,g,x){for(const{name:b,property:j,binding:M}of h)this.binders[j].setUniform(i,M,x,g.get(j),b)}updatePaintBuffers(){this._buffers=[];for(const i in this.binders){const l=this.binders[i];(l instanceof Wu||l instanceof Sl||l instanceof po)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer),l instanceof po&&l.paintTransitionVertexBuffer&&this._buffers.push(l.paintTransitionVertexBuffer)}}upload(i){for(const l in this.binders){const h=this.binders[l];(h instanceof Wu||h instanceof Sl||h instanceof po)&&h.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const l=this.binders[i];(l instanceof Wu||l instanceof Sl||l instanceof po)&&l.destroy()}}}class Ul{constructor(i,l,h=(()=>!0)){this.programConfigurations={};for(const g of i)this.programConfigurations[g.id]=new ol(g,l,h);this.needsUpload=!1,this._featureMap=new ff,this._featureMapWithoutIds=new ff,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(i,l,h,g,x,b,j,M,R){for(const L in this.programConfigurations)this.programConfigurations[L].populatePaintArrays(i,l,g,x,b,j,M,R);l.id!==void 0?this._featureMap.add(l.id,h,this._bufferOffset,i):(this._featureMapWithoutIds.add(this._idlessCounter,h,this._bufferOffset,i),this._idlessCounter+=1),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,l,h,g,x,b,j,M){for(const R of h)this.needsUpload=this.programConfigurations[R.id].updatePaintArrays(i,this._featureMap,this._featureMapWithoutIds,l,R,g,x,b,j||0,M)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const C_={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"],"fill-bridge-guard-rail-color":["structure_color"],"fill-tunnel-structure-color":["structure_color"]};function Qv(u,i){return C_[u]||[u.replace(`${i}-`,"").replace(/-/g,"_")]}const ex={"line-pattern":{source:Hc,composite:Hc},"fill-pattern":{source:Hc,composite:Hc},"fill-extrusion-pattern":{source:Hc,composite:Hc},"line-dasharray":{source:Cd,composite:Cd}},_y={color:{source:Md,composite:Nd},number:{source:bh,composite:Md}};function tx(u,i,l){const h=ex[u];return h&&h[l]||_y[i][l]}Hn(Gc,"ConstantBinder"),Hn(mf,"PatternConstantBinder"),Hn(Wu,"SourceExpressionBinder"),Hn(po,"PatternCompositeBinder"),Hn(Sl,"CompositeExpressionBinder"),Hn(ol,"ProgramConfiguration",{omit:["_buffers"]}),Hn(Ul,"ProgramConfigurationSet");const qa=mn/Math.PI/2,mo=5,y=6,a=16383,d=64,v=[d,32,16],S=-qa,A=qa;function P(u,i,l,h=qa){return l=Dr(l),[u*Math.sin(l)*h,-i*h,u*Math.cos(l)*h]}function O(u,i,l){return P(Math.cos(Dr(u)),Math.sin(Dr(u)),i,l)}const I=63710088e-1,H=2*Math.PI*I;class G{constructor(i,l){if(isNaN(i)||isNaN(l))throw new Error(`Invalid LngLat object: (${i}, ${l})`);if(this.lng=+i,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new G(Et(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const l=Math.PI/180,h=this.lat*l,g=i.lat*l,x=Math.sin(h)*Math.sin(g)+Math.cos(h)*Math.cos(g)*Math.cos((i.lng-this.lng)*l);return I*Math.acos(Math.min(x,1))}toBounds(i=0){const l=360*i/40075017,h=l/Math.cos(Math.PI/180*this.lat);return new ne({lng:this.lng-h,lat:this.lat-l},{lng:this.lng+h,lat:this.lat+l})}toEcef(i){return O(this.lat,this.lng,qa+i*qa/I)}static convert(i){if(i instanceof G)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new G(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new G(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ne{constructor(i,l){if(i)if(l)this.setSouthWest(i).setNorthEast(l);else if(i.length===4){const h=i;this.setSouthWest([h[0],h[1]]).setNorthEast([h[2],h[3]])}else{const h=i;this.setSouthWest(h[0]).setNorthEast(h[1])}}setNorthEast(i){return this._ne=i instanceof G?new G(i.lng,i.lat):G.convert(i),this}setSouthWest(i){return this._sw=i instanceof G?new G(i.lng,i.lat):G.convert(i),this}extend(i){const l=this._sw,h=this._ne;let g,x;if(i instanceof G)g=i,x=i;else{if(!(i instanceof ne))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(ne.convert(i)):this.extend(G.convert(i)):typeof i=="object"&&i!==null&&i.hasOwnProperty("lat")&&(i.hasOwnProperty("lon")||i.hasOwnProperty("lng"))?this.extend(G.convert(i)):this;if(g=i._sw,x=i._ne,!g||!x)return this}return l||h?(l.lng=Math.min(g.lng,l.lng),l.lat=Math.min(g.lat,l.lat),h.lng=Math.max(x.lng,h.lng),h.lat=Math.max(x.lat,h.lat)):(this._sw=new G(g.lng,g.lat),this._ne=new G(x.lng,x.lat)),this}getCenter(){return new G((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new G(this.getWest(),this.getNorth())}getSouthEast(){return new G(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:l,lat:h}=G.convert(i);let g=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&g}static convert(i){if(i)return i instanceof ne?i:new ne(i)}}const J=0,re=25.5;function de(u){return H*Math.cos(u*Math.PI/180)}function ce(u){return(180+u)/360}function pe(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function me(u,i){return u/de(i)}function be(u){return 360*u-180}function Ne(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function De(u,i){return u*de(Ne(i))}const Be=85.051129;function Ze(u){return Math.cos(Dr(Oe(u,-Be,Be)))}function Ye(u,i){const l=Oe(i,J,re),h=Math.pow(2,l);return Ze(u)*H/(512*h)}function Ue(u){return 1/Math.cos(u*Math.PI/180)}function qe(u,i=0){const l=Math.exp(Math.PI*(1-(u.y+i/mn)/(1<<u.z)*2));return 80150034*l/(l*l+1)/mn/(1<<u.z)}class Ge{constructor(i,l,h=0){this.x=+i,this.y=+l,this.z=+h}static fromLngLat(i,l=0){const h=G.convert(i);return new Ge(ce(h.lng),pe(h.lat),me(l,h.lat))}toLngLat(){return new G(be(this.x),Ne(this.y))}toAltitude(){return De(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/H*Ue(Ne(this.y))}}function _t(u,i,l,h,g,x,b,j,M){const R=(i+h)/2,L=(l+g)/2,U=new Rt(R,L);j(U),(function(q,ee,te,le,ue,ge){const Se=te-ue,we=le-ge;return Math.abs((le-ee)*Se-(te-q)*we)/Math.hypot(Se,we)})(U.x,U.y,x.x,x.y,b.x,b.y)>=M?(_t(u,i,l,R,L,x,U,j,M),_t(u,R,L,h,g,U,b,j,M)):u.push(b)}function ct(u,i,l){let h=u[0],g=h.x,x=h.y;i(h);const b=[h];for(let j=1;j<u.length;j++){const M=u[j],{x:R,y:L}=M;i(M),_t(b,g,x,R,L,h,M,i,l),g=R,x=L,h=M}return b}function Bt(u,i,l,h){if(h(i,l)){const g=i.add(l)._mult(.5);Bt(u,i,g,h),Bt(u,g,l,h)}else u.push(l)}function Ct(u,i){let l=u[0];const h=[l];for(let g=1;g<u.length;g++){const x=u[g];Bt(h,l,x,i),l=x}return h}const Xt=Math.pow(2,14)-1,gn=-Xt-1;function wt(u,i){const l=Math.round(u.x*i),h=Math.round(u.y*i);return u.x=Oe(l,gn,Xt),u.y=Oe(h,gn,Xt),(l<u.x||l>u.x+1||h<u.y||h>u.y+1)&&ai("Geometry exceeds allowed extent, reduce your vector tile buffer size"),u}function at(u,i,l){const h=u.loadGeometry(),g=u.extent,x=mn/g;if(i&&l&&l.projection.isReprojectedInTileSpace){const b=1<<i.z,{scale:j,x:M,y:R,projection:L}=l,U=q=>{const ee=be((i.x+q.x/g)/b),te=Ne((i.y+q.y/g)/b),le=L.project(ee,te);q.x=(le.x*j-M)*g,q.y=(le.y*j-R)*g};for(let q=0;q<h.length;q++)if(u.type!==1)h[q]=ct(h[q],U,1);else{const ee=[];for(const te of h[q])te.x<0||te.x>=g||te.y<0||te.y>=g||(U(te),ee.push(te));h[q]=ee}}for(const b of h)for(const j of b)wt(j,x);return h}function Dt(u,i){return{type:u.type,id:u.id,properties:u.properties,geometry:i?at(u):[]}}class At{constructor(i,l,h,g,x){this.properties={},this.extent=h,this.type=0,this.id=void 0,this._pbf=i,this._geometry=-1,this._keys=g,this._values=x,i.readFields(Gt,this,l)}loadGeometry(){const i=this._pbf;i.pos=this._geometry;const l=i.readVarint()+i.pos,h=[];let g,x=1,b=0,j=0,M=0;for(;i.pos<l;){if(b<=0){const R=i.readVarint();x=7&R,b=R>>3}if(b--,x===1||x===2)j+=i.readSVarint(),M+=i.readSVarint(),x===1&&(g&&h.push(g),g=[]),g&&g.push(new Rt(j,M));else{if(x!==7)throw new Error(`unknown command ${x}`);g&&g.push(g[0].clone())}}return g&&h.push(g),h}bbox(){const i=this._pbf;i.pos=this._geometry;const l=i.readVarint()+i.pos;let h=1,g=0,x=0,b=0,j=1/0,M=-1/0,R=1/0,L=-1/0;for(;i.pos<l;){if(g<=0){const U=i.readVarint();h=7&U,g=U>>3}if(g--,h===1||h===2)x+=i.readSVarint(),b+=i.readSVarint(),x<j&&(j=x),x>M&&(M=x),b<R&&(R=b),b>L&&(L=b);else if(h!==7)throw new Error(`unknown command ${h}`)}return[j,R,M,L]}toGeoJSON(i,l,h){const g=this.extent*Math.pow(2,h),x=this.extent*i,b=this.extent*l,j=this.loadGeometry();function M(q){return[360*(q.x+x)/g-180,360/Math.PI*Math.atan(Math.exp((1-2*(q.y+b)/g)*Math.PI))-90]}function R(q){return q.map(M)}let L;if(this.type===1){const q=[];for(const te of j)q.push(te[0]);const ee=R(q);L=q.length===1?{type:"Point",coordinates:ee[0]}:{type:"MultiPoint",coordinates:ee}}else if(this.type===2){const q=j.map(R);L=q.length===1?{type:"LineString",coordinates:q[0]}:{type:"MultiLineString",coordinates:q}}else{if(this.type!==3)throw new Error("unknown feature type");{const q=(function(te){const le=te.length;if(le<=1)return[te];const ue=[];let ge,Se;for(let we=0;we<le;we++){const Pe=Yt(te[we]);Pe!==0&&(Se===void 0&&(Se=Pe<0),Se===Pe<0?(ge&&ue.push(ge),ge=[te[we]]):ge&&ge.push(te[we]))}return ge&&ue.push(ge),ue})(j),ee=[];for(const te of q)ee.push(te.map(R));L=ee.length===1?{type:"Polygon",coordinates:ee[0]}:{type:"MultiPolygon",coordinates:ee}}}const U={type:"Feature",geometry:L,properties:this.properties};return this.id!=null&&(U.id=this.id),U}}function Gt(u,i,l){u===1?i.id=l.readVarint():u===2?(function(h,g){const x=h.readVarint()+h.pos;for(;h.pos<x;){const b=g._keys[h.readVarint()],j=g._values[h.readVarint()];g.properties[b]=j}})(l,i):u===3?i.type=l.readVarint():u===4&&(i._geometry=l.pos)}function Yt(u){let i=0;for(let l,h,g=0,x=u.length,b=x-1;g<x;b=g++)l=u[g],h=u[b],i+=(h.x-l.x)*(l.y+h.y);return i}At.types=["Unknown","Point","LineString","Polygon"];class Ht{constructor(i,l){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(en,this,l),this.length=this._features.length}feature(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];const l=this._pbf.readVarint()+this._pbf.pos;return new At(this._pbf,l,this.extent,this._keys,this._values)}}function en(u,i,l){u===15?i.version=l.readVarint():u===1?i.name=l.readString():u===5?i.extent=l.readVarint():u===2?i._features.push(l.pos):u===3?i._keys.push(l.readString()):u===4&&i._values.push((function(h){let g=null;const x=h.readVarint()+h.pos;for(;h.pos<x;){const b=h.readVarint()>>3;g=b===1?h.readString():b===2?h.readFloat():b===3?h.readDouble():b===4?h.readVarint64():b===5?h.readVarint():b===6?h.readSVarint():b===7?h.readBoolean():null}if(g==null)throw new Error("unknown feature value");return g})(l))}class Pn{constructor(i,l){this.layers=i.readFields(Kn,{},l)}}function Kn(u,i,l){if(u===3){const h=new Ht(l,l.readVarint()+l.pos);h.length&&(i[h.name]=h)}}const In="3d_elevation_id",rr="level";class ar{constructor(){this._valid=!1}reset(i){return this.feature=i,this._valid=!0,this._geometry=i.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(i,l){return this._valid&&i(l(this._geometry)),this}require(i,l,h){return this.get(i,!0,l,h)}optional(i,l,h){return this.get(i,!1,l,h)}success(){return this._valid}get(i,l,h,g){const x=this.feature.properties.hasOwnProperty(i)?+this.feature.properties[i]:void 0;return this._valid&&x!==void 0&&!Number.isNaN(x)?h(g?g(x):x):l&&(this._valid=!1),this}}class Er{constructor(i,l){this.featureFunc=i,this.vertexFunc=l}parseFeature(i,l,h){return this.featureFunc(i,l,h)}parseVertex(i,l,h){return this.vertexFunc(i,l,h)}}const Tr=new Er(((u,i,l)=>u.reset(i).require(In,(h=>{l.id=h})).optional("fixed_height_relative",(h=>{l.constantHeight=h}),ji.decodeRelativeHeight).geometry((h=>{l.bounds=h}),Tv).success()),((u,i,l)=>u.reset(i).require(In,(h=>{l.id=h})).require("elevation_idx",(h=>{l.idx=h})).require("extent",(h=>{l.extent=h})).require("height_relative",(h=>{l.height=h}),ji.decodeRelativeHeight).geometry((h=>{l.position=h}),ji.getPoint).success())),Zr=new Er(((u,i,l)=>u.reset(i).require(In,(h=>{l.id=h})).optional("fixed_height",(h=>{l.constantHeight=h}),ji.decodeMetricHeight).geometry((h=>{l.bounds=h}),Tv).success()),((u,i,l)=>u.reset(i).require(In,(h=>{l.id=h})).require("elevation_idx",(h=>{l.idx=h})).require("extent",(h=>{l.extent=h})).require("height",(h=>{l.height=h}),ji.decodeMetricHeight).geometry((h=>{l.position=h}),ji.getPoint).success()));class ji{static getPoint(i){return Xn(i[0][0].x,i[0][0].y)}static decodeRelativeHeight(i){return 1e-4*i*5}static decodeMetricHeight(i){return 1e-4*i}static parse(i){const l=[],h=[],g=i.length,x=new ar;for(let j=0;j<g;j++){const M=i.feature(j),R=M.properties.version,L=(b=R)?b==="1.0.1"?Zr:void 0:Tr;if(L===void 0){ai(`Unknown elevation feature version number ${R||"(unknown)"}`);continue}const U=M.properties.hasOwnProperty("type")?M.properties.type:void 0;if(U){if(At.types[M.type]==="Point"&&U==="curve_point"){const q={};L.parseVertex(x,M,q)&&l.push(q)}else if(At.types[M.type]==="Polygon"&&U==="curve_meta"){const q={};L.parseFeature(x,M,q)&&h.push(q)}}}var b;return{vertices:l,features:h}}}class Lr{constructor(i,l){this.pos=i,this.dir=l}intersectsPlane(i,l,h){const g=dr(l,this.dir);if(Math.abs(g)<1e-6)return!1;const x=((i[0]-this.pos[0])*l[0]+(i[1]-this.pos[1])*l[1])/g;return h[0]=this.pos[0]+this.dir[0]*x,h[1]=this.pos[1]+this.dir[1]*x,!0}}class mi{constructor(i,l){this.pos=i,this.dir=l}intersectsPlane(i,l,h){const g=Mt(l,this.dir);if(Math.abs(g)<1e-6)return!1;const x=((i[0]-this.pos[0])*l[0]+(i[1]-this.pos[1])*l[1]+(i[2]-this.pos[2])*l[2])/g;return h[0]=this.pos[0]+this.dir[0]*x,h[1]=this.pos[1]+this.dir[1]*x,h[2]=this.pos[2]+this.dir[2]*x,!0}closestPointOnSphere(i,l,h){if((function(ee,te){var le=ee[0],ue=ee[1],ge=ee[2],Se=te[0],we=te[1],Pe=te[2];return Math.abs(le-Se)<=w*Math.max(1,Math.abs(le),Math.abs(Se))&&Math.abs(ue-we)<=w*Math.max(1,Math.abs(ue),Math.abs(we))&&Math.abs(ge-Pe)<=w*Math.max(1,Math.abs(ge),Math.abs(Pe))})(this.pos,i)||l===0)return h[0]=h[1]=h[2]=0,!1;const[g,x,b]=this.dir,j=this.pos[0]-i[0],M=this.pos[1]-i[1],R=this.pos[2]-i[2],L=g*g+x*x+b*b,U=2*(j*g+M*x+R*b),q=U*U-4*L*(j*j+M*M+R*R-l*l);if(q<0){const ee=Math.max(-U/2,0),te=j+g*ee,le=M+x*ee,ue=R+b*ee,ge=Math.hypot(te,le,ue);return h[0]=te*l/ge,h[1]=le*l/ge,h[2]=ue*l/ge,!1}{const ee=(-U-Math.sqrt(q))/(2*L);if(ee<0){const te=Math.hypot(j,M,R);return h[0]=j*l/te,h[1]=M*l/te,h[2]=R*l/te,!1}return h[0]=j+g*ee,h[1]=M+x*ee,h[2]=R+b*ee,!0}}}class Ii{constructor(i,l,h,g,x){this.TL=i,this.TR=l,this.BR=h,this.BL=g,this.horizon=x}static fromInvProjectionMatrix(i,l,h){const g=[-1,1,1],x=[1,1,1],b=[1,-1,1],j=[-1,-1,1],M=Cn(g,g,i),R=Cn(x,x,i),L=Cn(b,b,i),U=Cn(j,j,i);return new Ii(M,R,L,U,l/h)}}function os(u,i,l){let h=1/0,g=-1/0;const x=[];for(const b of u){Rr(x,b,i);const j=Mt(x,l);h=Math.min(h,j),g=Math.max(g,j)}return[h,g]}function Fr(u,i){let l=!0;for(let h=0;h<u.planes.length;h++){const g=u.planes[h];let x=0;for(let b=0;b<i.length;b++)x+=Mt(g,i[b])+g[3]>=0;if(x===0)return 0;x!==i.length&&(l=!1)}return l?2:1}function Bi(u,i){for(const l of u.projections){const h=os(i,u.points[0],l.axis);if(l.projection[1]<h[0]||l.projection[0]>h[1])return 0}return 1}function $i(u,i){let l=0;const h=[0,0,0,0];for(let b=0;b<u.length;b++)h[0]=u[b][0],h[1]=u[b][1],h[2]=u[b][2],h[3]=1,(g=h)[0]*(x=i)[0]+g[1]*x[1]+g[2]*x[2]+g[3]*x[3]>=0&&l++;var g,x;return l}class Wi{constructor(i,l){this.points=i||new Array(8).fill([0,0,0]),this.planes=l||new Array(6).fill([0,0,0,0]),this.bounds=ii.fromPoints(this.points),this.projections=[],this.frustumEdges=[Rr([],this.points[2],this.points[3]),Rr([],this.points[0],this.points[3]),Rr([],this.points[4],this.points[0]),Rr([],this.points[5],this.points[1]),Rr([],this.points[6],this.points[2]),Rr([],this.points[7],this.points[3])];for(const h of this.frustumEdges){const g=[0,-h[2],h[1]],x=[h[2],0,-h[0]];this.projections.push({axis:g,projection:os(this.points,this.points[0],g)}),this.projections.push({axis:x,projection:os(this.points,this.points[0],x)})}}static fromInvProjectionMatrix(i,l,h,g){const x=Math.pow(2,h),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((R=>{const L=qt([],R,i),U=1/L[3]/l*x;return(q=L)[0]=(ee=L)[0]*(te=[U,U,g?1/L[3]:U,U])[0],q[1]=ee[1]*te[1],q[2]=ee[2]*te[2],q[3]=ee[3]*te[3],q;var q,ee,te})),j=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((R=>{const L=Ot([],an([],Rr([],b[R[0]],b[R[1]]),Rr([],b[R[2]],b[R[1]]))),U=-Mt(L,b[R[1]]);return L.concat(U)})),M=[];for(let R=0;R<b.length;R++)M.push([b[R][0],b[R][1],b[R][2]]);return new Wi(M,j)}intersectsPrecise(i,l,h){for(let g=0;g<l.length;g++)if(!$i(i,l[g]))return 0;for(let g=0;g<this.planes.length;g++)if(!$i(i,this.planes[g]))return 0;for(const g of h)for(const x of this.frustumEdges){const b=an([],g,x),j=nt(b);if(j===0)continue;pt(b,b,1/j);const M=os(this.points,this.points[0],b),R=os(i,this.points[0],b);if(M[0]>R[1]||R[0]>M[1])return 0}return 1}containsPoint(i){for(const l of this.planes){const h=l[3];if(Mt([l[0],l[1],l[2]],i)+h<0)return!1}return!0}}class ii{static fromPoints(i){const l=[1/0,1/0,1/0],h=[-1/0,-1/0,-1/0];for(const g of i)mt(l,l,g),He(h,h,g);return new ii(l,h)}static fromTileIdAndHeight(i,l,h){const g=1<<i.canonical.z,x=i.canonical.x,b=i.canonical.y;return new ii([x/g,b/g,l],[(x+1)/g,(b+1)/g,h])}static applyTransform(i,l){const h=i.getCorners();for(let g=0;g<h.length;++g)Cn(h[g],h[g],l);return ii.fromPoints(h)}static applyTransformFast(i,l){const h=[l[12],l[13],l[14]],g=[...h];for(let x=0;x<3;x++)for(let b=0;b<3;b++){const j=l[4*b+x],M=j*i.min[b],R=j*i.max[b];h[x]+=Math.min(M,R),g[x]+=Math.max(M,R)}return new ii(h,g)}static projectAabbCorners(i,l){const h=i.getCorners();for(let g=0;g<h.length;++g)Cn(h[g],h[g],l);return h}constructor(i,l){this.min=i,this.max=l,this.center=pt([],Ee([],this.min,this.max),.5)}quadrant(i){const l=[i%2==0,i<2],h=$e(this.min),g=$e(this.max);for(let x=0;x<l.length;x++)h[x]=l[x]?this.min[x]:this.center[x],g[x]=l[x]?this.center[x]:this.max[x];return g[2]=this.max[2],new ii(h,g)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}getCorners(){const i=this.min,l=this.max;return[[i[0],i[1],i[2]],[l[0],i[1],i[2]],[l[0],l[1],i[2]],[i[0],l[1],i[2]],[i[0],i[1],l[2]],[l[0],i[1],l[2]],[l[0],l[1],l[2]],[i[0],l[1],l[2]]]}intersects(i){return this.intersectsAabb(i.bounds)?Fr(i,this.getCorners()):0}intersectsFlat(i){return this.intersectsAabb(i.bounds)?Fr(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(i,l){return l||this.intersects(i)?Bi(i,this.getCorners()):0}intersectsPreciseFlat(i,l){return l||this.intersectsFlat(i)?Bi(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(i){for(let l=0;l<3;++l)if(this.min[l]>i.max[l]||i.min[l]>this.max[l])return!1;return!0}intersectsAabbXY(i){return!(this.min[0]>i.max[0]||i.min[0]>this.max[0]||this.min[1]>i.max[1]||i.min[1]>this.max[1])}encapsulate(i){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],i.min[l]),this.max[l]=Math.max(this.max[l],i.max[l])}encapsulatePoint(i){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],i[l]),this.max[l]=Math.max(this.max[l],i[l])}closestPoint(i){return[Math.max(Math.min(this.max[0],i[0]),this.min[0]),Math.max(Math.min(this.max[1],i[1]),this.min[1]),Math.max(Math.min(this.max[2],i[2]),this.min[2])]}}Hn(ii,"Aabb");class Xi{constructor(i,l){this.feature=i,this.metersToTile=l,this.index=0}get(){const i=this.feature.vertices[this.index],l=this.feature.vertexProps[this.index].dir,h=l[1],g=-l[0],x=(i.extent+1)*this.metersToTile;return[new Rt(Math.trunc(i.position[0]+h*x),Math.trunc(i.position[1]+g*x)),new Rt(Math.trunc(i.position[0]-h*x),Math.trunc(i.position[1]-g*x))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class oi{constructor(i,l,h,g,x,b){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=i,this.heightRange={min:h,max:h},this.safeArea=l,this.constantHeight=h,this.constantHeight==null&&(this.constantHeight!=null||g.length!==0)){this.vertices=g,this.edges=x,this.edges=this.edges.filter((j=>{return j.a<this.vertices.length&&j.b<this.vertices.length&&!((M=this.vertices[j.a].position)[0]===(R=this.vertices[j.b].position)[0]&&M[1]===R[1]);var M,R})),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const j of this.vertices)this.vertexProps.push({dir:Xn(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,j.height),this.heightRange.max=Math.max(this.heightRange.max,j.height);for(const j of this.edges){const M=this.vertices[j.a].position,R=this.vertices[j.b].position,L=Ur(jn(),R,M),U=Hi(L),q=yi(jn(),L,1/U);this.edgeProps.push({vec:L,dir:q,len:U});const ee=this.vertexProps[j.a].dir,te=this.vertexProps[j.b].dir;mr(ee,ee,q),mr(te,te,q)}for(const j of this.vertexProps)j.dir[0]===0&&j.dir[1]===0||xr(j.dir,j.dir);this.tessellate(b)}}pointElevation(i){if(this.constantHeight!=null)return this.constantHeight;const l=this.getClosestEdge(i);if(l==null)return 0;const[h,g]=l;return yr(this.vertices[this.edges[h].a].height,this.vertices[this.edges[h].b].height,g)}computeSlopeNormal(i,l){const h=this.getClosestEdge(i);if(!h)return Me(0,0,1);const g=h[0],x=this.edges[g],b=this.edgeProps[g].vec,j=Me(b[0],b[1],(this.vertices[x.b].height-this.vertices[x.a].height)*l),M=Me(j[1],-j[0],0);an(M,M,j);const R=nt(M);return R>0?pt(M,M,1/R):Me(0,0,1)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(i){if(this.edges.length===0)return;let l=0,h=Number.POSITIVE_INFINITY,g=0;const x=Xn(i.x,i.y);for(let b=0;b<this.edges.length;b++){const j=this.edges[b],M=this.edgeProps[b].dir,R=new Lr(x,this.edgeProps[b].dir),L=this.vertices[j.a].position,U=this.vertices[j.b].position,q=jn(),ee=jn(),te=R.intersectsPlane(L,this.vertexProps[j.a].dir,q),le=R.intersectsPlane(U,this.vertexProps[j.b].dir,ee);if(!te||!le)continue;const ue=Ur(jn(),ee,q),ge=Ur(jn(),x,q),Se=dr(ue,ue),we=Se>0?dr(ge,ue)/Se:0,Pe=Oe(we,0,1),tt=Math.abs((we-Pe)*this.edgeProps[b].len),Ke=Ur(jn(),x,L),Qe=tt+Math.abs(dr(Ke,Xn(M[1],-M[0])));Qe<h&&(l=b,h=Qe,g=Pe)}return[l,g]}tessellate(i){for(let l=this.edges.length-1;l>=0;--l){const h=this.edges[l].a,g=this.edges[l].b,{position:x,height:b,extent:j}=this.vertices[h],{position:M,height:R,extent:L}=this.vertices[g],U=this.vertexProps[h].dir,q=this.vertexProps[g].dir,ee=Me(x[0]/i,x[1]/i,b),te=Me(M[0]/i,M[1]/i,R),le=Me(U[1],-U[0],0);pt(le,le,j);const ue=Me(q[1],-q[0],0);if(pt(ue,ue,L),this.distSqLines(Me(ee[0]+.5*le[0],ee[1]+.5*le[1],ee[2]+.5*le[2]),Me(te[0]-.5*ue[0],te[1]-.5*ue[1],te[2]-.5*ue[2]),Me(ee[0]-.5*le[0],ee[1]-.5*le[1],ee[2]-.5*le[2]),Me(te[0]+.5*ue[0],te[1]+.5*ue[1],te[2]+.5*ue[2]))<=.0025000000000000005)continue;const ge=this.vertices.length,Se=mr(jn(),x,M);this.vertices.push({position:yi(Se,Se,.5),height:.5*(b+R),extent:.5*(j+L)});const we=mr(jn(),U,q);this.vertexProps.push({dir:xr(we,we)}),this.edges.splice(l,1),this.edgeProps.splice(l,1),this.edges.push({a:h,b:ge}),this.edges.push({a:ge,b:g});const Pe=Ur(jn(),this.vertices[ge].position,x),tt=Hi(Pe),Ke={vec:Pe,dir:yi(jn(),Pe,1/tt),len:tt};this.edgeProps.push(Ke),this.edgeProps.push(Ke)}}distSqLines(i,l,h,g){const x=it(Re(),l,i),b=it(Re(),g,h),j=it(Re(),i,h),M=Mt(x,x),R=Mt(x,b),L=Mt(x,j),U=Mt(b,b),q=Mt(b,j),ee=M*U-R*R;if(ee===0){const ue=Mt(j,b)/Mt(b,b);return Je(Jt(Re(),h,g,ue),i)}const te=(R*q-L*U)/ee,le=(M*q-R*L)/ee;return Je(Jt(Re(),i,l,te),Jt(Re(),h,g,le))}}class js{static parseFrom(i,l){const h=ji.parse(i);if(!h)return[];let{vertices:g,features:x}=h;const b=1/qe(l);x.sort(((L,U)=>L.id-U.id)),g.sort(((L,U)=>L.id-U.id||L.idx-U.idx)),g=g.filter(((L,U,q)=>U===q.findIndex((ee=>ee.id===L.id&&ee.idx===L.idx))));const j=new Array;let M=0;const R=g.length;for(const L of x){if(L.constantHeight){j.push(new oi(L.id,L.bounds,L.constantHeight));continue}for(;M!==R&&g[M].id<L.id;)M++;if(M===R||g[M].id!==L.id)continue;const U=new Array,q=new Array,ee=M;for(;M!==R&&g[M].id===L.id;){const te=g[M];if(U.push({position:te.position,height:te.height,extent:te.extent}),M!==ee&&g[M-1].idx===te.idx-1){const le=M-ee;q.push({a:le-1,b:le})}M++}j.push(new oi(L.id,L.bounds,void 0,U,q,b))}return j}static getElevationFeature(i,l){if(!l)return;const h=+i.properties[In];return Number.isNaN(h)?void 0:l.find((g=>g.id===h))}}class Ei{constructor(i,l){this.zScale=1,this.xOffset=0,this.yOffset=0,i.equals(l)||(this.zScale=Math.pow(2,l.z-i.z),this.xOffset=(i.x*this.zScale-l.x)*mn,this.yOffset=(i.y*this.zScale-l.y)*mn)}constantElevation(i,l){if(i.constantHeight!=null)return this.computeBiasedHeight(i.constantHeight,l)}pointElevation(i,l,h){const g=this.constantElevation(l,h);return g??(i.x=i.x*this.zScale+this.xOffset,i.y=i.y*this.zScale+this.yOffset,this.computeBiasedHeight(l.pointElevation(i),h))}computeBiasedHeight(i,l){return l<=0?i:i+l*ut(0,l,i>=0?i:Math.abs(.5*i))}}Hn(oi,"ElevationFeature");class Ui{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map((l=>l.fqid)),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new bl,this.indexArray=new ki,this.segments=new Hs,this.programConfigurations=new Ul(i.layers,{zoom:i.zoom,lut:i.lut}),this.stateDependentLayerIds=this.layers.filter((l=>l.isStateDependent())).map((l=>l.id)),this.elevationMode=this.layers[0].layout.get("circle-elevation-reference"),this.hasElevation=!1,this.elevationMode!=="none"&&(this.elevatedLayoutVertexArray=new bh),this.worldview=i.worldview}updateFootprints(i,l){}populate(i,l,h,g){const x=this.layers[0],b=[];let j=null;x.type==="circle"&&(j=x.layout.get("circle-sort-key"));for(const{feature:R,id:L,index:U,sourceLayerIndex:q}of i){const ee=this.layers[0]._featureFilter.needGeometry,te=Dt(R,ee);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom,{worldview:this.worldview}),te,h))continue;const le=j?j.evaluate(te,{},h):void 0,ue={id:L,properties:R.properties,type:R.type,sourceLayerIndex:q,index:U,geometry:ee?te.geometry:at(R,h,g),patterns:{},sortKey:le};b.push(ue)}j&&b.sort(((R,L)=>R.sortKey-L.sortKey));let M=null;g.projection.name==="globe"&&(this.globeExtVertexArray=new Vm,M=g.projection);for(const R of b){const{geometry:L,index:U,sourceLayerIndex:q}=R,ee=i[U].feature;this.addFeature(R,L,U,l.availableImages,h,M,l.brightness,l.elevationFeatures),l.featureIndex.insert(ee,L,U,q,this.index)}this.hasElevation||(this.elevatedLayoutVertexArray=void 0)}update(i,l,h,g,x,b,j){this.programConfigurations.updatePaintArrays(i,l,x,h,g,b,j,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Kv.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,Jv.members)),this.elevatedLayoutVertexArray&&(this.elevatedLayoutVertexBuffer=i.createVertexBuffer(this.elevatedLayoutVertexArray,A_.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy())}addFeature(i,l,h,g,x,b,j,M){let R;this.elevationMode!=="none"&&(R=js.getElevationFeature(i,M));for(const L of l)for(const U of L){const q=U.x,ee=U.y;if(q<0||q>=mn||ee<0||ee>=mn)continue;if(b){const ue=b.projectTilePoint(q,ee,x),ge=b.upVector(x,q,ee);this.addGlobeExtVertex(ue,ge),this.addGlobeExtVertex(ue,ge),this.addGlobeExtVertex(ue,ge),this.addGlobeExtVertex(ue,ge)}const te=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),le=te.vertexLength;if(this.addCircleVertex(q,ee,-1,-1),this.addCircleVertex(q,ee,1,-1),this.addCircleVertex(q,ee,1,1),this.addCircleVertex(q,ee,-1,1),this.elevationMode!=="none"){const ue=R?R.pointElevation(new Rt(q,ee)):0;this.hasElevation=this.hasElevation||ue!==0;for(let ge=0;ge<4;ge++)this.elevatedLayoutVertexArray.emplaceBack(ue)}this.indexArray.emplaceBack(le,le+1,le+2),this.indexArray.emplaceBack(le,le+2,le+3),te.vertexLength+=4,te.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,{},g,x,j,void 0,this.worldview)}addCircleVertex(i,l,h,g){this.layoutVertexArray.emplaceBack(2*i+(h+1)/2,2*l+(g+1)/2)}addGlobeExtVertex(i,l){this.globeExtVertexArray.emplaceBack(i.x,i.y,i.z,l[0]*16384,l[1]*16384,l[2]*16384)}}function fs(u,i){for(let l=0;l<u.length;l++)if(Ha(i,u[l]))return!0;for(let l=0;l<i.length;l++)if(Ha(u,i[l]))return!0;return!!go(u,i)}function _a(u,i,l){return!!Ha(u,i)||!!qo(i,u,l)}function ba(u,i){if(u.length===1)return Wc(i,u[0]);for(let l=0;l<i.length;l++){const h=i[l];for(let g=0;g<h.length;g++)if(Ha(u,h[g]))return!0}for(let l=0;l<u.length;l++)if(Wc(i,u[l]))return!0;for(let l=0;l<i.length;l++)if(go(u,i[l]))return!0;return!1}function pa(u,i,l){if(u.length>1){if(go(u,i))return!0;for(let h=0;h<i.length;h++)if(qo(i[h],u,l))return!0}for(let h=0;h<u.length;h++)if(qo(u[h],i,l))return!0;return!1}function go(u,i){if(u.length===0||i.length===0)return!1;for(let l=0;l<u.length-1;l++){const h=u[l],g=u[l+1];for(let x=0;x<i.length-1;x++)if(so(h,g,i[x],i[x+1]))return!0}return!1}function so(u,i,l,h){return ws(u,l,h)!==ws(i,l,h)&&ws(u,i,l)!==ws(u,i,h)}function ll(u,i,l){return(u.x-l.x)*(i.y-l.y)-(u.y-l.y)*(i.x-l.x)}function za(u,i,l,h){const g=ll(u,i,h),x=ll(u,i,l);if(Math.sign(g)===Math.sign(x))return;const b=ll(l,h,u),j=b+x-g;return Math.sign(b)!==Math.sign(j)?[b/(b-j),x/(x-g)]:void 0}function qo(u,i,l){const h=l*l;if(i.length===1)return u.distSqr(i[0])<h;for(let g=1;g<i.length;g++)if(sc(u,i[g-1],i[g])<h)return!0;return!1}function sc(u,i,l){const h=i.distSqr(l);if(h===0)return u.distSqr(i);const g=((u.x-i.x)*(l.x-i.x)+(u.y-i.y)*(l.y-i.y))/h;return u.distSqr(g<0?i:g>1?l:l.sub(i)._mult(g)._add(i))}function Wc(u,i){let l,h,g,x=!1;for(let b=0;b<u.length;b++){l=u[b];for(let j=0,M=l.length-1;j<l.length;M=j++)h=l[j],g=l[M],h.y>i.y!=g.y>i.y&&i.x<(g.x-h.x)*(i.y-h.y)/(g.y-h.y)+h.x&&(x=!x)}return x}function Ha(u,i){let l=!1;for(let h=0,g=u.length-1;h<u.length;g=h++){const x=u[h],b=u[g];x.y>i.y!=b.y>i.y&&i.x<(b.x-x.x)*(i.y-x.y)/(b.y-x.y)+x.x&&(l=!l)}return l}function la(u,i,l,h,g){for(const b of u)if(i<=b.x&&l<=b.y&&h>=b.x&&g>=b.y)return!0;const x=[new Rt(i,l),new Rt(i,g),new Rt(h,g),new Rt(h,l)];if(u.length>2){for(const b of x)if(Ha(u,b))return!0}for(let b=0;b<u.length-1;b++)if(ia(u[b],u[b+1],x))return!0;return!1}function ia(u,i,l){const h=l[0],g=l[2];if(u.x<h.x&&i.x<h.x||u.x>g.x&&i.x>g.x||u.y<h.y&&i.y<h.y||u.y>g.y&&i.y>g.y)return!1;const x=ws(u,i,l[0]);return x!==ws(u,i,l[1])||x!==ws(u,i,l[2])||x!==ws(u,i,l[3])}function ls(u,i,l,h,g,x){let b=i.y-u.y,j=u.x-i.x;if(x=x||0){const M=b*b+j*j;if(M===0)return!0;const R=Math.sqrt(M);b/=R,j/=R}return!((l.x-u.x)*b+(l.y-u.y)*j-x<0||(h.x-u.x)*b+(h.y-u.y)*j-x<0||(g.x-u.x)*b+(g.y-u.y)*j-x<0)}function Ga(u,i,l,h,g,x,b){return!(ls(u,i,h,g,x,b)||ls(i,l,h,g,x,b)||ls(l,u,h,g,x,b)||ls(h,g,u,i,l,b)||ls(g,x,u,i,l,b)||ls(x,h,u,i,l,b))}function So(u,i,l){const h=i.paint.get(u).value;return h.kind==="constant"?h.value:l.programConfigurations.get(i.id).getMaxValue(u)}function ma(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function Vl(u,i,l,h,g){if(!i[0]&&!i[1])return u;const x=Rt.convert(i)._mult(g);l==="viewport"&&x._rotate(-h);const b=[];for(let j=0;j<u.length;j++)b.push(u[j].sub(x));return b}function Rd(u,i,l,h){const g=Rt.convert(u)._mult(h);return i==="viewport"&&g._rotate(-l),g}let Th,Ep;function Cp(u,i,l){var h=2*Math.PI*6378137/256/Math.pow(2,l);return[u*h-2*Math.PI*6378137/2,i*h-2*Math.PI*6378137/2]}Hn(Ui,"CircleBucket",{omit:["layers"]});class ac{constructor(i,l,h){this.z=i,this.x=l,this.y=h,this.key=Tl(0,i,i,l,h)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}isChildOf(i){const l=this.z-i.z;return i.z===0||i.z<this.z&&i.x===this.x>>l&&i.y===this.y>>l}url(i,l){const h=(function(x,b,j){var M=Cp(256*x,256*(b=Math.pow(2,j)-b-1),j),R=Cp(256*(x+1),256*(b+1),j);return M[0]+","+M[1]+","+R[0]+","+R[1]})(this.x,this.y,this.z),g=(function(x,b,j){let M,R="";for(let L=x;L>0;L--)M=1<<L-1,R+=(b&M?1:0)+(j&M?2:0);return R})(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",g).replace("{bbox-epsg-3857}",h)}toString(){return`${this.z}/${this.x}/${this.y}`}}class gu{constructor(i,l){this.wrap=i,this.canonical=l,this.key=Tl(i,l.z,l.z,l.x,l.y)}}class wa{constructor(i,l,h,g,x){this.overscaledZ=i,this.wrap=l,this.canonical=new ac(h,+g,+x),this.key=l===0&&i===h?this.canonical.key:Tl(l,i,h,g,x)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const l=this.canonical.z-i;return i>this.canonical.z?new wa(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new wa(i,this.wrap,i,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(i,l=!0){if(this.overscaledZ===i&&l)return this.key;if(i>this.canonical.z)return Tl(this.wrap*+l,i,this.canonical.z,this.canonical.x,this.canonical.y);{const h=this.canonical.z-i;return Tl(this.wrap*+l,i,i,this.canonical.x>>h,this.canonical.y>>h)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const l=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.z<this.canonical.z&&i.canonical.x===this.canonical.x>>l&&i.canonical.y===this.canonical.y>>l}children(i){if(this.overscaledZ>=i)return[new wa(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,h=2*this.canonical.x,g=2*this.canonical.y;return[new wa(l,this.wrap,l,h,g),new wa(l,this.wrap,l,h+1,g),new wa(l,this.wrap,l,h,g+1),new wa(l,this.wrap,l,h+1,g+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new wa(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new wa(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new gu(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Tl(u,i,l,h,g){const x=1<<Math.min(l,22);let b=x*(g%x)+h%x;return u&&l<22&&(b+=x*x*((u<0?-2*u-1:2*u)%(1<<2*(22-l)))),16*(32*b+l)+(i-l)}const Ah=[u=>{let i=u.canonical.x-1,l=u.wrap;return i<0&&(i=(1<<u.canonical.z)-1,l--),new wa(u.overscaledZ,l,u.canonical.z,i,u.canonical.y)},u=>{let i=u.canonical.x+1,l=u.wrap;return i===1<<u.canonical.z&&(i=0,l++),new wa(u.overscaledZ,l,u.canonical.z,i,u.canonical.y)},u=>new wa(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,(u.canonical.y===0?1<<u.canonical.z:u.canonical.y)-1),u=>new wa(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y===(1<<u.canonical.z)-1?0:u.canonical.y+1)];Hn(ac,"CanonicalTileID"),Hn(wa,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const BT=Ai([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:nx}=BT,UT=Ai([{name:"a_pos_3",components:3,type:"Int16"}]);var rw=Ai([{name:"a_pos",type:"Int16",components:2}]);function rx(u){return u*qa/I}const N_=[new ii([S,S,S],[A,A,A]),new ii([S,S,S],[0,0,A]),new ii([0,S,S],[A,0,A]),new ii([S,0,S],[0,A,A]),new ii([0,0,S],[A,A,A])];function iw(u,i,l,h=!0){const g=pt([],u._camera.position,u.worldSize),x=[i,l,1,1];qt(x,x,u.pixelMatrixInverse),ui(x,x,1/x[3]);const b=Ot([],Rr([],x,g)),j=u.globeMatrix,M=[j[12],j[13],j[14]],R=Rr([],M,g),L=nt(R),U=Ot([],R),q=u.worldSize/(2*Math.PI),ee=Mt(U,b),te=Math.asin(q/L);if(te<Math.acos(ee)){if(!h)return null;const Ft=[],xt=[];pt(Ft,b,L/ee),Ot(xt,Rr(xt,Ft,R)),Ot(b,Ee(b,R,pt(b,xt,Math.tan(te)*L)))}const le=[];new mi(g,b).closestPointOnSphere(M,q,le);const ue=Ot([],Fi(j,0)),ge=Ot([],Fi(j,1)),Se=Ot([],Fi(j,2)),we=Mt(ue,le),Pe=Mt(ge,le),tt=Mt(Se,le),Ke=gt(Math.asin(-Pe/q));let Qe=gt(Math.atan2(we,tt));Qe=u.center.lng+(function(Ft,xt){const Wt=(xt-Ft+180)%360-180;return Wt<-180?Wt+360:Wt})(u.center.lng,Qe);const dt=ce(Qe),ft=Oe(pe(Ke),0,1);return new Ge(dt,ft)}class VT{constructor(i,l,h){this.a=Rr([],i,h),this.b=Rr([],l,h),this.center=h;const g=Ot([],this.a),x=Ot([],this.b);this.angle=Math.acos(Mt(g,x))}}function Da(u,i){if(u.angle===0)return null;let l;return l=u.a[i]===0?1/u.angle*.5*Math.PI:1/u.angle*Math.atan(u.b[i]/u.a[i]/Math.sin(u.angle)-1/Math.tan(u.angle)),l<0||l>1?null:(function(h,g,x,b){const j=Math.sin(x);return h*(Math.sin((1-b)*x)/j)+g*(Math.sin(b*x)/j)})(u.a[i],u.b[i],u.angle,Oe(l,0,1))+u.center[i]}function Xu(u){if(u.z<=1)return N_[u.z+2*u.y+u.x];const i=aw(P_(u));return ii.fromPoints(i)}function gf(u,i,l){return pt(u,u,1-l),We(u,u,i,l)}function sw(u,i,l){for(const h of u)Cn(h,h,i),pt(h,h,l)}function $T(u,i,l,h){const g=i/u.worldSize,x=u.globeMatrix;if(l.z<=1){const ft=Xu(l).getCorners();return sw(ft,x,g),ii.fromPoints(ft)}const b=P_(l,h),j=aw(b,qa+rx(u._tileCoverLift));sw(j,x,g);const M=Number.MAX_VALUE,R=[-M,-M,-M],L=[M,M,M];if(b.contains(u.center)){for(const xt of j)mt(L,L,xt),He(R,R,xt);R[2]=0;const ft=u.point,Ft=[ft.x*g,ft.y*g,0];return mt(L,L,Ft),He(R,R,Ft),new ii(L,R)}if(u._tileCoverLift>0){for(const ft of j)mt(L,L,ft),He(R,R,ft);return new ii(L,R)}const U=[x[12]*g,x[13]*g,x[14]*g],q=b.getCenter(),ee=Oe(u.center.lat,-Be,Be),te=Oe(q.lat,-Be,Be),le=ce(u.center.lng),ue=pe(ee);let ge=le-ce(q.lng);const Se=ue-pe(te);ge>.5?ge-=1:ge<-.5&&(ge+=1);let we=0;Math.abs(ge)>Math.abs(Se)?we=ge>=0?1:3:(we=Se>=0?0:2,We(U,U,[x[4]*g,x[5]*g,x[6]*g],-Math.sin(Dr(Se>=0?b.getSouth():b.getNorth()))*qa));const Pe=j[we],tt=j[(we+1)%4],Ke=new VT(Pe,tt,U),Qe=[Da(Ke,0)||Pe[0],Da(Ke,1)||Pe[1],Da(Ke,2)||Pe[2]],dt=Pp(u.zoom);if(dt>0){const ft=(function({x:xt,y:Wt,z:bn},tn,dn,xn,Lt){const hn=1/(1<<bn);let Tt=xt*hn,zt=Tt+hn,wn=Wt*hn,pn=wn+hn,ur=0;const Jn=(Tt+zt)/2-xn;return Jn>.5?ur=-1:Jn<-.5&&(ur=1),Tt=((Tt+ur)*tn-(xn*=tn))*dn+xn,zt=((zt+ur)*tn-xn)*dn+xn,wn=(wn*tn-(Lt*=tn))*dn+Lt,pn=(pn*tn-Lt)*dn+Lt,[[Tt,pn,0],[zt,pn,0],[zt,wn,0],[Tt,wn,0]]})(l,i,u._pixelsPerMercatorPixel,le,ue);for(let xt=0;xt<j.length;xt++)gf(j[xt],ft[xt],dt);const Ft=Ee([],ft[we],ft[(we+1)%4]);pt(Ft,Ft,.5),gf(Qe,Ft,dt)}for(const ft of j)mt(L,L,ft),He(R,R,ft);return L[2]=Math.min(Pe[2],tt[2]),mt(L,L,Qe),He(R,R,Qe),new ii(L,R)}function P_({x:u,y:i,z:l},h=!1){const g=1/(1<<l),x=new G(be(u*g),i===(1<<l)-1&&h?-90:Ne((i+1)*g)),b=new G(be((u+1)*g),i===0&&h?90:Ne(i*g));return new ne(x,b)}function aw(u,i=qa){const l=Dr(u.getNorth()),h=Dr(u.getSouth()),g=Math.cos(l),x=Math.cos(h),b=Math.sin(l),j=Math.sin(h),M=u.getWest(),R=u.getEast();return[P(x,j,M,i),P(x,j,R,i),P(g,b,R,i),P(g,b,M,i)]}function Np(u,i,l,h){const g=1<<l.z,x=(u/mn+l.x)/g;return O(Ne((i/mn+l.y)/g),be(x),h)}function yf({min:u,max:i}){return a/Math.max(i[0]-u[0],i[1]-u[1],i[2]-u[2])}const M_=new Float64Array(16);function tg(u){const i=yf(u),l=he(M_,[i,i,i]);return Y(l,l,Pt([],u.min))}function ix(u){const i=(h=u.min,(l=M_)[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=h[0],l[13]=h[1],l[14]=h[2],l[15]=1,l);var l,h;const g=1/yf(u);return X(i,i,[g,g,g])}function vf(u){const i=mn/(2*Math.PI);return u/(2*Math.PI)/i}function Od(u,i){return mn/(512*Math.pow(2,u))*yf(Xu(i))}function by(u,i,l,h,g){const x=vf(l),b=[u,i,-l/(2*Math.PI)],j=B(new Float64Array(16));return Y(j,j,b),X(j,j,[x,x,x]),ae(j,j,Dr(-g)),Z(j,j,Dr(-h)),j}function Pp(u){return ut(mo,y,u)}function ow(u,i){const l=O(i.lat,i.lng),h=(function(te){const le=O(te._center.lat,te._center.lng);let ue=an([],Me(0,1,0),le);const ge=ye([],-te.angle,le);ue=Cn(ue,ue,ge),ye(ge,-te._pitch,ue);const Se=Ot([],le);return pt(Se,Se,rx(te.cameraToCenterDistance/te.pixelsPerMeter)),Cn(Se,Se,ge),Ee([],le,Se)})(u);return b=(g=it([],h,l))[0],j=g[1],M=g[2],R=(x=l)[0],L=x[1],U=x[2],ee=(q=Math.sqrt(b*b+j*j+M*M)*Math.sqrt(R*R+L*L+U*U))&&Mt(g,x)/q,Math.acos(Math.min(Math.max(ee,-1),1));var g,x,b,j,M,R,L,U,q,ee}function R_(u,i){return ow(u,i)>Math.PI/2*1.01}const lw=Dr(85),qT=Math.cos(lw),lN=Math.sin(lw),cw=$(),uw=u=>{const i=[];return u.paint.get("circle-pitch-alignment")==="map"&&i.push("PITCH_WITH_MAP"),u.paint.get("circle-pitch-scale")==="map"&&i.push("SCALE_WITH_MAP"),i};function dw(u,i,l,h,g,x,b,j,M){if(x&&u.queryGeometry.isAboveHorizon)return!1;x&&(M*=u.pixelToTileUnitsFactor);const R=u.tileID.canonical,L=l.projection.upVectorScale(R,l.center.lat,l.worldSize).metersToTile;for(const U of i)for(const q of U){const ee=q.add(j),te=g&&l.elevation?l.elevation.exaggeration()*g.getElevationAt(ee.x,ee.y,!0):0,le=l.projection.projectTilePoint(ee.x,ee.y,R);if(te>0){const we=l.projection.upVector(R,ee.x,ee.y);le.x+=we[0]*L*te,le.y+=we[1]*L*te,le.z+=we[2]*L*te}const ue=x?ee:cN(le.x,le.y,le.z,h),ge=x?u.tilespaceRays.map((we=>uN(we,te))):u.queryGeometry.screenGeometry,Se=qt([],[le.x,le.y,le.z,1],h);if(!b&&x?M*=Se[3]/l.cameraToCenterDistance:b&&!x&&(M*=l.cameraToCenterDistance/Se[3]),x){const we=Ne((q.y/mn+R.y)/(1<<R.z));M/=l.projection.pixelsPerMeter(we,1)/me(1,we)}if(_a(ge,ue,M))return!0}return!1}function cN(u,i,l,h){const g=qt([],[u,i,l,1],h);return new Rt(g[0]/g[3],g[1]/g[3])}const O_=Me(0,0,0),hw=Me(0,0,1);function uN(u,i){const l=Re();return O_[2]=i,u.intersectsPlane(O_,hw,l),new Rt(l[0],l[1])}class HT extends Ui{}let wy,GT,fw,Ls;function D_(u,{width:i,height:l},h,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==i*l*h)throw new RangeError("mismatched image size")}else g=new Uint8Array(i*l*h);return u.width=i,u.height=l,u.data=g,u}function sx(u,i,l){const{width:h,height:g}=i;h===u.width&&g===u.height||(ax(u,i,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,h),height:Math.min(u.height,g)},l,null),u.width=h,u.height=g,u.data=i.data)}function ax(u,i,l,h,g,x,b,j){if(g.width===0||g.height===0)return i;if(g.width>u.width||g.height>u.height||l.x>u.width-g.width||l.y>u.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>i.width||g.height>i.height||h.x>i.width-g.width||h.y>i.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const M=u.data,R=i.data,L=x===4&&j;for(let U=0;U<g.height;U++){const q=((l.y+U)*u.width+l.x)*x,ee=((h.y+U)*i.width+h.x)*x;if(L)for(let te=0;te<g.width;te++){const le=q+te*x+3,ue=ee+te*x;R[ue+0]=255,R[ue+1]=255,R[ue+2]=255,R[ue+3]=M[le]}else if(b)for(let te=0;te<g.width;te++){const le=q+te*x,ue=ee+te*x,ge=new ns(M[le+0]/255,M[le+1]/255,M[le+2]/255,M[le+3]).toNonPremultipliedRenderColor(b).toArray();R[ue+0]=ge[0],R[ue+1]=ge[1],R[ue+2]=ge[2],R[ue+3]=ge[3]}else for(let te=0;te<g.width*x;te++)R[ee+te]=M[q+te]}return i}Hn(HT,"HeatmapBucket",{omit:["layers"]});class xf{constructor(i,l){D_(this,i,1,l)}resize(i){sx(this,new xf(i),1)}clone(){return new xf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,l,h,g,x){ax(i,l,h,g,x,1,null)}}class Oo{constructor(i,l){D_(this,i,4,l)}resize(i){sx(this,new Oo(i),4)}replace(i,l){l?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Oo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,l,h,g,x,b,j){ax(i,l,h,g,x,4,b,j)}}class Sy{constructor(i,l){this.width=i.width,this.height=i.height,this.data=l instanceof Uint8Array?new Float32Array(l.buffer):l}}function Mp(u){const i={},l=u.resolution||256,h=u.clips?u.clips.length:1,g=u.image||new Oo({width:l,height:h}),x=(b,j,M)=>{i[u.evaluationKey]=M;const R=u.expression.evaluate(i),L=R?R.toNonPremultipliedRenderColor(null):null;L&&(g.data[b+j+0]=Math.floor(255*L.r),g.data[b+j+1]=Math.floor(255*L.g),g.data[b+j+2]=Math.floor(255*L.b),g.data[b+j+3]=Math.floor(255*L.a))};if(u.clips)for(let b=0,j=0;b<h;++b,j+=4*l)for(let M=0,R=0;M<l;M++,R+=4){const L=M/(l-1),{start:U,end:q}=u.clips[b];x(j,R,U*(1-L)+q*L)}else for(let b=0,j=0;b<l;b++,j+=4)x(0,j,b/(l-1));return g}Hn(xf,"AlphaImage"),Hn(Oo,"RGBAImage");const Ty=Ai([{name:"a_pos",components:2,type:"Int16"}],4),WT=Ai([{name:"a_road_z_offset",components:1,type:"Float32"}],4),dN=Ai([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),hN=Ai([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function ng(u,i,l=2){const h=i&&i.length,g=h?i[0]*l:u.length;let x=pw(u,0,g,l,!0);const b=[];if(!x||x.next===x.prev)return b;let j,M,R;if(h&&(x=(function(L,U,q,ee){const te=[];for(let le=0,ue=U.length;le<ue;le++){const ge=pw(L,U[le]*ee,le<ue-1?U[le+1]*ee:L.length,ee,!1);ge===ge.next&&(ge.steiner=!0),te.push(vw(ge))}te.sort(yw);for(let le=0;le<te.length;le++)q=k_(te[le],q);return q})(u,i,x,l)),u.length>80*l){j=u[0],M=u[1];let L=j,U=M;for(let q=l;q<g;q+=l){const ee=u[q],te=u[q+1];ee<j&&(j=ee),te<M&&(M=te),ee>L&&(L=ee),te>U&&(U=te)}R=Math.max(L-j,U-M),R=R!==0?32767/R:0}return ga(x,b,l,j,M,R,0),b}function pw(u,i,l,h,g){let x;if(g===(function(b,j,M,R){let L=0;for(let U=j,q=M-R;U<M;U+=R)L+=(b[q]-b[U])*(b[U+1]+b[q+1]),q=U;return L})(u,i,l,h)>0)for(let b=i;b<l;b+=h)x=KT(b/h|0,u[b],u[b+1],x);else for(let b=l-h;b>=i;b-=h)x=KT(b/h|0,u[b],u[b+1],x);return x&&rg(x,x.next)&&(lx(x),x=x.next),x}function jh(u,i){if(!u)return u;i||(i=u);let l,h=u;do if(l=!1,h.steiner||!rg(h,h.next)&&To(h.prev,h,h.next)!==0)h=h.next;else{if(lx(h),h=i=h.prev,h===h.next)break;l=!0}while(l||h!==i);return i}function ga(u,i,l,h,g,x,b){if(!u)return;!b&&x&&(function(M,R,L,U){let q=M;do q.z===0&&(q.z=I_(q.x,q.y,R,L,U)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next;while(q!==M);q.prevZ.nextZ=null,q.prevZ=null,(function(ee){let te,le=1;do{let ue,ge=ee;ee=null;let Se=null;for(te=0;ge;){te++;let we=ge,Pe=0;for(let Ke=0;Ke<le&&(Pe++,we=we.nextZ,we);Ke++);let tt=le;for(;Pe>0||tt>0&&we;)Pe!==0&&(tt===0||!we||ge.z<=we.z)?(ue=ge,ge=ge.nextZ,Pe--):(ue=we,we=we.nextZ,tt--),Se?Se.nextZ=ue:ee=ue,ue.prevZ=Se,Se=ue;ge=we}Se.nextZ=null,le*=2}while(te>1)})(q)})(u,h,g,x);let j=u;for(;u.prev!==u.next;){const M=u.prev,R=u.next;if(x?$l(u,h,g,x):mw(u))i.push(M.i,u.i,R.i),lx(u),u=R.next,j=R.next;else if((u=R)===j){b?b===1?ga(u=fN(jh(u),i),i,l,h,g,x,2):b===2&&gw(u,i,l,h,g,x):ga(jh(u),i,l,h,g,x,1);break}}}function mw(u){const i=u.prev,l=u,h=u.next;if(To(i,l,h)>=0)return!1;const g=i.x,x=l.x,b=h.x,j=i.y,M=l.y,R=h.y,L=Math.min(g,x,b),U=Math.min(j,M,R),q=Math.max(g,x,b),ee=Math.max(j,M,R);let te=h.next;for(;te!==i;){if(te.x>=L&&te.x<=q&&te.y>=U&&te.y<=ee&&ox(g,j,x,M,b,R,te.x,te.y)&&To(te.prev,te,te.next)>=0)return!1;te=te.next}return!0}function $l(u,i,l,h){const g=u.prev,x=u,b=u.next;if(To(g,x,b)>=0)return!1;const j=g.x,M=x.x,R=b.x,L=g.y,U=x.y,q=b.y,ee=Math.min(j,M,R),te=Math.min(L,U,q),le=Math.max(j,M,R),ue=Math.max(L,U,q),ge=I_(ee,te,i,l,h),Se=I_(le,ue,i,l,h);let we=u.prevZ,Pe=u.nextZ;for(;we&&we.z>=ge&&Pe&&Pe.z<=Se;){if(we.x>=ee&&we.x<=le&&we.y>=te&&we.y<=ue&&we!==g&&we!==b&&ox(j,L,M,U,R,q,we.x,we.y)&&To(we.prev,we,we.next)>=0||(we=we.prevZ,Pe.x>=ee&&Pe.x<=le&&Pe.y>=te&&Pe.y<=ue&&Pe!==g&&Pe!==b&&ox(j,L,M,U,R,q,Pe.x,Pe.y)&&To(Pe.prev,Pe,Pe.next)>=0))return!1;Pe=Pe.nextZ}for(;we&&we.z>=ge;){if(we.x>=ee&&we.x<=le&&we.y>=te&&we.y<=ue&&we!==g&&we!==b&&ox(j,L,M,U,R,q,we.x,we.y)&&To(we.prev,we,we.next)>=0)return!1;we=we.prevZ}for(;Pe&&Pe.z<=Se;){if(Pe.x>=ee&&Pe.x<=le&&Pe.y>=te&&Pe.y<=ue&&Pe!==g&&Pe!==b&&ox(j,L,M,U,R,q,Pe.x,Pe.y)&&To(Pe.prev,Pe,Pe.next)>=0)return!1;Pe=Pe.nextZ}return!0}function fN(u,i){let l=u;do{const h=l.prev,g=l.next.next;!rg(h,g)&&YT(h,l,l.next,g)&&Ay(h,g)&&Ay(g,h)&&(i.push(h.i,l.i,g.i),lx(l),lx(l.next),l=u=g),l=l.next}while(l!==u);return jh(l)}function gw(u,i,l,h,g,x){let b=u;do{let j=b.next.next;for(;j!==b.prev;){if(b.i!==j.i&&ZT(b,j)){let M=F_(b,j);return b=jh(b,b.next),M=jh(M,M.next),ga(b,i,l,h,g,x,0),void ga(M,i,l,h,g,x,0)}j=j.next}b=b.next}while(b!==u)}function yw(u,i){let l=u.x-i.x;return l===0&&(l=u.y-i.y,l===0)&&(l=(u.next.y-u.y)/(u.next.x-u.x)-(i.next.y-i.y)/(i.next.x-i.x)),l}function k_(u,i){const l=(function(g,x){let b=x;const j=g.x,M=g.y;let R,L=-1/0;if(rg(g,b))return b;do{if(rg(g,b.next))return b.next;if(M<=b.y&&M>=b.next.y&&b.next.y!==b.y){const le=b.x+(M-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(le<=j&&le>L&&(L=le,R=b.x<b.next.x?b:b.next,le===j))return R}b=b.next}while(b!==x);if(!R)return null;const U=R,q=R.x,ee=R.y;let te=1/0;b=R;do{if(j>=b.x&&b.x>=q&&j!==b.x&&L_(M<ee?j:L,M,q,ee,M<ee?L:j,M,b.x,b.y)){const le=Math.abs(M-b.y)/(j-b.x);Ay(b,g)&&(le<te||le===te&&(b.x>R.x||b.x===R.x&&XT(R,b)))&&(R=b,te=le)}b=b.next}while(b!==U);return R})(u,i);if(!l)return i;const h=F_(l,u);return jh(h,h.next),jh(l,l.next)}function XT(u,i){return To(u.prev,u,i.prev)<0&&To(i.next,u,u.next)<0}function I_(u,i,l,h,g){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-l)*g|0)|u<<8))|u<<4))|u<<2))|u<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-h)*g|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function vw(u){let i=u,l=u;do(i.x<l.x||i.x===l.x&&i.y<l.y)&&(l=i),i=i.next;while(i!==u);return l}function L_(u,i,l,h,g,x,b,j){return(g-b)*(i-j)>=(u-b)*(x-j)&&(u-b)*(h-j)>=(l-b)*(i-j)&&(l-b)*(x-j)>=(g-b)*(h-j)}function ox(u,i,l,h,g,x,b,j){return!(u===b&&i===j)&&L_(u,i,l,h,g,x,b,j)}function ZT(u,i){return u.next.i!==i.i&&u.prev.i!==i.i&&!(function(l,h){let g=l;do{if(g.i!==l.i&&g.next.i!==l.i&&g.i!==h.i&&g.next.i!==h.i&&YT(g,g.next,l,h))return!0;g=g.next}while(g!==l);return!1})(u,i)&&(Ay(u,i)&&Ay(i,u)&&(function(l,h){let g=l,x=!1;const b=(l.x+h.x)/2,j=(l.y+h.y)/2;do g.y>j!=g.next.y>j&&g.next.y!==g.y&&b<(g.next.x-g.x)*(j-g.y)/(g.next.y-g.y)+g.x&&(x=!x),g=g.next;while(g!==l);return x})(u,i)&&(To(u.prev,u,i.prev)||To(u,i.prev,i))||rg(u,i)&&To(u.prev,u,u.next)>0&&To(i.prev,i,i.next)>0)}function To(u,i,l){return(i.y-u.y)*(l.x-i.x)-(i.x-u.x)*(l.y-i.y)}function rg(u,i){return u.x===i.x&&u.y===i.y}function YT(u,i,l,h){const g=Dd(To(u,i,l)),x=Dd(To(u,i,h)),b=Dd(To(l,h,u)),j=Dd(To(l,h,i));return g!==x&&b!==j||!(g!==0||!z_(u,l,i))||!(x!==0||!z_(u,h,i))||!(b!==0||!z_(l,u,h))||!(j!==0||!z_(l,i,h))}function z_(u,i,l){return i.x<=Math.max(u.x,l.x)&&i.x>=Math.min(u.x,l.x)&&i.y<=Math.max(u.y,l.y)&&i.y>=Math.min(u.y,l.y)}function Dd(u){return u>0?1:u<0?-1:0}function Ay(u,i){return To(u.prev,u,u.next)<0?To(u,i,u.next)>=0&&To(u,u.prev,i)>=0:To(u,i,u.prev)<0||To(u,u.next,i)<0}function F_(u,i){const l=cx(u.i,u.x,u.y),h=cx(i.i,i.x,i.y),g=u.next,x=i.prev;return u.next=i,i.prev=u,l.next=g,g.prev=l,h.next=l,l.prev=h,x.next=h,h.prev=x,h}function KT(u,i,l,h){const g=cx(u,i,l);return h?(g.next=h.next,g.prev=h,h.next.prev=g,h.next=g):(g.prev=g,g.next=g),g}function lx(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function cx(u,i,l){return{i:u,x:i,y:l,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function ux(u,i){const l=u.length;if(l<=1)return[u];const h=[];let g,x;for(let b=0;b<l;b++){const j=Ks(u[b]);j!==0&&(u[b].area=Math.abs(j),x===void 0&&(x=j<0),x===j<0?(g&&h.push(g),g=[u[b]]):g.push(u[b]))}if(g&&h.push(g),i>1)for(let b=0;b<h.length;b++)h[b].length<=i||(il(h[b],i,1,h[b].length-1,kd),h[b]=h[b].slice(0,i));return h}function kd(u,i){return i.area-u.area}function B_(u,i,l=1){if(!u)return null;const h=typeof u=="string"?uo.from(u).getPrimary():u.getPrimary(),g=typeof u=="string"?null:u.getSecondary();for(const x of[h,g]){if(!x)continue;const b=x.id.toString();i.has(b)||i.set(b,[]),x.scaleSelf(l),i.get(b).push(x)}return{primary:h.toString(),secondary:g?g.toString():null}}function U_(u,i,l,h){const g=h.patternDependencies;let x=!1;for(const b of i){const j=b.paint.get(`${u}-pattern`);j.isConstant()||(x=!0),B_(j.constantOr(null),g,l)&&(x=!0)}return x}function V_(u,i,l,h,g,x){const b=x.patternDependencies;for(const j of i){const M=j.paint.get(`${u}-pattern`).value;if(M.kind!=="constant"){let R=M.evaluate({zoom:h},l,{},x.availableImages);R=R&&R.name?R.name:R;const L=B_(R,b,g);if(!L)continue;const{primary:U,secondary:q}=L;U&&(l.patterns[j.id]=[U,q].filter(Boolean))}}return l}class jy{constructor(){this.polygons=new Map}add(i,...l){this.polygons.has(i)?this.polygons.get(i).push(...l):this.polygons.set(i,l)}merge(i){for(const[l,h]of i.polygons)this.add(l,...h)}}class Al{constructor(){this.portals=[]}static evaluate(i){if(i.length===0)return new Al;let l=[];for(const R of i)l.push(...R.portals);if(l.length===0)return new Al;const h=(R,L)=>R<=0&&L<=0||R>=mn&&L>=mn;for(const R of l){const L=R.va,U=R.vb;(h(L.x,U.x)||h(L.y,U.y))&&(R.type="border")}const g=l.filter((R=>R.type!=="unevaluated")),x=l.filter((R=>R.type==="unevaluated"));if(x.length===0)return new Al;x.sort(((R,L)=>R.hash===L.hash?R.isTunnel===L.isTunnel?0:R.isTunnel?-1:1:R.hash<L.hash?1:-1)),l=g.concat(x);let b=g.length,j=b,M=b;do if(j++,j===l.length||l[b].hash!==l[j].hash){if(j-b==2){M<b&&(l[M]=l[b],l[b]=null);const R=l[M],L=l[j-1];R.type=R.isTunnel!==L.isTunnel?"tunnel":"polygon",R.connection={a:R.connection.a,b:L.connection.a},M++}b=j}while(b!==l.length);return l.splice(M),l.sort(((R,L)=>R.hash<L.hash?1:-1)),{portals:l}}}Hn(Al,"ElevationPortalGraph"),Hn(jy,"ElevationPolygons");class JT{constructor(i,l,h){this.outPositions=i,this.outNormals=l,this.outIndices=h,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(i,l,h){let g=i[2];h!=null&&(g*=h);const x=this.getVec3Bits(i)<<96n|this.getVec3Bits(l),b=this.vertexLookup.get(x);if(b!=null)return b;const j=this.outPositions.length;this.vertexLookup.set(x,j);const M=Math.trunc(16384*l[0]),R=Math.trunc(16384*l[1]),L=Math.trunc(16384*l[2]);return this.outPositions.emplaceBack(i[0],i[1],g),this.outNormals.emplaceBack(M,R,L),j}addTriangle(i,l,h){this.outIndices.emplaceBack(i,l,h)}addTriangles(i,l,h){if(i.length===0)return;const g=h.length===1,x=Re(),b=Re();for(let j=0;j<i.length;j+=3){const M=l[i[j+0]],R=l[i[j+1]],L=l[i[j+2]],U=g?h[0]:h[i[j+1]],q=g?h[0]:h[i[j+2]];rt(x,M.x,M.y,g?h[0]:h[i[j+0]]);const ee=this.addVertex(x,b);rt(x,R.x,R.y,U);const te=this.addVertex(x,b);rt(x,L.x,L.y,q);const le=this.addVertex(x,b);this.outIndices.emplaceBack(ee,te,le)}}addQuad(i,l,h,g,x,b){const j=this.addVertex(i,x,b),M=this.addVertex(l,x,b),R=this.addVertex(h,x,b),L=this.addVertex(g,x,b);this.addTriangle(j,M,R),this.addTriangle(R,L,j)}getVertexCount(){return this.outPositions.length}clearVertexLookup(){this.vertexLookup.clear()}getBits(i){return this.view.setFloat32(0,i),BigInt(this.view.getUint32(0))}getVec3Bits(i){return this.getBits(i[0])<<64n|this.getBits(i[1])<<32n|this.getBits(i[2])}}class jl{constructor(i,l,h,g){this.unevaluatedPortals=new Al,this.portalPolygons=new jy,this.bridgeFeatureSections=[],this.tunnelFeatureSections=[],this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new uy,this.vertexNormals=new Gv,this.indexArray=new ki,this.tileToMeters=qe(i),this.bridgeProgramConfigurations=new Ul(l,{zoom:h,lut:g},(x=>x!=="fill-tunnel-structure-color")),this.tunnelProgramConfigurations=new Ul(l,{zoom:h,lut:g},(x=>x!=="fill-bridge-guard-rail-color"))}addVertices(i,l){const h=this.unevalVertices.length;for(let g=0;g<i.length;g++)this.unevalVertices.push(i[g]),this.unevalHeights.push(l[g]);return h}addTriangles(i,l,h){const g=h?this.unevalTunnelTriangles:this.unevalTriangles;for(const x of i)g.push(x+l)}addRenderableRing(i,l,h,g,x,b){const j=[new Rt(x.min.x,x.min.y),new Rt(x.max.x,x.min.y),new Rt(x.max.x,x.max.y),new Rt(x.min.x,x.max.y)];for(let M=0;M<h-1;M++){const R=l+M,L=R+1,U=this.unevalVertices[R],q=this.unevalVertices[L];if(!(U.x>=x.min.x&&U.x<=x.max.x&&U.y>=x.min.y&&U.y<=x.max.y||q.x>=x.min.x&&q.x<=x.max.x&&q.y>=x.min.y&&q.y<=x.max.y||ia(U,q,j))||this.isOnBorder(U.x,q.x)||this.isOnBorder(U.y,q.y))continue;const ee=jl.computeEdgeHash(this.unevalVertices[R],this.unevalVertices[L]);let te,le=this.vertexHashLookup.get(jl.computePosHash(U));le!=null?te=le.next:(le=this.vertexHashLookup.get(jl.computePosHash(q)),te=le!=null?le.prev:ee),this.unevalEdges.push({polygonIdx:i,a:R,b:L,hash:ee,portalHash:te,isTunnel:g,type:"unevaluated",featureInfo:b})}}addPortalCandidates(i,l,h,g,x){if(l.length===0)return;this.portalPolygons.add(i,{geometry:l,zLevel:x});const b=l[0];this.vertexHashLookup.clear();let j=jl.computeEdgeHash(b[b.length-2],b[b.length-1]);for(let M=0;M<b.length-1;M++){const R=b[M+0],L=b[M+1],U=Xn(L.x-R.x,L.y-R.y),q=Hi(U);if(q===0)continue;let ee="unevaluated";const te=g.pointElevation(R),le=g.pointElevation(L);Math.abs(te)<.01&&Math.abs(le)<.01?ee="entrance":(this.isOnBorder(R.x,L.x)||this.isOnBorder(R.y,L.y))&&(ee="border");const ue=jl.computeEdgeHash(R,L);this.unevaluatedPortals.portals.push({connection:{a:i,b:void 0},va:R,vb:L,vab:U,length:q,hash:ue,isTunnel:h,type:ee});const ge=jl.computePosHash(R);this.vertexHashLookup.set(ge,{prev:j,next:ue}),j=ue}}construct(i){if(this.unevalVertices.length===0)return;const l=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),h=q=>{q.primitiveLength=this.indexArray.length-q.primitiveOffset},g=new JT(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(i.portals,this.unevalEdges);const x=l(),b=l(),j=l(),M=(q,ee)=>{q.sort(((le,ue)=>le.type===ee&&ue.type!==ee?-1:le.type!==ee&&ue.type===ee?1:0));const te=q.findIndex((le=>le.type!==ee));return te>=0?te:q.length};let R=0;this.unevalEdges.length>0&&(R=M(this.unevalEdges,"none"),this.constructBridgeStructures(g,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:R},this.tileToMeters)),h(j);const L=l(),U=l();if(this.unevalEdges.length>0){const q=this.unevalEdges.splice(R),ee=M(q,"tunnel")+R;this.unevalEdges.push(...q),this.constructTunnelStructures(g,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:R},{min:R,max:ee})}h(L),g.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),h(U),g.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),h(b),g.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),h(x),this.maskSegments=Hs.simpleSegment(0,U.primitiveOffset,0,U.primitiveLength),this.depthSegments=Hs.simpleSegment(0,b.primitiveOffset,0,b.primitiveLength),this.renderableBridgeSegments=Hs.simpleSegment(0,j.primitiveOffset,0,j.primitiveLength),this.renderableTunnelSegments=Hs.simpleSegment(0,L.primitiveOffset,0,L.primitiveLength),this.shadowCasterSegments=Hs.simpleSegment(0,x.primitiveOffset,0,x.primitiveLength)}update(i,l,h,g,x,b,j,M){this.bridgeProgramConfigurations.updatePaintArrays(i,l,x,h,g,b,j,M),this.tunnelProgramConfigurations.updatePaintArrays(i,l,x,h,g,b,j,M)}upload(i){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=i.createVertexBuffer(this.vertexPositions,dN.members),this.vertexBufferNormal=i.createVertexBuffer(this.vertexNormals,hN.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.bridgeProgramConfigurations.upload(i),this.tunnelProgramConfigurations.upload(i))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableBridgeSegments.destroy(),this.renderableTunnelSegments.destroy(),this.shadowCasterSegments.destroy()),this.bridgeProgramConfigurations.destroy(),this.tunnelProgramConfigurations.destroy()}populatePaintArrays(i,l,h,g,x){const b=(j,M)=>{for(let R=0;R<M.length-1;R++){const L=M[R].featureIndex,U=M[R+1].vertexStart,q=i.feature(L);j.populatePaintArrays(U,q,L,{},h,l,g,void 0,x)}};b(this.bridgeProgramConfigurations,this.bridgeFeatureSections),b(this.tunnelProgramConfigurations,this.tunnelFeatureSections)}computeVertexConnections(i,l,h,g,x){const b=new Map;for(let j=g;j<x;j++){const M=h[j],R=M.a,L=M.b,U=jl.computePosHash(i[R]),q=jl.computePosHash(i[L]);let ee=b.get(U);ee||(ee={},b.set(U,ee));let te=b.get(q);te||(te={},b.set(q,te)),l[R]<=0&&l[L]<=0||(ee.to=L,te.from=R)}return b}isTerminalVertex(i,l){const h=jl.computePosHash(this.unevalVertices[i]),g=l.get(h);return!g||!g.from||!g.to}constructBridgeStructures(i,l,h,g,x,b){i.clearVertexLookup();const j=this.computeVertexConnections(l,h,g,x.min,x.max),M=1/b,R=.5*M,L=(dn,xn)=>rt(dn,l[xn].x,l[xn].y,h[xn]*M),U=Re(),q=Re(),ee=Re(),te=Re(),le=Re(),ue=(dn,xn)=>{const Lt=j.get(jl.computePosHash(l[xn])),hn=Lt.from,Tt=Lt.to;if(!hn||!Tt)return;L(U,hn),L(q,xn),L(ee,Tt),zr(te),or(U,q)||(Rr(le,q,U),Ot(te,le)),or(ee,q)||(Rr(le,ee,q),Ee(te,te,Ot(le,le)));const zt=Nn(te);return zt>0?pt(dn,te,1/zt):void 0};let ge=Number.POSITIVE_INFINITY;this.sortSubarray(g,x.min,x.max,((dn,xn)=>dn.featureInfo.featureIndex-xn.featureInfo.featureIndex));const Se=Re(),we=Re(),Pe=Re(),tt=Re(),Ke=Re(),Qe=Re(),dt=Re(),ft=Re(),Ft=Re(),xt=[Re(),Re(),Re(),Re()],Wt=[Re(),Re(),Re(),Re()],bn=[{coord:new Rt(0,0),height:0},{coord:new Rt(0,0),height:0}],tn=(dn,xn)=>dn>xn;for(let dn=x.min;dn<x.max;dn++){const xn=g[dn];if(!xn.featureInfo.guardRailEnabled||!this.prepareEdgePoints(bn,l,h,xn,tn))continue;const[Lt,hn]=bn;if(rt(Se,Lt.coord.x,Lt.coord.y,M*Lt.height),rt(we,hn.coord.x,hn.coord.y,M*hn.height),or(Se,we))continue;Rr(Pe,we,Se),Ot(Pe,Pe);const Tt=ue(ft,xn.a)||Pe,zt=ue(Ft,xn.b)||Pe;rt(tt,Tt[1],-Tt[0],0),Ot(tt,tt),rt(Ke,zt[1],-zt[0],0),Ot(Ke,Ke),an(ft,tt,Tt),Ot(Qe,ft),an(ft,Ke,zt),Ot(dt,ft),Ee(xt[0],Se,pt(ft,Rr(ft,tt,Qe),R)),Ee(xt[1],Se,pt(ft,Ee(ft,tt,Qe),R)),Ee(xt[2],Se,pt(ft,Qe,R)),xt[3]=Se,Ee(Wt[0],we,pt(ft,Rr(ft,Ke,dt),R)),Ee(Wt[1],we,pt(ft,Ee(ft,Ke,dt),R)),Ee(Wt[2],we,pt(ft,dt,R)),Wt[3]=we,ge=this.addFeatureSection(xn.featureInfo.featureIndex,ge,this.bridgeFeatureSections,i);const wn=i.addVertex(xt[0],tt,b),pn=i.addVertex(xt[1],tt,b),ur=i.addVertex(Wt[0],Ke,b),Jn=i.addVertex(Wt[1],Ke,b);i.addTriangle(wn,pn,ur),i.addTriangle(pn,Jn,ur);const cn=i.addVertex(xt[1],Qe,b),yn=i.addVertex(xt[2],Qe,b),er=i.addVertex(Wt[1],dt,b),Bn=i.addVertex(Wt[2],dt,b);i.addTriangle(cn,yn,er),i.addTriangle(yn,Bn,er),Pt(tt,tt),Pt(Ke,Ke);const En=i.addVertex(xt[2],tt,b),$n=i.addVertex(xt[3],tt,b),Cr=i.addVertex(Wt[2],Ke,b),kr=i.addVertex(Wt[3],Ke,b);i.addTriangle(En,$n,Cr),i.addTriangle($n,kr,Cr);const si=this.isTerminalVertex(xn.a,j),Hr=this.isTerminalVertex(xn.b,j);Lt.height<.01&&si&&i.addQuad(xt[3],xt[2],xt[1],xt[0],Pt(Tt,Tt),b),hn.height<.01&&Hr&&i.addQuad(Wt[0],Wt[1],Wt[2],Wt[3],zt,b)}this.bridgeFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:i.getVertexCount()})}constructTunnelStructures(i,l,h,g,x,b){i.clearVertexLookup();let j=Number.POSITIVE_INFINITY;const M=(ge,Se)=>ge.featureInfo.featureIndex-Se.featureInfo.featureIndex;this.sortSubarray(g,x.min,x.max,M),this.sortSubarray(g,b.min,b.max,M);const R=ge=>Ot(ge,ge),L=[{coord:new Rt(0,0),height:0},{coord:new Rt(0,0),height:0}],U=(ge,Se)=>ge<Se,q=Re(),ee=Re(),te=Re(),le=Re(),ue=Re();for(let ge=x.min;ge<x.max;ge++){if(!this.prepareEdgePoints(L,l,h,g[ge],U))continue;const[Se,we]=L,Pe=R(rt(ue,-(we.coord.y-Se.coord.y),we.coord.x-Se.coord.x,0));j=this.addFeatureSection(g[ge].featureInfo.featureIndex,j,this.tunnelFeatureSections,i),i.addQuad(rt(q,Se.coord.x,Se.coord.y,Se.height),rt(ee,we.coord.x,we.coord.y,we.height),rt(te,we.coord.x,we.coord.y,g[ge].isTunnel?-.1:0),rt(le,Se.coord.x,Se.coord.y,g[ge].isTunnel?-.1:0),Pe)}for(let ge=b.min;ge<b.max;ge++){const Se=g[ge];Se.isTunnel&&([Se.a,Se.b]=[Se.b,Se.a]);const we=l[Se.a],Pe=l[Se.b],tt=R(rt(ue,-(Pe.y-we.y),Pe.x-we.x,0));j=this.addFeatureSection(Se.featureInfo.featureIndex,j,this.tunnelFeatureSections,i),i.addQuad(rt(q,Pe.x,Pe.y,0),rt(ee,we.x,we.y,0),rt(te,we.x,we.y,h[Se.a]+4),rt(le,Pe.x,Pe.y,h[Se.b]+4),tt),i.addQuad(rt(q,we.x,we.y,0),rt(ee,Pe.x,Pe.y,0),rt(te,Pe.x,Pe.y,h[Se.b]+4),rt(le,we.x,we.y,h[Se.a]+4),tt)}this.tunnelFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:i.getVertexCount()})}setElevatedPoint(i,l,h,g){i.coord.x=l,i.coord.y=h,i.height=g}prepareEdgePoints(i,l,h,g,x){let b=l[g.a].x,j=l[g.a].y,M=l[g.b].x,R=l[g.b].y,L=h[g.a],U=h[g.b];const q=x(L,0),ee=x(U,0);if(q&&ee)return this.setElevatedPoint(i[0],b,j,L),this.setElevatedPoint(i[1],M,R,U),!0;if(!q&&!ee)return!1;if(q){if(!ee){const te=U/(U-L);M=yr(M,b,te),R=yr(R,j,te),U=yr(U,L,te)}}else{const te=L/(L-U);b=yr(b,M,te),j=yr(j,R,te),L=yr(L,U,te)}return this.setElevatedPoint(i[0],b,j,L),this.setElevatedPoint(i[1],M,R,U),!0}prepareEdges(i,l){if(l.length===0)return;l.sort(((j,M)=>j.hash===M.hash?M.polygonIdx-j.polygonIdx:M.hash>j.hash?1:-1));let h=0,g=0,x=0,b=l[h].polygonIdx;do g++,(g===l.length||l[h].hash!==l[g].hash)&&((g-h==1||l[g-1].polygonIdx!==b)&&(x<h&&(l[x]=l[h],l[h]=null),l[x].type="none",x++),h=g,h!==l.length&&(b=l[h].polygonIdx));while(h!==l.length);if(l.splice(x),l.length!==0&&i.length!==0){l.sort(((R,L)=>R.portalHash<L.portalHash?1:-1));let j=0,M=0;for(;j!==l.length&&M!==i.length;){const R=l[j],L=i[M];R.portalHash>L.hash?j++:L.hash>R.portalHash?M++:(R.type=L.type,j++)}}}isOnBorder(i,l){return i<=0&&l<=0||i>=mn&&l>=mn}addFeatureSection(i,l,h,g){return i!==l&&(l=i,h.push({featureIndex:i,vertexStart:g.getVertexCount()}),g.clearVertexLookup()),l}sortSubarray(i,l,h,g){const x=i.slice(l,h);x.sort(g),i.splice(l,x.length,...x)}static computeEdgeHash(i,l){return(i.y===l.y&&i.x>l.x||i.y>l.y)&&([i,l]=[l,i]),BigInt(jl.computePosHash(i))<<32n|BigInt(jl.computePosHash(l))}static computePosHash(i){return((65535&i.x)<<16|65535&i.y)>>>0}}var Eh,QT={exports:{}},e2=(Eh||(Eh=1,(function(u,i){(function(l){function h(Ie,Le){return Ie>Le?1:Ie<Le?-1:0}var g=function(Ie,Le){Ie===void 0&&(Ie=h),Le===void 0&&(Le=!1),this._compare=Ie,this._root=null,this._size=0,this._noDuplicates=!!Le},x={size:{configurable:!0}};function b(Ie,Le,It,Sn,kn){var Dn=kn-Sn;if(Dn>0){var Qn=Sn+Math.floor(Dn/2),Or={key:Le[Qn],data:It[Qn],parent:Ie};return Or.left=b(Or,Le,It,Sn,Qn),Or.right=b(Or,Le,It,Qn+1,kn),Or}return null}function j(Ie,Le,It,Sn,kn){if(!(It>=Sn)){for(var Dn=Ie[It+Sn>>1],Qn=It-1,Or=Sn+1;;){do Qn++;while(kn(Ie[Qn],Dn)<0);do Or--;while(kn(Ie[Or],Dn)>0);if(Qn>=Or)break;var Ci=Ie[Qn];Ie[Qn]=Ie[Or],Ie[Or]=Ci,Ci=Le[Qn],Le[Qn]=Le[Or],Le[Or]=Ci}j(Ie,Le,It,Or,kn),j(Ie,Le,Or+1,Sn,kn)}}g.prototype.rotateLeft=function(Ie){var Le=Ie.right;Le&&(Ie.right=Le.left,Le.left&&(Le.left.parent=Ie),Le.parent=Ie.parent),Ie.parent?Ie===Ie.parent.left?Ie.parent.left=Le:Ie.parent.right=Le:this._root=Le,Le&&(Le.left=Ie),Ie.parent=Le},g.prototype.rotateRight=function(Ie){var Le=Ie.left;Le&&(Ie.left=Le.right,Le.right&&(Le.right.parent=Ie),Le.parent=Ie.parent),Ie.parent?Ie===Ie.parent.left?Ie.parent.left=Le:Ie.parent.right=Le:this._root=Le,Le&&(Le.right=Ie),Ie.parent=Le},g.prototype._splay=function(Ie){for(;Ie.parent;){var Le=Ie.parent;Le.parent?Le.left===Ie&&Le.parent.left===Le?(this.rotateRight(Le.parent),this.rotateRight(Le)):Le.right===Ie&&Le.parent.right===Le?(this.rotateLeft(Le.parent),this.rotateLeft(Le)):Le.left===Ie&&Le.parent.right===Le?(this.rotateRight(Le),this.rotateLeft(Le)):(this.rotateLeft(Le),this.rotateRight(Le)):Le.left===Ie?this.rotateRight(Le):this.rotateLeft(Le)}},g.prototype.splay=function(Ie){for(var Le,It,Sn,kn,Dn;Ie.parent;)(It=(Le=Ie.parent).parent)&&It.parent?((Sn=It.parent).left===It?Sn.left=Ie:Sn.right=Ie,Ie.parent=Sn):(Ie.parent=null,this._root=Ie),kn=Ie.left,Dn=Ie.right,Ie===Le.left?(It&&(It.left===Le?(Le.right?(It.left=Le.right,It.left.parent=It):It.left=null,Le.right=It,It.parent=Le):(kn?(It.right=kn,kn.parent=It):It.right=null,Ie.left=It,It.parent=Ie)),Dn?(Le.left=Dn,Dn.parent=Le):Le.left=null,Ie.right=Le,Le.parent=Ie):(It&&(It.right===Le?(Le.left?(It.right=Le.left,It.right.parent=It):It.right=null,Le.left=It,It.parent=Le):(Dn?(It.left=Dn,Dn.parent=It):It.left=null,Ie.right=It,It.parent=Ie)),kn?(Le.right=kn,kn.parent=Le):Le.right=null,Ie.left=Le,Le.parent=Ie)},g.prototype.replace=function(Ie,Le){Ie.parent?Ie===Ie.parent.left?Ie.parent.left=Le:Ie.parent.right=Le:this._root=Le,Le&&(Le.parent=Ie.parent)},g.prototype.minNode=function(Ie){if(Ie===void 0&&(Ie=this._root),Ie)for(;Ie.left;)Ie=Ie.left;return Ie},g.prototype.maxNode=function(Ie){if(Ie===void 0&&(Ie=this._root),Ie)for(;Ie.right;)Ie=Ie.right;return Ie},g.prototype.insert=function(Ie,Le){var It=this._root,Sn=null,kn=this._compare;if(this._noDuplicates)for(;It;){if(Sn=It,kn(It.key,Ie)===0)return;It=kn(It.key,Ie)<0?It.right:It.left}else for(;It;)Sn=It,It=kn(It.key,Ie)<0?It.right:It.left;return It={key:Ie,data:Le,left:null,right:null,parent:Sn},Sn?kn(Sn.key,It.key)<0?Sn.right=It:Sn.left=It:this._root=It,this.splay(It),this._size++,It},g.prototype.find=function(Ie){for(var Le=this._root,It=this._compare;Le;){var Sn=It(Le.key,Ie);if(Sn<0)Le=Le.right;else{if(!(Sn>0))return Le;Le=Le.left}}return null},g.prototype.contains=function(Ie){for(var Le=this._root,It=this._compare;Le;){var Sn=It(Ie,Le.key);if(Sn===0)return!0;Le=Sn<0?Le.left:Le.right}return!1},g.prototype.remove=function(Ie){var Le=this.find(Ie);if(!Le)return!1;if(this.splay(Le),Le.left)if(Le.right){var It=this.minNode(Le.right);It.parent!==Le&&(this.replace(It,It.right),It.right=Le.right,It.right.parent=It),this.replace(Le,It),It.left=Le.left,It.left.parent=It}else this.replace(Le,Le.left);else this.replace(Le,Le.right);return this._size--,!0},g.prototype.removeNode=function(Ie){if(!Ie)return!1;if(this.splay(Ie),Ie.left)if(Ie.right){var Le=this.minNode(Ie.right);Le.parent!==Ie&&(this.replace(Le,Le.right),Le.right=Ie.right,Le.right.parent=Le),this.replace(Ie,Le),Le.left=Ie.left,Le.left.parent=Le}else this.replace(Ie,Ie.left);else this.replace(Ie,Ie.right);return this._size--,!0},g.prototype.erase=function(Ie){var Le=this.find(Ie);if(Le){this.splay(Le);var It=Le.left,Sn=Le.right,kn=null;It&&(It.parent=null,kn=this.maxNode(It),this.splay(kn),this._root=kn),Sn&&(It?kn.right=Sn:this._root=Sn,Sn.parent=kn),this._size--}},g.prototype.pop=function(){var Ie=this._root,Le=null;if(Ie){for(;Ie.left;)Ie=Ie.left;Le={key:Ie.key,data:Ie.data},this.remove(Ie.key)}return Le},g.prototype.next=function(Ie){var Le=Ie;if(Le)if(Le.right)for(Le=Le.right;Le&&Le.left;)Le=Le.left;else for(Le=Ie.parent;Le&&Le.right===Ie;)Ie=Le,Le=Le.parent;return Le},g.prototype.prev=function(Ie){var Le=Ie;if(Le)if(Le.left)for(Le=Le.left;Le&&Le.right;)Le=Le.right;else for(Le=Ie.parent;Le&&Le.left===Ie;)Ie=Le,Le=Le.parent;return Le},g.prototype.forEach=function(Ie){for(var Le=this._root,It=[],Sn=!1,kn=0;!Sn;)Le?(It.push(Le),Le=Le.left):It.length>0?(Ie(Le=It.pop(),kn++),Le=Le.right):Sn=!0;return this},g.prototype.range=function(Ie,Le,It,Sn){for(var kn=[],Dn=this._compare,Qn=this._root;kn.length!==0||Qn;)if(Qn)kn.push(Qn),Qn=Qn.left;else{if(Dn((Qn=kn.pop()).key,Le)>0)break;if(Dn(Qn.key,Ie)>=0&&It.call(Sn,Qn))return this;Qn=Qn.right}return this},g.prototype.keys=function(){for(var Ie=this._root,Le=[],It=[],Sn=!1;!Sn;)Ie?(Le.push(Ie),Ie=Ie.left):Le.length>0?(Ie=Le.pop(),It.push(Ie.key),Ie=Ie.right):Sn=!0;return It},g.prototype.values=function(){for(var Ie=this._root,Le=[],It=[],Sn=!1;!Sn;)Ie?(Le.push(Ie),Ie=Ie.left):Le.length>0?(Ie=Le.pop(),It.push(Ie.data),Ie=Ie.right):Sn=!0;return It},g.prototype.at=function(Ie){for(var Le=this._root,It=[],Sn=!1,kn=0;!Sn;)if(Le)It.push(Le),Le=Le.left;else if(It.length>0){if(Le=It.pop(),kn===Ie)return Le;kn++,Le=Le.right}else Sn=!0;return null},g.prototype.load=function(Ie,Le,It){if(Ie===void 0&&(Ie=[]),Le===void 0&&(Le=[]),It===void 0&&(It=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var Sn=Ie.length;return It&&j(Ie,Le,0,Sn-1,this._compare),this._root=b(null,Ie,Le,0,Sn),this._size=Sn,this},g.prototype.min=function(){var Ie=this.minNode(this._root);return Ie?Ie.key:null},g.prototype.max=function(){var Ie=this.maxNode(this._root);return Ie?Ie.key:null},g.prototype.isEmpty=function(){return this._root===null},x.size.get=function(){return this._size},g.createTree=function(Ie,Le,It,Sn,kn){return new g(It,kn).load(Ie,Le,Sn)},Object.defineProperties(g.prototype,x);var M=0,R=1,L=2,U=3,q=0,ee=1,te=2,le=3;function ue(Ie,Le,It){Le===null?(Ie.inOut=!1,Ie.otherInOut=!0):(Ie.isSubject===Le.isSubject?(Ie.inOut=!Le.inOut,Ie.otherInOut=Le.otherInOut):(Ie.inOut=!Le.otherInOut,Ie.otherInOut=Le.isVertical()?!Le.inOut:Le.inOut),Le&&(Ie.prevInResult=!ge(Le,It)||Le.isVertical()?Le.prevInResult:Le));var Sn=ge(Ie,It);Ie.resultTransition=Sn?(function(kn,Dn){var Qn,Or=!kn.inOut,Ci=!kn.otherInOut;switch(Dn){case q:Qn=Or&&Ci;break;case ee:Qn=Or||Ci;break;case le:Qn=Or^Ci;break;case te:Qn=kn.isSubject?Or&&!Ci:Ci&&!Or}return Qn?1:-1})(Ie,It):0}function ge(Ie,Le){switch(Ie.type){case M:switch(Le){case q:return!Ie.otherInOut;case ee:return Ie.otherInOut;case te:return Ie.isSubject&&Ie.otherInOut||!Ie.isSubject&&!Ie.otherInOut;case le:return!0}break;case L:return Le===q||Le===ee;case U:return Le===te;case R:return!1}return!1}var Se=function(Ie,Le,It,Sn,kn){this.left=Le,this.point=Ie,this.otherEvent=It,this.isSubject=Sn,this.type=kn||M,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},we={inResult:{configurable:!0}};function Pe(Ie,Le){return Ie[0]===Le[0]&&Ie[1]===Le[1]}Se.prototype.isBelow=function(Ie){var Le=this.point,It=this.otherEvent.point;return this.left?(Le[0]-Ie[0])*(It[1]-Ie[1])-(It[0]-Ie[0])*(Le[1]-Ie[1])>0:(It[0]-Ie[0])*(Le[1]-Ie[1])-(Le[0]-Ie[0])*(It[1]-Ie[1])>0},Se.prototype.isAbove=function(Ie){return!this.isBelow(Ie)},Se.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},we.inResult.get=function(){return this.resultTransition!==0},Se.prototype.clone=function(){var Ie=new Se(this.point,this.left,this.otherEvent,this.isSubject,this.type);return Ie.contourId=this.contourId,Ie.resultTransition=this.resultTransition,Ie.prevInResult=this.prevInResult,Ie.isExteriorRing=this.isExteriorRing,Ie.inOut=this.inOut,Ie.otherInOut=this.otherInOut,Ie},Object.defineProperties(Se.prototype,we);var tt=11102230246251565e-32,Ke=134217729,Qe=(3+8*tt)*tt;function dt(Ie,Le,It,Sn,kn){var Dn,Qn,Or,Ci,Ni=Le[0],hi=Sn[0],Es=0,va=0;hi>Ni==hi>-Ni?(Dn=Ni,Ni=Le[++Es]):(Dn=hi,hi=Sn[++va]);var li=0;if(Es<Ie&&va<It)for(hi>Ni==hi>-Ni?(Or=Dn-((Qn=Ni+Dn)-Ni),Ni=Le[++Es]):(Or=Dn-((Qn=hi+Dn)-hi),hi=Sn[++va]),Dn=Qn,Or!==0&&(kn[li++]=Or);Es<Ie&&va<It;)hi>Ni==hi>-Ni?(Or=Dn-((Qn=Dn+Ni)-(Ci=Qn-Dn))+(Ni-Ci),Ni=Le[++Es]):(Or=Dn-((Qn=Dn+hi)-(Ci=Qn-Dn))+(hi-Ci),hi=Sn[++va]),Dn=Qn,Or!==0&&(kn[li++]=Or);for(;Es<Ie;)Or=Dn-((Qn=Dn+Ni)-(Ci=Qn-Dn))+(Ni-Ci),Ni=Le[++Es],Dn=Qn,Or!==0&&(kn[li++]=Or);for(;va<It;)Or=Dn-((Qn=Dn+hi)-(Ci=Qn-Dn))+(hi-Ci),hi=Sn[++va],Dn=Qn,Or!==0&&(kn[li++]=Or);return Dn===0&&li!==0||(kn[li++]=Dn),li}function ft(Ie){return new Float64Array(Ie)}var Ft=33306690738754716e-32,xt=22204460492503146e-32,Wt=11093356479670487e-47,bn=ft(4),tn=ft(8),dn=ft(12),xn=ft(16),Lt=ft(4);function hn(Ie,Le,It){var Sn=(function(kn,Dn,Qn,Or,Ci,Ni){var hi=(Dn-Ni)*(Qn-Ci),Es=(kn-Ci)*(Or-Ni),va=hi-Es;if(hi===0||Es===0||hi>0!=Es>0)return va;var li=Math.abs(hi+Es);return Math.abs(va)>=Ft*li?va:-(function(Qs,Ds,ps,da,Ws,ks,zs){var _s,fi,Cs,ha,Mr,Zi,Xs,Sa,ea,yo,Ps,ao,Xc,El,ul,Zc,Fp,vo,Do=Qs-Ws,Cl=ps-Ws,oc=Ds-ks,ql=da-ks;bn[0]=(ul=(Sa=Do-(Xs=(Zi=Ke*Do)-(Zi-Do)))*(yo=ql-(ea=(Zi=Ke*ql)-(Zi-ql)))-((El=Do*ql)-Xs*ea-Sa*ea-Xs*yo))-((Ps=ul-(Fp=(Sa=oc-(Xs=(Zi=Ke*oc)-(Zi-oc)))*(yo=Cl-(ea=(Zi=Ke*Cl)-(Zi-Cl)))-((Zc=oc*Cl)-Xs*ea-Sa*ea-Xs*yo)))+(Mr=ul-Ps))+(Mr-Fp),bn[1]=(Xc=El-((ao=El+Ps)-(Mr=ao-El))+(Ps-Mr))-((Ps=Xc-Zc)+(Mr=Xc-Ps))+(Mr-Zc),bn[2]=ao-((vo=ao+Ps)-(Mr=vo-ao))+(Ps-Mr),bn[3]=vo;var Ly=(function(WVe,b5){for(var w5=b5[0],oP=1;oP<4;oP++)w5+=b5[oP];return w5})(0,bn),i1=xt*zs;if(Ly>=i1||-Ly>=i1||(_s=Qs-(Do+(Mr=Qs-Do))+(Mr-Ws),Cs=ps-(Cl+(Mr=ps-Cl))+(Mr-Ws),fi=Ds-(oc+(Mr=Ds-oc))+(Mr-ks),ha=da-(ql+(Mr=da-ql))+(Mr-ks),_s===0&&fi===0&&Cs===0&&ha===0)||(i1=Wt*zs+Qe*Math.abs(Ly),(Ly+=Do*ha+ql*_s-(oc*Cs+Cl*fi))>=i1||-Ly>=i1))return Ly;Lt[0]=(ul=(Sa=_s-(Xs=(Zi=Ke*_s)-(Zi-_s)))*(yo=ql-(ea=(Zi=Ke*ql)-(Zi-ql)))-((El=_s*ql)-Xs*ea-Sa*ea-Xs*yo))-((Ps=ul-(Fp=(Sa=fi-(Xs=(Zi=Ke*fi)-(Zi-fi)))*(yo=Cl-(ea=(Zi=Ke*Cl)-(Zi-Cl)))-((Zc=fi*Cl)-Xs*ea-Sa*ea-Xs*yo)))+(Mr=ul-Ps))+(Mr-Fp),Lt[1]=(Xc=El-((ao=El+Ps)-(Mr=ao-El))+(Ps-Mr))-((Ps=Xc-Zc)+(Mr=Xc-Ps))+(Mr-Zc),Lt[2]=ao-((vo=ao+Ps)-(Mr=vo-ao))+(Ps-Mr),Lt[3]=vo;var kae=dt(4,bn,4,Lt,tn);Lt[0]=(ul=(Sa=Do-(Xs=(Zi=Ke*Do)-(Zi-Do)))*(yo=ha-(ea=(Zi=Ke*ha)-(Zi-ha)))-((El=Do*ha)-Xs*ea-Sa*ea-Xs*yo))-((Ps=ul-(Fp=(Sa=oc-(Xs=(Zi=Ke*oc)-(Zi-oc)))*(yo=Cs-(ea=(Zi=Ke*Cs)-(Zi-Cs)))-((Zc=oc*Cs)-Xs*ea-Sa*ea-Xs*yo)))+(Mr=ul-Ps))+(Mr-Fp),Lt[1]=(Xc=El-((ao=El+Ps)-(Mr=ao-El))+(Ps-Mr))-((Ps=Xc-Zc)+(Mr=Xc-Ps))+(Mr-Zc),Lt[2]=ao-((vo=ao+Ps)-(Mr=vo-ao))+(Ps-Mr),Lt[3]=vo;var Iae=dt(kae,tn,4,Lt,dn);Lt[0]=(ul=(Sa=_s-(Xs=(Zi=Ke*_s)-(Zi-_s)))*(yo=ha-(ea=(Zi=Ke*ha)-(Zi-ha)))-((El=_s*ha)-Xs*ea-Sa*ea-Xs*yo))-((Ps=ul-(Fp=(Sa=fi-(Xs=(Zi=Ke*fi)-(Zi-fi)))*(yo=Cs-(ea=(Zi=Ke*Cs)-(Zi-Cs)))-((Zc=fi*Cs)-Xs*ea-Sa*ea-Xs*yo)))+(Mr=ul-Ps))+(Mr-Fp),Lt[1]=(Xc=El-((ao=El+Ps)-(Mr=ao-El))+(Ps-Mr))-((Ps=Xc-Zc)+(Mr=Xc-Ps))+(Mr-Zc),Lt[2]=ao-((vo=ao+Ps)-(Mr=vo-ao))+(Ps-Mr),Lt[3]=vo;var Lae=dt(Iae,dn,4,Lt,xn);return xn[Lae-1]})(kn,Dn,Qn,Or,Ci,Ni,li)})(Ie[0],Ie[1],Le[0],Le[1],It[0],It[1]);return Sn>0?-1:Sn<0?1:0}function Tt(Ie,Le){var It=Ie.point,Sn=Le.point;return It[0]>Sn[0]?1:It[0]<Sn[0]?-1:It[1]!==Sn[1]?It[1]>Sn[1]?1:-1:(function(kn,Dn,Qn,Or){return kn.left!==Dn.left?kn.left?1:-1:hn(Qn,kn.otherEvent.point,Dn.otherEvent.point)!==0?kn.isBelow(Dn.otherEvent.point)?-1:1:!kn.isSubject&&Dn.isSubject?1:-1})(Ie,Le,It)}function zt(Ie,Le,It){var Sn=new Se(Le,!1,Ie,Ie.isSubject),kn=new Se(Le,!0,Ie.otherEvent,Ie.isSubject);return Pe(Ie.point,Ie.otherEvent.point)&&console.warn("what is that, a collapsed segment?",Ie),Sn.contourId=kn.contourId=Ie.contourId,Tt(kn,Ie.otherEvent)>0&&(Ie.otherEvent.left=!0,kn.left=!1),Ie.otherEvent.otherEvent=kn,Ie.otherEvent=Sn,It.push(kn),It.push(Sn),It}function wn(Ie,Le){return Ie[0]*Le[1]-Ie[1]*Le[0]}function pn(Ie,Le){return Ie[0]*Le[0]+Ie[1]*Le[1]}function ur(Ie,Le,It){var Sn=(function(Ci,Ni,hi,Es,va){var li=[Ni[0]-Ci[0],Ni[1]-Ci[1]],Qs=[Es[0]-hi[0],Es[1]-hi[1]];function Ds(Zi,Xs,Sa){return[Zi[0]+Xs*Sa[0],Zi[1]+Xs*Sa[1]]}var ps=[hi[0]-Ci[0],hi[1]-Ci[1]],da=wn(li,Qs),Ws=da*da,ks=pn(li,li);if(Ws>0){var zs=wn(ps,Qs)/da;if(zs<0||zs>1)return null;var _s=wn(ps,li)/da;return _s<0||_s>1?null:zs===0||zs===1?[Ds(Ci,zs,li)]:_s===0||_s===1?[Ds(hi,_s,Qs)]:[Ds(Ci,zs,li)]}if((Ws=(da=wn(ps,li))*da)>0)return null;var fi=pn(li,ps)/ks,Cs=fi+pn(li,Qs)/ks,ha=Math.min(fi,Cs),Mr=Math.max(fi,Cs);return ha<=1&&Mr>=0?ha===1?[Ds(Ci,ha>0?ha:0,li)]:Mr===0?[Ds(Ci,Mr<1?Mr:1,li)]:[Ds(Ci,ha>0?ha:0,li),Ds(Ci,Mr<1?Mr:1,li)]:null})(Ie.point,Ie.otherEvent.point,Le.point,Le.otherEvent.point),kn=Sn?Sn.length:0;if(kn===0||kn===1&&(Pe(Ie.point,Le.point)||Pe(Ie.otherEvent.point,Le.otherEvent.point))||kn===2&&Ie.isSubject===Le.isSubject)return 0;if(kn===1)return Pe(Ie.point,Sn[0])||Pe(Ie.otherEvent.point,Sn[0])||zt(Ie,Sn[0],It),Pe(Le.point,Sn[0])||Pe(Le.otherEvent.point,Sn[0])||zt(Le,Sn[0],It),1;var Dn=[],Qn=!1,Or=!1;return Pe(Ie.point,Le.point)?Qn=!0:Tt(Ie,Le)===1?Dn.push(Le,Ie):Dn.push(Ie,Le),Pe(Ie.otherEvent.point,Le.otherEvent.point)?Or=!0:Tt(Ie.otherEvent,Le.otherEvent)===1?Dn.push(Le.otherEvent,Ie.otherEvent):Dn.push(Ie.otherEvent,Le.otherEvent),Qn&&Or||Qn?(Le.type=R,Ie.type=Le.inOut===Ie.inOut?L:U,Qn&&!Or&&zt(Dn[1].otherEvent,Dn[0].point,It),2):Or?(zt(Dn[0],Dn[1].point,It),3):Dn[0]!==Dn[3].otherEvent?(zt(Dn[0],Dn[1].point,It),zt(Dn[1],Dn[2].point,It),3):(zt(Dn[0],Dn[1].point,It),zt(Dn[3].otherEvent,Dn[2].point,It),3)}function Jn(Ie,Le){if(Ie===Le)return 0;if(hn(Ie.point,Ie.otherEvent.point,Le.point)!==0||hn(Ie.point,Ie.otherEvent.point,Le.otherEvent.point)!==0)return Pe(Ie.point,Le.point)?Ie.isBelow(Le.otherEvent.point)?-1:1:Ie.point[0]===Le.point[0]?Ie.point[1]<Le.point[1]?-1:1:Tt(Ie,Le)===1?Le.isAbove(Ie.point)?-1:1:Ie.isBelow(Le.point)?-1:1;if(Ie.isSubject!==Le.isSubject)return Ie.isSubject?-1:1;var It=Ie.point,Sn=Le.point;return It[0]===Sn[0]&&It[1]===Sn[1]?(It=Ie.otherEvent.point)[0]===(Sn=Le.otherEvent.point)[0]&&It[1]===Sn[1]?0:Ie.contourId>Le.contourId?1:-1:Tt(Ie,Le)===1?1:-1}var cn=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function yn(Ie,Le,It,Sn){var kn,Dn=Ie+1,Qn=Le[Ie].point,Or=Le.length;for(Dn<Or&&(kn=Le[Dn].point);Dn<Or&&kn[0]===Qn[0]&&kn[1]===Qn[1];){if(!It[Dn])return Dn;++Dn<Or&&(kn=Le[Dn].point)}for(Dn=Ie-1;It[Dn]&&Dn>Sn;)Dn--;return Dn}cn.prototype.isExterior=function(){return this.holeOf==null};var er=En,Bn=En;function En(Ie,Le){if(!(this instanceof En))return new En(Ie,Le);if(this.data=Ie||[],this.length=this.data.length,this.compare=Le||$n,this.length>0)for(var It=(this.length>>1)-1;It>=0;It--)this._down(It)}function $n(Ie,Le){return Ie<Le?-1:Ie>Le?1:0}En.prototype={push:function(Ie){this.data.push(Ie),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var Ie=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),Ie}},peek:function(){return this.data[0]},_up:function(Ie){for(var Le=this.data,It=this.compare,Sn=Le[Ie];Ie>0;){var kn=Ie-1>>1,Dn=Le[kn];if(It(Sn,Dn)>=0)break;Le[Ie]=Dn,Ie=kn}Le[Ie]=Sn},_down:function(Ie){for(var Le=this.data,It=this.compare,Sn=this.length>>1,kn=Le[Ie];Ie<Sn;){var Dn=1+(Ie<<1),Qn=Dn+1,Or=Le[Dn];if(Qn<this.length&&It(Le[Qn],Or)<0&&(Dn=Qn,Or=Le[Qn]),It(Or,kn)>=0)break;Le[Ie]=Or,Ie=Dn}Le[Ie]=kn}},er.default=Bn;var Cr=Math.max,kr=Math.min,si=0;function Hr(Ie,Le,It,Sn,kn,Dn){var Qn,Or,Ci,Ni,hi,Es;for(Qn=0,Or=Ie.length-1;Qn<Or;Qn++)if(Ni=Ie[Qn+1],hi=new Se(Ci=Ie[Qn],!1,void 0,Le),Es=new Se(Ni,!1,hi,Le),hi.otherEvent=Es,Ci[0]!==Ni[0]||Ci[1]!==Ni[1]){hi.contourId=Es.contourId=It,Dn||(hi.isExteriorRing=!1,Es.isExteriorRing=!1),Tt(hi,Es)>0?Es.left=!0:hi.left=!0;var va=Ci[0],li=Ci[1];kn[0]=kr(kn[0],va),kn[1]=kr(kn[1],li),kn[2]=Cr(kn[2],va),kn[3]=Cr(kn[3],li),Sn.push(hi),Sn.push(Es)}}var Mi=[];function gi(Ie,Le,It){typeof Ie[0][0][0]=="number"&&(Ie=[Ie]),typeof Le[0][0][0]=="number"&&(Le=[Le]);var Sn=(function(li,Qs,Ds){var ps=null;return li.length*Qs.length==0&&(Ds===q?ps=Mi:Ds===te?ps=li:Ds!==ee&&Ds!==le||(ps=li.length===0?Qs:li)),ps})(Ie,Le,It);if(Sn)return Sn===Mi?null:Sn;var kn=[1/0,1/0,-1/0,-1/0],Dn=[1/0,1/0,-1/0,-1/0],Qn=(function(li,Qs,Ds,ps,da){var Ws,ks,zs,_s,fi,Cs,ha=new er(null,Tt);for(zs=0,_s=li.length;zs<_s;zs++)for(fi=0,Cs=(Ws=li[zs]).length;fi<Cs;fi++)(ks=fi===0)&&si++,Hr(Ws[fi],!0,si,ha,Ds,ks);for(zs=0,_s=Qs.length;zs<_s;zs++)for(fi=0,Cs=(Ws=Qs[zs]).length;fi<Cs;fi++)ks=fi===0,da===te&&(ks=!1),ks&&si++,Hr(Ws[fi],!1,si,ha,ps,ks);return ha})(Ie,Le,kn,Dn,It);if(Sn=(function(li,Qs,Ds,ps,da){var Ws=null;return(Ds[0]>ps[2]||ps[0]>Ds[2]||Ds[1]>ps[3]||ps[1]>Ds[3])&&(da===q?Ws=Mi:da===te?Ws=li:da!==ee&&da!==le||(Ws=li.concat(Qs))),Ws})(Ie,Le,kn,Dn,It))return Sn===Mi?null:Sn;for(var Or=(function(li){var Qs,Ds,ps=(function(zs){var _s,fi,Cs,ha,Mr=[];for(fi=0,Cs=zs.length;fi<Cs;fi++)((_s=zs[fi]).left&&_s.inResult||!_s.left&&_s.otherEvent.inResult)&&Mr.push(_s);for(var Zi=!1;!Zi;)for(Zi=!0,fi=0,Cs=Mr.length;fi<Cs;fi++)fi+1<Cs&&Tt(Mr[fi],Mr[fi+1])===1&&(ha=Mr[fi],Mr[fi]=Mr[fi+1],Mr[fi+1]=ha,Zi=!1);for(fi=0,Cs=Mr.length;fi<Cs;fi++)(_s=Mr[fi]).otherPos=fi;for(fi=0,Cs=Mr.length;fi<Cs;fi++)(_s=Mr[fi]).left||(ha=_s.otherPos,_s.otherPos=_s.otherEvent.otherPos,_s.otherEvent.otherPos=ha);return Mr})(li),da={},Ws=[],ks=function(){if(!da[Qs]){var zs=Ws.length,_s=(function(Mr,Zi,Xs){var Sa=new cn;if(Mr.prevInResult!=null){var ea=Mr.prevInResult,yo=ea.outputContourId;if(ea.resultTransition>0){var Ps=Zi[yo];if(Ps.holeOf!=null){var ao=Ps.holeOf;Zi[ao].holeIds.push(Xs),Sa.holeOf=ao,Sa.depth=Zi[yo].depth}else Zi[yo].holeIds.push(Xs),Sa.holeOf=yo,Sa.depth=Zi[yo].depth+1}else Sa.holeOf=null,Sa.depth=Zi[yo].depth}else Sa.holeOf=null,Sa.depth=0;return Sa})(ps[Qs],Ws,zs),fi=function(Mr){da[Mr]=!0,Mr<ps.length&&ps[Mr]&&(ps[Mr].outputContourId=zs)},Cs=Qs,ha=Qs;for(_s.points.push(ps[Qs].point);fi(Cs),fi(Cs=ps[Cs].otherPos),_s.points.push(ps[Cs].point),!((Cs=yn(Cs,ps,da,ha))==ha||Cs>=ps.length)&&ps[Cs];);Ws.push(_s)}};for(Qs=0,Ds=ps.length;Qs<Ds;Qs++)ks();return Ws})((function(li,Qs,Ds,ps,da,Ws){for(var ks,zs,_s,fi=new g(Jn),Cs=[],ha=Math.min(ps[2],da[2]);li.length!==0;){var Mr=li.pop();if(Cs.push(Mr),Ws===q&&Mr.point[0]>ha||Ws===te&&Mr.point[0]>ps[2])break;if(Mr.left){zs=ks=fi.insert(Mr),ks=ks!==(_s=fi.minNode())?fi.prev(ks):null,zs=fi.next(zs);var Zi=ks?ks.key:null;if(ue(Mr,Zi,Ws),zs&&ur(Mr,zs.key,li)===2&&(ue(Mr,Zi,Ws),ue(zs.key,Mr,Ws)),ks&&ur(ks.key,Mr,li)===2){var Xs=ks;ue(Zi,(Xs=Xs!==_s?fi.prev(Xs):null)?Xs.key:null,Ws),ue(Mr,Zi,Ws)}}else zs=ks=fi.find(Mr=Mr.otherEvent),ks&&zs&&(ks=ks!==_s?fi.prev(ks):null,zs=fi.next(zs),fi.remove(Mr),zs&&ks&&ur(ks.key,zs.key,li))}return Cs})(Qn,0,0,kn,Dn,It)),Ci=[],Ni=0;Ni<Or.length;Ni++){var hi=Or[Ni];if(hi.isExterior()){for(var Es=[hi.points],va=0;va<hi.holeIds.length;va++)Es.push(Or[hi.holeIds[va]].points);Ci.push(Es)}}return Ci}var Gs={UNION:ee,DIFFERENCE:te,INTERSECTION:q,XOR:le};l.diff=function(Ie,Le){return gi(Ie,Le,te)},l.intersection=function(Ie,Le){return gi(Ie,Le,q)},l.operations=Gs,l.union=function(Ie,Le){return gi(Ie,Le,ee)},l.xor=function(Ie,Le){return gi(Ie,Le,le)},Object.defineProperty(l,"__esModule",{value:!0})})(i)})(0,QT.exports)),QT.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function _f(u,i,l,h){const g=[],x=h===0?(b,j,M,R,L,U)=>{b.push(new Rt(U,M+(U-j)/(R-j)*(L-M)))}:(b,j,M,R,L,U)=>{b.push(new Rt(j+(U-M)/(L-M)*(R-j),U))};for(const b of u){const j=[];for(const M of b){if(M.length<=2)continue;const R=[];for(let q=0;q<M.length-1;q++){const ee=M[q].x,te=M[q].y,le=M[q+1].x,ue=M[q+1].y,ge=h===0?ee:te,Se=h===0?le:ue;ge<i?Se>i&&x(R,ee,te,le,ue,i):ge>l?Se<l&&x(R,ee,te,le,ue,l):R.push(M[q]),Se<i&&ge>=i&&x(R,ee,te,le,ue,i),Se>l&&ge<=l&&x(R,ee,te,le,ue,l)}let L=M[M.length-1];const U=h===0?L.x:L.y;U>=i&&U<=l&&R.push(L),R.length&&(L=R[R.length-1],R[0].x===L.x&&R[0].y===L.y||R.push(R[0]),j.push(R))}j.length&&g.push(j)}return g}function t2(u,i){const l=xw(u),h=xw([i]),g=e2.intersection(l,h);return g==null?[]:n2(g)}function pN(u,i){let h=xw(u,65536);for(;i.valid();i.next()){const[g,x]=i.get(),b=g.x*65536,j=g.y*65536,M=x.x*65536,R=x.y*65536,L=M-b,U=R-j,q=Math.hypot(L,U),ee=Math.trunc(U/q*3),te=-Math.trunc(L/q*3);h=e2.diff(h,[[[b,j],[M,R],[M+ee,R+te],[b+ee,j+te],[b,j]]])}return n2(h,1/65536)}function xw(u,i=1){return[u.map((l=>l.map((h=>[h.x*i,h.y*i]))))]}function n2(u,i=1){return u.map((l=>l.map(((h,g)=>{const x=h.map((b=>new Rt(b[0]*i,b[1]*i).round()));return g>0&&x.reverse(),x}))))}class _w{constructor(i,l){this.layoutVertexArray=new bl,this.indexArray=new ki,this.lineIndexArray=new Vo,this.triangleSegments=new Hs,this.lineSegments=new Hs,this.programConfigurations=new Ul(i.layers,{zoom:i.zoom,lut:i.lut}),this.uploaded=!1,l&&(this.elevatedLayoutVertexArray=new bh)}update(i,l,h,g,x,b,j,M){this.programConfigurations.updatePaintArrays(i,l,x,h,g,b,j,M)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Ty.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.lineIndexBuffer=i.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=i.createVertexBuffer(this.elevatedLayoutVertexArray,WT.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(i,l,h,g,x,b,j){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,l,h,g,x,b,void 0,j)}}class bw{constructor(i){this.zoom=i.zoom,this.pixelRatio=i.pixelRatio,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map((l=>l.fqid)),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lut=i.lut,this.bufferData=new _w(i,!1),this.elevationBufferData=new _w(i,!0),this.stateDependentLayerIds=this.layers.filter((l=>l.isStateDependent())).map((l=>l.id)),this.projection=i.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference"),this.sourceLayerIndex=i.sourceLayerIndex,this.worldview=i.worldview}updateFootprints(i,l){}populate(i,l,h,g){this.hasPattern=U_("fill",this.layers,this.pixelRatio,l);const x=this.layers[0].layout.get("fill-sort-key"),b=[];for(const{feature:j,id:M,index:R,sourceLayerIndex:L}of i){const U=this.layers[0]._featureFilter.needGeometry,q=Dt(j,U);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom,{worldview:this.worldview}),q,h))continue;const ee=x?x.evaluate(q,{},h,l.availableImages):void 0,te={id:M,properties:j.properties,type:j.type,sourceLayerIndex:L,index:R,geometry:U?q.geometry:at(j,h,g),patterns:{},sortKey:ee};b.push(te)}x&&b.sort(((j,M)=>j.sortKey-M.sortKey));for(const j of b){const{geometry:M,index:R,sourceLayerIndex:L}=j;if(this.hasPattern){const U=V_("fill",this.layers,j,this.zoom,this.pixelRatio,l);this.patternFeatures.push(U)}else this.addFeature(j,M,R,h,{},l.availableImages,l.brightness,l.elevationFeatures);l.featureIndex.insert(i[R].feature,M,R,L,this.index)}}update(i,l,h,g,x,b,j){this.bufferData.update(i,l,h,g,x,b,j,this.worldview),this.elevationBufferData.update(i,l,h,g,x,b,j,this.worldview),this.elevatedStructures&&this.elevatedStructures.update(i,l,h,g,x,b,j,this.worldview)}addFeatures(i,l,h,g,x,b){for(const j of this.patternFeatures)this.addFeature(j,j.geometry,j.index,l,h,g,b,i.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(i){this.bufferData.upload(i),this.elevationBufferData.upload(i),this.elevatedStructures&&this.elevatedStructures.upload(i)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(i,l,h,g,x,b=[],j,M){const R=ux(l,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(i,R,g,h,M):this.addGeometry(R,this.bufferData),this.bufferData.populatePaintArrays(i,h,x,b,g,j,this.worldview),this.elevationBufferData.populatePaintArrays(i,h,x,b,g,j,this.worldview)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(i,l,h,g,x){this.elevatedStructures&&(this.elevatedStructures.construct(i),this.elevatedStructures.populatePaintArrays(l,h,g,x,this.worldview))}addElevatedRoadFeature(i,l,h,g,x){const b=new Array,j=js.getElevationFeature(i,x);if(!j)return void this.addGeometry(l,this.bufferData);{const R=this.clipPolygonsToTile(l,1);R.length>0&&b.push({polygons:R,elevationFeature:j,elevationTileID:h})}const M={guardRailEnabled:this.layers[0].layout.get("fill-construct-bridge-guard-rail").evaluate(i,{},h),featureIndex:g};for(const R of b)if(R.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new jl(R.elevationTileID,this.layers,this.zoom,this.lut));const U=R.elevationFeature.isTunnel();let q=0;i.properties.hasOwnProperty(rr)&&(q=+i.properties[rr]);for(const ee of R.polygons)this.elevatedStructures.addPortalCandidates(R.elevationFeature.id,ee,U,R.elevationFeature,q)}R.elevationFeature.constantHeight==null&&(R.polygons=this.prepareElevatedPolygons(R.polygons,R.elevationFeature,R.elevationTileID));const L=new Ei(h,R.elevationTileID);this.addElevatedGeometry(R.polygons,L,R.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,g,M)}}addElevatedGeometry(i,l,h,g,x,b){const j={elevation:h,elevationSampler:l,bias:g,index:x,featureInfo:b},[M,R]=this.addGeometry(i,this.elevationBufferData,j);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:M,max:R}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,M),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,R))}addGeometry(i,l,h){let g=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY,b=null;h&&(b=h.elevationSampler.constantElevation(h.elevation,h.bias),b!=null&&(g=b,x=b));const j=(M,R,L)=>{if(h!=null)if(R.push(M),b!=null)l.elevatedLayoutVertexArray.emplaceBack(b),L.push(b);else{const U=h.elevationSampler.pointElevation(M,h.elevation,h.bias);l.elevatedLayoutVertexArray.emplaceBack(U),L.push(U),g=Math.min(g,U),x=Math.max(x,U)}};for(const M of i){let R=0;for(const we of M)R+=we.length;const L=l.triangleSegments.prepareSegment(R,l.layoutVertexArray,l.indexArray),U=L.vertexLength,q=[],ee=[],te=[],le=[],ue=[],ge=l.layoutVertexArray.length;for(const we of M){if(we.length===0)continue;we!==M[0]&&ee.push(q.length/2);const Pe=l.lineSegments.prepareSegment(we.length,l.layoutVertexArray,l.lineIndexArray),tt=Pe.vertexLength;h&&ue.push(l.layoutVertexArray.length-ge),j(we[0],te,le),l.layoutVertexArray.emplaceBack(we[0].x,we[0].y),l.lineIndexArray.emplaceBack(tt+we.length-1,tt),q.push(we[0].x),q.push(we[0].y);for(let Ke=1;Ke<we.length;Ke++)j(we[Ke],te,le),l.layoutVertexArray.emplaceBack(we[Ke].x,we[Ke].y),l.lineIndexArray.emplaceBack(tt+Ke-1,tt+Ke),q.push(we[Ke].x),q.push(we[Ke].y);Pe.vertexLength+=we.length,Pe.primitiveLength+=we.length}const Se=ng(q,ee);for(let we=0;we<Se.length;we+=3)l.indexArray.emplaceBack(U+Se[we],U+Se[we+1],U+Se[we+2]);if(Se.length>0&&h&&this.elevationMode==="hd-road-base"){const we=h.elevation.isTunnel(),Pe=h.elevation.safeArea,tt=this.elevatedStructures.addVertices(te,le);this.elevatedStructures.addTriangles(Se,tt,we);const Ke=ue.length;if(Ke>0){for(let Qe=0;Qe<Ke-1;Qe++)this.elevatedStructures.addRenderableRing(h.index,ue[Qe]+tt,ue[Qe+1]-ue[Qe],we,Pe,h.featureInfo);this.elevatedStructures.addRenderableRing(h.index,ue[Ke-1]+tt,te.length-ue[Ke-1],we,Pe,h.featureInfo)}}L.vertexLength+=R,L.primitiveLength+=Se.length/3}return[g,x]}prepareElevatedPolygons(i,l,h){const g=1/qe(h),x=[];for(const b of i){const j=pN(b,new Xi(l,g));x.push(...j)}return x}clipPolygonsToTile(i,l){const h=-l,g=-l,x=mn+l,b=mn+l;let j=0;const M=[],R=[];for(;j<i.length;j++){const q=i[j],ee=Tv(q);(ee.min.x>=h&&ee.max.x<=x&&ee.min.y>=g&&ee.max.y<=b?M:R).push(q)}if(M.length===i.length)return i;const L=[new Rt(h,g),new Rt(x,g),new Rt(x,b),new Rt(h,b),new Rt(h,g)],U=M;for(const q of R)U.push(...t2(q,L));return U}}let r2,i2,ww,ig;Hn(bw,"FillBucket",{omit:["layers","patternFeatures"]}),Hn(_w,"FillBufferData"),Hn(jl,"ElevatedStructures");class Rp{constructor(i,l,h,g){if(this.triangleCount=l.length/3,this.min=new Rt(0,0),this.max=new Rt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||i.length===0)return;const[x,b]=[i[0].clone(),i[0].clone()];for(let U=1;U<i.length;++U){const q=i[U];x.x=Math.min(x.x,q.x),x.y=Math.min(x.y,q.y),b.x=Math.max(b.x,q.x),b.y=Math.max(b.y,q.y)}if(g){const U=Math.ceil(Math.max(b.x-x.x,b.y-x.y)/g);h=Math.max(h,U)}if(h===0)return;this.min=x,this.max=b;const j=this.max.sub(this.min);j.x=Math.max(j.x,1),j.y=Math.max(j.y,1);const M=Math.max(j.x,j.y)/h;this.cellsX=Math.max(1,Math.ceil(j.x/M)),this.cellsY=Math.max(1,Math.ceil(j.y/M)),this.xScale=1/M,this.yScale=1/M;const R=[];for(let U=0;U<this.triangleCount;U++){const q=i[l[3*U+0]].sub(this.min),ee=i[l[3*U+1]].sub(this.min),te=i[l[3*U+2]].sub(this.min),le=Id(Math.floor(Math.min(q.x,ee.x,te.x)),this.xScale,this.cellsX),ue=Id(Math.floor(Math.max(q.x,ee.x,te.x)),this.xScale,this.cellsX),ge=Id(Math.floor(Math.min(q.y,ee.y,te.y)),this.yScale,this.cellsY),Se=Id(Math.floor(Math.max(q.y,ee.y,te.y)),this.yScale,this.cellsY),we=new Rt(0,0),Pe=new Rt(0,0),tt=new Rt(0,0),Ke=new Rt(0,0);for(let Qe=ge;Qe<=Se;++Qe){we.y=Pe.y=Qe*M,tt.y=Ke.y=(Qe+1)*M;for(let dt=le;dt<=ue;++dt)we.x=tt.x=dt*M,Pe.x=Ke.x=(dt+1)*M,(Ga(q,ee,te,we,Pe,Ke)||Ga(q,ee,te,we,Ke,tt))&&R.push({cellIdx:Qe*this.cellsX+dt,triIdx:U})}}if(R.length===0)return;R.sort(((U,q)=>U.cellIdx-q.cellIdx||U.triIdx-q.triIdx));let L=0;for(;L<R.length;){const U=R[L].cellIdx,q={start:this.payload.length,len:0};for(;L<R.length&&R[L].cellIdx===U;)++q.len,this.payload.push(R[L++].triIdx);this.cells[U]=q}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(i,l){if(this.triangleCount===0||this.cells.length===0||i.x>this.max.x||this.min.x>i.x||i.y>this.max.y||this.min.y>i.y)return;const h=Id(i.x-this.min.x,this.xScale,this.cellsX),g=Id(i.y-this.min.y,this.yScale,this.cellsY),x=this.cells[g*this.cellsX+h];if(x){this._lazyInitLookup();for(let b=0;b<x.len;b++){const j=this.payload[x.start+b],M=Math.floor(j/8),R=1<<j%8;if(!(this.lookup[M]&R)&&(this.lookup[M]|=R,l.push(j),l.length===this.triangleCount))return}}}query(i,l,h){if(this.triangleCount===0||this.cells.length===0||i.x>this.max.x||this.min.x>l.x||i.y>this.max.y||this.min.y>l.y)return;this._lazyInitLookup();const g=Id(i.x-this.min.x,this.xScale,this.cellsX),x=Id(l.x-this.min.x,this.xScale,this.cellsX),b=Id(i.y-this.min.y,this.yScale,this.cellsY),j=Id(l.y-this.min.y,this.yScale,this.cellsY);for(let M=b;M<=j;M++)for(let R=g;R<=x;R++){const L=this.cells[M*this.cellsX+R];if(L)for(let U=0;U<L.len;U++){const q=this.payload[L.start+U],ee=Math.floor(q/8),te=1<<q%8;if(!(this.lookup[ee]&te)&&(this.lookup[ee]|=te,h.push(q),h.length===this.triangleCount))return}}}}function Id(u,i,l){return Math.max(0,Math.min(l-1,Math.floor(u*i)))}Hn(Rp,"TriangleGridIndex");class s2{constructor(i){this.zoom=i.zoom,this.layers=i.layers,this.layerIds=this.layers.map((l=>l.fqid)),this.index=i.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter((l=>l.isStateDependent())).map((l=>l.id)),this.footprints=[],this.worldview=i.worldview}updateFootprints(i,l){for(const h of this.footprints)l.push({footprint:h,id:i})}populate(i,l,h,g){const x=[];for(const{feature:b,id:j,index:M,sourceLayerIndex:R}of i){const L=this.layers[0]._featureFilter.needGeometry,U=Dt(b,L);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom,{worldview:this.worldview}),U,h))continue;const q={id:j,properties:b.properties,type:b.type,sourceLayerIndex:R,index:M,geometry:L?U.geometry:at(b,h,g),patterns:{}};x.push(q)}for(const b of x){const{geometry:j,index:M,sourceLayerIndex:R}=b;this.addFeature(b,j,M,h,{},l.availableImages,l.brightness),l.featureIndex.insert(i[M].feature,j,M,R,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(i){}update(i,l,h,g,x,b,j){}destroy(){}addFeature(i,l,h,g,x,b=[],j){for(const M of ux(l,2)){const R=[],L=[],U=[],q=new Rt(1/0,1/0),ee=new Rt(-1/0,-1/0);for(const ue of M)if(ue.length!==0){ue!==M[0]&&U.push(L.length/2);for(let ge=0;ge<ue.length;ge++)L.push(ue[ge].x),L.push(ue[ge].y),R.push(ue[ge]),q.x=Math.min(q.x,ue[ge].x),q.y=Math.min(q.y,ue[ge].y),ee.x=Math.max(ee.x,ue[ge].x),ee.y=Math.max(ee.y,ue[ge].y)}const te=ng(L,U),le=new Rp(R,te,8,256);this.footprints.push({vertices:R,indices:te,grid:le,min:q,max:ee})}}}Hn(s2,"ClipBucket",{omit:["layers"]});const Ey=Ai([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),dx=Ai([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),a2=Ai([{name:"a_centroid_pos",components:2,type:"Uint16"}]),$_=Ai([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Sw=Ai([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Tw=Ai([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:q_}=Ey,Cy=Number.MAX_SAFE_INTEGER,Aw=Cy-1;function o2(u,i,l,h){return u.order<i||u.order===Cy||!(u.clipMask&l)||(function(g,x){return x.length!==0&&x.find((b=>b===g))===void 0})(h,u.clipScope)}function hx(u,i){return u.x-i.x||u.y-i.y}function Ny(u,i){return hx(u.min,i.min)===0&&hx(u.max,i.max)===0}function jw(u,i){return!(u.min.x>i.max.x||u.max.x<i.min.x||u.min.y>i.max.y||u.max.y<i.min.y)}function H_(u,i){if(u.length!==i.length)return!1;for(let l=0;l<u.length;l++)if(u[l].sourceId!==i[l].sourceId||!Ny(u[l],i[l])||u[l].order!==i[l].order||u[l].clipMask!==i[l].clipMask||!Jr(u[l].clipScope,i[l].clipScope))return!1;return!0}function l2(u,i,l){const h=1/mn,g=1/(1<<l.canonical.z),x=(i.x*h+l.canonical.x)*g+l.wrap,b=(i.y*h+l.canonical.y)*g;return{min:new Rt((u.x*h+l.canonical.x)*g+l.wrap,(u.y*h+l.canonical.y)*g),max:new Rt(x,b)}}function G_(u,i,l){const h=1<<l.canonical.z,g=((i.x-l.wrap)*h-l.canonical.x)*mn,x=(i.y*h-l.canonical.y)*mn;return{min:new Rt(((u.x-l.wrap)*h-l.canonical.x)*mn,(u.y*h-l.canonical.y)*mn),max:new Rt(g,x)}}function Py(u,i,l,h,g,x,b){const j=u.indices,M=u.vertices,R=[];for(let L=h;L<h+g;L+=3){const U=i[l[L+0]+x],q=i[l[L+1]+x],ee=i[l[L+2]+x],te=Math.min(U.x,q.x,ee.x),le=Math.max(U.x,q.x,ee.x),ue=Math.min(U.y,q.y,ee.y),ge=Math.max(U.y,q.y,ee.y);R.length=0,u.grid.query(new Rt(te,ue),new Rt(le,ge),R);for(let Se=0;Se<R.length;Se++){const we=R[Se];if(Ga(M[j[3*we+0]],M[j[3*we+1]],M[j[3*we+2]],U,q,ee,b))return!0}}return!1}function W_(u,i,l,h){if(!u||!l)return!1;let g=u.vertices;if(!i.canonical.equals(h.canonical)||i.wrap!==h.wrap){if(l.vertices.length<u.vertices.length)return W_(l,h,u,i);const x=i.canonical,b=h.canonical,j=Math.pow(2,b.z-x.z);g=u.vertices.map((M=>new Rt((M.x+x.x*mn)*j-b.x*mn,(M.y+x.y*mn)*j-b.y*mn)))}return Py(l,g,u.indices,0,u.indices.length,0,0)}function c2(u,i,l,h){const g=Math.pow(2,h.z-l.z);return new Rt((u+l.x*mn)*g-h.x*mn,(i+l.y*mn)*g-h.y*mn)}function sg(u,i){const l=[];i.grid.queryPoint(u,l);const h=i.indices,g=i.vertices;for(let x=0;x<l.length;x++){const b=l[x];if(Ha([g[h[3*b+0]],g[h[3*b+1]],g[h[3*b+2]]],u))return!0}return!1}const Ew=[new Rt(0,0),new Rt(mn,0),new Rt(mn,mn),new Rt(0,mn)];function Cw(u,i){const l=[];let h=[];if(!i||u.length<2)return[u];if(u.length===2)return ia(u[0],u[1],Ew)?[u]:[];for(let g=0;g<u.length+2;g++){const x=u[g%u.length],b=u[(g+1)%u.length],j=ia(g===0?u[u.length-1]:u[(g-1)%u.length],x,Ew),M=ia(x,b,Ew),R=j||M;R&&h.push(x),R&&M||h.length>0&&(h.length>1&&l.push(h),h=[])}return h.length>1&&l.push(h),l}const X_=At.types,u2=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],d2=["fill-extrusion-flood-light-ground-radius"],Nw=Math.pow(2,13),h2=Math.pow(2,15)-1,fx=new Rt(0,1),Op=2147483648;function px(u,i,l,h,g,x,b,j){u.emplaceBack((i<<1)+b,(l<<1)+x,(Math.floor(h*Nw)<<1)+g,Math.round(j))}function ag(u,i,l){u.emplaceBack(i.x*mn,i.y*mn,l?1:0)}function My(u,i,l,h,g,x){u.emplaceBack(i.x,i.y,(l.x<<1)+h,(l.y<<1)+g,x)}function Dp(u,i,l){u.emplaceBack(i.x,i.y,i.z,l[0]*16384,l[1]*16384,l[2]*16384)}class Z_{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class Pw{constructor(){this.centroidXY=new Rt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Rt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Rt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0,this.buildingId=0}span(){return new Rt(this.max.x-this.min.x,this.max.y-this.min.y)}}class Y_{constructor(){this.acc=new Rt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(i,l){i.min.x===Number.MAX_VALUE&&(i.min.x=i.max.x=l.x,i.min.y=i.max.y=l.y)}appendEdge(i,l,h){this.accCount++,this.acc._add(l);let g=!!this.borders;l.x<i.min.x?(i.min.x=l.x,g=!0):l.x>i.max.x&&(i.max.x=l.x,g=!0),l.y<i.min.y?(i.min.y=l.y,g=!0):l.y>i.max.y&&(i.max.y=l.y,g=!0),((l.x===0||l.x===mn)&&l.x===h.x)!=((l.y===0||l.y===mn)&&l.y===h.y)&&this.processBorderOverlap(l,h),g&&this.checkBorderIntersection(l,h)}checkBorderIntersection(i,l){l.x<0!=i.x<0&&this.addBorderIntersection(0,yr(l.y,i.y,(0-l.x)/(i.x-l.x))),l.x>mn!=i.x>mn&&this.addBorderIntersection(1,yr(l.y,i.y,(mn-l.x)/(i.x-l.x))),l.y<0!=i.y<0&&this.addBorderIntersection(2,yr(l.x,i.x,(0-l.y)/(i.y-l.y))),l.y>mn!=i.y>mn&&this.addBorderIntersection(3,yr(l.x,i.x,(mn-l.y)/(i.y-l.y)))}addBorderIntersection(i,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const h=this.borders[i];l<h[0]&&(h[0]=l),l>h[1]&&(h[1]=l)}processBorderOverlap(i,l){if(i.x===l.x){if(i.y===l.y)return;const h=i.x===0?0:1;this.addBorderIntersection(h,l.y),this.addBorderIntersection(h,i.y)}else{const h=i.y===0?2:3;this.addBorderIntersection(h,l.x),this.addBorderIntersection(h,i.x)}}centroid(){return this.accCount===0?new Rt(0,0):new Rt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce(((i,l)=>i+ +(l[0]!==Number.MAX_VALUE)),0):0}}function bf(u,i){const l=u.add(i)._unit(),h=Oe(u.x*l.x+u.y*l.y,-1,1);var g,x,b;return g=Math.acos(h),Math.min(4,Math.max(-4,Math.tan(g)))/4*h2*((x=u).x*(b=i).y-x.y*b.x<0?-1:1)}const kp=[u=>u.x<0,u=>u.x>mn,u=>u.y<0,u=>u.y>mn];function Ip(u,i,l,h){const g=[4];if(h===0)return g;l._mult(h);const x=u.sub(l),b=i.sub(l),j=[u,i,x,b];for(let M=0;M<4;M++)for(const R of j)if(kp[M](R)){g.push(M);break}return g}class og{constructor(i){this.vertexArray=new Ed,this.indexArray=new ki,this.programConfigurations=new Ul(i.layers,{zoom:i.zoom,lut:i.lut},(l=>d2.includes(l))),this._segments=new Hs,this.hiddenByLandmarkVertexArray=new Xm,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Hs}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(i,l,h,g=!1){const x=i.length;if(x>2){let b=Math.max(0,this._segments.get().length-1);const j=this._segments._prepareSegment(4*x,this.vertexArray.length,2*this._segmentToGroundQuads[b].length);let M;b!==this._segments.get().length-1&&(b++,this._segmentToGroundQuads[b]=[],this._segmentToRegionTriCounts[b]=[0,0,0,0,0]);{const R=i[0],L=i[1];M=bf(R.sub(i[x-1])._perp()._unit(),L.sub(R)._perp()._unit())}for(let R=0;R<x;R++){const L=R===x-1?0:R+1,U=i[R],q=i[L],ee=i[L===x-1?0:L+1],te=q.sub(U)._perp()._unit(),le=bf(te,ee.sub(q)._perp()._unit()),ue=M,ge=le;if(lg(U,q,l)||g&&f2(U,l)&&f2(q,l)){M=le;continue}const Se=j.vertexLength;My(this.vertexArray,U,q,1,1,ue),My(this.vertexArray,U,q,1,0,ue),My(this.vertexArray,U,q,0,1,ge),My(this.vertexArray,U,q,0,0,ge),j.vertexLength+=4;const we=Ip(U,q,te,h);for(const Pe of we)this._segmentToGroundQuads[b].push({id:Se,region:Pe}),this._segmentToRegionTriCounts[b][Pe]+=2,j.primitiveLength+=2;M=le}}}prepareBorderSegments(){if(!this.hasData())return;const i=this._segments.get(),l=i.length;for(let h=0;h<l;h++)this._segmentToGroundQuads[h].sort(((g,x)=>g.region-x.region));for(let h=0;h<l;h++){const g=this._segmentToGroundQuads[h],x=i[h],b=this._segmentToRegionTriCounts[h];b.reduce(((M,R)=>M+R),0);let j=0;for(let M=0;M<=4;M++){const R=b[M];if(R!==0){let L=this.regionSegments[M];L||(L=this.regionSegments[M]=new Hs);const U={vertexOffset:x.vertexOffset,primitiveOffset:x.primitiveOffset+j,vertexLength:x.vertexLength,primitiveLength:R};L.get().push(U)}j+=R}for(let M=0;M<g.length;M++){const R=g[M].id;this.indexArray.emplaceBack(R,R+1,R+3),this.indexArray.emplaceBack(R,R+3,R+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(i,l,h,g,x,b,j){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,i,l,h,g,x,b,void 0,j)}upload(i){this.hasData()&&(this.vertexBuffer=i.createVertexBuffer(this.vertexArray,dx.members),this.indexBuffer=i.createIndexBuffer(this.indexArray))}uploadPaintProperties(i){this.hasData()&&this.programConfigurations.upload(i)}update(i,l,h,g,x,b,j,M){this.hasData()&&this.programConfigurations.updatePaintArrays(i,l,h,g,x,b,j,M)}updateHiddenByLandmark(i){this.updateHiddenByLandmarkRange(i.groundVertexArrayOffset,i.groundVertexCount,!!(i.flags&Op))}updateHiddenByLandmarkRange(i,l,h){if(!this.hasData())return;const g=l+i;if(l!==0){for(let x=i;x<g;++x)this.hiddenByLandmarkVertexArray.emplace(x,h?1:0);this._needsHiddenByLandmarkUpdate=!0}}uploadHiddenByLandmark(i){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=i.createVertexBuffer(this.hiddenByLandmarkVertexArray,Sw.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let i=0;i<=4;i++){const l=this.regionSegments[i];l&&l.destroy()}}}}class Lp{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.overscaling=i.overscaling,this.layers=i.layers,this.pixelRatio=i.pixelRatio,this.layerIds=this.layers.map((l=>l.fqid)),this.index=i.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=i.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new ki,this.footprintVertices=new bl,this.footprintSegments=[],this.layoutVertexArray=new jd,this.centroidVertexArray=new Km,this.wallVertexArray=new Yv,this.indexArray=new ki,this.programConfigurations=new Ul(i.layers,{zoom:i.zoom,lut:i.lut},(l=>u2.includes(l))),this.segments=new Hs,this.stateDependentLayerIds=this.layers.filter((l=>l.isStateDependent())).map((l=>l.id)),this.groundEffect=new og(i),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[],this.worldview=i.worldview}updateFootprints(i,l){}populate(i,l,h,g){this.features=[],this.hasPattern=U_("fill-extrusion",this.layers,this.pixelRatio,l),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=qe(h),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:x,id:b,index:j,sourceLayerIndex:M}of i){const R=this.layers[0]._featureFilter.needGeometry,L=Dt(x,R);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom,{worldview:this.worldview}),L,h))continue;const U={id:b,sourceLayerIndex:M,index:j,geometry:R?L.geometry:at(x,h,g),properties:x.properties,type:x.type,patterns:{}},q=this.layoutVertexArray.length,ee=X_[U.type]==="Polygon";if(this.hasPattern)this.features.push({featureId:x.id,feature:V_("fill-extrusion",this.layers,U,this.zoom,this.pixelRatio,l)});else if(this.wallMode)for(const te of U.geometry)for(const le of Cw(te,ee))this.addFeature(x.id,U,[le],j,h,{},l.availableImages,g,l.brightness);else this.addFeature(x.id,U,U.geometry,j,h,{},l.availableImages,g,l.brightness);l.featureIndex.insert(x,U.geometry,j,M,this.index,q)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(i,l,h,g,x,b){for(const{featureId:j,feature:M}of this.features){const R=X_[M.type]==="Polygon",{geometry:L}=M;if(this.wallMode)for(const U of L)for(const q of Cw(U,R))this.addFeature(j,M,[q],M.index,l,h,g,x,b);else this.addFeature(j,M,L,M.index,l,h,g,x,b)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(i,l,h,g,x,b,j){this.programConfigurations.updatePaintArrays(i,l,x,h,g,b,j,this.worldview),this.groundEffect.update(i,l,x,h,g,b,j,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,q_),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.wallVertexBuffer=i.createVertexBuffer(this.wallVertexArray,$_.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=i.createVertexBuffer(this.layoutVertexExtArray,Tw.members,!0)),this.groundEffect.upload(i)),this.groundEffect.uploadPaintProperties(i),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){this.groundEffect.uploadHiddenByLandmark(i),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,a2.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,l,h,g,x,b,j,M,R){const L=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(l,{})/this.tileToMeter,U=[new Rt(0,0),new Rt(mn,mn)],q=M.projection,ee=q.name==="globe",te=this.wallMode||X_[l.type]==="Polygon",le=new Y_;le.centroidDataIndex=this.centroidData.length;const ue=new Pw;ue.buildingId=i,l.properties&&l.properties.hasOwnProperty("building_id")&&(ue.buildingId=l.properties.building_id);const ge=this.layers[0].paint.get("fill-extrusion-base").evaluate(l,{},x)<=0,Se=this.layers[0].paint.get("fill-extrusion-height").evaluate(l,{},x);let we;if(ue.height=Se,ue.vertexArrayOffset=this.layoutVertexArray.length,ue.groundVertexArrayOffset=this.groundEffect.vertexArray.length,ee&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Vm),this.wallMode){if(ee)return void ai("Non zero fill-extrusion-line-width is not yet supported on globe.");if(h.length!==1)return;we=(function(xt){const Wt=xt[0].x===xt[xt.length-1].x&&xt[0].y===xt[xt.length-1].y;(function(yn){let er=0;const Bn=yn.length;for(let En=0;En<Bn;En++)er+=(yn[(En+1)%Bn].x-yn[En].x)*(yn[(En+1)%Bn].y+yn[En].y);return er>=0})(xt)||(xt=xt.reverse());const tn={geometry:[],joinNormals:[],indices:[]},dn=[],xn=[],Lt=[];let hn=xt.length;for(;hn>=2&&xt[hn-1].equals(xt[hn-2]);)hn--;if(hn<(Wt?3:2))return tn;let Tt,zt,wn,pn,ur,Jn=0;for(;Jn<hn-1&&xt[Jn].equals(xt[Jn+1]);)Jn++;Wt&&(Tt=xt[hn-2],ur=xt[Jn].sub(Tt)._unit()._perp());for(let yn=Jn;yn<hn;yn++){if(wn=yn===hn-1?Wt?xt[Jn+1]:void 0:xt[yn+1],wn&&xt[yn].equals(wn))continue;ur&&(pn=ur),Tt&&(zt=Tt),Tt=xt[yn],ur=wn?wn.sub(Tt)._unit()._perp():pn,pn=pn||ur;let er=pn.add(ur);er.x===0&&er.y===0||er._unit();const Bn=er.x*ur.x+er.y*ur.y,En=Bn!==0?1/Bn:1/0,$n=pn.x*ur.y-pn.y*ur.x>0;let Cr="miter";const kr=2;Cr==="miter"&&En>kr&&(Cr="bevel"),Cr==="bevel"&&(En>100&&(Cr="flipbevel"),En<kr&&(Cr="miter"));const si=(Hr,Mi,gi,Gs)=>{const Ie=new Rt(Hr.x,Hr.y),Le=new Rt(Hr.x,Hr.y);Ie.x+=Mi.x*Gs,Ie.y+=Mi.y*Gs,Le.x-=Mi.x*Math.max(gi,1),Le.y-=Mi.y*Math.max(gi,1),Lt.push(Mi),dn.push(Ie),xn.push(Le)};if(Cr==="miter")er._mult(En),si(Tt,er,0,0);else if(Cr==="flipbevel")er=ur.mult(-1),si(Tt,er,0,0),si(Tt,er.mult(-1),0,0);else{const Hr=-Math.sqrt(En*En-1),Mi=$n?Hr:0,gi=$n?0:Hr;zt&&si(Tt,pn,Mi,gi),wn&&si(Tt,ur,Mi,gi)}}tn.geometry=[...dn,...xn.reverse(),dn[0]],tn.joinNormals=[...Lt,...Lt.reverse(),Lt[Lt.length-1]];const cn=tn.geometry.length-1;for(let yn=0;yn<cn/2;yn++)if(yn+1<cn/2){let er=yn,Bn=yn+1,En=cn-1-yn,$n=cn-2-yn;er=er===0?cn-1:er-1,Bn=Bn===0?cn-1:Bn-1,En=En===0?cn-1:En-1,$n=$n===0?cn-1:$n-1,tn.indices.push(En),tn.indices.push(Bn),tn.indices.push(er),tn.indices.push(En),tn.indices.push($n),tn.indices.push(Bn)}return tn})(h[0]),h=[we.geometry]}const Pe=(xt,Wt)=>xt<(Wt.length-1)/2||xt===Wt.length-1,tt=this.wallMode?[h]:ux(h,500);for(let xt=tt.length-1;xt>=0;xt--){const Wt=tt[xt];(Wt.length===0||(Ke=Wt[0]).every((bn=>bn.x<=0))||Ke.every((bn=>bn.x>=mn))||Ke.every((bn=>bn.y<=0))||Ke.every((bn=>bn.y>=mn)))&&tt.splice(xt,1)}var Ke;let Qe;if(ee)Qe=p2(tt,U,x);else{Qe=[];for(const xt of tt)Qe.push({polygon:xt,bounds:U})}const dt=te?this.edgeRadius:0,ft=dt>0&&this.zoom<17,Ft=(xt,Wt)=>{if(xt.length===0)return!1;const bn=xt[xt.length-1];return Wt.x===bn.x&&Wt.y===bn.y};for(const{polygon:xt,bounds:Wt}of Qe){let bn=0,tn=0;for(const hn of xt)te&&!hn[0].equals(hn[hn.length-1])&&hn.push(hn[0]),tn+=te?hn.length-1:hn.length;const dn=this.segments.prepareSegment((te?5:4)*tn,this.layoutVertexArray,this.indexArray);ue.footprintSegIdx<0&&(ue.footprintSegIdx=this.footprintSegments.length),ue.polygonSegIdx<0&&(ue.polygonSegIdx=this.polygonSegments.length);const xn={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Lt=new Z_;if(Lt.vertexOffset=this.footprintVertices.length,Lt.indexOffset=3*this.footprintIndices.length,Lt.ringIndices=[],te){const hn=[],Tt=[];bn=dn.vertexLength;for(let wn=0;wn<xt.length;wn++){const pn=xt[wn];pn.length&&wn!==0&&Tt.push(hn.length/2);const ur=[];let Jn,cn;Jn=pn[1].sub(pn[0])._perp()._unit(),Lt.ringIndices.push(pn.length-1);for(let yn=1;yn<pn.length;yn++){const er=pn[yn],Bn=pn[yn===pn.length-1?1:yn+1],En=er.clone();if(dt){cn=Bn.sub(er)._perp()._unit();const $n=Jn.add(cn)._unit(),Cr=dt*Math.min(4,1/(Jn.x*$n.x+Jn.y*$n.y));En.x+=Cr*$n.x,En.y+=Cr*$n.y,En.x=Math.round(En.x),En.y=Math.round(En.y),Jn=cn}if(!ge||dt!==0&&!ft||Ft(ur,En)||ur.push(En),px(this.layoutVertexArray,En.x,En.y,0,0,1,1,0),this.wallMode){const $n=Pe(yn,pn);ag(this.wallVertexArray,we.joinNormals[yn],!$n)}dn.vertexLength++,this.footprintVertices.emplaceBack(er.x,er.y),hn.push(er.x,er.y),ee&&Dp(this.layoutVertexExtArray,q.projectTilePoint(En.x,En.y,x),q.upVector(x,En.x,En.y))}ge&&(dt===0||ft)&&(ur.length!==0&&Ft(ur,ur[0])&&ur.pop(),this.groundEffect.addData(ur,Wt,L))}const zt=this.wallMode?we.indices:ng(hn,Tt);for(let wn=0;wn<zt.length;wn+=3)this.footprintIndices.emplaceBack(Lt.vertexOffset+zt[wn+0],Lt.vertexOffset+zt[wn+1],Lt.vertexOffset+zt[wn+2]),this.indexArray.emplaceBack(bn+zt[wn],bn+zt[wn+2],bn+zt[wn+1]),dn.primitiveLength++;Lt.indexCount+=zt.length,Lt.vertexCount+=this.footprintVertices.length-Lt.vertexOffset}for(let hn=0;hn<xt.length;hn++){const Tt=xt[hn];le.startRing(ue,Tt[0]);let zt=Tt.length>4&&Rw(Tt[Tt.length-2],Tt[0],Tt[1]),wn=dt?mN(Tt[Tt.length-2],Tt[0],Tt[1],dt):0;const pn=[];let ur,Jn,cn;Jn=Tt[1].sub(Tt[0])._perp()._unit();let yn=!0;for(let er=1,Bn=0;er<Tt.length;er++){let En=Tt[er-1],$n=Tt[er];const Cr=Tt[er===Tt.length-1?1:er+1];if(le.appendEdge(ue,$n,En),lg($n,En,Wt)){dt&&(Jn=Cr.sub($n)._perp()._unit(),yn=!yn);continue}const kr=$n.sub(En)._perp(),si=kr.x/(Math.abs(kr.x)+Math.abs(kr.y)),Hr=kr.y>0?1:0,Mi=En.dist($n);if(Bn+Mi>32768&&(Bn=0),dt){cn=Cr.sub($n)._perp()._unit();let Le=Mw(En,$n,Cr,wf(Jn,cn),dt);isNaN(Le)&&(Le=0);const It=$n.sub(En)._unit();En=En.add(It.mult(wn))._round(),$n=$n.add(It.mult(-Le))._round(),wn=Le,Jn=cn,ge&&this.zoom>=17&&(Ft(pn,En)||pn.push(En),Ft(pn,$n)||pn.push($n))}const gi=dn.vertexLength,Gs=Tt.length>4&&Rw(En,$n,Cr);let Ie=mx(Bn,zt,yn);if(px(this.layoutVertexArray,En.x,En.y,si,Hr,0,0,Ie),px(this.layoutVertexArray,En.x,En.y,si,Hr,0,1,Ie),this.wallMode){const Le=Pe(er-1,Tt),It=we.joinNormals[er-1];ag(this.wallVertexArray,It,Le),ag(this.wallVertexArray,It,Le)}if(Bn+=Mi,Ie=mx(Bn,Gs,!yn),zt=Gs,px(this.layoutVertexArray,$n.x,$n.y,si,Hr,0,0,Ie),px(this.layoutVertexArray,$n.x,$n.y,si,Hr,0,1,Ie),this.wallMode){const Le=Pe(er,Tt),It=we.joinNormals[er];ag(this.wallVertexArray,It,Le),ag(this.wallVertexArray,It,Le)}if(dn.vertexLength+=4,this.indexArray.emplaceBack(gi+0,gi+1,gi+2),this.indexArray.emplaceBack(gi+1,gi+3,gi+2),dn.primitiveLength+=2,dt){const Le=bn+(er===1?Tt.length-2:er-2),It=er===1?bn:Le+1;if(this.indexArray.emplaceBack(gi+1,Le,gi+3),this.indexArray.emplaceBack(Le,It,gi+3),dn.primitiveLength+=2,ur===void 0&&(ur=gi),!lg(Cr,Tt[er],Wt)){const Sn=er===Tt.length-1?ur:dn.vertexLength;this.indexArray.emplaceBack(gi+2,gi+3,Sn),this.indexArray.emplaceBack(gi+3,Sn+1,Sn),this.indexArray.emplaceBack(gi+3,It,Sn+1),dn.primitiveLength+=3}yn=!yn}if(ee){const Le=this.layoutVertexExtArray,It=q.projectTilePoint(En.x,En.y,x),Sn=q.projectTilePoint($n.x,$n.y,x),kn=q.upVector(x,En.x,En.y),Dn=q.upVector(x,$n.x,$n.y);Dp(Le,It,kn),Dp(Le,It,kn),Dp(Le,Sn,Dn),Dp(Le,Sn,Dn)}}te&&(bn+=Tt.length-1),ge&&dt&&this.zoom>=17&&(pn.length!==0&&Ft(pn,pn[0])&&pn.pop(),this.groundEffect.addData(pn,Wt,L,dt>0))}this.footprintSegments.push(Lt),xn.triangleCount=this.indexArray.length-xn.triangleArrayOffset,this.polygonSegments.push(xn),++ue.footprintSegLen,++ue.polygonSegLen}if(ue.vertexCount=this.layoutVertexArray.length-ue.vertexArrayOffset,ue.groundVertexCount=this.groundEffect.vertexArray.length-ue.groundVertexArrayOffset,ue.vertexCount!==0){if(ue.centroidXY=le.borders?fx:this.encodeCentroid(le,ue),this.centroidData.push(ue),le.borders){this.featuresOnBorder.push(le);const xt=this.featuresOnBorder.length-1;for(let Wt=0;Wt<le.borders.length;Wt++)le.borders[Wt][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Wt].push(xt)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,g,b,j,x,R,void 0,this.worldview),this.groundEffect.addPaintPropertiesData(l,g,b,j,x,R,this.worldview),this.maxHeight=Math.max(this.maxHeight,Se)}}sortBorders(){for(let i=0;i<this.borderFeatureIndices.length;i++)this.borderFeatureIndices[i].sort(((l,h)=>this.featuresOnBorder[l].borders[i][0]-this.featuresOnBorder[h].borders[i][0]))}splitToSubtiles(){const i=[];for(let j=0;j<this.centroidData.length;j++){const M=this.centroidData[j],R=+(M.min.y+M.max.y>mn),L=2*R+(+(M.min.x+M.max.x>mn)^R);for(let U=0;U<M.polygonSegLen;U++){const q=M.polygonSegIdx+U;i.push({centroidIdx:j,subtile:L,polygonSegmentIdx:q,triangleSegmentIdx:this.polygonSegments[q].triangleSegIdx})}}const l=new ki;i.sort(((j,M)=>j.triangleSegmentIdx===M.triangleSegmentIdx?j.subtile-M.subtile:j.triangleSegmentIdx-M.triangleSegmentIdx));let h=0,g=0,x=0;for(const j of i){if(j.triangleSegmentIdx!==h)break;x++}const b=i.length;for(;g!==i.length;){h=i[g].triangleSegmentIdx;let j=0,M=g,R=g;for(let L=M;L<x&&i[L].subtile===j;L++)R++;for(;M!==x;){const L=i[M];j=L.subtile;const U=this.centroidData[L.centroidIdx].min.clone(),q=this.centroidData[L.centroidIdx].max.clone(),ee={vertexOffset:this.segments.segments[h].vertexOffset,primitiveOffset:l.length,vertexLength:this.segments.segments[h].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let te=M;te<R;te++){const le=i[te],ue=this.polygonSegments[le.polygonSegmentIdx],ge=this.centroidData[le.centroidIdx].min,Se=this.centroidData[le.centroidIdx].max,we=this.indexArray.uint16;for(let Pe=ue.triangleArrayOffset;Pe<ue.triangleArrayOffset+ue.triangleCount;Pe++)l.emplaceBack(we[3*Pe],we[3*Pe+1],we[3*Pe+2]);ee.primitiveLength+=ue.triangleCount,U.x=Math.min(U.x,ge.x),U.y=Math.min(U.y,ge.y),q.x=Math.max(q.x,Se.x),q.y=Math.max(q.y,Se.y)}ee.primitiveLength>0&&this.triangleSubSegments.push({segment:ee,min:U,max:q}),M=R;for(let te=M;te<x&&i[te].subtile===i[M].subtile;te++)R++}g=x;for(let L=g;L<b&&i[L].triangleSegmentIdx===i[g].triangleSegmentIdx;L++)x++}l._trim(),this.indexArray=l}getVisibleSegments(i,l,h){const g=new Hs;if(this.wallMode){for(const le of this.triangleSubSegments)g.segments.push(le.segment);return g}let x=0,b=0;const j=1<<i.canonical.z;if(l){const le=l.getMinMaxForTile(i);le&&(x=le.min,b=le.max)}b+=this.maxHeight;const M=i.toUnwrapped();let R;const L=[M.canonical.x/j+M.wrap,M.canonical.y/j],U=[(M.canonical.x+1)/j+M.wrap,(M.canonical.y+1)/j],q=(le,ue,ge)=>[le[0]*(1-ge[0])+ue[0]*ge[0],le[1]*(1-ge[1])+ue[1]*ge[1]],ee=[],te=[];for(const le of this.triangleSubSegments){ee[0]=le.min.x/mn,ee[1]=le.min.y/mn,te[0]=le.max.x/mn,te[1]=le.max.y/mn;const ue=q(L,U,ee),ge=q(L,U,te);if(new ii([ue[0],ue[1],x],[ge[0],ge[1],b]).intersectsPrecise(h)===0){R&&(g.segments.push(R),R=void 0);continue}const Se=le.segment;R&&R.vertexOffset!==Se.vertexOffset&&(g.segments.push(R),R=void 0),R?(R.vertexLength+=Se.vertexLength,R.primitiveLength+=Se.primitiveLength):R={vertexOffset:Se.vertexOffset,primitiveLength:Se.primitiveLength,vertexLength:Se.vertexLength,primitiveOffset:Se.primitiveOffset,sortKey:void 0,vaos:{}}}return R&&g.segments.push(R),g}encodeCentroid(i,l){const h=i.centroid(),g=l.span(),x=Math.min(7,Math.round(g.x*this.tileToMeter/10)),b=Math.min(7,Math.round(g.y*this.tileToMeter/10));return new Rt(Oe(h.x,1,mn-1)<<3|x,Oe(h.y,1,mn-1)<<3|b)}encodeBorderCentroid(i){if(!i.borders)return new Rt(0,0);const l=i.borders,h=Number.MAX_VALUE;if(l[0][0]!==h||l[1][0]!==h){const g=l[0][0]!==h?0:1;return new Rt(6|(l[0][0]!==h?0:65528),(l[g][0]+l[g][1])/2<<3|6)}{const g=l[2][0]!==h?2:3;return new Rt((l[g][0]+l[g][1])/2<<3|6,6|(l[2][0]!==h?0:65528))}}showCentroid(i){const l=this.centroidData[i.centroidDataIndex];l.flags&=2147483647,l.centroidXY.x=0,l.centroidXY.y=0,this.writeCentroidToBuffer(l)}writeCentroidToBuffer(i){this.groundEffect.updateHiddenByLandmark(i);const l=i.vertexArrayOffset,h=i.vertexCount+i.vertexArrayOffset,g=i.flags&Op?fx:i.centroidXY,x=this.centroidVertexArray.geta_centroid_pos0(l);if(this.centroidVertexArray.geta_centroid_pos1(l)!==g.y||x!==g.x){for(let b=l;b<h;++b)this.centroidVertexArray.emplace(b,g.x,g.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const i of this.centroidData)this.writeCentroidToBuffer(i)}updateReplacement(i,l,h){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const g=l.getReplacementRegionsForTile(i.toUnwrapped());if(H_(this.activeReplacements,g))return;if(this.activeReplacements=g,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const b of this.centroidData)b.flags&=2147483647;const x=[];for(const b of this.activeReplacements){if(b.order<h)continue;const j=Math.max(1,Math.pow(2,b.footprintTileId.canonical.z-i.canonical.z));if(b.footprint.buildingId){const M=b.footprint.buildingId;for(const R of this.centroidData)R.buildingId===M&&(R.flags|=Op)}else for(const M of this.centroidData)if(!(M.flags&Op||b.min.x>M.max.x||M.min.x>b.max.x||b.min.y>M.max.y||M.min.y>b.max.y))for(let R=0;R<M.footprintSegLen;R++){const L=this.footprintSegments[M.footprintSegIdx+R];if(x.length=0,K_(this.footprintVertices,L.vertexOffset,L.vertexCount,b.footprintTileId.canonical,i.canonical,x),Py(b.footprint,x,this.footprintIndices.uint16,L.indexOffset,L.indexCount,-L.vertexOffset,-j)){M.flags|=Op;break}}}for(const b of this.centroidData)this.writeCentroidToBuffer(b);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(i,l,h){let g=!1;for(let x=0;x<h.footprintSegLen;x++){const b=this.footprintSegments[h.footprintSegIdx+x];let j=0;for(const M of b.ringIndices){for(let R=j,L=M+j-1;R<M+j;L=R++){const U=this.footprintVertices.int16[2*(R+b.vertexOffset)+0],q=this.footprintVertices.int16[2*(R+b.vertexOffset)+1],ee=this.footprintVertices.int16[2*(L+b.vertexOffset)+1];q>l!=ee>l&&i<(this.footprintVertices.int16[2*(L+b.vertexOffset)+0]-U)*(l-q)/(ee-q)+U&&(g=!g)}j=M}}return g}getHeightAtTileCoord(i,l){let h=Number.NEGATIVE_INFINITY,g=!0;const x=4*(i+mn)*mn+(l+mn);if(this.partLookup.hasOwnProperty(x)){const b=this.partLookup[x];return b?{height:b.height,hidden:!!(b.flags&Op)}:void 0}for(const b of this.centroidData)i>b.max.x||b.min.x>i||l>b.max.y||b.min.y>l||b.height<=h||this.footprintContainsPoint(i,l,b)&&(h=b.height,this.partLookup[x]=b,g=!!(b.flags&Op));if(h!==Number.NEGATIVE_INFINITY)return{height:h,hidden:g};this.partLookup[x]=void 0}}function wf(u,i){const l=u.add(i)._unit();return u.x*l.x+u.y*l.y}function mN(u,i,l,h){const g=i.sub(u)._perp()._unit(),x=l.sub(i)._perp()._unit();return Mw(u,i,l,wf(g,x),h)}function Mw(u,i,l,h,g){const x=Math.sqrt(1-h*h);return Math.min(u.dist(i)/3,i.dist(l)/3,g*x/h)}function lg(u,i,l){return u.x<l[0].x&&i.x<l[0].x||u.x>l[1].x&&i.x>l[1].x||u.y<l[0].y&&i.y<l[0].y||u.y>l[1].y&&i.y>l[1].y}function f2(u,i){return u.x<i[0].x||u.x>i[1].x||u.y<i[0].y||u.y>i[1].y}function Rw(u,i,l){if(u.x<0||u.x>=mn||i.x<0||i.x>=mn||l.x<0||l.x>=mn)return!1;const h=l.sub(i),g=h.perp(),x=u.sub(i);return(h.x*x.x+h.y*x.y)/Math.sqrt((h.x*h.x+h.y*h.y)*(x.x*x.x+x.y*x.y))>-.866&&g.x*x.x+g.y*x.y<0}function mx(u,i,l){const h=i?2|u:-3&u;return l?1|h:-2&h}function Ow(){const u=Math.PI/32,i=Math.tan(u),l=I;return l*Math.sqrt(1+2*i*i)-l}function p2(u,i,l){const h=1<<l.z,g=be(l.x/h),x=be((l.x+1)/h),b=Ne(l.y/h),j=Ne((l.y+1)/h);return(function(M,R,L,U,q=0,ee){const te=[];if(!M.length||!L||!U)return te;const le=(Ke,Qe)=>{for(const dt of Ke)te.push({polygon:dt,bounds:Qe})},ue=Math.ceil(Math.log2(L)),ge=Math.ceil(Math.log2(U)),Se=ue-ge,we=[];for(let Ke=0;Ke<Math.abs(Se);Ke++)we.push(Se>0?0:1);for(let Ke=0;Ke<Math.min(ue,ge);Ke++)we.push(0),we.push(1);let Pe=M;if(Pe=_f(Pe,R[0].y-q,R[1].y+q,1),Pe=_f(Pe,R[0].x-q,R[1].x+q,0),!Pe.length)return te;const tt=[];for(we.length?tt.push({polygons:Pe,bounds:R,depth:0}):le(Pe,R);tt.length;){const Ke=tt.pop(),Qe=Ke.depth,dt=we[Qe],ft=Ke.bounds[0],Ft=Ke.bounds[1],xt=dt===0?ft.x:ft.y,Wt=dt===0?Ft.x:Ft.y,bn=ee?ee(dt,xt,Wt):.5*(xt+Wt),tn=_f(Ke.polygons,xt-q,bn+q,dt),dn=_f(Ke.polygons,bn-q,Wt+q,dt);if(tn.length){const xn=[ft,new Rt(dt===0?bn:Ft.x,dt===1?bn:Ft.y)];we.length>Qe+1?tt.push({polygons:tn,bounds:xn,depth:Qe+1}):le(tn,xn)}if(dn.length){const xn=[new Rt(dt===0?bn:ft.x,dt===1?bn:ft.y),Ft];we.length>Qe+1?tt.push({polygons:dn,bounds:xn,depth:Qe+1}):le(dn,xn)}}return te})(u,i,Math.ceil((x-g)/11.25),Math.ceil((b-j)/11.25),1,((M,R,L)=>{if(M===0)return .5*(R+L);{const U=Ne((l.y+R/mn)/h);return(pe(.5*(Ne((l.y+L/mn)/h)+U))*h-l.y)*mn}}))}function K_(u,i,l,h,g,x){const b=Math.pow(2,h.z-g.z);for(let j=0;j<l;j++){let M=u.int16[2*(j+i)+0],R=u.int16[2*(j+i)+1];M=(M+g.x*mn)*b-h.x*mn,R=(R+g.y*mn)*b-h.y*mn,x.push(new Rt(M,R))}}let gx,Dw;Hn(Lp,"FillExtrusionBucket",{omit:["layers","features"]}),Hn(Pw,"PartData"),Hn(Z_,"FootprintSegment"),Hn(Y_,"BorderCentroidData"),Hn(og,"GroundEffect");class Ld extends Rt{constructor(i,l,h){super(i,l),this.z=h}}class J_ extends Ld{constructor(i,l,h,g){super(i,l,h),this.w=g}}function yx(u,i,l,h){const g=l==="x"?"y":"x",x=(h-u[l])/(i[l]-u[l]);u[g]=Math.round(u[g]+(i[g]-u[g])*x),u[l]=h,u.hasOwnProperty("z")&&(u.z=yr(u.z,i.z,x)),u.hasOwnProperty("w")&&(u.w=yr(u.w,i.w,x))}function kw(u,i,l,h){const g=l,x=h;for(const b of["x","y"]){let j=u,M=i;j[b]>=M[b]&&(j=i,M=u),j[b]<g&&M[b]>g&&yx(j,M,b,g),j[b]<x&&M[b]>x&&yx(M,j,b,x)}}function Q_(u,i,l,h,g,x){const b=[];for(let j=0;j<u.length;j++){const M=u[j];let R;const L=b.length;let U=0;for(let q=0;q<M.length-1;q++){let ee=M[q],te=M[q+1],le=0;const ue=U;let ge,Se;x&&(le=Math.hypot(te.x-ee.x,te.y-ee.y),U+=le,ge=ee,Se=te),ee.x<i&&te.x<i||(ee.x<i?ee=new Rt(i,ee.y+(i-ee.x)/(te.x-ee.x)*(te.y-ee.y))._round():te.x<i&&(te=new Rt(i,ee.y+(i-ee.x)/(te.x-ee.x)*(te.y-ee.y))._round()),ee.y<l&&te.y<l||(ee.y<l?ee=new Rt(ee.x+(l-ee.y)/(te.y-ee.y)*(te.x-ee.x),l)._round():te.y<l&&(te=new Rt(ee.x+(l-ee.y)/(te.y-ee.y)*(te.x-ee.x),l)._round()),ee.x>=h&&te.x>=h||(ee.x>=h?ee=new Rt(h,ee.y+(h-ee.x)/(te.x-ee.x)*(te.y-ee.y))._round():te.x>=h&&(te=new Rt(h,ee.y+(h-ee.x)/(te.x-ee.x)*(te.y-ee.y))._round()),ee.y>=g&&te.y>=g||(ee.y>=g?ee=new Rt(ee.x+(g-ee.y)/(te.y-ee.y)*(te.x-ee.x),g)._round():te.y>=g&&(te=new Rt(ee.x+(g-ee.y)/(te.y-ee.y)*(te.x-ee.x),g)._round()),R&&ee.equals(R[R.length-1])||(R=[ee],b.push(R),x&&x.push({progress:{min:ue+m(ge,Se,ee)*le,max:1},parentIndex:j,prevPoint:ge,nextPoint:Se})),R.push(te),x&&(x[x.length-1].progress.max=ue+m(ge,Se,te)*le,x[x.length-1].nextPoint=Se)))))}if(x&&U>0)for(let q=L;q<b.length;q++)x[q].progress.min/=U,x[q].progress.max/=U}return b}function e0(u,i,l,h,g){if(u.length<2)return void h.push(u);const x=[];for(;i.valid();){const[R,L]=i.get();for(let U=0;U<u.length-1;U++){const q=u[U],ee=u[U+1],te=za(q,ee,R,L);if(te){const[le]=te,ue=new Rt(yr(q.x,ee.x,le),yr(q.y,ee.y,le));x.push({t:U+le,distance:0,point:ue})}}i.next()}if(x.length===0)return void h.push(u);x.sort(((R,L)=>R.t-L.t));let b=0,j=0,M=[];for(h.push(M);b!==u.length;){if(j===x.length){for(;b!==u.length;)M.length!==0&&M[M.length-1].equals(u[b])||M.push(u[b]),b++;break}x[j].t<=b?(M.length!==0&&M[M.length-1].equals(x[j].point)||M.push(x[j].point),Math.trunc(x[j].t),j++):(M.length!==0&&M[M.length-1].equals(u[b])||M.push(u[b]),b++)}}function m(u,i,l){return u.x!==i.x?(l.x-u.x)/(i.x-u.x):u.y!==i.y?(l.y-u.y)/(i.y-u.y):0}function _(u,i){return u.x*i.x+u.y*i.y}function C(u,i){if(u.length===1){let l=0;const h=i[l++];let g;for(;!g||h.equals(g);)if(g=i[l++],!g)return 1/0;for(;l<i.length;l++){const x=i[l],b=u[0],j=g.sub(h),M=x.sub(h),R=b.sub(h),L=_(j,j),U=_(j,M),q=_(M,M),ee=_(R,j),te=_(R,M),le=L*q-U*U,ue=(q*ee-U*te)/le,ge=(L*te-U*ee)/le,Se=h.z*(1-ue-ge)+g.z*ue+x.z*ge;if(isFinite(Se))return Se}return 1/0}{let l=1/0;for(const h of i)l=Math.min(l,h.z);return l}}function k(u,i,l,h,g,x,b,j){const M=b*g.getElevationAt(u,i,!0,!0),R=x[0]!==0,L=R?x[1]===0?b*(x[0]/7-450):b*(function(U,q,ee){const te=Math.floor(q[0]/8),le=Math.floor(q[1]/8),ue=10*(q[0]-8*te),ge=10*(q[1]-8*le),Se=U.getElevationAt(te,le,!0,!0),we=U.getMeterToDEM(ee),Pe=Math.floor(.5*(ue*we-1)),tt=Math.floor(.5*(ge*we-1)),Ke=U.tileCoordToPixel(te,le),Qe=2*Pe+1,dt=2*tt+1,ft=(function(dn,xn,Lt,hn,Tt){return[dn.getElevationAtPixel(xn,Lt,!0),dn.getElevationAtPixel(xn+Tt,Lt,!0),dn.getElevationAtPixel(xn,Lt+Tt,!0),dn.getElevationAtPixel(xn+hn,Lt+Tt,!0)]})(U,Ke.x-Pe,Ke.y-tt,Qe,dt),Ft=Math.abs(ft[0]-ft[1]),xt=Math.abs(ft[2]-ft[3]),Wt=Math.abs(ft[0]-ft[2])+Math.abs(ft[1]-ft[3]),bn=Math.min(.25,.5*we*(Ft+xt)/Qe),tn=Math.min(.25,.5*we*Wt/dt);return Se+Math.max(bn*ue,tn*ge)})(g,x,j):M;return{base:M+(l===0?-1:l),top:R?Math.max(L+h,M+l+2):M+h}}class W{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class ie{constructor(){this.tasks={},this.taskQueue=[],br(["process"],this),this.invoker=new W(this.process),this.nextId=0}add(i,l){const h=this.nextId++,g=(function({type:x,isSymbolTile:b,zoom:j}){return j=j||0,x==="message"?0:x!=="maybePrepare"||b?x!=="parseTile"||b?x==="parseTile"&&b?300-j:x==="maybePrepare"&&b?400-j:500:200-j:100-j})(l);if(g===0){try{i()}finally{}return null}return this.tasks[h]={fn:i,metadata:l,priority:g,id:h},this.taskQueue.push(h),this.invoker.trigger(),{cancel:()=>{delete this.tasks[h]}}}process(){try{if(this.taskQueue=this.taskQueue.filter((h=>!!this.tasks[h])),!this.taskQueue.length)return;const i=this.pick();if(i===null)return;const l=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let i=null,l=1/0;for(let g=0;g<this.taskQueue.length;g++){const x=this.tasks[this.taskQueue[g]];x.priority<l&&(l=x.priority,i=g)}if(i===null)return null;const h=this.taskQueue[i];return this.taskQueue.splice(i,1),h}remove(){this.invoker.remove()}}class Ae{constructor(i,l,h){this.target=i,this.parent=l,this.mapId=h,this.callbacks={},this.cancelCallbacks={},br(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new ie}send(i,l,h,g,x=!1,b){const j=Math.round(1e18*Math.random()).toString(36).substring(0,10);h&&(h.metadata=b,this.callbacks[j]=h);const M=new Set;return this.target.postMessage({id:j,type:i,hasCallback:!!h,targetMapId:g,mustQueue:x,sourceMapId:this.mapId,data:uu(l,M)},M),{cancel:()=>{h&&delete this.callbacks[j],this.target.postMessage({id:j,type:"<cancel>",targetMapId:g,sourceMapId:this.mapId})}}}receive(i){const l=i.data;if(!l)return;const h=l.id;if(h&&(!l.targetMapId||this.mapId===l.targetMapId))if(l.type==="<cancel>"){const g=this.cancelCallbacks[h];delete this.cancelCallbacks[h],g&&g.cancel()}else if(l.mustQueue||fr(self)){const g=this.callbacks[h],x=this.scheduler.add((()=>this.processTask(h,l)),g&&g.metadata||{type:"message"});x&&(this.cancelCallbacks[h]=x)}else this.processTask(h,l)}processTask(i,l){if(delete this.cancelCallbacks[i],l.type==="<response>"){const h=this.callbacks[i];delete this.callbacks[i],h&&(l.error?h(Aa(l.error)):h(null,Aa(l.data)))}else{const h=new Set,g=l.hasCallback?(b,j)=>{this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:b?uu(b):null,data:uu(j,h)},h)}:()=>{},x=Aa(l.data);if(this.parent[l.type])this.parent[l.type](l.sourceMapId,x,g);else if(this.parent.getWorkerSource){const b=l.type.split("."),{source:j,scope:M}=x;this.parent.getWorkerSource(l.sourceMapId,b[0],j,M)[b[1]](x,g)}else g(new Error(`Could not find function ${l.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var Xe={workerUrl:"",workerClass:null,workerParams:void 0};const Nt="mapboxgl_preloaded_worker_pool";class on{constructor(){this.active={}}acquire(i,l=on.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<l;)this.workers.push(Xe.workerClass!=null?new Xe.workerClass:new self.Worker(Xe.workerUrl,Xe.workerParams));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.workers&&this.numActive()===0&&(this.workers.forEach((l=>{l.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Nt]}numActive(){return Object.keys(this.active).length}}on.workerCount=2;class zn{constructor(i,l,h="Worker",g=on.workerCount){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=Kt();const x=this.workerPool.acquire(this.id,g);for(let b=0;b<x.length;b++){const j=new zn.Actor(x[b],l,this.id);j.name=`${h} ${b}`,this.actors.push(j)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(i,l,h){ht(this.actors,((g,x)=>{g.send(i,l,x)}),h=h||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((i=>{i.remove()})),this.actors=[],this.workerPool.release(this.id)}}let Yn,_n;function Tn(){return Yn||(Yn=new on),Yn}zn.Actor=Ae;class is{constructor(i){this.module=i}createIntArray(i){const l=new Int32Array(i),h=this.module.malloc(l.length*l.BYTES_PER_ELEMENT);return this.module.heap32.set(l,h/l.BYTES_PER_ELEMENT),h}createFloatArray(i){const l=new Float32Array(i),h=this.module.malloc(l.length*l.BYTES_PER_ELEMENT);return this.module.heapF32.set(l,h/l.BYTES_PER_ELEMENT),h}createStringBuffer(i){const l=this.module.malloc(i.length+1);for(let h=0;h<i.length;++h)this.module.heapU8[l+h]=i.charCodeAt(h);return this.module.heapU8[l+i.length]=0,l}readStringBuffer(i){let l="";for(;this.module.heapU8[i]!==0;)l+=String.fromCharCode(this.module.heapU8[i]),++i;return l}setStyle(i){const l=i.entranceColorRgb,h=i.facadeGlazingColorRgb,g=i.roofColorRgb,x=i.wallColorRgb,b=i.normalScale;this.module.setStyle(l[0],l[1],l[2],h[0],h[1],h[2],g[0],g[1],g[2],x[0],x[1],x[2],b[0],b[1],b[2],i.tileToMeters)}setAOOptions(i,l){this.module.setAOOptions(i?1:0,l)}setMetricOptions(i,l){this.module.setMetricOptions(i?1:0,l)}setStructuralOptions(i){this.module.setStructuralOptions(i?1:0)}setFacadeOptions(i,l){this.module.setFacadeOptions(i,l?1:0)}setFauxFacadeOptions(i,l,h){this.module.setFauxFacadeOptions(i?1:0,l?1:0,h)}setFacadeClassifierOptions(i){this.module.setFacadeClassifierOptions(i)}generateMesh(i,l){for(const j of i){const M=this.createStringBuffer(j.roofType),R=[0],L=[];for(const ee of j.coordinates)if(Array.isArray(ee)){for(const te of ee)L.push(te.x),L.push(te.y);R.push(L.length)}const U=this.createIntArray(R),q=this.createFloatArray(L);this.module.addFeature(j.id,j.sourceId,j.minHeight,j.height,M,j.roofType.length,q,U,R.length-1),this.module.free(M),this.module.free(U),this.module.free(q)}for(const j of l){let M;M=j.entrances?JSON.parse(j.entrances):[];const R=this.createFloatArray(M),L=[];for(const q of j.coordinates)L.push(q.x),L.push(q.y);const U=this.createFloatArray(L);this.module.addFacade(j.sourceId,j.crossPerc,j.distanceToRoad,R,M.length,U,L.length),this.module.free(R),this.module.free(U)}if(!this.module.generateMesh()){const j=this.module.getLastError();return this.readStringBuffer(j)}const h=this.module.getMeshCount(),g=new Array(h);for(let j=0;j<h;j++){const M=this.module.getPositionsPtr(j),R=this.module.getPositionsLength(j),L=new Float32Array(this.module.heapF32.buffer,M,R),U=this.module.getNormalsPtr(j),q=this.module.getNormalsLength(j),ee=new Float32Array(this.module.heapF32.buffer,U,q),te=this.module.getColorsPtr(j),le=this.module.getColorsLength(j),ue=new Uint8Array(this.module.heapU8.buffer,te,le),ge=this.module.getAOPtr(j),Se=this.module.getAOLength(j),we=new Float32Array(this.module.heapF32.buffer,ge,Se),Pe=this.module.getUVPtr(j),tt=this.module.getUVLength(j),Ke=new Float32Array(this.module.heapF32.buffer,Pe,tt),Qe=this.module.getFauxFacadePtr(j),dt=this.module.getFauxFacadeLength(j),ft=new Uint8Array(this.module.heapU8.buffer,Qe,dt),Ft=this.module.getIndicesPtr(j),xt=this.module.getIndicesLength(j),Wt=new Int32Array(this.module.heap32.buffer,Ft,xt),bn=this.module.getBuildingPart(j),tn=this.readStringBuffer(bn);g[j]={positions:L,normals:ee,colors:ue,ao:we,uv:Ke,isFauxFacade:ft,indices:Wt,buildingPart:tn}}const x=this.module.getRingCount(),b=[];for(let j=0;j<x;j++){const M=this.module.getRingPtr(j),R=this.module.getRingLength(j),L=new Float32Array(this.module.heapF32.buffer,M,R);b.push(L)}return{meshes:g,modifiedPolygonRings:b}}}let Li,ja,Qt,Ut,ln,Vn=null,ti=null,Os=null,wi=null;function Yi(){return fr(self)&&self.worker.dracoUrl?self.worker.dracoUrl:ja||Ua.DRACO_URL}function cl(){if(fr(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Ut)return Ut;const u=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Ut=WebAssembly.validate(u)?Ua.MESHOPT_SIMD_URL:Ua.MESHOPT_URL,Ut}function ya(){return wi}const zd={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},gN={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Iw={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function WF(u,i,l){const h=l.json.bufferViews.length,g=l.buffers.length;i.bufferView=h,l.json.bufferViews[h]={buffer:g,byteLength:u.byteLength},l.buffers[g]=u}const yN="KHR_draco_mesh_compression";function aie(u,i){const l=u.extensions&&u.extensions[yN];if(!l)return;const h=new Qt.Decoder,g=KF(i,l.bufferView),x=new Qt.Mesh;if(!h.DecodeArrayToMesh(g,g.byteLength,x))throw new Error("Failed to decode Draco mesh");const b=i.json.accessors[u.indices],j=zd[b.componentType],M=b.count*j.BYTES_PER_ELEMENT,R=Qt._malloc(M);j===Uint16Array?h.GetTrianglesUInt16Array(x,M,R):h.GetTrianglesUInt32Array(x,M,R),WF(Qt.memory.buffer.slice(R,R+M),b,i),Qt._free(R);for(const L of Object.keys(l.attributes)){const U=h.GetAttributeByUniqueId(x,l.attributes[L]),q=i.json.accessors[u.attributes[L]],ee=gN[q.componentType],te=q.count*Iw[q.type]*zd[q.componentType].BYTES_PER_ELEMENT,le=Qt._malloc(te);h.GetAttributeDataArrayForAllPoints(x,U,Qt[ee],te,le),WF(Qt.memory.buffer.slice(le,le+te),q,i),Qt._free(le)}h.destroy(),x.destroy(),delete u.extensions[yN]}const m2="EXT_meshopt_compression";function oie(u,i){if(!u.extensions||!u.extensions[m2])return;const l=u.extensions[m2],h=new Uint8Array(i.buffers[l.buffer],l.byteOffset||0,l.byteLength||0),g=new Uint8Array(l.count*l.byteStride);ln.decodeGltfBuffer(g,l.count,l.byteStride,h,l.mode,l.filter),u.buffer=i.buffers.length,u.byteOffset=0,i.buffers[u.buffer]=g.buffer,delete u.extensions[m2]}const XF=1179937895,ZF=new TextDecoder("utf8");function YF(u,i){return new URL(u,i).href}function lie(u,i,l,h){return fetch(YF(u.uri,h)).then((g=>g.arrayBuffer())).then((g=>{i.buffers[l]=g}))}function KF(u,i){const l=u.json.bufferViews[i];return new Uint8Array(u.buffers[l.buffer],l.byteOffset||0,l.byteLength)}function cie(u,i,l,h){if(u.uri){const g=YF(u.uri,h);return fetch(g).then((x=>x.blob())).then((x=>createImageBitmap(x))).then((x=>{i.images[l]=x}))}if(u.bufferView!==void 0){const g=KF(i,u.bufferView),x=new Blob([g],{type:u.mimeType});return createImageBitmap(x).then((b=>{i.images[l]=b}))}}function JF(u,i=0,l){const h={json:null,images:[],buffers:[]};if(new Uint32Array(u,i,1)[0]===XF){const L=new Uint32Array(u,i);let U=2;const q=(L[U++]>>2)-3,ee=L[U++]>>2;if(U++,h.json=JSON.parse(ZF.decode(L.subarray(U,U+ee))),U+=ee,U<q){const te=L[U++];U++;const le=i+(U<<2);h.buffers[0]=u.slice(le,le+te)}}else h.json=JSON.parse(ZF.decode(new Uint8Array(u,i)));const{buffers:g,images:x,meshes:b,extensionsUsed:j,bufferViews:M}=h.json;let R=Promise.resolve();if(g){const L=[];for(let U=0;U<g.length;U++){const q=g[U];q.uri?L.push(lie(q,h,U,l)):h.buffers[U]||(h.buffers[U]=null)}R=Promise.all(L)}return R.then((()=>{const L=[],U=j&&j.includes(yN),q=j&&j.includes(m2);if(U&&L.push((function(){if(!Qt)return Li??(Li=(function(ee){let te,le=null;function ue(){te=new Uint8Array(le.buffer)}function ge(){throw new Error("Unexpected Draco error.")}const Se={a:{a:ge,d:function(we,Pe,tt){return te.copyWithin(we,Pe,Pe+tt)},c:function(we){const Pe=te.length,tt=Math.max(we>>>0,Math.ceil(1.2*Pe)),Ke=Math.ceil((tt-Pe)/65536);try{return le.grow(Ke),ue(),!0}catch{return!1}},b:ge}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(ee,Se):ee.then((we=>we.arrayBuffer())).then((we=>WebAssembly.instantiate(we,Se)))).then((we=>{const{Rb:Pe,Qb:tt,P:Ke,T:Qe,X:dt,Ja:ft,La:Ft,Qa:xt,Va:Wt,Wa:bn,eb:tn,jb:dn,f:xn,e:Lt,yb:hn,zb:Tt,Ab:zt,Bb:wn,Db:pn,Gb:ur}=we.instance.exports;le=Lt;const Jn=(()=>{let cn=0,yn=0,er=0,Bn=0;return En=>{er&&(Pe(Bn),Pe(cn),yn+=er,er=cn=0),cn||(yn+=128,cn=tt(yn));const $n=En.length+7&-8;let Cr=cn;$n>=yn&&(er=$n,Cr=Bn=tt($n));for(let kr=0;kr<En.length;kr++)te[Cr+kr]=En[kr];return Cr}})();return ue(),xn(),{memory:Lt,_free:Pe,_malloc:tt,Mesh:class{constructor(){this.ptr=Ke()}destroy(){Qe(this.ptr)}},Decoder:class{constructor(){this.ptr=ft()}destroy(){dn(this.ptr)}DecodeArrayToMesh(cn,yn,er){const Bn=Jn(cn),En=Ft(this.ptr,Bn,yn,er.ptr);return!!dt(En)}GetAttributeByUniqueId(cn,yn){return{ptr:xt(this.ptr,cn.ptr,yn)}}GetTrianglesUInt16Array(cn,yn,er){Wt(this.ptr,cn.ptr,yn,er)}GetTrianglesUInt32Array(cn,yn,er){bn(this.ptr,cn.ptr,yn,er)}GetAttributeDataArrayForAllPoints(cn,yn,er,Bn,En){tn(this.ptr,cn.ptr,yn.ptr,er,Bn,En)}},DT_INT8:hn(),DT_UINT8:Tt(),DT_INT16:zt(),DT_UINT16:wn(),DT_UINT32:pn(),DT_FLOAT32:ur()}}))})(fetch(Yi())),Li.then((ee=>{Qt=ee,Li=void 0})))})()),q&&L.push((function(){if(ln)return;const ee=(function(te){let le;const ue=WebAssembly.instantiateStreaming(te,{}).then((we=>{le=we.instance,le.exports.__wasm_call_ctors()})),ge={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Se={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:ue,supported:!0,decodeGltfBuffer(we,Pe,tt,Ke,Qe,dt){(function(ft,Ft,xt,Wt,bn,tn,dn){const xn=ft.exports.sbrk,Lt=Wt+3&-4,hn=xn(Lt*bn),Tt=xn(tn.length),zt=new Uint8Array(ft.exports.memory.buffer);zt.set(tn,Tt);const wn=Ft(hn,Wt,bn,Tt,tn.length);if(wn===0&&dn&&dn(hn,Lt,bn),xt.set(zt.subarray(hn,hn+Wt*bn)),xn(hn-xn(0)),wn!==0)throw new Error(`Malformed buffer data: ${wn}`)})(le,le.exports[Se[Qe]],we,Pe,tt,Ke,le.exports[ge[dt]])}}})(fetch(cl()));return ee.ready.then((()=>{ln=ee}))})()),x)for(let ee=0;ee<x.length;ee++)L.push(cie(x[ee],h,ee,l));return(L.length?Promise.all(L):Promise.resolve()).then((()=>{if(U&&b)for(const{primitives:ee}of b)for(const te of ee)aie(te,h);if(q&&b&&M)for(const ee of M)oie(ee,h);return h}))}))}function vN(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function xN(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class _N{constructor(i,l,h,g){this.context=i,this.format=h,this.useMipmap=g&&g.useMipmap,this.texture=i.gl.createTexture(),this.update(l,{premultiply:g&&g.premultiply})}update(i,l){const h=i&&i instanceof HTMLVideoElement&&i.width===0?i.videoWidth:i.width,g=i&&i instanceof HTMLVideoElement&&i.height===0?i.videoHeight:i.height,{context:x}=this,{gl:b}=x,{x:j,y:M}=l&&l.position?l.position:{x:0,y:0},R=j+h,L=M+g;!this.size||this.size[0]===R&&this.size[1]===L||(b.bindTexture(b.TEXTURE_2D,null),b.deleteTexture(this.texture),this.texture=b.createTexture(),this.size=null),b.bindTexture(b.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===b.RGBA8&&(!l||l.premultiply!==!1));const U=i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||ImageBitmap&&i instanceof ImageBitmap;if(!this.size&&R>0&&L>0){const q=this.useMipmap?Math.floor(Math.log2(Math.max(R,L)))+1:1;b.texStorage2D(b.TEXTURE_2D,q,this.format,R,L),this.size=[R,L]}if(this.size)if(U)b.texSubImage2D(b.TEXTURE_2D,0,j,M,vN(this.format),xN(this.format),i);else{const q=i.data;q&&b.texSubImage2D(b.TEXTURE_2D,0,j,M,h,g,vN(this.format),xN(this.format),q)}this.useMipmap&&b.generateMipmap(b.TEXTURE_2D)}bind(i,l,h=!1){const{context:g}=this,{gl:x}=g;x.bindTexture(x.TEXTURE_2D,this.texture),i!==this.minFilter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,i),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,this.useMipmap&&!h?i===x.NEAREST?x.NEAREST_MIPMAP_NEAREST:x.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),l!==this.wrapS&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,l),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,l),this.wrapS=l)}bindExtraParam(i,l,h,g,x){const{context:b}=this,{gl:j}=b;j.bindTexture(j.TEXTURE_2D,this.texture),l!==this.magFilter&&(j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MAG_FILTER,l),this.magFilter=l),i!==this.minFilter&&(j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MIN_FILTER,this.useMipmap?i===j.NEAREST?j.NEAREST_MIPMAP_NEAREST:j.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),h!==this.wrapS&&(j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_S,h),this.wrapS=h),g!==this.wrapT&&(j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_T,g),this.wrapT=g),x!==this.compareMode&&(x?(j.texParameteri(j.TEXTURE_2D,j.TEXTURE_COMPARE_MODE,j.COMPARE_REF_TO_TEXTURE),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_COMPARE_FUNC,x)):j.texParameteri(j.TEXTURE_2D,j.TEXTURE_COMPARE_MODE,j.NONE),this.compareMode=x)}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class Lw{constructor(i,l){this.context=i,this.texture=l}bind(i,l){const{context:h}=this,{gl:g}=h;g.bindTexture(g.TEXTURE_2D,this.texture),i!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,i),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,i),this.minFilter=i),l!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,l),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,l),this.wrapS=l)}}const uie=Ai([{name:"a_pos_3f",components:3,type:"Float32"}]),die=Ai([{name:"a_color_3f",components:3,type:"Float32"}]),hie=Ai([{name:"a_color_4f",components:4,type:"Float32"}]),fie=Ai([{name:"a_uv_2f",components:2,type:"Float32"}]),pie=Ai([{name:"a_normal_3f",components:3,type:"Float32"}]),mie=Ai([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),gie=Ai([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);function QF(u,i){const l=g2(u.projection,u.zoom,u.width,u.height),h=(function(x,b,j,M,R){const L=new G(j.lng-180*Ry,j.lat),U=new G(j.lng+180*Ry,j.lat),q=x.project(L.lng,L.lat),ee=x.project(U.lng,U.lat),te=-Math.atan2(ee.y-q.y,ee.x-q.x),le=Ge.fromLngLat(j);le.y=Oe(le.y,-1+Ry,1-Ry);const ue=le.toLngLat(),ge=x.project(ue.lng,ue.lat),Se=Ge.fromLngLat(ue);Se.x+=Ry;const we=Se.toLngLat(),Pe=x.project(we.lng,we.lat),tt=tB(Pe.x-ge.x,Pe.y-ge.y,te),Ke=Ge.fromLngLat(ue);Ke.y+=Ry;const Qe=Ke.toLngLat(),dt=x.project(Qe.lng,Qe.lat),ft=tB(dt.x-ge.x,dt.y-ge.y,te),Ft=Math.abs(tt.x)/Math.abs(ft.y),xt=B([]);se(xt,xt,-te*(1-(R?0:M)));const Wt=B([]);return X(Wt,Wt,[1,1-(1-Ft)*M,1]),Wt[4]=-ft.x/ft.y*M,se(Wt,Wt,te),K(Wt,xt,Wt),Wt})(u.projection,0,u.center,l,i),g=eB(u);return X(h,h,[g,g,1]),h}function eB(u){const i=u.projection,l=g2(u.projection,u.zoom,u.width,u.height),h=bN(i,u.center),g=bN(i,G.convert(i.center));return Math.pow(2,h*l+(1-l)*g)}function g2(u,i,l,h,g=1/0){const x=u.range;if(!x)return 0;const b=Math.min(g,Math.max(l,h)),j=Math.log(b/1024)/Math.LN2;return ut(x[0]+j,x[1]+j,i)}const Ry=1/4e4;function bN(u,i){const l=Oe(i.lat,-Be,Be),h=new G(i.lng-180*Ry,l),g=new G(i.lng+180*Ry,l),x=u.project(h.lng,l),b=u.project(g.lng,l),j=Ge.fromLngLat(h),M=Ge.fromLngLat(g),R=b.x-x.x,L=b.y-x.y,U=M.x-j.x,q=M.y-j.y,ee=Math.sqrt((U*U+q*q)/(R*R+L*L));return Math.log(ee)/Math.LN2}function tB(u,i,l){const h=Math.cos(l),g=Math.sin(l);return{x:u*h-i*g,y:u*g+i*h}}function nB(u,i,l){B(u),se(u,u,Dr(i[2])),ae(u,u,Dr(i[0])),Z(u,u,Dr(i[1])),X(u,u,l),K(u,u,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function y2(u,i,l,h,g,x,b,j){const M=[l[0]-i[0],l[1]-i[1],0],R=[h[0]-i[0],h[1]-i[1],0];if(nt(M)<1e-12||nt(R)<1e-12)return Wn(u);const L=an([],M,R);Ot(L,L),it(R,h,i),M[2]=(x-g)*j,R[2]=(b-g)*j;const U=M;return an(U,M,R),Ot(U,U),Fe(u,L,U)}function wN(u,i,l=!1){const h=Pp(i.zoom),g=(function(x,b,j){const M=b.worldSize,R=[x[12],x[13],x[14]],L=Ne(R[1]/M),U=be(R[0]/M),q=B([]),ee=me(1,L)*M,te=me(1,0)*M*Ye(L,b.zoom),le=1/vf(M);let ue=te*le;if(j){const Pe=g2(b.projection,b.zoom,b.width,b.height,1024);ue=le*b.projection.pixelSpaceConversion(b.center.lat,M,Pe)}const ge=O(L,U);Ee(ge,ge,pt([],Ot([],ge),ee*ue*R[2]));const Se=(function(Pe){const tt=[Pe[0],Pe[1],Pe[2]];let Ke=[0,1,0];const Qe=an([],Ke,tt);return an(Ke,tt,Qe),jt(Ke)===0&&(Ke=[0,1,0],an(Qe,tt,Ke)),Ot(Qe,Qe),Ot(Ke,Ke),Ot(tt,tt),[Qe[0],Qe[1],Qe[2],0,Ke[0],Ke[1],Ke[2],0,tt[0],tt[1],tt[2],0,Pe[0],Pe[1],Pe[2],1]})(ge);X(q,q,[ue,ue,ue*ee]),Y(q,q,[-R[0],-R[1],-R[2]]);const we=K([],b.globeMatrix,Se);return K(we,we,q),K(we,we,x),we})(u,i,l);if(h>0){const x=(function(b,j){const M=j.worldSize,R=me(1,0)*M*Ye(j.center.lat,j.zoom)/vf(M),L=me(1,j.center.lat)*M,U=B([]);return Z(U,U,Dr(j.center.lng)),ae(U,U,Dr(j.center.lat)),Y(U,U,[0,0,qa]),X(U,U,[R,R,R*L]),Y(U,U,[j.point.x-.5*M,j.point.y-.5*M,0]),K(U,U,b),K(U,j.globeMatrix,U)})(u,i);return(function(b,j,M){const R=(te,le,ue)=>{const ge=nt(te),Se=nt(le),we=gf(te,le,ue);return pt(we,we,1/nt(we)*yr(ge,Se,ue))},L=R([b[0],b[1],b[2]],[j[0],j[1],j[2]],M),U=R([b[4],b[5],b[6]],[j[4],j[5],j[6]],M),q=R([b[8],b[9],b[10]],[j[8],j[9],j[10]],M),ee=gf([b[12],b[13],b[14]],[j[12],j[13],j[14]],M);return[L[0],L[1],L[2],0,U[0],U[1],U[2],0,q[0],q[1],q[2],0,ee[0],ee[1],ee[2],1]})(g,x,h)}return g}function rB(u,i,l,h){const g=ii.projectAabbCorners(h,l);let x=Number.MAX_VALUE,b=-1;for(let R=0;R<g.length;++R){const L=g[R];L[0]=(.5*L[0]+.5)*i.width,L[1]=(.5-.5*L[1])*i.height,L[2]<x&&(b=R,x=L[2])}const j=R=>new Rt(g[R][0],g[R][1]);let M;switch(b){case 0:case 6:M=[j(1),j(5),j(4),j(7),j(3),j(2),j(1)];break;case 1:case 7:M=[j(0),j(4),j(5),j(6),j(2),j(3),j(0)];break;case 3:case 5:M=[j(1),j(0),j(4),j(7),j(6),j(2),j(1)];break;default:M=[j(1),j(5),j(6),j(7),j(3),j(0),j(1)]}if(fs(u,M))return x}const vx=64,t0={CoordinateSpaceTile:1,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function iB(u,i,l,h,g,x,b,j,M,R=!1){const L=l.zoom,U=l.project(h),q=Ye(h.lat,L),ee=1/q;B(u),Y(u,u,[U.x+b[0]*ee,U.y+b[1]*ee,b[2]]);let te=1,le=1;const ue=l.worldSize;if(R){if(l.projection.name==="mercator"){let Pe=0;l.elevation&&(Pe=l.elevation.getAtPointOrZero(new Ge(U.x/ue,U.y/ue),0));const tt=qt([],[U.x,U.y,Pe,1],l.projMatrix)[3]/l.cameraToCenterDistance;te=tt,le=tt*Ye(l.center.lat,L)}else if(l.projection.name==="globe"){const Pe=wN(u,l),tt=[0,0,0,1];qt(tt,tt,K([],l.projMatrix,Pe));const Ke=tt[3]/l.cameraToCenterDistance,Qe=Pp(L),dt=l.projection.pixelsPerMeter(h.lat,ue)*Ye(h.lat,L),ft=l.projection.pixelsPerMeter(l.center.lat,ue)*Ye(l.center.lat,L);te=Ke/yr(dt,Ze(l.center.lat),Qe),le=Ke*q/dt,te*=ft,le*=ft}}else te=ee;X(u,u,[te,te,le]);const ge=[...u],Se=i.orientation,we=[];if(nB(we,[Se[0]+g[0],Se[1]+g[1],Se[2]+g[2]],x),K(u,ge,we),j&&l.elevation){let Pe=0;const tt=[];if(M&&l.elevation){Pe=(function(Qe,dt,ft,Ft,xt){const Wt=dt.elevation;if(!Wt)return 0;const bn=ii.projectAabbCorners(ft,Ft),tn=me(1,xt.lat)*dt.worldSize,dn=(function(yn,er){const Bn=[0,0,1],En=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const $n of En){const Cr=yn[$n.corners[0]],kr=yn[$n.corners[1]],si=yn[$n.corners[2]],Hr=[kr[0]-Cr[0],kr[1]-Cr[1],er*(kr[2]-Cr[2])],Mi=an(Hr,Hr,[si[0]-Cr[0],si[1]-Cr[1],er*(si[2]-Cr[2])]);Ot(Mi,Mi),$n.dotProductWithUp=Mt(Mi,Bn)}return En.sort((($n,Cr)=>$n.dotProductWithUp-Cr.dotProductWithUp)),En[0].corners})(bn,tn),xn=bn[dn[0]],Lt=bn[dn[1]],hn=bn[dn[2]],Tt=bn[dn[3]],zt=Wt.getAtPointOrZero(new Ge(xn[0]/dt.worldSize,xn[1]/dt.worldSize),0),wn=Wt.getAtPointOrZero(new Ge(Lt[0]/dt.worldSize,Lt[1]/dt.worldSize),0),pn=Wt.getAtPointOrZero(new Ge(hn[0]/dt.worldSize,hn[1]/dt.worldSize),0),ur=Wt.getAtPointOrZero(new Ge(Tt[0]/dt.worldSize,Tt[1]/dt.worldSize),0),Jn=(zt+ur)/2,cn=(wn+pn)/2;return Jn>cn?wn<pn?y2(Qe,Lt,Tt,xn,wn,ur,zt,tn):y2(Qe,hn,xn,Tt,pn,zt,ur,tn):zt<ur?y2(Qe,xn,Lt,hn,zt,wn,pn,tn):y2(Qe,Tt,hn,Lt,ur,pn,wn,tn),Math.max(Jn,cn)})(tt,l,i.aabb,u,h);const Ke=K([],Ce([],tt),we);K(u,ge,Ke)}else Pe=l.elevation.getAtPointOrZero(new Ge(U.x/ue,U.y/ue),0);Pe!==0&&(u[14]+=Pe)}}function zw(u,i,l=!1){u.uploaded||(u.gfxTexture=new _N(i,u.image,l?i.gl.R8:i.gl.RGBA8,{useMipmap:u.sampler.minFilter>=i.gl.NEAREST_MIPMAP_NEAREST}),u.uploaded=!0,u.image=null)}function yie(u,i,l){u.indexBuffer=i.createIndexBuffer(u.indexArray,!1,!0),u.vertexBuffer=i.createVertexBuffer(u.vertexArray,uie.members,!1,!0),u.normalArray&&(u.normalBuffer=i.createVertexBuffer(u.normalArray,pie.members,!1,!0)),u.texcoordArray&&(u.texcoordBuffer=i.createVertexBuffer(u.texcoordArray,fie.members,!1,!0)),u.colorArray&&(u.colorBuffer=i.createVertexBuffer(u.colorArray,(u.colorArray.bytesPerElement===12?die:hie).members,!1,!0)),u.featureArray&&(u.pbrBuffer=i.createVertexBuffer(u.featureArray,gie.members,!0)),u.segments=Hs.simpleSegment(0,0,u.vertexArray.length,u.indexArray.length);const h=u.material;h.pbrMetallicRoughness.baseColorTexture&&zw(h.pbrMetallicRoughness.baseColorTexture,i),h.pbrMetallicRoughness.metallicRoughnessTexture&&zw(h.pbrMetallicRoughness.metallicRoughnessTexture,i),h.normalTexture&&zw(h.normalTexture,i),h.occlusionTexture&&zw(h.occlusionTexture,i,l),h.emissionTexture&&zw(h.emissionTexture,i)}function SN(u,i,l){if(u.meshes)for(const h of u.meshes)yie(h,i,l);if(u.children)for(const h of u.children)SN(h,i,l)}function v2(u){if(u.meshes)for(const i of u.meshes)i.indexArray.destroy(),i.vertexArray.destroy(),i.colorArray&&i.colorArray.destroy(),i.normalArray&&i.normalArray.destroy(),i.texcoordArray&&i.texcoordArray.destroy(),i.featureArray&&i.featureArray.destroy();if(u.children)for(const i of u.children)v2(i)}function TN(u){if(u.meshes)for(const l of u.meshes)l.vertexBuffer&&(l.vertexBuffer.destroy(),l.indexBuffer.destroy(),l.normalBuffer&&l.normalBuffer.destroy(),l.texcoordBuffer&&l.texcoordBuffer.destroy(),l.colorBuffer&&l.colorBuffer.destroy(),l.pbrBuffer&&l.pbrBuffer.destroy(),l.segments.destroy(),l.material&&((i=l.material).pbrMetallicRoughness.baseColorTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),i.pbrMetallicRoughness.metallicRoughnessTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),i.normalTexture&&i.normalTexture.gfxTexture&&i.normalTexture.gfxTexture.destroy(),i.emissionTexture&&i.emissionTexture.gfxTexture&&i.emissionTexture.gfxTexture.destroy(),i.occlusionTexture&&i.occlusionTexture.gfxTexture&&i.occlusionTexture.gfxTexture.destroy()));var i;if(u.children)for(const l of u.children)TN(l)}function xx(u,i){const l=u.json.bufferViews[i.bufferView],h=zd[i.componentType];return new h(u.buffers[l.buffer],(i.byteOffset||0)+(l.byteOffset||0),i.count*(l.byteStride&&l.byteStride!==Iw[i.type]*h.BYTES_PER_ELEMENT?l.byteStride/h.BYTES_PER_ELEMENT:Iw[i.type]))}function AN(u,i,l,h){const g=zd[i.componentType],x=(function(L){switch(L){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}})(g),b=u.json.bufferViews[i.bufferView],j=b.byteStride?b.byteStride/g.BYTES_PER_ELEMENT:Iw[i.type],M=l.float32,R=M.length/l.capacity;for(let L=0,U=0;L<i.count*j;L+=j,U+=R)for(let q=0;q<R;q++)M[U+q]=h[L+q]*x;l._trim()}function vie(u,i,l){const h=u.indices,g=u.attributes,x={};x.indexArray=new ki;const b=i.json.accessors[h],j=b.count/3;x.indexArray.reserve(j);const M=xx(i,b);for(let q=0;q<j;q++)x.indexArray.emplaceBack(M[3*q],M[3*q+1],M[3*q+2]);x.indexArray._trim(),x.vertexArray=new wl;const R=i.json.accessors[g.POSITION];x.vertexArray.reserve(R.count);const L=xx(i,R);for(let q=0;q<R.count;q++)x.vertexArray.emplaceBack(L[3*q],L[3*q+1],L[3*q+2]);if(x.vertexArray._trim(),x.aabb=new ii(R.min,R.max),x.centroid=(function(q,ee){const te=[0,0,0],le=q.length;if(le>0){for(let ue=0;ue<le;ue++){const ge=3*q[ue];te[0]+=ee[ge],te[1]+=ee[ge+1],te[2]+=ee[ge+2]}te[0]/=le,te[1]/=le,te[2]/=le}return te})(M,L),g.COLOR_0!==void 0){const q=i.json.accessors[g.COLOR_0],ee=Iw[q.type],te=xx(i,q);x.colorArray=ee===3?new wl:new Nd,x.colorArray.resize(q.count),AN(i,q,x.colorArray,te)}if(g.NORMAL!==void 0){x.normalArray=new wl;const q=i.json.accessors[g.NORMAL];x.normalArray.resize(q.count);const ee=xx(i,q);AN(i,q,x.normalArray,ee)}if(g.TEXCOORD_0!==void 0&&l.length>0){x.texcoordArray=new Md;const q=i.json.accessors[g.TEXCOORD_0];x.texcoordArray.resize(q.count);const ee=xx(i,q);AN(i,q,x.texcoordArray,ee)}if(g._FEATURE_ID_RGBA4444!==void 0){const q=i.json.accessors[g._FEATURE_ID_RGBA4444];i.json.extensionsUsed&&i.json.extensionsUsed.includes("EXT_meshopt_compression")&&(x.featureData=xx(i,q))}g._FEATURE_RGBA4444!==void 0&&(x.featureData=new Uint32Array(xx(i,i.json.accessors[g._FEATURE_RGBA4444]).buffer));const U=u.material;return x.material=(function(q,ee){const{emissiveFactor:te=[0,0,0],alphaMode:le="OPAQUE",alphaCutoff:ue=.5,normalTexture:ge,occlusionTexture:Se,emissiveTexture:we,doubleSided:Pe}=q,{baseColorFactor:tt=[1,1,1,1],metallicFactor:Ke=1,roughnessFactor:Qe=1,baseColorTexture:dt,metallicRoughnessTexture:ft}=q.pbrMetallicRoughness||{},Ft=Se?ee[Se.index]:void 0;if(Se&&Se.extensions&&Se.extensions.KHR_texture_transform&&Ft){const xt=Se.extensions.KHR_texture_transform;Ft.offsetScale=[xt.offset[0],xt.offset[1],xt.scale[0],xt.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new ns(...tt),metallicFactor:Ke,roughnessFactor:Qe,baseColorTexture:dt?ee[dt.index]:void 0,metallicRoughnessTexture:ft?ee[ft.index]:void 0},doubleSided:Pe,emissiveFactor:new ns(...te),alphaMode:le,alphaCutoff:ue,normalTexture:ge?ee[ge.index]:void 0,occlusionTexture:Ft,emissionTexture:we?ee[we.index]:void 0,defined:q.defined===void 0}})(U!==void 0?i.json.materials[U]:{defined:!1},l),x}function sB(u,i,l){const{matrix:h,rotation:g,translation:x,scale:b,mesh:j,extras:M,children:R}=u,L={};if(L.matrix=h||(function(U,q,ee,te){var le=q[0],ue=q[1],ge=q[2],Se=q[3],we=le+le,Pe=ue+ue,tt=ge+ge,Ke=le*we,Qe=le*Pe,dt=le*tt,ft=ue*Pe,Ft=ue*tt,xt=ge*tt,Wt=Se*we,bn=Se*Pe,tn=Se*tt,dn=te[0],xn=te[1],Lt=te[2];return U[0]=(1-(ft+xt))*dn,U[1]=(Qe+tn)*dn,U[2]=(dt-bn)*dn,U[3]=0,U[4]=(Qe-tn)*xn,U[5]=(1-(Ke+xt))*xn,U[6]=(Ft+Wt)*xn,U[7]=0,U[8]=(dt+bn)*Lt,U[9]=(Ft-Wt)*Lt,U[10]=(1-(Ke+ft))*Lt,U[11]=0,U[12]=ee[0],U[13]=ee[1],U[14]=ee[2],U[15]=1,U})([],g||[0,0,0,1],x||[0,0,0],b||[1,1,1]),j!==void 0){L.meshes=l[j];const U=L.anchor=[0,0];for(const q of L.meshes){const{min:ee,max:te}=q.aabb;U[0]+=ee[0]+te[0],U[1]+=ee[1]+te[1]}U[0]=Math.floor(U[0]/L.meshes.length/2),U[1]=Math.floor(U[1]/L.meshes.length/2)}if(M&&(M.id&&(L.id=M.id),M.lights&&(L.lights=(function(U){if(!U.length)return[];const q=(function(ge){const Se=atob(ge),we=new Uint8Array(Se.length);for(let Pe=0;Pe<Se.length;Pe++)we[Pe]=Se.codePointAt(Pe);return we})(U),ee=[],te=q.length/24,le=new Uint16Array(q.buffer),ue=new Float32Array(q.buffer);for(let ge=0;ge<te;ge++){const Se=le[2*ge*6]/30,we=le[2*ge*6+1]/30,Pe=le[2*ge*6+10]/100,tt=ue[6*ge+1],Ke=ue[6*ge+2],Qe=ue[6*ge+3],dt=ue[6*ge+4],ft=Qe-tt,Ft=dt-Ke,xt=Math.hypot(ft,Ft);ee.push({pos:[tt+.5*ft,Ke+.5*Ft,we],normal:[Ft/xt,-ft/xt,0],width:xt,height:Se,depth:Pe,points:[tt,Ke,Qe,dt]})}return ee})(M.lights))),R){const U=[];for(const q of R)U.push(sB(i.json.nodes[q],i,l));L.children=U}return L}function xie(u){if(u.vertices.length===0||u.indices.length===0)return null;const i=new Rp(u.vertices,u.indices,8,256),[l,h]=[i.min.clone(),i.max.clone()];return{vertices:u.vertices,indices:u.indices,grid:i,min:l,max:h}}function _ie(u){if(!u.extras||!u.extras.ground)return null;const i=u.extras.ground;if(!i||!Array.isArray(i)||i.length===0)return null;const l=i[0];if(!l||!Array.isArray(l)||l.length===0)return null;const h=[];for(const b of l){if(!Array.isArray(b)||b.length!==2)continue;const j=b[0],M=b[1];typeof j=="number"&&typeof M=="number"&&h.push(new Rt(j,M))}if(h.length<3)return null;h.length>1&&h[h.length-1].equals(h[0])&&h.pop();let g=0;for(let b=0;b<h.length;b++){const j=h[b],M=h[(b+1)%h.length],R=h[(b+2)%h.length];g+=(j.x-M.x)*(R.y-M.y)-(R.x-M.x)*(j.y-M.y)}g>0&&h.reverse();const x=ng(h.flatMap((b=>[b.x,b.y])),[]);return x.length===0?null:{vertices:h,indices:x}}function bie(u,i){const l=[],h=[];let g=0;const x=[];for(const b of u){g=l.length;const j=b.vertexArray.float32,M=b.indexArray.uint16;for(let R=0;R<b.vertexArray.length;R++)x[0]=j[3*R+0],x[1]=j[3*R+1],x[2]=j[3*R+2],Cn(x,x,i),l.push(new Rt(x[0],x[1]));for(let R=0;R<3*b.indexArray.length;R++)h.push(M[R]+g)}if(h.length%3!=0)return null;for(let b=0;b<h.length;b+=3){const j=l[h[b+0]],M=l[h[b+1]],R=l[h[b+2]];(j.x-M.x)*(R.y-M.y)-(R.x-M.x)*(j.y-M.y)>0&&([h[b+1],h[b+2]]=[h[b+2],h[b+1]])}return{vertices:l,indices:h}}function aB(u){const i=(function(M,R){const L=[],U=WebGL2RenderingContext;if(M.json.textures)for(const q of M.json.textures){const ee={magFilter:U.LINEAR,minFilter:U.NEAREST,wrapS:U.REPEAT,wrapT:U.REPEAT};q.sampler!==void 0&&Object.assign(ee,M.json.samplers[q.sampler]),L.push({image:R[q.source],sampler:ee,uploaded:!1})}return L})(u,u.images),l=(function(M,R){const L=[];for(const U of M.json.meshes){const q=[];for(const ee of U.primitives)q.push(vie(ee,M,R));L.push(q)}return L})(u,i),{scenes:h,scene:g,nodes:x}=u.json,b=h?h[g||0].nodes:x,j=[];for(const M of b)j.push(sB(x[M],u,l));return(function(M,R,L){const U={},q=new Set;for(let ee=0;ee<M.length;ee++){const te=L[R[ee]];if(!te.extras)continue;const le=te.extras["mapbox:footprint:version"],ue=te.extras["mapbox:footprint:id"];(le||ue)&&q.add(ee),le==="1.0.0"&&ue&&(U[ue]=ee)}for(let ee=0;ee<M.length;ee++){if(q.has(ee))continue;const te=M[ee],le=L[R[ee]];if(!le.extras)continue;let ue=null;te.id in U&&(ue=bie(M[U[te.id]].meshes,te.matrix)),ue||(ue=_ie(le)),ue&&(te.footprint=xie(ue))}if(q.size>0){const ee=Array.from(q.values()).sort(((te,le)=>te-le));for(let te=ee.length-1;te>=0;te--)M.splice(ee[te],1)}})(j,b,u.json.nodes),j}function wie(u){u.heightmap=new Float32Array(4096),u.heightmap.fill(-1);const i=u.vertexArray.float32,l=u.aabb.min[0]-1,h=u.aabb.min[1]-1,g=vx/(u.aabb.max[0]-l+2),x=vx/(u.aabb.max[1]-h+2);for(let b=0;b<i.length;b+=3){const j=i[b+2],M=(i[b+0]-l)*g|0,R=(i[b+1]-h)*x|0;j>u.heightmap[R*vx+M]&&(u.heightmap[R*vx+M]=j)}}function oB(u,i,l,h,g){l.reserve(l.length+4*u.length),h.reserve(h.length+10*u.length),g.reserve(g.length+10*u.length);let x=h.length;for(const b of u){const j=Math.min(10,Math.max(4,1.3*b.height))*i,M=[-b.normal[1],b.normal[0],0],R=Math.min(.29,.1*b.width/b.depth),L=b.width-2*b.depth*i*(R+.01),U=We([],b.pos,M,L/2),q=We([],b.pos,M,-L/2),ee=[U[0],U[1],U[2]+b.height],te=[q[0],q[1],q[2]+b.height],le=We([],b.normal,M,R);pt(le,le,j);const ue=We([],b.normal,M,-R);pt(ue,ue,j),Ee(le,U,le),Ee(ue,q,ue),U[2]+=.1,q[2]+=.1,h.emplaceBack(le[0],le[1],le[2]),h.emplaceBack(ue[0],ue[1],ue[2]),h.emplaceBack(U[0],U[1],U[2]),h.emplaceBack(q[0],q[1],q[2]),h.emplaceBack(ee[0],ee[1],ee[2]),h.emplaceBack(te[0],te[1],te[2]),h.emplaceBack(U[0],U[1],U[2]),h.emplaceBack(q[0],q[1],q[2]),h.emplaceBack(le[0],le[1],le[2]),h.emplaceBack(ue[0],ue[1],ue[2]);const ge=L/j/2;g.emplaceBack(-ge-R,-1,ge,.8),g.emplaceBack(ge+R,-1,ge,.8),g.emplaceBack(-ge,0,ge,1.3),g.emplaceBack(ge,0,ge,1.3),g.emplaceBack(ge+R,-.8,ge,.7),g.emplaceBack(ge+R,-.8,ge,.7),g.emplaceBack(0,0,ge,1.3),g.emplaceBack(0,0,ge,1.3),g.emplaceBack(ge+R,-1.2,ge,.8),g.emplaceBack(ge+R,-1.2,ge,.8),l.emplaceBack(6+x,4+x,8+x),l.emplaceBack(7+x,9+x,5+x),l.emplaceBack(0+x,1+x,2+x),l.emplaceBack(1+x,3+x,2+x),x+=10}}function Sie(u,i){const l={};l.indexArray=new ki,l.vertexArray=new wl,l.colorArray=new Nd,oB(u,i,l.indexArray,l.vertexArray,l.colorArray);const h={defined:!0};h.emissiveFactor=ns.black;const g={};return g.baseColorFactor=ns.white,h.pbrMetallicRoughness=g,l.material=h,l.aabb=new ii([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),l}const lB=Ai([{name:"a_pos_3f",components:3,type:"Float32"}]),Tie=Ai([{name:"a_normal_3",components:3,type:"Int16"}]),cB=Ai([{name:"a_part_color_emissive",components:2,type:"Uint16"}]),Aie=Ai([{name:"a_bloom_attenuation",components:4,type:"Float32"}]),uB=At.types,jN=32767;function jie(u,i){const l=mn+i;for(const h of u)for(const g of h)if(g.x<-i||g.x>l||g.y<-i||g.y>l)return!1;return!0}class dB{constructor(i){this.layoutAOArray=[],this.indexArrayForConflationUploaded=!1,this.maxHeight=0,this.replacementUpdateTime=0,this.activeReplacements=[],this.footprints=[],this.featuresOnBorder=[],this.buildingFeatures=[],this.footprintLookup={},this.zoom=i.zoom,this.canonical=i.canonical,this.layers=i.layers,this.layerIds=this.layers.map((l=>l.fqid)),this.index=i.index,this.hasPattern=!1,this.worldview=i.worldview,this.layoutVertexArray=new wl,this.layoutNormalArray=new uf,this.layoutColorArray=new Vo,this.indexArray=new ki,this.indexArrayForConflation=new ki,this.entranceBloom={layoutVertexArray:new wl,layoutVertexBuffer:null,layoutAttenuationArray:new Nd,layoutAttenuationBuffer:null,layoutColorArray:new Vo,layoutColorBuffer:null,indexArray:new ki,indexArrayForConflation:new ki,indexBuffer:null,segmentsBucket:new Hs},this.programConfigurations=new Ul(i.layers,{zoom:i.zoom,lut:i.lut}),this.segmentsBucket=new Hs,this.stateDependentLayerIds=this.layers.filter((l=>l.isStateDependent())).map((l=>l.id)),this.projection=i.projection,this.groundEffect=new og(i)}get segments(){return this.segmentsBucket}get bloomGeometry(){return this.entranceBloom}updateFootprints(i,l){for(const h of this.footprints)l.push({footprint:h,id:i})}prepare(){return(function(){if(wi!=null||Os!=null)return null;if(ti!=null)return ti;const i=fetch(Ua.BUILDING_GEN_URL);return ti=(function(l){let h,g,x,b;function j(){h=new Uint8Array(b.buffer),g=new Int32Array(b.buffer),x=new Float32Array(b.buffer)}function M(){throw new Error("Unexpected BuildingGen error.")}const R=()=>{},L={a:{a:M,f:function(U){const q=h.length,ee=Math.max(U>>>0,Math.ceil(1.2*q)),te=Math.ceil((ee-q)/65536);try{return b.grow(te),j(),!0}catch{return!1}},g:M,b:R,c:R,d:R,e:R}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(l,L):l.then((U=>U.arrayBuffer())).then((U=>WebAssembly.instantiate(U,L)))).then((U=>{const q=U.instance.exports;return(0,q.g)(),b=q.f,j(),new is({setStyle:q.h,setAOOptions:q.i,setMetricOptions:q.j,setStructuralOptions:q.k,setFacadeOptions:q.l,setFauxFacadeOptions:q.m,setFacadeClassifierOptions:q.n,addFeature:q.o,addFacade:q.p,generateMesh:q.q,getLastError:q.r,getMeshCount:q.s,getPositionsPtr:q.t,getPositionsLength:q.u,getNormalsPtr:q.v,getNormalsLength:q.w,getColorsPtr:q.x,getColorsLength:q.y,getAOPtr:q.z,getAOLength:q.A,getUVPtr:q.B,getUVLength:q.C,getFauxFacadePtr:q.D,getFauxFacadeLength:q.E,getIndicesPtr:q.F,getIndicesLength:q.G,getBuildingPart:q.H,getRingCount:q.I,getRingPtr:q.J,getRingLength:q.K,free:q.L,malloc:q.M,heapU8:h,heap32:g,heapF32:x})}))})(i).then((l=>(ti=null,wi=l,wi))).catch((l=>{ai("Could not load building-gen"),ti=null,Os=l})),ti})()}populate(i,l,h,g){const x=ya();if(!x)return;const b=qe(h);this.tileToMeter=b,this.brightness=l.brightness,x.setStyle({convertToMeters:!1,entranceColorRgb:[1,1,1],facadeGlazingColorRgb:[.5607843137254902,.6745098039215687,.7215686274509804],normalScale:[1,-1,b],ridgeHeight:3,roofColorRgb:[.886274516,.784313738,.713725507],tileToMeters:b,tileZoom:16,wallColorRgb:[.988235294,.933333337,.811764717]}),x.setAOOptions(!1,.3),x.setMetricOptions(!1,16),x.setStructuralOptions(!0),x.setFacadeOptions(4,!0),x.setFauxFacadeOptions(!1,!1,1),x.setFacadeClassifierOptions(3);const j=new Map;for(const{feature:M}of i){if(uB[M.type]!=="LineString")continue;const R=this.layers[0]._featureFilter.needGeometry,L=Dt(M,R);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom),L,h))continue;const U=R?L.geometry:at(M,h,g),q=[];for(const ue of U)for(const ge of ue)q.push({x:ge.x,y:ge.y});const ee={coordinates:q,crossPerc:M.properties.cross_perc,distanceToRoad:M.properties.distance_to_road,entrances:M.properties.entrances,sourceId:0},te=M.properties.source_id;let le=j.get(te);le||(le=[],j.set(te,le)),le.push(ee)}this.maxHeight=0;for(const{feature:M,index:R}of i){if(uB[M.type]==="LineString")continue;const L=this.layers[0]._featureFilter.needGeometry,U=Dt(M,L);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom),U,h))continue;const q=L?U.geometry:at(M,h,g),ee=ux(q,500);if(!jie(q,163))continue;const te=this.layers[0],le=te.layout.get("building-base").evaluate(M,{},h),ue=te.layout.get("building-height").evaluate(M,{},h),ge=te.layout.get("building-roof-shape").evaluate(M,{},h),Se=te.paint.get("building-ambient-occlusion-intensity"),we=te.paint.get("building-ambient-occlusion-ground-radius")/this.tileToMeter;if(ge==="flat")continue;const Pe=M.properties.source_id;let tt;tt=j.has(Pe)?j.get(Pe):[];const Ke=[],Qe=new Rt(1/0,1/0),dt=new Rt(-1/0,-1/0);for(const cn of ee)if(cn.length>0){const yn=[];for(const er of cn){const Bn=[];for(let En=er.length-1;En>=0;En--){const $n=er[En];Bn.push({x:$n.x,y:$n.y}),Qe.x=Math.min(Qe.x,$n.x),Qe.y=Math.min(Qe.y,$n.y),dt.x=Math.max(dt.x,$n.x),dt.y=Math.max(dt.y,$n.y)}yn.push(Bn)}Ke.push({id:M.id,height:ue,minHeight:le,sourceId:0,roofType:ge,coordinates:yn})}const ft=x.generateMesh(Ke,tt);if(typeof ft=="string"||ft.meshes.length===0||ft.modifiedPolygonRings.length===0)continue;let Ft=0;for(const cn of ft.meshes)Ft+=cn.positions.length/3;const xt=this.segmentsBucket.prepareSegment(Ft,this.layoutVertexArray,this.indexArray),Wt=[];let bn=null,tn=0,dn=-1;const xn=this.indexArray.length;let Lt=0;for(const cn of ft.meshes){const yn=this.layoutVertexArray.length;if(cn.buildingPart==="entrance"){const Bn=new Array;for(let kr=0;kr<cn.indices.length;kr+=12){const si=cn.positions[kr+0],Hr=cn.positions[kr+1],Mi=cn.positions[kr+3],gi=cn.positions[kr+4],Gs=cn.positions[kr+2],Ie=cn.positions[kr+8]-Gs,Le=1,It=Mi-si,Sn=gi-Hr,kn=Math.hypot(It,Sn);Bn.push({pos:[si+.5*It,Hr+.5*Sn,Gs],normal:[Sn/kn,-It/kn,0],width:kn,height:Ie,depth:Le,points:[si,Hr,Mi,gi]})}const En=this.entranceBloom.segmentsBucket.prepareSegment(10*Bn.length,this.entranceBloom.layoutVertexArray,this.entranceBloom.indexArray),$n=this.entranceBloom.layoutVertexArray.length;tn=this.entranceBloom.indexArray.length,oB(Bn,.5/this.tileToMeter,this.entranceBloom.indexArray,this.entranceBloom.layoutVertexArray,this.entranceBloom.layoutAttenuationArray);const Cr=this.entranceBloom.layoutVertexArray.length-$n;dn=this.entranceBloom.indexArray.length-tn;for(let kr=0;kr<Cr;kr++)this.entranceBloom.layoutColorArray.emplaceBack(65535,65535);En.vertexLength+=Cr,En.primitiveLength+=dn,bn={part:cn.buildingPart,vertexOffset:$n,vertexLength:Cr}}for(let Bn=0;Bn<cn.positions.length;Bn+=3)Lt=Math.max(Lt,cn.positions[Bn+2]),this.layoutVertexArray.emplaceBack(cn.positions[Bn],cn.positions[Bn+1],cn.positions[Bn+2]);for(let Bn=0;Bn<cn.normals.length;Bn+=3)this.layoutNormalArray.emplaceBack(cn.normals[Bn+0]*jN,cn.normals[Bn+1]*jN,cn.normals[Bn+2]*jN);for(let Bn=0;Bn<cn.ao.length;Bn++)this.layoutAOArray.push(cn.ao[Bn]);for(let Bn=0;Bn<cn.colors.length;Bn+=3){const En=1+(cn.ao[Bn/3]-1)*Se;this.layoutColorArray.emplaceBack(cn.colors[Bn]*En<<8|cn.colors[Bn+1]*En,cn.colors[Bn+2]*En<<8)}const er=xt.vertexLength;for(let Bn=0;Bn<cn.indices.length;Bn+=3)this.indexArray.emplaceBack(er+cn.indices[Bn],er+cn.indices[Bn+1],er+cn.indices[Bn+2]);xt.vertexLength+=cn.positions.length/3,xt.primitiveLength+=cn.indices.length/3,(cn.buildingPart==="roof"||cn.buildingPart==="wall"||cn.buildingPart==="facade_glazing"||cn.buildingPart==="entrance")&&Wt.push({part:cn.buildingPart,vertexOffset:yn,vertexLength:cn.positions.length/3})}this.maxHeight=Math.max(this.maxHeight,Lt),this.buildingFeatures.push({feature:U,segment:xt,parts:Wt,buildingBloom:bn});const hn=this.indexArray.length-xn,Tt=[],zt=[],wn=new Rt(1/0,1/0),pn=new Rt(-1/0,-1/0),ur=this.groundEffect.vertexArray.length;for(const cn of ft.modifiedPolygonRings){const yn=[],er=new Rt(1/0,1/0),Bn=new Rt(-1/0,-1/0);for(let En=0;En<cn.length;En+=2){const $n=cn.length-En-2;er.x=Math.min(er.x,cn[$n]),er.y=Math.min(er.y,cn[$n+1]),Bn.x=Math.max(Bn.x,cn[$n]),Bn.y=Math.max(Bn.y,cn[$n+1]);const Cr=new Rt(cn[$n],cn[$n+1]);yn.push(Cr),Tt.push(Cr.x,Cr.y),zt.push(Cr.clone())}wn.x=Math.min(wn.x,er.x),wn.y=Math.min(wn.y,er.y),pn.x=Math.max(pn.x,Bn.x),pn.y=Math.max(pn.y,Bn.y),this.groundEffect.addData(yn,[er,Bn],we)}const Jn=this.groundEffect.vertexArray.length-ur;(Qe.x<0||dt.x>mn||Qe.y<0||dt.y>mn)&&this.featuresOnBorder.push({featureId:M.id,footprintIndex:this.footprints.length});{const cn=ng(Tt,null,2),yn=new Rp(zt,cn,8,256);let er=M.id;M.properties&&M.properties.hasOwnProperty("building_id")&&(er=M.properties.building_id),this.footprints.push({vertices:zt,indices:cn,grid:yn,min:wn,max:pn,buildingId:er,hiddenFlags:0,indicesOffset:xn,indicesLength:hn,bloomIndicesOffset:tn,bloomIndicesLength:dn,groundEffectVertexOffset:ur,groundEffectVertexLength:Jn,segment:xt,height:Lt})}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,M,R,{},l.availableImages,h,l.brightness),this.groundEffect.addPaintPropertiesData(M,R,{},l.availableImages,h,l.brightness)}this.groundEffect.prepareBorderSegments(),this.evaluate(this.layers[0])}update(i,l,h,g,x,b,j){this.programConfigurations.updatePaintArrays(i,l,x,h,g,b,j),this.groundEffect.update(i,l,x,h,g,b,j)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,lB.members),this.layoutNormalBuffer=i.createVertexBuffer(this.layoutNormalArray,Tie.members),this.entranceBloom.layoutVertexBuffer=i.createVertexBuffer(this.entranceBloom.layoutVertexArray,lB.members),this.entranceBloom.layoutAttenuationBuffer=i.createVertexBuffer(this.entranceBloom.layoutAttenuationArray,Aie.members),this.uploadUpdatedColorBuffer(i),this.uploadUpdatedIndexBuffer(i),this.groundEffect.upload(i)),this.groundEffect.uploadPaintProperties(i),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.layoutNormalBuffer.destroy(),this.layoutColorBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segmentsBucket.destroy(),this.entranceBloom.layoutVertexBuffer.destroy(),this.entranceBloom.layoutColorBuffer.destroy(),this.entranceBloom.layoutAttenuationBuffer.destroy(),this.entranceBloom.indexBuffer.destroy(),this.entranceBloom.segmentsBucket.destroy())}updateFootprintHiddenFlags(i,l,h=!0){let g=!1;const x=h?l:0,b=0|(h?-1:~l);this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const j of i){const M=this.footprints[j],R=M.hiddenFlags&b|x;M.hiddenFlags!==R&&(M.hiddenFlags=R,g=!0,this.groundEffect.updateHiddenByLandmarkRange(M.groundEffectVertexOffset,M.groundEffectVertexLength,M.hiddenFlags!==0))}return g&&(this.indexArrayForConflationUploaded=!1),g}uploadUpdatedIndexBuffer(i){if(this.groundEffect.uploadHiddenByLandmark(i),!this.indexArrayForConflationUploaded&&this.indexArray.length!==0){this.indexArrayForConflation.resize(this.indexArray.length),this.indexArrayForConflation.uint16.set(this.indexArray.uint16),this.entranceBloom.indexArrayForConflation.resize(this.entranceBloom.indexArray.length),this.entranceBloom.indexArrayForConflation.uint16.set(this.entranceBloom.indexArray.uint16);for(const l of this.footprints){const h=l.indicesOffset+l.indicesLength;if(l.hiddenFlags!==0){for(let x=l.indicesOffset;x<h;x++)this.indexArrayForConflation.uint16[3*x+0]=0,this.indexArrayForConflation.uint16[3*x+1]=0,this.indexArrayForConflation.uint16[3*x+2]=0;const g=l.bloomIndicesOffset+l.bloomIndicesLength;for(let x=l.bloomIndicesOffset;x<g;x++)this.entranceBloom.indexArrayForConflation.uint16[3*x+0]=0,this.entranceBloom.indexArrayForConflation.uint16[3*x+1]=0,this.entranceBloom.indexArrayForConflation.uint16[3*x+2]=0}}this.indexBuffer?this.indexBuffer.updateData(this.indexArrayForConflation):this.indexBuffer=i.createIndexBuffer(this.indexArrayForConflation,!0),this.entranceBloom.indexBuffer?this.entranceBloom.indexBuffer.updateData(this.entranceBloom.indexArrayForConflation):this.entranceBloom.indexBuffer=i.createIndexBuffer(this.entranceBloom.indexArrayForConflation,!0),this.indexArrayForConflationUploaded=!0}}uploadUpdatedColorBuffer(i){this.layoutColorBuffer?this.layoutColorBuffer.updateData(this.layoutColorArray):this.layoutColorBuffer=i.createVertexBuffer(this.layoutColorArray,cB.members,!0),this.entranceBloom.layoutColorBuffer?this.entranceBloom.layoutColorBuffer.updateData(this.entranceBloom.layoutColorArray):this.entranceBloom.layoutColorBuffer=i.createVertexBuffer(this.entranceBloom.layoutColorArray,cB.members,!0)}evaluate(i){const l=i.paint.get("building-ambient-occlusion-intensity");for(const h of this.buildingFeatures){const g=h.feature;g.properties["building-part"]="roof";const x=i.paint.get("building-color").evaluate(g,{},this.canonical),b=i.paint.get("building-emissive-strength").evaluate(g,{},this.canonical);g.properties["building-part"]="wall";const j=i.paint.get("building-color").evaluate(g,{},this.canonical),M=i.paint.get("building-emissive-strength").evaluate(g,{},this.canonical);g.properties["building-part"]="window";const R=i.paint.get("building-color").evaluate(g,{},this.canonical),L=i.paint.get("building-emissive-strength").evaluate(g,{},this.canonical);g.properties["building-part"]="door";const U=i.paint.get("building-color").evaluate(g,{},this.canonical),q=i.paint.get("building-emissive-strength").evaluate(g,{},this.canonical);for(const te of h.parts){let le,ue=x;te.part==="roof"?(ue=x,le=b):te.part==="wall"?(ue=j,le=M):te.part==="facade_glazing"?(ue=R,le=L):te.part==="entrance"&&(ue=U,le=q),le=Oe(le,0,1);for(let ge=0;ge<te.vertexLength;ge++){const Se=te.vertexOffset+ge,we=1+(this.layoutAOArray[Se]-1)*l;this.layoutColorArray.emplace(Se,ue.r*we*255<<8|ue.g*we*255,ue.b*we*255<<8|255*le)}}const ee=h.buildingBloom;if(ee)for(let te=0;te<ee.vertexLength;te++)this.bloomGeometry.layoutColorArray.emplace(ee.vertexOffset+te,255*U.r<<8|255*U.g,255*U.b<<8|51*q)}}needsEvaluation(i,l){const h=i.transform.projectionOptions,g=i.style.getBrightness();return!(this.uploaded&&h.name===this.projection.name&&this.brightness===g||(this.projection=h,this.brightness=g,0))}updateReplacement(i,l,h){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const g=l.getReplacementRegionsForTile(i.toUnwrapped());if(H_(this.activeReplacements,g))return;this.activeReplacements=g;for(const b of this.footprints)b.hiddenFlags&=-2;const x=[];for(const b of this.activeReplacements){if(b.order<=Aw)continue;const j=Math.max(1,Math.pow(2,b.footprintTileId.canonical.z-i.canonical.z));for(const M of this.footprints)M.min.x>b.max.x||M.max.x<b.min.x||M.min.y>b.max.y||M.max.y<b.min.y||(x.length=0,Eie(M.vertices,0,M.vertices.length,b.footprintTileId.canonical,i.canonical,x),Py(b.footprint,x,M.indices,0,M.indices.length,0,-j)&&(M.hiddenFlags|=1))}this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const b of this.footprints)this.groundEffect.updateHiddenByLandmarkRange(b.groundEffectVertexOffset,b.groundEffectVertexLength,b.hiddenFlags!==0);this.indexArrayForConflationUploaded=!1}getHeightAtTileCoord(i,l){let h=Number.NEGATIVE_INFINITY,g=!0;const x=4*(i+mn)*mn+(l+mn);if(this.footprintLookup.hasOwnProperty(x)){const j=this.footprintLookup[x];return j?{height:j.height,hidden:j.hiddenFlags!==0}:void 0}const b=new Rt(i,l);for(const j of this.footprints)i>j.max.x||j.min.x>i||l>j.max.y||j.min.y>l||j.height<=h||sg(b,j)&&(h=j.height,this.footprintLookup[x]=j,g=j.hiddenFlags!==0);if(h!==Number.NEGATIVE_INFINITY)return{height:h,hidden:g};this.footprintLookup[x]=void 0}}function Eie(u,i,l,h,g,x){const b=Math.pow(2,h.z-g.z);for(let j=0;j<l;j++){let M=u[j+i].x,R=u[j+i].y;M=(M+g.x*mn)*b-h.x*mn,R=(R+g.y*mn)*b-h.y*mn,x.push(new Rt(M,R))}}let hB,fB;Hn(dB,"BuildingBucket",{omit:["layers"]});const Cie=Ai([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),Nie=Ai([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:Pie}=Cie,Mie=Ai([{name:"a_packed",components:3,type:"Float32"}]),{members:Rie}=Mie,Oie=Ai([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Die}=Oie;class pB{constructor(i,l){this.width=i,this.height=l,this.nextRow=0,this.image=new xf({width:i,height:l}),this.positions={},this.uploaded=!1}getDash(i,l){const h=this.getKey(i,l);return this.positions[h]}trim(){const i=this.width,l=this.height=ir(this.nextRow);this.image.resize({width:i,height:l})}getKey(i,l){return i.join(",")+l}getDashRanges(i,l,h){const g=[];let x=i.length%2==1?-i[i.length-1]*h:0,b=i[0]*h,j=!0;g.push({left:x,right:b,isDash:j,zeroLength:i[0]===0});let M=i[0];for(let R=1;R<i.length;R++){j=!j;const L=i[R];x=M*h,M+=L,b=M*h,g.push({left:x,right:b,isDash:j,zeroLength:L===0})}return g}addRoundDash(i,l,h){const g=l/2;for(let x=-h;x<=h;x++){const b=this.width*(this.nextRow+h+x);let j=0,M=i[j];for(let R=0;R<this.width;R++){R/M.right>1&&(M=i[++j]);const L=Math.abs(R-M.left),U=Math.abs(R-M.right),q=Math.min(L,U);let ee;const te=x/h*(g+1);if(M.isDash){const le=g-Math.abs(te);ee=Math.sqrt(q*q+le*le)}else ee=g-Math.sqrt(q*q+te*te);this.image.data[b+R]=Math.max(0,Math.min(255,ee+128))}}}addRegularDash(i,l){for(let M=i.length-1;M>=0;--M){const R=i[M],L=i[M+1];R.zeroLength?i.splice(M,1):L&&L.isDash===R.isDash&&(L.left=R.left,i.splice(M,1))}const h=i[0],g=i[i.length-1];h.isDash===g.isDash&&(h.left=g.left-this.width,g.right=h.right+this.width);const x=this.width*this.nextRow;let b=0,j=i[b];for(let M=0;M<this.width;M++){M/j.right>1&&(j=i[++b]);const R=Math.abs(M-j.left),L=Math.abs(M-j.right),U=Math.min(R,L);this.image.data[x+M]=Math.max(0,Math.min(255,(j.isDash?U:-U)+l+128))}}addDash(i,l){const h=this.getKey(i,l);if(this.positions[h])return this.positions[h];const g=l==="round",x=g?7:0,b=2*x+1;if(this.nextRow+b>this.height)return ai("LineAtlas out of space"),null;i.length===0&&i.push(1);let j=0;for(let L=0;L<i.length;L++)i[L]<0&&(ai("Negative value is found in line dasharray, replacing values with 0"),i[L]=0),j+=i[L];if(j!==0){const L=this.width/j,U=this.getDashRanges(i,this.width,L);g?this.addRoundDash(U,L,x):this.addRegularDash(U,l==="square"?.5*L:0)}const M=this.nextRow+x;this.nextRow+=b;const R={tl:[M,x],br:[j,0]};return this.positions[h]=R,R}}Hn(pB,"LineAtlas");const kie=At.types,Iie=Math.cos(Math.PI/180*37.5),Lie=Math.cos(Math.PI/180*5);class EN{constructor(i){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=i.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=i.overscaling,this.pixelRatio=i.pixelRatio,this.layers=i.layers,this.layerIds=this.layers.map((l=>l.fqid)),this.index=i.index,this.projection=i.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((l=>{this.gradients[l.id]={}})),this.layoutVertexArray=new wh,this.layoutVertexArray2=new wl,this.patternVertexArray=new wl,this.indexArray=new ki,this.programConfigurations=new Ul(i.layers,{zoom:i.zoom,lut:i.lut}),this.segments=new Hs,this.maxLineLength=0,this.zOffsetVertexArray=new wl,this.stateDependentLayerIds=this.layers.filter((l=>l.isStateDependent())).map((l=>l.id)),this.tessellationStep=i.tessellationStep?i.tessellationStep:mn/64,this.worldview=i.worldview}updateFootprints(i,l){}populate(i,l,h,g){this.hasPattern=U_("line",this.layers,this.pixelRatio,l);const x=this.layers[0].layout.get("line-sort-key");this.tileToMeter=qe(h);const b=this.layers[0].layout.get("line-elevation-reference");if(b==="hd-road-markup")this.elevationType="road";else{const q=this.layers[0].layout.get("line-z-offset"),ee=q.isConstant()&&!q.constantOr(0);this.elevationType=b!=="sea"&&b!=="ground"&&ee?"none":"offset",this.elevationType==="offset"&&b==="none"&&ai(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const j=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&j!==void 0;const M=[];for(const{feature:q,id:ee,index:te,sourceLayerIndex:le}of i){const ue=this.layers[0]._featureFilter.needGeometry,ge=Dt(q,ue);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom,{worldview:this.worldview}),ge,h))continue;const Se=x?x.evaluate(ge,{},h):void 0,we={id:ee,properties:q.properties,type:q.type,sourceLayerIndex:le,index:te,geometry:ue?ge.geometry:at(q,h,g),patterns:{},sortKey:Se};M.push(we)}x&&M.sort(((q,ee)=>q.sortKey-ee.sortKey));const{lineAtlas:R,featureIndex:L}=l,U=this.addConstantDashes(R);for(const q of M){const{geometry:ee,index:te,sourceLayerIndex:le}=q;if(U&&this.addFeatureDashes(q,R),this.hasPattern){const ue=V_("line",this.layers,q,this.zoom,this.pixelRatio,l);this.patternFeatures.push(ue)}else this.addFeature(q,ee,te,h,R.positions,l.availableImages,l.brightness,l.elevationFeatures);L.insert(i[te].feature,ee,te,le,this.index)}}addConstantDashes(i){let l=!1;for(const h of this.layers){const g=h.paint.get("line-dasharray").value,x=h.layout.get("line-cap").value;if(g.kind!=="constant"||x.kind!=="constant")l=!0;else{const b=x.value,j=g.value;if(!j)continue;i.addDash(j,b)}}return l}addFeatureDashes(i,l){const h=this.zoom;for(const g of this.layers){const x=g.paint.get("line-dasharray").value,b=g.layout.get("line-cap").value;if(x.kind==="constant"&&b.kind==="constant")continue;let j,M;if(x.kind==="constant"){if(j=x.value,!j)continue}else j=x.evaluate({zoom:h},i);M=b.kind==="constant"?b.value:b.evaluate({zoom:h},i),l.addDash(j,M),i.patterns[g.id]=[l.getKey(j,M)]}}update(i,l,h,g,x,b,j,M){this.programConfigurations.updatePaintArrays(i,l,x,h,g,b,j,M)}addFeatures(i,l,h,g,x,b){for(const j of this.patternFeatures)this.addFeature(j,j.geometry,j.index,l,h,g,b)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,Rie)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=i.createVertexBuffer(this.patternVertexArray,Die)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,Nie.members,!0)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Pie),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,l,h,g,x,b,j,M){const R=this.layers[0].layout,L=R.get("line-join").evaluate(i,{}),U=R.get("line-cap").evaluate(i,{}),q=R.get("line-miter-limit"),ee=R.get("line-round-limit");this.lineClips=this.lineFeatureClips(i),this.lineFeature=i,this.zOffsetValue=R.get("line-z-offset").value;const te=this.layers[0].paint.get("line-width").value;if(te.kind!=="constant"&&te.isLineProgressConstant===!1&&(this.variableWidthValue=te),this.elevationType==="road"){const le=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(i,l,g,M,L,U,q,ee)){const[ue,ge]=this.clipRuntimeLinesToTile(l,1);for(let Se=0;Se<ue.length;Se++){const we=ue[Se],Pe=ge[Se],tt={progress:{min:Pe.progress.min,max:Pe.progress.max},nextDir:this.computeSegNextDir(Pe,we),prevDir:this.computeSegPrevDir(Pe,we)};this.addLine(we,i,g,L,U,q,ee,tt)}this.fillNonElevatedRoadSegment(le)}}else for(const le of l)this.addLine(le,i,g,L,U,q,ee);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,x,b,g,j,void 0,this.worldview)}computeSegNextDir(i,l){return i.nextPoint.sub(l.at(-2)).unit()}computeSegPrevDir(i,l){return l[1].sub(i.prevPoint).unit()}clipLinesToTile(i,l){return Q_(i,-l,-l,mn+l,mn+l)}clipRuntimeLinesToTile(i,l){const h=[];return[Q_(i,-l,-l,mn+l,mn+l,h),h]}addElevatedRoadFeature(i,l,h,g,x,b,j,M){const R=[],L=js.getElevationFeature(i,g);if(L){const U=this.clipLinesToTile(l,1),q=this.prepareElevatedLines(U,L,h);for(const ee of q)R.push({geometry:ee,elevation:L,elevationTileID:h,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(R.length===0)return!1;for(const U of R){const q=this.layoutVertexArray.length;this.addLine(U.geometry,i,h,x,b,j,M);const ee=new Ei(h,U.elevationTileID);if(U.elevation)for(let te=q;te<this.layoutVertexArray.length;te++){const le=new Rt(this.layoutVertexArray.int16[6*te]>>1,this.layoutVertexArray.int16[6*te+1]>>1),ue=ee.pointElevation(le,U.elevation,.05);this.updateHeightRange(ue),this.zOffsetVertexArray.emplaceBack(ue,0,0)}else this.fillNonElevatedRoadSegment(q)}return!0}prepareElevatedLines(i,l,h){if(l.constantHeight!=null)return i;const g=[],x=1/qe(h);for(const b of i)e0(b,new Xi(l,x),0,g);return g}fillNonElevatedRoadSegment(i){for(let l=i;l<this.layoutVertexArray.length;l++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(i){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,i),this.heightRange.max=Math.max(this.heightRange.max,i)):this.heightRange={min:i,max:i}}addLine(i,l,h,g,x,b,j,M){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const R=g==="none";this.patternJoinNone=this.hasPattern&&R,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const L=M&&M.progress.min>0,U=M&&M.progress.max<1;if(this.lineClips){let dt={min:this.lineClips.start,max:this.lineClips.end},ft=1;if(M){const Wt=this.lineClips.end-this.lineClips.start;dt=(function(bn,tn,dn){return{min:id(bn.min,tn,dn),max:id(bn.max,tn,dn)}})(M.progress,{min:0,max:1},dt),Wt>0&&(ft=(dt.max-dt.min)/Wt)}const Ft=+l.properties.mapbox_clip_feature_len,xt=+l.properties.mapbox_clip_seg_len;if(Number.isNaN(Ft)||Number.isNaN(xt)){for(let bn=0;bn<i.length-1;bn++)this.totalDistance+=i[bn].dist(i[bn+1]);const Wt=this.totalDistance/(dt.max-dt.min);this.totalFeatureLength=Number.isFinite(Wt)?Wt:0,this.lineClips.start=dt.min,this.lineClips.end=dt.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=Ft,this.distance=xt*ft,this.lineClips.start=dt.min,this.lineClips.end=dt.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const q=kie[l.type]==="Polygon";let ee=i.length;for(;ee>=2&&i[ee-1].equals(i[ee-2]);)ee--;let te=0;for(;te<ee-1&&i[te].equals(i[te+1]);)te++;if(ee<(q?3:2))return;g==="bevel"&&(b=1.05);const le=this.segments.prepareSegment(10*ee,this.layoutVertexArray,this.indexArray);let ue,ge,Se,we,Pe,tt,Ke,Qe;M&&M.prevDir&&(tt=M.prevDir.perp()),M&&M.nextDir&&(Ke=M.nextDir.perp()),this.e1=this.e2=-1,q&&(ue=i[ee-2],Pe=i[te].sub(ue)._unit()._perp());for(let dt=te;dt<ee;dt++){if(Se=dt===ee-1?q?i[te+1]:void 0:i[dt+1],Se&&i[dt].equals(Se))continue;Pe&&(we=Pe),ue&&(ge=ue),ue=i[dt],Qe=this.evaluateLineProgressFeatures(ge?ge.dist(ue):0),Pe=Se?Se.sub(ue)._unit()._perp():we,we=we||Pe;const ft=ge&&Se;let Ft=ft?g:q||R?"butt":x;const xt=we.x*Pe.x+we.y*Pe.y;if(R){const Tt=function(zt){if(zt.patternJoinNone){const wn=zt.segmentPoints.length/2,pn=zt.lineSoFar-zt.segmentStart;for(let ur=0;ur<wn;++ur){const Jn=zt.segmentPoints[2*ur+1],cn=Math.round(zt.segmentPoints[2*ur])+.5+.25*Jn;zt.patternVertexArray.emplaceBack(cn,pn,zt.segmentStart),zt.patternVertexArray.emplaceBack(cn,pn,zt.segmentStart)}zt.segmentPoints.length=0}zt.e1=zt.e2=-1};if(ft&&xt<Lie){this.updateDistance(ge,ue),this.addCurrentVertex(ue,we,1,1,le,Qe),Tt(this),this.addCurrentVertex(ue,Pe,-1,-1,le,Qe);continue}if(ge){if(!Se){this.updateDistance(ge,ue),this.addCurrentVertex(ue,we,1,1,le,Qe),Tt(this);continue}Ft="miter"}}let Wt=we.add(Pe);Wt.x===0&&Wt.y===0||Wt._unit();const bn=Wt.x*Pe.x+Wt.y*Pe.y,tn=bn!==0?1/bn:1/0,dn=2*Math.sqrt(2-2*bn),xn=bn<Iie&&ge&&Se,Lt=we.x*Pe.y-we.y*Pe.x>0,hn=this.overscaling<=16?15*mn/(512*this.overscaling):0;if(ft&&Ft==="round"){if(tn<j)Ft="miter";else if(tn<=2){const Tt=CN(ue,-10,mn+10);Ft=this.elevationType==="offset"&&(Tt||this.hasCrossSlope)?"miter":"fakeround"}}if(Ft==="miter"&&tn>b&&(Ft="bevel"),Ft==="bevel"&&(tn>2&&(Ft="flipbevel"),tn<b&&(Ft="miter")),ge&&!(Ft==="miter"&&xn)&&this.updateDistance(ge,ue),Ft==="miter")if(xn){const Tt=ue.dist(ge);if(Tt>2*hn){const wn=ue.sub(ue.sub(ge)._mult(hn/Tt)._round());this.updateDistance(ge,wn),this.addCurrentVertex(wn,we,0,0,le,Qe),ge=wn}this.updateDistance(ge,ue),Wt._mult(tn),this.addCurrentVertex(ue,Wt,0,0,le,Qe);const zt=ue.dist(Se);if(zt>2*hn){const wn=ue.add(Se.sub(ue)._mult(hn/zt)._round());this.updateDistance(ue,wn),this.addCurrentVertex(wn,Pe,0,0,le,Qe),ue=wn}}else Wt._mult(tn),this.addCurrentVertex(ue,Wt,0,0,le,Qe);else if(Ft==="flipbevel"){if(tn>100)Wt=Pe.mult(-1);else{const Tt=tn*we.add(Pe).mag()/we.sub(Pe).mag();Wt._perp()._mult(Tt*(Lt?-1:1))}this.addCurrentVertex(ue,Wt,0,0,le,Qe),this.addCurrentVertex(ue,Wt.mult(-1),0,0,le,Qe)}else if(Ft==="bevel"||Ft==="fakeround"){Qe!=null&&ge&&this.addCurrentVertex(ue,Ke||we,-1,-1,le,Qe);const Tt=ue.dist(ge)<=2*hn&&Ft!=="bevel",zt=Wt.mult(Lt?1:-1);zt._mult(tn);const wn=Pe.mult(Lt?-1:1),pn=we.mult(Lt?-1:1),ur=this.evaluateLineProgressFeatures(this.distance);if(Qe==null&&(this.addHalfVertex(ue,zt.x,zt.y,!1,!Lt,0,le,ur),Tt||this.addHalfVertex(ue,zt.x+2*pn.x,zt.y+2*pn.y,!1,Lt,0,le,ur)),Ft==="fakeround"){const Jn=Math.round(180*dn/Math.PI/20);this.addHalfVertex(ue,pn.x,pn.y,!1,Lt,0,le,ur);for(let cn=0;cn<Jn;cn++){let yn=cn/Jn;if(yn!==.5){const Bn=yn-.5;yn+=yn*Bn*(yn-1)*((1.0904+xt*(xt*(3.55645-1.43519*xt)-3.2452))*Bn*Bn+(.848013+xt*(.215638*xt-1.06021)))}const er=wn.sub(pn)._mult(yn)._add(pn)._unit();this.addHalfVertex(ue,er.x,er.y,!1,Lt,0,le,ur)}this.addHalfVertex(ue,wn.x,wn.y,!1,Lt,0,le,ur)}Tt||Qe!=null||this.addHalfVertex(ue,zt.x+2*wn.x,zt.y+2*wn.y,!1,Lt,0,le,ur),Qe!=null&&Se&&this.addCurrentVertex(ue,tt||Pe,1,1,le,Qe)}else if(Ft==="butt")this.addCurrentVertex(ue,Wt,0,0,le,Qe);else if(Ft==="square"){if(!ge){const Tt=L?0:-1;this.addCurrentVertex(ue,Wt,Tt,Tt,le,Qe)}if(this.addCurrentVertex(ue,Wt,0,0,le,Qe),ge){const Tt=U?0:1;this.addCurrentVertex(ue,Wt,Tt,Tt,le,Qe)}}else if(Ft==="round"){if(ge){const Tt=!ft&&Ke?Ke:we;this.addCurrentVertex(ue,Tt,0,0,le,Qe),!ft&&U||this.addCurrentVertex(ue,Tt,1,1,le,Qe,!0)}if(Se){const Tt=!ft&&tt?tt:Pe;!ft&&L||this.addCurrentVertex(ue,Tt,-1,-1,le,Qe,!0),this.addCurrentVertex(ue,Tt,0,0,le,Qe)}}}}addVerticesTo(i,l,h,g,x,b,j,M,R,L){const U=(l.w-i.w)/this.tessellationStep|0;let q=0;const ee=this.scaledDistance;if(U>1){this.lineSoFar=i.w;const le=(l.x-i.x)/U,ue=(l.y-i.y)/U,ge=(l.z-i.z)/U,Se=(l.w-i.w)/U;for(let we=1;we<U;++we){i.x+=le,i.y+=ue,i.z+=ge,this.lineSoFar+=Se,q+=Se;const Pe=this.evaluateLineProgressFeatures(this.prevDistance+q);this.scaledDistance=(this.prevDistance+q)/this.totalDistance,this.addHalfVertex(i,h,g,L,!1,j,R,Pe),this.addHalfVertex(i,x,b,L,!0,-M,R,Pe)}}this.lineSoFar=l.w,this.scaledDistance=ee;const te=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(l,h,g,L,!1,j,R,te),this.addHalfVertex(l,x,b,L,!0,-M,R,te)}evaluateLineProgressFeatures(i){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+i)/this.totalFeatureLength):ai(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let l=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(l=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:l}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:l}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:l}}addCurrentVertex(i,l,h,g,x,b,j=!1){const M=l.x+l.y*h,R=l.y-l.x*h,L=l.y*g-l.x,U=-l.y-l.x*g;if(b!=null){const q=this.elevationType==="offset",ee=-10,te=mn+10,le=b.zOffset,ue=new J_(i.x,i.y,le,this.lineSoFar),ge=!!q&&CN(i,ee,te),Se=this.lineSoFar,we=this.distance;if(this.currentVertex)if(ge){const Pe=this.currentVertexIsOutside,tt=this.currentVertex,Ke=new J_(i.x,i.y,le,this.lineSoFar);if(kw(tt,Ke,ee,te),!CN(Ke,ee,te)){if(Pe){this.e1=this.e2=-1,this.distance-=tt.dist(ue),this.lineSoFar=tt.w;const Qe=this.evaluateLineProgressFeatures(tt.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(tt,M,R,j,!1,h,x,Qe),this.addHalfVertex(tt,L,U,j,!0,-g,x,Qe),this.prevDistance=this.distance}this.distance=this.prevDistance+tt.dist(Ke),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(tt,Ke,M,R,L,U,h,g,x,j),this.distance=we,this.scaledDistance=this.distance/this.totalDistance}}else{const Pe=this.currentVertex;if(this.currentVertexIsOutside){kw(Pe,ue,ee,te),this.e1=this.e2=-1,this.distance-=Pe.dist(ue),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=Pe.w;const tt=this.evaluateLineProgressFeatures(Pe.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Pe,M,R,j,!1,h,x,tt),this.addHalfVertex(Pe,L,U,j,!0,-g,x,tt),this.prevDistance=this.distance,this.distance=we,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(Pe,ue,M,R,L,U,h,g,x,j)}else ge||(this.addHalfVertex(i,M,R,j,!1,h,x,b),this.addHalfVertex(i,L,U,j,!0,-g,x,b));this.currentVertex=ue,this.currentVertexIsOutside=ge,this.lineSoFar=Se}else this.addHalfVertex(i,M,R,j,!1,h,x,b),this.addHalfVertex(i,L,U,j,!0,-g,x,b)}addHalfVertex({x:i,y:l},h,g,x,b,j,M,R){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),b||this.segmentPoints.push(this.lineSoFar-this.segmentStart,j)),this.layoutVertexArray.emplaceBack((i<<1)+(x?1:0),(l<<1)+(b?1:0),Math.round(63*h)+128,Math.round(63*g)+128,1+(j===0?0:j<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const U=yr(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,U)}const L=M.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,L),M.primitiveLength++),b?this.e2=L:this.e1=L,R!=null&&this.zOffsetVertexArray.emplaceBack(R.zOffset,R.variableWidth,R.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(i,l){this.prevDistance=this.distance,this.distance+=i.dist(l),this.updateScaledDistance()}}function CN(u,i,l){return u.x<i||u.x>l||u.y<i||u.y>l}let mB,gB;function yB(u,i,l){return i*(mn/(u.tileSize*Math.pow(2,l-u.tileID.overscaledZ)))}Hn(EN,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const vB=(u,i,l)=>(1-l)*u+l*i;function xB(u,i){return 1/yB(u,1,i.tileZoom)}function _B(u,i,l,h){return u.translatePosMatrix(h||i.tileID.projMatrix,i,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}const bB=u=>{const i=[];wB(u)&&i.push("RENDER_LINE_DASH"),u.paint.get("line-gradient")&&i.push("RENDER_LINE_GRADIENT");const l=u.paint.get("line-trim-offset");l[0]===0&&l[1]===0||i.push("RENDER_LINE_TRIM_OFFSET"),u.paint.get("line-border-width").constantOr(1)!==0&&i.push("RENDER_LINE_BORDER");const h=u.layout.get("line-join").constantOr("miter")==="none",g=!!u.paint.get("line-pattern").constantOr(1);return h&&g&&i.push("LINE_JOIN_NONE"),i};function wB(u){const i=u.paint.get("line-dasharray").value;return i.value||i.kind!=="constant"}let NN;const SB=()=>NN||(NN={layout:mB||(mB=new ra({"line-cap":new Ln(yt.layout_line["line-cap"]),"line-join":new Ln(yt.layout_line["line-join"]),"line-miter-limit":new fn(yt.layout_line["line-miter-limit"]),"line-round-limit":new fn(yt.layout_line["line-round-limit"]),"line-sort-key":new Ln(yt.layout_line["line-sort-key"]),"line-z-offset":new Ln(yt.layout_line["line-z-offset"]),"line-elevation-reference":new fn(yt.layout_line["line-elevation-reference"]),"line-cross-slope":new fn(yt.layout_line["line-cross-slope"]),visibility:new fn(yt.layout_line.visibility),"line-width-unit":new fn(yt.layout_line["line-width-unit"])})),paint:gB||(gB=new ra({"line-opacity":new Ln(yt.paint_line["line-opacity"]),"line-color":new Ln(yt.paint_line["line-color"]),"line-translate":new fn(yt.paint_line["line-translate"]),"line-translate-anchor":new fn(yt.paint_line["line-translate-anchor"]),"line-width":new Ln(yt.paint_line["line-width"]),"line-gap-width":new Ln(yt.paint_line["line-gap-width"]),"line-offset":new Ln(yt.paint_line["line-offset"]),"line-blur":new Ln(yt.paint_line["line-blur"]),"line-dasharray":new Ln(yt.paint_line["line-dasharray"]),"line-pattern":new Ln(yt.paint_line["line-pattern"]),"line-pattern-cross-fade":new fn(yt.paint_line["line-pattern-cross-fade"]),"line-gradient":new lf(yt.paint_line["line-gradient"]),"line-trim-offset":new fn(yt.paint_line["line-trim-offset"]),"line-trim-fade-range":new fn(yt.paint_line["line-trim-fade-range"]),"line-trim-color":new fn(yt.paint_line["line-trim-color"]),"line-emissive-strength":new fn(yt.paint_line["line-emissive-strength"]),"line-border-width":new Ln(yt.paint_line["line-border-width"]),"line-border-color":new Ln(yt.paint_line["line-border-color"]),"line-occlusion-opacity":new fn(yt.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"})}))},NN);class zie extends Ln{possiblyEvaluate(i,l){return l=new hs(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,transition:l.transition,worldview:l.worldview}),super.possiblyEvaluate(i,l)}evaluate(i,l,h,g){return l=St({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(i,l,h,g)}}let Fw;function TB(u,i){return i>0?i+2*u:u}const Fie=Ai([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Bie=Ai([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Uie=Ai([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ai([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Vie=Ai([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),$ie=Ai([{name:"a_x_axis",components:3,type:"Float32"},{name:"a_y_axis",components:3,type:"Float32"}]),qie=Ai([{name:"a_texb",components:2,type:"Uint16"}]),Hie=Ai([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),Gie=Ai([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Ai([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const AB=Ai([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Wie=Ai([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ai([{name:"triangle",components:3,type:"Uint16"}]),Ai([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ai([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),Ai([{type:"Float32",name:"offsetX"}]),Ai([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Qo=24;function Xie(u,i,l){return u.sections.forEach((h=>{h.text=(function(g,x,b){const j=x.layout.get("text-transform").evaluate(b,{});return j==="uppercase"?g=g.toLocaleUpperCase():j==="lowercase"&&(g=g.toLocaleLowerCase()),du.applyArabicShaping&&(g=du.applyArabicShaping(g)),g})(h.text,i,l)})),u}const Bw={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function Zie(u){return u==="︶"||u==="﹈"||u==="︸"||u==="﹄"||u==="﹂"||u==="︾"||u==="︼"||u==="︺"||u==="︘"||u==="﹀"||u==="︐"||u==="︓"||u==="︔"||u==="｀"||u==="￣"||u==="︑"||u==="︒"}function Yie(u){return u==="︵"||u==="﹇"||u==="︷"||u==="﹃"||u==="﹁"||u==="︽"||u==="︻"||u==="︹"||u==="︗"||u==="︿"}const PN=4294967296,jB=1/PN,EB=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");let x2=class{constructor(u=new Uint8Array(16)){this.buf=ArrayBuffer.isView(u)?u:new Uint8Array(u),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(u,i,l=this.length){for(;this.pos<l;){const h=this.readVarint(),g=h>>3,x=this.pos;this.type=7&h,u(g,i,this),this.pos===x&&this.skip(h)}return i}readMessage(u,i){return this.readFields(u,i,this.readVarint()+this.pos)}readFixed32(){const u=this.dataView.getUint32(this.pos,!0);return this.pos+=4,u}readSFixed32(){const u=this.dataView.getInt32(this.pos,!0);return this.pos+=4,u}readFixed64(){const u=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*PN;return this.pos+=8,u}readSFixed64(){const u=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*PN;return this.pos+=8,u}readFloat(){const u=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,u}readDouble(){const u=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,u}readVarint(u){const i=this.buf;let l,h;return h=i[this.pos++],l=127&h,h<128?l:(h=i[this.pos++],l|=(127&h)<<7,h<128?l:(h=i[this.pos++],l|=(127&h)<<14,h<128?l:(h=i[this.pos++],l|=(127&h)<<21,h<128?l:(h=i[this.pos],l|=(15&h)<<28,(function(g,x,b){const j=b.buf;let M,R;if(R=j[b.pos++],M=(112&R)>>4,R<128||(R=j[b.pos++],M|=(127&R)<<3,R<128)||(R=j[b.pos++],M|=(127&R)<<10,R<128)||(R=j[b.pos++],M|=(127&R)<<17,R<128)||(R=j[b.pos++],M|=(127&R)<<24,R<128)||(R=j[b.pos++],M|=(1&R)<<31,R<128))return n0(g,M,x);throw new Error("Expected varint not more than 10 bytes")})(l,u,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const u=this.readVarint();return u%2==1?(u+1)/-2:u/2}readBoolean(){return!!this.readVarint()}readString(){const u=this.readVarint()+this.pos,i=this.pos;return this.pos=u,u-i>=12&&EB?EB.decode(this.buf.subarray(i,u)):(function(l,h,g){let x="",b=h;for(;b<g;){const j=l[b];let M,R,L,U=null,q=j>239?4:j>223?3:j>191?2:1;if(b+q>g)break;q===1?j<128&&(U=j):q===2?(M=l[b+1],(192&M)==128&&(U=(31&j)<<6|63&M,U<=127&&(U=null))):q===3?(M=l[b+1],R=l[b+2],(192&M)==128&&(192&R)==128&&(U=(15&j)<<12|(63&M)<<6|63&R,(U<=2047||U>=55296&&U<=57343)&&(U=null))):q===4&&(M=l[b+1],R=l[b+2],L=l[b+3],(192&M)==128&&(192&R)==128&&(192&L)==128&&(U=(15&j)<<18|(63&M)<<12|(63&R)<<6|63&L,(U<=65535||U>=1114112)&&(U=null))),U===null?(U=65533,q=1):U>65535&&(U-=65536,x+=String.fromCharCode(U>>>10&1023|55296),U=56320|1023&U),x+=String.fromCharCode(U),b+=q}return x})(this.buf,i,u)}readBytes(){const u=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,u);return this.pos=u,i}readPackedVarint(u=[],i){const l=this.readPackedEnd();for(;this.pos<l;)u.push(this.readVarint(i));return u}readPackedSVarint(u=[]){const i=this.readPackedEnd();for(;this.pos<i;)u.push(this.readSVarint());return u}readPackedBoolean(u=[]){const i=this.readPackedEnd();for(;this.pos<i;)u.push(this.readBoolean());return u}readPackedFloat(u=[]){const i=this.readPackedEnd();for(;this.pos<i;)u.push(this.readFloat());return u}readPackedDouble(u=[]){const i=this.readPackedEnd();for(;this.pos<i;)u.push(this.readDouble());return u}readPackedFixed32(u=[]){const i=this.readPackedEnd();for(;this.pos<i;)u.push(this.readFixed32());return u}readPackedSFixed32(u=[]){const i=this.readPackedEnd();for(;this.pos<i;)u.push(this.readSFixed32());return u}readPackedFixed64(u=[]){const i=this.readPackedEnd();for(;this.pos<i;)u.push(this.readFixed64());return u}readPackedSFixed64(u=[]){const i=this.readPackedEnd();for(;this.pos<i;)u.push(this.readSFixed64());return u}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(u){const i=7&u;if(i===0)for(;this.buf[this.pos++]>127;);else if(i===2)this.pos=this.readVarint()+this.pos;else if(i===5)this.pos+=4;else{if(i!==1)throw new Error(`Unimplemented type: ${i}`);this.pos+=8}}writeTag(u,i){this.writeVarint(u<<3|i)}realloc(u){let i=this.length||16;for(;i<this.pos+u;)i*=2;if(i!==this.length){const l=new Uint8Array(i);l.set(this.buf),this.buf=l,this.dataView=new DataView(l.buffer),this.length=i}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(u){this.realloc(4),this.dataView.setInt32(this.pos,u,!0),this.pos+=4}writeSFixed32(u){this.realloc(4),this.dataView.setInt32(this.pos,u,!0),this.pos+=4}writeFixed64(u){this.realloc(8),this.dataView.setInt32(this.pos,-1&u,!0),this.dataView.setInt32(this.pos+4,Math.floor(u*jB),!0),this.pos+=8}writeSFixed64(u){this.realloc(8),this.dataView.setInt32(this.pos,-1&u,!0),this.dataView.setInt32(this.pos+4,Math.floor(u*jB),!0),this.pos+=8}writeVarint(u){(u=+u||0)>268435455||u<0?(function(i,l){let h,g;if(i>=0?(h=i%4294967296|0,g=i/4294967296|0):(h=~(-i%4294967296),g=~(-i/4294967296),4294967295^h?h=h+1|0:(h=0,g=g+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),(function(x,b,j){j.buf[j.pos++]=127&x|128,x>>>=7,j.buf[j.pos++]=127&x|128,x>>>=7,j.buf[j.pos++]=127&x|128,x>>>=7,j.buf[j.pos++]=127&x|128,j.buf[j.pos]=127&(x>>>=7)})(h,0,l),(function(x,b){const j=(7&x)<<4;b.buf[b.pos++]|=j|((x>>>=3)?128:0),x&&(b.buf[b.pos++]=127&x|((x>>>=7)?128:0),x&&(b.buf[b.pos++]=127&x|((x>>>=7)?128:0),x&&(b.buf[b.pos++]=127&x|((x>>>=7)?128:0),x&&(b.buf[b.pos++]=127&x|((x>>>=7)?128:0),x&&(b.buf[b.pos++]=127&x)))))})(g,l)})(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))}writeSVarint(u){this.writeVarint(u<0?2*-u-1:2*u)}writeBoolean(u){this.writeVarint(+u)}writeString(u){u=String(u),this.realloc(4*u.length),this.pos++;const i=this.pos;this.pos=(function(h,g,x){for(let b,j,M=0;M<g.length;M++){if(b=g.charCodeAt(M),b>55295&&b<57344){if(!j){b>56319||M+1===g.length?(h[x++]=239,h[x++]=191,h[x++]=189):j=b;continue}if(b<56320){h[x++]=239,h[x++]=191,h[x++]=189,j=b;continue}b=j-55296<<10|b-56320|65536,j=null}else j&&(h[x++]=239,h[x++]=191,h[x++]=189,j=null);b<128?h[x++]=b:(b<2048?h[x++]=b>>6|192:(b<65536?h[x++]=b>>12|224:(h[x++]=b>>18|240,h[x++]=b>>12&63|128),h[x++]=b>>6&63|128),h[x++]=63&b|128)}return x})(this.buf,u,this.pos);const l=this.pos-i;l>=128&&CB(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l}writeFloat(u){this.realloc(4),this.dataView.setFloat32(this.pos,u,!0),this.pos+=4}writeDouble(u){this.realloc(8),this.dataView.setFloat64(this.pos,u,!0),this.pos+=8}writeBytes(u){const i=u.length;this.writeVarint(i),this.realloc(i);for(let l=0;l<i;l++)this.buf[this.pos++]=u[l]}writeRawMessage(u,i){this.pos++;const l=this.pos;u(i,this);const h=this.pos-l;h>=128&&CB(l,h,this),this.pos=l-1,this.writeVarint(h),this.pos+=h}writeMessage(u,i,l){this.writeTag(u,2),this.writeRawMessage(i,l)}writePackedVarint(u,i){i.length&&this.writeMessage(u,Kie,i)}writePackedSVarint(u,i){i.length&&this.writeMessage(u,Jie,i)}writePackedBoolean(u,i){i.length&&this.writeMessage(u,tse,i)}writePackedFloat(u,i){i.length&&this.writeMessage(u,Qie,i)}writePackedDouble(u,i){i.length&&this.writeMessage(u,ese,i)}writePackedFixed32(u,i){i.length&&this.writeMessage(u,nse,i)}writePackedSFixed32(u,i){i.length&&this.writeMessage(u,rse,i)}writePackedFixed64(u,i){i.length&&this.writeMessage(u,ise,i)}writePackedSFixed64(u,i){i.length&&this.writeMessage(u,sse,i)}writeBytesField(u,i){this.writeTag(u,2),this.writeBytes(i)}writeFixed32Field(u,i){this.writeTag(u,5),this.writeFixed32(i)}writeSFixed32Field(u,i){this.writeTag(u,5),this.writeSFixed32(i)}writeFixed64Field(u,i){this.writeTag(u,1),this.writeFixed64(i)}writeSFixed64Field(u,i){this.writeTag(u,1),this.writeSFixed64(i)}writeVarintField(u,i){this.writeTag(u,0),this.writeVarint(i)}writeSVarintField(u,i){this.writeTag(u,0),this.writeSVarint(i)}writeStringField(u,i){this.writeTag(u,2),this.writeString(i)}writeFloatField(u,i){this.writeTag(u,5),this.writeFloat(i)}writeDoubleField(u,i){this.writeTag(u,1),this.writeDouble(i)}writeBooleanField(u,i){this.writeVarintField(u,+i)}};function n0(u,i,l){return l?4294967296*i+(u>>>0):4294967296*(i>>>0)+(u>>>0)}function CB(u,i,l){const h=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));l.realloc(h);for(let g=l.pos-1;g>=u;g--)l.buf[g+h]=l.buf[g]}function Kie(u,i){for(let l=0;l<u.length;l++)i.writeVarint(u[l])}function Jie(u,i){for(let l=0;l<u.length;l++)i.writeSVarint(u[l])}function Qie(u,i){for(let l=0;l<u.length;l++)i.writeFloat(u[l])}function ese(u,i){for(let l=0;l<u.length;l++)i.writeDouble(u[l])}function tse(u,i){for(let l=0;l<u.length;l++)i.writeBoolean(u[l])}function nse(u,i){for(let l=0;l<u.length;l++)i.writeFixed32(u[l])}function rse(u,i){for(let l=0;l<u.length;l++)i.writeSFixed32(u[l])}function ise(u,i){for(let l=0;l<u.length;l++)i.writeFixed64(u[l])}function sse(u,i){for(let l=0;l<u.length;l++)i.writeSFixed64(u[l])}const MN=3;function ase(u,i,l){i.glyphs=[],u===1&&l.readMessage(ose,i)}function ose(u,i,l){if(u===3){const{id:h,bitmap:g,width:x,height:b,left:j,top:M,advance:R}=l.readMessage(lse,{});i.glyphs.push({id:h,bitmap:new xf({width:x+2*MN,height:b+2*MN},g),metrics:{width:x,height:b,left:j,top:M,advance:R}})}else u===4?i.ascender=l.readSVarint():u===5&&(i.descender=l.readSVarint())}function lse(u,i,l){u===1?i.id=l.readVarint():u===2?i.bitmap=l.readBytes():u===3?i.width=l.readVarint():u===4?i.height=l.readVarint():u===5?i.left=l.readSVarint():u===6?i.top=l.readSVarint():u===7&&(i.advance=l.readVarint())}const NB=MN,yu={horizontal:1,vertical:2,horizontalOnly:3};class Uw{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(i,l){const h=new Uw;return h.scale=i||1,h.fontStack=l,h}static forImage(i){const l=new Uw;return l.image=i,l}}class r0{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,l,h){const g=new r0;for(let x=0;x<i.sections.length;x++){const b=i.sections[x];b.image?g.addImageSection(b,h):g.addTextSection(b,l)}return g}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCodePoint(i){return this.text.codePointAt(i)}verticalizePunctuation(i){this.text=(function(l,h){let g="";for(let x=0;x<l.length;x++){const b=l.charCodeAt(x+1)||null,j=l.charCodeAt(x-1)||null;g+=!h&&(b&&$c(b)&&!Bw[l[x+1]]||j&&$c(j)&&!Bw[l[x-1]])||!Bw[l[x]]?l[x]:Bw[l[x]]}return g})(this.text,i)}trim(){let i=0;for(let h=0;h<this.text.length&&_2[this.text.charCodeAt(h)];h++)i++;let l=this.text.length;for(let h=this.text.length-1;h>=0&&h>=i&&_2[this.text.charCodeAt(h)];h--)l--;this.text=this.text.substring(i,l),this.sectionIndex=this.sectionIndex.slice(i,l)}substring(i,l){const h=new r0;return h.text=this.text.substring(i,l),h.sectionIndex=this.sectionIndex.slice(i,l),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((i,l)=>Math.max(i,this.sections[l].scale)),0)}addTextSection(i,l){this.text+=i.text,this.sections.push(Uw.forText(i.scale,i.fontStack||l));const h=this.sections.length-1;for(let g=0;g<i.text.length;++g)this.sectionIndex.push(h)}addImageSection(i,l){const h=i.image?i.image.getPrimary():null;if(!h)return void ai("Can't add FormattedSection with an empty image.");h.scaleSelf(l);const g=this.getNextImageSectionCharCode();g?(this.text+=String.fromCodePoint(g),this.sections.push(Uw.forImage(h)),this.sectionIndex.push(this.sections.length-1)):ai("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function RN(u,i,l,h,g,x,b,j,M,R,L,U,q,ee,te,le=1){const ue=r0.fromFeature(u,g,le);U===yu.vertical&&ue.verticalizePunctuation(q);let ge=[];const Se=(function(Qe,dt,ft,Ft,xt,Wt){if(!Qe)return[];const bn=[],tn=(function(hn,Tt,zt,wn,pn,ur){let Jn=0;for(let cn=0;cn<hn.length();cn++){const yn=hn.getSection(cn);Jn+=PB(hn.getCodePoint(cn),yn,wn,pn,Tt,ur)}return Jn/Math.max(1,Math.ceil(Jn/zt))})(Qe,dt,ft,Ft,xt,Wt),dn=Qe.text.indexOf("​")>=0;let xn=0;for(let hn=0;hn<Qe.length();hn++){const Tt=Qe.getSection(hn),zt=Qe.getCodePoint(hn);if(_2[zt]||(xn+=PB(zt,Tt,Ft,xt,dt,Wt)),hn<Qe.length()-1){const wn=!((Lt=zt)<11904||!(sr["Bopomofo Extended"](Lt)||sr.Bopomofo(Lt)||sr["CJK Compatibility Forms"](Lt)||sr["CJK Compatibility Ideographs"](Lt)||sr["CJK Compatibility"](Lt)||sr["CJK Radicals Supplement"](Lt)||sr["CJK Strokes"](Lt)||sr["CJK Symbols and Punctuation"](Lt)||sr["CJK Unified Ideographs Extension A"](Lt)||sr["CJK Unified Ideographs"](Lt)||sr["Enclosed CJK Letters and Months"](Lt)||sr["Halfwidth and Fullwidth Forms"](Lt)||sr.Hiragana(Lt)||sr["Ideographic Description Characters"](Lt)||sr["Kangxi Radicals"](Lt)||sr["Katakana Phonetic Extensions"](Lt)||sr.Katakana(Lt)||sr["Vertical Forms"](Lt)||sr["Yi Radicals"](Lt)||sr["Yi Syllables"](Lt)));(cse[zt]||wn||Tt.image)&&bn.push(RB(hn+1,xn,tn,bn,use(zt,Qe.getCodePoint(hn+1),wn&&dn),!1))}}var Lt;return OB(RB(Qe.length(),xn,tn,bn,0,!0))})(ue,R,x,i,h,ee),{processBidirectionalText:we,processStyledBidirectionalText:Pe}=du;if(we&&ue.sections.length===1){const Qe=we(ue.toString(),Se);for(const dt of Qe){const ft=new r0;ft.text=dt,ft.sections=ue.sections;for(let Ft=0;Ft<dt.length;Ft++)ft.sectionIndex.push(0);ge.push(ft)}}else if(Pe){const Qe=Pe(ue.text,ue.sectionIndex,Se);for(const dt of Qe){const ft=new r0;ft.text=dt[0],ft.sectionIndex=dt[1],ft.sections=ue.sections,ge.push(ft)}}else ge=(function(Qe,dt){const ft=[],Ft=Qe.text;let xt=0;for(const Wt of dt)ft.push(Qe.substring(xt,Wt)),xt=Wt;return xt<Ft.length&&ft.push(Qe.substring(xt,Ft.length)),ft})(ue,Se);const tt=[],Ke={positionedLines:tt,text:ue.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:U,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if((function(Qe,dt,ft,Ft,xt,Wt,bn,tn,dn,xn,Lt,hn){let Tt=0,zt=0,wn=0;const pn=tn==="right"?1:tn==="left"?0:.5;let ur=!1;for(const En of xt){const $n=En.getSections();for(const Cr of $n){if(Cr.image)continue;const kr=dt[Cr.fontStack];if(kr&&(ur=kr.ascender!==void 0&&kr.descender!==void 0,!ur))break}if(!ur)break}let Jn=0;for(const En of xt){En.trim();const $n=En.getMaxScale(),Cr=($n-1)*Qo,kr={positionedGlyphs:[],lineOffset:0};Qe.positionedLines[Jn]=kr;const si=kr.positionedGlyphs;let Hr=0;if(!En.length()){zt+=Wt,++Jn;continue}let Mi=0,gi=0;for(let Ie=0;Ie<En.length();Ie++){const Le=En.getSection(Ie),It=En.getSectionIndex(Ie),Sn=En.getCodePoint(Ie);let kn=Le.scale,Dn=null,Qn=null,Or=null,Ci=Qo,Ni=0,hi=dn;hi===yu.vertical&&((cn=Sn)===12312||cn===12313||cn===12316||cn===12540||cn===12448)&&(hi=yu.horizontal);const Es=!(hi===yu.horizontal||!Lt&&!fp(Sn)||Lt&&(_2[Sn]||km(Sn)));if(Le.image){const va=Ft.get(Le.image.toString());if(!va)continue;Or=Le.image,Qe.iconsInText=Qe.iconsInText||!0,Qn=va.paddedRect;const li=va.displaySize;kn=kn*Qo/hn,Dn={width:li[0],height:li[1],left:0,top:-NB,advance:Es?li[1]:li[0],localGlyph:!1},Ni=ur?-Dn.height*kn:$n*Qo-17-li[1]*kn,Ci=Dn.advance;const Qs=(Es?li[0]:li[1])*kn-Qo*$n;Qs>0&&Qs>Hr&&(Hr=Qs)}else{const va=ft[Le.fontStack];if(!va)continue;va[Sn]&&(Qn=va[Sn]);const li=dt[Le.fontStack];if(!li)continue;const Qs=li.glyphs[Sn];if(!Qs)continue;if(Dn=Qs.metrics,Ci=Sn!==8203?Qo:0,ur){const Ds=li.ascender!==void 0?Math.abs(li.ascender):0,ps=li.descender!==void 0?Math.abs(li.descender):0,da=(Ds+ps)*kn;Mi<da&&(Mi=da,gi=(Ds-ps)/2*kn),Ni=-Ds*kn}else Ni=($n-kn)*Qo-17}Es?(Qe.verticalizable=!0,si.push({glyph:Sn,image:Or,x:Tt,y:zt+Ni,vertical:Es,scale:kn,localGlyph:Dn.localGlyph,fontStack:Le.fontStack,sectionIndex:It,metrics:Dn,rect:Qn}),Tt+=Ci*kn+xn):(si.push({glyph:Sn,image:Or,x:Tt,y:zt+Ni,vertical:Es,scale:kn,localGlyph:Dn.localGlyph,fontStack:Le.fontStack,sectionIndex:It,metrics:Dn,rect:Qn}),Tt+=Dn.advance*kn+xn)}si.length!==0&&(wn=Math.max(Tt-xn,wn),ur?DB(si,pn,Hr,gi,Wt*$n/2):DB(si,pn,Hr,0,Wt/2)),Tt=0;const Gs=Wt*$n+Hr;kr.lineOffset=Math.max(Hr,Cr),zt+=Gs,++Jn}var cn;const yn=zt,{horizontalAlign:er,verticalAlign:Bn}=ON(bn);(function(En,$n,Cr,kr,si,Hr){const Mi=($n-Cr)*si,gi=-Hr*kr;for(const Gs of En)for(const Ie of Gs.positionedGlyphs)Ie.x+=Mi,Ie.y+=gi})(Qe.positionedLines,pn,er,Bn,wn,yn),Qe.top+=-Bn*yn,Qe.bottom=Qe.top+yn,Qe.left+=-er*wn,Qe.right=Qe.left+wn,Qe.hasBaseline=ur})(Ke,i,l,h,ge,b,j,M,U,R,q,te),!(function(Qe){for(const dt of Qe)if(dt.positionedGlyphs.length!==0)return!1;return!0})(tt))return Ke}const _2={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},cse={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function PB(u,i,l,h,g,x){if(i.image){const b=h.get(i.image.toString());return b?b.displaySize[0]*i.scale*Qo/x+g:0}{const b=l[i.fontStack],j=b&&b.glyphs[u];return j?j.metrics.advance*i.scale+g:0}}function MB(u,i,l,h){const g=Math.pow(u-i,2);return h?u<i?g/2:2*g:g+Math.abs(l)*l}function use(u,i,l){let h=0;return u===10&&(h-=1e4),l&&(h+=150),u!==40&&u!==65288||(h+=50),i!==41&&i!==65289||(h+=50),h}function RB(u,i,l,h,g,x){let b=null,j=MB(i,l,g,x);for(const M of h){const R=MB(i-M.x,l,g,x)+M.badness;R<=j&&(b=M,j=R)}return{index:u,x:i,priorBreak:b,badness:j}}function OB(u){return u?OB(u.priorBreak).concat(u.index):[]}function ON(u){let i=.5,l=.5;switch(u){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:i,verticalAlign:l}}function DB(u,i,l,h,g){if(!(i||l||h||g))return;const x=u.length-1,b=u[x],j=(b.x+b.metrics.advance*b.scale)*i;for(let M=0;M<=x;M++)u[M].x-=j,u[M].y+=l+h+g}function kB(u){return u.imagePrimary!==void 0&&u.top!==void 0&&u.bottom!==void 0&&u.left!==void 0&&u.right!==void 0}function dse(u,i,l,h){const{horizontalAlign:g,verticalAlign:x}=ON(h),b=l[0]-u.displaySize[0]*g,j=l[1]-u.displaySize[1]*x;return{imagePrimary:u,imageSecondary:i,top:j,bottom:j+u.displaySize[1],left:b,right:b+u.displaySize[0]}}function IB(u,i,l,h,g,x){const b=u.imagePrimary;let j;if(b.content){const ue=b.content,ge=b.pixelRatio||1;j=[ue[0]/ge,ue[1]/ge,b.displaySize[0]-ue[2]/ge,b.displaySize[1]-ue[3]/ge]}const M=i.left*x,R=i.right*x;let L,U,q,ee;l==="width"||l==="both"?(ee=g[0]+M-h[3],U=g[0]+R+h[1]):(ee=g[0]+(M+R-b.displaySize[0])/2,U=ee+b.displaySize[0]);const te=i.top*x,le=i.bottom*x;return l==="height"||l==="both"?(L=g[1]+te-h[0],q=g[1]+le+h[2]):(L=g[1]+(te+le-b.displaySize[1])/2,q=L+b.displaySize[1]),{imagePrimary:b,imageSecondary:void 0,top:L,right:U,bottom:q,left:ee,collisionPadding:j}}function LB(u){return!u.imagePrimary.stretchX}function zB(u){return!u.imagePrimary.stretchY}function FB(u){return{width:u.right-u.left,height:u.bottom-u.top}}const zp=128;function BB(u,i,l){const{expression:h}=i;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new hs(u+1,{worldview:l}))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:g,interpolationType:x}=h;let b=0;for(;b<g.length&&g[b]<=u;)b++;b=Math.max(0,b-1);let j=b;for(;j<g.length&&g[j]<u+1;)j++;j=Math.min(g.length-1,j);const M=g[b],R=g[j];return h.kind==="composite"?{kind:"composite",minZoom:M,maxZoom:R,interpolationType:x}:{kind:"camera",minZoom:M,maxZoom:R,minSize:h.evaluate(new hs(M,{worldview:l})),maxSize:h.evaluate(new hs(R,{worldview:l})),interpolationType:x}}}function DN(u,{uSize:i,uSizeT:l},{lowerSize:h,upperSize:g}){return u.kind==="source"?h/zp:u.kind==="composite"?yr(h/zp,g/zp,l):i}function Vw(u,i,l=1){let h=0,g=0;if(u.kind==="constant")g=u.layoutSize*l;else if(u.kind!=="source"){const{interpolationType:x,minZoom:b,maxZoom:j}=u,M=x?Oe(na.interpolationFactor(x,i,b,j),0,1):0;u.kind==="camera"?g=yr(u.minSize,u.maxSize,M)*l:h=M*l}return{uSizeT:h,uSize:g}}class cg extends Rt{constructor(i,l,h,g,x){super(i,l),this.angle=g,this.z=h,x!==void 0&&(this.segment=x)}clone(){return new cg(this.x,this.y,this.z,this.angle,this.segment)}}function UB(u,i,l,h,g){if(i.segment===void 0)return!0;let x=i,b=i.segment+1,j=0;for(;j>-l/2;){if(b--,b<0)return!1;j-=u[b].dist(x),x=u[b]}j+=u[b].dist(u[b+1]),b++;const M=[];let R=0;for(;j<l/2;){const L=u[b],U=u[b+1];if(!U)return!1;let q=u[b-1].angleTo(L)-L.angleTo(U);for(q=Math.abs((q+3*Math.PI)%(2*Math.PI)-Math.PI),M.push({distance:j,angleDelta:q}),R+=q;j-M[0].distance>h;)R-=M.shift().angleDelta;if(R>g)return!1;b++,j+=L.dist(U)}return!0}function VB(u){let i=0;for(let l=0;l<u.length-1;l++)i+=u[l].dist(u[l+1]);return i}function $B(u,i,l){return u?.6*i*l:0}function qB(u,i){return Math.max(u?u.right-u.left:0,i?i.right-i.left:0)}function hse(u,i,l,h,g,x){const b=$B(l,g,x),j=qB(l,h)*x;let M=0;const R=VB(u)/2;for(let L=0;L<u.length-1;L++){const U=u[L],q=u[L+1],ee=U.dist(q);if(M+ee>R){const te=(R-M)/ee,le=yr(U.x,q.x,te),ue=yr(U.y,q.y,te),ge=new cg(le,ue,0,q.angleTo(U),L);return!b||UB(u,ge,j,b,i)?ge:void 0}M+=ee}}function fse(u,i,l,h,g,x,b,j,M){const R=$B(h,x,b),L=qB(h,g),U=L*b,q=u[0].x===0||u[0].x===M||u[0].y===0||u[0].y===M;return i-U<i/4&&(i=U+i/4),HB(u,q?i/2*j%i:(L/2+2*x)*b*j%i,i,R,l,U,q,!1,M)}function HB(u,i,l,h,g,x,b,j,M){const R=x/2,L=VB(u);let U=0,q=i-l,ee=[];for(let te=0;te<u.length-1;te++){const le=u[te],ue=u[te+1],ge=le.dist(ue),Se=ue.angleTo(le);for(;q+l<U+ge;){q+=l;const we=(q-U)/ge,Pe=yr(le.x,ue.x,we),tt=yr(le.y,ue.y,we);if(Pe>=0&&Pe<M&&tt>=0&&tt<M&&q-R>=0&&q+R<=L){const Ke=new cg(Pe,tt,0,Se,te);h&&!UB(u,Ke,x,h,g)||ee.push(Ke)}}U+=ge}return j||ee.length||b||(ee=HB(u,U/2,l,h,g,x,b,!0,M)),ee}function GB(u){let i=0,l=0;for(const b of u)i+=b.w*b.h,l=Math.max(l,b.w);u.sort(((b,j)=>j.h-b.h));const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),l),h:1/0}];let g=0,x=0;for(const b of u)for(let j=h.length-1;j>=0;j--){const M=h[j];if(!(b.w>M.w||b.h>M.h)){if(b.x=M.x,b.y=M.y,x=Math.max(x,b.y+b.h),g=Math.max(g,b.x+b.w),b.w===M.w&&b.h===M.h){const R=h.pop();R&&j<h.length&&(h[j]=R)}else b.h===M.h?(M.x+=b.w,M.w-=b.w):b.w===M.w?(M.y+=b.h,M.h-=b.h):(h.push({x:M.x+b.w,y:M.y,w:M.w-b.w,h:b.h}),M.y+=b.h,M.h-=b.h);break}}return{w:g,h:x,fill:i/(g*x)||0}}Hn(cg,"Anchor");const _x=1;class $w{static getImagePositionScale(i,l,h){if(l&&i&&i.options&&i.options.transform){const g=i.options.transform;return{x:g.a,y:g.d}}return{x:h,y:h}}constructor(i,l,h,g){this.paddedRect=i;const{pixelRatio:x,version:b,stretchX:j,stretchY:M,content:R,sdf:L,usvg:U}=l;this.pixelRatio=x,this.stretchX=j,this.stretchY=M,this.content=R,this.version=b,this.padding=h,this.sdf=L,this.usvg=U,this.scale=$w.getImagePositionScale(g,U,x)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function kN(u,i,l){const h=vc.parse(u),g=(function(x,b,j=[1,1]){return{x:0,y:0,w:(x.data?x.data.width:x.width*j[0])+2*b,h:(x.data?x.data.height:x.height*j[1])+2*b}})(i,l,[h.options.transform.a,h.options.transform.d]);return{bin:g,imagePosition:new $w(g,i,l,h),imageVariant:h}}class WB{constructor(i,l,h){const g=new Map,x=new Map;this.haveRenderCallbacks=[];const b=[];this.addImages(i,g,_x,b),this.addImages(l,x,2,b);const{w:j,h:M}=GB(b),R=new Oo({width:j||1,height:M||1});for(const[L,U]of i.entries()){const q=g.get(L).paddedRect;Oo.copy(U.data,R,{x:0,y:0},{x:q.x+_x,y:q.y+_x},U.data,h,U.sdf)}for(const[L,U]of l.entries()){const q=x.get(L),ee=q.paddedRect;let te=q.padding;const le=ee.x+te,ue=ee.y+te,ge=U.data.width,Se=U.data.height;te=te>1?te-1:te,Oo.copy(U.data,R,{x:0,y:0},{x:le,y:ue},U.data,h),Oo.copy(U.data,R,{x:0,y:Se-te},{x:le,y:ue-te},{width:ge,height:te},h),Oo.copy(U.data,R,{x:0,y:0},{x:le,y:ue+Se},{width:ge,height:te},h),Oo.copy(U.data,R,{x:ge-te,y:0},{x:le-te,y:ue},{width:te,height:Se},h),Oo.copy(U.data,R,{x:0,y:0},{x:le+ge,y:ue},{width:te,height:Se},h),Oo.copy(U.data,R,{x:ge-te,y:Se-te},{x:le-te,y:ue-te},{width:te,height:te},h),Oo.copy(U.data,R,{x:0,y:Se-te},{x:le+ge,y:ue-te},{width:te,height:te},h),Oo.copy(U.data,R,{x:0,y:0},{x:le+ge,y:ue+Se},{width:te,height:te},h),Oo.copy(U.data,R,{x:ge-te,y:0},{x:le-te,y:ue+Se},{width:te,height:te},h)}this.lut=h,this.image=R,this.iconPositions=g,this.patternPositions=x}addImages(i,l,h,g){for(const[x,b]of i.entries()){const{bin:j,imagePosition:M,imageVariant:R}=kN(x,b,h);l.set(x,M),g.push(j),b.hasRenderCallback&&this.haveRenderCallbacks.push(R.id)}}patchUpdatedImages(i,l,h){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((g=>i.hasImage(g,h))),i.dispatchRenderCallbacks(this.haveRenderCallbacks,h);for(const g of i.getUpdatedImages(h)){for(const x of this.iconPositions.keys()){const b=vc.parse(x);if(vl.isEqual(b.id,g)){const j=i.getImage(g,h);this.patchUpdatedImage(this.iconPositions.get(x),j,l)}}for(const x of this.patternPositions.keys()){const b=vc.parse(x);if(vl.isEqual(b.id,g)){const j=i.getImage(g,h);this.patchUpdatedImage(this.patternPositions.get(x),j,l)}}}}patchUpdatedImage(i,l,h){if(!i||!l||i.version===l.version)return;i.version=l.version;const[g,x]=i.tl,b=i.sdf;if(this.lut||b){const j={width:l.data.width,height:l.data.height},M=new Oo(j);Oo.copy(l.data,M,{x:0,y:0},{x:0,y:0},j,this.lut,b),h.update(M,{position:{x:g,y:x}})}else h.update(l.data,{position:{x:g,y:x}})}}Hn($w,"ImagePosition"),Hn(WB,"ImageAtlas");const qw=1e20;function XB(u,i,l,h,g,x,b,j,M){for(let R=i;R<i+h;R++)ZB(u,l*x+R,x,g,b,j,M);for(let R=l;R<l+g;R++)ZB(u,R*x+i,1,h,b,j,M)}function ZB(u,i,l,h,g,x,b){x[0]=0,b[0]=-qw,b[1]=qw,g[0]=u[i];for(let j=1,M=0,R=0;j<h;j++){g[j]=u[i+j*l];const L=j*j;do{const U=x[M];R=(g[j]-g[U]+L-U*U)/(j-U)/2}while(R<=b[M]&&--M>-1);M++,x[M]=j,b[M]=R,b[M+1]=qw}for(let j=0,M=0;j<h;j++){for(;b[M+1]<j;)M++;const R=x[M],L=j-R;u[i+j*l]=g[R]+L*L}}const Sf=2,IN={none:0,ideographs:1,all:2};class i0{constructor(i,l,h){this.requestManager=i,this.localGlyphMode=l,this.localFontFamily=h,this.url="",this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i){this.url=i}getGlyphs(i,l){const h=[],g=this.url||Ua.GLYPHS_URL;for(const x in i)for(const b of i[x])h.push({stack:x,id:b});ht(h,(({stack:x,id:b},j)=>{let M=this.entries[x];M||(M=this.entries[x]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let R=M.glyphs[b];if(R!==void 0)return void j(null,{stack:x,id:b,glyph:R});if(R=this._tinySDF(M,x,b),R)return M.glyphs[b]=R,void j(null,{stack:x,id:b,glyph:R});const L=Math.floor(b/256);if(256*L>65535)return ai("glyphs > 65535 not supported"),void j(null,{stack:x,id:b,glyph:R});if(M.ranges[L])return void j(null,{stack:x,id:b,glyph:R});let U=M.requests[L];U||(U=M.requests[L]=[],i0.loadGlyphRange(x,L,g,this.requestManager,((q,ee)=>{if(ee){M.ascender=ee.ascender,M.descender=ee.descender;for(const te in ee.glyphs)this._doesCharSupportLocalGlyph(+te)||(M.glyphs[+te]=ee.glyphs[+te]);M.ranges[L]=!0}for(const te of U)te(q,ee);delete M.requests[L]}))),U.push(((q,ee)=>{q?j(q):ee&&j(null,{stack:x,id:b,glyph:ee.glyphs[b]||null})}))}),((x,b)=>{if(x)l(x);else if(b){const j={};for(const{stack:M,id:R,glyph:L}of b)j[M]===void 0&&(j[M]={}),j[M].glyphs===void 0&&(j[M].glyphs={}),j[M].glyphs[R]=L&&{id:L.id,bitmap:L.bitmap.clone(),metrics:L.metrics},j[M].ascender=this.entries[M].ascender,j[M].descender=this.entries[M].descender;l(null,j)}}))}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==IN.none&&(this.localGlyphMode===IN.all?!!this.localFontFamily:!!this.localFontFamily&&(sr["CJK Unified Ideographs"](i)||sr["Hangul Syllables"](i)||sr.Hiragana(i)||sr.Katakana(i)||sr["CJK Symbols and Punctuation"](i)||sr["CJK Unified Ideographs Extension A"](i)||sr["CJK Unified Ideographs Extension B"](i)||sr.Osage(i)))}_tinySDF(i,l,h){const g=this.localFontFamily;if(!g||!this._doesCharSupportLocalGlyph(h))return;let x=i.tinySDF;if(!x){let le="400";/bold/i.test(l)?le="900":/medium/i.test(l)?le="500":/light/i.test(l)&&(le="200"),x=i.tinySDF=new i0.TinySDF({fontFamily:g,fontWeight:le,fontSize:24*Sf,buffer:3*Sf,radius:8*Sf}),x.fontWeight=le}if(this.localGlyphs[x.fontWeight][h])return this.localGlyphs[x.fontWeight][h];const b=String.fromCodePoint(h),{data:j,width:M,height:R,glyphWidth:L,glyphHeight:U,glyphLeft:q,glyphTop:ee,glyphAdvance:te}=x.draw(b);return this.localGlyphs[x.fontWeight][h]={id:h,bitmap:new xf({width:M,height:R},j),metrics:{width:L/Sf,height:U/Sf,left:q/Sf,top:ee/Sf-27,advance:te/Sf,localGlyph:!0}}}}i0.loadGlyphRange=function(u,i,l,h,g){const x=256*i,b=x+255,j=h.transformRequest(h.normalizeGlyphsURL(l).replace("{fontstack}",u).replace("{range}",`${x}-${b}`),Mu.Glyphs);gc(j,((M,R)=>{if(M)g(M);else if(R){const L={},U=(function(q){return new x2(q).readFields(ase,{})})(R);for(const q of U.glyphs)L[q.id]=q;g(null,{glyphs:L,ascender:U.ascender,descender:U.descender})}}))},i0.TinySDF=class{constructor({fontSize:u=24,buffer:i=3,radius:l=8,cutoff:h=.25,fontFamily:g="sans-serif",fontWeight:x="normal",fontStyle:b="normal"}={}){this.buffer=i,this.cutoff=h,this.radius=l;const j=this.size=u+4*i,M=this._createCanvas(j),R=this.ctx=M.getContext("2d",{willReadFrequently:!0});R.font=`${b} ${x} ${u}px ${g}`,R.textBaseline="alphabetic",R.textAlign="left",R.fillStyle="black",this.gridOuter=new Float64Array(j*j),this.gridInner=new Float64Array(j*j),this.f=new Float64Array(j),this.z=new Float64Array(j+1),this.v=new Uint16Array(j)}_createCanvas(u){const i=document.createElement("canvas");return i.width=i.height=u,i}draw(u){const{width:i,actualBoundingBoxAscent:l,actualBoundingBoxDescent:h,actualBoundingBoxLeft:g,actualBoundingBoxRight:x}=this.ctx.measureText(u),b=Math.ceil(l),j=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-g))),M=Math.min(this.size-this.buffer,b+Math.ceil(h)),R=j+2*this.buffer,L=M+2*this.buffer,U=Math.max(R*L,0),q=new Uint8ClampedArray(U),ee={data:q,width:R,height:L,glyphWidth:j,glyphHeight:M,glyphTop:b,glyphLeft:0,glyphAdvance:i};if(j===0||M===0)return ee;const{ctx:te,buffer:le,gridInner:ue,gridOuter:ge}=this;te.clearRect(le,le,j,M),te.fillText(u,le,le+b);const Se=te.getImageData(le,le,j,M);ge.fill(qw,0,U),ue.fill(0,0,U);for(let we=0;we<M;we++)for(let Pe=0;Pe<j;Pe++){const tt=Se.data[4*(we*j+Pe)+3]/255;if(tt===0)continue;const Ke=(we+le)*R+Pe+le;if(tt===1)ge[Ke]=0,ue[Ke]=qw;else{const Qe=.5-tt;ge[Ke]=Qe>0?Qe*Qe:0,ue[Ke]=Qe<0?Qe*Qe:0}}XB(ge,0,0,R,L,R,this.f,this.v,this.z),XB(ue,le,le,j,M,R,this.f,this.v,this.z);for(let we=0;we<U;we++){const Pe=Math.sqrt(ge[we])-Math.sqrt(ue[we]);q[we]=Math.round(255-255*(Pe/this.radius+this.cutoff))}return ee}};const Oy=_x;function YB(u,i){return u+i[1]-i[0]}function KB(u,i,l,h,g=1){const x=[],b=u.imagePrimary,j=b.pixelRatio,M=b.paddedRect.w-2*Oy,R=b.paddedRect.h-2*Oy,L=(u.right-u.left)*g,U=(u.bottom-u.top)*g,q=b.stretchX||[[0,M]],ee=b.stretchY||[[0,R]],te=q.reduce(YB,0),le=ee.reduce(YB,0),ue=M-te,ge=R-le;let Se=0,we=te,Pe=0,tt=le,Ke=0,Qe=ue,dt=0,ft=ge;if(b.content&&h){const xt=b.content;Se=b2(q,0,xt[0]),Pe=b2(ee,0,xt[1]),we=b2(q,xt[0],xt[2]),tt=b2(ee,xt[1],xt[3]),Ke=xt[0]-Se,dt=xt[1]-Pe,Qe=xt[2]-xt[0]-we,ft=xt[3]-xt[1]-tt}const Ft=(xt,Wt,bn,tn)=>{const dn=w2(xt.stretch-Se,we,L,u.left*g),xn=S2(xt.fixed-Ke,Qe,xt.stretch,te),Lt=w2(Wt.stretch-Pe,tt,U,u.top*g),hn=S2(Wt.fixed-dt,ft,Wt.stretch,le),Tt=w2(bn.stretch-Se,we,L,u.left*g),zt=S2(bn.fixed-Ke,Qe,bn.stretch,te),wn=w2(tn.stretch-Pe,tt,U,u.top*g),pn=S2(tn.fixed-dt,ft,tn.stretch,le),ur=new Rt(dn,Lt),Jn=new Rt(Tt,Lt),cn=new Rt(Tt,wn),yn=new Rt(dn,wn),er=new Rt(xn/j,hn/j),Bn=new Rt(zt/j,pn/j),En=i*Math.PI/180;if(En){const Mi=Math.sin(En),gi=Math.cos(En),Gs=[gi,-Mi,Mi,gi];ur._matMult(Gs),Jn._matMult(Gs),yn._matMult(Gs),cn._matMult(Gs)}const $n=xt.stretch+xt.fixed,Cr=bn.stretch+bn.fixed,kr=Wt.stretch+Wt.fixed,si=tn.stretch+tn.fixed,Hr=u.imageSecondary;return{tl:ur,tr:Jn,bl:yn,br:cn,texPrimary:{x:b.paddedRect.x+Oy+$n,y:b.paddedRect.y+Oy+kr,w:Cr-$n,h:si-kr},texSecondary:Hr?{x:Hr.paddedRect.x+Oy+$n,y:Hr.paddedRect.y+Oy+kr,w:Cr-$n,h:si-kr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:er,pixelOffsetBR:Bn,minFontScaleX:Qe/j/L,minFontScaleY:ft/j/U,isSDF:l}};if(h&&(b.stretchX||b.stretchY)){const xt=JB(q,ue,te),Wt=JB(ee,ge,le);for(let bn=0;bn<xt.length-1;bn++){const tn=xt[bn],dn=xt[bn+1];for(let xn=0;xn<Wt.length-1;xn++)x.push(Ft(tn,Wt[xn],dn,Wt[xn+1]))}}else x.push(Ft({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:R+1}));return x}function b2(u,i,l){let h=0;for(const g of u)h+=Math.max(i,Math.min(l,g[1]))-Math.max(i,Math.min(l,g[0]));return h}function JB(u,i,l){const h=[{fixed:-Oy,stretch:0}];for(const[g,x]of u){const b=h[h.length-1];h.push({fixed:g-b.stretch,stretch:b.stretch}),h.push({fixed:g-b.stretch,stretch:b.stretch+(x-g)})}return h.push({fixed:i+Oy,stretch:l}),h}function w2(u,i,l,h){return u/i*l+h}function S2(u,i,l,h){return u-i*l/h}function pse(u,i,l,h){const g=i+u.positionedLines[h].lineOffset;return h===0?l+g/2:l+(g+(i+u.positionedLines[h-1].lineOffset))/2}function mse(u,i=1,l=!1){let h=1/0,g=1/0,x=-1/0,b=-1/0;const j=u[0];for(let ee=0;ee<j.length;ee++){const te=j[ee];(!ee||te.x<h)&&(h=te.x),(!ee||te.y<g)&&(g=te.y),(!ee||te.x>x)&&(x=te.x),(!ee||te.y>b)&&(b=te.y)}const M=Math.min(x-h,b-g);let R=M/2;const L=new ym([],gse);if(M===0)return new Rt(h,g);for(let ee=h;ee<x;ee+=M)for(let te=g;te<b;te+=M)L.push(new s0(ee+R,te+R,R,u));let U=(function(ee){let te=0,le=0,ue=0;const ge=ee[0];for(let Se=0,we=ge.length,Pe=we-1;Se<we;Pe=Se++){const tt=ge[Se],Ke=ge[Pe],Qe=tt.x*Ke.y-Ke.x*tt.y;le+=(tt.x+Ke.x)*Qe,ue+=(tt.y+Ke.y)*Qe,te+=3*Qe}return new s0(le/te,ue/te,0,ee)})(u),q=L.length;for(;L.length;){const ee=L.pop();(ee.d>U.d||!U.d)&&(U=ee,l&&console.log("found best %d after %d probes",Math.round(1e4*ee.d)/1e4,q)),ee.max-U.d<=i||(R=ee.h/2,L.push(new s0(ee.p.x-R,ee.p.y-R,R,u)),L.push(new s0(ee.p.x+R,ee.p.y-R,R,u)),L.push(new s0(ee.p.x-R,ee.p.y+R,R,u)),L.push(new s0(ee.p.x+R,ee.p.y+R,R,u)),q+=4)}return l&&(console.log(`num probes: ${q}`),console.log(`best distance: ${U.d}`)),U.p}function gse(u,i){return i.max-u.max}class s0{constructor(i,l,h,g){this.p=new Rt(i,l),this.h=h,this.d=(function(x,b){let j=!1,M=1/0;for(let R=0;R<b.length;R++){const L=b[R];for(let U=0,q=L.length,ee=q-1;U<q;ee=U++){const te=L[U],le=L[ee];te.y>x.y!=le.y>x.y&&x.x<(le.x-te.x)*(x.y-te.y)/(le.y-te.y)+te.x&&(j=!j),M=Math.min(M,sc(x,te,le))}}return(j?1:-1)*Math.sqrt(M)})(this.p,g),this.max=this.d+this.h*Math.SQRT2}}const yse=Object.keys,LN=Number.POSITIVE_INFINITY,vse=Math.sqrt(2);function QB(u,[i,l]){let h=0,g=0;if(l===LN){i<0&&(i=0);const x=i/vse;switch(u){case"top-right":case"top-left":g=x-7;break;case"bottom-right":case"bottom-left":g=7-x;break;case"bottom":g=7-i;break;case"top":g=i-7}switch(u){case"top-right":case"bottom-right":h=-x;break;case"top-left":case"bottom-left":h=x;break;case"left":h=i;break;case"right":h=-i}}else{switch(i=Math.abs(i),l=Math.abs(l),u){case"top-right":case"top-left":case"top":g=l-7;break;case"bottom-right":case"bottom-left":case"bottom":g=7-l}switch(u){case"top-right":case"bottom-right":case"right":h=-i;break;case"top-left":case"bottom-left":case"left":h=i}}return[h,g]}function T2(u,i,l,h,g,x,b,j,M){if(!i||!i.usvg)return;const R=FB(h),L=FB(g),U=x!=="both"&&x!=="width"||!LB(h)?1:L.width/R.width,q=x!=="both"&&x!=="height"||!zB(h)?1:L.height/R.height;l.scaleSelf(U,q);const ee=l.toString();b.set(ee,l),j.set(ee,i);const{imagePosition:te}=kN(ee,i,_x);M.set(ee,te)}function e4(u,i,l,h,g,x,b,j,M){if(!u)return;const R=(function(L,U,q,ee,te,le){if(L.kind==="camera")return L.maxSize;if(L.kind==="composite"){const ue=U.possiblyEvaluate(new hs(L.maxZoom,{worldview:le}),q).evaluate(te,{},q),ge=U.possiblyEvaluate(new hs(L.minZoom,{worldview:le}),q).evaluate(te,{},q);return Math.max(ue,ge)}return U.possiblyEvaluate(new hs(ee,{worldview:le})).evaluate(te,{},q)})(i,l,h,g,x,M);return u.scaleSelf(R*j*b)}function t4(u,i,l,h,g,x,b,j,M){return{iconPrimary:e4(u.getPrimary(),i,l,h,g,x,b,j,M),iconSecondary:e4(u.getSecondary(),i,l,h,g,x,b,j,M)}}function xse(u,i,l){if(!i)return;const h=l.get(u.toString()),g=l.get(i.toString());g&&(h.paddedRect.w===g.paddedRect.w&&h.paddedRect.h===g.paddedRect.h||ai(`Mismatch in icon variant sizes: ${u.toString()} and ${i.toString()}`),h.usvg!==g.usvg&&ai(`Mismatch in icon variant image types: ${u.id} and ${i.id}`))}function n4(u,i,l,h){if(!u)return;const g=i.get(l.toString());if(u.imagePrimary=g,h){const x=i.get(h.toString());u.imageSecondary=x}}function _se(u,i){for(const l in u.horizontal)r4(u.horizontal[l],i);r4(u.vertical,i)}function r4(u,i){if(u){for(const l of u.positionedLines)for(const h of l.positionedGlyphs)if(h.image!==null){const g=h.image.toString();h.rect=i.get(g).paddedRect}}}function zN(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function bse(u,i,l,h,g,x,b,j,M){const R=FN(x.horizontal)||x.vertical,L=l.get("icon-text-fit-padding").evaluate(h,{},g);let U,q=i;return i&&M!=="none"&&(u.allowVerticalPlacement&&x.vertical&&(U=IB(i,x.vertical,M,L,j,b)),R&&(q=IB(i,R,M,L,j,b))),{defaultShapedIcon:q,verticallyShapedIcon:U}}function wse(u,i,l,h,g,x,b,j,M,R,L,U,q,ee,te,le,ue,ge,Se,we){let Pe=b.textMaxSize.evaluate(i,{},q);Pe===void 0?Pe=j*b.textScaleFactor:Pe*=b.textScaleFactor;const tt=u.layers[0].layout,Ke=FN(l.horizontal)||l.vertical,Qe=ee.name==="globe",dt=Qo,ft=u.tilePixelRatio*Pe/dt,Ft=(xn=u.overscaling,u.zoom>18&&xn>2&&(xn>>=1),Math.max(mn/(512*xn),1)*tt.get("symbol-spacing")),xt=tt.get("text-padding")*u.tilePixelRatio,Wt=tt.get("icon-padding")*u.tilePixelRatio,bn=Dr(tt.get("text-max-angle")),tn=tt.get("icon-rotation-alignment")==="map"&&we!=="point",dn=Ft/2;var xn;u.hasAnyIconTextFit===!1&&ue!=="none"&&(u.hasAnyIconTextFit=!0);const Lt=i.properties?+i.properties[In]:null,hn=Lt&&u.elevationFeatureIdToIndex?u.elevationFeatureIdToIndex.get(Lt):65535,Tt=(zt,wn,pn)=>{if(wn.x<0||wn.x>=mn||wn.y<0||wn.y>=mn)return;let ur=null;if(Qe){const{x:Jn,y:cn,z:yn}=ee.projectTilePoint(wn.x,wn.y,pn);ur={anchor:new cg(Jn,cn,yn,0,void 0),up:ee.upVector(pn,wn.x,wn.y)}}(function(Jn,cn,yn,er,Bn,En,$n,Cr,kr,si,Hr,Mi,gi,Gs,Ie,Le,It,Sn,kn,Dn,Qn,Or,Ci,Ni,hi,Es,va,li,Qs){const Ds=Jn.addToLineVertexArray(cn,er);let ps,da,Ws,ks,zs,_s,fi,Cs=0,ha=0,Mr=0,Zi=0,Xs=-1,Sa=-1;const ea={};let yo=kl("");const Ps=yn?yn.anchor:cn,ao=li!=="none";let Xc=0,El=0;if(kr._unevaluatedLayout.getValue("text-radial-offset")===void 0){const vo=kr.layout.get("text-offset").evaluate(Qn,{},hi);Xc=vo[0]*Qo,El=vo[1]*Qo}else Xc=kr.layout.get("text-radial-offset").evaluate(Qn,{},hi)*Qo,El=LN;if(Jn.allowVerticalPlacement&&Bn.vertical){const vo=Bn.vertical;if(Ie)_s=BN(vo),Cr&&(fi=BN(Cr));else{const Do=kr.layout.get("text-rotate").evaluate(Qn,{},hi)+90;Ws=A2(si,Ps,cn,Hr,Mi,gi,vo,Gs,Do,Le),Cr&&(ks=A2(si,Ps,cn,Hr,Mi,gi,Cr,Sn,Do))}}if(En){const vo=Jn.iconSizeData,Do=kr.layout.get("icon-rotate").evaluate(Qn,{},hi),Cl=KB(En,Do,Ci,ao,Or.iconScaleFactor),oc=Cr?KB(Cr,Do,Ci,ao,Or.iconScaleFactor):void 0;da=A2(si,Ps,cn,Hr,Mi,gi,En,Sn,Do,null),Cs=4*Cl.length;let ql=null;vo.kind==="source"?(ql=[zp*kr.layout.get("icon-size").evaluate(Qn,{},hi)*Or.iconScaleFactor],ql[0]>Dy&&ai(`${Jn.layerIds[0]}: Value for "icon-size" is >= ${Hw}. Reduce your "icon-size".`)):vo.kind==="composite"&&(ql=[zp*Or.compositeIconSizes[0].evaluate(Qn,{},hi)*Or.iconScaleFactor,zp*Or.compositeIconSizes[1].evaluate(Qn,{},hi)*Or.iconScaleFactor],(ql[0]>Dy||ql[1]>Dy)&&ai(`${Jn.layerIds[0]}: Value for "icon-size" is >= ${Hw}. Reduce your "icon-size".`)),Jn.addSymbols(Jn.icon,Cl,ql,Dn,kn,Qn,void 0,yn,cn,Ds.lineStartIndex,Ds.lineLength,-1,Ni,hi,Es,va),Xs=Jn.icon.placedSymbolArray.length-1,oc&&(ha=4*oc.length,Jn.addSymbols(Jn.icon,oc,ql,Dn,kn,Qn,yu.vertical,yn,cn,Ds.lineStartIndex,Ds.lineLength,-1,Ni,hi,Es,va),Sa=Jn.icon.placedSymbolArray.length-1)}for(const vo in Bn.horizontal){const Do=vo,Cl=Bn.horizontal[Do];ps||(yo=kl(Cl.text),Ie?zs=BN(Cl):ps=A2(si,Ps,cn,Hr,Mi,gi,Cl,Gs,kr.layout.get("text-rotate").evaluate(Qn,{},hi),Le));const oc=Cl.positionedLines.length===1;if(Mr+=i4(Jn,yn,cn,Cl,$n,kr,Ie,Qn,Le,Ds,Bn.vertical?yu.horizontal:yu.horizontalOnly,oc?yse(Bn.horizontal):[Do],ea,Xs,Or,Ni,hi,Es),oc)break}Bn.vertical&&(Zi+=i4(Jn,yn,cn,Bn.vertical,$n,kr,Ie,Qn,Le,Ds,yu.vertical,["vertical"],ea,Sa,Or,Ni,hi,Es));let ul=-1;const Zc=(vo,Do)=>vo?Math.max(vo,Do):Do;ul=Zc(zs,ul),ul=Zc(_s,ul),ul=Zc(fi,ul);const Fp=ul>-1?1:0;Jn.glyphOffsetArray.length>=65535&&ai("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Qn.sortKey!==void 0&&Jn.addToSortKeyRanges(Jn.symbolInstances.length,Qn.sortKey),Jn.symbolInstances.emplaceBack(cn.x,cn.y,Ps.x,Ps.y,Ps.z,ea.right>=0?ea.right:-1,ea.center>=0?ea.center:-1,ea.left>=0?ea.left:-1,ea.vertical>=0?ea.vertical:-1,Xs,Sa,yo,ps!==void 0?ps:Jn.collisionBoxArray.length,ps!==void 0?ps+1:Jn.collisionBoxArray.length,Ws!==void 0?Ws:Jn.collisionBoxArray.length,Ws!==void 0?Ws+1:Jn.collisionBoxArray.length,da!==void 0?da:Jn.collisionBoxArray.length,da!==void 0?da+1:Jn.collisionBoxArray.length,ks||Jn.collisionBoxArray.length,ks?ks+1:Jn.collisionBoxArray.length,Hr,Mr,Zi,Cs,ha,Fp,0,Xc,El,ul,0,ao?1:0,Qs)})(u,wn,ur,zt,l,h,x,g,u.layers[0],u.collisionBoxArray,i.index,i.sourceLayerIndex,u.index,xt,Se,R,0,Wt,tn,ge,i,b,L,U,q,te,le,ue,hn)};if(we==="line")for(const zt of Q_(i.geometry,0,0,mn,mn)){const wn=fse(zt,Ft,bn,l.vertical||Ke,h,dt,ft,u.overscaling,mn);for(const pn of wn)Ke&&Sse(u,Ke.text,dn,pn)||Tt(zt,pn,q)}else if(we==="line-center"){for(const zt of i.geometry)if(zt.length>1){const wn=hse(zt,bn,l.vertical||Ke,h,dt,ft);wn&&Tt(zt,wn,q)}}else if(i.type==="Polygon")for(const zt of ux(i.geometry,0)){const wn=mse(zt,16);Tt(zt[0],new cg(wn.x,wn.y,0,0,void 0),q)}else if(i.type==="LineString")for(const zt of i.geometry)Tt(zt,new cg(zt[0].x,zt[0].y,0,0,void 0),q);else if(i.type==="Point")for(const zt of i.geometry)for(const wn of zt)Tt([wn],new cg(wn.x,wn.y,0,0,void 0),q)}const Hw=255,Dy=Hw*zp;function i4(u,i,l,h,g,x,b,j,M,R,L,U,q,ee,te,le,ue,ge){const Se=(function(tt,Ke,Qe,dt,ft,Ft,xt,Wt){const bn=[];if(Ke.positionedLines.length===0)return bn;const tn=dt.layout.get("text-rotate").evaluate(Ft,{})*Math.PI/180,dn=(function(zt){const wn=zt[0],pn=zt[1],ur=wn*pn;return ur>0?[wn,-pn]:ur<0?[-wn,pn]:wn===0?[pn,wn]:[pn,-wn]})(Qe);let xn=Math.abs(Ke.top-Ke.bottom);for(const zt of Ke.positionedLines)xn-=zt.lineOffset;const Lt=Ke.positionedLines.length,hn=xn/Lt;let Tt=Ke.top-Qe[1];for(let zt=0;zt<Lt;++zt){const wn=Ke.positionedLines[zt];Tt=pse(Ke,hn,Tt,zt);for(const pn of wn.positionedGlyphs){if(!pn.rect)continue;const ur=pn.rect||{};let Jn=NB+1,cn=!0,yn=1,er=0;if(pn.image){const Qn=xt.get(pn.image.toString());if(!Qn)continue;if(Qn.sdf){ai("SDF images are not supported in formatted text and will be ignored.");continue}cn=!1,yn=Qn.pixelRatio,Jn=_x/yn}const Bn=(ft||Wt)&&pn.vertical,En=pn.metrics.advance*pn.scale/2,$n=pn.metrics,Cr=pn.rect;if(Cr===null)continue;Wt&&Ke.verticalizable&&(er=pn.image?En-pn.metrics.width*pn.scale/2:0);const kr=ft?[pn.x+En,pn.y]:[0,0];let si=[0,0],Hr=[0,0],Mi=!1;ft||(Bn?(Hr=[pn.x+En+dn[0],pn.y+dn[1]-er],Mi=!0):si=[pn.x+En+Qe[0],pn.y+Qe[1]-er]);const gi=Cr.w*pn.scale/(yn*(pn.localGlyph?Sf:1)),Gs=Cr.h*pn.scale/(yn*(pn.localGlyph?Sf:1));let Ie,Le,It,Sn;if(Bn){const Qn=pn.y-Tt,Or=new Rt(-En,En-Qn),Ci=-Math.PI/2,Ni=new Rt(...Hr);Ie=new Rt(-En+si[0],si[1]),Ie._rotateAround(Ci,Or)._add(Ni),Ie.x+=-Qn+En,Ie.y-=($n.left-Jn)*pn.scale;const hi=pn.image?$n.advance*pn.scale:Qo*pn.scale,Es=String.fromCodePoint(pn.glyph);Zie(Es)?Ie.x+=(1-Jn)*pn.scale:Yie(Es)?Ie.x+=hi-$n.height*pn.scale+(-Jn-1)*pn.scale:Ie.x+=pn.image||$n.width+2*Jn===Cr.w&&$n.height+2*Jn===Cr.h?(hi-Gs)/2:(hi-($n.height+2*Jn)*pn.scale)/2,Le=new Rt(Ie.x,Ie.y-gi),It=new Rt(Ie.x+Gs,Ie.y),Sn=new Rt(Ie.x+Gs,Ie.y-gi)}else{const Qn=($n.left-Jn)*pn.scale-En+si[0],Or=(-$n.top-Jn)*pn.scale+si[1],Ci=Qn+gi,Ni=Or+Gs;Ie=new Rt(Qn,Or),Le=new Rt(Ci,Or),It=new Rt(Qn,Ni),Sn=new Rt(Ci,Ni)}if(tn){let Qn;Qn=ft?new Rt(0,0):Mi?new Rt(dn[0],dn[1]):new Rt(Qe[0],Qe[1]),Ie._rotateAround(tn,Qn),Le._rotateAround(tn,Qn),It._rotateAround(tn,Qn),Sn._rotateAround(tn,Qn)}const kn=new Rt(0,0),Dn=new Rt(0,0);bn.push({tl:Ie,tr:Le,bl:It,br:Sn,texPrimary:ur,texSecondary:void 0,writingMode:Ke.writingMode,glyphOffset:kr,sectionIndex:pn.sectionIndex,isSDF:cn,pixelOffsetTL:kn,pixelOffsetBR:Dn,minFontScaleX:0,minFontScaleY:0})}}return bn})(0,h,M,x,b,j,g,u.allowVerticalPlacement),we=u.textSizeData;let Pe=null;we.kind==="source"?(Pe=[zp*x.layout.get("text-size").evaluate(j,{},ue)*te.textScaleFactor],Pe[0]>Dy&&ai(`${u.layerIds[0]}: Value for "text-size" is >= ${Hw}. Reduce your "text-size".`)):we.kind==="composite"&&(Pe=[zp*te.compositeTextSizes[0].evaluate(j,{},ue)*te.textScaleFactor,zp*te.compositeTextSizes[1].evaluate(j,{},ue)*te.textScaleFactor],(Pe[0]>Dy||Pe[1]>Dy)&&ai(`${u.layerIds[0]}: Value for "text-size" is >= ${Hw}. Reduce your "text-size".`)),u.addSymbols(u.text,Se,Pe,M,b,j,L,i,l,R.lineStartIndex,R.lineLength,ee,le,ue,ge,!1);for(const tt of U)q[tt]=u.text.placedSymbolArray.length-1;return 4*Se.length}function FN(u){for(const i in u)return u[i];return null}function A2(u,i,l,h,g,x,b,j,M,R){let L=b.top,U=b.bottom,q=b.left,ee=b.right;if(kB(b)&&b.collisionPadding){const te=b.collisionPadding;q-=te[0],L-=te[1],ee+=te[2],U+=te[3]}if(M){const te=new Rt(q,L),le=new Rt(ee,L),ue=new Rt(q,U),ge=new Rt(ee,U),Se=Dr(M);let we=new Rt(0,0);R&&(we=new Rt(R[0],R[1])),te._rotateAround(Se,we),le._rotateAround(Se,we),ue._rotateAround(Se,we),ge._rotateAround(Se,we),q=Math.min(te.x,le.x,ue.x,ge.x),ee=Math.max(te.x,le.x,ue.x,ge.x),L=Math.min(te.y,le.y,ue.y,ge.y),U=Math.max(te.y,le.y,ue.y,ge.y)}return u.emplaceBack(i.x,i.y,i.z,l.x,l.y,q,L,ee,U,j,h,g,x),u.length-1}function BN(u){kB(u)&&u.collisionPadding&&(u.top-=u.collisionPadding[1],u.bottom+=u.collisionPadding[3]);const i=u.bottom-u.top;return i>0?Math.max(10,i):null}function Sse(u,i,l,h){const g=u.compareText;if(i in g){const x=g[i];for(let b=x.length-1;b>=0;b--)if(h.dist(x[b])<l)return!0}else g[i]=[];return g[i].push(h),!1}function s4(u,i){const l=u.fovAboveCenter,h=u.elevation?u.elevation.getMinElevationBelowMSL()*i:0,g=(u._camera.position[2]*u.worldSize-h)/Math.cos(u._pitch),x=Math.sin(l)*g/Math.sin(Math.max(Math.PI/2-u._pitch-l,.01));let b=Math.sin(u._pitch)*x+g;const j=g*(1/u._horizonShift);if(!u.elevation||u.elevation.exaggeration()===0){let M=Math.max(u.zoom-17,0);u.isOrthographic&&(M/=10),b*=1+M}return Math.min(1.01*b,j)}function Gw(u,i){if(!i.isReprojectedInTileSpace)return{scale:1<<u.z,x:u.x,y:u.y,x2:u.x+1,y2:u.y+1,projection:i};const l=Math.pow(2,-u.z),h=u.x*l,g=(u.x+1)*l,x=u.y*l,b=(u.y+1)*l,j=be(h),M=be(g),R=Ne(x),L=Ne(b),U=i.project(j,R),q=i.project(M,R),ee=i.project(M,L),te=i.project(j,L);let le=Math.min(U.x,q.x,ee.x,te.x),ue=Math.min(U.y,q.y,ee.y,te.y),ge=Math.max(U.x,q.x,ee.x,te.x),Se=Math.max(U.y,q.y,ee.y,te.y);const we=l/16;function Pe(Ke,Qe,dt,ft,Ft,xt){const Wt=(dt+Ft)/2,bn=(ft+xt)/2,tn=i.project(be(Wt),Ne(bn)),dn=Math.max(0,le-tn.x,ue-tn.y,tn.x-ge,tn.y-Se);le=Math.min(le,tn.x),ge=Math.max(ge,tn.x),ue=Math.min(ue,tn.y),Se=Math.max(Se,tn.y),dn>we&&(Pe(Ke,tn,dt,ft,Wt,bn),Pe(tn,Qe,Wt,bn,Ft,xt))}Pe(U,q,h,x,g,x),Pe(q,ee,g,x,g,b),Pe(ee,te,g,b,h,b),Pe(te,U,h,b,h,x),le-=we,ue-=we,ge+=we,Se+=we;const tt=1/Math.max(ge-le,Se-ue);return{scale:tt,x:le*tt,y:ue*tt,x2:ge*tt,y2:Se*tt,projection:i}}function a4(u,{x:i,y:l},h=0){return new Rt(((i-h)*u.scale-u.x)*mn,(l*u.scale-u.y)*mn)}const Tse=B(new Float32Array(16));class ky{constructor(i){this.spec=i,this.name=i.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(i,l){return{x:0,y:0,z:0}}unproject(i,l){return new G(0,0)}projectTilePoint(i,l,h){return{x:i,y:l,z:0}}locationPoint(i,l,h,g=!0){return i._coordinatePoint(i.locationCoordinate(l,h),g)}pixelsPerMeter(i,l){return me(1,i)*l}pixelSpaceConversion(i,l,h){return 1}farthestPixelDistance(i){return s4(i,i.pixelsPerMeter)}pointCoordinate(i,l,h,g){const x=i.horizonLineFromTop(!1),b=new Rt(l,Math.max(x,h));return i.rayIntersectionCoordinate(i.pointRayIntersection(b,g))}pointCoordinate3D(i,l,h){const g=new Rt(l,h);if(i.elevation)return i.elevation.pointCoordinate(g);{const x=this.pointCoordinate(i,g.x,g.y,0);return[x.x,x.y,x.z]}}isPointAboveHorizon(i,l){if(i.elevation&&i.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(i,l.x,l.y);const h=i.horizonLineFromTop();return l.y<h}createInversionMatrix(i,l){return Tse}createTileMatrix(i,l,h){let g,x,b;const j=h.canonical,M=B(new Float64Array(16));if(this.isReprojectedInTileSpace){const R=Gw(j,this);g=1,x=R.x+h.wrap*R.scale,b=R.y,X(M,M,[g/R.scale,g/R.scale,i.pixelsPerMeter/l])}else g=l/i.zoomScale(j.z),x=(j.x+Math.pow(2,j.z)*h.wrap)*g,b=j.y*g;return Y(M,M,[x,b,0]),X(M,M,[g/mn,g/mn,1]),M}upVector(i,l,h){return[0,0,1]}upVectorScale(i,l,h){return{metersToTile:1}}}class Ase extends ky{constructor(i){super(i),this.range=[4,7],this.center=i.center||[-96,37.5];const[l,h]=this.parallels=i.parallels||[29.5,45.5],g=Math.sin(Dr(l));this.n=(g+Math.sin(Dr(h)))/2,this.c=1+g*(2*this.n-g),this.r0=Math.sqrt(this.c)/this.n}project(i,l){const{n:h,c:g,r0:x}=this,b=Dr(i-this.center[0]),j=Dr(l),M=Math.sqrt(g-2*h*Math.sin(j))/h;return{x:M*Math.sin(b*h),y:M*Math.cos(b*h)-x,z:0}}unproject(i,l){const{n:h,c:g,r0:x}=this,b=x+l;let j=Math.atan2(i,Math.abs(b))*Math.sign(b);b*h<0&&(j-=Math.PI*Math.sign(i)*Math.sign(b));const M=Dr(this.center[0])*h;j=Et(j,-Math.PI-M,Math.PI-M);const R=Oe(gt(j/h)+this.center[0],-180,180),L=Math.asin(Oe((g-(i*i+b*b)*h*h)/(2*h),-1,1)),U=Oe(gt(L),-Be,Be);return new G(R,U)}}const Ww=1.340264,Xw=-.081106,Zw=893e-6,Yw=.003796,j2=Math.sqrt(3)/2;class jse extends ky{project(i,l){l=l/180*Math.PI,i=i/180*Math.PI;const h=Math.asin(j2*Math.sin(l)),g=h*h,x=g*g*g;return{x:.5*(i*Math.cos(h)/(j2*(Ww+3*Xw*g+x*(7*Zw+9*Yw*g)))/Math.PI+.5),y:1-.5*(h*(Ww+Xw*g+x*(Zw+Yw*g))/Math.PI+1),z:0}}unproject(i,l){i=(2*i-.5)*Math.PI;let h=l=(2*(1-l)-1)*Math.PI,g=h*h,x=g*g*g;for(let L,U,q,ee=0;ee<12&&(U=h*(Ww+Xw*g+x*(Zw+Yw*g))-l,q=Ww+3*Xw*g+x*(7*Zw+9*Yw*g),L=U/q,h=Oe(h-L,-Math.PI/3,Math.PI/3),g=h*h,x=g*g*g,!(Math.abs(L)<1e-12));++ee);const b=j2*i*(Ww+3*Xw*g+x*(7*Zw+9*Yw*g))/Math.cos(h),j=Math.asin(Math.sin(h)/j2),M=Oe(180*b/Math.PI,-180,180),R=Oe(180*j/Math.PI,-Be,Be);return new G(M,R)}}class Ese extends ky{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0}project(i,l){return{x:.5+i/360,y:.5-l/360,z:0}}unproject(i,l){const h=360*(i-.5),g=Oe(360*(.5-l),-Be,Be);return new G(h,g)}}const a0=Math.PI/2;function E2(u){return Math.tan((a0+u)/2)}class Cse extends ky{constructor(i){super(i),this.center=i.center||[0,30];const[l,h]=this.parallels=i.parallels||[30,30];let g=Dr(l),x=Dr(h);this.southernCenter=g+x<0,this.southernCenter&&(g=-g,x=-x);const b=Math.cos(g),j=E2(g);this.n=g===x?Math.sin(g):Math.log(b/Math.cos(x))/Math.log(E2(x)/j),this.f=b*Math.pow(E2(g),this.n)/this.n}project(i,l){l=Dr(l),this.southernCenter&&(l=-l),i=Dr(i-this.center[0]);const h=1e-6,{n:g,f:x}=this;x>0?l<-a0+h&&(l=-a0+h):l>a0-h&&(l=a0-h);const b=x/Math.pow(E2(l),g);let j=b*Math.sin(g*i),M=x-b*Math.cos(g*i);return j=.5*(j/Math.PI+.5),M=.5*(M/Math.PI+.5),{x:j,y:this.southernCenter?M:1-M,z:0}}unproject(i,l){i=(2*i-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;const{n:h,f:g}=this,x=g-l,b=Math.sign(x),j=Math.sign(h)*Math.sqrt(i*i+x*x);let M=Math.atan2(i,Math.abs(x))*b;x*h<0&&(M-=Math.PI*Math.sign(i)*b);const R=Oe(gt(M/h)+this.center[0],-180,180),L=Oe(gt(2*Math.atan(Math.pow(g/j,1/h))-a0),-Be,Be);return new G(R,this.southernCenter?-L:L)}}class o4 extends ky{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(i,l){return{x:ce(i),y:pe(l),z:0}}unproject(i,l){const h=be(i),g=Ne(l);return new G(h,g)}}const l4=Dr(Be);class Nse extends ky{project(i,l){const h=(l=Dr(l))*l,g=h*h;return{x:.5*((i=Dr(i))*(.8707-.131979*h+g*(g*(.003971*h-.001529*g)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+h*(.015085+g*(.028874*h-.044475-.005916*g)))/Math.PI+1),z:0}}unproject(i,l){i=(2*i-.5)*Math.PI;let h=l=(2*(1-l)-1)*Math.PI,g=25,x=0,b=h*h;do{b=h*h;const R=b*b;x=(h*(1.007226+b*(.015085+R*(.028874*b-.044475-.005916*R)))-l)/(1.007226+b*(.045255+R*(.259866*b-.311325-.005916*11*R))),h=Oe(h-x,-l4,l4)}while(Math.abs(x)>1e-6&&--g>0);b=h*h;const j=Oe(gt(i/(.8707+b*(b*(b*b*b*(.003971-.001529*b)-.013791)-.131979))),-180,180),M=gt(h);return new G(j,M)}}const c4=Dr(Be);class Pse extends ky{project(i,l){l=Dr(l),i=Dr(i);const h=Math.cos(l),g=2/Math.PI,x=Math.acos(h*Math.cos(i/2)),b=Math.sin(x)/x,j=.5*(i*g+2*h*Math.sin(i/2)/b)||0,M=.5*(l+Math.sin(l)/b)||0;return{x:.5*(j/Math.PI+.5),y:1-.5*(M/Math.PI+1),z:0}}unproject(i,l){let h=i=(2*i-.5)*Math.PI,g=l=(2*(1-l)-1)*Math.PI,x=25;const b=1e-6;let j=0,M=0;do{const R=Math.cos(g),L=Math.sin(g),U=2*L*R,q=L*L,ee=R*R,te=Math.cos(h/2),le=Math.sin(h/2),ue=2*te*le,ge=le*le,Se=1-ee*te*te,we=Se?1/Se:0,Pe=Se?Math.acos(R*te)*Math.sqrt(1/Se):0,tt=.5*(2*Pe*R*le+2*h/Math.PI)-i,Ke=.5*(Pe*L+g)-l,Qe=.5*we*(ee*ge+Pe*R*te*q)+1/Math.PI,dt=we*(ue*U/4-Pe*L*le),ft=.125*we*(U*le-Pe*L*ee*ue),Ft=.5*we*(q*te+Pe*ge*R)+.5,xt=dt*ft-Ft*Qe;j=(Ke*dt-tt*Ft)/xt,M=(tt*ft-Ke*Qe)/xt,h=Oe(h-j,-Math.PI,Math.PI),g=Oe(g-M,-c4,c4)}while((Math.abs(j)>b||Math.abs(M)>b)&&--x>0);return new G(gt(h),gt(g))}}class u4 extends ky{constructor(i){super(i),this.center=i.center||[0,0],this.parallels=i.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Dr(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(i,l){const{scale:h,cosPhi:g}=this;return{x:Dr(i)*g*h+.5,y:-Math.sin(Dr(l))/g*h+.5,z:0}}unproject(i,l){const{scale:h,cosPhi:g}=this,x=-(l-.5)/h,b=Oe(gt((i-.5)/h)/g,-180,180),j=Math.asin(Oe(x*g,-1,1)),M=Oe(gt(j),-Be,Be);return new G(b,M)}}class Mse extends o4{constructor(i){super(i),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(i,l,h){const g=Np(i,l,h);return Cn(g,g,tg(Xu(h))),{x:g[0],y:g[1],z:g[2]}}locationPoint(i,l,h){const g=O(l.lat,l.lng),x=Ot([],g),b=h?i._centerAltitude+h:i.elevation?i.elevation.getAtPointOrZero(i.locationCoordinate(l),i._centerAltitude):i._centerAltitude;We(g,g,x,me(1,0)*mn*b);const j=B(new Float64Array(16));return K(j,i.pixelMatrix,i.globeMatrix),Cn(g,g,j),new Rt(g[0],g[1])}pixelsPerMeter(i,l){return me(1,0)*l}pixelSpaceConversion(i,l,h){const g=me(1,i)*l,x=yr(me(1,45)*l,g,h);return this.pixelsPerMeter(i,l)/x}createTileMatrix(i,l,h){const g=ix(Xu(h.canonical));return K(new Float64Array(16),i.globeMatrix,g)}createInversionMatrix(i,l){const{center:h}=i,g=tg(Xu(l));return Z(g,g,Dr(h.lng)),ae(g,g,Dr(h.lat)),X(g,g,[i._pixelsPerMercatorPixel,i._pixelsPerMercatorPixel,1]),Float32Array.from(g)}pointCoordinate(i,l,h,g){return iw(i,l,h,!0)||new Ge(0,0)}pointCoordinate3D(i,l,h){const g=this.pointCoordinate(i,l,h,0);return[g.x,g.y,g.z]}isPointAboveHorizon(i,l){return!iw(i,l.x,l.y,!1)}farthestPixelDistance(i){const l=(function(g,x){const b=g.cameraToCenterDistance,j=g._centerAltitude*x,M=g._camera,R=g._camera.forward(),L=Ee([],pt([],R,-b),[0,0,j]),U=g.worldSize/(2*Math.PI),q=[0,0,-U],ee=g.width/g.height,te=Math.tan(g.fovAboveCenter),le=pt([],M.up(),te),ue=pt([],M.right(),te*ee),ge=Ot([],Ee([],Ee([],R,le),ue)),Se=[];let we;if(new mi(L,ge).closestPointOnSphere(q,U,Se)){const Pe=Ee([],Se,q),tt=Rr([],Pe,L);we=Math.cos(g.fovAboveCenter)*nt(tt)}else{const Pe=Rr([],L,q),tt=Rr([],q,L);Ot(tt,tt);const Ke=nt(Pe)-U;we=Math.sqrt(Ke*(Ke+2*U));const Qe=Math.acos(we/(U+Ke))-Math.acos(Mt(R,tt));we*=Math.cos(Qe)}return 1.01*we})(i,this.pixelsPerMeter(i.center.lat,i.worldSize)),h=Pp(i.zoom);if(h>0){const g=s4(i,me(1,i.center.lat)*i.worldSize),x=i.worldSize/(2*Math.PI),b=Math.max(i.width,i.height)/i.worldSize*Math.PI;return yr(l,g+x*(1-Math.cos(b)),Math.pow(h,10))}return l}upVector(i,l,h){return Np(l,h,i,1)}upVectorScale(i){return{metersToTile:rx(yf(Xu(i)))}}}function d4(u){const i=u.parallels,l=!!i&&Math.abs(i[0]+i[1])<.01;switch(u.name){case"mercator":return new o4(u);case"equirectangular":return new Ese(u);case"naturalEarth":return new Nse(u);case"equalEarth":return new jse(u);case"winkelTripel":return new Pse(u);case"albers":return l?new u4(u):new Ase(u);case"lambertConformalConic":return l?new u4(u):new Cse(u);case"globe":return new Mse(u)}throw new Error(`Invalid projection name: ${u.name}`)}const Rse=At.types,Ose=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function C2(u,i,l,h,g,x,b,j,M,R,L,U,q){const ee=j?Math.min(Dy,Math.round(j[0])):0,te=j?Math.min(Dy,Math.round(j[1])):0;u.emplaceBack(i,l,Math.round(32*h),Math.round(32*g),x,b,(ee<<1)+(M?1:0),te,16*R,16*L,256*U,256*q)}function N2(u,i,l){u.emplaceBack(i,l)}function P2(u,i,l,h,g,x,b){u.emplaceBack(i,l,h,g,x,b)}const M2=(u,i,l,h)=>{for(let g=0;g<i;g++)u.emplaceBack(l[0],l[1],l[2],h[0],h[1],h[2])};function R2(u,i,l,h,g){u.emplaceBack(i,l,h,g),u.emplaceBack(i,l,h,g),u.emplaceBack(i,l,h,g),u.emplaceBack(i,l,h,g)}function Dse(u){for(const i of u.sections)if(__(i.text))return!0;return!1}class UN{constructor(i){this.layoutVertexArray=new $m,this.indexArray=new ki,this.programConfigurations=i,this.segments=new Hs,this.dynamicLayoutVertexArray=new Nd,this.opacityVertexArray=new nc,this.placedSymbolArray=new fo,this.iconTransitioningVertexArray=new Vo,this.globeExtVertexArray=new fu,this.zOffsetVertexArray=new bh,this.orientationVertexArray=new Gm}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(i,l,h,g,x){this.isEmpty()||(h&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Fie.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,Uie.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,Ose,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=i.createVertexBuffer(this.iconTransitioningVertexArray,qie.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,Bie.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||x)&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,Vie.members,!0)),!this.orientationVertexBuffer&&this.orientationVertexArray&&this.orientationVertexArray.length>0&&(this.orientationVertexBuffer=i.createVertexBuffer(this.orientationVertexArray,$ie.members,!0)),this.opacityVertexBuffer.itemSize=1),(h||g)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.orientationVertexBuffer&&this.orientationVertexBuffer.destroy())}}Hn(UN,"SymbolBuffers");class VN{constructor(i,l,h){this.layoutVertexArray=new i,this.layoutAttributes=l,this.indexArray=new h,this.segments=new Hs,this.collisionVertexArray=new rc,this.collisionVertexArrayExt=new Nd}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,Hie.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,Gie.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Hn(VN,"CollisionBuffers");class O2{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.lut=i.lut,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map((b=>b.fqid)),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=B([]),this.placementViewportMatrix=B([]);const l=this.layers[0]._unevaluatedLayout._values;this.worldview=i.worldview,this.textSizeData=BB(this.zoom,l["text-size"],this.worldview),this.iconSizeData=BB(this.zoom,l["icon-size"],this.worldview);const h=this.layers[0].layout,g=h.get("symbol-sort-key"),x=h.get("symbol-z-order");this.canOverlap=h.get("text-allow-overlap")||h.get("icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&g.constantOr(1)!==void 0,this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=h.get("text-writing-mode").map((b=>yu[b])),this.stateDependentLayerIds=this.layers.filter((b=>b.isStateDependent())).map((b=>b.id)),this.sourceID=i.sourceID,this.projection=i.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.hasAnySecondaryIcon=!1}createArrays(){this.text=new UN(new Ul(this.layers,{zoom:this.zoom,lut:this.lut},(i=>i.startsWith("text")||i.startsWith("symbol")))),this.icon=new UN(new Ul(this.layers,{zoom:this.zoom,lut:this.lut},(i=>i.startsWith("icon")||i.startsWith("symbol")))),this.glyphOffsetArray=new my,this.lineVertexArray=new Xv,this.symbolInstances=new Wv}calculateGlyphDependencies(i,l,h,g,x){for(const b of i){const j=b.codePointAt(0);if(j===void 0)break;if(l[j]=!0,g&&x&&j<=65535){const M=Bw[b];M&&(l[M.charCodeAt(0)]=!0)}}}updateFootprints(i,l){}updateReplacement(i,l){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;const h=l.getReplacementRegionsForTile(i.toUnwrapped(),!0);return!H_(this.activeReplacements,h)&&(this.activeReplacements=h,!0)}populate(i,l,h,g){const x=this.layers[0],b=x.layout,j=this.projection.name==="globe",M=b.get("text-font"),R=b.get("text-field"),L=b.get("icon-image"),[U,q]=b.get("icon-size-scale-range"),ee=Oe(l.scaleFactor||1,U,q),te=(R.value.kind!=="constant"||R.value.value instanceof Bo&&!R.value.value.isEmpty()||R.value.value.toString().length>0)&&(M.value.kind!=="constant"||M.value.value.length>0),le=L.value.kind!=="constant"||!!L.value.value||Object.keys(L.parameters).length>0,ue=b.get("symbol-sort-key");if(this.features=[],!te&&!le)return;const ge=l.iconDependencies,Se=l.glyphDependencies,we=l.availableImages,Pe=new hs(this.zoom,{worldview:this.worldview});for(const{feature:tt,id:Ke,index:Qe,sourceLayerIndex:dt}of i){const ft=x._featureFilter.needGeometry,Ft=Dt(tt,ft);if(!x._featureFilter.filter(Pe,Ft,h))continue;if(ft||(Ft.geometry=at(tt,h,g)),j&&tt.type!==1&&h.z<=5){const dn=Ft.geometry,xn=.98078528056,Lt=(hn,Tt)=>Mt(Np(hn.x,hn.y,h,1),Np(Tt.x,Tt.y,h,1))<xn;for(let hn=0;hn<dn.length;hn++)dn[hn]=Ct(dn[hn],Lt)}let xt,Wt;if(te){const dn=x.getValueAndResolveTokens("text-field",Ft,h,we),xn=Bo.factory(dn);Dse(xn)&&(this.hasRTLText=!0),(!this.hasRTLText||Bv()==="unavailable"||this.hasRTLText&&du.isParsed())&&(xt=Xie(xn,x,Ft))}if(le){const dn=x.getValueAndResolveTokens("icon-image",Ft,h,we);Wt=typeof dn=="string"?uo.build(dn):dn}if(!xt&&!Wt)continue;const bn=this.sortFeaturesByKey?ue.evaluate(Ft,{},h):void 0,tn={id:Ke,text:xt,icon:Wt,index:Qe,sourceLayerIndex:dt,geometry:Ft.geometry,properties:tt.properties,type:Rse[tt.type],sortKey:bn};if(this.features.push(tn),Wt){const dn=this.layers[0]._unevaluatedLayout._values,{iconPrimary:xn,iconSecondary:Lt}=t4(Wt,this.iconSizeData,dn["icon-size"],h,this.zoom,tn,this.pixelRatio,ee,this.worldview),hn=xn.id.toString();if(ge.has(hn)?ge.get(hn).push(xn):ge.set(hn,[xn]),Lt){this.hasAnySecondaryIcon=!0;const Tt=Lt.id.toString();ge.has(Tt)?ge.get(Tt).push(Lt):ge.set(Tt,[Lt])}}if(xt){const dn=M.evaluate(Ft,{},h).join(","),xn=b.get("text-rotation-alignment")==="map"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(yu.vertical)>=0;for(const Lt of xt.sections)if(Lt.image){const hn=Lt.image.getPrimary().scaleSelf(this.pixelRatio),Tt=hn.id.toString(),zt=ge.get(Tt)||[];zt.push(hn),ge.set(Tt,zt)}else{const hn=Om(xt.toString()),Tt=Lt.fontStack||dn,zt=Se[Tt]=Se[Tt]||{};this.calculateGlyphDependencies(Lt.text,zt,xn,this.allowVerticalPlacement,hn)}}}if(b.get("symbol-placement")==="line"&&(this.features=(function(tt){const Ke={},Qe={},dt=[];let ft=0;function Ft(tn){dt.push(tt[tn]),ft++}function xt(tn,dn,xn){const Lt=Qe[tn];return delete Qe[tn],Qe[dn]=Lt,dt[Lt].geometry[0].pop(),dt[Lt].geometry[0]=dt[Lt].geometry[0].concat(xn[0]),Lt}function Wt(tn,dn,xn){const Lt=Ke[dn];return delete Ke[dn],Ke[tn]=Lt,dt[Lt].geometry[0].shift(),dt[Lt].geometry[0]=xn[0].concat(dt[Lt].geometry[0]),Lt}function bn(tn,dn,xn){const Lt=xn?dn[0][dn[0].length-1]:dn[0][0];return`${tn}:${Lt.x}:${Lt.y}`}for(let tn=0;tn<tt.length;tn++){const dn=tt[tn],xn=dn.geometry,Lt=dn.text?dn.text.toString():null;if(!Lt){Ft(tn);continue}const hn=bn(Lt,xn),Tt=bn(Lt,xn,!0);if(hn in Qe&&Tt in Ke&&Qe[hn]!==Ke[Tt]){const zt=Wt(hn,Tt,xn),wn=xt(hn,Tt,dt[zt].geometry);delete Ke[hn],delete Qe[Tt],Qe[bn(Lt,dt[wn].geometry,!0)]=wn,dt[zt].geometry=null}else hn in Qe?xt(hn,Tt,xn):Tt in Ke?Wt(hn,Tt,xn):(Ft(tn),Ke[hn]=ft-1,Qe[Tt]=ft-1)}return dt.filter((tn=>tn.geometry))})(this.features)),b.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",l.elevationFeatures){!this.elevationFeatures&&l.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const tt of l.elevationFeatures)this.elevationFeatureIdToIndex.set(tt.id,this.elevationFeatures.length),this.elevationFeatures.push(tt)}}else b.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort(((tt,Ke)=>tt.sortKey-Ke.sortKey))}update(i,l,h,g,x,b,j){this.text.programConfigurations.updatePaintArrays(i,l,x,h,g,b,j,this.worldview),this.icon.programConfigurations.updatePaintArrays(i,l,x,h,g,b,j,this.worldview)}updateRoadElevation(i){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let l=!1;const h=qe(i),g=1/h;let x=!1,b=!1;for(let j=0;j<this.symbolInstances.length;j++){const M=this.symbolInstances.get(j),R=Me(1,0,0),L=Me(0,1,0),{numHorizontalGlyphVertices:U,numVerticalGlyphVertices:q,numIconVertices:ee,numVerticalIconVertices:te}=M,le=U>0||q>0,ue=ee>0,ge=this.elevationFeatures[M.elevationFeatureIndex];if(ge){const Se=new Rt(M.tileAnchorX,M.tileAnchorY),we=.075+ge.pointElevation(Se);M.zOffset!==we&&(l=!0,M.zOffset=we);const Pe=ge.computeSlopeNormal(Se,g),tt=Fe(rn(),Me(0,0,1),Pe);sn(R,R,tt),sn(L,L,tt),R[2]*=h,L[2]*=h,R[0]===1&&R[1]===0&&R[2]===0&&L[0]===0&&L[1]===1&&L[2]===0||(x=x||le,b=b||ue)}if(le&&(M2(this.text.orientationVertexArray,U,R,L),M2(this.text.orientationVertexArray,q,R,L)),ue){const{placedIconSymbolIndex:Se,verticalPlacedIconSymbolIndex:we}=M;Se>=0&&M2(this.icon.orientationVertexArray,ee,R,L),we>=0&&M2(this.icon.orientationVertexArray,te,R,L)}}x||(this.text.orientationVertexArray=void 0),b||(this.icon.orientationVertexArray=void 0),l&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const i=(x,b,j)=>{h+=b,h>x.length&&x.resize(h);for(let M=-b;M<0;M++)x.emplace(M+h,j)},l=(x,b,j)=>{g+=b,g>x.length&&x.resize(g);for(let M=-b;M<0;M++)x.emplace(M+g,j)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let h=0,g=0;for(let x=0;x<this.symbolInstances.length;x++){const b=this.symbolInstances.get(x),{numHorizontalGlyphVertices:j,numVerticalGlyphVertices:M,numIconVertices:R}=b,L=b.zOffset,U=R>0;if((j>0||M>0)&&(i(this.text.zOffsetVertexArray,j,L),i(this.text.zOffsetVertexArray,M,L)),U){const{placedIconSymbolIndex:q,verticalPlacedIconSymbolIndex:ee}=b;q>=0&&l(this.icon.zOffsetVertexArray,R,L),ee>=0&&l(this.icon.zOffsetVertexArray,b.numVerticalIconVertices,L)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=d4(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,l){const h=this.lineVertexArray.length;if(i.segment!==void 0)for(const{x:g,y:x}of l)this.lineVertexArray.emplaceBack(g,x);return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(i,l,h,g,x,b,j,M,R,L,U,q,ee,te,le,ue){const ge=i.indexArray,Se=i.layoutVertexArray,we=i.globeExtVertexArray,Pe=i.segments.prepareSegment(4*l.length,Se,ge,this.canOverlap?b.sortKey:void 0),tt=this.glyphOffsetArray.length,Ke=Pe.vertexLength,Qe=this.allowVerticalPlacement&&j===yu.vertical?Math.PI/2:0,dt=b.text&&b.text.sections;for(let Ft=0;Ft<l.length;Ft++){const{tl:xt,tr:Wt,bl:bn,br:tn,texPrimary:dn,texSecondary:xn,pixelOffsetTL:Lt,pixelOffsetBR:hn,minFontScaleX:Tt,minFontScaleY:zt,glyphOffset:wn,isSDF:pn,sectionIndex:ur}=l[Ft],Jn=Pe.vertexLength,cn=wn[1];if(C2(Se,R.x,R.y,xt.x,cn+xt.y,dn.x,dn.y,h,pn,Lt.x,Lt.y,Tt,zt),C2(Se,R.x,R.y,Wt.x,cn+Wt.y,dn.x+dn.w,dn.y,h,pn,hn.x,Lt.y,Tt,zt),C2(Se,R.x,R.y,bn.x,cn+bn.y,dn.x,dn.y+dn.h,h,pn,Lt.x,hn.y,Tt,zt),C2(Se,R.x,R.y,tn.x,cn+tn.y,dn.x+dn.w,dn.y+dn.h,h,pn,hn.x,hn.y,Tt,zt),M){const{x:yn,y:er,z:Bn}=M.anchor,[En,$n,Cr]=M.up;P2(we,yn,er,Bn,En,$n,Cr),P2(we,yn,er,Bn,En,$n,Cr),P2(we,yn,er,Bn,En,$n,Cr),P2(we,yn,er,Bn,En,$n,Cr),R2(i.dynamicLayoutVertexArray,yn,er,Bn,Qe)}else R2(i.dynamicLayoutVertexArray,R.x,R.y,R.z,Qe);if(ue){const yn=xn||dn;N2(i.iconTransitioningVertexArray,yn.x,yn.y),N2(i.iconTransitioningVertexArray,yn.x+yn.w,yn.y),N2(i.iconTransitioningVertexArray,yn.x,yn.y+yn.h),N2(i.iconTransitioningVertexArray,yn.x+yn.w,yn.y+yn.h)}ge.emplaceBack(Jn,Jn+1,Jn+2),ge.emplaceBack(Jn+1,Jn+2,Jn+3),Pe.vertexLength+=4,Pe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(wn[0]),Ft!==l.length-1&&ur===l[Ft+1].sectionIndex||i.programConfigurations.populatePaintArrays(Se.length,b,b.index,{},ee,te,le,dt&&dt[ur],this.worldview)}const ft=M?M.anchor:R;i.placedSymbolArray.emplaceBack(ft.x,ft.y,ft.z,R.x,R.y,tt,this.glyphOffsetArray.length-tt,Ke,L,U,R.segment,h?h[0]:0,h?h[1]:0,g[0],g[1],j,0,0,0,q,0)}_commitLayoutVertex(i,l,h,g,x,b,j){i.emplaceBack(l,h,g,x,b,Math.round(j.x),Math.round(j.y))}_addCollisionDebugVertices(i,l,h,g,x,b,j){const M=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),R=M.vertexLength,L=j.tileAnchorX,U=j.tileAnchorY;for(let ee=0;ee<4;ee++)h.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(h.collisionVertexArrayExt,l,i.padding,j.zOffset),this._commitLayoutVertex(h.layoutVertexArray,g,x,b,L,U,new Rt(i.x1,i.y1)),this._commitLayoutVertex(h.layoutVertexArray,g,x,b,L,U,new Rt(i.x2,i.y1)),this._commitLayoutVertex(h.layoutVertexArray,g,x,b,L,U,new Rt(i.x2,i.y2)),this._commitLayoutVertex(h.layoutVertexArray,g,x,b,L,U,new Rt(i.x1,i.y2)),M.vertexLength+=4;const q=h.indexArray;q.emplaceBack(R,R+1),q.emplaceBack(R+1,R+2),q.emplaceBack(R+2,R+3),q.emplaceBack(R+3,R),M.primitiveLength+=4}_addTextDebugCollisionBoxes(i,l,h,g,x,b){for(let j=g;j<x;j++){const M=h.get(j),R=this.getSymbolInstanceTextSize(i,b,l,j);this._addCollisionDebugVertices(M,R,this.textCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,b)}}_addIconDebugCollisionBoxes(i,l,h,g,x,b){for(let j=g;j<x;j++){const M=h.get(j),R=this.getSymbolInstanceIconSize(i,l,b.placedIconSymbolIndex);this._addCollisionDebugVertices(M,R,this.iconCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,b)}}generateCollisionDebugBuffers(i,l,h){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new VN(qm,AB.members,Vo),this.iconCollisionBox=new VN(qm,AB.members,Vo);const g=Vw(this.iconSizeData,i),x=Vw(this.textSizeData,i,h);for(let b=0;b<this.symbolInstances.length;b++){const j=this.symbolInstances.get(b);this._addTextDebugCollisionBoxes(x,i,l,j.textBoxStartIndex,j.textBoxEndIndex,j),this._addTextDebugCollisionBoxes(x,i,l,j.verticalTextBoxStartIndex,j.verticalTextBoxEndIndex,j),this._addIconDebugCollisionBoxes(g,i,l,j.iconBoxStartIndex,j.iconBoxEndIndex,j),this._addIconDebugCollisionBoxes(g,i,l,j.verticalIconBoxStartIndex,j.verticalIconBoxEndIndex,j)}}getSymbolInstanceTextSize(i,l,h,g){const x=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:g),b=DN(this.textSizeData,i,x)/Qo;return this.tilePixelRatio*b}getSymbolInstanceIconSize(i,l,h){const g=this.icon.placedSymbolArray.get(h),x=DN(this.iconSizeData,i,g);return this.tilePixelRatio*x}_commitDebugCollisionVertexUpdate(i,l,h,g){i.emplaceBack(l,-h,-h,g),i.emplaceBack(l,h,-h,g),i.emplaceBack(l,h,h,g),i.emplaceBack(l,-h,h,g)}_updateTextDebugCollisionBoxes(i,l,h,g,x,b,j){for(let M=g;M<x;M++){const R=h.get(M),L=this.getSymbolInstanceTextSize(i,b,l,M);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,L,R.padding,b.zOffset)}}_updateIconDebugCollisionBoxes(i,l,h,g,x,b,j){for(let M=g;M<x;M++){const R=h.get(M),L=this.getSymbolInstanceIconSize(i,l,b.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,L,R.padding,b.zOffset)}}updateCollisionDebugBuffers(i,l,h,g){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const x=Vw(this.iconSizeData,i,g),b=Vw(this.textSizeData,i,h);for(let j=0;j<this.symbolInstances.length;j++){const M=this.symbolInstances.get(j);this._updateTextDebugCollisionBoxes(b,i,l,M.textBoxStartIndex,M.textBoxEndIndex,M,h),this._updateTextDebugCollisionBoxes(b,i,l,M.verticalTextBoxStartIndex,M.verticalTextBoxEndIndex,M,h),this._updateIconDebugCollisionBoxes(x,i,l,M.iconBoxStartIndex,M.iconBoxEndIndex,M,g),this._updateIconDebugCollisionBoxes(x,i,l,M.verticalIconBoxStartIndex,M.verticalIconBoxEndIndex,M,g)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,l,h,g,x,b,j,M,R){const L={};if(l<h){const{x1:U,y1:q,x2:ee,y2:te,padding:le,projectedAnchorX:ue,projectedAnchorY:ge,projectedAnchorZ:Se,tileAnchorX:we,tileAnchorY:Pe,featureIndex:tt}=i.get(l);L.textBox={x1:U,y1:q,x2:ee,y2:te,padding:le,projectedAnchorX:ue,projectedAnchorY:ge,projectedAnchorZ:Se,tileAnchorX:we,tileAnchorY:Pe},L.textFeatureIndex=tt}if(g<x){const{x1:U,y1:q,x2:ee,y2:te,padding:le,projectedAnchorX:ue,projectedAnchorY:ge,projectedAnchorZ:Se,tileAnchorX:we,tileAnchorY:Pe,featureIndex:tt}=i.get(g);L.verticalTextBox={x1:U,y1:q,x2:ee,y2:te,padding:le,projectedAnchorX:ue,projectedAnchorY:ge,projectedAnchorZ:Se,tileAnchorX:we,tileAnchorY:Pe},L.verticalTextFeatureIndex=tt}if(b<j){const{x1:U,y1:q,x2:ee,y2:te,padding:le,projectedAnchorX:ue,projectedAnchorY:ge,projectedAnchorZ:Se,tileAnchorX:we,tileAnchorY:Pe,featureIndex:tt}=i.get(b);L.iconBox={x1:U,y1:q,x2:ee,y2:te,padding:le,projectedAnchorX:ue,projectedAnchorY:ge,projectedAnchorZ:Se,tileAnchorX:we,tileAnchorY:Pe},L.iconFeatureIndex=tt}if(M<R){const{x1:U,y1:q,x2:ee,y2:te,padding:le,projectedAnchorX:ue,projectedAnchorY:ge,projectedAnchorZ:Se,tileAnchorX:we,tileAnchorY:Pe,featureIndex:tt}=i.get(M);L.verticalIconBox={x1:U,y1:q,x2:ee,y2:te,padding:le,projectedAnchorX:ue,projectedAnchorY:ge,projectedAnchorZ:Se,tileAnchorX:we,tileAnchorY:Pe},L.verticalIconFeatureIndex=tt}return L}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const h=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(i,l){const h=i.placedSymbolArray.get(l),g=h.vertexStartIndex+4*h.numGlyphs;for(let x=h.vertexStartIndex;x<g;x+=4)i.indexArray.emplaceBack(x,x+1,x+2),i.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(i),h=Math.cos(i),g=[],x=[],b=[];for(let j=0;j<this.symbolInstances.length;++j){b.push(j);const M=this.symbolInstances.get(j);g.push(0|Math.round(l*M.tileAnchorX+h*M.tileAnchorY)),x.push(M.featureIndex)}return b.sort(((j,M)=>g[j]-g[M]||x[M]-x[j])),b}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let i=0;i<this.symbolInstances.length;++i)this.symbolInstanceIndexesSortedZOffset.push(i)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort(((i,l)=>this.symbolInstances.get(l).zOffset-this.symbolInstances.get(i).zOffset))}addToSortKeyRanges(i,l){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===l?h.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const h=this.symbolInstances.get(l);this.featureSortOrder.push(h.featureIndex);const{rightJustifiedTextSymbolIndex:g,centerJustifiedTextSymbolIndex:x,leftJustifiedTextSymbolIndex:b,verticalPlacedTextSymbolIndex:j,placedIconSymbolIndex:M,verticalPlacedIconSymbolIndex:R}=h;g>=0&&this.addIndicesForPlacedSymbol(this.text,g),x>=0&&x!==g&&this.addIndicesForPlacedSymbol(this.text,x),b>=0&&b!==x&&b!==g&&this.addIndicesForPlacedSymbol(this.text,b),j>=0&&this.addIndicesForPlacedSymbol(this.text,j),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M),R>=0&&this.addIndicesForPlacedSymbol(this.icon,R)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let h4,f4,$N;Hn(O2,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),O2.addDynamicAttributes=R2;class p4{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:th,this.defaultValue=i}evaluate(i){if(i.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(i.formattedSection))return l.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Hn(p4,"FormatSectionOverride",{omit:["defaultValue"]});const qN=()=>$N||($N={layout:h4||(h4=new ra({"symbol-placement":new fn(yt.layout_symbol["symbol-placement"]),"symbol-spacing":new fn(yt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new fn(yt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ln(yt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new fn(yt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new fn(yt.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new fn(yt.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new fn(yt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new fn(yt.layout_symbol["icon-ignore-placement"]),"icon-optional":new fn(yt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new fn(yt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ln(yt.layout_symbol["icon-size"]),"icon-size-scale-range":new fn(yt.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new Ln(yt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ln(yt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ln(yt.layout_symbol["icon-image"]),"icon-rotate":new Ln(yt.layout_symbol["icon-rotate"]),"icon-padding":new fn(yt.layout_symbol["icon-padding"]),"icon-keep-upright":new fn(yt.layout_symbol["icon-keep-upright"]),"icon-offset":new Ln(yt.layout_symbol["icon-offset"]),"icon-anchor":new Ln(yt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new fn(yt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new fn(yt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new fn(yt.layout_symbol["text-rotation-alignment"]),"text-field":new Ln(yt.layout_symbol["text-field"]),"text-font":new Ln(yt.layout_symbol["text-font"]),"text-size":new Ln(yt.layout_symbol["text-size"]),"text-size-scale-range":new fn(yt.layout_symbol["text-size-scale-range"]),"text-max-width":new Ln(yt.layout_symbol["text-max-width"]),"text-line-height":new Ln(yt.layout_symbol["text-line-height"]),"text-letter-spacing":new Ln(yt.layout_symbol["text-letter-spacing"]),"text-justify":new Ln(yt.layout_symbol["text-justify"]),"text-radial-offset":new Ln(yt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new fn(yt.layout_symbol["text-variable-anchor"]),"text-anchor":new Ln(yt.layout_symbol["text-anchor"]),"text-max-angle":new fn(yt.layout_symbol["text-max-angle"]),"text-writing-mode":new fn(yt.layout_symbol["text-writing-mode"]),"text-rotate":new Ln(yt.layout_symbol["text-rotate"]),"text-padding":new fn(yt.layout_symbol["text-padding"]),"text-keep-upright":new fn(yt.layout_symbol["text-keep-upright"]),"text-transform":new Ln(yt.layout_symbol["text-transform"]),"text-offset":new Ln(yt.layout_symbol["text-offset"]),"text-allow-overlap":new fn(yt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new fn(yt.layout_symbol["text-ignore-placement"]),"text-optional":new fn(yt.layout_symbol["text-optional"]),visibility:new fn(yt.layout_symbol.visibility)})),paint:f4||(f4=new ra({"icon-opacity":new Ln(yt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Ln(yt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Ln(yt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Ln(yt.paint_symbol["text-emissive-strength"]),"icon-color":new Ln(yt.paint_symbol["icon-color"]),"icon-halo-color":new Ln(yt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ln(yt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ln(yt.paint_symbol["icon-halo-blur"]),"icon-translate":new fn(yt.paint_symbol["icon-translate"]),"icon-translate-anchor":new fn(yt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new fn(yt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Ln(yt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Ln(yt.paint_symbol["text-occlusion-opacity"]),"text-color":new Ln(yt.paint_symbol["text-color"],{runtimeType:Yo,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new Ln(yt.paint_symbol["text-halo-color"]),"text-halo-width":new Ln(yt.paint_symbol["text-halo-width"]),"text-halo-blur":new Ln(yt.paint_symbol["text-halo-blur"]),"text-translate":new fn(yt.paint_symbol["text-translate"]),"text-translate-anchor":new fn(yt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new fn(yt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new fn(yt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new fn(yt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new fn(yt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Ln(yt.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"})}))},$N);class D2 extends al{constructor(i,l,h,g){super(i,qN(),l,h,g),this._colorAdjustmentMatrix=B([]),this.hasInitialOcclusionOpacityProperties=i.paint!==void 0&&("icon-occlusion-opacity"in i.paint||"text-occlusion-opacity"in i.paint)}recalculate(i,l){super.recalculate(i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const h=this.layout.get("text-writing-mode");if(h){const g=[];for(const x of h)g.indexOf(x)<0&&g.push(x);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(i,l,h,g){return this._saturation===i&&this._contrast===l&&this._brightnessMin===h&&this._brightnessMax===g||(this._colorAdjustmentMatrix=(function(x,b,j,M){x=Ia(x),b=Na(b);const R=$(),L=x/3,U=1-2*L,q=[U,L,L,0,L,U,L,0,L,L,U,0,0,0,0,1],ee=.5-.5*b,te=M-j;return K(R,[te,0,0,0,0,te,0,0,0,0,te,0,j,j,j,1],[b,0,0,0,0,b,0,0,0,0,b,0,ee,ee,ee,1]),K(R,R,q),R})(i,l,h,g),this._saturation=i,this._contrast=l,this._brightnessMin=h,this._brightnessMax=g),this._colorAdjustmentMatrix}getValueAndResolveTokens(i,l,h,g){const x=this.layout.get(i).evaluate(l,{},h,g),b=this._unevaluatedLayout._values[i];return b.isDataDriven()||up(b.value)||!x?x:(function(j,M){return M.replace(/{([^{}]+)}/g,((R,L)=>L in j?String(j[L]):""))})(l.properties,x)}createBucket(i){return new O2(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of qN().paint.overridableProperties){if(!D2.hasPaintOverride(this.layout,i))continue;const l=this.paint.get(i),h=new p4(l),g=new ho(h,l.property.specification,this.scope,this.options);let x=null;x=l.value.kind==="constant"||l.value.kind==="source"?new Hu("source",g):new cu("composite",g,l.value.zoomStops,l.value.interpolationType),this.paint._values[i]=new of(l.property,x,l.parameters)}}_handleOverridablePaintPropertyUpdate(i,l,h){return!(!this.layout||l.isDataDriven()||h.isDataDriven())&&D2.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,l){const h=i.get("text-field"),g=qN().paint.properties[l];let x=!1;const b=j=>{for(const M of j)if(g.overrides&&g.overrides.hasOverride(M))return void(x=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Bo)b(h.value.value.sections);else if(h.value.kind==="source"){const j=R=>{x||(R instanceof Pr&&Fn(R.value)===xe?b(R.value.sections):R instanceof xc?b(R.sections):R.eachChild(j))},M=h.value;M._styleExpression&&j(M._styleExpression.expression)}return x}getProgramIds(){return["symbol"]}getDefaultProgramParams(i,l,h){return{config:new ol(this,{zoom:l,lut:h}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let m4,g4,y4,v4;var HN=Ai([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function k2(u,i,l,h,g,x,b,j){const M=[u,i,1,l,h,1,g,x,1],R=[b,j,1],L=D([],M),[U,q,ee]=nr(R,R,L);return V(M,M,[U,0,0,0,q,0,0,0,ee])}function x4(u,i,l,h,g,x,b,j){const M=(function(R,L,U,q,ee,te,le,ue){const ge=k2(0,0,1,0,1,1,0,1),Se=k2(R,L,U,q,ee,te,le,ue);return V(Se,Se,D([],ge))})(u,i,l,h,g,x,b,j);return[M[2]/M[8]/mn,M[5]/M[8]/mn]}function I2(u){return[u[0],Math.min(Math.max(u[1],-Be),Be)]}class _4 extends od{constructor(i,l,h,g){super(),this.id=i,this.dispatcher=h,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(g),this.options=l,this._dirty=!1}load(i,l){if(this._loaded=l||!1,this.fire(new yc("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return i&&(this.coordinates=i),this._loaded=!0,void this._finishLoading();this._imageRequest=gr(this.map._requestManager.transformRequest(this.url,Mu.Image),((h,g)=>{this._imageRequest=null,this._loaded=!0,h?this.fire(new Fo(h)):g&&(this.image=g instanceof HTMLImageElement?co.getImageData(g):g,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading())}))}loaded(){return this._loaded}updateImage(i){return i.url?(this._imageRequest&&i.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=i.url,this.load(i.coordinates,this._loaded),this):this}setTexture(i){if(!(i.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new Lw(this.map.painter.context,i.handle),this.width=i.dimensions[0],this.height=i.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new yc("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(i){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof Lw||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(i){if(this.coordinates=i,this._boundsArray=void 0,this._unsupportedCoords=!1,!i.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let l=i[0][1],h=i[0][1];for(const x of i)x[1]>h&&(h=x[1]),x[1]<l&&(l=x[1]);const g=(h+l)/2;if(g>Be?this.onNorthPole=!0:g<-Be&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const x=i.map(Ge.fromLngLat);this.tileID=(function(b){let j=1/0,M=1/0,R=-1/0,L=-1/0;for(const le of b)j=Math.min(j,le.x),M=Math.min(M,le.y),R=Math.max(R,le.x),L=Math.max(L,le.y);const U=Math.max(R-j,L-M),q=Math.max(0,Math.floor(-Math.log(U)/Math.LN2)),ee=Math.pow(2,q);let te=Math.floor((j+R)/2*ee);return te>1&&(te-=1),new ac(q,te,Math.floor((M+L)/2*ee))})(x),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new yc("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){!this.texture||this.texture instanceof Lw||(this.texture.destroy(),this._dirty=!0),this.texture=null,this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(i){for(const ge in this.tiles){const Se=this.tiles[ge];Se.state!=="loaded"&&(Se.state="loaded",Se.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const l=Gw(new ac(0,0,0),this.map.transform.projection),h=[l.projection.project(this.coordinates[0][0],this.coordinates[0][1]),l.projection.project(this.coordinates[1][0],this.coordinates[1][1]),l.projection.project(this.coordinates[2][0],this.coordinates[2][1]),l.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!(function(ge){const Se=ge[1].x-ge[0].x,we=ge[1].y-ge[0].y,Pe=ge[2].x-ge[1].x,tt=ge[2].y-ge[1].y,Ke=ge[3].x-ge[2].x,Qe=ge[3].y-ge[2].y,dt=ge[0].x-ge[3].x,ft=ge[0].y-ge[3].y,Ft=Se*tt-Pe*we,xt=Pe*Qe-Ke*tt,Wt=Ke*ft-dt*Qe,bn=dt*we-Se*ft;return Ft>0&&xt>0&&Wt>0&&bn>0||Ft<0&&xt<0&&Wt<0&&bn<0})(h))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const g=Gw(this.tileID,this.map.transform.projection),[x,b,j,M]=this.coordinates.map((ge=>{const Se=g.projection.project(ge[0],ge[1]);return a4(g,Se)._round()}));this.perspectiveTransform=x4(x.x,x.y,b.x,b.y,j.x,j.y,M.x,M.y);const R=this._boundsArray=new jd;R.emplaceBack(x.x,x.y,0,0),R.emplaceBack(b.x,b.y,mn,0),R.emplaceBack(M.x,M.y,0,mn),R.emplaceBack(j.x,j.y,mn,mn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=i.createVertexBuffer(R,HN.members),this.boundsSegments=Hs.simpleSegment(0,0,4,2);const L=[],U=[I2((q=this.coordinates)[0]),I2(q[1]),I2(q[2]),I2(q[3])];var q;const[ee,te,le,ue]=(function(ge){let Se=ge[0][0],we=Se,Pe=ge[0][1],tt=Pe;for(let Ke=1;Ke<ge.length;Ke++)ge[Ke][0]<Se?Se=ge[Ke][0]:ge[Ke][0]>we&&(we=ge[Ke][0]),ge[Ke][1]<Pe?Pe=ge[Ke][1]:ge[Ke][1]>tt&&(tt=ge[Ke][1]);return[Se,Pe,we-Se,tt-Pe]})(U);{const ge=new jd,[Se,we,Pe,tt]=(function(Lt){let hn=Lt[0].x,Tt=hn,zt=Lt[0].y,wn=zt;for(let pn=1;pn<Lt.length;pn++)Lt[pn].x<hn?hn=Lt[pn].x:Lt[pn].x>Tt&&(Tt=Lt[pn].x),Lt[pn].y<zt?zt=Lt[pn].y:Lt[pn].y>wn&&(wn=Lt[pn].y);return[hn,zt,Tt-hn,wn-zt]})(h),Ke=Lt=>[(Lt.x-Se)/Pe,(Lt.y-we)/tt],[Qe,dt,ft,Ft]=h.map(Ke),xt=(function(Lt,hn,Tt,zt,wn,pn,ur,Jn){const cn=k2(0,0,1,0,1,1,0,1);return V(cn,cn,D([],k2(Lt,hn,Tt,zt,wn,pn,ur,Jn)))})(Qe[0],Qe[1],dt[0],dt[1],ft[0],ft[1],Ft[0],Ft[1]);this.elevatedGlobePerspectiveTransform=x4(Qe[0],Qe[1],dt[0],dt[1],ft[0],ft[1],Ft[0],Ft[1]);const Wt=(Lt,hn)=>{L.push(Lt.lng);const Tt=Math.round((Lt.lng-ee)/le*mn),zt=Math.round((Lt.lat-te)/ue*mn),wn=Ke(hn),pn=nr([],[wn[0],wn[1],1],xt),ur=Math.round(pn[0]/pn[2]*mn),Jn=Math.round(pn[1]/pn[2]*mn);ge.emplaceBack(Tt,zt,ur,Jn)},bn=h[3].x-h[0].x,tn=h[3].y-h[0].y,dn=h[2].x-h[1].x,xn=h[2].y-h[1].y;for(let Lt=0;Lt<65;Lt++){const hn=Lt/64,Tt=[h[0].x+hn*bn,h[0].y+hn*tn],zt=[h[1].x+hn*dn,h[1].y+hn*xn],wn=zt[0]-Tt[0],pn=zt[1]-Tt[1];for(let ur=0;ur<65;ur++){const Jn=ur/64,cn={x:Tt[0]+wn*Jn,y:Tt[1]+pn*Jn};Wt(l.projection.unproject(cn.x,cn.y),cn)}}this.elevatedGlobeVertexBuffer=i.createVertexBuffer(ge,HN.members)}{this.maxLongitudeTriangleSize=0;let ge=[],Se=new ki;const we=(Pe,tt,Ke)=>{Se.emplaceBack(Pe,tt,Ke);const Qe=L[Pe],dt=L[tt],ft=L[Ke],Ft=Math.min(Math.min(Qe,dt),ft),xt=Math.max(Math.max(Qe,dt),ft)-Ft;xt>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=xt),ge.push(Ft+xt/2)};for(let Pe=0;Pe<64;Pe++)for(let tt=0;tt<64;tt++){const Ke=65*Pe+tt,Qe=Ke+1,dt=Ke+65,ft=dt+1;we(Ke,dt,Qe),we(Qe,dt,ft)}[ge,Se]=(function(Pe,tt){const Ke=Array.from({length:Pe.length},((ft,Ft)=>Ft));Ke.sort(((ft,Ft)=>Pe[ft]-Pe[Ft]));const Qe=[],dt=new ki;for(let ft=0;ft<Ke.length;ft++){const Ft=Ke[ft];Qe.push(Pe[Ft]);const xt=3*Ft,Wt=xt+1;dt.emplaceBack(tt.uint16[xt],tt.uint16[Wt],tt.uint16[Wt+1])}return[Qe,dt]})(ge,Se),this.elevatedGlobeTrianglesCenterLongitudes=ge,this.elevatedGlobeIndexBuffer=i.createIndexBuffer(Se)}this.elevatedGlobeSegments=Hs.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,le/mn,0,ue/mn,0,0,te,ee,0])}prepare(){const i=Object.keys(this.tiles).length!==0;if(this.tileID&&!i)return;const l=this.map.painter.context,h=l.gl;!this._dirty||this.texture instanceof Lw||(this.texture?this.texture.update(this.image):(this.texture=new _N(l,this.image,h.RGBA8),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),i&&this._prepareData(l)}loadTile(i,l){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},l(null)):(i.state="errored",l(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(i){const l=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!l)return null;const h=this.elevatedGlobeTrianglesCenterLongitudes;let g=(x=i+180)+360*Math.round((h[0]-x)/360);var x;const b=new Hs,j=(U,q)=>{b.segments.push({vertexOffset:0,primitiveOffset:U,vertexLength:l.segments[0].vertexLength,primitiveLength:q,sortKey:void 0,vaos:{}})},M=.51*this.maxLongitudeTriangleSize;if(Math.abs(h[0]-g)<=M){const U=Js(h,0,h.length,g+M);return U===h.length||j(U,rs(h,U+1,h.length,g+360-M)-U),b}g<h[0]&&(g+=360);const R=rs(h,0,h.length,g-M);if(R===h.length)return j(0,h.length),b;j(0,R-0);const L=Js(h,R+1,h.length,g+M);return L!==h.length&&j(L,h.length-L),b}}const kse=(Math.pow(256,2)-1)/16907520;class b4 extends al{constructor(i,l,h,g){super(i,{layout:y4||(y4=new ra({visibility:new fn(yt.layout_raster.visibility)})),paint:v4||(v4=new ra({"raster-opacity":new fn(yt.paint_raster["raster-opacity"]),"raster-color":new lf(yt.paint_raster["raster-color"]),"raster-color-mix":new fn(yt.paint_raster["raster-color-mix"]),"raster-color-range":new fn(yt.paint_raster["raster-color-range"]),"raster-hue-rotate":new fn(yt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new fn(yt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new fn(yt.paint_raster["raster-brightness-max"]),"raster-saturation":new fn(yt.paint_raster["raster-saturation"]),"raster-contrast":new fn(yt.paint_raster["raster-contrast"]),"raster-resampling":new fn(yt.paint_raster["raster-resampling"]),"raster-fade-duration":new fn(yt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new fn(yt.paint_raster["raster-emissive-strength"]),"raster-array-band":new fn(yt.paint_raster["raster-array-band"]),"raster-elevation":new fn(yt.paint_raster["raster-elevation"]),"raster-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"})}))},l,h,g),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(i){return!(i&&i._source instanceof _4&&(i._source.onNorthPole||i._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(i){i!=="raster-color"&&i!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}updateColorRamp(i){if(!this.hasColorMap()||!this._curRampRange)return;const l=this._transitionablePaint._values["raster-color"].value.expression,[h,g]=i||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(h)&&isNaN(g)||h===this._curRampRange[0]&&g===this._curRampRange[1]||(this.colorRamp=Mp({expression:l,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:h,end:g}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[h,g])}}let w4,S4,T4,A4,j4;class E4 extends al{constructor(i,l,h,g){super(i,{layout:w4||(w4=new ra({visibility:new fn(yt["layout_raster-particle"].visibility)})),paint:S4||(S4=new ra({"raster-particle-array-band":new fn(yt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new fn(yt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new lf(yt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new fn(yt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new fn(yt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new fn(yt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new fn(yt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new fn(yt["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"})}))},l,h,g),this._updateColorRamp(),this.lastInvalidatedAt=co.now()}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this.tileFramebuffer&&(this.tileFramebuffer.destroy(),this.tileFramebuffer=null),this.particleFramebuffer&&(this.particleFramebuffer.destroy(),this.particleFramebuffer=null)}onRemove(i){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(i){return!1}_handleSpecialPaintPropertyUpdate(i){i!=="raster-particle-color"&&i!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),i==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const i=this._transitionablePaint._values["raster-particle-color"].value.expression,l=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Mp({expression:i,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:l}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=co.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class Ise extends al{constructor(i,l){super(i,{},l,null),this.implementation=i,i.slot&&(this.slot=i.slot)}is3D(i){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(i){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}function GN(u,i,l){const h=[0,0,1],g=Wn([]);return un(g,g,l?-Dr(u)+Math.PI:Dr(u)),Vt(g,g,-Dr(i)),sn(h,h,g),Ot(h,h)}const C4={None:0,Model:1,Symbol:2,FillExtrusion:4};class L2{constructor(i,l,h,g){this.message=(i?`${i}: `:"")+h,g&&(this.identifier=g),l!=null&&l.__line__&&(this.line=l.__line__)}}function WN(u,i){const l=u.indexOf("://")===-1;try{return new URL(u,l&&i?"http://example.com":void 0),!0}catch{return!1}}class N4{constructor(i,l){this.feature=i,this.instancedDataOffset=l,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class P4{constructor(){this.instancedDataArray=new df,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class XN{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.layers=i.layers,this.layerIds=this.layers.map((l=>l.fqid)),this.projection=i.projection,this.index=i.index,this.worldview=i.worldview,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter((l=>l.isStateDependent())).map((l=>l.id)),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=i.styleDefinedModelURLs}updateFootprints(i,l){}populate(i,l,h,g){this.tileToMeter=qe(h);const x=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:b,id:j,index:M,sourceLayerIndex:R}of i){const L=j??(b.properties&&b.properties.hasOwnProperty("id")?b.properties.id:void 0),U=Dt(b,x);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom,{worldview:this.worldview}),U,h))continue;const q={id:L,sourceLayerIndex:R,index:M,geometry:x?U.geometry:at(b,h,g),properties:b.properties,type:b.type,patterns:{}},ee=this.addFeature(q,q.geometry,U);ee&&l.featureIndex.insert(b,q.geometry,M,R,this.index,this.instancesPerModel[ee].instancedDataArray.length,mn/32)}this.lookup=null}update(i,l,h,g){for(const x in this.instancesPerModel){const b=this.instancesPerModel[x];for(const j in i)b.idToFeaturesIndex.hasOwnProperty(j)&&(this.evaluate(b.features[b.idToFeaturesIndex[j]],i[j],b,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let i=!1;for(const l in this.instancesPerModel){const h=this.instancesPerModel[l];for(const g of h.features){const x=this.layers[0],b=g.feature,j=this.canonical,M=x.paint.get("model-rotation").evaluate(b,{},j),R=x.paint.get("model-scale").evaluate(b,{},j),L=x.paint.get("model-translation").evaluate(b,{},j);or(g.rotation,M)&&or(g.scale,R)&&or(g.translation,L)||(this.evaluate(g,g.featureStates,h,!0),i=!0)}}return i}updateReplacement(i,l,h,g){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;const x=l.getReplacementRegionsForTile(i.toUnwrapped(),!0);if(H_(this.activeReplacements,x))return!1;this.activeReplacements=x;let b=!1;for(const j in this.instancesPerModel){const M=this.instancesPerModel[j],R=M.instancedDataArray;for(const L of M.features){const U=L.instancedDataOffset,q=L.instancedDataCount;for(let ee=0;ee<q;ee++){const te=16*(ee+U);let le=R.float32[te+0];const ue=le>mn;le=ue?le-mn:le;const ge=Math.floor(le),Se=R.float32[te+1];let we=!1;for(const Pe of this.activeReplacements)if(!o2(Pe,h,C4.Model,g)&&!(Pe.min.x>ge||ge>Pe.max.x||Pe.min.y>Se||Se>Pe.max.y)&&(we=sg(c2(ge,Se,i.canonical,Pe.footprintTileId.canonical),Pe.footprint),we))break;R.float32[te]=we?le+mn:le,b=b||we!==ue}}}return b}isEmpty(){for(const i in this.instancesPerModel)if(this.instancesPerModel[i].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(i){if(!this.uploaded)for(const l in this.instancesPerModel){const h=this.instancesPerModel[l];h.instancedDataArray.length<0||h.instancedDataArray.length===0||(h.instancedDataBuffer?h.instancedDataBuffer.updateData(h.instancedDataArray):h.instancedDataBuffer=i.createVertexBuffer(h.instancedDataArray,mie.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const l in this.instancesPerModel){const h=this.instancesPerModel[l];h.instancedDataArray.length!==0&&h.instancedDataBuffer&&h.instancedDataBuffer.destroy()}const i=this.layers[0].modelManager;if(i&&this.modelUris&&this.modelsRequested)for(const l of this.modelUris)i.removeModel(l,"",!0)}addFeature(i,l,h){const g=this.layers[0],x=g.layout.get("model-id").evaluate(h,{},this.canonical);if(!x)return ai(`modelId is not evaluated for layer ${g.id} and it is not going to get rendered.`),x;(WN(x,!1)||this.styleDefinedModelURLs[x]!==void 0)&&(this.modelUris.includes(x)||this.modelUris.push(x)),this.instancesPerModel[x]||(this.instancesPerModel[x]=new P4);const b=this.instancesPerModel[x],j=b.instancedDataArray,M=new N4(h,j.length);for(const R of l)for(const L of R){if(L.x<0||L.x>=mn||L.y<0||L.y>=mn)continue;const U=(this.lookupDim-1)/mn,q=this.lookupDim*(L.y*U|0)+L.x*U|0;if(this.lookup){if(this.lookup[q]!==0)continue;this.lookup[q]=1}this.instanceCount++;const ee=j.length;j.resize(ee+1),b.instancesEvaluatedElevation.push(0),j.float32[16*ee]=L.x,j.float32[16*ee+1]=L.y}return M.instancedDataCount=b.instancedDataArray.length-M.instancedDataOffset,M.instancedDataCount>0&&(i.id&&(b.idToFeaturesIndex[i.id]=b.features.length),b.features.push(M),this.evaluate(M,{},b,!1)),x}getModelUris(){return this.modelUris}evaluate(i,l,h,g){const x=this.layers[0],b=i.feature,j=this.canonical,M=i.rotation=x.paint.get("model-rotation").evaluate(b,l,j),R=i.scale=x.paint.get("model-scale").evaluate(b,l,j),L=i.translation=x.paint.get("model-translation").evaluate(b,l,j),U=x.paint.get("model-color").evaluate(b,l,j);U.a=x.paint.get("model-color-mix-intensity").evaluate(b,l,j);const q=[];this.maxVerticalOffset<L[2]&&(this.maxVerticalOffset=L[2]),this.maxScale=Math.max(Math.max(this.maxScale,R[0]),Math.max(R[1],R[2])),nB(q,M,R);const ee=Math.round(100*U.a)+U.b/1.05;for(let te=0;te<i.instancedDataCount;++te){const le=i.instancedDataOffset+te,ue=16*le,ge=h.instancedDataArray.float32;let Se=0;g&&(Se=ge[ue+6]-h.instancesEvaluatedElevation[le]);const we=0|ge[ue+1];ge[ue]=(0|ge[ue])+U.r/1.05,ge[ue+1]=we+U.g/1.05,ge[ue+2]=ee,ge[ue+3]=1/(j.z>10?this.tileToMeter:qe(j,we)),ge[ue+4]=L[0],ge[ue+5]=L[1],ge[ue+6]=L[2]+Se,ge[ue+7]=q[0],ge[ue+8]=q[1],ge[ue+9]=q[2],ge[ue+10]=q[4],ge[ue+11]=q[5],ge[ue+12]=q[6],ge[ue+13]=q[8],ge[ue+14]=q[9],ge[ue+15]=q[10],h.instancesEvaluatedElevation[le]=L[2]}}}let M4,R4;Hn(XN,"ModelBucket",{omit:["layers"]}),Hn(P4,"PerModelAttributes"),Hn(N4,"ModelFeature");class o0{constructor(i,l,h){this._demTile=i,this._dem=this._demTile.dem,this._scale=l,this._offset=h}static create(i,l,h){const g=h||i.findDEMTileFor(l);if(!g||!g.dem)return;const x=g.dem,b=g.tileID,j=1<<l.canonical.z-b.canonical.z;return new o0(g,x.dim/mn/j,[(l.canonical.x/j-b.canonical.x)*x.dim,(l.canonical.y/j-b.canonical.y)*x.dim])}tileCoordToPixel(i,l){const h=l*this._scale+this._offset[1];return new Rt(Math.floor(i*this._scale+this._offset[0]),Math.floor(h))}getElevationAt(i,l,h,g){const x=i*this._scale+this._offset[0],b=l*this._scale+this._offset[1],j=Math.floor(x),M=Math.floor(b),R=this._dem;return g=!!g,h?yr(yr(R.get(j,M,g),R.get(j,M+1,g),b-M),yr(R.get(j+1,M,g),R.get(j+1,M+1,g),b-M),x-j):R.get(j,M,g)}getElevationAtPixel(i,l,h){return this._dem.get(i,l,!!h)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*me(1,i)*this._dem.stride}}const ZN=new Float32Array(262144),bx=new Uint8Array(262144);function O4(u){let i=0;if(u.meshes)for(const l of u.meshes)i=Math.max(i,l.aabb.max[2]);if(u.children)for(const l of u.children)i=Math.max(i,O4(l));return i}function D4(u,i,l){if(u.meshes)for(const h of u.meshes){if(h.aabb.min[0]===1/0)continue;const g=ii.applyTransform(h.aabb,u.matrix);l.insert(i,g.min[0],g.min[1],g.max[0],g.max[1])}if(u.children)for(const h of u.children)D4(h,i,l)}const k4=["","wall","door","roof","window","lamp","logo"];class I4{constructor(i){this.node=i,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedTranslation=[0,0,0],this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:i.id,geometry:[],properties:{height:O4(i)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new ii([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let i=0;const l=new ii([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const h of this.node.meshes)this.node.lightMeshIndex!==i&&(h.transformedAabb=ii.applyTransformFast(h.aabb,this.node.matrix),l.encapsulate(h.transformedAabb)),i++;this.aabb=l}return this.aabb}}class z2{constructor(i,l,h,g,x,b,j,M){this.id=h,this.layers=i,this.layerIds=this.layers.map((R=>R.fqid)),this.stateDependentLayerIds=this.layers.filter((R=>R.isStateDependent())).map((R=>R.id)),this.modelTraits|=t0.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,g&&(this.modelTraits|=t0.HasMapboxMeshFeatures),x&&(this.modelTraits|=t0.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=b,this.worldview=M,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const R of l)this.nodesInfo.push(new I4(R)),D4(R,j.featureIndexArray.length,j.grid),j.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,j.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(i,l){for(const h of this.getNodesInfo()){const g=h.node;g.footprint&&l.push({footprint:g.footprint,id:i})}}update(i){const l=Object.keys(i).length!==0;if(l&&!this.stateDependentLayers.length)return;const h=l?this.stateDependentLayers:this.layers;if(!Jr(i,this.states))for(const g of h)this.evaluate(g,i);this.states=structuredClone(i)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(i){if(!this.needsUpload)return;const l=this.getNodesInfo();for(const h of l){const g=h.node;this.uploaded?this.updatePbrBuffer(g):SN(g,i,!0)}for(const h of l)v2(h.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(i){let l=!1;if(!i.meshes)return l;for(const h of i.meshes)h.pbrBuffer&&(h.pbrBuffer.updateData(h.featureArray),l=!0);return l}needsReEvaluation(i,l,h){const g=i.transform.projectionOptions,x=i.style.getBrightness(),b=this.brightness!==x;if(!this.uploaded||this.dirty||g.name!==this.projection.name||Kw(h.paint.get("model-color").value,b)||Kw(h.paint.get("model-color-mix-intensity").value,b)||Kw(h.paint.get("model-roughness").value,b)||Kw(h.paint.get("model-emissive-strength").value,b)||Kw(h.paint.get("model-height-based-emissive-strength-multiplier").value,b)){this.projection=g,this.brightness=x;const j=this.getNodesInfo();for(const M of j)M.state=null;return!0}return!1}evaluateTransform(i,l){if(i.transform.zoom===this.zoom)return;this.zoom=i.transform.zoom;const h=this.getNodesInfo(),g=this.id.canonical;for(const x of h){const b=x.feature;x.evaluatedTranslation=l.paint.get("model-translation").evaluate(b,{},g),x.evaluatedScale=l.paint.get("model-scale").evaluate(b,{},g)}}evaluate(i,l){const h=this.getNodesInfo();for(const g of h){if(!g.node.meshes)continue;const x=g.feature,b=l&&l[x.id];if(Jr(b,g.state))continue;g.state=structuredClone(b);const j=g.node.meshes&&g.node.meshes[0].featureData,M=g.evaluatedColor[2],R=g.evaluatedRMEA[2],L=this.id.canonical;if(g.hasTranslucentParts=!1,j){for(let U=0;U<k4.length;U++){const q=k4[U];q.length&&(x.properties.part=q);const ee=i.paint.get("model-color").evaluate(x,b,L).toPremultipliedRenderColor(null),te=i.paint.get("model-color-mix-intensity").evaluate(x,b,L);g.evaluatedColor[U]=[ee.r,ee.g,ee.b,te],g.evaluatedRMEA[U][0]=i.paint.get("model-roughness").evaluate(x,b,L),g.evaluatedRMEA[U][2]=i.paint.get("model-emissive-strength").evaluate(x,b,L),g.evaluatedRMEA[U][3]=ee.a,g.emissionHeightBasedParams[U]=i.paint.get("model-height-based-emissive-strength-multiplier").evaluate(x,b,L),!g.hasTranslucentParts&&ee.a<1&&(g.hasTranslucentParts=!0)}delete x.properties.part,zse(g,M!==g.evaluatedColor[2]||R!==g.evaluatedRMEA[2],this.modelTraits)}else g.evaluatedRMEA[0][2]=i.paint.get("model-emissive-strength").evaluate(x,b,L);g.evaluatedTranslation=i.paint.get("model-translation").evaluate(x,b,L),g.evaluatedScale=i.paint.get("model-scale").evaluate(x,b,L),this.updatePbrBuffer(g.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(i,l,h,g){const x=i.findDEMTileFor(h);if(x&&(x.tileID.canonical!==this.terrainTile||l!==this.terrainExaggeration)){if(x.dem&&x.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=x.tileID.overscaledZ;const b=o0.create(i,h,x);if(!b)return;this.modelTraits&t0.HasMapboxMeshFeatures&&this.updateDEM(i,b,h,g);for(const j of this.getNodesInfo()){const M=j.node;if(!M.footprint||!M.footprint.vertices||!M.footprint.vertices.length)continue;const R=M.footprint.vertices;let L=b.getElevationAt(R[0].x,R[0].y,!0,!0);for(let U=1;U<R.length;U++)L=Math.min(L,b.getElevationAt(R[U].x,R[U].y,!0,!0));M.elevation=L}}this.terrainTile=x.tileID.canonical,this.terrainExaggeration=l}}updateDEM(i,l,h,g){let x=l._dem._modifiedForSources[g];if(x===void 0&&(l._dem._modifiedForSources[g]=[],x=l._dem._modifiedForSources[g]),x.includes(h.canonical))return;const b=l._dem.dim;x.push(h.canonical);let j=!1;for(const M of this.getNodesInfo()){const R=M.node;if(!R.footprint||!R.footprint.grid)continue;const L=R.footprint.grid,U=l.tileCoordToPixel(L.min.x,L.min.y),q=l.tileCoordToPixel(L.max.x,L.max.y),ee=Math.min(Math.min(b-q.y,U.x),Math.min(U.y,b-q.x));if(ee<0)continue;const te=Oe(ee,2,5);let le=Math.max(0,U.x-te),ue=Math.max(0,U.y-te),ge=Math.min(q.x+te,b-1),Se=Math.min(q.y+te,b-1);for(let Ke=ue;Ke<=Se;++Ke)for(let Qe=le;Qe<=ge;++Qe)bx[Ke*b+Qe]=255;let we=0,Pe=0;for(let Ke=0;Ke<L.cellsY;++Ke)for(let Qe=0;Qe<L.cellsX;++Qe){if(!L.cells[Ke*L.cellsX+Qe])continue;const dt=l.tileCoordToPixel(L.min.x+Qe/L.xScale,L.min.y+Ke/L.yScale),ft=l.tileCoordToPixel(L.min.x+(Qe+1)/L.xScale,L.min.y+(Ke+1)/L.yScale);for(let Ft=dt.y;Ft<=Math.min(ft.y+1,b-1);++Ft)for(let xt=dt.x;xt<=Math.min(ft.x+1,b-1);++xt)bx[Ft*b+xt]===255&&(bx[Ft*b+xt]=0,we+=l.getElevationAtPixel(xt,Ft),Pe++)}const tt=we/Pe;le=Math.max(1,U.x-te),ue=Math.max(1,U.y-te),ge=Math.min(q.x+te,b-2),Se=Math.min(q.y+te,b-2),j=!0;for(let Ke=ue;Ke<=Se;++Ke)for(let Qe=le;Qe<=ge;++Qe)bx[Ke*b+Qe]===0&&(ZN[Ke*b+Qe]=l._dem.set(Qe,Ke,tt));for(let Ke=1;Ke<te;++Ke){le=Math.max(1,U.x-Ke),ue=Math.max(1,U.y-Ke),ge=Math.min(q.x+Ke,b-2),Se=Math.min(q.y+Ke,b-2);for(let Qe=ue;Qe<=Se;++Qe)for(let dt=le;dt<=ge;++dt){const ft=Qe*b+dt;if(bx[ft]===255){let Ft=0,xt=0,Wt=-1,bn=-1;for(let tn=-1;tn<=1;++tn)for(let dn=-1;dn<=1;++dn){const xn=(Qe+tn)*b+dt+dn;if(bx[xn]>=Ke)continue;const Lt=ZN[xn],hn=Math.abs(Lt);hn>xt&&(Ft=Lt,xt=hn,Wt=dn,bn=tn)}if(xt>.1){const tn=1-(Ke+.5*Math.abs(Wt*bn))/te;let dn=l._dem.get(dt,Qe)+Ft*tn;const xn=l._dem.get(dt+Wt,Qe+bn),Lt=l._dem.get(dt-Wt,Qe-bn,!0);(dn-xn)*(dn-Lt)>0&&(dn=(xn+Lt)/2),ZN[ft]=l._dem.set(dt,Qe,dn),bx[ft]=Ke}}}}}j&&(l._demTile.needsDEMTextureUpload=!0,l._dem._timestamp=co.now())}setFilter(i){this.filter=i?cf(i):null}getNodesInfo(){return this.filter?this.nodesInfo.filter((i=>this.filter.filter(new hs(this.id.overscaledZ,{worldview:this.worldview}),i.feature,this.id.canonical))):this.nodesInfo}destroy(){const i=this.getNodesInfo();for(const l of i)v2(l.node),TN(l.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(i,l){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const h=l.getReplacementRegionsForTile(i.toUnwrapped());for(const g of this.getNodesInfo()){const x=g.node.footprint;g.hiddenByReplacement=!!x&&!h.find((b=>b.footprint===x))}}getHeightAtTileCoord(i,l){const h=[],g=[0,0,0],x=B([]);for(const b of this.getNodesInfo()){const j=b.node.meshes[0],M=j.transformedAabb;if(i<M.min[0]||l<M.min[1]||i>M.max[0]||l>M.max[1])continue;if(b.node.hidden===!0)return{height:1/0,maxHeight:b.feature.properties.height,hidden:!1,verticalScale:b.evaluatedScale[2]};F(x,b.node.matrix),g[0]=i,g[1]=l,Cn(g,g,x);const R=(g[0]-j.aabb.min[0])/(j.aabb.max[0]-j.aabb.min[0])*vx|0,L=Math.min(63,(g[1]-j.aabb.min[1])/(j.aabb.max[1]-j.aabb.min[1])*vx|0)*vx+Math.min(63,R),U=j.heightmap[L];if(!(U<0&&b.node.footprint))return b.hiddenByReplacement?void 0:{height:U,maxHeight:b.feature.properties.height,hidden:!1,verticalScale:b.evaluatedScale[2]};if(b.node.footprint.grid.query(new Rt(i,l),new Rt(i,l),h),h.length>0)return{height:void 0,maxHeight:b.feature.properties.height,hidden:b.hiddenByReplacement,verticalScale:b.evaluatedScale[2]}}}}function Kw(u,i){return u instanceof Hu&&!u.isLightConstant&&i}function Lse(u,i,l,h,g,x,b,j){let M=(61440&i|(61440&i)>>4)>>8,R=(3840&i|(3840&i)>>4)>>4,L=240&i|(240&i)>>4;l[3]>0&&(M=yr(M,255*l[0],l[3]),R=yr(R,255*l[1],l[3]),L=yr(L,255*l[2],l[3]));const U=M<<8|R,q=L<<8|Math.floor(255*h[3]),ee=(function(Ke){const Qe=Oe(Ke,0,2);return Math.min(Math.round(.5*Qe*255),255)})(h[2])<<8|15*h[0]<<4|15*h[1],te=Oe(g[0],0,1),le=Oe(g[1],0,1),ue=Oe(g[2],0,1),ge=Oe(g[3],0,1);let Se,we,Pe,tt;if(te!==le&&b!==x&&le!==te){const Ke=b-x;we=1/(Ke*(le-te)),Pe=-(x+Ke*te)/(Ke*(le-te));const Qe=Oe(g[4],-1,1);tt=Math.pow(10,Qe),Se=255*ue<<8|255*ge}else Se=65535,we=0,Pe=1,tt=1;if(u.emplaceBack(U,q,ee,Se,we,Pe,tt),j){const Ke=j.length;j.clear();for(let Qe=0;Qe<Ke;Qe++)j.emplaceBack(U,q,ee,Se,we,Pe,tt)}}function zse(u,i,l){const h=u.node;let g=0;const x=l&t0.HasMeshoptCompression;for(const b of h.meshes){if(h.lights&&h.lightMeshIndex===g||!b.featureData)continue;b.featureArray=new hf,b.featureArray.reserve(b.featureData.length);let j=i;for(const M of b.featureData){const R=x?65535&M:M>>16&65535,L=x?M>>16&65535:65535&M,U=(15&L)<8?15&L:0,q=u.evaluatedRMEA[U],ee=u.evaluatedColor[U],te=u.emissionHeightBasedParams[U];let le;if(j&&U===2&&h.lights&&(le=new hf,le.resize(10*h.lights.length)),Lse(b.featureArray,R,ee,q,te,b.aabb.min[2],b.aabb.max[2],le),le&&j){j=!1;const ue=h.meshes[h.lightMeshIndex];ue.featureArray=le,ue.featureArray._trim()}}b.featureArray._trim(),g++}}function L4(u,i,l,h){const g=1<<u.z;i.lat=Ne((h/mn+u.y)/g),i.lng=be((l/mn+u.x)/g)}function Fse(u,i,l,h){const g=u.getNodesInfo()[i];if(!g||g.hiddenByReplacement||!g.node.meshes)return;let x=Number.MAX_VALUE;const b=g.node,j=l.tile,M=h.calculatePosMatrix(j.tileID.toUnwrapped(),h.worldSize),R=g.evaluatedScale;let L=0;h.elevation&&b.elevation&&(L=b.elevation*h.elevation.exaggeration()),Y(M,M,[(b.anchor?b.anchor[0]:0)*(R[0]-1),(b.anchor?b.anchor[1]:0)*(R[1]-1),L]),X(M,M,R);const U=l.queryGeometry,q=U.isPointQuery()?U.screenBounds:U.screenGeometry,ee=function(le){const ue=K([],M,le.matrix);K(ue,h.expandedFarZProjMatrix,ue);for(let ge=0;ge<le.meshes.length;++ge){const Se=le.meshes[ge];if(ge===le.lightMeshIndex)continue;const we=rB(q,h,ue,Se.aabb);we!=null&&(x=Math.min(we,x))}if(le.children)for(const ge of le.children)ee(ge)};if(ee(b),x===Number.MAX_VALUE)return;const te=new G(0,0);return L4(j.tileID.canonical,te,g.node.anchor[0],g.node.anchor[1]),{intersectionZ:x,position:te,feature:g.feature}}Hn(z2,"Tiled3dModelBucket",{omit:["layers"]}),Hn(I4,"Tiled3dModelFeature");const Bse={circle:class extends al{constructor(u,i,l,h){super(u,{layout:Th||(Th=new ra({"circle-sort-key":new Ln(yt.layout_circle["circle-sort-key"]),"circle-elevation-reference":new fn(yt.layout_circle["circle-elevation-reference"]),visibility:new fn(yt.layout_circle.visibility)})),paint:Ep||(Ep=new ra({"circle-radius":new Ln(yt.paint_circle["circle-radius"]),"circle-color":new Ln(yt.paint_circle["circle-color"]),"circle-blur":new Ln(yt.paint_circle["circle-blur"]),"circle-opacity":new Ln(yt.paint_circle["circle-opacity"]),"circle-translate":new fn(yt.paint_circle["circle-translate"]),"circle-translate-anchor":new fn(yt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new fn(yt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new fn(yt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ln(yt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ln(yt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ln(yt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new fn(yt.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"})}))},i,l,h)}createBucket(u){return new Ui(u)}queryRadius(u){const i=u;return So("circle-radius",this,i)+So("circle-stroke-width",this,i)+ma(this.paint.get("circle-translate"))}queryIntersectsFeature(u,i,l,h,g,x,b,j){const M=Rd(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,u.pixelToTileUnitsFactor),R=this.paint.get("circle-radius").evaluate(i,l)+this.paint.get("circle-stroke-width").evaluate(i,l);return dw(u,h,x,b,j,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",M,R)}getProgramIds(){return["circle"]}getDefaultProgramParams(u,i,l){const h=uw(this);return{config:new ol(this,{zoom:i,lut:l}),defines:h,overrideFog:!1}}is3D(u){return!u&&!!this.layout&&this.layout.get("circle-elevation-reference")!=="none"}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends al{createBucket(u){return new HT(u)}constructor(u,i,l,h){super(u,{layout:wy||(wy=new ra({visibility:new fn(yt.layout_heatmap.visibility)})),paint:GT||(GT=new ra({"heatmap-radius":new Ln(yt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ln(yt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new fn(yt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new lf(yt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new fn(yt.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"})}))},i,l,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Mp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}_clear(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}queryRadius(u){return So("heatmap-radius",this,u)}queryIntersectsFeature(u,i,l,h,g,x,b,j){const M=this.paint.get("heatmap-radius").evaluate(i,l);return dw(u,h,x,b,j,!0,!0,new Rt(0,0),M)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(u,i,l){return u==="heatmap"?{config:new ol(this,{zoom:i,lut:l}),overrideFog:!1}:{}}},hillshade:class extends al{constructor(u,i,l,h){super(u,{layout:fw||(fw=new ra({visibility:new fn(yt.layout_hillshade.visibility)})),paint:Ls||(Ls=new ra({"hillshade-illumination-direction":new fn(yt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new fn(yt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new fn(yt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new fn(yt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new fn(yt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new fn(yt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new fn(yt.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"})}))},i,l,h)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(u,i,l){return{overrideFog:!1}}},fill:class extends al{constructor(u,i,l,h){super(u,{layout:r2||(r2=new ra({"fill-sort-key":new Ln(yt.layout_fill["fill-sort-key"]),visibility:new fn(yt.layout_fill.visibility),"fill-elevation-reference":new fn(yt.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new Ln(yt.layout_fill["fill-construct-bridge-guard-rail"])})),paint:i2||(i2=new ra({"fill-antialias":new fn(yt.paint_fill["fill-antialias"]),"fill-opacity":new Ln(yt.paint_fill["fill-opacity"]),"fill-color":new Ln(yt.paint_fill["fill-color"]),"fill-outline-color":new Ln(yt.paint_fill["fill-outline-color"]),"fill-translate":new fn(yt.paint_fill["fill-translate"]),"fill-translate-anchor":new fn(yt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ln(yt.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new fn(yt.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new fn(yt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Ln(yt.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new Ln(yt.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new Ln(yt.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"})}))},i,l,h)}getProgramIds(){const u=this.paint.get("fill-pattern"),i=u&&u.constantOr(1),l=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getDefaultProgramParams(u,i,l){return{config:new ol(this,{zoom:i,lut:l}),overrideFog:!1}}recalculate(u,i){super.recalculate(u,i);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new bw(u)}queryRadius(){return ma(this.paint.get("fill-translate"))}queryIntersectsFeature(u,i,l,h,g,x){return!u.queryGeometry.isAboveHorizon&&ba(Vl(u.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,u.pixelToTileUnitsFactor),h)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(u){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const i=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return u!=null?i&&!u:i}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends al{constructor(u,i,l,h){super(u,{layout:gx||(gx=new ra({visibility:new fn(yt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new fn(yt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:Dw||(Dw=new ra({"fill-extrusion-opacity":new fn(yt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ln(yt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new fn(yt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new fn(yt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ln(yt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new fn(yt["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new Ln(yt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ln(yt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new fn(yt["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new fn(yt["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new fn(yt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new fn(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new fn(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new fn(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new fn(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new fn(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new fn(yt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new fn(yt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Ln(yt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Ln(yt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new fn(yt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new fn(yt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new fn(yt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new fn(yt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Ln(yt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Ln(yt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new fn(yt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"})}))},i,l,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new Lp(u)}queryRadius(){return ma(this.paint.get("fill-extrusion-translate"))}is3D(u){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(u,i,l,h,g,x,b,j,M){const R=Rd(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,u.pixelToTileUnitsFactor),L=this.paint.get("fill-extrusion-height").evaluate(i,l),U=this.paint.get("fill-extrusion-base").evaluate(i,l),q=[0,0],ee=j&&x.elevation,te=x.elevation?x.elevation.exaggeration():1,le=u.tile.getBucket(this);if(ee&&le instanceof Lp){const Pe=le.centroidVertexArray,tt=M+1;tt<Pe.length&&(q[0]=Pe.geta_centroid_pos0(tt),q[1]=Pe.geta_centroid_pos1(tt))}if(q[0]===0&&q[1]===1)return!1;x.projection.name==="globe"&&(h=p2([h],[new Rt(0,0),new Rt(mn,mn)],u.tileID.canonical).map((Pe=>Pe.polygon)).flat());const ue=ee?j:null,[ge,Se]=(function(Pe,tt,Ke,Qe,dt,ft,Ft,xt,Wt,bn,tn){return Pe.projection.name==="globe"?(function(dn,xn,Lt,hn,Tt,zt,wn,pn,ur,Jn,cn){const yn=[],er=[],Bn=dn.projection.upVectorScale(cn,dn.center.lat,dn.worldSize).metersToTile,En=[0,0,0,1],$n=[0,0,0,1],Cr=(si,Hr,Mi,gi)=>{si[0]=Hr,si[1]=Mi,si[2]=gi,si[3]=1},kr=Ow();Lt>0&&(Lt+=kr),hn+=kr;for(const si of xn){const Hr=[],Mi=[];for(const gi of si){const Gs=gi.x+Tt.x,Ie=gi.y+Tt.y,Le=dn.projection.projectTilePoint(Gs,Ie,cn),It=dn.projection.upVector(cn,gi.x,gi.y);let Sn=Lt,kn=hn;if(wn){const Dn=k(Gs,Ie,Lt,hn,wn,pn,ur,Jn);Sn+=Dn.base,kn+=Dn.top}Lt!==0?Cr(En,Le.x+It[0]*Bn*Sn,Le.y+It[1]*Bn*Sn,Le.z+It[2]*Bn*Sn):Cr(En,Le.x,Le.y,Le.z),Cr($n,Le.x+It[0]*Bn*kn,Le.y+It[1]*Bn*kn,Le.z+It[2]*Bn*kn),Cn(En,En,zt),Cn($n,$n,zt),Hr.push(new Ld(En[0],En[1],En[2])),Mi.push(new Ld($n[0],$n[1],$n[2]))}yn.push(Hr),er.push(Mi)}return[yn,er]})(Pe,tt,Ke,Qe,dt,ft,Ft,xt,Wt,bn,tn):Ft?(function(dn,xn,Lt,hn,Tt,zt,wn,pn,ur){const Jn=[],cn=[],yn=[0,0,0,1];for(const er of dn){const Bn=[],En=[];for(const $n of er){const Cr=$n.x+hn.x,kr=$n.y+hn.y,si=k(Cr,kr,xn,Lt,zt,wn,pn,ur);yn[0]=Cr,yn[1]=kr,yn[2]=si.base,yn[3]=1,qt(yn,yn,Tt),yn[3]=Math.max(yn[3],1e-5);const Hr=new Ld(yn[0]/yn[3],yn[1]/yn[3],yn[2]/yn[3]);yn[0]=Cr,yn[1]=kr,yn[2]=si.top,yn[3]=1,qt(yn,yn,Tt),yn[3]=Math.max(yn[3],1e-5);const Mi=new Ld(yn[0]/yn[3],yn[1]/yn[3],yn[2]/yn[3]);Bn.push(Hr),En.push(Mi)}Jn.push(Bn),cn.push(En)}return[Jn,cn]})(tt,Ke,Qe,dt,ft,Ft,xt,Wt,bn):(function(dn,xn,Lt,hn,Tt){const zt=[],wn=[],pn=Tt[8]*xn,ur=Tt[9]*xn,Jn=Tt[10]*xn,cn=Tt[11]*xn,yn=Tt[8]*Lt,er=Tt[9]*Lt,Bn=Tt[10]*Lt,En=Tt[11]*Lt;for(const $n of dn){const Cr=[],kr=[];for(const si of $n){const Hr=si.x+hn.x,Mi=si.y+hn.y,gi=Tt[0]*Hr+Tt[4]*Mi+Tt[12],Gs=Tt[1]*Hr+Tt[5]*Mi+Tt[13],Ie=Tt[2]*Hr+Tt[6]*Mi+Tt[14],Le=Tt[3]*Hr+Tt[7]*Mi+Tt[15],It=gi+pn,Sn=Gs+ur,kn=Ie+Jn,Dn=Math.max(Le+cn,1e-5),Qn=gi+yn,Or=Gs+er,Ci=Ie+Bn,Ni=Math.max(Le+En,1e-5);Cr.push(new Ld(It/Dn,Sn/Dn,kn/Dn)),kr.push(new Ld(Qn/Ni,Or/Ni,Ci/Ni))}zt.push(Cr),wn.push(kr)}return[zt,wn]})(tt,Ke,Qe,dt,ft)})(x,h,U,L,R,b,ue,q,te,x.center.lat,u.tileID.canonical),we=u.queryGeometry;return(function(Pe,tt,Ke){let Qe=1/0;ba(Ke,tt)&&(Qe=C(Ke,tt[0]));for(let dt=0;dt<tt.length;dt++){const ft=tt[dt],Ft=Pe[dt];for(let xt=0;xt<ft.length-1;xt++){const Wt=ft[xt],bn=[Wt,ft[xt+1],Ft[xt+1],Ft[xt],Wt];fs(Ke,bn)&&(Qe=Math.min(Qe,C(Ke,bn)))}}return Qe!==1/0&&Qe})(ge,Se,we.isPointQuery()?we.screenBounds:we.screenGeometry)}},building:class extends al{constructor(u,i,l,h){super(u,{layout:hB||(hB=new ra({visibility:new fn(yt.layout_building.visibility),"building-facade":new Ln(yt.layout_building["building-facade"]),"building-facade-floors":new Ln(yt.layout_building["building-facade-floors"]),"building-facade-window":new Ln(yt.layout_building["building-facade-window"]),"building-roof-shape":new Ln(yt.layout_building["building-roof-shape"]),"building-height":new Ln(yt.layout_building["building-height"]),"building-base":new Ln(yt.layout_building["building-base"])})),paint:fB||(fB=new ra({"building-opacity":new fn(yt.paint_building["building-opacity"]),"building-ambient-occlusion-intensity":new fn(yt.paint_building["building-ambient-occlusion-intensity"]),"building-ambient-occlusion-ground-intensity":new fn(yt.paint_building["building-ambient-occlusion-ground-intensity"]),"building-ambient-occlusion-ground-radius":new fn(yt.paint_building["building-ambient-occlusion-ground-radius"]),"building-ambient-occlusion-ground-attenuation":new fn(yt.paint_building["building-ambient-occlusion-ground-attenuation"]),"building-vertical-scale":new fn(yt.paint_building["building-vertical-scale"]),"building-cast-shadows":new fn(yt.paint_building["building-cast-shadows"]),"building-color":new Ln(yt.paint_building["building-color"]),"building-emissive-strength":new Ln(yt.paint_building["building-emissive-strength"]),"building-facade-emissive-chance":new fn(yt.paint_building["building-facade-emissive-chance"]),"building-cutoff-fade-range":new fn(yt.paint_building["building-cutoff-fade-range"]),"building-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"})}))},i,l,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new dB(u)}hasShadowPass(){return this.paint.get("building-cast-shadows")}hasLightBeamPass(){return!0}canCastShadows(){return!0}is3D(u){return!0}},line:class extends al{constructor(u,i,l,h){const g=SB();super(u,g,i,l,h),g.layout&&(this.layout=new qc(g.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof gd,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(u,i){super.recalculate(u,i),this.paint._values["line-floorwidth"]=(()=>{if(Fw)return Fw;const l=SB();return Fw=new zie(l.paint.properties["line-width"].specification),Fw.useIntegerZoom=!0,Fw})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new EN(u)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(u,i,l){const h=bB(this);return{config:new ol(this,{zoom:i,lut:l}),defines:h,overrideFog:!1}}queryRadius(u){const i=u,l=TB(So("line-width",this,i),So("line-gap-width",this,i)),h=So("line-offset",this,i);return l/2+Math.abs(h)+ma(this.paint.get("line-translate"))}queryIntersectsFeature(u,i,l,h,g,x){if(u.queryGeometry.isAboveHorizon)return!1;const b=Vl(u.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,u.pixelToTileUnitsFactor),j=u.pixelToTileUnitsFactor/2*TB(this.paint.get("line-width").evaluate(i,l),this.paint.get("line-gap-width").evaluate(i,l)),M=this.paint.get("line-offset").evaluate(i,l);return M&&(h=(function(R,L){const U=[],q=new Rt(0,0);for(let ee=0;ee<R.length;ee++){const te=R[ee],le=[];for(let ue=0;ue<te.length;ue++){const ge=te[ue],Se=te[ue+1],we=ue===0?q:ge.sub(te[ue-1])._unit()._perp(),Pe=ue===te.length-1?q:Se.sub(ge)._unit()._perp(),tt=we._add(Pe)._unit();tt._mult(1/(tt.x*Pe.x+tt.y*Pe.y)),le.push(tt._mult(L)._add(ge))}U.push(le)}return U})(h,M*u.pixelToTileUnitsFactor)),(function(R,L,U){for(let q=0;q<L.length;q++){const ee=L[q];if(R.length>=3){for(let te=0;te<ee.length;te++)if(Ha(R,ee[te]))return!0}if(pa(R,ee,U))return!0}return!1})(b,h,j)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(u){return!this.hasElevatedBuckets||this.layout&&this.layout.get("line-elevation-reference")==="hd-road-markup"}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:D2,background:class extends al{constructor(u,i,l,h){super(u,{layout:m4||(m4=new ra({visibility:new fn(yt.layout_background.visibility)})),paint:g4||(g4=new ra({"background-pitch-alignment":new fn(yt.paint_background["background-pitch-alignment"]),"background-color":new fn(yt.paint_background["background-color"]),"background-pattern":new fn(yt.paint_background["background-pattern"]),"background-opacity":new fn(yt.paint_background["background-opacity"]),"background-emissive-strength":new fn(yt.paint_background["background-emissive-strength"]),"background-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"})}))},i,l,h)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(u,i,l){return{overrideFog:!1}}is3D(u){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:b4,"raster-particle":E4,sky:class extends al{constructor(u,i,l,h){super(u,{layout:T4||(T4=new ra({visibility:new fn(yt.layout_sky.visibility)})),paint:A4||(A4=new ra({"sky-type":new fn(yt.paint_sky["sky-type"]),"sky-atmosphere-sun":new fn(yt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new fn(yt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new fn(yt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new fn(yt.paint_sky["sky-gradient-radius"]),"sky-gradient":new lf(yt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new fn(yt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new fn(yt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new fn(yt.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"})}))},i,l,h),this._updateColorRamp()}_clear(){this.skyboxFbo&&(this.skyboxFbo.destroy(),this.skyboxFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this._skyboxInvalidated=!0}_handleSpecialPaintPropertyUpdate(u){u==="sky-gradient"?this._updateColorRamp():u!=="sky-atmosphere-sun"&&u!=="sky-atmosphere-halo-color"&&u!=="sky-atmosphere-color"&&u!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Mp({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(u){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=u.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}return!1}getCenter(u,i){if(this.paint.get("sky-type")==="atmosphere"){const h=this.paint.get("sky-atmosphere-sun"),g=!h,x=u.style.light,b=x.properties.get("position");return g&&x.properties.get("anchor")==="viewport"&&ai("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),g?GN(b.azimuthal,90-b.polar,i):GN(h[0],90-h[1],i)}const l=this.paint.get("sky-gradient-center");return GN(l[0],90-l[1],i)}isSky(){return!0}markSkyboxValid(u){this._skyboxInvalidated=!1,this._lightPosition=u.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const u=this.paint.get("sky-type");return u==="atmosphere"?["skyboxCapture","skybox"]:u==="gradient"?["skyboxGradient"]:null}},slot:class extends al{constructor(u,i,l,h){super(u,{paint:j4||(j4=new ra({}))},i,null)}},model:class extends al{constructor(u,i,l,h){super(u,{layout:M4||(M4=new ra({visibility:new fn(yt.layout_model.visibility),"model-id":new Ln(yt.layout_model["model-id"])})),paint:R4||(R4=new ra({"model-opacity":new Ln(yt.paint_model["model-opacity"]),"model-rotation":new Ln(yt.paint_model["model-rotation"]),"model-scale":new Ln(yt.paint_model["model-scale"]),"model-translation":new Ln(yt.paint_model["model-translation"]),"model-color":new Ln(yt.paint_model["model-color"]),"model-color-mix-intensity":new Ln(yt.paint_model["model-color-mix-intensity"]),"model-type":new fn(yt.paint_model["model-type"]),"model-cast-shadows":new fn(yt.paint_model["model-cast-shadows"]),"model-receive-shadows":new fn(yt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new fn(yt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Ln(yt.paint_model["model-emissive-strength"]),"model-roughness":new Ln(yt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Ln(yt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new fn(yt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new fn(yt.paint_model["model-front-cutoff"]),"model-color-use-theme":new Ln({type:"string",default:"default","property-type":"data-driven"})}))},i,l,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new XN(u)}getProgramIds(){return["model"]}is3D(u){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(u){return u instanceof z2?mn-1:0}queryIntersectsFeature(u,i,l,h,g,x){if(!this.modelManager)return!1;const b=this.modelManager,j=u.tile.getBucket(this);if(!(j&&j instanceof XN))return!1;for(const M in j.instancesPerModel){const R=j.instancesPerModel[M],L=i.id!==void 0?i.id:i.properties&&i.properties.hasOwnProperty("id")?i.properties.id:void 0;if(R.idToFeaturesIndex.hasOwnProperty(L)){const U=R.features[R.idToFeaturesIndex[L]],q=b.getModel(M,this.scope);if(!q)return!1;let ee=$();const te=new G(0,0),le=j.canonical;let ue=Number.MAX_VALUE;for(let ge=0;ge<U.instancedDataCount;++ge){const Se=16*(U.instancedDataOffset+ge),we=R.instancedDataArray.float32,Pe=[we[Se+4],we[Se+5],we[Se+6]];L4(le,te,we[Se],0|we[Se+1]),iB(ee,q,x,te,U.rotation,U.scale,Pe,!1,!1,!1),x.projection.name==="globe"&&(ee=wN(ee,x));const tt=K([],x.projMatrix,ee),Ke=u.queryGeometry,Qe=rB(Ke.isPointQuery()?Ke.screenBounds:Ke.screenGeometry,x,tt,q.aabb);Qe!=null&&(ue=Math.min(Qe,ue))}return ue!==Number.MAX_VALUE&&ue}}return!1}_handleOverridablePaintPropertyUpdate(u,i,l){return!(!this.layout||i.isDataDriven()||l.isDataDriven()||u!=="model-color"&&u!=="model-color-mix-intensity"&&u!=="model-rotation"&&u!=="model-scale"&&u!=="model-translation"&&u!=="model-emissive-strength")}_isPropertyZoomDependent(u){const i=this._transitionablePaint._values[u];return i!=null&&i.value!=null&&i.value.expression!=null&&i.value.expression instanceof cu}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends al{constructor(u,i,l,h){super(u,{layout:ww||(ww=new ra({"clip-layer-types":new fn(yt.layout_clip["clip-layer-types"]),"clip-layer-scope":new fn(yt.layout_clip["clip-layer-scope"])})),paint:ig||(ig=new ra({}))},i,l,h)}recalculate(u,i){super.recalculate(u,i)}createBucket(u){return new s2(u)}is3D(u){return!0}}},YN=new ns(0,0,0),KN={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},JN={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},F2={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},Use={PAINT_ORDER_FILL_AND_STROKE:1},Jw={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},z4={MASK_TYPE_LUMINANCE:1};function Vse(u,i,l){u===1&&i.icons.push((function(h,g){return(function(x){if(x.usvg_tree.height||(x.usvg_tree.height=x.usvg_tree.width),!x.metadata)return x;const{metadata:b}=x;if(b.content_area){const{content_area:j}=b;j.top==null&&(j.top=j.left),j.width==null&&(j.width=x.usvg_tree.width),j.height==null&&(j.height=j.width)}return b.stretch_x&&b.stretch_x.length&&F4(b,"x"),b.stretch_y&&b.stretch_y.length&&F4(b,"y"),x})(h.readFields($se,{name:void 0},g))})(l,l.readVarint()+l.pos))}function F4(u,i){const l=[],h=u[`stretch_${i}`];let g=null;for(let x=0;x<h.length;x++)g===null?g=l.length===0?h[0]:l[l.length-1][1]+h[x]:(l.push([g,g+h[x]]),g=null);u[`stretch_${i}_areas`]=l}function $se(u,i,l){u===1?i.name=l.readString():u===2?i.metadata=(function(h,g){return h.readFields(qse,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},g)})(l,l.readVarint()+l.pos):u===3&&(i.usvg_tree=(function(h,g){return h.readFields(Wse,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},g)})(l,l.readVarint()+l.pos),i.data="usvg_tree")}function qse(u,i,l){u===1?i.stretch_x=l.readPackedVarint():u===2?i.stretch_y=l.readPackedVarint():u===3?i.content_area=(function(h,g){return h.readFields(Hse,{left:0},g)})(l,l.readVarint()+l.pos):u===4&&i.variables.push((function(h,g){return h.readFields(Gse,{name:void 0},g)})(l,l.readVarint()+l.pos))}function Hse(u,i,l){u===1?i.left=l.readVarint():u===2?i.width=l.readVarint():u===3?i.top=l.readVarint():u===4&&(i.height=l.readVarint())}function Gse(u,i,l){u===1?i.name=l.readString():u===2&&(i.rgb_color=V2(l.readVarint()),i.value="rgb_color")}function Wse(u,i,l){u===1?i.width=i.height=l.readVarint():u===2?i.height=l.readVarint():u===3?i.children.push(B2(l,l.readVarint()+l.pos)):u===4?i.linear_gradients.push((function(h,g){return h.readFields(eae,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},g)})(l,l.readVarint()+l.pos)):u===5?i.radial_gradients.push((function(h,g){return h.readFields(nae,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},g)})(l,l.readVarint()+l.pos)):u===7?i.clip_paths.push((function(h,g){return h.readFields(rae,{children:[]},g)})(l,l.readVarint()+l.pos)):u===8&&i.masks.push((function(h,g){const x=h.readFields(iae,{left:0,width:20,mask_type:z4.MASK_TYPE_LUMINANCE,children:[]},g);return x.height==null&&(x.height=x.width),x.top==null&&(x.top=x.left),x})(l,l.readVarint()+l.pos))}function B2(u,i){return u.readFields(Xse,{},i)}function Xse(u,i,l){u===1?(i.group=(function(h,g){return h.readFields(Zse,{opacity:255,children:[]},g)})(l,l.readVarint()+l.pos),i.node="group"):u===2&&(i.path=(function(h,g){return h.readFields(Kse,{paint_order:1,commands:[],step:1,diffs:[],rule:KN.PATH_RULE_NON_ZERO},g)})(l,l.readVarint()+l.pos),i.node="path")}function Zse(u,i,l){u===1?i.transform=U2(l,l.readVarint()+l.pos):u===2?i.opacity=l.readVarint():u===5?i.clip_path_idx=l.readVarint():u===6?i.mask_idx=l.readVarint():u===7&&i.children.push(B2(l,l.readVarint()+l.pos))}function U2(u,i){return u.readFields(Yse,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},i)}function Yse(u,i,l){u===1?i.sx=l.readFloat():u===2?i.ky=l.readFloat():u===3?i.kx=l.readFloat():u===4?i.sy=l.readFloat():u===5?i.tx=l.readFloat():u===6&&(i.ty=l.readFloat())}function Kse(u,i,l){u===1?i.fill=(function(h,g){return h.readFields(Jse,{rgb_color:YN,paint:"rgb_color",opacity:255},g)})(l,l.readVarint()+l.pos):u===2?i.stroke=(function(h,g){return h.readFields(Qse,{rgb_color:YN,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},g)})(l,l.readVarint()+l.pos):u===3?i.paint_order=l.readVarint():u===5?l.readPackedVarint(i.commands):u===6?i.step=l.readFloat():u===7?l.readPackedSVarint(i.diffs):u===8&&(i.rule=l.readVarint())}function Jse(u,i,l){u===1?(i.rgb_color=V2(l.readVarint()),i.paint="rgb_color"):u===2?(i.linear_gradient_idx=l.readVarint(),i.paint="linear_gradient_idx"):u===3?(i.radial_gradient_idx=l.readVarint(),i.paint="radial_gradient_idx"):u===5&&(i.opacity=l.readVarint())}function V2(u){return new ns((u>>16&255)/255,(u>>8&255)/255,(255&u)/255,1)}function Qse(u,i,l){u===1?(i.rgb_color=V2(l.readVarint()),i.paint="rgb_color"):u===2?(i.linear_gradient_idx=l.readVarint(),i.paint="linear_gradient_idx"):u===3?(i.radial_gradient_idx=l.readVarint(),i.paint="radial_gradient_idx"):u===5?l.readPackedFloat(i.dasharray):u===6?i.dashoffset=l.readFloat():u===7?i.miterlimit=l.readFloat():u===8?i.opacity=l.readVarint():u===9?i.width=l.readFloat():u===10?i.linecap=l.readVarint():u===11&&(i.linejoin=l.readVarint())}function eae(u,i,l){u===1?i.transform=U2(l,l.readVarint()+l.pos):u===2?i.spread_method=l.readVarint():u===3?i.stops.push(B4(l,l.readVarint()+l.pos)):u===4?i.x1=l.readFloat():u===5?i.y1=l.readFloat():u===6?i.x2=l.readFloat():u===7&&(i.y2=l.readFloat())}function B4(u,i){return u.readFields(tae,{offset:0,opacity:255,rgb_color:YN},i)}function tae(u,i,l){u===1?i.offset=l.readFloat():u===2?i.opacity=l.readVarint():u===3&&(i.rgb_color=V2(l.readVarint()))}function nae(u,i,l){u===1?i.transform=U2(l,l.readVarint()+l.pos):u===2?i.spread_method=l.readVarint():u===3?i.stops.push(B4(l,l.readVarint()+l.pos)):u===4?i.cx=l.readFloat():u===5?i.cy=l.readFloat():u===6?i.r=l.readFloat():u===7?i.fx=l.readFloat():u===8?i.fy=l.readFloat():u===9&&(i.fr=l.readFloat())}function rae(u,i,l){u===1?i.transform=U2(l,l.readVarint()+l.pos):u===2?i.clip_path_idx=l.readVarint():u===3&&i.children.push(B2(l,l.readVarint()+l.pos))}function iae(u,i,l){u===1?i.left=i.top=l.readFloat():u===2?i.width=i.height=l.readFloat():u===3?i.top=l.readFloat():u===4?i.height=l.readFloat():u===5?i.mask_type=l.readVarint():u===6?i.mask_idx=l.readVarint():u===7&&i.children.push(B2(l,l.readVarint()+l.pos))}class sae{static calculate(i={},l=[]){const h=new Map,g=new Map;if(Object.keys(i).length===0)return h;l.forEach((x=>{g.set(x.name,x.rgb_color||new ns(0,0,0))}));for(const[x,b]of Object.entries(i))g.has(x)?h.set(g.get(x).toString(),b):console.warn(`Ignoring unknown image variable "${x}"`);return h}}function l0(u,i=255,l){const h=i/255,g=u.toString(),x=l.has(g)?l.get(g).clone():u.clone();return x.a*=h,x.toString()}function Qw(u,i){if(!sd()){const l=document.createElement("canvas");return l.width=u,l.height=i,l}return new OffscreenCanvas(u,i)}function aae(u,i){const l=sae.calculate(i.params,u.metadata?u.metadata.variables:[]),h=u.usvg_tree,g=h.width,x=h.height,b=i.transform?i.transform:new DOMMatrix,j=Math.max(1,Math.round(g*b.a)),M=Math.max(1,Math.round(x*b.d)),R=new DOMMatrix([j/g,0,0,M/x,0,0]),L=Qw(j,M).getContext("2d");return QN(L,R,h,h,l),L.getImageData(0,0,j,M)}function QN(u,i,l,h,g){for(const x of h.children)U4(u,i,l,x,g)}function U4(u,i,l,h,g){h.group?(u.save(),(function(x,b,j,M,R){const L=M.mask_idx!=null?j.masks[M.mask_idx]:null,U=M.clip_path_idx!=null?j.clip_paths[M.clip_path_idx]:null;if(M.transform&&(b=c0(M.transform).preMultiplySelf(b)),!(function(te,le,ue){return te.opacity!==255||le||ue})(M,U!=null,L!=null))return void QN(x,b,j,M,R);const q=Qw(x.canvas.width,x.canvas.height),ee=q.getContext("2d");QN(ee,b,j,M,R),U&&X4(ee,b,j,U),L&&Z4(ee,b,j,L,R),x.globalAlpha=M.opacity/255,x.drawImage(q,0,0)})(u,i,l,h.group,g),u.restore()):h.path&&(u.save(),(function(x,b,j,M,R){x.setTransform(b),M.paint_order===Use.PAINT_ORDER_FILL_AND_STROKE?(V4(x,j,M,R),q4(x,j,M,R)):(q4(x,j,M,R),V4(x,j,M,R))})(u,i,l,h.path,g),u.restore())}function V4(u,i,l,h){const g=l.fill;if(!g)return;const x=g.opacity/255;switch(u.save(),u.beginPath(),Y4(l,u),g.paint){case"rgb_color":u.fillStyle=l0(g.rgb_color,g.opacity,h);break;case"linear_gradient_idx":{const b=i.linear_gradients[g.linear_gradient_idx];b.transform&&u.setTransform(c0(b.transform).preMultiplySelf(u.getTransform())),u.fillStyle=H4(u,b,x,h);break}case"radial_gradient_idx":{const b=i.radial_gradients[g.radial_gradient_idx];b.transform&&u.setTransform(c0(b.transform).preMultiplySelf(u.getTransform())),u.fillStyle=G4(u,b,x,h)}}u.fill($4(l)),u.restore()}function $4(u){return u.rule===KN.PATH_RULE_NON_ZERO?"nonzero":u.rule===KN.PATH_RULE_EVEN_ODD?"evenodd":void 0}function q4(u,i,l,h){const g=l.stroke;if(!g)return;const x=K4(l);u.lineWidth=g.width,u.miterLimit=g.miterlimit,u.setLineDash(g.dasharray),u.lineDashOffset=g.dashoffset;const b=g.opacity/255;switch(g.paint){case"rgb_color":u.strokeStyle=l0(g.rgb_color,g.opacity,h);break;case"linear_gradient_idx":u.strokeStyle=H4(u,i.linear_gradients[g.linear_gradient_idx],b,h,!0);break;case"radial_gradient_idx":u.strokeStyle=G4(u,i.radial_gradients[g.radial_gradient_idx],b,h,!0)}switch(g.linejoin){case F2.LINE_JOIN_MITER_CLIP:case F2.LINE_JOIN_MITER:u.lineJoin="miter";break;case F2.LINE_JOIN_ROUND:u.lineJoin="round";break;case F2.LINE_JOIN_BEVEL:u.lineJoin="bevel"}switch(g.linecap){case JN.LINE_CAP_BUTT:u.lineCap="butt";break;case JN.LINE_CAP_ROUND:u.lineCap="round";break;case JN.LINE_CAP_SQUARE:u.lineCap="square"}u.stroke(x)}function H4(u,i,l,h,g=!1){if(i.stops.length===1){const q=i.stops[0];return l0(q.rgb_color,q.opacity*l,h)}const{x1:x,y1:b,x2:j,y2:M}=i;let R=new DOMPoint(x,b),L=new DOMPoint(j,M);if(g){const q=c0(i.transform);R=q.transformPoint(R),L=q.transformPoint(L)}const U=u.createLinearGradient(R.x,R.y,L.x,L.y);for(const q of i.stops)U.addColorStop(q.offset,l0(q.rgb_color,q.opacity*l,h));return U}function G4(u,i,l,h,g=!1){if(i.stops.length===1){const ge=i.stops[0];return l0(ge.rgb_color,ge.opacity*l,h)}const x=c0(i.transform),{fx:b,fy:j,fr:M,cx:R,cy:L,r:U}=i;let q=new DOMPoint(b,j),ee=new DOMPoint(R,L),te=M,le=U;if(g){q=x.transformPoint(q),ee=x.transformPoint(ee);const ge=(x.a+x.d)/2;te=M*ge,le=i.r*ge}const ue=u.createRadialGradient(q.x,q.y,te,ee.x,ee.y,le);for(const ge of i.stops)ue.addColorStop(ge.offset,l0(ge.rgb_color,ge.opacity*l,h));return ue}function W4(u,i,l,h){const g=h.transform?c0(h.transform).preMultiplySelf(i):i,x=Qw(u.canvas.width,u.canvas.height),b=x.getContext("2d");for(const M of h.children)if(M.group)W4(b,g,l,M.group);else if(M.path){const R=M.path,L=new Path2D;L.addPath(K4(R),g),b.fill(L,$4(R))}const j=h.clip_path_idx!=null?l.clip_paths[h.clip_path_idx]:null;j&&X4(b,g,l,j),u.globalCompositeOperation="source-over",u.drawImage(x,0,0)}function X4(u,i,l,h){const g=Qw(u.canvas.width,u.canvas.height);W4(g.getContext("2d"),i,l,h),u.globalCompositeOperation="destination-in",u.drawImage(g,0,0)}function Z4(u,i,l,h,g){if(h.children.length===0)return;const x=h.mask_idx!=null?l.masks[h.mask_idx]:null;x&&Z4(u,i,l,x,g);const b=u.canvas.width,j=u.canvas.height,M=Qw(b,j),R=M.getContext("2d"),L=h.width,U=h.height,q=h.left,ee=h.top,te=new Path2D,le=new Path2D;le.rect(q,ee,L,U),te.addPath(le,i),R.clip(te);for(const Se of h.children)U4(R,i,l,Se,g);const ue=R.getImageData(0,0,b,j),ge=ue.data;if(h.mask_type===z4.MASK_TYPE_LUMINANCE)for(let Se=0;Se<ge.length;Se+=4)ge[Se+3]=ge[Se+3]/255*(.2126*ge[Se]+.7152*ge[Se+1]+.0722*ge[Se+2]);R.putImageData(ue,0,0),u.globalCompositeOperation="destination-in",u.drawImage(M,0,0)}function c0(u){return u?new DOMMatrix([u.sx,u.ky,u.kx,u.sy,u.tx,u.ty]):new DOMMatrix}function Y4(u,i){const l=u.step;let h=u.diffs[0]*l,g=u.diffs[1]*l;i.moveTo(h,g);for(let x=0,b=2;x<u.commands.length;x++)switch(u.commands[x]){case Jw.PATH_COMMAND_MOVE:h+=u.diffs[b++]*l,g+=u.diffs[b++]*l,i.moveTo(h,g);break;case Jw.PATH_COMMAND_LINE:h+=u.diffs[b++]*l,g+=u.diffs[b++]*l,i.lineTo(h,g);break;case Jw.PATH_COMMAND_QUAD:{const j=h+u.diffs[b++]*l,M=g+u.diffs[b++]*l;h=j+u.diffs[b++]*l,g=M+u.diffs[b++]*l,i.quadraticCurveTo(j,M,h,g);break}case Jw.PATH_COMMAND_CUBIC:{const j=h+u.diffs[b++]*l,M=g+u.diffs[b++]*l,R=j+u.diffs[b++]*l,L=M+u.diffs[b++]*l;h=R+u.diffs[b++]*l,g=L+u.diffs[b++]*l,i.bezierCurveTo(j,M,R,L,h,g);break}case Jw.PATH_COMMAND_CLOSE:i.closePath()}return i}function K4(u){return Y4(u,new Path2D)}class $2{constructor(i){this.capacity=i,this.cache=new Map}get(i){if(!this.cache.has(i))return;const l=this.cache.get(i);return this.cache.delete(i),this.cache.set(i,l),l}put(i,l){this.cache.has(i)?this.cache.delete(i):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(i,l)}delete(i){this.cache.delete(i)}}Hn($2,"LRUCache");class eP{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(i){return new Oo(i,i.data)}getFromCache(i,l,h){return this.cacheMap.has(h)||this.cacheMap.set(h,new $2(150)),this.cacheMap.get(h).get(_h(i.toString(),l))}setInCache(i,l,h,g){this.cacheDependenciesMap.has(g)||this.cacheDependenciesMap.set(g,new Map),this.cacheMap.has(g)||this.cacheMap.set(g,new $2(150));const x=this.cacheDependenciesMap.get(g),b=_h(i.id.toString(),h);x.get(b)||x.set(b,new Set);const j=this.cacheMap.get(g),M=i.toString();x.get(b).add(M),j.put(_h(i.toString(),h),l)}removeImagesFromCacheByIds(i,l,h=0){if(!this.cacheMap.has(h)||!this.cacheDependenciesMap.has(h))return;const g=this.cacheMap.get(h),x=this.cacheDependenciesMap.get(h);for(const b of i){const j=_h(b.toString(),l);if(x.has(j)){for(const M of x.get(j))g.delete(M);x.delete(j)}}}rasterize(i,l,h,g,x=aae){const b=this.getFromCache(i,h,g);if(b)return b.clone();const j=x(l.icon,i.options),M=eP._getImage(j);return this.setInCache(i,M,h,g),M.clone()}}class J4{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,l){const h=this.toIdx(i,l);return{min:this.minimums[h],max:this.maximums[h]}}isLeaf(i,l){return this.leaves[this.toIdx(i,l)]}toIdx(i,l){return l*this.size+i}}function Q4(u,i,l,h){let g=0,x=Number.MAX_VALUE;for(let b=0;b<3;b++)if(Math.abs(h[b])<1e-15){if(l[b]<u[b]||l[b]>i[b])return null}else{const j=1/h[b];let M=(u[b]-l[b])*j,R=(i[b]-l[b])*j;if(M>R){const L=M;M=R,R=L}if(M>g&&(g=M),R<x&&(x=R),g>x)return null}return g}function e5(u,i,l,h,g,x,b,j,M,R,L){const U=h-u,q=g-i,ee=x-l,te=b-u,le=j-i,ue=M-l,ge=L[1]*ue-L[2]*le,Se=L[2]*te-L[0]*ue,we=L[0]*le-L[1]*te,Pe=U*ge+q*Se+ee*we;if(Math.abs(Pe)<1e-15)return null;const tt=1/Pe,Ke=R[0]-u,Qe=R[1]-i,dt=R[2]-l,ft=(Ke*ge+Qe*Se+dt*we)*tt;if(ft<0||ft>1)return null;const Ft=Qe*ee-dt*q,xt=dt*U-Ke*ee,Wt=Ke*q-Qe*U,bn=(L[0]*Ft+L[1]*xt+L[2]*Wt)*tt;return bn<0||ft+bn>1?null:(te*Ft+le*xt+ue*Wt)*tt}function t5(u,i,l){return(u-i)/(l-i)}function n5(u,i,l,h,g,x,b,j,M){const R=1<<l,L=x-h,U=b-g,q=(u+1)/R*L+h,ee=(i+0)/R*U+g,te=(i+1)/R*U+g;j[0]=(u+0)/R*L+h,j[1]=ee,M[0]=q,M[1]=te}class r5{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=(function(x){const b=Math.ceil(Math.log2(x.dim/8)),j=[];let M=Math.ceil(Math.pow(2,b));const R=1/M,L=(ee,te,le,ue,ge)=>{const Se=ue?1:0,we=(ee+1)*le-Se,Pe=te*le,tt=(te+1)*le-Se;ge[0]=ee*le,ge[1]=Pe,ge[2]=we,ge[3]=tt};let U=new J4(M);const q=[];for(let ee=0;ee<M*M;ee++){L(ee%M,Math.floor(ee/M),R,!1,q);const te=Iy(q[0],q[1],x),le=Iy(q[2],q[1],x),ue=Iy(q[2],q[3],x),ge=Iy(q[0],q[3],x);U.minimums.push(Math.min(te,le,ue,ge)),U.maximums.push(Math.max(te,le,ue,ge)),U.leaves.push(1)}for(j.push(U),M/=2;M>=1;M/=2){const ee=j[j.length-1];U=new J4(M);for(let te=0;te<M*M;te++){L(te%M,Math.floor(te/M),2,!0,q);const le=ee.getElevation(q[0],q[1]),ue=ee.getElevation(q[2],q[1]),ge=ee.getElevation(q[2],q[3]),Se=ee.getElevation(q[0],q[3]),we=ee.isLeaf(q[0],q[1]),Pe=ee.isLeaf(q[2],q[1]),tt=ee.isLeaf(q[2],q[3]),Ke=ee.isLeaf(q[0],q[3]),Qe=Math.min(le.min,ue.min,ge.min,Se.min),dt=Math.max(le.max,ue.max,ge.max,Se.max),ft=we&&Pe&&tt&&Ke;U.maximums.push(dt),U.minimums.push(Qe),U.leaves.push(dt-Qe<=5&&ft?1:0)}j.push(U)}return j})(this.dem),h=l.length-1,g=l[h];this._addNode(g.minimums[0],g.maximums[0],g.leaves[0]),this._construct(l,0,0,h,0)}raycastRoot(i,l,h,g,x,b,j=1){return Q4([i,l,-100],[h,g,this.maximums[0]*j],x,b)}raycast(i,l,h,g,x,b,j=1){if(!this.nodeCount)return null;const M=this.raycastRoot(i,l,h,g,x,b,j);if(M==null)return null;const R=[],L=[],U=[],q=[],ee=[{idx:0,t:M,nodex:0,nodey:0,depth:0}];for(;ee.length>0;){const{idx:te,t:le,nodex:ue,nodey:ge,depth:Se}=ee.pop();if(this.leaves[te]){n5(ue,ge,Se,i,l,h,g,U,q);const Pe=1<<Se,tt=(ue+0)/Pe,Ke=(ue+1)/Pe,Qe=(ge+0)/Pe,dt=(ge+1)/Pe,ft=Iy(tt,Qe,this.dem)*j,Ft=Iy(Ke,Qe,this.dem)*j,xt=Iy(Ke,dt,this.dem)*j,Wt=Iy(tt,dt,this.dem)*j,bn=e5(U[0],U[1],ft,q[0],U[1],Ft,q[0],q[1],xt,x,b),tn=e5(q[0],q[1],xt,U[0],q[1],Wt,U[0],U[1],ft,x,b),dn=Math.min(bn!==null?bn:Number.MAX_VALUE,tn!==null?tn:Number.MAX_VALUE);if(dn!==Number.MAX_VALUE)return dn;{const xn=We([],x,b,le);if(i5(ft,Ft,Wt,xt,t5(xn[0],U[0],q[0]),t5(xn[1],U[1],q[1]))>=xn[2])return le}continue}let we=0;for(let Pe=0;Pe<this._siblingOffset.length;Pe++){n5((ue<<1)+this._siblingOffset[Pe][0],(ge<<1)+this._siblingOffset[Pe][1],Se+1,i,l,h,g,U,q),U[2]=-100,q[2]=this.maximums[this.childOffsets[te]+Pe]*j;const tt=Q4(U,q,x,b);if(tt!=null){const Ke=tt;R[Pe]=Ke;let Qe=!1;for(let dt=0;dt<we&&!Qe;dt++)Ke>=R[L[dt]]&&(L.splice(dt,0,Pe),Qe=!0);Qe||(L[we]=Pe),we++}}for(let Pe=0;Pe<we;Pe++){const tt=L[Pe];ee.push({idx:this.childOffsets[te]+tt,t:R[tt],nodex:(ue<<1)+this._siblingOffset[tt][0],nodey:(ge<<1)+this._siblingOffset[tt][1],depth:Se+1})}}return null}_addNode(i,l,h){return this.minimums.push(i),this.maximums.push(l),this.leaves.push(h),this.childOffsets.push(0),this.nodeCount++}_construct(i,l,h,g,x){if(i[g].isLeaf(l,h)===1)return;this.childOffsets[x]||(this.childOffsets[x]=this.nodeCount);const b=g-1,j=i[b];let M=0,R=0;for(let L=0;L<this._siblingOffset.length;L++){const U=2*l+this._siblingOffset[L][0],q=2*h+this._siblingOffset[L][1],ee=j.getElevation(U,q),te=j.isLeaf(U,q),le=this._addNode(ee.min,ee.max,te);te&&(M|=1<<L),R||(R=le)}for(let L=0;L<this._siblingOffset.length;L++)M&1<<L||this._construct(i,2*l+this._siblingOffset[L][0],2*h+this._siblingOffset[L][1],b,R+L)}}function i5(u,i,l,h,g,x){return yr(yr(u,l,x),yr(i,h,x),g)}function Iy(u,i,l){const h=l.dim,g=Oe(u*h-.5,0,h-1),x=Oe(i*h-.5,0,h-1),b=Math.floor(g),j=Math.floor(x),M=Math.min(b+1,h-1),R=Math.min(j+1,h-1);return i5(l.get(b,j),l.get(M,j),l.get(b,R),l.get(M,R),g-b,x-j)}const oae={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function lae(u,i,l){return(256*u*256+256*i+l)/10-1e4}function cae(u,i,l){return 256*u+i+l/256-32768}class q2{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,l,h,g=!1){if(this.uid=i,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return void ai(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const x=this.dim=l.height-2,b=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.floatView=new Float32Array(l.data.buffer),this.borderReady=g,this._modifiedForSources={},!g){for(let M=0;M<x;M++)b[this._idx(-1,M)]=b[this._idx(0,M)],b[this._idx(x,M)]=b[this._idx(x-1,M)],b[this._idx(M,-1)]=b[this._idx(M,0)],b[this._idx(M,x)]=b[this._idx(M,x-1)];b[this._idx(-1,-1)]=b[this._idx(0,0)],b[this._idx(x,-1)]=b[this._idx(x-1,0)],b[this._idx(-1,x)]=b[this._idx(0,x-1)],b[this._idx(x,x)]=b[this._idx(x-1,x-1)]}const j=h==="terrarium"?cae:lae;for(let M=0;M<b.length;++M){const R=4*M;this.floatView[M]=j(this.pixels[R],this.pixels[R+1],this.pixels[R+2])}this._timestamp=co.now()}_buildQuadTree(){this._tree=new r5(this)}get(i,l,h=!1){h&&(i=Oe(i,-1,this.dim),l=Oe(l,-1,this.dim));const g=this._idx(i,l);return this.floatView[g]}set(i,l,h){const g=this._idx(i,l),x=this.floatView[g];return this.floatView[g]=h,h-x}static getUnpackVector(i){return oae[i]}_idx(i,l){if(i<-1||i>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(i+1)}static pack(i,l){const h=[0,0,0,0],g=q2.getUnpackVector(l);let x=Math.floor((i+g[3])/g[2]);return h[2]=x%256,x=Math.floor(x/256),h[1]=x%256,x=Math.floor(x/256),h[0]=x,h}getPixels(){return new Sy({width:this.stride,height:this.stride},this.pixels)}backfillBorder(i,l,h){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let g=l*this.dim,x=l*this.dim+this.dim,b=h*this.dim,j=h*this.dim+this.dim;switch(l){case-1:g=x-1;break;case 1:x=g+1}switch(h){case-1:b=j-1;break;case 1:j=b+1}const M=-l*this.dim,R=-h*this.dim;for(let L=b;L<j;L++)for(let U=g;U<x;U++){const q=4*this._idx(U,L),ee=4*this._idx(U+M,L+R);this.pixels[q+0]=i.pixels[ee+0],this.pixels[q+1]=i.pixels[ee+1],this.pixels[q+2]=i.pixels[ee+2],this.pixels[q+3]=i.pixels[ee+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function uae(u,i,l){u===1?i.headerLength=l.readFixed32():u===2?i.x=l.readVarint():u===3?i.y=l.readVarint():u===4?i.z=l.readVarint():u===5&&i.layers.push((function(h,g){return h.readFields(mae,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},g)})(l,l.readVarint()+l.pos))}function dae(u,i,l){u===1?(i.delta_filter=(function(h,g){return h.readFields(hae,{blockSize:0},g)})(l,l.readVarint()+l.pos),i.filter="delta_filter"):u===2?(l.readVarint(),i.filter="zigzag_filter"):u===3?(l.readVarint(),i.filter="bitshuffle_filter"):u===4&&(l.readVarint(),i.filter="byteshuffle_filter")}function hae(u,i,l){u===1&&(i.blockSize=l.readVarint())}function fae(u,i,l){u===1?(l.readVarint(),i.codec="gzip_data"):u===2?(l.readVarint(),i.codec="jpeg_image"):u===3?(l.readVarint(),i.codec="webp_image"):u===4&&(l.readVarint(),i.codec="png_image")}function pae(u,i,l){let h=0,g=0;u===1?i.firstByte=l.readFixed64():u===2?i.lastByte=l.readFixed64():u===3?i.filters.push((function(x,b){return x.readFields(dae,{},b)})(l,l.readVarint()+l.pos)):u===4?i.codec=(function(x,b){return x.readFields(fae,{},b)})(l,l.readVarint()+l.pos):u===5?g=l.readFloat():u===6?h=l.readFloat():u===7?i.bands.push(l.readString()):u===8?i.offset=l.readDouble():u===9&&(i.scale=l.readDouble()),i.offset===0&&(i.offset=g),i.scale===0&&(i.scale=h)}function mae(u,i,l){u===1?i.version=l.readVarint():u===2?i.name=l.readString():u===3?i.units=l.readString():u===4?i.tileSize=l.readVarint():u===5?i.buffer=l.readVarint():u===6?i.pixelFormat=l.readVarint():u===7&&i.dataIndex.push((function(h,g){return h.readFields(pae,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},g)})(l,l.readVarint()+l.pos))}function gae(u,i,l){if(u===2)(function(h,g,x){h.readFields(yae,x,g)})(l,l.readVarint()+l.pos,i);else if(u===3)throw new Error("Not implemented")}function yae(u,i,l){if(u===1){let h=0;const g=l.readVarint()+l.pos;for(;l.pos<g;)i[h++]=l.readVarint()}}function vae(u,i){if(i.length!==4)throw new Error(`Expected data of dimension 4 but got ${i.length}.`);let l=i[3];for(let h=2;h>=1;h--){const g=h===1?1:0,x=h===2?1:0;for(let b=0;b<i[0];b++){const j=i[1]*b;for(let M=g;M<i[1];M++){const R=i[2]*(M+j);for(let L=x;L<i[2];L++){const U=i[3]*(L+R);for(let q=0;q<i[3];q++){const ee=U+q;u[ee]+=u[ee-l]}}}}l*=i[h]}return u}function xae(u){for(let i=0,l=u.length;i<l;i++)u[i]=u[i]>>>1^-(1&u[i]);return u}function _ae(u,i){switch(i){case"uint32":return u;case"uint16":for(let l=0;l<u.length;l+=2){const h=u[l],g=u[l+1];u[l]=(240&h)>>4|(61440&h)>>8|(240&g)<<4|61440&g,u[l+1]=15&h|(3840&h)>>4|(15&g)<<8|(3840&g)<<4}return u;case"uint8":for(let l=0;l<u.length;l+=4){const h=u[l],g=u[l+1],x=u[l+2],b=u[l+3];u[l+0]=(192&h)>>6|(192&g)>>4|(192&x)>>2|192&b,u[l+1]=(48&h)>>4|(48&g)>>2|48&x|(48&b)<<2,u[l+2]=(12&h)>>2|12&g|(12&x)<<2|(12&b)<<4,u[l+3]=3&h|(3&g)<<2|(3&x)<<4|(3&b)<<6}return u;default:throw new Error(`Invalid pixel format, "${i}"`)}}Hn(q2,"DEMData"),Hn(r5,"DemMinMaxQuadTree",{omit:["dem"]});var Fd=Uint8Array,e1=Uint16Array,bae=Int32Array,s5=new Fd([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),a5=new Fd([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),wae=new Fd([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o5=function(u,i){for(var l=new e1(31),h=0;h<31;++h)l[h]=i+=1<<u[h-1];var g=new bae(l[30]);for(h=1;h<30;++h)for(var x=l[h];x<l[h+1];++x)g[x]=x-l[h]<<5|h;return{b:l,r:g}},l5=o5(s5,2),c5=l5.b,Sae=l5.r;c5[28]=258,Sae[258]=28;for(var Tae=o5(a5,0).b,u5=new e1(32768),Ao=0;Ao<32768;++Ao){var u0=(43690&Ao)>>1|(21845&Ao)<<1;u5[Ao]=((65280&(u0=(61680&(u0=(52428&u0)>>2|(13107&u0)<<2))>>4|(3855&u0)<<4))>>8|(255&u0)<<8)>>1}var t1=function(u,i,l){for(var h=u.length,g=0,x=new e1(i);g<h;++g)u[g]&&++x[u[g]-1];var b,j=new e1(i);for(g=1;g<i;++g)j[g]=j[g-1]+x[g-1]<<1;b=new e1(1<<i);var M=15-i;for(g=0;g<h;++g)if(u[g])for(var R=g<<4|u[g],L=i-u[g],U=j[u[g]-1]++<<L,q=U|(1<<L)-1;U<=q;++U)b[u5[U]>>M]=R;return b},n1=new Fd(288);for(Ao=0;Ao<144;++Ao)n1[Ao]=8;for(Ao=144;Ao<256;++Ao)n1[Ao]=9;for(Ao=256;Ao<280;++Ao)n1[Ao]=7;for(Ao=280;Ao<288;++Ao)n1[Ao]=8;var d5=new Fd(32);for(Ao=0;Ao<32;++Ao)d5[Ao]=5;var Aae=t1(n1,9),jae=t1(d5,5),tP=function(u){for(var i=u[0],l=1;l<u.length;++l)u[l]>i&&(i=u[l]);return i},Tf=function(u,i,l){var h=i/8|0;return(u[h]|u[h+1]<<8)>>(7&i)&l},nP=function(u,i){var l=i/8|0;return(u[l]|u[l+1]<<8|u[l+2]<<16)>>(7&i)},Eae=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Af=function(u,i,l){var h=new Error(i||Eae[u]);if(h.code=u,Error.captureStackTrace&&Error.captureStackTrace(h,Af),!l)throw h;return h},Cae=new Fd(0),Nae=typeof TextDecoder<"u"&&new TextDecoder;try{Nae.decode(Cae,{stream:!0})}catch{}const Pae={gzip_data:"gzip"};class Ch extends Error{constructor(i){super(i),this.name="MRTError"}}const Mae={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},h5={uint32:1,uint16:2,uint8:4},Rae={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let rP;class H2{constructor(i=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=i}getLayer(i){const l=this.layers[i];if(!l)throw new Ch(`Layer '${i}' not found`);return l}getHeaderLength(i){const l=new Uint8Array(i),h=new DataView(i);if(l[0]!==13)throw new Ch("File is not a valid MRT.");return h.getUint32(1,!0)}parseHeader(i){const l=new Uint8Array(i),h=this.getHeaderLength(i);if(l.length<h)throw new Ch(`Expected header with length >= ${h} but got buffer of length ${l.length}`);const g=new rP(l.subarray(0,h)).readFields(uae,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0);if(!isNaN(this.x)&&(this.x!==g.x||this.y!==g.y||this.z!==g.z))throw new Ch(`Invalid attempt to parse header ${g.z}/${g.x}/${g.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=g.x,this.y=g.y,this.z=g.z;for(const x of g.layers)this.layers[x.name]=new f5(x,{cacheSize:this._cacheSize});return this}createDecodingTask(i){const l=[],h=this.getLayer(i.layerName);for(let g of i.blockIndices){const x=h.dataIndex[g],b=x.firstByte-i.firstByte,j=x.lastByte-i.firstByte;if(h._blocksInProgress.has(g))continue;const M={layerName:h.name,firstByte:b,lastByte:j,pixelFormat:h.pixelFormat,blockIndex:g,blockShape:[x.bands.length].concat(h.bandShape),buffer:h.buffer,codec:x.codec.codec,filters:x.filters.map((R=>R.filter))};h._blocksInProgress.add(g),l.push(M)}return new p5(l,(()=>{l.forEach((g=>h._blocksInProgress.delete(g.blockIndex)))}),((g,x)=>{if(l.forEach((b=>h._blocksInProgress.delete(b.blockIndex))),g)throw g;x.forEach((b=>{this.getLayer(b.layerName).processDecodedData(b)}))}))}}class f5{constructor({version:i,name:l,units:h,tileSize:g,pixelFormat:x,buffer:b,dataIndex:j},M){if(this.version=i,this.version!==1)throw new Ch(`Cannot parse raster layer encoded with MRT version ${i}`);this.name=l,this.units=h,this.tileSize=g,this.buffer=b,this.pixelFormat=Mae[x],this.dataIndex=j,this.bandShape=[g+2*b,g+2*b,h5[this.pixelFormat]],this._decodedBlocks=new $2(M?M.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return h5[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map((({bands:i})=>i)).flat()}processDecodedData(i){const l=i.blockIndex.toString();this._decodedBlocks.get(l)||this._decodedBlocks.put(l,i.data)}getBlockForBand(i){let l=0;switch(typeof i){case"string":for(const[h,g]of this.dataIndex.entries()){for(const[x,b]of g.bands.entries())if(b===i)return{bandIndex:l+x,blockIndex:h,blockBandIndex:x};l+=g.bands.length}break;case"number":for(const[h,g]of this.dataIndex.entries()){if(i>=l&&i<l+g.bands.length)return{bandIndex:i,blockIndex:h,blockBandIndex:i-l};l+=g.bands.length}break;default:throw new Ch(`Invalid band \`${JSON.stringify(i)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(i){let l=1/0,h=-1/0;const g=[],x=new Set;for(const b of i){const{blockIndex:j}=this.getBlockForBand(b);if(j<0)throw new Ch(`Invalid band: ${JSON.stringify(b)}`);const M=this.dataIndex[j];g.includes(j)||g.push(j),x.add(j),l=Math.min(l,M.firstByte),h=Math.max(h,M.lastByte)}if(x.size>this.cacheSize)throw new Ch(`Number of blocks to decode (${x.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:l,lastByte:h,blockIndices:g}}hasBand(i){const{blockIndex:l}=this.getBlockForBand(i);return l>=0}hasDataForBand(i){const{blockIndex:l}=this.getBlockForBand(i);return l>=0&&!!this._decodedBlocks.get(l.toString())}getBandView(i){const{blockIndex:l,blockBandIndex:h}=this.getBlockForBand(i);if(l<0)throw new Ch(`Band not found: ${JSON.stringify(i)}`);const g=this._decodedBlocks.get(l.toString());if(!g)throw new Ch(`Data for band ${JSON.stringify(i)} of layer "${this.name}" not decoded.`);const x=this.dataIndex[l],b=this.bandShape.reduce(((R,L)=>R*L),1),j=h*b,M=g.subarray(j,j+b);return{data:M,bytes:new Uint8Array(M.buffer).subarray(M.byteOffset,M.byteOffset+M.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:x.offset,scale:x.scale}}}H2.setPbf=function(u){rP=u};class p5{constructor(i,l,h){this.tasks=i,this._onCancel=l,this._onComplete=h,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(i,l){this._finalized||(this._onComplete(i,l),this._finalized=!0)}}H2.performDecoding=function(u,i){const l=new Uint8Array(u);return Promise.all(i.tasks.map((h=>{const{layerName:g,firstByte:x,lastByte:b,pixelFormat:j,blockShape:M,blockIndex:R,filters:L,codec:U}=h,q=l.subarray(x,b+1),ee=new Uint32Array(M[0]*M[1]*M[2]);let te;if(U!=="gzip_data")throw new Ch(`Unhandled codec: ${U}`);return te=(function(le,ue){if(!globalThis.DecompressionStream&&ue==="gzip_data")return Promise.resolve(((Pe=(function(Qe){Qe[0]==31&&Qe[1]==139&&Qe[2]==8||Af(6,"invalid gzip data");var dt=Qe[3],ft=10;4&dt&&(ft+=2+(Qe[10]|Qe[11]<<8));for(var Ft=(dt>>3&1)+(dt>>4&1);Ft>0;Ft-=!Qe[ft++]);return ft+(2&dt)})(we=le))+8>we.length&&Af(6,"invalid gzip data"),(function(Qe,dt,ft,Ft){var xt=Qe.length;if(!xt||dt.f&&!dt.l)return ft||new Fd(0);var Wt=!ft,bn=Wt||dt.i!=2,tn=dt.i;Wt&&(ft=new Fd(3*xt));var dn,xn,Lt=function(da){var Ws=ft.length;if(da>Ws){var ks=new Fd(Math.max(2*Ws,da));ks.set(ft),ft=ks}},hn=dt.f||0,Tt=dt.p||0,zt=dt.b||0,wn=dt.l,pn=dt.d,ur=dt.m,Jn=dt.n,cn=8*xt;do{if(!wn){hn=Tf(Qe,Tt,1);var yn=Tf(Qe,Tt+1,3);if(Tt+=3,!yn){var er=Qe[(Ie=4+((Tt+7)/8|0))-4]|Qe[Ie-3]<<8,Bn=Ie+er;if(Bn>xt){tn&&Af(0);break}bn&&Lt(zt+er),ft.set(Qe.subarray(Ie,Bn),zt),dt.b=zt+=er,dt.p=Tt=8*Bn,dt.f=hn;continue}if(yn==1)wn=Aae,pn=jae,ur=9,Jn=5;else if(yn==2){var En=Tf(Qe,Tt,31)+257,$n=Tf(Qe,Tt+10,15)+4,Cr=En+Tf(Qe,Tt+5,31)+1;Tt+=14;for(var kr=new Fd(Cr),si=new Fd(19),Hr=0;Hr<$n;++Hr)si[wae[Hr]]=Tf(Qe,Tt+3*Hr,7);Tt+=3*$n;var Mi=tP(si),gi=(1<<Mi)-1,Gs=t1(si,Mi);for(Hr=0;Hr<Cr;){var Ie,Le=Gs[Tf(Qe,Tt,gi)];if(Tt+=15&Le,(Ie=Le>>4)<16)kr[Hr++]=Ie;else{var It=0,Sn=0;for(Ie==16?(Sn=3+Tf(Qe,Tt,3),Tt+=2,It=kr[Hr-1]):Ie==17?(Sn=3+Tf(Qe,Tt,7),Tt+=3):Ie==18&&(Sn=11+Tf(Qe,Tt,127),Tt+=7);Sn--;)kr[Hr++]=It}}var kn=kr.subarray(0,En),Dn=kr.subarray(En);ur=tP(kn),Jn=tP(Dn),wn=t1(kn,ur),pn=t1(Dn,Jn)}else Af(1);if(Tt>cn){tn&&Af(0);break}}bn&&Lt(zt+131072);for(var Qn=(1<<ur)-1,Or=(1<<Jn)-1,Ci=Tt;;Ci=Tt){var Ni=(It=wn[nP(Qe,Tt)&Qn])>>4;if((Tt+=15&It)>cn){tn&&Af(0);break}if(It||Af(2),Ni<256)ft[zt++]=Ni;else{if(Ni==256){Ci=Tt,wn=null;break}var hi=Ni-254;Ni>264&&(hi=Tf(Qe,Tt,(1<<(li=s5[Hr=Ni-257]))-1)+c5[Hr],Tt+=li);var Es=pn[nP(Qe,Tt)&Or],va=Es>>4;if(Es||Af(3),Tt+=15&Es,Dn=Tae[va],va>3){var li=a5[va];Dn+=nP(Qe,Tt)&(1<<li)-1,Tt+=li}if(Tt>cn){tn&&Af(0);break}bn&&Lt(zt+131072);var Qs=zt+hi;if(zt<Dn){var Ds=0-Dn,ps=Math.min(Dn,Qs);for(Ds+zt<0&&Af(3);zt<ps;++zt)ft[zt]=(void 0)[Ds+zt]}for(;zt<Qs;++zt)ft[zt]=ft[zt-Dn]}}dt.l=wn,dt.p=Ci,dt.b=zt,dt.f=hn,wn&&(hn=1,dt.m=ur,dt.d=pn,dt.n=Jn)}while(!hn);return zt!=ft.length&&Wt?(dn=ft,((xn=zt)==null||xn>dn.length)&&(xn=dn.length),new Fd(dn.subarray(0,xn))):ft.subarray(0,zt)})(we.subarray(Pe,-8),{i:2},new Fd(((ge=we)[(Se=ge.length)-4]|ge[Se-3]<<8|ge[Se-2]<<16|ge[Se-1]<<24)>>>0))));var ge,Se,we,Pe;const tt=Pae[ue];if(!tt)throw new Error(`Unhandled codec: ${ue}`);const Ke=new globalThis.DecompressionStream(tt);return new Response(new Blob([le]).stream().pipeThrough(Ke)).arrayBuffer().then((Qe=>new Uint8Array(Qe)))})(q,U).then((le=>((function(ue,ge){ue.readFields(gae,ge)})(new rP(le),ee),new Rae[j](ee.buffer)))),te.then((le=>{for(let ue=L.length-1;ue>=0;ue--)switch(L[ue]){case"delta_filter":vae(le,M);break;case"zigzag_filter":xae(le);break;case"bitshuffle_filter":_ae(le,j);break;default:throw new Ch(`Unhandled filter "${L[ue]}"`)}return{layerName:g,blockIndex:R,data:le}})).catch((le=>{throw le}))})))},Hn(p5,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),Hn(H2,"MapboxRasterTile"),Hn(f5,"MapboxRasterLayer",{omit:["_blocksInProgress"]});class m5{constructor(i){this._stringToNumber={},this._numberToString=[];for(let l=0;l<i.length;l++){const h=i[l];this._stringToNumber[h]=l,this._numberToString[l]=h}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}const Oae=["id","tile","layer","source","sourceLayer","state"];class d0{constructor(i,l,h,g,x){this.type="Feature",this._vectorTileFeature=i,this._z=l,this._x=h,this._y=g,this.properties=i.properties,this.id=x}clone(){const i=new d0(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(i.state=Object.assign({},this.state)),this.layer&&(i.layer=Object.assign({},this.layer)),this.source&&(i.source=this.source),this.sourceLayer&&(i.sourceLayer=this.sourceLayer),i}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const l of Oae)this[l]!==void 0&&(i[l]=this[l]);return i}}class g5{constructor(i,l){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Sd(mn,16,0),this.featureIndexArray=new Zv,this.promoteId=l,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(i,l,h,g,x,b=0,j=0){const M=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,g,x,b);const R=this.grid;for(let L=0;L<l.length;L++){const U=l[L],q=[1/0,1/0,-1/0,-1/0];for(let ee=0;ee<U.length;ee++){const te=U[ee];q[0]=Math.min(q[0],te.x),q[1]=Math.min(q[1],te.y),q[2]=Math.max(q[2],te.x),q[3]=Math.max(q[3],te.y)}j!==0&&(q[0]-=j,q[1]-=j,q[2]+=j,q[3]+=j),q[0]<mn&&q[1]<mn&&q[2]>=0&&q[3]>=0&&R.insert(M,q[0],q[1],q[2],q[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Pn(new x2(this.rawTileData)).layers,this.sourceLayerCoder=new m5(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const i in this.vtLayers)this.vtFeatures[i]=[]}return this.vtLayers}query(i,l){const{tilespaceGeometry:h,transform:g,tileTransform:x,pixelPosMatrix:b,availableImages:j,worldview:M}=l;this.loadVTLayers(),this.serializedLayersCache.clear();const R=h.bufferedTilespaceBounds,L=this.grid.query(R.min.x,R.min.y,R.max.x,R.max.y,((te,le,ue,ge)=>la(h.bufferedTilespaceGeometry,te,le,ue,ge)));L.sort(Dae);let U=null;g.elevation&&L.length>0&&(U=o0.create(g.elevation,this.tileID));const q={};let ee;for(let te=0;te<L.length;te++){const le=L[te];if(le===ee)continue;ee=le;const ue=this.featureIndexArray.get(le);let ge=null;this.is3DTile?this.loadMatchingModelFeature(q,ue,i,h,g,M):this.loadMatchingFeature(q,ue,i,j,M,((Se,we,Pe,tt=0)=>(ge||(ge=at(Se,this.tileID.canonical,x)),we.queryIntersectsFeature(h,Se,Pe,ge,this.z,g,b,U,tt))))}return q}loadMatchingFeature(i,l,h,g,x,b){const{featureIndex:j,bucketIndex:M,sourceLayerIndex:R,layoutVertexArrayOffset:L}=l,U=this.bucketLayerIDs[M],q=h.layers,ee=Object.keys(q);if(ee.length&&!Wr(ee,U))return;const te=h.sourceCache,le=this.sourceLayerCoder.decode(R),ue=this.vtLayers[le].feature(j),ge=this.getId(ue,le);for(let Se=0;Se<U.length;Se++){const we=U[Se];if(!q[we])continue;const{styleLayer:Pe,targets:tt}=q[we];let Ke={};ge!==void 0&&(Ke=te.getFeatureState(Pe.sourceLayer,ge));const Qe=!b||b(ue,Pe,Ke,L);if(!Qe)continue;const dt=new d0(ue,this.z,this.x,this.y,ge);dt.tile=this.tileID.canonical,dt.state=Ke;let ft=this.serializedLayersCache.get(we);ft||(ft=Pe.serialize(),ft.id=we,this.serializedLayersCache.set(we,ft)),dt.source=ft.source,dt.sourceLayer=ft["source-layer"],dt.layer=St({},ft),dt.layer.paint=y5(ft.paint,Pe.paint,ue,Ke,g),dt.layer.layout=y5(ft.layout,Pe.layout,ue,Ke,g);let Ft=!1;for(const xt of tt){this.updateFeatureProperties(dt,xt);const{filter:Wt}=xt;if(Wt){if(ue.properties=dt.properties,Wt.needGeometry){const bn=Dt(ue,!0);if(!Wt.filter(new hs(this.tileID.overscaledZ,{worldview:x}),bn,this.tileID.canonical))continue}else if(!Wt.filter(new hs(this.tileID.overscaledZ,{worldview:x}),ue))continue}Ft=!0,xt.targetId&&this.addFeatureVariant(dt,xt)}Ft&&this.appendToResult(i,we,j,dt,Qe)}}loadMatchingModelFeature(i,l,h,g,x,b){const{featureIndex:j,bucketIndex:M}=l,R=this.bucketLayerIDs[M],L=h.layers,U=Object.keys(L);if(!U.length||Wr(U,R))for(let q=0;q<R.length;q++){const ee=R[q],{styleLayer:te,targets:le}=L[ee];if(te.type!=="model")continue;const ue=g.tile,ge=ue.getBucket(te);if(!(ge&&ge instanceof z2))continue;const Se=Fse(ge,j,g,x);if(!Se)continue;const{z:we,x:Pe,y:tt}=ue.tileID.canonical,{feature:Ke,intersectionZ:Qe,position:dt}=Se;let ft={};Ke.id!==void 0&&(ft=h.sourceCache.getFeatureState(te.sourceLayer,Ke.id));const Ft=new d0({},we,Pe,tt,Ke.id);Ft.tile=this.tileID.canonical,Ft.state=ft,Ft.properties=Ke.properties,Ft.geometry={type:"Point",coordinates:[dt.lng,dt.lat]};let xt=this.serializedLayersCache.get(ee);xt||(xt=te.serialize(),xt.id=ee,this.serializedLayersCache.set(ee,xt)),Ft.source=xt.source,Ft.sourceLayer=xt["source-layer"],Ft.layer=St({},xt);let Wt=!1;for(const bn of le){this.updateFeatureProperties(Ft,bn);const{filter:tn}=bn;if(tn){if(Ke.properties=Ft.properties,tn.needGeometry){if(!tn.filter(new hs(this.tileID.overscaledZ,{worldview:b}),Ke,this.tileID.canonical))continue}else if(!tn.filter(new hs(this.tileID.overscaledZ,{worldview:b}),Ke))continue}Wt=!0,bn.targetId&&this.addFeatureVariant(Ft,bn)}Wt&&this.appendToResult(i,ee,j,Ft,Qe)}}updateFeatureProperties(i,l,h){if(l.properties){const g={};for(const x in l.properties){const b=l.properties[x].evaluate({zoom:this.z},i._vectorTileFeature,i.state,i.tile,h);b!=null&&(g[x]=b)}i.properties=g}}addFeatureVariant(i,l,h){const g={target:l.target,namespace:l.namespace,uniqueFeatureID:l.uniqueFeatureID};l.properties&&(g.properties=i.properties),i.variants=i.variants||{},i.variants[l.targetId]=i.variants[l.targetId]||[],i.variants[l.targetId].push(g)}appendToResult(i,l,h,g,x){let b=i[l];b===void 0&&(b=i[l]=[]),b.push({featureIndex:h,feature:g,intersectionZ:x})}lookupSymbolFeatures(i,l,h,g,x,b){const j={};this.loadVTLayers();for(const M of i)this.loadMatchingFeature(j,{bucketIndex:l,sourceLayerIndex:h,featureIndex:M,layoutVertexArrayOffset:0},g,x,b);return j}loadFeature(i){const{featureIndex:l,sourceLayerIndex:h}=i;this.loadVTLayers();const g=this.sourceLayerCoder.decode(h),x=this.vtFeatures[g];if(x[l])return x[l];const b=this.vtLayers[g].feature(l);return x[l]=b,b}hasLayer(i){for(const l of this.bucketLayerIDs)for(const h of l)if(i===h)return!0;return!1}getId(i,l){let h=i.id;if(this.promoteId){const g=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[l];if(g!=null)if(Array.isArray(g)){if(!this.promoteIdExpression){const x=Uc(g);if(x.result!=="success"){const b=x.value.map((j=>`${j.key}: ${j.message}`)).join(", ");return void ai(`Failed to create expression for promoteId: ${b}`)}this.promoteIdExpression=x.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new nh),h=this.promoteIdExpression.evaluate({zoom:0},i)}else h=i.properties[g];typeof h=="boolean"&&(h=Number(h))}return h}}function y5(u,i,l,h,g){return pr(u,((x,b)=>{const j=i instanceof qc?i.get(b):null;return j&&j.evaluate?j.evaluate(l,h,void 0,g):j}))}function Dae(u,i){return i-u}Hn(g5,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const v5=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class iP{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,h]=new Uint8Array(i,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=h>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const x=v5[15&h];if(!x)throw new Error("Unrecognized array type.");const[b]=new Uint16Array(i,2,1),[j]=new Uint32Array(i,4,1);return new iP(j,b,x,i)}constructor(i,l=64,h=Float64Array,g){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=h,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const x=v5.indexOf(this.ArrayType),b=2*i*this.ArrayType.BYTES_PER_ELEMENT,j=i*this.IndexArrayType.BYTES_PER_ELEMENT,M=(8-j%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${h}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+j+M,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+b+j+M),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+j+M,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=i)}add(i,l){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=i,this.coords[this._pos++]=l,h}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return sP(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,l,h,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:b,nodeSize:j}=this,M=[0,x.length-1,0],R=[];for(;M.length;){const L=M.pop()||0,U=M.pop()||0,q=M.pop()||0;if(U-q<=j){for(let ue=q;ue<=U;ue++){const ge=b[2*ue],Se=b[2*ue+1];ge>=i&&ge<=h&&Se>=l&&Se<=g&&R.push(x[ue])}continue}const ee=q+U>>1,te=b[2*ee],le=b[2*ee+1];te>=i&&te<=h&&le>=l&&le<=g&&R.push(x[ee]),(L===0?i<=te:l<=le)&&(M.push(q),M.push(ee-1),M.push(1-L)),(L===0?h>=te:g>=le)&&(M.push(ee+1),M.push(U),M.push(1-L))}return R}within(i,l,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:x,nodeSize:b}=this,j=[0,g.length-1,0],M=[],R=h*h;for(;j.length;){const L=j.pop()||0,U=j.pop()||0,q=j.pop()||0;if(U-q<=b){for(let ue=q;ue<=U;ue++)_5(x[2*ue],x[2*ue+1],i,l)<=R&&M.push(g[ue]);continue}const ee=q+U>>1,te=x[2*ee],le=x[2*ee+1];_5(te,le,i,l)<=R&&M.push(g[ee]),(L===0?i-h<=te:l-h<=le)&&(j.push(q),j.push(ee-1),j.push(1-L)),(L===0?i+h>=te:l+h>=le)&&(j.push(ee+1),j.push(U),j.push(1-L))}return M}}function sP(u,i,l,h,g,x){if(g-h<=l)return;const b=h+g>>1;x5(u,i,b,h,g,x),sP(u,i,l,h,b-1,1-x),sP(u,i,l,b+1,g,1-x)}function x5(u,i,l,h,g,x){for(;g>h;){if(g-h>600){const R=g-h+1,L=l-h+1,U=Math.log(R),q=.5*Math.exp(2*U/3),ee=.5*Math.sqrt(U*q*(R-q)/R)*(L-R/2<0?-1:1);x5(u,i,l,Math.max(h,Math.floor(l-L*q/R+ee)),Math.min(g,Math.floor(l+(R-L)*q/R+ee)),x)}const b=i[2*l+x];let j=h,M=g;for(r1(u,i,h,l),i[2*g+x]>b&&r1(u,i,h,g);j<M;){for(r1(u,i,j,M),j++,M--;i[2*j+x]<b;)j++;for(;i[2*M+x]>b;)M--}i[2*h+x]===b?r1(u,i,h,M):(M++,r1(u,i,M,g)),M<=l&&(h=M+1),l<=M&&(g=M-1)}}function r1(u,i,l,h){aP(u,l,h),aP(i,2*l,2*h),aP(i,2*l+1,2*h+1)}function aP(u,i,l){const h=u[i];u[i]=u[l],u[l]=h}function _5(u,i,l,h){const g=u-l,x=i-h;return g*g+x*x}s.$=Ya,s.A=yc,s.B=vc,s.C=_h,s.D=zn,s.E=od,s.F=2,s.G=$w,s.H=GB,s.I=vl,s.J=kc,s.K=class extends L2{},s.L=ld,s.M=qv,s.N=Cm,s.O=vh,s.P=Rt,s.Q=Lv,s.R=Mu,s.S=up,s.T=_N,s.U=gp,s.V=L2,s.W=rf,s.X=Uc,s.Y=rp,s.Z=Ma,s._=dh,s.a=function(u){return Ua.API_CDN_URL_REGEX.test(u)},s.a$=Kt,s.a0=pm,s.a1=yp,s.a2=_d,s.a3=cp,s.a4=function(u){const i=u.value;let l=[];if(!i)return l;const h=kc(i);return h!=="string"?(l=l.concat([new L2(u.key,i,`string expected, "${h}" found`)]),l):(WN(i,!0)||(l=l.concat([new L2(u.key,i,`invalid url "${i}"`)])),l)},s.a5=yt,s.a6=mp,s.a7=ra,s.a8=fn,s.a9=class{constructor(u){this.specification=u}possiblyEvaluate(u,i){return ca(u.expression.evaluate(i))}interpolate(u,i,l){return{x:yr(u.x,i.x,l),y:yr(u.y,i.y,l),z:yr(u.z,i.z,l),azimuthal:yr(u.azimuthal,i.azimuthal,l),polar:yr(u.polar,i.polar,l)}}},s.aA=qt,s.aB=qa,s.aC=Ha,s.aD=ce,s.aE=ct,s.aF=function(u,i){const l={};for(let h=0;h<i.length;h++){const g=i[h];g in u&&(l[g]=u[g])}return l},s.aG=ne,s.aH=pe,s.aI=class{constructor(u){this.entries={},this.scheduler=u}request(u,i,l,h){const g=this.entries[u]=this.entries[u]||{callbacks:[]};if(g.result){const[x,b]=g.result;return this.scheduler?this.scheduler.add((()=>{h(x,b)}),i):h(x,b),()=>{}}return g.callbacks.push(h),g.cancel||(g.cancel=l(((x,b)=>{g.result=[x,b];for(const j of g.callbacks)this.scheduler?this.scheduler.add((()=>{j(x,b)}),i):j(x,b);setTimeout((()=>delete this.entries[u]),3e3)}))),()=>{g.result||(g.callbacks=g.callbacks.filter((x=>x!==h)),g.callbacks.length||(g.cancel(),delete this.entries[u]))}}},s.aJ=function(u,i,l){const h=JSON.stringify(u.request);return u.data&&(this.deduped.entries[h]={result:[null,u.data]}),this.deduped.request(h,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom},(g=>{const x=gc(u.request,((b,j,M,R)=>{b?g(b):j&&g(null,{vectorTile:l?void 0:new Pn(new x2(j)),rawData:j,cacheControl:M,expires:R})}));return()=>{x.cancel(),g()}}),i)},s.aK=function(u){ad++,ad>to&&(u.getActor().send("enforceCacheSizeLimit",Po),ad=0)},s.aL=function(u){return u<=1?1:Math.pow(2,Math.floor(Math.log(u)/Math.LN2))},s.aM=wa,s.aN=b4,s.aO=E4,s.aP=_4,s.aQ=function(u,i){const l=document.createElement("video");l.muted=!0,l.onloadstart=function(){i(null,l)};for(let h=0;h<u.length;h++){const g=document.createElement("source");je(u[h])||(l.crossOrigin="Anonymous"),g.src=u[h],l.appendChild(g)}return{cancel:()=>{}}},s.aR=Lw,s.aS=function(u){return fetch(u).then((i=>i.arrayBuffer())).then((i=>JF(i,0,u)))},s.aT=aB,s.aU=class{constructor(u,i,l,h){this.id=u,this.position=i!=null?new G(i[0],i[1]):new G(0,0),this.orientation=l??[0,0,0],this.nodes=h,this.uploaded=!1,this.aabb=new ii([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(u,i){if(K(u.matrix,i,u.matrix),u.meshes)for(const l of u.meshes){const h=ii.applyTransformFast(l.aabb,u.matrix);this.aabb.encapsulate(h)}if(u.children)for(const l of u.children)this._applyTransformations(l,u.matrix)}computeBoundsAndApplyParent(){const u=B([]);for(const i of this.nodes)this._applyTransformations(i,u)}computeModelMatrix(u,i,l,h,g,x,b=!1){iB(this.matrix,this,u.transform,this.position,i,l,h,g,x,b)}upload(u){if(!this.uploaded){for(const i of this.nodes)SN(i,u);for(const i of this.nodes)v2(i);this.uploaded=!0}}destroy(){for(const u of this.nodes)TN(u)}},s.aV=br,s.aW=Gw,s.aX=be,s.aY=Ne,s.aZ=jd,s.a_=ki,s.aa=hs,s.ab=cu,s.ac=Ge,s.ad=Cn,s.ae=nt,s.af=ut,s.ag=qc,s.ah=Pp,s.ai=yr,s.aj=mn,s.ak=Vg,s.al=Dr,s.am=ns,s.an=class{constructor(u){this.specification=u}possiblyEvaluate(u,i){return(function([l,h]){const g=ca([1,l,h]);return{x:g.x,y:g.y,z:g.z}})(u.expression.evaluate(i))}interpolate(u,i,l){return{x:yr(u.x,i.x,l),y:yr(u.y,i.y,l),z:yr(u.z,i.z,l)}}},s.ao=function(u,i,l=0,h=!0){const g=new Rt(l,l),x=u.sub(g),b=i.add(g),j=[x,new Rt(b.x,x.y),b,new Rt(x.x,b.y)];return h&&j.push(x.clone()),j},s.ap=function(u,i){const l=[];for(let h=0;h<u.length;h++){const g=Et(h-1,-1,u.length-1),x=Et(h+1,-1,u.length-1),b=u[h],j=u[x],M=u[g].sub(b).unit(),R=j.sub(b).unit(),L=R.angleWithSep(M.x,M.y),U=M.add(R).unit().mult(-1*i/Math.sin(L/2));l.push(b.add(U))}return l},s.aq=a4,s.ar=la,s.as=function(u,i,l=0){return Me(((i.x-l)*u.scale-u.x)*mn,(i.y*u.scale-u.y)*mn,De(i.z,i.y))},s.at=Rr,s.au=Ot,s.av=mi,s.aw=yB,s.ax=function(u){let i=1/0,l=1/0,h=-1/0,g=-1/0;for(const x of u)i=Math.min(i,x.x),l=Math.min(l,x.y),h=Math.max(h,x.x),g=Math.max(g,x.y);return{min:new Rt(i,l),max:new Rt(h,g)}},s.ay=Oe,s.az=K,s.b=function(u){return Ua.API_FONTS_REGEX.test(u)},s.b$=zN,s.b0=T_,s.b1=O2,s.b2=function(){du.isLoading()||du.isLoaded()||Bv()!=="deferred"||Uv()},s.b3=cf,s.b4=Dt,s.b5=d0,s.b6=di,s.b7=EN,s.b8=bw,s.b9=at,s.bA=function(u,i){const{x:l,y:h}=u.point,g=by(l,h,u.worldSize/u._pixelsPerMercatorPixel,0,0);return K(g,g,ix(Xu(i)))},s.bB=E,s.bC=zr,s.bD=function(u,i){return Math.hypot(i[0]-u[0],i[1]-u[1],i[2]-u[2])},s.bE=We,s.bF=an,s.bG=Mt,s.bH=Vw,s.bI=yu,s.bJ=DN,s.bK=function(u,i,l,h,g){const x=5*i+2;u.float32[x+0]=l,u.float32[x+1]=h,u.float32[x+2]=g},s.bL=R2,s.bM=Xn,s.bN=yi,s.bO=mr,s.bP=Ji,s.bQ=Et,s.bR=function(u,i,l,h){var g=new T(4);return g[0]=u,g[1]=i,g[2]=l,g[3]=h,g},s.bS=Q_,s.bT=fs,s.bU=Qo,s.bV=o2,s.bW=C4,s.bX=c2,s.bY=sg,s.bZ=ON,s.b_=QB,s.ba=bl,s.bb=fy,s.bc=rw,s.bd=Hs,s.be=ng,s.bf=HN,s.bg=function(u,i){const l=Pp(i.zoom);if(l===0)return Xu(u);const h=P_(u),g=aw(h),x=ce(h.getWest())*i.worldSize,b=ce(h.getEast())*i.worldSize,j=pe(h.getNorth())*i.worldSize,M=pe(h.getSouth())*i.worldSize,R=[x,j,0],L=[b,j,0],U=[x,M,0],q=[b,M,0],ee=F([],i.globeMatrix);return Cn(R,R,ee),Cn(L,L,ee),Cn(U,U,ee),Cn(q,q,ee),g[0]=gf(g[0],U,l),g[1]=gf(g[1],q,l),g[2]=gf(g[2],L,l),g[3]=gf(g[3],R,l),ii.fromPoints(g)},s.bh=tg,s.bi=F,s.bj=Np,s.bk=gf,s.bl=uf,s.bm=UT,s.bn=he,s.bo=Y,s.bp=H2,s.bq=x2,s.br=gc,s.bs=function(u,i){const l=[];for(const h in u)h in i||l.push(h);return l},s.bt=ht,s.bu=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.bv=Jr,s.bw=function(u){var i=new T(16);return i[0]=u[0],i[1]=u[1],i[2]=u[2],i[3]=u[3],i[4]=u[4],i[5]=u[5],i[6]=u[6],i[7]=u[7],i[8]=u[8],i[9]=u[9],i[10]=u[10],i[11]=u[11],i[12]=u[12],i[13]=u[13],i[14]=u[14],i[15]=u[15],i},s.bx=B,s.by=se,s.bz=$,s.c=dc,s.c$=45,s.c0=iP,s.c1=pt,s.c2=Nn,s.c3=Wn,s.c4=function(u,i,l){l*=.5;var h=i[0],g=i[1],x=i[2],b=i[3],j=Math.sin(l),M=Math.cos(l);return u[0]=h*M+g*j,u[1]=g*M-h*j,u[2]=x*M+b*j,u[3]=b*M-x*j,u},s.c5=Vt,s.c6=Fi,s.c7=function(u,i){return u[0]=-i[0],u[1]=-i[1],u[2]=-i[2],u[3]=i[3],u},s.c8=Ce,s.c9=function(u,i,l,h,g){var x,b=1/Math.tan(i/2);return u[0]=b/l,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=b,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,g!=null&&g!==1/0?(u[10]=(g+h)*(x=1/(h-g)),u[14]=2*g*h*x):(u[10]=-1,u[14]=-2*h),u},s.cA=ac,s.cB=$T,s.cC=function(u,i,l,h,g,x,b,j,M){if(M.name==="globe")return $T(u,i,new ac(l,h,g),!1);const R=Gw({z:l,x:h,y:g},M);return new ii([(x+R.x/R.scale)*i,i*(R.y/R.scale),b],[(x+R.x2/R.scale)*i,i*(R.y2/R.scale),j])},s.cD=function(u,i,l){return u[0]=Math.min(i[0],l[0]),u[1]=Math.min(i[1],l[1]),u[2]=Math.min(i[2],l[2]),u[3]=Math.min(i[3],l[3]),u},s.cE=function(u,i,l){return u[0]=Math.max(i[0],l[0]),u[1]=Math.max(i[1],l[1]),u[2]=Math.max(i[2],l[2]),u[3]=Math.max(i[3],l[3]),u},s.cF=function(u){const i=Math.round((u+45+360)%360/90)%4;return Q[i]},s.cG=Be,s.cH=ui,s.cI=y,s.cJ=function(u){const i=B(new Float64Array(16));K(i,u.pixelMatrix,u.globeMatrix);const l=[0,S,0],h=[0,A,0];return Cn(l,l,i),Cn(h,h,i),[l[0]>0&&l[0]<=u.width&&l[1]>0&&l[1]<=u.height&&!R_(u,new G(u.center.lat,90)),h[0]>0&&h[0]<=u.width&&h[1]>0&&h[1]<=u.height&&!R_(u,new G(u.center.lat,-90))]},s.cK=function(u,i){const{scale:l}=u.tileTransform,h=l*mn/(u.tileSize*Math.pow(2,i.zoom-u.tileID.overscaledZ+u.tileID.canonical.z));return(function(g,x,b){var j=x[1],M=x[2],R=x[3],L=b[0],U=b[1];return g[0]=x[0]*L,g[1]=j*L,g[2]=M*U,g[3]=R*U,g})(new Float32Array(4),i.inverseAdjustmentMatrix,[h,h])},s.cL=g2,s.cM=Ve,s.cN=QF,s.cO=function(u){const i=QF(u,!0);return E([],[i[0],i[1],i[4],i[5]])},s.cP=X,s.cQ=Ii,s.cR=ae,s.cS=function(u){const{x:i,y:l}=u.point,{lng:h,lat:g}=u._center;return by(i,l,u.worldSize,h,g)},s.cT=et,s.cU=gt,s.cV=Tl,s.cW=ia,s.cX=mo,s.cY=function(u,i,l){let h=0;for(let g=0;g<2;++g)u[g]>0&&(h+=(u[g]-0)*(u[g]-0)),i[g]<0&&(h+=(0-i[g])*(0-i[g]));return h},s.cZ=function(u){return u*u*u*u*u},s.c_=de,s.ca=function(u,i,l,h,g,x,b){var j=1/(i-l),M=1/(h-g),R=1/(x-b);return u[0]=-2*j,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*M,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*R,u[11]=0,u[12]=(i+l)*j,u[13]=(g+h)*M,u[14]=(b+x)*R,u[15]=1,u},s.cb=me,s.cc=function(u,i,l){u[4*i+0]=l[0],u[4*i+1]=l[1],u[4*i+2]=l[2],u[4*i+3]=l[3]},s.cd=Sp,s.ce=ic,s.cf=Ra,s.cg=mu,s.ch=Oa,s.ci=G,s.cj=d4,s.ck=function(){var u=new T(4);return T!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u},s.cl=function(u,i,l){var h=i[0],g=i[1],x=i[2],b=i[3],j=Math.sin(l),M=Math.cos(l);return u[0]=h*M+x*j,u[1]=g*M+b*j,u[2]=h*-j+x*M,u[3]=g*-j+b*M,u},s.cm=function(u,i){return u[0]===i[0]&&u[1]===i[1]&&u[2]===i[2]&&u[3]===i[3]},s.cn=or,s.co=function(u){return Math.hypot(u[0],u[1],u[2],u[3])},s.cp=ze,s.cq=sn,s.cr=gu,s.cs=3,s.ct=2,s.cu=7,s.cv=6,s.cw=Jt,s.cx=Re,s.cy=Wi,s.cz=eB,s.d=function(u){return Ua.API_TILEJSON_REGEX.test(u)},s.d$=(u,i,l,h,g,x,b,j,M,R)=>{const L=u.transform,U=L.calculatePixelsToTileUnitsMatrix(i),q=l.paint.get("line-trim-color-use-theme").constantOr("default")==="none",ee=L.pitch<15?vB(.07,.7,Oe((14-L.zoom)/5,0,1)):.07;return{u_matrix:_B(u,i,l,h),u_pixels_to_tile_units:U,u_device_pixel_ratio:x,u_width_scale:b,u_floor_width_scale:j,u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:g,u_texsize:wB(l)&&i.lineAtlasTexture?i.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:xB(i,u.transform),u_alpha_discard_threshold:0,u_trim_offset:M,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toPremultipliedRenderColor(q?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:ee,u_tile_to_meter:qe(i.tileID.canonical,0),u_ground_shadow_factor:R}},s.d0=Tp,s.d1=function(u,i,l){const h=Math.sqrt(u*u+i*i+l*l),g=h>0?Math.acos(l/h)*ka:0;let x=u!==0||i!==0?Math.atan2(-i,-u)*ka+90:0;return x<0&&(x+=360),[h,x,g]},s.d2=Me,s.d3=ca,s.d4=qe,s.d5=Ee,s.d6=ii,s.d7=it,s.d8=function(u){return[Math.pow(u[0],1/2.2),Math.pow(u[1],1/2.2),Math.pow(u[2],1/2.2)]},s.d9=WN,s.dA=P_,s.dB=function(u){const i=Be-5;u=Oe(u,-i,i)/i*90;const l=Math.pow(Math.abs(Math.sin(Dr(u))),3);return Math.round(l*(v.length-1))},s.dC=function(u,i,l,h){const g=i.getNorth(),x=i.getSouth(),b=i.getWest(),j=i.getEast(),M=1<<u.z,R=j-b,L=g-x,U=R/d,q=-L/v[l],ee=[0,U,0,q,0,0,g,b,0];if(u.z>0){const te=180/h;V(ee,ee,[te/R+1,0,0,0,te/L+1,0,-.5*te/U,.5*te/q,1])}return ee[2]=M,ee[5]=u.x,ee[8]=u.y,ee},s.dD=Xu,s.dE=function(u,i,l){const h=B(new Float64Array(16)),g=(i/(1<<u)-.5)*Math.PI*2;return Z(h,l.globeMatrix,g),Float32Array.from(h)},s.dF=class{isDataAvailableAtPoint(u){const i=this._source();if(this.isUsingMockSource()||!i||u.y<0||u.y>1)return!1;const l=i.getSource().maxzoom,h=1<<l,g=Math.floor(u.x),x=Math.floor((u.x-g)*h),b=Math.floor(u.y*h),j=this.findDEMTileFor(new wa(l,g,l,x,b));return!(!j||!j.dem)}getAtPointOrZero(u,i=0){return this.getAtPoint(u,i)||0}getAtPoint(u,i,l=!0){if(this.isUsingMockSource())return null;i==null&&(i=null);const h=this._source();if(!h||u.y<0||u.y>1)return i;const g=h.getSource().maxzoom,x=1<<g,b=Math.floor(u.x),j=u.x-b,M=new wa(g,b,g,Math.floor(j*x),Math.floor(u.y*x)),R=this.findDEMTileFor(M);if(!R||!R.dem)return i;const L=R.dem,U=1<<R.tileID.canonical.z,q=(j*U-R.tileID.canonical.x)*L.dim,ee=(u.y*U-R.tileID.canonical.y)*L.dim,te=Math.floor(q),le=Math.floor(ee);return(l?this.exaggeration():1)*yr(yr(L.get(te,le),L.get(te,le+1),ee-le),yr(L.get(te+1,le),L.get(te+1,le+1),ee-le),q-te)}getAtTileOffset(u,i,l){const h=1<<u.canonical.z;return this.getAtPointOrZero(new Ge(u.wrap+(u.canonical.x+i/mn)/h,(u.canonical.y+l/mn)/h))}getAtTileOffsetFunc(u,i,l,h){return g=>{const x=this.getAtTileOffset(u,g.x,g.y),b=h.upVector(u.canonical,g.x,g.y);return pt(b,b,x*h.upVectorScale(u.canonical,i,l).metersToTile),b}}getForTilePoints(u,i,l,h){if(this.isUsingMockSource())return!1;const g=o0.create(this,u,h);return!!g&&(i.forEach((x=>{x[2]=this.exaggeration()*g.getElevationAt(x[0],x[1],l)})),!0)}getMinMaxForTile(u){if(this.isUsingMockSource())return null;const i=this.findDEMTileFor(u);if(!i||!i.dem)return null;const l=i.dem.tree,h=i.tileID,g=1<<u.canonical.z-h.canonical.z;let x=u.canonical.x/g-h.canonical.x,b=u.canonical.y/g-h.canonical.y,j=0;for(let M=0;M<u.canonical.z-h.canonical.z&&!l.leaves[j];M++){x*=2,b*=2;const R=2*Math.floor(b)+Math.floor(x);j=l.childOffsets[j]+R,x%=1,b%=1}return{min:this.exaggeration()*l.minimums[j],max:this.exaggeration()*l.maximums[j]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(u,i,l){throw new Error("Pure virtual method called.")}pointCoordinate(u){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(u){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const u=this.visibleDemTiles;if(u.length===0)return null;let i=!1,l=Number.MAX_VALUE,h=Number.MIN_VALUE;for(const g of u){const x=this.getMinMaxForTile(g.tileID);x&&(l=Math.min(l,x.min),h=Math.max(h,x.max),i=!0)}return i?{min:l,max:h}:null}},s.dG=Sy,s.dH=rx,s.dI=function(u,i){return[Math.pow(u[0],2.2)*i,Math.pow(u[1],2.2)*i,Math.pow(u[2],2.2)*i]},s.dJ=N,s.dK=function(u,i){var l=Math.sin(i),h=Math.cos(i);return u[0]=h,u[1]=l,u[2]=0,u[3]=-l,u[4]=h,u[5]=0,u[6]=0,u[7]=0,u[8]=1,u},s.dL=nr,s.dM=Od,s.dN=Na,s.dO=Ia,s.dP=256,s.dQ=function(u,i){const l=[0,0,0];return Cn(l,l,tg(Xu(i.canonical))),Cn(l,l,u),l},s.dR=u=>({u_matrix:new Oa(u),u_texsize:new mu(u),u_pixels_to_tile_units:new xy(u),u_device_pixel_ratio:new Ra(u),u_width_scale:new Ra(u),u_floor_width_scale:new Ra(u),u_image:new Sp(u),u_units_to_pixels:new mu(u),u_tile_units_to_pixels:new Ra(u),u_alpha_discard_threshold:new Ra(u),u_trim_offset:new mu(u),u_trim_fade_range:new mu(u),u_trim_color:new Tp(u),u_emissive_strength:new Ra(u),u_zbias_factor:new Ra(u),u_tile_to_meter:new Ra(u),u_ground_shadow_factor:new ic(u),u_pattern_transition:new Ra(u)}),s.dS=u=>({u_matrix:new Oa(u),u_pixels_to_tile_units:new xy(u),u_device_pixel_ratio:new Ra(u),u_width_scale:new Ra(u),u_floor_width_scale:new Ra(u),u_units_to_pixels:new mu(u),u_dash_image:new Sp(u),u_gradient_image:new Sp(u),u_image_height:new Ra(u),u_texsize:new mu(u),u_tile_units_to_pixels:new Ra(u),u_alpha_discard_threshold:new Ra(u),u_trim_offset:new mu(u),u_trim_fade_range:new mu(u),u_trim_color:new Tp(u),u_emissive_strength:new Ra(u),u_zbias_factor:new Ra(u),u_tile_to_meter:new Ra(u),u_ground_shadow_factor:new ic(u)}),s.dT=u=>({u_camera_to_center_distance:new Ra(u),u_extrude_scale:new xy(u),u_device_pixel_ratio:new Ra(u),u_matrix:new Oa(u),u_inv_rot_matrix:new Oa(u),u_merc_center:new mu(u),u_tile_id:new ic(u),u_zoom_transition:new Ra(u),u_up_dir:new ic(u),u_emissive_strength:new Ra(u)}),s.dU=Sc,s.dV=Wie,s.dW=uw,s.dX=(u,i,l,h,g,x)=>{const b=u.transform,j=b.projection.name==="globe";let M;if(x.paint.get("circle-pitch-alignment")==="map")if(j){const L=Od(b.zoom,i.canonical)*b._pixelsPerMercatorPixel;M=Float32Array.from([L,0,0,L])}else M=b.calculatePixelsToTileUnitsMatrix(l);else M=new Float32Array([b.pixelsToGLUnits[0],0,0,b.pixelsToGLUnits[1]]);const R={u_camera_to_center_distance:u.transform.getCameraToCenterDistance(b.projection),u_matrix:u.translatePosMatrix(i.projMatrix,l,x.paint.get("circle-translate"),x.paint.get("circle-translate-anchor")),u_device_pixel_ratio:co.devicePixelRatio,u_extrude_scale:M,u_inv_rot_matrix:cw,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:x.paint.get("circle-emissive-strength")};if(j){R.u_inv_rot_matrix=h,R.u_merc_center=g,R.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],R.u_zoom_transition=Pp(b.zoom);const L=g[0]*mn,U=g[1]*mn;R.u_up_dir=b.projection.upVector(new ac(0,0,0),L,U)}return R},s.dY=bB,s.dZ=uo,s.d_=(u,i,l,h,g,x,b,j,M,R)=>{const L=u.transform,U=L.pitch<15?vB(.07,.7,Oe((14-L.zoom)/5,0,1)):.07,q=l.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:_B(u,i,l,h),u_texsize:i.imageAtlasTexture?i.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:L.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:g,u_width_scale:x,u_floor_width_scale:b,u_image:0,u_tile_units_to_pixels:xB(i,L),u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:j,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toPremultipliedRenderColor(q?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:U,u_tile_to_meter:qe(i.tileID.canonical,0),u_ground_shadow_factor:M,u_pattern_transition:R}},s.da=function(u,i){return u.readFields(Vse,{icons:[]},i)},s.db=Tn,s.dc=i0,s.dd=IN,s.de=yl,s.df=Fv,s.dg=Za,s.dh=kl,s.di=Gr,s.dj=function(u){const i=u.indexOf(vp);return i>=0?u.slice(0,i):u},s.dk=function(u){return u.indexOf(vp)>=0},s.dl=function(u){const i=u.lastIndexOf(vp);return i>=0?u.slice(i+1):""},s.dm=function(u){const i=[],l=u.id;return l===void 0&&i.push({message:`layers.${l}: missing required property "id"`}),u.render===void 0&&i.push({message:`layers.${l}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&i.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),i},s.dn=function(u,i,l,h){return u.type==="custom"?new Ise(u,i):new Bse[u.type](u,i,l,h)},s.dp=Qr,s.dq=function(u){const i=u.indexOf(vp);return i>=0?u.slice(i+1):""},s.dr=class extends d0{constructor(u,i){super(u._vectorTileFeature,u._z,u._x,u._y,u.id),u.state&&(this.state=Object.assign({},u.state)),this.target=i.target,this.namespace=i.namespace,i.properties&&(this.properties=i.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=u.source,this.sourceLayer=u.sourceLayer,this.layer=u.layer)}toJSON(){const u=super.toJSON();return u.target=this.target,u.namespace=this.namespace,u}},s.ds=ay,s.dt=mc,s.du=function(u){return u({pluginStatus:sl,pluginURL:Td}),ay.on("pluginStateChange",u),u},s.dv=Ap,s.dw=class extends Ro{constructor(u){super(u),this.current=nw}set(u,i,l){if(this.fetchUniformLocation(u,i)){for(let h=0;h<9;h++)if(l[h]!==this.current[h]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}}},s.dx=fe,s.dy=function(u,i,l){const h=Pp(l.zoom),g=u.style.map._antialias,x=u.terrain&&u.terrain.exaggeration()>0;return h===0&&!g&&!x},s.dz=function(u){const i=u.pixelsPerMeter,l=i/me(1,u.center.lat),h=B(new Float64Array(16));return Y(h,h,[u.point.x,u.point.y,0]),X(h,h,[l,l,i]),Float32Array.from(h)},s.e=Ua,s.e$=Bv,s.e0=ir,s.e1=Mp,s.e2=De,s.e3=Ah,s.e4=Lp,s.e5=Ow,s.e6=Op,s.e7=450,s.e8=7,s.e9=Ye,s.eA=function(u,i,l,h,g,x,b,j,M,R,L,U,q,ee,te,le){var ue=new T(16);return ue[0]=u,ue[1]=i,ue[2]=l,ue[3]=h,ue[4]=g,ue[5]=x,ue[6]=b,ue[7]=j,ue[8]=M,ue[9]=R,ue[10]=L,ue[11]=U,ue[12]=q,ue[13]=ee,ue[14]=te,ue[15]=le,ue},s.eB=I,s.eC=bp,s.eD=pu,s.eE=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Rt(1/0,1/0),max:new Rt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(u,i=!1){const l=l2(new Rt(0,0),new Rt(mn,mn),u),h=[];if(i&&!jw(l,this._globalClipBounds))return h;for(const g of this._activeRegions){if(g.hiddenByOverlap||!jw(l,g))continue;const x=G_(g.min,g.max,u);h.push({min:x.min,max:x.max,sourceId:this._sourceIds[g.priority],footprint:g.footprint,footprintTileId:g.tileId,order:g.order,clipMask:g.clipMask,clipScope:g.clipScope})}return h}setSources(u){this._setSources(u.map((i=>({getSourceId:()=>i.cache.id,getFootprints:()=>{const l=[];for(const h of i.cache.getVisibleCoordinates()){const g=i.cache.getTile(h).buckets[i.layer];g&&g.updateFootprints(h.toUnwrapped(),l)}return l},getOrder:()=>i.order,getClipMask:()=>i.clipMask,getClipScope:()=>i.clipScope}))))}_addSource(u){const i=u.getFootprints();if(i.length===0)return;const l=u.getOrder(),h=u.getClipMask(),g=u.getClipScope();for(const x of i){if(!x.footprint)continue;const b=l2(x.footprint.min,x.footprint.max,x.id);this._activeRegions.push({min:b.min,max:b.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:x.id,footprint:x.footprint,order:l,clipMask:h,clipScope:g})}this._sourceIds.push(u.getSourceId())}_computeReplacement(){this._activeRegions.sort(((i,l)=>i.priority-l.priority||hx(i.min,l.min)||hx(i.max,l.max)||i.order-l.order||i.clipMask-l.clipMask||(function(h,g){const x=(b,j)=>b+j;return h.length-g.length||h.reduce(x,"").localeCompare(g.reduce(x,""))})(i.clipScope,l.clipScope)));let u=this._activeRegions.length!==this._prevRegions.length;if(!u){let i=0;for(;!u&&i!==this._activeRegions.length;){const l=this._activeRegions[i],h=this._prevRegions[i];u=l.priority!==h.priority||!Ny(l,h)||l.order!==h.order||l.clipMask!==h.clipMask||!Jr(l.clipScope,h.clipScope),++i}}if(u){++this._updateTime;for(const l of this._activeRegions)l.order!==Cy&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,l.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,l.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,l.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,l.max.y));const i=l=>{const h=this._activeRegions;if(l>=h.length)return l;const g=h[l].priority;for(;l<h.length&&h[l].priority===g;)++l;return l};if(this._sourceIds.length>1){let l=0,h=i(l);for(;l!==h;){let g=l;const x=l;for(;g!==h;){const b=this._activeRegions[g];b.hiddenByOverlap=!1;for(let j=0;j<x;j++){const M=this._activeRegions[j];if(!M.hiddenByOverlap&&b.order===Cy&&jw(b,M)&&(b.hiddenByOverlap=W_(b.footprint,b.tileId,M.footprint,M.tileId),b.hiddenByOverlap))break}++g}l=h,h=i(l)}}}}_setSources(u){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let i=u.length-1;i>=0;i--)this._addSource(u[i]);this._computeReplacement()}},s.eF=Cy,s.eG=class{constructor(u){this._createGrid(u),this._createPoles(u)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const u of this._poleSegments)u.destroy();for(const u of this._gridSegments)u.withSkirts.destroy(),u.withoutSkirts.destroy()}_fillGridMeshWithLods(u,i){const l=new bl,h=new ki,g=[],x=u+1+2,b=i[0]+1,j=i[0]+1+(1+i.length),M=(R,L,U)=>{let q=R===x-1?R-2:R===0?R:R-1;return q+=U?24575:0,[q,L]};for(let R=0;R<x;++R)l.emplaceBack(...M(R,0,!0));for(let R=0;R<b;++R)for(let L=0;L<x;++L)l.emplaceBack(...M(L,R,(L===0||L===x-1)&&!0));for(let R=0;R<i.length;++R){const L=i[R];for(let U=0;U<x;++U)l.emplaceBack(...M(U,L,!0))}for(let R=0;R<i.length;++R){const L=h.length,U=i[R]+1+2,q=new ki;for(let le=0;le<U-1;le++){const ue=le===U-2,ge=ue?x*(j-i.length+R-le):x;for(let Se=0;Se<x-1;Se++){const we=le*x+Se;le===0||ue||Se===0||Se===x-2?(q.emplaceBack(we+1,we,we+ge),q.emplaceBack(we+ge,we+ge+1,we+1)):(h.emplaceBack(we+1,we,we+ge),h.emplaceBack(we+ge,we+ge+1,we+1))}}const ee=Hs.simpleSegment(0,L,l.length,h.length-L);for(let le=0;le<q.uint16.length;le+=3)h.emplaceBack(q.uint16[le],q.uint16[le+1],q.uint16[le+2]);const te=Hs.simpleSegment(0,L,l.length,h.length-L);g.push({withoutSkirts:ee,withSkirts:te})}return{vertices:l,indices:h,segments:g}}_createGrid(u){const i=this._fillGridMeshWithLods(d,v);this._gridSegments=i.segments,this._gridBuffer=u.createVertexBuffer(i.vertices,rw.members),this._gridIndexBuffer=u.createIndexBuffer(i.indices,!0)}_createPoles(u){const i=new ki;for(let b=0;b<=d;b++)i.emplaceBack(0,b+1,b+2);this._poleIndexBuffer=u.createIndexBuffer(i,!0);const l=new Sh,h=new Sh,g=new Sh,x=new Sh;this._poleSegments=[];for(let b=0,j=0;b<mo;b++){const M=360/(1<<b);l.emplaceBack(0,-qa,0,.5,0),h.emplaceBack(0,-qa,0,.5,1),g.emplaceBack(0,-qa,0,.5,.5),x.emplaceBack(0,-qa,0,.5,.5);for(let R=0;R<=d;R++){let L=R/d,U=0;const q=yr(0,M,L),[ee,te,le]=P(qT,lN,q,qa);l.emplaceBack(ee,te,le,L,U),h.emplaceBack(ee,te,le,L,1-U);const ue=Dr(q);L=.5+.5*Math.sin(ue),U=.5+.5*Math.cos(ue),g.emplaceBack(ee,te,le,L,U),x.emplaceBack(ee,te,le,L,1-U)}this._poleSegments.push(Hs.simpleSegment(j,0,66,64)),j+=66}this._poleNorthVertexBuffer=u.createVertexBuffer(l,nx,!1),this._poleSouthVertexBuffer=u.createVertexBuffer(h,nx,!1),this._texturedPoleNorthVertexBuffer=u.createVertexBuffer(g,nx,!1),this._texturedPoleSouthVertexBuffer=u.createVertexBuffer(x,nx,!1)}getGridBuffers(u,i){return[this._gridBuffer,this._gridIndexBuffer,i?this._gridSegments[u].withSkirts:this._gridSegments[u].withoutSkirts]}getPoleBuffers(u,i){return[i?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,i?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[u]]}},s.eH=Aw,s.eI=Te,s.eJ=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},s.eK=ke,s.eL=Ue,s.eM=function(u,i,l){return u[0]=i[0]/l[0],u[1]=i[1]/l[1],u[2]=i[2]/l[2],u},s.eN=qr,s.eO=O,s.eP=jt,s.eQ=rt,s.eR=function([u,i,l]){const h=Math.hypot(u,i,l),g=Math.atan2(u,l),x=.5*Math.PI-Math.acos(-i/h);return new G(gt(g),gt(x))},s.eS=st,s.eT=bN,s.eU=function(u){const i=u.navigator?u.navigator.userAgent:null;return!!(function(l){if(wr==null){const h=l.navigator?l.navigator.userAgent:null;wr=!!l.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return wr})(u)&&!(!i||!(i.match("Version/15.4")||i.match("Version/15.5")||i.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},s.eV=function(u,i){Po=u,to=i},s.eW=R_,s.eX=ow,s.eY=function(u){const i=[0,0,0],l=B(new Float64Array(16));return K(l,u.pixelMatrix,u.globeMatrix),Cn(i,i,l),new Rt(i[0],i[1])},s.eZ=function(){const u=Yn;u&&(u.isPreloaded()&&u.numActive()===1?(u.release(Nt),Yn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},s.e_=function(){Tn().acquire(Nt)},s.ea=function(u,i){if(u===i){var l=i[1],h=i[2],g=i[3],x=i[6],b=i[7],j=i[11];u[1]=i[4],u[2]=i[8],u[3]=i[12],u[4]=l,u[6]=i[9],u[7]=i[13],u[8]=h,u[9]=x,u[11]=i[14],u[12]=g,u[13]=b,u[14]=j}else u[0]=i[0],u[1]=i[4],u[2]=i[8],u[3]=i[12],u[4]=i[1],u[5]=i[5],u[6]=i[9],u[7]=i[13],u[8]=i[2],u[9]=i[6],u[10]=i[10],u[11]=i[14],u[12]=i[3],u[13]=i[7],u[14]=i[11],u[15]=i[15];return u},s.eb=kse,s.ec=Ai,s.ed=Wm,s.ee=256,s.ef=ix,s.eg=wl,s.eh=Z,s.ei=function(u,i){return u[0]=i[0],u[1]=i[1],u[2]=i[2],u[3]=i[4],u[4]=i[5],u[5]=i[6],u[6]=i[8],u[7]=i[9],u[8]=i[10],u},s.ej=Sh,s.ek=dy,s.el=Iv,s.em=function(u,i,l,h,g){return Oe((u-i)/(l-i)*(g-h)+h,h,g)},s.en=un,s.eo=function(u,i){var l=i[0],h=i[1],g=i[2],x=i[3],b=i[4],j=i[5],M=i[6],R=i[7],L=i[8],U=L*b-j*R,q=-L*x+j*M,ee=R*x-b*M,te=l*U+h*q+g*ee;return te?(u[0]=U*(te=1/te),u[1]=(-L*h+g*R)*te,u[2]=(j*h-g*b)*te,u[3]=q*te,u[4]=(L*l-g*M)*te,u[5]=(-j*l+g*x)*te,u[6]=ee*te,u[7]=(-R*l+h*M)*te,u[8]=(b*l-h*x)*te,u):null},s.ep=2,s.eq=Pt,s.er=wN,s.es=[1,1,1],s.et=class{constructor(u,i,l,h){this.context=u,this.format=h,this.size=l,this.texture=u.gl.createTexture();const[g,x,b]=this.size,{gl:j}=u;j.bindTexture(j.TEXTURE_3D,this.texture),u.pixelStoreUnpackFlipY.set(!1),u.pixelStoreUnpack.set(1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),j.texImage3D(j.TEXTURE_3D,0,this.format,g,x,b,0,vN(this.format),xN(this.format),i.data)}bind(u,i){const{context:l}=this,{gl:h}=l;h.bindTexture(h.TEXTURE_3D,this.texture),u!==this.minFilter&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MAG_FILTER,u),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MIN_FILTER,u),this.minFilter=u),i!==this.wrapS&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_S,i),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_T,i),this.wrapS=i)}destroy(){const{gl:u}=this.context;u.deleteTexture(this.texture),this.texture=null}},s.eu=o0,s.ev=ci,s.ew=function(u,i,l,h){var g=i[0],x=i[1],b=i[2],j=i[3];return u[0]=g+h*(l[0]-g),u[1]=x+h*(l[1]-x),u[2]=b+h*(l[2]-b),u[3]=j+h*(l[3]-j),u},s.ex=t0,s.ey=Vo,s.ez=Md,s.f=function(u){return btoa(encodeURIComponent(u).replace(/%([0-9A-F]{2})/g,((i,l)=>String.fromCharCode(+("0x"+l)))))},s.f0=function(u,i,l=!1){if(sl===Bl.deferred||sl===Bl.loading||sl===Bl.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");Td=co.resolveURL(u),sl=Bl.deferred,sy=i,Im(),l||Uv()},s.f1=function(u){Ut=co.resolveURL(u),Vn||(Vn=new zn(Tn(),new od)),Vn.broadcast("setMeshoptUrl",Ut)},s.f2=cl,s.f3=function(u){ja=co.resolveURL(u),Vn||(Vn=new zn(Tn(),new od)),Vn.broadcast("setDracoUrl",ja)},s.f4=Yi,s.f5=Xe,s.f6=function(u){const i=Va();if(!i)return;const l=i.delete(Zo);u&&l.then((()=>u())).catch(u)},s.f7=on,s.f8=Hn,s.f9=xf,s.fa=Sf,s.fb=m5,s.fc=g5,s.fd=pB,s.fe=In,s.ff="hd_road_elevation",s.fg=js,s.fh=pr,s.fi=Al,s.fj=kN,s.fk=_x,s.fl=function(u,i,l,h,g,x,b,j=1,M,R,L){u.createArrays(),u.tilePixelRatio=mn/(512*u.overscaling),u.compareText={},u.iconsNeedLinear=!1;const U=u.layers[0].layout,q=u.layers[0]._unevaluatedLayout._values,ee={};ee.scaleFactor=j,ee.textSizeScaleRange=U.get("text-size-scale-range"),ee.iconSizeScaleRange=U.get("icon-size-scale-range");const[te,le]=ee.textSizeScaleRange,[ue,ge]=ee.iconSizeScaleRange;ee.textScaleFactor=Oe(ee.scaleFactor,te,le),ee.iconScaleFactor=Oe(ee.scaleFactor,ue,ge);const Se=q["text-size"],we=q["icon-size"];if(u.textSizeData.kind==="composite"){const{minZoom:ft,maxZoom:Ft}=u.textSizeData;ee.compositeTextSizes=[Se.possiblyEvaluate(new hs(ft,{worldview:L}),x),Se.possiblyEvaluate(new hs(Ft,{worldview:L}),x)]}if(u.iconSizeData.kind==="composite"){const{minZoom:ft,maxZoom:Ft}=u.iconSizeData;ee.compositeIconSizes=[we.possiblyEvaluate(new hs(ft,{worldview:L}),x),we.possiblyEvaluate(new hs(Ft,{worldview:L}),x)]}ee.layoutTextSize=Se.possiblyEvaluate(new hs(b+1,{worldview:L}),x),ee.layoutIconSize=we.possiblyEvaluate(new hs(b+1,{worldview:L}),x),ee.textMaxSize=Se.possiblyEvaluate(new hs(18,{worldview:L}),x);const Pe=U.get("symbol-placement"),tt=U.get("text-rotation-alignment")==="map"&&Pe!=="point",Ke=U.get("text-size");let Qe=!1;const dt=[];for(const ft of u.features){const Ft=U.get("text-font").evaluate(ft,{},x).join(","),xt=Ke.evaluate(ft,{},x)*ee.textScaleFactor,Wt=ee.layoutTextSize.evaluate(ft,{},x)*ee.textScaleFactor,bn=ee.layoutIconSize.evaluate(ft,{},x)*ee.iconScaleFactor,tn={horizontal:{},vertical:void 0},dn=ft.text;let xn,Lt=[0,0];if(dn){const $n=dn.toString(),Cr=U.get("text-letter-spacing").evaluate(ft,{},x)*Qo,kr=U.get("text-line-height").evaluate(ft,{},x)*Qo,si=Dm($n)?Cr:0,Hr=U.get("text-anchor").evaluate(ft,{},x),Mi=U.get("text-variable-anchor");if(!Mi){const It=U.get("text-radial-offset").evaluate(ft,{},x);if(It)Lt=QB(Hr,[It*Qo,LN]);else{const Sn=U.get("text-offset").evaluate(ft,{},x);Lt=[Sn[0]*Qo,Sn[1]*Qo]}}let gi=tt?"center":U.get("text-justify").evaluate(ft,{},x);const Gs=Pe==="point",Ie=Gs?U.get("text-max-width").evaluate(ft,{},x)*Qo:1/0,Le=It=>{u.allowVerticalPlacement&&Om($n)&&(tn.vertical=RN(dn,i,l,g,Ft,Ie,kr,Hr,It,si,Lt,yu.vertical,!0,Wt,xt,M))};if(!tt&&Mi){const It=gi==="auto"?Mi.map((kn=>zN(kn))):[gi];let Sn=!1;for(let kn=0;kn<It.length;kn++){const Dn=It[kn];if(!tn.horizontal[Dn])if(Sn)tn.horizontal[Dn]=tn.horizontal[0];else{const Qn=RN(dn,i,l,g,Ft,Ie,kr,"center",Dn,si,Lt,yu.horizontal,!1,Wt,xt,M);Qn&&(tn.horizontal[Dn]=Qn,Sn=Qn.positionedLines.length===1)}}Le("left")}else{if(gi==="auto"&&(gi=zN(Hr)),Gs||U.get("text-writing-mode").indexOf("horizontal")>=0||!Om($n)){const It=RN(dn,i,l,g,Ft,Ie,kr,Hr,gi,si,Lt,yu.horizontal,!1,Wt,xt,M);It&&(tn.horizontal[gi]=It)}Le(Gs?"left":gi)}}let hn,Tt,zt,wn,pn,ur,Jn=!1;const cn=U.get("icon-text-fit").evaluate(ft,{},x);if(ft.icon&&ft.icon.hasPrimary()){const $n=t4(ft.icon,u.iconSizeData,q["icon-size"],x,u.zoom,ft,M,ee.iconScaleFactor,L);hn=$n.iconPrimary,zt=$n.iconSecondary;const Cr=hn.toString();if(Tt=h.get(Cr),Tt&&(pn=U.get("icon-offset").evaluate(ft,{},x),ur=U.get("icon-anchor").evaluate(ft,{},x),xn=dse(g.get(Cr),zt?g.get(zt.toString()):void 0,pn,ur),Jn=Tt.sdf,u.sdfIcons===void 0?u.sdfIcons=Tt.sdf:u.sdfIcons!==Tt.sdf&&ai("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Tt.pixelRatio!==u.pixelRatio||U.get("icon-rotate").constantOr(1)!==0)&&(u.iconsNeedLinear=!0)),zt){const kr=zt.toString();wn=h.get(kr)}}Qe=Qe||!(!ft.icon||!ft.icon.hasSecondary());const yn=FN(tn.horizontal)||tn.vertical;u.iconsInText||(u.iconsInText=!!yn&&yn.iconsInText);const er=Wt*ee.textScaleFactor/Qo,{defaultShapedIcon:Bn,verticallyShapedIcon:En}=bse(u,xn,U,ft,x,tn,er,pn,cn);cn!=="none"&&xn&&(LB(xn)||zB(xn))&&(T2(0,Tt,hn,xn,Bn,cn,R,h,g),T2(0,wn,zt,xn,Bn,cn,R,h,g),En&&(T2(0,Tt,hn,xn,En,cn,R,h,g),T2(0,wn,zt,xn,En,cn,R,h,g))),xn=Bn,dt.push({feature:ft,shapedTextOrientations:tn,shapedText:yn,shapedIcon:xn,iconPrimary:hn,iconSecondary:zt,iconOffset:pn,iconAnchor:ur,verticallyShapedIcon:En,layoutTextSize:Wt,layoutIconSize:bn,textOffset:Lt,isSDFIcon:Jn,iconTextFit:cn})}return{featureData:dt,sizes:ee,hasAnySecondaryIcon:Qe,textAlongLine:tt,symbolPlacement:Pe}},s.fm=WB,s.fn=function(u,i,l,h,g,x,b,j,M,R){const{featureData:L,hasAnySecondaryIcon:U,sizes:q,textAlongLine:ee,symbolPlacement:te}=i;for(const le of L){const{shapedIcon:ue,verticallyShapedIcon:ge,feature:Se,shapedTextOrientations:we,shapedText:Pe,layoutTextSize:tt,textOffset:Ke,isSDFIcon:Qe,iconPrimary:dt,iconSecondary:ft,iconTextFit:Ft,iconOffset:xt}=le;n4(ue,R.iconPositions,dt,ft),n4(ge,R.iconPositions,dt,ft),_se(we,R.iconPositions),xse(dt,ft,R.iconPositions),(Pe||ue)&&wse(u,Se,we,ue,ge,M,q,tt,0,Ke,Qe,h,g,b,j,U,Ft,xt,ee,te)}l&&u.generateCollisionDebugBuffers(x,u.collisionBoxArray,q.textScaleFactor)},s.fo=Pn,s.fp=q2,s.fq=At,s.fr=function(u){let i=0;if(new Uint32Array(u,0,1)[0]!==XF){const l=new Uint32Array(u,0,7),[,,h,g,x,b]=l;i=l.byteLength+g+x+b+x,(h!==u.byteLength||i>=u.byteLength)&&ai("Invalid b3dm header information.")}return JF(u,i)},s.fs=function(u,i){const l=aB(u);for(const h of l){for(const g of h.meshes)wie(g);h.lights&&(h.lightMeshIndex=h.meshes.length,h.meshes.push(Sie(h.lights,i)))}return l},s.ft=z2,s.fu=fr,s.fv=Ae,s.fw=du,s.fx=Bl,s.fy=function(u){nl(),ml?.then((i=>{i.keys().then((l=>{for(let h=0;h<l.length-u;h++)i.delete(l[h]).catch((g=>ai(g.message)))})).catch((l=>ai(l.message)))})).catch((i=>ai(i.message)))},s.g=function(u,i){return mc(St(u,{method:"GET"}),i)},s.h=St,s.i=function(u){return Ua.API_STYLE_REGEX.test(u)&&!dc(u)},s.j=function(u){return u.indexOf("mapbox:")===0},s.k=ts,s.l=wo,s.m=function(u){return decodeURIComponent(atob(u).split("").map((i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2))).join(""))},s.n=function(u,i){return mc(St(u,{type:"json"}),i)},s.o=gr,s.p=function(u,i){return mc(St(u,{method:"POST"}),i)},s.q=co,s.r=Oo,s.s=function(u){try{const i=self[u];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch{return!1}},s.t=sd,s.u=function(){return(function u(i){return i?(i^Math.random()*(16>>i/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,u)})()},s.v=function(u){return!!u&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(u)},s.w=ai,s.x=function(){return _n||(_n=new on),_n},s.y=eP,s.z=Fo})),f(["./shared"],(function(s){function w(gt){const Q=gt?gt.url.toString():void 0;return Q?performance.getEntriesByName(Q):[]}function T(gt){if(typeof gt=="number"||typeof gt=="boolean"||typeof gt=="string"||gt==null)return JSON.stringify(gt);if(Array.isArray(gt)){let fe="[";for(const Te of gt)fe+=`${T(Te)},`;return`${fe}]`}let Q="{";for(const fe of Object.keys(gt).sort())Q+=`${fe}:${T(gt[fe])},`;return`${Q}}`}function E(gt){let Q="";for(const fe of s.bu)Q+=`/${T(gt[fe])}`;return Q}class N{constructor(Q){this.keyCache={},this._layers={},this._layerConfigs={},Q&&this.replace(Q)}replace(Q,fe){this._layerConfigs={},this._layers={},this.update(Q,[],fe)}update(Q,fe,Te){this._options=Te;for(const Oe of Q)this._layerConfigs[Oe.id]=Oe,(this._layers[Oe.id]=s.dn(Oe,this.scope,null,this._options)).compileFilter(Te),this.keyCache[Oe.id]&&delete this.keyCache[Oe.id];for(const Oe of fe)delete this.keyCache[Oe],delete this._layerConfigs[Oe],delete this._layers[Oe];this.familiesBySource={};const ke=(function(Oe,ut){const Et={};for(let St=0;St<Oe.length;St++){const nn=Oe[St];let Kt=ut&&ut[nn.id];Kt||(nn.type==="symbol"?Kt=nn.id:(Kt=E(nn),nn.type==="line"&&nn.paint&&(function br(pr){return typeof pr=="string"&&pr==="line-progress"||(Array.isArray(pr)?pr.some(br):!(!pr||typeof pr!="object")&&Object.values(pr).some(br))})(nn.paint["line-width"])&&(Kt+=`/${T(nn.paint["line-width"])}`))),ut&&(ut[nn.id]=Kt);let ir=Et[Kt];ir||(ir=Et[Kt]=[]),ir.push(nn)}const ht=[];for(const St in Et)ht.push(Et[St]);return ht})(Object.values(this._layerConfigs),this.keyCache);for(const Oe of ke){const ut=Oe.map((ir=>this._layers[ir.id])),Et=ut[0];if(Et.visibility==="none")continue;const ht=Et.source||"";let St=this.familiesBySource[ht];St||(St=this.familiesBySource[ht]={});const nn=Et.sourceLayer||"_geojsonTileLayer";let Kt=St[nn];Kt||(Kt=St[nn]=[]),Kt.push(ut)}}}const D=1*s.fa;class V{constructor(Q){const fe={},Te=[];for(const Et in Q){const ht=Q[Et],St=fe[Et]={};for(const nn in ht.glyphs){const Kt=ht.glyphs[+nn];if(!Kt||Kt.bitmap.width===0||Kt.bitmap.height===0)continue;const ir=Kt.metrics.localGlyph?D:1,br={x:0,y:0,w:Kt.bitmap.width+2*ir,h:Kt.bitmap.height+2*ir};Te.push(br),St[nn]=br}}const{w:ke,h:Oe}=s.H(Te),ut=new s.f9({width:ke||1,height:Oe||1});for(const Et in Q){const ht=Q[Et];for(const St in ht.glyphs){const nn=ht.glyphs[+St];if(!nn||nn.bitmap.width===0||nn.bitmap.height===0)continue;const Kt=fe[Et][St],ir=nn.metrics.localGlyph?D:1;s.f9.copy(nn.bitmap,ut,{x:0,y:0},{x:Kt.x+ir,y:Kt.y+ir},nn.bitmap)}}this.image=ut,this.positions=fe}}s.f8(V,"GlyphAtlas");class ${constructor(Q){this.tileID=new s.aM(Q.tileID.overscaledZ,Q.tileID.wrap,Q.tileID.canonical.z,Q.tileID.canonical.x,Q.tileID.canonical.y),this.tileZoom=Q.tileZoom,this.uid=Q.uid,this.zoom=Q.zoom,this.lut=Q.lut,this.canonical=Q.tileID.canonical,this.pixelRatio=Q.pixelRatio,this.tileSize=Q.tileSize,this.source=Q.source,this.scope=Q.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Q.showCollisionBoxes,this.collectResourceTiming=!!Q.request&&Q.request.collectResourceTiming,this.promoteId=Q.promoteId,this.isSymbolTile=Q.isSymbolTile,this.tileTransform=s.aW(Q.tileID.canonical,Q.projection),this.projection=Q.projection,this.worldview=Q.worldview,this.localizableLayerIds=Q.localizableLayerIds,this.brightness=Q.brightness,this.extraShadowCaster=!!Q.extraShadowCaster,this.tessellationStep=Q.tessellationStep,this.scaleFactor=Q.scaleFactor,this.worldview=Q.worldview}parse(Q,fe,Te,ke,Oe,ut){this.status="parsing",this.data=Q,this.collisionBoxArray=new s.b0;const Et=new s.fb(Object.keys(Q.layers).sort()),ht=new s.fc(this.tileID,this.promoteId);ht.bucketLayerIDs=[];const St={},nn=new s.fd(256,256),Kt={featureIndex:ht,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:nn,availableImages:Te,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},ir=[],br=fe.familiesBySource[this.source];for(const Qr in br){const Gr=Q.layers[Qr];if(!Gr)continue;let Wr=!1,Gi=!1,ai=!1;for(const fr of br[Qr])fr[0].type==="symbol"?Wr=!0:Gi=!0,fr[0].is3D()&&fr[0].type!=="model"&&(ai=!0);if(this.extraShadowCaster&&!ai||this.isSymbolTile===!0&&!Wr||this.isSymbolTile===!1&&!Gi)continue;Gr.version===1&&s.w(`Vector tile source "${this.source}" layer "${Qr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ws=Et.encode(Qr),Ks=[];let ca=!1;for(let fr=0,di=0;fr<Gr.length;fr++){const wr=Gr.feature(fr),Fi=ht.getId(wr,Qr);if(this.localizableLayerIds&&this.localizableLayerIds.has(Qr)){const rs=wr.properties?wr.properties.worldview:null;if(this.worldview&&typeof rs=="string")if(rs==="all")wr.properties.$localized=!0;else{if(!rs.split(",").includes(this.worldview))continue;wr.properties.$localized=!0,wr.properties.worldview=this.worldview}}!ca&&wr.properties&&wr.properties.hasOwnProperty(s.fe)&&(ca=!0),Ks.push({feature:wr,id:Fi,index:di,sourceLayerIndex:ws}),di++}ca&&!Kt.elevationFeatures&&Q.layers.hasOwnProperty(s.ff)&&(Kt.elevationFeatures=s.fg.parseFrom(Q.layers[s.ff],this.canonical));for(const fr of br[Qr]){const di=fr[0];if(this.extraShadowCaster&&(!di.is3D()||di.type==="model")||this.isSymbolTile!==void 0&&di.type==="symbol"!==this.isSymbolTile||di.minzoom&&this.zoom<Math.floor(di.minzoom)||di.maxzoom&&this.zoom>=di.maxzoom||di.visibility==="none")continue;B(fr,this.zoom,Kt.brightness,Te,this.worldview);const wr=St[di.id]=di.createBucket({index:ht.bucketLayerIDs.length,layers:fr,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ws,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:ke,worldview:this.worldview});ht.bucketLayerIDs.push(fr.map((rs=>s.C(rs.id,rs.scope))));let Fi=wr.prepare?wr.prepare():null;Fi!=null?(Fi=Fi.then((()=>wr.populate(Ks,Kt,this.tileID.canonical,this.tileTransform))),ir.push(Fi)):wr.populate(Ks,Kt,this.tileID.canonical,this.tileTransform)}}const pr=()=>{let Qr,Gr,Wr,Gi,ai,ws;nn.trim();const Ks={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ca=()=>{if(Qr)return this.status="done",ut(Qr);if(this.extraShadowCaster)this.status="done",ut(null,{buckets:Object.values(St).filter((di=>!di.isEmpty())),featureIndex:ht,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Kt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Gr&&Wr&&Gi){const di=new V(Gr),wr=new Map;for(const[Js,Na]of Wr.entries()){const{imagePosition:Ia}=s.fj(Js,Na,s.fk);wr.set(Js,Ia)}const Fi={};for(const Js in St){const Na=St[Js];Na instanceof s.b1&&(B(Na.layers,this.zoom,Kt.brightness,Te,this.worldview),Fi[Js]=s.fl(Na,Gr,di.positions,Wr,wr,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,ai,this.worldview))}const rs={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(Oe,Wr,ai,(()=>{rs.iconsPending=!1,fr(Fi,di,rs)})),this.rasterizeIfNeeded(Oe,Gi,ws,(()=>{rs.patternsPending=!1,fr(Fi,di,rs)}))}},fr=(di,wr,Fi,rs)=>{if(Fi.iconsPending||Fi.patternsPending)return;const Js=new s.fm(Wr,Gi,this.lut);for(const Na in St){const Ia=St[Na];if(Na in di)s.fn(Ia,di[Na],this.showCollisionBoxes,Te,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,Wr,Js);else if(Ia.hasPattern&&(Ia instanceof s.b7||Ia instanceof s.b8||Ia instanceof s.e4)){B(Ia.layers,this.zoom,Kt.brightness,Te,this.worldview);const id=Object.fromEntries(Js.patternPositions);Ia.addFeatures(Kt,this.tileID.canonical,id,Te,this.tileTransform,this.brightness)}}this.status="done",ut(null,{buckets:Object.values(St).filter((Na=>!Na.isEmpty())),featureIndex:ht,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:wr.image,lineAtlas:nn,imageAtlas:Js,brightness:Kt.brightness})};if(!this.extraShadowCaster){const di=s.fh(Kt.glyphDependencies,(rs=>Object.keys(rs).map(Number)));Object.keys(di).length?Oe.send("getGlyphs",{uid:this.uid,stacks:di},((rs,Js)=>{Qr||(Qr=rs,Gr=Js,ca())}),void 0,!1,Ks):Gr={};const wr=Array.from(Kt.iconDependencies.keys()).map((rs=>s.I.parse(rs)));wr.length?Oe.send("getImages",{images:wr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},((rs,Js)=>{Qr||(Qr=rs,Wr=new Map,ai=this.updateImageMapAndGetImageTaskQueue(Wr,Js,Kt.iconDependencies),ca())}),void 0,!1,Ks):(Wr=new Map,ai=new Map);const Fi=Array.from(Kt.patternDependencies.keys()).map((rs=>s.I.parse(rs)));Fi.length?Oe.send("getImages",{images:Fi,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},((rs,Js)=>{Qr||(Qr=rs,Gi=new Map,ws=this.updateImageMapAndGetImageTaskQueue(Gi,Js,Kt.patternDependencies),ca())}),void 0,!1,Ks):(Gi=new Map,ws=new Map)}if(Kt.elevationFeatures&&Kt.elevationFeatures.length>0){const di=[];for(const Fi of Object.values(St))if(Fi instanceof s.b8){const rs=Fi.getUnevaluatedPortalGraph();rs&&di.push(rs)}const wr=s.fi.evaluate(di);for(const Fi of Object.values(St))if(Fi instanceof s.b8){const rs=Q.layers[Et.decode(Fi.sourceLayerIndex)];Fi.setEvaluatedPortalGraph(wr,rs,this.tileID.canonical,Kt.availableImages,Kt.brightness)}}ca()};ir.length>0?Promise.allSettled(ir).then(pr).catch(ut):pr()}rasterizeIfNeeded(Q,fe,Te,ke){Array.from(fe.values()).some((Oe=>Oe.usvg))?this.rasterize(Q,fe,Te,ke):ke()}updateImageMapAndGetImageTaskQueue(Q,fe,Te){const ke=new Map;for(const Oe of fe.keys()){const ut=Te.get(Oe)||[];for(const Et of ut){const ht=Et.toString(),St=fe.get(Et.id.toString());St.usvg?ke.has(ht)||(ke.set(ht,Et),Q.set(ht,Object.assign({},St))):Q.set(ht,St)}}return ke}rasterize(Q,fe,Te,ke){this.rasterizeTask=Q.send("rasterizeImages",{scope:this.scope,tasks:Te},((Oe,ut)=>{if(!Oe)for(const[Et,ht]of ut.entries()){const St=Object.assign(fe.get(Et),{data:ht});fe.set(Et,St)}ke()}))}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function B(gt,Q,fe,Te,ke){const Oe=new s.aa(Q,{brightness:fe,worldview:ke});for(const ut of gt)ut.recalculate(Oe,Te)}class F extends s.E{constructor(Q,fe,Te,ke,Oe,ut,Et){super(),this.actor=Q,this.layerIndex=fe,this.availableImages=Te,this.availableModels=ke,this.loadVectorData=ut||s.aJ,this.loading={},this.loaded={},this.deduped=new s.aI(Q.scheduler),this.isSpriteLoaded=Oe,this.scheduler=Q.scheduler,this.brightness=Et}loadTile(Q,fe){const Te=Q.uid,ke=Q&&Q.request,Oe=ke&&ke.collectResourceTiming,ut=this.loading[Te]=new $(Q);ut.abort=this.loadVectorData(Q,((Et,ht)=>{const St=!this.loading[Te];if(delete this.loading[Te],ut.cancelRasterize(),St||Et||!ht)return ut.status="done",St||(this.loaded[Te]=ut),fe(Et);const nn=ht.rawData,Kt={};ht.expires&&(Kt.expires=ht.expires),ht.cacheControl&&(Kt.cacheControl=ht.cacheControl),ut.vectorTile=ht.vectorTile||new s.fo(new s.bq(nn));const ir=()=>{ut.parse(ut.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,((br,pr)=>{if(br||!pr)return fe(br);const Qr={};if(Oe){const Gr=w(ke);Gr.length>0&&(Qr.resourceTiming=JSON.parse(JSON.stringify(Gr)))}fe(null,s.h({rawTileData:nn.slice(0)},pr,Kt,Qr))}))};this.isSpriteLoaded?ir():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(ir,{type:"parseTile",isSymbolTile:Q.isSymbolTile,zoom:Q.tileZoom}):ir()})),this.loaded=this.loaded||{},this.loaded[Te]=ut}))}reloadTile(Q,fe){const Te=this.loaded,ke=Q.uid;if(Te&&Te[ke]){const Oe=Te[ke];Oe.scaleFactor=Q.scaleFactor,Oe.showCollisionBoxes=Q.showCollisionBoxes,Oe.projection=Q.projection,Oe.brightness=Q.brightness,Oe.tileTransform=s.aW(Q.tileID.canonical,Q.projection),Oe.extraShadowCaster=Q.extraShadowCaster,Oe.lut=Q.lut,Oe.worldview=Q.worldview;const ut=(Et,ht)=>{const St=Oe.reloadCallback;St&&(delete Oe.reloadCallback,Oe.parse(Oe.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,St)),fe(Et,ht)};Oe.status==="parsing"?Oe.reloadCallback=ut:Oe.status==="done"&&(Oe.vectorTile?Oe.parse(Oe.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,ut):ut())}else fe(null,void 0)}abortTile(Q,fe){const Te=Q.uid,ke=this.loading[Te];ke&&(ke.abort&&ke.abort(),delete this.loading[Te]),fe()}removeTile(Q,fe){const Te=this.loaded,ke=Q.uid;Te&&Te[ke]&&delete Te[ke],fe()}}class K{loadTile(Q,fe){const{uid:Te,encoding:ke,rawImageData:Oe,padding:ut}=Q,Et=ImageBitmap&&Oe instanceof ImageBitmap?this.getImageData(Oe,ut):Oe;fe(null,new s.fp(Te,Et,ke,ut<1))}reloadTile(Q,fe){fe(null,null)}abortTile(Q,fe){fe()}removeTile(Q,fe){fe()}getImageData(Q,fe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Q.width,Q.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Q.width,this.offscreenCanvas.height=Q.height,this.offscreenCanvasContext.drawImage(Q,0,0,Q.width,Q.height);const Te=this.offscreenCanvasContext.getImageData(-fe,-fe,Q.width+2*fe,Q.height+2*fe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Te}}s.bp.setPbf(s.bq);class Y{constructor(Q){this._mrt=new s.bp(Q.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=Q.uid,this.tileID=Q.tileID,this.source=Q.source}parse(Q,fe){const Te=this._mrt;this.status="parsing",this._entireBuffer=Q;try{Te.parseHeader(Q),this._isHeaderLoaded=!0;const ke=[];for(const Oe in Te.layers){const ut=Te.getLayer(Oe),Et=ut.getDataRange(ut.getBandList()),ht=Te.createDecodingTask(Et),St=Q.slice(Et.firstByte,Et.lastByte+1),nn=s.bp.performDecoding(St,ht).then((Kt=>ht.complete(null,Kt))).catch((Kt=>ht.complete(Kt,null)));ke.push(nn)}Promise.allSettled(ke).then((()=>fe(null,Te))).catch((Oe=>fe(Oe)))}catch(ke){fe(ke)}}}class X{constructor(Q){this.actor=Q,this.loading={},this.loaded={}}loadTile(Q,fe){const Te=Q.uid,ke=Q.request,Oe=this.loading[Te]=new Y(Q),{cancel:ut}=s.br(ke,((Et,ht,St,nn)=>{const Kt=!this.loading[Te];if(delete this.loading[Te],Kt||Et||!ht)return Oe.status="done",Kt||(this.loaded[Te]=Oe),fe(Et);Oe.parse(ht,((ir,br)=>{if(ir||!br)return fe(ir);fe(null,br,St,nn)})),this.loaded[Te]=Oe}));Oe.abort=ut}reloadTile(Q,fe){fe(null,void 0)}abortTile(Q,fe){const Te=Q.uid,ke=this.loading[Te];ke&&(ke.abort&&ke.abort(),delete this.loading[Te]),fe()}removeTile(Q,fe){const Te=Q.uid;this.loaded[Te]&&delete this.loaded[Te],fe()}decodeRasterArray(Q,fe){s.bp.performDecoding(Q.buffer,Q.task).then((Te=>fe(null,Te))).catch((Te=>fe(Te)))}}const ae=s.fq.prototype.toGeoJSON;class Z{constructor(Q){this._feature=Q,this.extent=s.aj,this.type=Q.type,this.properties=Q.tags,"id"in Q&&!isNaN(Q.id)&&(this.id=parseInt(Q.id,10))}loadGeometry(){if(this._feature.type===1){const Q=[];for(const fe of this._feature.geometry)Q.push([new s.P(fe[0],fe[1])]);return Q}{const Q=[];for(const fe of this._feature.geometry){const Te=[];for(const ke of fe)Te.push(new s.P(ke[0],ke[1]));Q.push(Te)}return Q}}toGeoJSON(Q,fe,Te){return ae.call(this,Q,fe,Te)}}class se{constructor(Q,fe){this.name=Q,this.extent=s.aj,this.length=fe.length,this._jsonFeatures=fe}feature(Q){return new Z(this._jsonFeatures[Q])}}class he{constructor(Q){this.layers={},this.extent=s.aj;for(const fe of Object.keys(Q))this.layers[fe]=new se(fe,Q[fe])}}const ye=64/4096,Ce=128;class Ve{constructor(){this.features=new Map}clear(){this.features.clear()}load(Q=[],fe){for(const Te of Q){const ke=Te.id;if(ke==null)continue;let Oe=this.features.get(ke);Oe&&this.updateCache(Oe,fe),Te.geometry?(Oe=$e(Te),this.updateCache(Oe,fe),this.features.set(ke,Oe)):this.features.delete(ke),this.updateCache(Oe,fe)}}updateCache(Q,fe){for(const{canonical:Te,uid:ke}of Object.values(fe)){const{z:Oe,x:ut,y:Et}=Te;Re(Q,Math.pow(2,Oe),ut,Et)&&delete fe[ke]}}getTile(Q,fe,Te){const ke=Math.pow(2,Q),Oe=[];for(const ut of this.features.values())Re(ut,ke,fe,Te)&&Oe.push(Ee(ut,ke,fe,Te));return{features:Oe}}getFeatures(){return[...this.features.values()]}}function Re({minX:gt,minY:Q,maxX:fe,maxY:Te},ke,Oe,ut){return gt<(Oe+1+ye)/ke&&Q<(ut+1+ye)/ke&&fe>(Oe-ye)/ke&&Te>(ut-ye)/ke}function $e(gt){const{id:Q,geometry:fe,properties:Te}=gt;if(!fe)return;if(fe.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:ke,coordinates:Oe}=fe,ut={id:Q,type:1,geometry:[],tags:Te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Et=ut.geometry;if(ke==="Point")nt(Oe,Et,ut);else if(ke==="MultiPoint")for(const ht of Oe)nt(ht,Et,ut);else if(ke==="LineString")ut.type=2,Me(Oe,Et,ut);else if(ke==="MultiLineString")ut.type=2,rt(Oe,Et,ut);else if(ke==="Polygon")ut.type=3,rt(Oe,Et,ut,!0);else{if(ke!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");ut.type=3;for(const ht of Oe)rt(ht,Et,ut,!0)}return ut}function nt([gt,Q],fe,Te){const ke=s.aD(gt);let Oe=s.aH(Q);Oe=Oe<0?0:Oe>1?1:Oe,fe.push(ke,Oe),Te.minX=Math.min(Te.minX,ke),Te.minY=Math.min(Te.minY,Oe),Te.maxX=Math.max(Te.maxX,ke),Te.maxY=Math.max(Te.maxY,Oe)}function Me(gt,Q,fe,Te=!1,ke=!1){const Oe=[];for(const ut of gt)nt(ut,Oe,fe);Q.push(Oe),Te&&(function(ut,Et){let ht=0;for(let St=0,nn=ut.length,Kt=nn-2;St<nn;Kt=St,St+=2)ht+=(ut[St]-ut[Kt])*(ut[St+1]+ut[Kt+1]);if(ht>0===Et)for(let St=0,nn=ut.length;St<nn/2;St+=2){const Kt=ut[St],ir=ut[St+1];ut[St]=ut[nn-2-St],ut[St+1]=ut[nn-1-St],ut[nn-2-St]=Kt,ut[nn-1-St]=ir}})(Oe,ke)}function rt(gt,Q,fe,Te=!1){for(let ke=0;ke<gt.length;ke++)Me(gt[ke],Q,fe,Te,ke===0)}function Ee(gt,Q,fe,Te){const{id:ke,type:Oe,geometry:ut,tags:Et}=gt,ht=[];if(Oe===1)(function(St,nn,Kt,ir,br){for(let pr=0;pr<St.length;pr+=2){const Qr=Math.round(s.aj*(St[pr+0]*nn-Kt)),Gr=Math.round(s.aj*(St[pr+1]*nn-ir));br.push([Qr,Gr])}})(ut,Q,fe,Te,ht);else for(const St of ut)it(St,Q,fe,Te,ht);return{id:ke,type:Oe,geometry:ht,tags:Et}}function it(gt,Q,fe,Te,ke){const Oe=-Ce,ut=s.aj+Ce;let Et;for(let ht=0;ht<gt.length-2;ht+=2){let St=Math.round(s.aj*(gt[ht+0]*Q-fe)),nn=Math.round(s.aj*(gt[ht+1]*Q-Te)),Kt=Math.round(s.aj*(gt[ht+2]*Q-fe)),ir=Math.round(s.aj*(gt[ht+3]*Q-Te));const br=Kt-St,pr=ir-nn;St<Oe&&Kt<Oe||(St<Oe?(nn+=Math.round(pr*((Oe-St)/br)),St=Oe):Kt<Oe&&(ir=nn+Math.round(pr*((Oe-St)/br)),Kt=Oe),nn<Oe&&ir<Oe||(nn<Oe?(St+=Math.round(br*((Oe-nn)/pr)),nn=Oe):ir<Oe&&(Kt=St+Math.round(br*((Oe-nn)/pr)),ir=Oe),St>=ut&&Kt>=ut||(St>=ut?(nn+=Math.round(pr*((ut-St)/br)),St=ut):Kt>=ut&&(ir=nn+Math.round(pr*((ut-St)/br)),Kt=ut),nn>=ut&&ir>=ut||(nn>=ut?(St+=Math.round(br*((ut-nn)/pr)),nn=ut):ir>=ut&&(Kt=St+Math.round(br*((ut-nn)/pr)),ir=ut),Et&&St===Et[Et.length-1][0]&&nn===Et[Et.length-1][1]||(Et=[[St,nn]],ke.push(Et)),Et.push([Kt,ir])))))}}function et({name:gt,features:Q},fe){fe.writeStringField(1,gt),fe.writeVarintField(5,s.aj);const Te=new Map,ke=new Map,Oe={keys:Te,values:ke,feature:null};for(const ut of Q)Oe.feature=ut,fe.writeMessage(2,mt,Oe);for(const ut of Te.keys())fe.writeStringField(3,ut);for(const ut of ke.keys())fe.writeMessage(4,jt,ut)}function mt(gt,Q){const fe=gt.feature;fe.id===void 0||isNaN(+fe.id)||Q.writeVarintField(1,+fe.id),fe.tags&&Q.writeMessage(2,He,gt),Q.writeVarintField(3,fe.type),Q.writeMessage(4,Je,fe)}function He({keys:gt,values:Q,feature:fe},Te){for(const ke of Object.keys(fe.tags)){let Oe=fe.tags[ke];if(Oe===null)continue;let ut=gt.get(ke);ut===void 0&&(ut=gt.size,gt.set(ke,ut)),Te.writeVarint(ut);const Et=typeof Oe;Et!=="string"&&Et!=="boolean"&&Et!=="number"&&(Oe=JSON.stringify(Oe));let ht=Q.get(Oe);ht===void 0&&(ht=Q.size,Q.set(Oe,ht)),Te.writeVarint(ht)}}function pt(gt,Q){return(Q<<3)+(7&gt)}function We(gt){return gt<<1^gt>>31}function Je(gt,Q){const{geometry:fe,type:Te}=gt;let ke=0,Oe=0;if(Te===1){Q.writeVarint(pt(1,fe.length));for(const ut of fe){const Et=ut[0]-ke,ht=ut[1]-Oe;Q.writeVarint(We(Et)),Q.writeVarint(We(ht)),ke+=Et,Oe+=ht}}else for(const ut of fe){Q.writeVarint(pt(1,1));const Et=ut.length-(Te===3?1:0);for(let ht=0;ht<Et;ht++){ht===1&&Q.writeVarint(pt(2,Et-1));const St=ut[ht][0]-ke,nn=ut[ht][1]-Oe;Q.writeVarint(We(St)),Q.writeVarint(We(nn)),ke+=St,Oe+=nn}Te===3&&Q.writeVarint(pt(7,1))}}function jt(gt,Q){const fe=typeof gt;fe==="string"?Q.writeStringField(1,gt):fe==="boolean"?Q.writeBooleanField(7,gt):fe==="number"&&(gt%1!=0?Q.writeDoubleField(3,gt):gt<0?Q.writeSVarintField(6,gt):Q.writeVarintField(5,gt))}const Pt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:gt=>gt},Ot=Math.fround||(Mt=new Float32Array(1),gt=>(Mt[0]=+gt,Mt[0]));var Mt;const an=3,Jt=5,Cn=6;class nr{constructor(Q){this.options=Object.assign(Object.create(Pt),Q),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Q){const{log:fe,minZoom:Te,maxZoom:ke}=this.options;fe&&console.time("total time");const Oe=`prepare ${Q.length} points`;fe&&console.time(Oe),this.points=Q;const ut=[];for(let ht=0;ht<Q.length;ht++){const St=Q[ht];if(!St.geometry)continue;const[nn,Kt]=St.geometry.coordinates,ir=Ot(or(nn)),br=Ot(Rr(Kt));ut.push(ir,br,1/0,ht,-1,1),this.options.reduce&&ut.push(0)}let Et=this.trees[ke+1]=this._createTree(ut);fe&&console.timeEnd(Oe);for(let ht=ke;ht>=Te;ht--){const St=+Date.now();Et=this.trees[ht]=this._createTree(this._cluster(Et,ht)),fe&&console.log("z%d: %d clusters in %dms",ht,Et.numItems,+Date.now()-St)}return fe&&console.timeEnd("total time"),this}getClusters(Q,fe){let Te=((Q[0]+180)%360+360)%360-180;const ke=Math.max(-90,Math.min(90,Q[1]));let Oe=Q[2]===180?180:((Q[2]+180)%360+360)%360-180;const ut=Math.max(-90,Math.min(90,Q[3]));if(Q[2]-Q[0]>=360)Te=-180,Oe=180;else if(Te>Oe){const Kt=this.getClusters([Te,ke,180,ut],fe),ir=this.getClusters([-180,ke,Oe,ut],fe);return Kt.concat(ir)}const Et=this.trees[this._limitZoom(fe)],ht=Et.range(or(Te),Rr(ut),or(Oe),Rr(ke)),St=Et.data,nn=[];for(const Kt of ht){const ir=this.stride*Kt;nn.push(St[ir+Jt]>1?sn(St,ir,this.clusterProps):this.points[St[ir+an]])}return nn}getChildren(Q){const fe=this._getOriginId(Q),Te=this._getOriginZoom(Q),ke="No cluster with the specified id.",Oe=this.trees[Te];if(!Oe)throw new Error(ke);const ut=Oe.data;if(fe*this.stride>=ut.length)throw new Error(ke);const Et=this.options.radius/(this.options.extent*Math.pow(2,Te-1)),ht=Oe.within(ut[fe*this.stride],ut[fe*this.stride+1],Et),St=[];for(const nn of ht){const Kt=nn*this.stride;ut[Kt+4]===Q&&St.push(ut[Kt+Jt]>1?sn(ut,Kt,this.clusterProps):this.points[ut[Kt+an]])}if(St.length===0)throw new Error(ke);return St}getLeaves(Q,fe,Te){const ke=[];return this._appendLeaves(ke,Q,fe=fe||10,Te=Te||0,0),ke}getTile(Q,fe,Te){const ke=this.trees[this._limitZoom(Q)],Oe=Math.pow(2,Q),{extent:ut,radius:Et}=this.options,ht=Et/ut,St=(Te-ht)/Oe,nn=(Te+1+ht)/Oe,Kt={features:[]};return this._addTileFeatures(ke.range((fe-ht)/Oe,St,(fe+1+ht)/Oe,nn),ke.data,fe,Te,Oe,Kt),fe===0&&this._addTileFeatures(ke.range(1-ht/Oe,St,1,nn),ke.data,Oe,Te,Oe,Kt),fe===Oe-1&&this._addTileFeatures(ke.range(0,St,ht/Oe,nn),ke.data,-1,Te,Oe,Kt),Kt.features.length?Kt:null}getClusterExpansionZoom(Q){let fe=this._getOriginZoom(Q)-1;for(;fe<=this.options.maxZoom;){const Te=this.getChildren(Q);if(fe++,Te.length!==1)break;Q=Te[0].properties.cluster_id}return fe}_appendLeaves(Q,fe,Te,ke,Oe){const ut=this.getChildren(fe);for(const Et of ut){const ht=Et.properties;if(ht&&ht.cluster?Oe+ht.point_count<=ke?Oe+=ht.point_count:Oe=this._appendLeaves(Q,ht.cluster_id,Te,ke,Oe):Oe<ke?Oe++:Q.push(Et),Q.length===Te)break}return Oe}_createTree(Q){const fe=new s.c0(Q.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Te=0;Te<Q.length;Te+=this.stride)fe.add(Q[Te],Q[Te+1]);return fe.finish(),fe.data=Q,fe}_addTileFeatures(Q,fe,Te,ke,Oe,ut){for(const Et of Q){const ht=Et*this.stride,St=fe[ht+Jt]>1;let nn,Kt,ir;if(St)nn=zr(fe,ht,this.clusterProps),Kt=fe[ht],ir=fe[ht+1];else{const Qr=this.points[fe[ht+an]];nn=Qr.properties;const[Gr,Wr]=Qr.geometry.coordinates;Kt=or(Gr),ir=Rr(Wr)}const br={type:1,geometry:[[Math.round(this.options.extent*(Kt*Oe-Te)),Math.round(this.options.extent*(ir*Oe-ke))]],tags:nn};let pr;pr=St||this.options.generateId?fe[ht+an]:this.points[fe[ht+an]].id,pr!==void 0&&(br.id=pr),ut.features.push(br)}}_limitZoom(Q){return Math.max(this.options.minZoom,Math.min(Math.floor(+Q),this.options.maxZoom+1))}_cluster(Q,fe){const{radius:Te,extent:ke,reduce:Oe,minPoints:ut}=this.options,Et=Te/(ke*Math.pow(2,fe)),ht=Q.data,St=[],nn=this.stride;for(let Kt=0;Kt<ht.length;Kt+=nn){if(ht[Kt+2]<=fe)continue;ht[Kt+2]=fe;const ir=ht[Kt],br=ht[Kt+1],pr=Q.within(ht[Kt],ht[Kt+1],Et),Qr=ht[Kt+Jt];let Gr=Qr;for(const Wr of pr){const Gi=Wr*nn;ht[Gi+2]>fe&&(Gr+=ht[Gi+Jt])}if(Gr>Qr&&Gr>=ut){let Wr,Gi=ir*Qr,ai=br*Qr,ws=-1;const Ks=(Kt/nn<<5)+(fe+1)+this.points.length;for(const ca of pr){const fr=ca*nn;if(ht[fr+2]<=fe)continue;ht[fr+2]=fe;const di=ht[fr+Jt];Gi+=ht[fr]*di,ai+=ht[fr+1]*di,ht[fr+4]=Ks,Oe&&(Wr||(Wr=this._map(ht,Kt,!0),ws=this.clusterProps.length,this.clusterProps.push(Wr)),Oe(Wr,this._map(ht,fr)))}ht[Kt+4]=Ks,St.push(Gi/Gr,ai/Gr,1/0,Ks,-1,Gr),Oe&&St.push(ws)}else{for(let Wr=0;Wr<nn;Wr++)St.push(ht[Kt+Wr]);if(Gr>1)for(const Wr of pr){const Gi=Wr*nn;if(!(ht[Gi+2]<=fe)){ht[Gi+2]=fe;for(let ai=0;ai<nn;ai++)St.push(ht[Gi+ai])}}}}return St}_getOriginId(Q){return Q-this.points.length>>5}_getOriginZoom(Q){return(Q-this.points.length)%32}_map(Q,fe,Te){if(Q[fe+Jt]>1){const ut=this.clusterProps[Q[fe+Cn]];return Te?Object.assign({},ut):ut}const ke=this.points[Q[fe+an]].properties,Oe=this.options.map(ke);return Te&&Oe===ke?Object.assign({},Oe):Oe}}function sn(gt,Q,fe){return{type:"Feature",id:gt[Q+an],properties:zr(gt,Q,fe),geometry:{type:"Point",coordinates:[(Te=gt[Q],360*(Te-.5)),qr(gt[Q+1])]}};var Te}function zr(gt,Q,fe){const Te=gt[Q+Jt],ke=Te>=1e4?`${Math.round(Te/1e3)}k`:Te>=1e3?Math.round(Te/100)/10+"k":Te,Oe=gt[Q+Cn],ut=Oe===-1?{}:Object.assign({},fe[Oe]);return Object.assign(ut,{cluster:!0,cluster_id:gt[Q+an],point_count:Te,point_count_abbreviated:ke})}function or(gt){return gt/360+.5}function Rr(gt){const Q=Math.sin(gt*Math.PI/180),fe=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return fe<0?0:fe>1?1:fe}function qr(gt){const Q=(180-360*gt)*Math.PI/180;return 360*Math.atan(Math.exp(Q))/Math.PI-90}function Nn(gt,Q,fe,Te){let ke=Te;const Oe=Q+(fe-Q>>1);let ut,Et=fe-Q;const ht=gt[Q],St=gt[Q+1],nn=gt[fe],Kt=gt[fe+1];for(let ir=Q+3;ir<fe;ir+=3){const br=ci(gt[ir],gt[ir+1],ht,St,nn,Kt);if(br>ke)ut=ir,ke=br;else if(br===ke){const pr=Math.abs(ir-Oe);pr<Et&&(ut=ir,Et=pr)}}ke>Te&&(ut-Q>3&&Nn(gt,Q,ut,Te),gt[ut+2]=ke,fe-ut>3&&Nn(gt,ut,fe,Te))}function ci(gt,Q,fe,Te,ke,Oe){let ut=ke-fe,Et=Oe-Te;if(ut!==0||Et!==0){const ht=((gt-fe)*ut+(Q-Te)*Et)/(ut*ut+Et*Et);ht>1?(fe=ke,Te=Oe):ht>0&&(fe+=ut*ht,Te+=Et*ht)}return ut=gt-fe,Et=Q-Te,ut*ut+Et*Et}function ui(gt,Q,fe,Te){const ke={id:gt??null,type:Q,geometry:fe,tags:Te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Q==="Point"||Q==="MultiPoint"||Q==="LineString")st(ke,fe);else if(Q==="Polygon")st(ke,fe[0]);else if(Q==="MultiLineString")for(const Oe of fe)st(ke,Oe);else if(Q==="MultiPolygon")for(const Oe of fe)st(ke,Oe[0]);return ke}function st(gt,Q){for(let fe=0;fe<Q.length;fe+=3)gt.minX=Math.min(gt.minX,Q[fe]),gt.minY=Math.min(gt.minY,Q[fe+1]),gt.maxX=Math.max(gt.maxX,Q[fe]),gt.maxY=Math.max(gt.maxY,Q[fe+1])}function qt(gt,Q,fe,Te){if(!Q.geometry)return;const ke=Q.geometry.coordinates;if(ke&&ke.length===0)return;const Oe=Q.geometry.type,ut=Math.pow(fe.tolerance/((1<<fe.maxZoom)*fe.extent),2);let Et=[],ht=Q.id;if(fe.promoteId?ht=Q.properties[fe.promoteId]:fe.generateId&&(ht=Te||0),Oe==="Point")rn(ke,Et);else if(Oe==="MultiPoint")for(const St of ke)rn(St,Et);else if(Oe==="LineString")Wn(ke,Et,ut,!1);else if(Oe==="MultiLineString"){if(fe.lineMetrics){for(const St of ke)Et=[],Wn(St,Et,ut,!1),gt.push(ui(ht,"LineString",Et,Q.properties));return}Vt(ke,Et,ut,!1)}else if(Oe==="Polygon")Vt(ke,Et,ut,!0);else{if(Oe!=="MultiPolygon"){if(Oe==="GeometryCollection"){for(const St of Q.geometry.geometries)qt(gt,{id:ht,geometry:St,properties:Q.properties},fe,Te);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const St of ke){const nn=[];Vt(St,nn,ut,!0),Et.push(nn)}}gt.push(ui(ht,Oe,Et,Q.properties))}function rn(gt,Q){Q.push(un(gt[0]),hr(gt[1]),0)}function Wn(gt,Q,fe,Te){let ke,Oe,ut=0;for(let ht=0;ht<gt.length;ht++){const St=un(gt[ht][0]),nn=hr(gt[ht][1]);Q.push(St,nn,0),ht>0&&(ut+=Te?(ke*nn-St*Oe)/2:Math.sqrt(Math.pow(St-ke,2)+Math.pow(nn-Oe,2))),ke=St,Oe=nn}const Et=Q.length-3;Q[2]=1,Nn(Q,0,Et,fe),Q[Et+2]=1,Q.size=Math.abs(ut),Q.start=0,Q.end=Q.size}function Vt(gt,Q,fe,Te){for(let ke=0;ke<gt.length;ke++){const Oe=[];Wn(gt[ke],Oe,fe,Te),Q.push(Oe)}}function un(gt){return gt/360+.5}function hr(gt){const Q=Math.sin(gt*Math.PI/180),fe=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return fe<0?0:fe>1?1:fe}function $t(gt,Q,fe,Te,ke,Oe,ut,Et){if(Te/=Q,Oe>=(fe/=Q)&&ut<Te)return gt;if(ut<fe||Oe>=Te)return null;const ht=[];for(const St of gt){const nn=St.geometry;let Kt=St.type;const ir=ke===0?St.minX:St.minY,br=ke===0?St.maxX:St.maxY;if(ir>=fe&&br<Te){ht.push(St);continue}if(br<fe||ir>=Te)continue;let pr=[];if(Kt==="Point"||Kt==="MultiPoint")lr(nn,pr,fe,Te,ke);else if(Kt==="LineString")ze(nn,pr,fe,Te,ke,!1,Et.lineMetrics);else if(Kt==="MultiLineString")jn(nn,pr,fe,Te,ke,!1);else if(Kt==="Polygon")jn(nn,pr,fe,Te,ke,!0);else if(Kt==="MultiPolygon")for(const Qr of nn){const Gr=[];jn(Qr,Gr,fe,Te,ke,!0),Gr.length&&pr.push(Gr)}if(pr.length){if(Et.lineMetrics&&Kt==="LineString"){for(const Qr of pr)ht.push(ui(St.id,Kt,Qr,St.tags));continue}Kt!=="LineString"&&Kt!=="MultiLineString"||(pr.length===1?(Kt="LineString",pr=pr[0]):Kt="MultiLineString"),Kt!=="Point"&&Kt!=="MultiPoint"||(Kt=pr.length===3?"Point":"MultiPoint"),ht.push(ui(St.id,Kt,pr,St.tags))}}return ht.length?ht:null}function lr(gt,Q,fe,Te,ke){for(let Oe=0;Oe<gt.length;Oe+=3){const ut=gt[Oe+ke];ut>=fe&&ut<=Te&&Xn(Q,gt[Oe],gt[Oe+1],gt[Oe+2])}}function ze(gt,Q,fe,Te,ke,Oe,ut){let Et=Fe(gt);const ht=ke===0?mr:Ur;let St,nn,Kt=gt.start;for(let Gr=0;Gr<gt.length-3;Gr+=3){const Wr=gt[Gr],Gi=gt[Gr+1],ai=gt[Gr+2],ws=gt[Gr+3],Ks=gt[Gr+4],ca=ke===0?Wr:Gi,fr=ke===0?ws:Ks;let di=!1;ut&&(St=Math.sqrt(Math.pow(Wr-ws,2)+Math.pow(Gi-Ks,2))),ca<fe?fr>fe&&(nn=ht(Et,Wr,Gi,ws,Ks,fe),ut&&(Et.start=Kt+St*nn)):ca>Te?fr<Te&&(nn=ht(Et,Wr,Gi,ws,Ks,Te),ut&&(Et.start=Kt+St*nn)):Xn(Et,Wr,Gi,ai),fr<fe&&ca>=fe&&(nn=ht(Et,Wr,Gi,ws,Ks,fe),di=!0),fr>Te&&ca<=Te&&(nn=ht(Et,Wr,Gi,ws,Ks,Te),di=!0),!Oe&&di&&(ut&&(Et.end=Kt+St*nn),Q.push(Et),Et=Fe(gt)),ut&&(Kt+=St)}let ir=gt.length-3;const br=gt[ir],pr=gt[ir+1],Qr=ke===0?br:pr;Qr>=fe&&Qr<=Te&&Xn(Et,br,pr,gt[ir+2]),ir=Et.length-3,Oe&&ir>=3&&(Et[ir]!==Et[0]||Et[ir+1]!==Et[1])&&Xn(Et,Et[0],Et[1],Et[2]),Et.length&&Q.push(Et)}function Fe(gt){const Q=[];return Q.size=gt.size,Q.start=gt.start,Q.end=gt.end,Q}function jn(gt,Q,fe,Te,ke,Oe){for(const ut of gt)ze(ut,Q,fe,Te,ke,Oe,!1)}function Xn(gt,Q,fe,Te){gt.push(Q,fe,Te)}function mr(gt,Q,fe,Te,ke,Oe){const ut=(Oe-Q)/(Te-Q);return Xn(gt,Oe,fe+(ke-fe)*ut,1),ut}function Ur(gt,Q,fe,Te,ke,Oe){const ut=(Oe-fe)/(ke-fe);return Xn(gt,Q+(Te-Q)*ut,Oe,1),ut}function yi(gt,Q){const fe=[];for(let Te=0;Te<gt.length;Te++){const ke=gt[Te],Oe=ke.type;let ut;if(Oe==="Point"||Oe==="MultiPoint"||Oe==="LineString")ut=Hi(ke.geometry,Q);else if(Oe==="MultiLineString"||Oe==="Polygon"){ut=[];for(const Et of ke.geometry)ut.push(Hi(Et,Q))}else if(Oe==="MultiPolygon"){ut=[];for(const Et of ke.geometry){const ht=[];for(const St of Et)ht.push(Hi(St,Q));ut.push(ht)}}fe.push(ui(ke.id,Oe,ut,ke.tags))}return fe}function Hi(gt,Q){const fe=[];fe.size=gt.size,gt.start!==void 0&&(fe.start=gt.start,fe.end=gt.end);for(let Te=0;Te<gt.length;Te+=3)fe.push(gt[Te]+Q,gt[Te+1],gt[Te+2]);return fe}function xr(gt,Q){if(gt.transformed)return gt;const fe=1<<gt.z,Te=gt.x,ke=gt.y;for(const Oe of gt.features){const ut=Oe.geometry,Et=Oe.type;if(Oe.geometry=[],Et===1)for(let ht=0;ht<ut.length;ht+=2)Oe.geometry.push(dr(ut[ht],ut[ht+1],Q,fe,Te,ke));else for(let ht=0;ht<ut.length;ht++){const St=[];for(let nn=0;nn<ut[ht].length;nn+=2)St.push(dr(ut[ht][nn],ut[ht][nn+1],Q,fe,Te,ke));Oe.geometry.push(St)}}return gt.transformed=!0,gt}function dr(gt,Q,fe,Te,ke,Oe){return[Math.round(fe*(gt*Te-ke)),Math.round(fe*(Q*Te-Oe))]}function Ki(gt,Q,fe,Te,ke){const Oe=Q===ke.maxZoom?0:ke.tolerance/((1<<Q)*ke.extent),ut={features:[],numPoints:0,numSimplified:0,numFeatures:gt.length,source:null,x:fe,y:Te,z:Q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Et of gt)Di(ut,Et,Oe,ke);return ut}function Di(gt,Q,fe,Te){const ke=Q.geometry,Oe=Q.type,ut=[];if(gt.minX=Math.min(gt.minX,Q.minX),gt.minY=Math.min(gt.minY,Q.minY),gt.maxX=Math.max(gt.maxX,Q.maxX),gt.maxY=Math.max(gt.maxY,Q.maxY),Oe==="Point"||Oe==="MultiPoint")for(let Et=0;Et<ke.length;Et+=3)ut.push(ke[Et],ke[Et+1]),gt.numPoints++,gt.numSimplified++;else if(Oe==="LineString")Ji(ut,ke,gt,fe,!1,!1);else if(Oe==="MultiLineString"||Oe==="Polygon")for(let Et=0;Et<ke.length;Et++)Ji(ut,ke[Et],gt,fe,Oe==="Polygon",Et===0);else if(Oe==="MultiPolygon")for(let Et=0;Et<ke.length;Et++){const ht=ke[Et];for(let St=0;St<ht.length;St++)Ji(ut,ht[St],gt,fe,!0,St===0)}if(ut.length){let Et=Q.tags||null;if(Oe==="LineString"&&Te.lineMetrics){Et={};for(const St in Q.tags)Et[St]=Q.tags[St];Et.mapbox_clip_start=ke.start/ke.size,Et.mapbox_clip_end=ke.end/ke.size}const ht={geometry:ut,type:Oe==="Polygon"||Oe==="MultiPolygon"?3:Oe==="LineString"||Oe==="MultiLineString"?2:1,tags:Et};Q.id!==null&&(ht.id=Q.id),gt.features.push(ht)}}function Ji(gt,Q,fe,Te,ke,Oe){const ut=Te*Te;if(Te>0&&Q.size<(ke?ut:Te))return void(fe.numPoints+=Q.length/3);const Et=[];for(let ht=0;ht<Q.length;ht+=3)(Te===0||Q[ht+2]>ut)&&(fe.numSimplified++,Et.push(Q[ht],Q[ht+1])),fe.numPoints++;ke&&(function(ht,St){let nn=0;for(let Kt=0,ir=ht.length,br=ir-2;Kt<ir;br=Kt,Kt+=2)nn+=(ht[Kt]-ht[br])*(ht[Kt+1]+ht[br+1]);if(nn>0===St)for(let Kt=0,ir=ht.length;Kt<ir/2;Kt+=2){const br=ht[Kt],pr=ht[Kt+1];ht[Kt]=ht[ir-2-Kt],ht[Kt+1]=ht[ir-1-Kt],ht[ir-2-Kt]=br,ht[ir-1-Kt]=pr}})(Et,Oe),gt.push(Et)}const bs={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ys{constructor(Q,fe){const Te=(fe=this.options=(function(Oe,ut){for(const Et in ut)Oe[Et]=ut[Et];return Oe})(Object.create(bs),fe)).debug;if(Te&&console.time("preprocess data"),fe.maxZoom<0||fe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(fe.promoteId&&fe.generateId)throw new Error("promoteId and generateId cannot be used together.");let ke=(function(Oe,ut){const Et=[];if(Oe.type==="FeatureCollection")for(let ht=0;ht<Oe.features.length;ht++)qt(Et,Oe.features[ht],ut,ht);else qt(Et,Oe.type==="Feature"?Oe:{geometry:Oe},ut);return Et})(Q,fe);this.tiles={},this.tileCoords=[],Te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",fe.indexMaxZoom,fe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ke=(function(Oe,ut){const Et=ut.buffer/ut.extent;let ht=Oe;const St=$t(Oe,1,-1-Et,Et,0,-1,2,ut),nn=$t(Oe,1,1-Et,2+Et,0,-1,2,ut);return(St||nn)&&(ht=$t(Oe,1,-Et,1+Et,0,-1,2,ut)||[],St&&(ht=yi(St,1).concat(ht)),nn&&(ht=ht.concat(yi(nn,-1)))),ht})(ke,fe),ke.length&&this.splitTile(ke,0,0,0),Te&&(ke.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Q,fe,Te,ke,Oe,ut,Et){const ht=[Q,fe,Te,ke],St=this.options,nn=St.debug;for(;ht.length;){ke=ht.pop(),Te=ht.pop(),fe=ht.pop(),Q=ht.pop();const Kt=1<<fe,ir=Vr(fe,Te,ke);let br=this.tiles[ir];if(!br&&(nn>1&&console.time("creation"),br=this.tiles[ir]=Ki(Q,fe,Te,ke,St),this.tileCoords.push({z:fe,x:Te,y:ke}),nn)){nn>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",fe,Te,ke,br.numFeatures,br.numPoints,br.numSimplified),console.timeEnd("creation"));const di=`z${fe}`;this.stats[di]=(this.stats[di]||0)+1,this.total++}if(br.source=Q,Oe==null){if(fe===St.indexMaxZoom||br.numPoints<=St.indexMaxPoints)continue}else{if(fe===St.maxZoom||fe===Oe)continue;if(Oe!=null){const di=Oe-fe;if(Te!==ut>>di||ke!==Et>>di)continue}}if(br.source=null,Q.length===0)continue;nn>1&&console.time("clipping");const pr=.5*St.buffer/St.extent,Qr=.5-pr,Gr=.5+pr,Wr=1+pr;let Gi=null,ai=null,ws=null,Ks=null,ca=$t(Q,Kt,Te-pr,Te+Gr,0,br.minX,br.maxX,St),fr=$t(Q,Kt,Te+Qr,Te+Wr,0,br.minX,br.maxX,St);Q=null,ca&&(Gi=$t(ca,Kt,ke-pr,ke+Gr,1,br.minY,br.maxY,St),ai=$t(ca,Kt,ke+Qr,ke+Wr,1,br.minY,br.maxY,St),ca=null),fr&&(ws=$t(fr,Kt,ke-pr,ke+Gr,1,br.minY,br.maxY,St),Ks=$t(fr,Kt,ke+Qr,ke+Wr,1,br.minY,br.maxY,St),fr=null),nn>1&&console.timeEnd("clipping"),ht.push(Gi||[],fe+1,2*Te,2*ke),ht.push(ai||[],fe+1,2*Te,2*ke+1),ht.push(ws||[],fe+1,2*Te+1,2*ke),ht.push(Ks||[],fe+1,2*Te+1,2*ke+1)}}getTile(Q,fe,Te){Q=+Q,fe=+fe,Te=+Te;const ke=this.options,{extent:Oe,debug:ut}=ke;if(Q<0||Q>24)return null;const Et=1<<Q,ht=Vr(Q,fe=fe+Et&Et-1,Te);if(this.tiles[ht])return xr(this.tiles[ht],Oe);ut>1&&console.log("drilling down to z%d-%d-%d",Q,fe,Te);let St,nn=Q,Kt=fe,ir=Te;for(;!St&&nn>0;)nn--,Kt>>=1,ir>>=1,St=this.tiles[Vr(nn,Kt,ir)];return St&&St.source?(ut>1&&(console.log("found parent tile z%d-%d-%d",nn,Kt,ir),console.time("drilling down")),this.splitTile(St.source,nn,Kt,ir,Q,fe,Te),ut>1&&console.timeEnd("drilling down"),this.tiles[ht]?xr(this.tiles[ht],Oe):null):null}}function Vr(gt,Q,fe){return 32*((1<<gt)*fe+Q)+gt}function Rt(gt,Q){const fe=gt.tileID.canonical;if(!this._geoJSONIndex)return void Q(null,null);const Te=this._geoJSONIndex.getTile(fe.z,fe.x,fe.y);if(!Te)return void Q(null,null);const ke=St=>St.tags&&"3d_elevation_id"in St.tags&&"source"in St.tags&&St.tags.source==="elevation",Oe=Te.features.filter((St=>ke(St)));let ut={_geojsonTileLayer:Te.features};Oe.length>0&&(ut={_geojsonTileLayer:Te.features.filter((St=>!ke(St))),hd_road_elevation:Oe});const Et=new he(ut),ht=(function(St){const nn=new s.bq;for(const Kt of Object.keys(St))nn.writeMessage(3,et,{name:Kt,features:St[Kt]});return nn.finish()})(ut).buffer;Q(null,{vectorTile:Et,rawData:ht})}class Jr extends F{constructor(Q,fe,Te,ke,Oe,ut,Et){super(Q,fe,Te,ke,Oe,Rt,Et),ut&&(this.loadGeoJSON=ut),this._dynamicIndex=new Ve}loadData(Q,fe){const Te=Q&&Q.request,ke=Te&&Te.collectResourceTiming;this._geoJSONIndex=null,this.loadGeoJSON(Q,((Oe,ut)=>{if(Oe||!ut)return fe(Oe);if(typeof ut!="object")return fe(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));{try{if(Q.filter){const ht=s.X(Q.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ht.result==="error")throw new Error(ht.value.map((St=>`${St.key}: ${St.message}`)).join(", "));ut.features=ut.features.filter((St=>ht.value.evaluate({zoom:0},St)))}Q.dynamic?(ut.type==="Feature"&&(ut={type:"FeatureCollection",features:[ut]}),Q.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(ut.features,this.loaded),Q.cluster&&(ut.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=Q.cluster?new nr((function({superclusterOptions:ht,clusterProperties:St}){if(!St||!ht)return ht;const nn={},Kt={},ir={accumulated:null,zoom:0},br={properties:null},pr=Object.keys(St);for(const Qr of pr){const[Gr,Wr]=St[Qr],Gi=s.X(Wr),ai=s.X(typeof Gr=="string"?[Gr,["accumulated"],["get",Qr]]:Gr);nn[Qr]=Gi.value,Kt[Qr]=ai.value}return ht.map=Qr=>{br.properties=Qr;const Gr={};for(const Wr of pr)Gr[Wr]=nn[Wr].evaluate(ir,br);return Gr},ht.reduce=(Qr,Gr)=>{br.properties=Gr;for(const Wr of pr)ir.accumulated=Qr[Wr],Qr[Wr]=Kt[Wr].evaluate(ir,br)},ht})(Q)).load(ut.features):Q.dynamic?this._dynamicIndex:(function(ht,St){return new Ys(ht,St)})(ut,Q.geojsonVtOptions)}catch(ht){return fe(ht)}const Et={};if(ke){const ht=w(Te);ht&&(Et.resourceTiming={},Et.resourceTiming[Q.source]=JSON.parse(JSON.stringify(ht)))}fe(null,Et)}}))}reloadTile(Q,fe){const Te=this.loaded;return Te&&Te[Q.uid]?Q.partial?fe(null,void 0):super.reloadTile(Q,fe):this.loadTile(Q,fe)}loadGeoJSON(Q,fe){if(Q.request)s.n(Q.request,fe);else{if(typeof Q.data!="string")return fe(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));setTimeout((()=>{try{return fe(null,JSON.parse(Q.data))}catch{return fe(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`))}}),0)}}getClusterExpansionZoom(Q,fe){try{fe(null,this._geoJSONIndex.getClusterExpansionZoom(Q.clusterId))}catch(Te){fe(Te)}}getClusterChildren(Q,fe){try{fe(null,this._geoJSONIndex.getChildren(Q.clusterId))}catch(Te){fe(Te)}}getClusterLeaves(Q,fe){try{fe(null,this._geoJSONIndex.getLeaves(Q.clusterId,Q.limit,Q.offset))}catch(Te){fe(Te)}}}class xa{constructor(Q,fe,Te){this.tileID=new s.aM(Q.tileID.overscaledZ,Q.tileID.wrap,Q.tileID.canonical.z,Q.tileID.canonical.x,Q.tileID.canonical.y),this.tileZoom=Q.tileZoom,this.uid=Q.uid,this.zoom=Q.zoom,this.canonical=Q.tileID.canonical,this.pixelRatio=Q.pixelRatio,this.tileSize=Q.tileSize,this.source=Q.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=Q.projection,this.brightness=fe,this.worldview=Te}parse(Q,fe,Te,ke){this.status="parsing";const Oe=new s.aM(Te.tileID.overscaledZ,Te.tileID.wrap,Te.tileID.canonical.z,Te.tileID.canonical.x,Te.tileID.canonical.y),ut=[],Et=fe.familiesBySource[Te.source],ht=new s.fc(Oe,Te.promoteId);ht.bucketLayerIDs=[],ht.is3DTile=!0,s.fr(Q).then((St=>{if(!St)return ke(new Error("Could not parse tile"));const nn=St.json.extensionsUsed&&St.json.extensionsUsed.includes("MAPBOX_mesh_features")||St.json.asset.extras&&St.json.asset.extras.MAPBOX_mesh_features,Kt=St.json.extensionsUsed&&St.json.extensionsUsed.includes("EXT_meshopt_compression"),ir=new s.aa(this.zoom,{brightness:this.brightness,worldview:this.worldview});for(const br in Et)for(const pr of Et[br]){const Qr=pr[0];ht.bucketLayerIDs.push(pr.map((Gi=>s.C(Gi.id,Gi.scope)))),Qr.recalculate(ir,[]);const Gr=s.fs(St,1/s.d4(Te.tileID.canonical)),Wr=new s.ft(pr,Gr,Oe,nn,Kt,this.brightness,ht,this.worldview);nn||(Wr.needsUpload=!0),ut.push(Wr),Wr.evaluate(Qr)}this.status="done",ke(null,{buckets:ut,featureIndex:ht,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})})).catch((St=>ke(new Error(St.message))))}}class ka{constructor(Q,fe,Te,ke,Oe,ut,Et,ht){this.actor=Q,this.layerIndex=fe,this.availableImages=Te,this.availableModels=ke,this.brightness=Et,this.loading={},this.loaded={},this.worldview=ht}loadTile(Q,fe){const Te=Q.uid,ke=this.loading[Te]=new xa(Q,this.brightness,this.worldview);s.br(Q.request,((Oe,ut)=>{const Et=!this.loading[Te];return delete this.loading[Te],Et||Oe?(ke.status="done",Et||(this.loaded[Te]=ke),fe(Oe)):ut&&ut.byteLength!==0?void ke.parse(ut,this.layerIndex,Q,((ht,St)=>{ke.status="done",this.loaded=this.loaded||{},this.loaded[Te]=ke,ht||!St?fe(ht):fe(null,St)})):(ke.status="done",this.loaded[Te]=ke,fe())}))}reloadTile(Q,fe){const Te=this.loaded,ke=Q.uid;if(Te&&Te[ke]){const Oe=Te[ke];Oe.projection=Q.projection,Oe.brightness=Q.brightness;const ut=(Et,ht)=>{Oe.reloadCallback&&(delete Oe.reloadCallback,this.loadTile(Q,fe)),fe(Et,ht)};Oe.status==="parsing"?Oe.reloadCallback=ut:Oe.status==="done"&&this.loadTile(Q,fe)}}abortTile(Q,fe){const Te=Q.uid;this.loading[Te]&&delete this.loading[Te],fe()}removeTile(Q,fe){const Te=this.loaded,ke=Q.uid;Te&&Te[ke]&&delete Te[ke],fe()}}class Dr{constructor(Q){this.self=Q,this.actor=new s.fv(Q,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new s.y,this.rtlPluginParsingListeners=[],this.projections={},this.defaultProjection=s.cj({name:"mercator"}),this.workerSourceTypes={vector:F,geojson:Jr,"raster-dem":K,"raster-array":X,"batched-model":ka},this.workerSources={},this.self.registerWorkerSource=(fe,Te)=>{if(this.workerSourceTypes[fe])throw new Error(`Worker source with name "${fe}" already registered.`);this.workerSourceTypes[fe]=Te},this.self.registerRTLTextPlugin=fe=>{if(s.fw.isParsed())throw new Error("RTL text plugin already registered.");s.fw.setState({pluginStatus:s.fx.parsed,pluginURL:s.fw.getPluginURL()}),s.fw.applyArabicShaping=fe.applyArabicShaping,s.fw.processBidirectionalText=fe.processBidirectionalText,s.fw.processStyledBidirectionalText=fe.processStyledBidirectionalText;for(const Te of this.rtlPluginParsingListeners)Te(null,!0);this.rtlPluginParsingListeners=[]}}clearCaches(Q,fe,Te){delete this.layerIndexes[Q],delete this.availableImages[Q],delete this.availableModels[Q],delete this.workerSources[Q],Te()}checkIfReady(Q,fe,Te){Te()}setReferrer(Q,fe){this.referrer=fe}spriteLoaded(Q,fe){this.isSpriteLoaded[Q]||(this.isSpriteLoaded[Q]={});const{scope:Te,isLoaded:ke}=fe;if(this.isSpriteLoaded[Q][Te]=ke,this.workerSources[Q]&&this.workerSources[Q][Te])for(const Oe in this.workerSources[Q][Te]){const ut=this.workerSources[Q][Te][Oe];for(const Et in ut){const ht=ut[Et];ht instanceof F&&(ht.isSpriteLoaded=ke,ht.fire(new s.A("isSpriteLoaded")))}}}setImages(Q,fe,Te){this.availableImages[Q]||(this.availableImages[Q]={});const{scope:ke,images:Oe}=fe;if(this.availableImages[Q][ke]=Oe,this.workerSources[Q]&&this.workerSources[Q][ke]){for(const ut in this.workerSources[Q][ke]){const Et=this.workerSources[Q][ke][ut];for(const ht in Et)Et[ht].availableImages=Oe}Te()}else Te()}setModels(Q,{scope:fe,models:Te},ke){if(this.availableModels[Q]||(this.availableModels[Q]={}),this.availableModels[Q][fe]=Te,this.workerSources[Q]&&this.workerSources[Q][fe]){for(const Oe in this.workerSources[Q][fe]){const ut=this.workerSources[Q][fe][Oe];for(const Et in ut)ut[Et].availableModels=Te}ke()}else ke()}setProjection(Q,fe){this.projections[Q]=s.cj(fe)}setBrightness(Q,fe,Te){this.brightness=fe,Te()}setWorldview(Q,fe,Te){this.worldview=fe,Te()}setLayers(Q,fe,Te){this.getLayerIndex(Q,fe.scope).replace(fe.layers,fe.options),Te()}updateLayers(Q,fe,Te){this.getLayerIndex(Q,fe.scope).update(fe.layers,fe.removedIds,fe.options),Te()}loadTile(Q,fe,Te){fe.projection=this.projections[Q]||this.defaultProjection,this.getWorkerSource(Q,fe.type,fe.source,fe.scope).loadTile(fe,Te)}decodeRasterArray(Q,fe,Te){this.getWorkerSource(Q,fe.type,fe.source,fe.scope).decodeRasterArray(fe,Te)}reloadTile(Q,fe,Te){fe.projection=this.projections[Q]||this.defaultProjection,this.getWorkerSource(Q,fe.type,fe.source,fe.scope).reloadTile(fe,Te)}abortTile(Q,fe,Te){this.getWorkerSource(Q,fe.type,fe.source,fe.scope).abortTile(fe,Te)}removeTile(Q,fe,Te){this.getWorkerSource(Q,fe.type,fe.source,fe.scope).removeTile(fe,Te)}removeSource(Q,fe,Te){if(!(this.workerSources[Q]&&this.workerSources[Q][fe.scope]&&this.workerSources[Q][fe.scope][fe.type]&&this.workerSources[Q][fe.scope][fe.type][fe.source]))return;const ke=this.workerSources[Q][fe.scope][fe.type][fe.source];delete this.workerSources[Q][fe.scope][fe.type][fe.source],ke.removeSource!==void 0?ke.removeSource(fe,Te):Te()}loadWorkerSource(Q,fe,Te){try{this.self.importScripts(fe.url),Te()}catch(ke){Te(ke.toString())}}syncRTLPluginState(Q,fe,Te){if(s.fw.isParsed())Te(null,!0);else if(s.fw.isParsing())this.rtlPluginParsingListeners.push(Te);else try{s.fw.setState(fe);const ke=s.fw.getPluginURL();!s.fw.isLoaded()||s.fw.isParsed()||s.fw.isParsing()||ke==null||(s.fw.setState({pluginStatus:s.fx.parsing,pluginURL:s.fw.getPluginURL()}),this.self.importScripts(ke),s.fw.isParsed()?Te(null,!0):this.rtlPluginParsingListeners.push(Te))}catch(ke){Te(ke.toString())}}setDracoUrl(Q,fe){this.dracoUrl=fe}getAvailableImages(Q,fe){this.availableImages[Q]||(this.availableImages[Q]={});let Te=this.availableImages[Q][fe];return Te||(Te=[]),Te}getAvailableModels(Q,fe){this.availableModels[Q]||(this.availableModels[Q]={});let Te=this.availableModels[Q][fe];return Te||(Te={}),Te}getLayerIndex(Q,fe){this.layerIndexes[Q]||(this.layerIndexes[Q]={});let Te=this.layerIndexes[Q][fe];return Te||(Te=this.layerIndexes[Q][fe]=new N,Te.scope=fe),Te}getWorkerSource(Q,fe,Te,ke){const Oe=this.workerSources;return Oe[Q]||(Oe[Q]={}),Oe[Q][ke]||(Oe[Q][ke]={}),Oe[Q][ke][fe]||(Oe[Q][ke][fe]={}),this.isSpriteLoaded[Q]||(this.isSpriteLoaded[Q]={}),Oe[Q][ke][fe][Te]||(Oe[Q][ke][fe][Te]=new this.workerSourceTypes[fe]({send:(ut,Et,ht,St,nn,Kt)=>this.actor.send(ut,Et,ht,Q,nn,Kt),scheduler:this.actor.scheduler},this.getLayerIndex(Q,ke),this.getAvailableImages(Q,ke),this.getAvailableModels(Q,ke),this.isSpriteLoaded[Q][ke],void 0,this.brightness,this.worldview)),Oe[Q][ke][fe][Te]}rasterizeImagesWorker(Q,fe,Te){const ke=new Map;for(const[Oe,{image:ut,imageVariant:Et}]of fe.tasks.entries()){const ht=this.imageRasterizer.rasterize(Et,ut,fe.scope,Q);ke.set(Oe,ht)}Te(void 0,ke)}removeRasterizedImages(Q,fe,Te){this.imageRasterizer.removeImagesFromCacheByIds(fe.imageIds,fe.scope,Q),Te()}enforceCacheSizeLimit(Q,fe){s.fy(fe)}getWorkerPerformanceMetrics(Q,fe,Te){Te(void 0,void 0)}}return s.fu(self)&&(self.worker=new Dr(self)),Dr})),f(["./shared"],(function(s){var w="3.14.0";const T={create:"create",load:"load",fullLoad:"fullLoad"},E={mark(y){performance.mark(y)},measure(y,a,d){performance.measure(y,a,d)}};function N(y){const a=y.name.split("?")[0];return s.a(a)&&a.includes("mapbox-gl.js")?"javascript":s.a(a)&&a.includes("mapbox-gl.css")?"css":s.b(a)?"fontRange":s.c(a)?"sprite":s.i(a)?"style":s.d(a)?"tilejson":"other"}var D,V={},$=(function(){if(D)return V;function y(v){return!a(v)}function a(v){return typeof window>"u"||typeof document>"u"?"not a browser":(function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var A,P,O=new Blob([""],{type:"text/javascript"}),I=URL.createObjectURL(O);try{P=new Worker(I),A=!0}catch{A=!1}return P&&P.terminate(),URL.revokeObjectURL(I),A})()?(function(){var A=document.createElement("canvas");A.width=A.height=1;var P=A.getContext("2d");if(!P)return!1;var O=P.getImageData(0,0,1,1);return O&&O.width===A.width})()?(d[S=v&&v.failIfMajorPerformanceCaveat]===void 0&&(d[S]=(function(A){var P,O=(function(I){var H=document.createElement("canvas"),G=Object.create(y.webGLContextAttributes);return G.failIfMajorPerformanceCaveat=I,H.getContext("webgl2",G)})(A);if(!O)return!1;try{P=O.createShader(O.VERTEX_SHADER)}catch{return!1}return!(!P||O.isContextLost())&&(O.shaderSource(P,"void main() {}"),O.compileShader(P),O.getShaderParameter(P,O.COMPILE_STATUS)===!0)})(S)),d[S]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var S}D=1,V.supported=y,V.notSupportedReason=a;var d={};return y.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},V})();function B(y,a,d){const v=document.createElement(y);return a!=null&&(v.className=a),d&&d.appendChild(v),v}function F(y,a,d){const v=document.createElementNS("http://www.w3.org/2000/svg",y);for(const S of Object.keys(a))v.setAttributeNS(null,S,String(a[S]));return d&&d.appendChild(v),v}const K=typeof document<"u"?document.documentElement&&document.documentElement.style:null,Y=K&&K.userSelect!==void 0?"userSelect":"WebkitUserSelect";let X;function ae(){K&&Y&&(X=K[Y],K[Y]="none")}function Z(){K&&Y&&(K[Y]=X)}function se(y){y.preventDefault(),y.stopPropagation(),window.removeEventListener("click",se,!0)}function he(){window.addEventListener("click",se,!0),window.setTimeout((()=>{window.removeEventListener("click",se,!0)}),0)}function ye(y,a){const d=y.getBoundingClientRect();return Re(y,d,a)}function Ce(y,a){const d=y.getBoundingClientRect(),v=[];for(let S=0;S<a.length;S++)v.push(Re(y,d,a[S]));return v}function Ve(y){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&y.button===2&&y.ctrlKey?0:y.button}function Re(y,a,d){const v=y.offsetWidth===a.width?1:y.offsetWidth/a.width;return new s.P((d.clientX-a.left)*v,(d.clientY-a.top)*v)}const $e="01",nt="NO_ACCESS_TOKEN";class Me{constructor(a,d,v){this._transformRequestFn=a,this._customAccessToken=d,this._silenceAuthErrors=!!v,this._createSkuToken()}_createSkuToken(){const a=(function(){let d="";for(let v=0;v<10;v++)d+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",$e,d].join(""),tokenExpiresAt:Date.now()+432e5}})();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,d){return this._transformRequestFn&&this._transformRequestFn(a,d)||{url:a}}normalizeStyleURL(a,d){if(!s.j(a))return a;const v=Ee(a);return v.params.push(`sdk=js-${w}`),v.path=`/styles/v1${v.path}`,this._makeAPIURL(v,this._customAccessToken||d)}normalizeGlyphsURL(a,d){if(!s.j(a))return a;const v=Ee(a);return v.path=`/fonts/v1${v.path}`,this._makeAPIURL(v,this._customAccessToken||d)}normalizeModelURL(a,d){if(!s.j(a))return a;const v=Ee(a);return v.path=`/models/v1${v.path}`,this._makeAPIURL(v,this._customAccessToken||d)}normalizeSourceURL(a,d,v,S){if(!s.j(a))return a;const A=Ee(a);return A.path=`/v4/${A.authority}.json`,A.params.push("secure"),v&&A.params.push(`language=${v}`),S&&A.params.push(`worldview=${S}`),this._makeAPIURL(A,this._customAccessToken||d)}normalizeIconsetURL(a,d){const v=Ee(a);return s.j(a)?(v.path=`/styles/v1${v.path}/iconset.pbf`,this._makeAPIURL(v,this._customAccessToken||d)):it(v)}normalizeSpriteURL(a,d,v,S){const A=Ee(a);return s.j(a)?(A.path=`/styles/v1${A.path}/sprite${d}${v}`,this._makeAPIURL(A,this._customAccessToken||S)):(A.path+=`${d}${v}`,it(A))}normalizeTileURL(a,d,v){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!s.j(a))return a;const S=Ee(a);S.path=S.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${d||v&&S.authority!=="raster"&&v===512?"@2x":""}${s.l.supported?".webp":"$1"}`),S.authority==="raster"?S.path=`/${s.e.RASTER_URL_PREFIX}${S.path}`:S.authority==="rasterarrays"?S.path=`/${s.e.RASTERARRAYS_URL_PREFIX}${S.path}`:S.authority==="3dtiles"?S.path=`/${s.e.TILES3D_URL_PREFIX}${S.path}`:(S.path=S.path.replace(/^.+\/v4\//,"/"),S.path=`/${s.e.TILE_URL_VERSION}${S.path}`);const A=this._customAccessToken||(function(P){for(const O of P){const I=O.match(/^access_token=(.*)$/);if(I)return I[1]}return null})(S.params)||s.e.ACCESS_TOKEN;return s.e.REQUIRE_ACCESS_TOKEN&&A&&this._skuToken&&S.params.push(`sku=${this._skuToken}`),this._makeAPIURL(S,A)}canonicalizeTileURL(a,d){const v=Ee(a);if(!v.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!v.path.match(/\.[\w]+$/))return a;let S="mapbox://";v.path.match(/^\/raster\/v1\//)?S+=`raster/${v.path.replace(`/${s.e.RASTER_URL_PREFIX}/`,"")}`:v.path.match(/^\/rasterarrays\/v1\//)?S+=`rasterarrays/${v.path.replace(`/${s.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:S+=`tiles/${v.path.replace(`/${s.e.TILE_URL_VERSION}/`,"")}`;let A=v.params;return d&&(A=A.filter((P=>!P.match(/^access_token=/)))),A.length&&(S+=`?${A.join("&")}`),S}canonicalizeTileset(a,d){const v=!!d&&s.j(d),S=[];for(const A of a.tiles||[])s.k(A)?S.push(this.canonicalizeTileURL(A,v)):S.push(A);return S}_makeAPIURL(a,d){const v="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",S=Ee(s.e.API_URL);if(a.protocol=S.protocol,a.authority=S.authority,a.protocol==="http"){const A=a.params.indexOf("secure");A>=0&&a.params.splice(A,1)}if(S.path!=="/"&&(a.path=`${S.path}${a.path}`),!s.e.REQUIRE_ACCESS_TOKEN)return it(a);if(d=d||s.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!d)throw new Error(`An API access token is required to use Mapbox GL. ${v}`);if(d[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${v}`)}return a.params=a.params.filter((A=>A.indexOf("access_token")===-1)),a.params.push(`access_token=${d||""}`),it(a)}}const rt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ee(y){const a=y.match(rt);if(!a)throw new Error("Unable to parse URL object");return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function it(y){const a=y.params.length?`?${y.params.join("&")}`:"";return`${y.protocol}://${y.authority}${y.path}${a}`}const et="mapbox.eventData";function mt(y){if(!y)return null;const a=y.split(".");if(!a||a.length!==3)return null;try{return JSON.parse(s.m(a[1]))}catch{return null}}class He{constructor(a){this.type=a,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(a){const d=mt(s.e.ACCESS_TOKEN);let v="";return v=d&&d.u?s.f(d.u):s.e.ACCESS_TOKEN||"",a?`${et}.${a}:${v}`:`${et}:${v}`}fetchEventData(){const a=s.s("localStorage"),d=this.getStorageKey(),v=this.getStorageKey("uuid");if(a)try{const S=localStorage.getItem(d);S&&(this.eventData=JSON.parse(S));const A=localStorage.getItem(v);A&&(this.anonId=A)}catch{s.w("Unable to read from LocalStorage")}}saveEventData(){const a=s.s("localStorage"),d=this.getStorageKey(),v=this.getStorageKey("uuid"),S=this.anonId;if(a&&S)try{localStorage.setItem(v,S),Object.keys(this.eventData).length>=1&&localStorage.setItem(d,JSON.stringify(this.eventData))}catch{s.w("Unable to write to LocalStorage")}}processRequests(a){}postEvent(a,d,v,S){if(!s.e.EVENTS_URL)return;const A=Ee(s.e.EVENTS_URL);A.params.push(`access_token=${S||s.e.ACCESS_TOKEN||""}`);const P={event:this.type,created:new Date(a).toISOString()},O=d?s.h(P,d):P,I={url:it(A),headers:{"Content-Type":"text/plain"},body:JSON.stringify([O])};this.pendingRequest=s.p(I,(H=>{this.pendingRequest=null,v(H),this.saveEventData(),this.processRequests(S)}))}queueRequest(a,d){this.queue.push(a),this.processRequests(d)}}const pt=new class extends He{constructor(y){super("appUserTurnstile"),this._customAccessToken=y}postTurnstileEvent(y,a){s.e.EVENTS_URL&&s.e.ACCESS_TOKEN&&Array.isArray(y)&&y.some((d=>s.j(d)||s.k(d)))&&this.queueRequest(Date.now(),a)}processRequests(y){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const a=mt(s.e.ACCESS_TOKEN),d=a?a.u:s.e.ACCESS_TOKEN;let v=d!==this.eventData.tokenU;s.v(this.anonId)||(this.anonId=s.u(),v=!0);const S=this.queue.shift();if(this.eventData.lastSuccess){const A=new Date(this.eventData.lastSuccess),P=new Date(S),O=(S-this.eventData.lastSuccess)/864e5;v=v||O>=1||O<-1||A.getDate()!==P.getDate()}else v=!0;v?this.postEvent(S,{sdkIdentifier:"mapbox-gl-js",sdkVersion:w,skuId:$e,"enabled.telemetry":!1,userId:this.anonId},(A=>{A||(this.eventData.lastSuccess=S,this.eventData.tokenU=d)}),y):this.processRequests()}},We=pt.postTurnstileEvent.bind(pt),Je=new class extends He{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(y,a,d,v){this.skuToken=a,this.errorCb=v,s.e.EVENTS_URL&&(d||s.e.ACCESS_TOKEN?this.queueRequest({id:y,timestamp:Date.now()},d):this.errorCb(new Error(nt)))}processRequests(y){if(this.pendingRequest||this.queue.length===0)return;const{id:a,timestamp:d}=this.queue.shift();a&&this.success[a]||(this.anonId||this.fetchEventData(),s.v(this.anonId)||(this.anonId=s.u()),this.postEvent(d,{sdkIdentifier:"mapbox-gl-js",sdkVersion:w,skuId:$e,skuToken:this.skuToken,userId:this.anonId},(v=>{v?this.errorCb(v):a&&(this.success[a]=!0)}),y))}remove(){this.errorCb=null}},jt=Je.postMapLoadEvent.bind(Je),Pt=new class extends He{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(y){let a=this.mapInstanceIdMap.get(y);return a||(a=s.u(),this.mapInstanceIdMap.set(y,a)),a}getEventId(y){const a=this.eventIdPerMapInstanceMap.get(y)||0;return this.eventIdPerMapInstanceMap.set(y,a+1),a}postStyleLoadEvent(y,a){const{map:d,style:v,importedStyles:S}=a;if(!s.e.EVENTS_URL||!y&&!s.e.ACCESS_TOKEN)return;const A=this.getMapInstanceId(d),P={mapInstanceId:A,eventId:this.getEventId(A),style:v};S.length&&(P.importedStyles=S),this.queueRequest({timestamp:Date.now(),payload:P},y)}processRequests(y){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:a,payload:d}=this.queue.shift();this.postEvent(a,d,(()=>{}),y)}},Ot=Pt.postStyleLoadEvent.bind(Pt),Mt=new class extends He{constructor(){super("gljs.performance")}postPerformanceEvent(y,a){s.e.EVENTS_URL&&(y||s.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:a},y)}processRequests(y){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:a,performanceData:d}=this.queue.shift(),v=(function(S){const A=performance.getEntriesByType("resource"),P=performance.getEntriesByType("mark"),O=(function(re){const de={};if(re){for(const ce in re)if(ce!=="other")for(const pe of re[ce]){const me=`${ce}ResolveRangeMin`,be=`${ce}ResolveRangeMax`,Ne=`${ce}RequestCount`,De=`${ce}RequestCachedCount`;de[me]=Math.min(de[me]||1/0,pe.startTime),de[be]=Math.max(de[be]||-1/0,pe.responseEnd);const Be=Ze=>{de[Ze]===void 0&&(de[Ze]=0),++de[Ze]};pe.transferSize!==void 0&&pe.transferSize===0&&Be(De),Be(Ne)}}return de})((function(re,de){const ce={};if(re)for(const pe of re){const me=de(pe);ce[me]===void 0&&(ce[me]=[]),ce[me].push(pe)}return ce})(A,N)),I=window.devicePixelRatio,H=navigator.connection||navigator.mozConnection||navigator.webkitConnection,G=H?H.effectiveType:void 0,ne={counters:[],metadata:[],attributes:[]},J=(re,de,ce)=>{ce!=null&&re.push({name:de,value:ce.toString()})};for(const re in O)J(ne.counters,re,O[re]);if(S.interactionRange[0]!==1/0&&S.interactionRange[1]!==-1/0&&(J(ne.counters,"interactionRangeMin",S.interactionRange[0]),J(ne.counters,"interactionRangeMax",S.interactionRange[1])),P)for(const re of Object.keys(T)){const de=T[re],ce=P.find((pe=>pe.name===de));ce&&J(ne.counters,de,ce.startTime)}return J(ne.counters,"visibilityHidden",S.visibilityHidden),J(ne.attributes,"style",(function(re){if(re)for(const de of re){const ce=de.name.split("?")[0];if(s.i(ce)){const pe=ce.split("/").slice(-2);if(pe.length===2)return`mapbox://styles/${pe[0]}/${pe[1]}`}}})(A)),J(ne.attributes,"terrainEnabled",S.terrainEnabled?"true":"false"),J(ne.attributes,"fogEnabled",S.fogEnabled?"true":"false"),J(ne.attributes,"projection",S.projection),J(ne.attributes,"zoom",S.zoom),J(ne.metadata,"devicePixelRatio",I),J(ne.metadata,"connectionEffectiveType",G),J(ne.metadata,"navigatorUserAgent",navigator.userAgent),J(ne.metadata,"screenWidth",window.screen.width),J(ne.metadata,"screenHeight",window.screen.height),J(ne.metadata,"windowWidth",window.innerWidth),J(ne.metadata,"windowHeight",window.innerHeight),J(ne.metadata,"mapWidth",S.width/I),J(ne.metadata,"mapHeight",S.height/I),J(ne.metadata,"webglRenderer",S.renderer),J(ne.metadata,"webglVendor",S.vendor),J(ne.metadata,"sdkVersion",w),J(ne.metadata,"sdkIdentifier","mapbox-gl-js"),ne})(d);for(const S of v.metadata);for(const S of v.counters);for(const S of v.attributes);this.postEvent(a,v,(()=>{}),y)}},an=Mt.postPerformanceEvent.bind(Mt),Jt=new class extends He{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(y,a,d,v){if(!s.e.API_URL||!s.e.SESSION_PATH)return;const S=Ee(s.e.API_URL+s.e.SESSION_PATH);S.params.push(`sku=${a||""}`),S.params.push(`access_token=${v||s.e.ACCESS_TOKEN||""}`);const A={url:it(S),headers:{"Content-Type":"text/plain"}};this.pendingRequest=s.g(A,(P=>{this.pendingRequest=null,d(P),this.saveEventData(),this.processRequests(v)}))}getSessionAPI(y,a,d,v){this.skuToken=a,this.errorCb=v,s.e.SESSION_PATH&&s.e.API_URL&&(d||s.e.ACCESS_TOKEN?this.queueRequest({id:y,timestamp:Date.now()},d):this.errorCb(new Error(nt)))}processRequests(y){if(this.pendingRequest||this.queue.length===0)return;const{id:a,timestamp:d}=this.queue.shift();a&&this.success[a]||this.getSession(d,this.skuToken,(v=>{v?this.errorCb(v):a&&(this.success[a]=!0)}),y)}remove(){this.errorCb=null}},Cn=Jt.getSessionAPI.bind(Jt),nr=new Set;function sn(y,a){a?nr.add(y):nr.delete(y)}class zr{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(a,d){this._updatedSourceCaches[a]=d,this.setDirty()}discardSourceCacheUpdate(a){delete this._updatedSourceCaches[a]}updateLayer(a){const d=a.scope;this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._updatedLayers[d].add(a.id),this.setDirty()}removeLayer(a){const d=a.scope;this._removedLayers[d]=this._removedLayers[d]||{},this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._removedLayers[d][a.id]=a,this._updatedLayers[d].delete(a.id),this._updatedPaintProps.delete(a.fqid),this.setDirty()}getRemovedLayer(a){return this._removedLayers[a.scope]?this._removedLayers[a.scope][a.id]:null}discardLayerRemoval(a){this._removedLayers[a.scope]&&delete this._removedLayers[a.scope][a.id]}getLayerUpdatesByScope(){const a={};for(const d in this._updatedLayers)a[d]=a[d]||{},a[d].updatedIds=Array.from(this._updatedLayers[d].values());for(const d in this._removedLayers)a[d]=a[d]||{},a[d].removedIds=Object.keys(this._removedLayers[d]);return a}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(a){this._updatedPaintProps.add(a.fqid),this.setDirty()}getUpdatedImages(a){return this._updatedImages[a]?Array.from(this._updatedImages[a].values()):[]}updateImage(a,d){this._updatedImages[d]=this._updatedImages[d]||new Set,this._updatedImages[d].add(s.I.toString(a)),this.setDirty()}resetUpdatedImages(a){this._updatedImages[a]&&this._updatedImages[a].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function or(y){const{userImage:a}=y;return!!(a&&a.render&&a.render())&&(y.data.replace(new Uint8Array(a.data.buffer)),!0)}class Rr extends s.E{constructor(a){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=a,a!=="raster"&&s.t()&&(this.imageRasterizerDispatcher=new s.D(s.x(),this,"Image Rasterizer Worker",1))}addScope(a){this.loaded.set(a,!1),this.imageProviders.set(a,new Map),this.images.set(a,new Map),this.updatedImages.set(a,new Set),this.callbackDispatchedThisFrame.set(a,new Set),this.patterns.set(a,new Map),this.atlasImage.set(a,new s.r({width:1,height:1}))}removeScope(a){this.loaded.delete(a),this.imageProviders.delete(a),this.images.delete(a),this.updatedImages.delete(a),this.callbackDispatchedThisFrame.delete(a),this.patterns.delete(a),this.atlasImage.delete(a);const d=this.atlasTexture.get(a);d&&(d.destroy(),this.atlasTexture.delete(a))}addImageProvider(a,d){this.imageProviders.has(d)||this.imageProviders.set(d,new Map),this.imageProviders.get(d).set(a.id,a)}removeImageProvider(a,d){this.imageProviders.has(d)&&this.imageProviders.get(d).delete(a)}getPendingImageProviders(){const a=[];for(const d of this.imageProviders.values())for(const v of d.values())v.hasPendingRequests()&&a.push(v);return a}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new s.y),this._imageRasterizer}isLoaded(){for(const a of this.loaded.keys())if(!this.loaded.get(a))return!1;return!0}setLoaded(a,d){if(this.loaded.get(d)!==a&&(this.loaded.set(d,a),a)){for(const{ids:v,callback:S}of this.requestors)this._notify(v,d,S);this.requestors=[]}}hasImage(a,d){return!!this.getImage(a,d)}getImage(a,d){return this.images.get(d).get(a.toString())}addImage(a,d,v){this._validate(a,v)&&this.images.get(d).set(a.toString(),v)}_validate(a,d){let v=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new s.z(new Error(`Image "${a.name}" has invalid "stretchX" value`))),v=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new s.z(new Error(`Image "${a.name}" has invalid "stretchY" value`))),v=!1),this._validateContent(d.content,d)||(this.fire(new s.z(new Error(`Image "${a.name}" has invalid "content" value`))),v=!1),v}_validateStretch(a,d){if(!a)return!0;let v=0;for(const S of a){if(S[0]<v||S[1]<S[0]||d<S[1])return!1;v=S[1]}return!0}_validateContent(a,d){return a?a.length!==4||!d.usvg&&(a[0]<0||d.data.width<a[0]||a[1]<0||d.data.height<a[1]||a[2]<0||d.data.width<a[2]||a[3]<0||d.data.height<a[3])?!1:!(a[2]<a[0]||a[3]<a[1]):!0}updateImage(a,d,v){const S=this.images.get(d).get(a.toString());v.version=S.version+1,this.images.get(d).set(a.toString(),v),this.updatedImages.get(d).add(a),this.removeFromImageRasterizerCache(a,d)}clearUpdatedImages(a){this.updatedImages.get(a).clear()}removeFromImageRasterizerCache(a,d){this.spriteFormat!=="raster"&&(s.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[a],scope:d}):this.imageRasterizer.removeImagesFromCacheByIds([a],d))}removeImage(a,d){const v=this.images.get(d),S=v.get(a.toString());v.delete(a.toString()),this.patterns.get(d).delete(a.toString()),this.removeFromImageRasterizerCache(a,d),S.userImage&&S.userImage.onRemove&&S.userImage.onRemove()}listImages(a){return Array.from(this.images.get(a).keys()).map((d=>s.I.from(d)))}getImages(a,d,v){const S=[],A=[],P=this.imageProviders.get(d);for(const G of a){if(!G.iconsetId){S.push(G);continue}const ne=P.get(G.iconsetId);ne&&(this.getImage(G,d)?A.push(G):ne.addPendingRequest(G))}if(S.length===0)return void this._notify(A,d,v);let O=!0;const I=!!this.loaded.get(d),H=this.images.get(d);if(!I)for(const G of S)H.has(G.toString())||(O=!1);I||O?this._notify(S,d,v):this.requestors.push({ids:S,scope:d,callback:v})}rasterizeImages(a,d){const v=new Map,{tasks:S,scope:A}=a;for(const[P,O]of S.entries()){const I=this.getImage(O.id,A);I&&v.set(P,{image:I,imageVariant:O})}this._rasterizeImages(A,v,d)}_rasterizeImages(a,d,v){if(s.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:d,scope:a},v);else{const S=new Map;for(const[A,{image:P,imageVariant:O}]of d.entries())S.set(A,this.imageRasterizer.rasterize(O,P,a,0));v(void 0,S)}}getUpdatedImages(a){return this.updatedImages.get(a)||new Set}_notify(a,d,v){const S=this.images.get(d),A=new Map;for(const P of a){if(!S.get(P.toString())){if(P.iconsetId)continue;this.fire(new s.A("styleimagemissing",{id:P.name}))}const O=S.get(P.toString());if(!O){s.w(`Image "${P.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const I={data:O.usvg?null:O.data.clone(),pixelRatio:O.pixelRatio,sdf:O.sdf,usvg:O.usvg,version:O.version,stretchX:O.stretchX,stretchY:O.stretchY,content:O.content,hasRenderCallback:!!(O.userImage&&O.userImage.render)};O.usvg&&Object.assign(I,{width:O.icon.usvg_tree.width,height:O.icon.usvg_tree.height}),A.set(s.I.toString(P),I)}v(null,A)}getPixelSize(a){const{width:d,height:v}=this.atlasImage.get(a);return{width:d,height:v}}getPattern(a,d,v){const S=a.toString(),A=this.patterns.get(d),P=A.get(S),O=this.getImage(a,d);if(!O)return null;if(P){if(P.position.version===O.version)return P.position;P.position.version=O.version}else{if(O.usvg&&!O.data){const I=this.getPatternInFlightId(S,d);if(this.patternsInFlight.has(I))return null;this.patternsInFlight.add(I);const H=new s.B(a).scaleSelf(s.q.devicePixelRatio),G=new Map([[H.toString(),{image:O,imageVariant:H}]]);return this._rasterizeImages(d,G,((ne,J)=>this.storePatternImage(H,d,O,v,J))),null}this.storePattern(a,d,O)}return this._updatePatternAtlas(d,v),A.get(S).position}getPatternInFlightId(a,d){return s.C(a,d)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(a,d,v,S,A){const P=a.toString(),O=A?A.get(P):void 0;O&&(v.data=O,this.storePattern(a.id,d,v),this._updatePatternAtlas(d,S),this.patternsInFlight.delete(this.getPatternInFlightId(a.id.toString(),d)))}storePattern(a,d,v){const S={w:v.data.width+2*s.F,h:v.data.height+2*s.F,x:0,y:0},A=new s.G(S,v,s.F);this.patterns.get(d).set(a.toString(),{bin:S,position:A})}destroyAtlasTextures(){for(const a of this.atlasTexture.values())a&&a.destroy();this.atlasTexture.clear()}bind(a,d){const v=a.gl;let S=this.atlasTexture.get(d);S?this.dirty&&(S.update(this.atlasImage.get(d)),this.dirty=!1):(S=new s.T(a,this.atlasImage.get(d),v.RGBA8),this.atlasTexture.set(d,S)),S.bind(v.LINEAR,v.CLAMP_TO_EDGE)}_updatePatternAtlas(a,d){const v=this.patterns.get(a),S=Array.from(v.values()).map((({bin:H})=>H)),{w:A,h:P}=s.H(S),O=this.atlasImage.get(a);O.resize({width:A||1,height:P||1});const I=this.images.get(a);for(const[H,{bin:G,position:ne}]of v.entries()){let J=ne.padding;const re=G.x+J,de=G.y+J,ce=I.get(H).data,pe=ce.width,me=ce.height;J=J>1?J-1:J,s.r.copy(ce,O,{x:0,y:0},{x:re,y:de},{width:pe,height:me},d),s.r.copy(ce,O,{x:0,y:me-J},{x:re,y:de-J},{width:pe,height:J},d),s.r.copy(ce,O,{x:0,y:0},{x:re,y:de+me},{width:pe,height:J},d),s.r.copy(ce,O,{x:pe-J,y:0},{x:re-J,y:de},{width:J,height:me},d),s.r.copy(ce,O,{x:0,y:0},{x:re+pe,y:de},{width:J,height:me},d),s.r.copy(ce,O,{x:pe-J,y:me-J},{x:re-J,y:de-J},{width:J,height:J},d),s.r.copy(ce,O,{x:0,y:me-J},{x:re+pe,y:de-J},{width:J,height:J},d),s.r.copy(ce,O,{x:0,y:0},{x:re+pe,y:de+me},{width:J,height:J},d),s.r.copy(ce,O,{x:pe-J,y:0},{x:re-J,y:de+me},{width:J,height:J},d)}this.dirty=!0}beginFrame(){for(const a of this.images.keys())this.callbackDispatchedThisFrame.set(a,new Set)}dispatchRenderCallbacks(a,d){const v=this.images.get(d);for(const S of a){if(this.callbackDispatchedThisFrame.get(d).has(S.toString()))continue;this.callbackDispatchedThisFrame.get(d).add(S.toString());const A=v.get(S.toString());or(A)&&this.updateImage(S,d,A)}}destroy(){this.imageRasterizerDispatcher&&this.imageRasterizerDispatcher.remove()}}function qr(y){const a=y.key,d=y.value,v=y.valueSpec||{},S=y.objectElementValidators||{},A=y.style,P=y.styleSpec;let O=[];const I=s.J(d);if(I!=="object")return[new s.V(a,d,`object expected, ${I} found`)];for(const H in d){const G=H.split(".")[0];let ne;S[G]?ne=S[G]:v[G]?ne=dr:S["*"]?ne=S["*"]:v["*"]&&(ne=dr),ne?O=O.concat(ne({key:(a&&`${a}.`)+H,value:d[H],valueSpec:v[G]||v["*"],style:A,styleSpec:P,object:d,objectKey:H},d)):O.push(new s.K(a,d[H],`unknown property "${H}"`))}for(const H in v)S[H]||v[H].required&&v[H].default===void 0&&d[H]===void 0&&O.push(new s.V(a,d,`missing required property "${H}"`));return O}function Nn(y){const a=y.value,d=y.valueSpec,v=y.style,S=y.styleSpec,A=y.key,P=y.arrayElementValidator||dr;if(s.J(a)!=="array")return[new s.V(A,a,`array expected, ${s.J(a)} found`)];if(d.length&&a.length!==d.length)return[new s.V(A,a,`array length ${d.length} expected, length ${a.length} found`)];if(d["min-length"]&&a.length<d["min-length"])return[new s.V(A,a,`array length at least ${d["min-length"]} expected, length ${a.length} found`)];let O={type:d.value,values:d.values,minimum:d.minimum,maximum:d.maximum,function:void 0};S.$version<7&&(O.function=d.function),s.J(d.value)==="object"&&(O=d.value);let I=[];for(let H=0;H<a.length;H++)I=I.concat(P({array:a,arrayIndex:H,value:a[H],valueSpec:O,style:v,styleSpec:S,key:`${A}[${H}]`},!0));return I}function ci(y){const a=y.key,d=y.value,v=y.valueSpec;let S=s.J(d);if(S==="number"&&d!=d&&(S="NaN"),S!=="number")return[new s.V(a,d,`number expected, ${S} found`)];if("minimum"in v){let A=v.minimum;if(s.J(v.minimum)==="array"&&(A=v.minimum[y.arrayIndex]),d<A)return[new s.V(a,d,`${d} is less than the minimum value ${A}`)]}if("maximum"in v){let A=v.maximum;if(s.J(v.maximum)==="array"&&(A=v.maximum[y.arrayIndex]),d>A)return[new s.V(a,d,`${d} is greater than the maximum value ${A}`)]}return[]}function ui(y){const a=y.valueSpec,d=s.M(y.value.type);let v,S,A,P={};const O=d!=="categorical"&&y.value.property===void 0,I=!O,H=s.J(y.value.stops)==="array"&&s.J(y.value.stops[0])==="array"&&s.J(y.value.stops[0][0])==="object",G=qr({key:y.key,value:y.value,valueSpec:y.styleSpec.function,style:y.style,styleSpec:y.styleSpec,objectElementValidators:{stops:function(re){if(d==="identity")return[new s.V(re.key,re.value,'identity function may not have a "stops" property')];let de=[];const ce=re.value;return de=de.concat(Nn({key:re.key,value:ce,valueSpec:re.valueSpec,style:re.style,styleSpec:re.styleSpec,arrayElementValidator:ne})),s.J(ce)==="array"&&ce.length===0&&de.push(new s.V(re.key,ce,"array must have at least one stop")),de},default:function(re){return dr({key:re.key,value:re.value,valueSpec:a,style:re.style,styleSpec:re.styleSpec})}}});return d==="identity"&&O&&G.push(new s.V(y.key,y.value,'missing required property "property"')),d==="identity"||y.value.stops||G.push(new s.V(y.key,y.value,'missing required property "stops"')),d==="exponential"&&y.valueSpec.expression&&!s.N(y.valueSpec)&&G.push(new s.V(y.key,y.value,"exponential functions not supported")),y.styleSpec.$version>=8&&(I&&!s.O(y.valueSpec)?G.push(new s.V(y.key,y.value,"property functions not supported")):O&&!s.Q(y.valueSpec)&&G.push(new s.V(y.key,y.value,"zoom functions not supported"))),d!=="categorical"&&!H||y.value.property!==void 0||G.push(new s.V(y.key,y.value,'"property" property is required')),G;function ne(re){let de=[];const ce=re.value,pe=re.key;if(s.J(ce)!=="array")return[new s.V(pe,ce,`array expected, ${s.J(ce)} found`)];if(ce.length!==2)return[new s.V(pe,ce,`array length 2 expected, length ${ce.length} found`)];if(H){if(s.J(ce[0])!=="object")return[new s.V(pe,ce,`object expected, ${s.J(ce[0])} found`)];if(ce[0].zoom===void 0)return[new s.V(pe,ce,"object stop key must have zoom")];if(ce[0].value===void 0)return[new s.V(pe,ce,"object stop key must have value")];const me=s.M(ce[0].zoom);if(typeof me!="number")return[new s.V(pe,ce[0].zoom,"stop zoom values must be numbers")];if(A&&A>me)return[new s.V(pe,ce[0].zoom,"stop zoom values must appear in ascending order")];me!==A&&(A=me,S=void 0,P={}),de=de.concat(qr({key:`${pe}[0]`,value:ce[0],valueSpec:{zoom:{}},style:re.style,styleSpec:re.styleSpec,objectElementValidators:{zoom:ci,value:J}}))}else de=de.concat(J({key:`${pe}[0]`,value:ce[0],style:re.style,styleSpec:re.styleSpec},ce));return s.S(s.U(ce[1]))?de.concat([new s.V(`${pe}[1]`,ce[1],"expressions are not allowed in function stops.")]):de.concat(dr({key:`${pe}[1]`,value:ce[1],valueSpec:a,style:re.style,styleSpec:re.styleSpec}))}function J(re,de){const ce=s.J(re.value),pe=s.M(re.value),me=re.value!==null?re.value:de;if(v){if(ce!==v)return[new s.V(re.key,me,`${ce} stop domain type must match previous stop domain type ${v}`)]}else v=ce;if(ce!=="number"&&ce!=="string"&&ce!=="boolean"&&typeof pe!="number"&&typeof pe!="string"&&typeof pe!="boolean")return[new s.V(re.key,me,"stop domain value must be a number, string, or boolean")];if(ce!=="number"&&d!=="categorical"){let be=`number expected, ${ce} found`;return s.O(a)&&d===void 0&&(be+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new s.V(re.key,me,be)]}return d!=="categorical"||ce!=="number"||typeof pe=="number"&&isFinite(pe)&&Math.floor(pe)===pe?d!=="categorical"&&ce==="number"&&typeof pe=="number"&&typeof S=="number"&&S!==void 0&&pe<S?[new s.V(re.key,me,"stop domain values must appear in ascending order")]:(S=pe,d==="categorical"&&pe in P?[new s.V(re.key,me,"stop domain values must be unique")]:(P[pe]=!0,[])):[new s.V(re.key,me,`integer expected, found ${String(pe)}`)]}}function st(y){const a=(y.expressionContext==="property"?s.W:s.X)(s.U(y.value),y.valueSpec);if(a.result==="error")return a.value.map((v=>new s.V(`${y.key}${v.key}`,y.value,v.message)));const d=a.value.expression||a.value._styleExpression.expression;if(y.expressionContext==="property"&&y.propertyKey==="text-font"&&!d.outputDefined())return[new s.V(y.key,y.value,`Invalid data expression for "${y.propertyKey}". Output values must be contained as literals within the expression.`)];if(y.expressionContext==="property"&&y.propertyType==="layout"&&!s.Y(d))return[new s.V(y.key,y.value,'"feature-state" data expressions are not supported with layout properties.')];if(y.expressionContext==="filter")return qt(d,y);if(y.expressionContext&&y.expressionContext.indexOf("cluster")===0){if(!s.Z(d,["zoom","feature-state"]))return[new s.V(y.key,y.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(y.expressionContext==="cluster-initial"&&!s._(d))return[new s.V(y.key,y.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function qt(y,a){const d=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(a.valueSpec&&a.valueSpec.expression)for(const S of a.valueSpec.expression.parameters)d.delete(S);if(d.size===0)return[];const v=[];return y instanceof s.$&&d.has(y.name)?[new s.V(a.key,a.value,`["${y.name}"] expression is not supported in a filter for a ${a.object.type} layer with id: ${a.object.id}`)]:(y.eachChild((S=>{v.push(...qt(S,a))})),v)}function rn(y){const a=y.key,d=y.value,v=y.valueSpec,S=[];return Array.isArray(v.values)?v.values.indexOf(s.M(d))===-1&&S.push(new s.V(a,d,`expected one of [${v.values.join(", ")}], ${JSON.stringify(d)} found`)):Object.keys(v.values).indexOf(s.M(d))===-1&&S.push(new s.V(a,d,`expected one of [${Object.keys(v.values).join(", ")}], ${JSON.stringify(d)} found`)),S}function Wn(y){return s.a1(s.U(y.value))?st(s.L({},y,{expressionContext:"filter",valueSpec:y.styleSpec[`filter_${y.layerType||"fill"}`]})):Vt(y)}function Vt(y){const a=y.value,d=y.key;if(s.J(a)!=="array")return[new s.V(d,a,`array expected, ${s.J(a)} found`)];const v=y.styleSpec;let S,A=[];if(a.length<1)return[new s.V(d,a,"filter array must have at least 1 element")];switch(A=A.concat(rn({key:`${d}[0]`,value:a[0],valueSpec:v.filter_operator,style:y.style,styleSpec:y.styleSpec})),s.M(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&s.M(a[1])==="$type"&&A.push(new s.V(d,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&A.push(new s.V(d,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(S=s.J(a[1]),S!=="string"&&A.push(new s.V(`${d}[1]`,a[1],`string expected, ${S} found`)));for(let P=2;P<a.length;P++)S=s.J(a[P]),s.M(a[1])==="$type"?A=A.concat(rn({key:`${d}[${P}]`,value:a[P],valueSpec:v.geometry_type,style:y.style,styleSpec:y.styleSpec})):S!=="string"&&S!=="number"&&S!=="boolean"&&A.push(new s.V(`${d}[${P}]`,a[P],`string, number, or boolean expected, ${S} found`));break;case"any":case"all":case"none":for(let P=1;P<a.length;P++)A=A.concat(Vt({key:`${d}[${P}]`,value:a[P],style:y.style,styleSpec:y.styleSpec}));break;case"has":case"!has":S=s.J(a[1]),a.length!==2?A.push(new s.V(d,a,`filter array for "${a[0]}" operator must have 2 elements`)):S!=="string"&&A.push(new s.V(`${d}[1]`,a[1],`string expected, ${S} found`))}return A}function un(y,a){const d=y.key,v=y.style,S=y.layer,A=y.styleSpec,P=y.value,O=y.objectKey,I=A[`${a}_${y.layerType}`];if(!I)return[];const H=O.match(/^(.*)-use-theme$/);if(a==="paint"&&H&&I[H[1]])return s.S(P)?[].concat(dr({key:y.key,value:P,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:v,styleSpec:A,expressionContext:"property",propertyType:a,propertyKey:O})):dr({key:d,value:P,valueSpec:{type:"string"},style:v,styleSpec:A});const G=O.match(/^(.*)-transition$/);if(a==="paint"&&G&&I[G[1]]&&I[G[1]].transition)return dr({key:d,value:P,valueSpec:A.transition,style:v,styleSpec:A});const ne=y.valueSpec||I[O];if(!ne)return[new s.K(d,P,`unknown property "${O}"`)];let J;if(s.J(P)==="string"&&s.O(ne)&&!ne.tokens&&(J=/^{([^}]+)}$/.exec(P))){const de=`\`{ "type": "identity", "property": ${J?JSON.stringify(J[1]):'"_"'} }\``;return[new s.V(d,P,`"${O}" does not support interpolation syntax
Use an identity property function instead: ${de}.`)]}const re=[];if(y.layerType==="symbol")O!=="text-field"||!v||v.glyphs||v.imports||re.push(new s.V(d,P,'use of "text-field" requires a style "glyphs" property')),O==="text-font"&&s.a2(s.U(P))&&s.M(P.type)==="identity"&&re.push(new s.V(d,P,'"text-font" does not support identity functions'));else if(y.layerType==="model"&&a==="paint"&&S&&S.layout&&S.layout.hasOwnProperty("model-id")&&s.O(ne)&&(s.a3(ne)||s.Q(ne))){const de=s.W(s.U(P),ne),ce=de.value.expression||de.value._styleExpression.expression;ce&&!s.Z(ce,["measure-light"])&&(O==="model-emissive-strength"&&s._(ce)&&s.Y(ce)||re.push(new s.V(d,P,`${O} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return re.concat(dr({key:y.key,value:P,valueSpec:ne,style:v,styleSpec:A,expressionContext:"property",propertyType:a,propertyKey:O}))}function hr(y){return un(y,"paint")}function $t(y){return un(y,"layout")}function lr(y){let a=[];const d=y.value,v=y.key,S=y.style,A=y.styleSpec;d.type||d.ref||a.push(new s.V(v,d,'either "type" or "ref" is required'));let P=s.M(d.type);const O=s.M(d.ref);if(d.id){const I=s.M(d.id);for(let H=0;H<y.arrayIndex;H++){const G=S.layers[H];s.M(G.id)===I&&a.push(new s.V(v,d.id,`duplicate layer id "${d.id}", previously used at line ${G.id.__line__}`))}}if("ref"in d){let I;["type","source","source-layer","filter","layout"].forEach((H=>{H in d&&a.push(new s.V(v,d[H],`"${H}" is prohibited for ref layers`))})),S.layers.forEach((H=>{s.M(H.id)===O&&(I=H)})),I?I.ref?a.push(new s.V(v,d.ref,"ref cannot reference another ref layer")):P=s.M(I.type):typeof O=="string"&&a.push(new s.V(v,d.ref,`ref layer "${O}" not found`))}else if(P!=="background"&&P!=="sky"&&P!=="slot")if(d.source){const I=S.sources&&S.sources[d.source],H=I&&s.M(I.type);I?H==="vector"&&P==="raster"?a.push(new s.V(v,d.source,`layer "${d.id}" requires a raster source`)):H==="raster"&&P!=="raster"?a.push(new s.V(v,d.source,`layer "${d.id}" requires a vector source`)):H!=="vector"||d["source-layer"]?H==="raster-dem"&&P!=="hillshade"?a.push(new s.V(v,d.source,"raster-dem source can only be used with layer type 'hillshade'.")):H!=="raster-array"||["raster","raster-particle"].includes(P)?P==="line"&&d.paint&&(d.paint["line-gradient"]||d.paint["line-trim-offset"])&&H==="geojson"&&!I.lineMetrics?a.push(new s.V(v,d,`layer "${d.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):P==="raster-particle"&&H!=="raster-array"&&a.push(new s.V(v,d.source,`layer "${d.id}" requires a 'raster-array' source.`)):a.push(new s.V(v,d.source,"raster-array source can only be used with layer type 'raster'.")):a.push(new s.V(v,d,`layer "${d.id}" must specify a "source-layer"`)):a.push(new s.V(v,d.source,`source "${d.source}" not found`))}else a.push(new s.V(v,d,'missing required property "source"'));return a=a.concat(qr({key:v,value:d,valueSpec:A.layer,style:y.style,styleSpec:y.styleSpec,objectElementValidators:{"*":()=>[],type:()=>dr({key:`${v}.type`,value:d.type,valueSpec:A.layer.type,style:y.style,styleSpec:y.styleSpec,object:d,objectKey:"type"}),filter:I=>Wn(s.L({layerType:P},I)),layout:I=>qr({layer:d,key:I.key,value:I.value,valueSpec:{},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":H=>$t(s.L({layerType:P},H))}}),paint:I=>qr({layer:d,key:I.key,value:I.value,valueSpec:{},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":H=>hr(s.L({layerType:P,layer:d},H))}})}})),a}function ze(y){const a=y.value,d=y.key,v=s.J(a);return v!=="string"?[new s.V(d,a,`string expected, ${v} found`)]:[]}const Fe={promoteId:function y({key:a,value:d}){if(s.J(d)==="string")return ze({key:a,value:d});if(Array.isArray(d)){const v=[],S=s.U(d),A=s.X(S);return A.result==="error"&&A.value.forEach((P=>{v.push(new s.V(`${a}${P.key}`,null,`${P.message}`))})),s.Z(A.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||v.push(new s.V(`${a}`,null,"promoteId expression should be only feature dependent")),v}{const v=[];for(const S in d)v.push(...y({key:`${a}.${S}`,value:d[S]}));return v}}};function jn(y){const a=y.value,d=y.key,v=y.styleSpec,S=y.style;if(!a.type)return[new s.V(d,a,'"type" is required')];const A=s.M(a.type);let P=[];switch(["vector","raster","raster-dem","raster-array"].includes(A)&&(a.url||a.tiles||P.push(new s.K(d,a,'Either "url" or "tiles" is required.'))),A){case"vector":case"raster":case"raster-dem":case"raster-array":return P=P.concat(qr({key:d,value:a,valueSpec:v[`source_${A.replace("-","_")}`],style:y.style,styleSpec:v,objectElementValidators:Fe})),P;case"geojson":if(P=qr({key:d,value:a,valueSpec:v.source_geojson,style:S,styleSpec:v,objectElementValidators:Fe}),a.cluster)for(const O in a.clusterProperties){const[I,H]=a.clusterProperties[O],G=typeof I=="string"?[I,["accumulated"],["get",O]]:I;P.push(...st({key:`${d}.${O}.map`,value:H,expressionContext:"cluster-map"})),P.push(...st({key:`${d}.${O}.reduce`,value:G,expressionContext:"cluster-reduce"}))}return P;case"video":return qr({key:d,value:a,valueSpec:v.source_video,style:S,styleSpec:v});case"image":return qr({key:d,value:a,valueSpec:v.source_image,style:S,styleSpec:v});case"canvas":return[new s.V(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return rn({key:`${d}.type`,value:a.type,valueSpec:{values:Xn(v)}})}}function Xn(y){return y.source.reduce(((a,d)=>{const v=y[d];return v.type.type==="enum"&&(a=a.concat(Object.keys(v.type.values))),a}),[])}function mr(y){const a=y.value,d=y.styleSpec,v=d.light,S=y.style;let A=[];const P=s.J(a);if(a===void 0)return A;if(P!=="object")return A=A.concat([new s.V("light",a,`object expected, ${P} found`)]),A;for(const O in a){const I=O.match(/^(.*)-transition$/),H=O.match(/^(.*)-use-theme$/);A=A.concat(H&&v[H[1]]?dr({key:O,value:a[O],valueSpec:{type:"string"},style:S,styleSpec:d}):I&&v[I[1]]&&v[I[1]].transition?dr({key:O,value:a[O],valueSpec:d.transition,style:S,styleSpec:d}):v[O]?dr({key:O,value:a[O],valueSpec:v[O],style:S,styleSpec:d}):[new s.V(O,a[O],`unknown property "${O}"`)])}return A}function Ur(y){const a=y.value;let d=[];if(!a)return d;const v=s.J(a);if(v!=="object")return d=d.concat([new s.V("light-3d",a,`object expected, ${v} found`)]),d;const S=y.styleSpec,A=S["light-3d"],P=y.key,O=y.style,I=y.style.lights;for(const ne of["type","id"])if(!(ne in a))return d=d.concat([new s.V("light-3d",a,`missing property ${ne} on light`)]),d;if(a.type&&I)for(let ne=0;ne<y.arrayIndex;ne++){const J=s.M(a.type),re=I[ne];s.M(re.type)===J&&d.push(new s.V(P,a.id,`duplicate light type "${a.type}", previously defined at line ${re.id.__line__}`))}const H=`properties_light_${a.type}`;if(!(H in S))return d=d.concat([new s.V("light-3d",a,`Invalid light type ${a.type}`)]),d;const G=S[H];for(const ne in a)if(ne==="properties"){const J=a[ne],re=s.J(J);if(re!=="object")return d=d.concat([new s.V("properties",J,`object expected, ${re} found`)]),d;for(const de in J){const ce=de.match(/^(.*)-transition$/),pe=de.match(/^(.*)-use-theme$/);d=d.concat(pe&&G[pe[1]]?dr({key:ne,value:J[de],valueSpec:{type:"string"},style:O,styleSpec:S}):ce&&G[ce[1]]&&G[ce[1]].transition?dr({key:ne,value:a[ne],valueSpec:S.transition,style:O,styleSpec:S}):G[de]?dr({key:de,value:J[de],valueSpec:G[de],style:O,styleSpec:S}):[new s.K(y.key,J[de],`unknown property "${de}"`)])}}else d=d.concat(A[ne]?dr({key:ne,value:a[ne],valueSpec:A[ne],style:O,styleSpec:S}):[new s.K(ne,a[ne],`unknown property "${ne}"`)]);return d}function yi(y){const a=y.value,d=y.key,v=y.style,S=y.styleSpec,A=S.terrain;let P=[];const O=s.J(a);if(a===void 0||O==="null")return P;if(O!=="object")return P=P.concat([new s.V("terrain",a,`object expected, ${O} found`)]),P;for(const I in a){const H=I.match(/^(.*)-transition$/),G=I.match(/^(.*)-use-theme$/);P=P.concat(G&&A[G[1]]?dr({key:I,value:a[I],valueSpec:{type:"string"},style:v,styleSpec:S}):H&&A[H[1]]&&A[H[1]].transition?dr({key:I,value:a[I],valueSpec:S.transition,style:v,styleSpec:S}):A[I]?dr({key:I,value:a[I],valueSpec:A[I],style:v,styleSpec:S}):[new s.K(I,a[I],`unknown property "${I}"`)])}if(a.source){const I=v.sources&&v.sources[a.source],H=I&&s.M(I.type);I?H!=="raster-dem"&&P.push(new s.V(d,a.source,`terrain cannot be used with a source of type ${String(H)}, it only be used with a "raster-dem" source type`)):P.push(new s.V(d,a.source,`source "${a.source}" not found`))}else P.push(new s.V(d,a,'terrain is missing required property "source"'));return P}function Hi(y){const a=y.value,d=y.style,v=y.styleSpec,S=v.fog;let A=[];const P=s.J(a);if(a===void 0)return A;if(P!=="object")return A=A.concat([new s.V("fog",a,`object expected, ${P} found`)]),A;for(const O in a){const I=O.match(/^(.*)-transition$/),H=O.match(/^(.*)-use-theme$/);A=A.concat(H&&S[H[1]]?dr({key:O,value:a[O],valueSpec:{type:"string"},style:d,styleSpec:v}):I&&S[I[1]]&&S[I[1]].transition?dr({key:O,value:a[O],valueSpec:v.transition,style:d,styleSpec:v}):S[O]?dr({key:O,value:a[O],valueSpec:S[O],style:d,styleSpec:v}):[new s.K(O,a[O],`unknown property "${O}"`)])}return A}const xr={"*":()=>[],array:Nn,boolean:function(y){const a=y.value,d=y.key,v=s.J(a);return v!=="boolean"?[new s.V(d,a,`boolean expected, ${v} found`)]:[]},number:ci,color:function(y){const a=y.key,d=y.value,v=s.J(d);return v!=="string"?[new s.V(a,d,`color expected, ${v} found`)]:s.a0.parseCSSColor(d)===null?[new s.V(a,d,`color expected, "${d}" found`)]:[]},enum:rn,filter:Wn,function:ui,layer:lr,object:qr,source:jn,model:s.a4,light:mr,"light-3d":Ur,terrain:yi,fog:Hi,string:ze,formatted:function(y){return ze(y).length===0?[]:st(y)},resolvedImage:function(y){return ze(y).length===0?[]:st(y)},projection:function(y){const a=y.value,d=y.styleSpec,v=d.projection,S=y.style;let A=[];const P=s.J(a);if(P==="object")for(const O in a)A=A.concat(dr({key:O,value:a[O],valueSpec:v[O],style:S,styleSpec:d}));else P!=="string"&&(A=A.concat([new s.V("projection",a,`object or string expected, ${P} found`)]));return A},import:function(y){const{value:a,styleSpec:d}=y,{data:v,...S}=a;Object.defineProperty(S,"__line__",{value:a.__line__,enumerable:!1});let A=qr(s.L({},y,{value:S,valueSpec:d.import}));return s.M(S.id)===""&&A.push(new s.V(`${y.key}.id`,S,"import id can't be an empty string")),v&&(A=A.concat(Di(v,d,{key:`${y.key}.data`}))),A},iconset:function(y){const a=y.value,d=y.key,v=y.styleSpec,S=y.style;if(!a.type)return[new s.V(d,a,'"type" is required')];const A=s.M(a.type);let P=[];if(P=P.concat(qr({key:d,value:a,valueSpec:v[`iconset_${A}`],style:S,styleSpec:v})),A==="source"&&a.source){const O=S.sources&&S.sources[a.source],I=O&&s.M(O.type);O?I!=="raster-array"&&P.push(new s.V(d,a.source,`iconset cannot be used with a source of type ${String(I)}, it only be used with a "raster-array" source type`)):P.push(new s.V(d,a.source,`source "${a.source}" not found`))}return P}};function dr(y,a=!1){const d=y.value,v=y.valueSpec,S=y.styleSpec;if(v.expression&&s.a2(s.M(d)))return ui(y);if(v.expression&&s.S(s.U(d)))return st(y);if(v.type&&xr[v.type]){const A=xr[v.type](y);return a===!0&&A.length>0&&s.J(y.value)==="array"?st(y):A}return qr(s.L({},y,{valueSpec:v.type?S[v.type]:v}))}function Ki(y){const a=y.value,d=y.key,v=ze(y);return v.length||(a.indexOf("{fontstack}")===-1&&v.push(new s.V(d,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&v.push(new s.V(d,a,'"glyphs" url must include a "{range}" token'))),v}function Di(y,a=s.a5,d={}){return dr({key:d.key||"",value:y,valueSpec:a.$root,styleSpec:a,style:y,objectElementValidators:{glyphs:Ki,"*":()=>[]}})}function Ji(y,a=s.a5){return ke(Di(y,a))}const bs=y=>ke(jn(y)),Ys=y=>ke(mr(y)),Vr=y=>ke(Ur(y)),Rt=y=>ke(yi(y)),Jr=y=>ke(Hi(y)),xa=y=>ke((function(a){const d=a.value,v=a.style,S=a.styleSpec,A=S.snow;let P=[];const O=s.J(d);if(d===void 0)return P;if(O!=="object")return P=P.concat([new s.V("snow",d,`object expected, ${O} found`)]),P;for(const I in d){const H=I.match(/^(.*)-transition$/);P=P.concat(H&&A[H[1]]&&A[H[1]].transition?dr({key:I,value:d[I],valueSpec:S.transition,style:v,styleSpec:S}):A[I]?dr({key:I,value:d[I],valueSpec:A[I],style:v,styleSpec:S}):[new s.K(I,d[I],`unknown property "${I}"`)])}return P})(y)),ka=y=>ke((function(a){const d=a.value,v=a.style,S=a.styleSpec,A=S.rain;let P=[];const O=s.J(d);if(d===void 0)return P;if(O!=="object")return P=P.concat([new s.V("rain",d,`object expected, ${O} found`)]),P;for(const I in d){const H=I.match(/^(.*)-transition$/);P=P.concat(H&&A[H[1]]&&A[H[1]].transition?dr({key:I,value:d[I],valueSpec:S.transition,style:v,styleSpec:S}):A[I]?dr({key:I,value:d[I],valueSpec:A[I],style:v,styleSpec:S}):[new s.K(I,d[I],`unknown property "${I}"`)])}return P})(y)),Dr=y=>ke(lr(y)),gt=y=>ke(Wn(y)),Q=y=>ke(hr(y)),fe=y=>ke($t(y)),Te=y=>ke(s.a4(y));function ke(y){return y.slice().sort(((a,d)=>a.line&&d.line?a.line-d.line:0))}function Oe(y,a){let d=!1;if(a&&a.length)for(const v of a)v instanceof s.K?s.w(v.message):(y.fire(new s.z(new Error(v.message))),d=!0);return d}let ut;class Et extends s.E{constructor(a,d="flat"){super(),this._transitionable=new s.a6(ut||(ut=new s.a7({anchor:new s.a8(s.a5.light.anchor),position:new s.a9(s.a5.light.position),color:new s.a8(s.a5.light.color),intensity:new s.a8(s.a5.light.intensity)}))),this.setLight(a,d),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(a,d,v={}){this._validate(Ys,a,v)||(this._transitionable.setTransitionOrValue(a),this.id=d)}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,d,v){return(!v||v.validate!==!1)&&Oe(this,a.call(Ji,s.h({value:d,style:{glyphs:!0,sprite:!0},styleSpec:s.a5})))}}let ht=class extends s.E{constructor(y,a,d,v,S){super(),this.scope=d,this._transitionable=new s.a6(new s.a7({source:new s.a8(s.a5.terrain.source),exaggeration:new s.a8(s.a5.terrain.exaggeration)}),d,v),this._transitionable.setTransitionOrValue(y,v),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=a,this.worldview=S}get(){return this._transitionable.serialize()}set(y,a){this._transitionable.setTransitionOrValue(y,a)}updateTransitions(y){this._transitioning=this._transitionable.transitioned(y,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(y){this.properties=this._transitioning.possiblyEvaluate(y)}getExaggeration(y){return this._transitioning.possiblyEvaluate(new s.aa(y,{worldview:this.worldview})).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const y=this._transitionable._values.exaggeration;if(!y)return null;const a=y.value.expression;if(!a)return null;let d=-1,v=-1,S=1;for(const A of a.zoomStops)S=a.evaluate(new s.aa(A,{worldview:this.worldview})),S>.01?(d=A,v=-1):v=A;return S<.01&&d>0&&v>d?[d,v]:null}isZoomDependent(){const y=this._transitionable._values.exaggeration;return y!=null&&y.value!=null&&y.value.expression!=null&&y.value.expression instanceof s.ab}};const St=45,nn=65,Kt=.05;function ir(y,a,d,v){const S=s.af(St,nn,d),[A,P]=br(y,v);let O=1-Math.min(1,Math.exp((a-A)/(P-A)*-6));return O*=O*O,O=Math.min(1,1.00747*O),O*S*y.alpha}function br(y,a){const d=.5/Math.tan(.5*a);return[y.range[0]+d,y.range[1]+d]}function pr(y,a,d,v,S){const A=s.ad([],[a,d,v],S.mercatorFogMatrix);return ir(y,s.ae(A),S.pitch,S._fov)}function Qr(y,a,d,v,S,A,P){const O=[[d,v,0],[S,v,0],[S,A,0],[d,A,0]];let I=Number.MAX_VALUE,H=-Number.MAX_VALUE;for(const G of O){const ne=s.ad([],G,a),J=s.ae(ne);I=Math.min(I,J),H=Math.max(H,J)}return[ir(y,I,P.pitch,P._fov),ir(y,H,P.pitch,P._fov)]}class Gr extends s.E{constructor(a,d,v,S){super();const A=new s.a7({range:new s.a8(s.a5.fog.range),color:new s.a8(s.a5.fog.color),"color-use-theme":new s.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new s.a8(s.a5.fog["high-color"]),"high-color-use-theme":new s.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new s.a8(s.a5.fog["space-color"]),"space-color-use-theme":new s.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new s.a8(s.a5.fog["horizon-blend"]),"star-intensity":new s.a8(s.a5.fog["star-intensity"]),"vertical-range":new s.a8(s.a5.fog["vertical-range"])});this._transitionable=new s.a6(A,v,new Map(S)),this.set(a,S),this._transitioning=this._transitionable.untransitioned(),this._transform=d,this.properties=new s.ag(A),this.scope=v}get state(){const a=this._transform,d=a.projection.name==="globe",v=s.ah(a.zoom),S=this.properties.get("range"),A=[.5,3];return{range:d?[s.ai(A[0],S[0],v),s.ai(A[1],S[1],v)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(a,d,v={}){if(this._validate(Jr,a,v))return;const S=s.h({},a);for(const A of Object.keys(s.a5.fog))S[A]===void 0&&(S[A]=s.a5.fog[A].default);this._options=S,this._transitionable.setTransitionOrValue(this._options,d)}getOpacity(a){if(!this._transform.projection.supportsFog)return 0;const d=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.af(St,nn,a))*d.a}getOpacityAtLatLng(a,d){return this._transform.projection.supportsFog?(function(v,S,A){const P=s.ac.fromLngLat(S),O=A.elevation?A.elevation.getAtPointOrZero(P):0;return pr(v,P.x,P.y,O,A)})(this.state,a,d):0}getOpacityForTile(a){if(!this._transform.projection.supportsFog)return[1,1];const d=this._transform.calculateFogTileMatrix(a.toUnwrapped());return Qr(this.state,d,0,0,s.aj,s.aj,this._transform)}getOpacityForBounds(a,d,v,S,A){return this._transform.projection.supportsFog?Qr(this.state,a,d,v,S,A,this._transform):[1,1]}getFovAdjustedRange(a){return this._transform.projection.supportsFog?br(this.state,a):[0,1]}isVisibleOnFrustum(a){if(!this._transform.projection.supportsFog)return!1;const d=[4,5,6,7];for(const v of d){const S=a.points[v];let A;if(S[2]>=0)A=S;else{const P=a.points[v-4];A=s.ak(P,S,P[2]/(P[2]-S[2]))}if(pr(this.state,A[0],A[1],0,this._transform)>=Kt)return!0}return!1}updateConfig(a){this._transitionable.setTransitionOrValue(this._options,new Map(a))}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,d,v){return(!v||v.validate!==!1)&&Oe(this,a.call(Ji,s.h({value:d,style:{glyphs:!0,sprite:!0},styleSpec:s.a5})))}}let Wr,Gi,ai,ws,Ks=class extends s.E{constructor(y,a,d,v){super();const S=Wr||(Wr=new s.a7({density:new s.a8(s.a5.snow.density),intensity:new s.a8(s.a5.snow.intensity),color:new s.a8(s.a5.snow.color),opacity:new s.a8(s.a5.snow.opacity),vignette:new s.a8(s.a5.snow.vignette),"vignette-color":new s.a8(s.a5.snow["vignette-color"]),"center-thinning":new s.a8(s.a5.snow["center-thinning"]),direction:new s.a8(s.a5.snow.direction),"flake-size":new s.a8(s.a5.snow["flake-size"])}));this._transitionable=new s.a6(S,d,new Map(v)),this.set(y,v),this._transitioning=this._transitionable.untransitioned(),this.properties=new s.ag(S),this.scope=d}get state(){const y=this.properties.get("opacity"),a=this.properties.get("color"),d=this.properties.get("direction"),v=s.al(d[0]),S=-Math.max(s.al(d[1]),.01),A=[Math.cos(v)*Math.cos(S),Math.sin(v)*Math.cos(S),Math.sin(S)],P=this.properties.get("vignette"),O=this.properties.get("vignette-color");return O.a=P,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new s.am(a.r,a.g,a.b,a.a*y),direction:A,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:O}}get(){return this._transitionable.serialize()}set(y,a,d={}){if(this._validate(xa,y,d))return;const v=s.h({},y);for(const S of Object.keys(s.a5.snow))v[S]===void 0&&(v[S]=s.a5.snow[S].default);this._options=v,this._transitionable.setTransitionOrValue(this._options,a)}updateConfig(y){this._transitionable.setTransitionOrValue(this._options,new Map(y))}updateTransitions(y){this._transitioning=this._transitionable.transitioned(y,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(y){this.properties=this._transitioning.possiblyEvaluate(y)}_validate(y,a,d){return(!d||d.validate!==!1)&&Oe(this,y.call(Ji,s.h({value:a,style:{glyphs:!0,sprite:!0},styleSpec:s.a5})))}},ca=class extends s.E{constructor(y,a,d,v){super();const S=Gi||(Gi=new s.a7({density:new s.a8(s.a5.rain.density),intensity:new s.a8(s.a5.rain.intensity),color:new s.a8(s.a5.rain.color),opacity:new s.a8(s.a5.rain.opacity),vignette:new s.a8(s.a5.rain.vignette),"vignette-color":new s.a8(s.a5.rain["vignette-color"]),"center-thinning":new s.a8(s.a5.rain["center-thinning"]),direction:new s.a8(s.a5.rain.direction),"droplet-size":new s.a8(s.a5.rain["droplet-size"]),"distortion-strength":new s.a8(s.a5.rain["distortion-strength"])}));this._transitionable=new s.a6(S,d,new Map(v)),this.set(y,v),this._transitioning=this._transitionable.untransitioned(),this.properties=new s.ag(S),this.scope=d}get state(){const y=this.properties.get("opacity"),a=this.properties.get("color"),d=this.properties.get("direction"),v=s.al(d[0]),S=-Math.max(s.al(d[1]),.01),A=[Math.cos(v)*Math.cos(S),Math.sin(v)*Math.cos(S),Math.sin(S)],P=this.properties.get("vignette-color");return P.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new s.am(a.r,a.g,a.b,a.a*y),direction:A,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:P}}get(){return this._transitionable.serialize()}set(y,a,d={}){if(this._validate(ka,y,d))return;const v=s.h({},y);for(const S of Object.keys(s.a5.rain))v[S]===void 0&&(v[S]=s.a5.rain[S].default);this._options=v,this._transitionable.setTransitionOrValue(this._options,a)}updateConfig(y){this._transitionable.setTransitionOrValue(this._options,new Map(y))}updateTransitions(y){this._transitioning=this._transitionable.transitioned(y,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(y){this.properties=this._transitioning.possiblyEvaluate(y)}_validate(y,a,d){return(!d||d.validate!==!1)&&Oe(this,y.call(Ji,s.h({value:a,style:{glyphs:!0,sprite:!0},styleSpec:s.a5})))}};class fr extends s.E{constructor(a,d,v,S){super(),this.scope=v,this._options=a,this.properties=new s.ag(d),this._transitionable=new s.a6(d,v,new Map(S)),this._transitionable.setTransitionOrValue(a.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(a){this._transitionable.setTransitionOrValue(this._options.properties,new Map(a))}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(a,d){this._options=a,this._transitionable.setTransitionOrValue(a.properties,d)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class di{constructor(a,d,v){this.screenBounds=a,this.cameraPoint=v.getCameraPoint(),this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=d,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,v)}static createFromScreenPoints(a,d){let v,S;if(a instanceof s.P||typeof a[0]=="number"){const A=s.P.convert(a);v=[A],S=d.isPointAboveHorizon(A)}else{const A=s.P.convert(a[0]),P=s.P.convert(a[1]),O=A.add(P)._div(2);v=[A,P],S=s.ao(A,P).every((I=>d.isPointAboveHorizon(I)))&&d.isPointAboveHorizon(O)}return new di(v,S,d)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(a){return s.ao(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],a)}bufferedCameraGeometry(a){const d=this.screenBounds[0],v=this.screenBounds.length===1?this.screenBounds[0].add(new s.P(1,1)):this.screenBounds[1],S=s.ao(d,v,0,!1);return this.cameraPoint.y>v.y&&(this.cameraPoint.x>d.x&&this.cameraPoint.x<v.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=v.x?S[2]=this.cameraPoint:this.cameraPoint.x<=d.x&&(S[3]=this.cameraPoint)),s.ap(S,a)}bufferedCameraGeometryGlobe(a){const d=this.screenBounds[0],v=this.screenBounds.length===1?this.screenBounds[0].add(new s.P(1,1)):this.screenBounds[1],S=s.ao(d,v,a),A=this.cameraPoint.clone();switch(3*((A.y>d.y)+(A.y>v.y))+((A.x>d.x)+(A.x>v.x))){case 0:S[0]=A,S[4]=A.clone();break;case 1:S.splice(1,0,A);break;case 2:S[1]=A;break;case 3:S.splice(4,0,A);break;case 5:S.splice(2,0,A);break;case 6:S[3]=A;break;case 7:S.splice(3,0,A);break;case 8:S[2]=A}return S}containsTile(a,d,v,S=0){const A=a.queryPadding/d._pixelsPerMercatorPixel+1,P=v?this._bufferedCameraMercator(A,d):this._bufferedScreenMercator(A,d);let O=a.tileID.wrap+(P.unwrapped?S:0);const I=P.polygon.map((pe=>s.aq(a.tileTransform,pe,O)));if(!s.ar(I,0,0,s.aj,s.aj))return;O=a.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const H=this.screenGeometryMercator.polygon.map((pe=>s.as(a.tileTransform,pe,O))),G=H.map((pe=>new s.P(pe[0],pe[1]))),ne=d.getFreeCameraOptions().position||new s.ac(0,0,0),J=s.as(a.tileTransform,ne,O),re=H.map((pe=>{const me=s.at(pe,pe,J);return s.au(me,me),new s.av(J,me)})),de=s.aw(a,1,d.zoom)*d._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:G,tilespaceRays:re,bufferedTilespaceGeometry:I,bufferedTilespaceBounds:(ce=s.ax(I),ce.min.x=s.ay(ce.min.x,0,s.aj),ce.min.y=s.ay(ce.min.y,0,s.aj),ce.max.x=s.ay(ce.max.x,0,s.aj),ce.max.y=s.ay(ce.max.y,0,s.aj),ce),tile:a,tileID:a.tileID,pixelToTileUnitsFactor:de};var ce}_bufferedScreenMercator(a,d){const v=rs(a);if(this._screenRaycastCache[v])return this._screenRaycastCache[v];{let S;return S=d.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(a),d):{polygon:this.bufferedScreenGeometry(a).map((A=>d.pointCoordinate3D(A))),unwrapped:!0},this._screenRaycastCache[v]=S,S}}_bufferedCameraMercator(a,d){const v=rs(a);if(this._cameraRaycastCache[v])return this._cameraRaycastCache[v];{let S;return S=d.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(a),d):{polygon:this.bufferedCameraGeometry(a).map((A=>d.pointCoordinate3D(A))),unwrapped:!0},this._cameraRaycastCache[v]=S,S}}_projectAndResample(a,d){const v=(function(A,P){const O=s.az([],P.pixelMatrix,P.globeMatrix),I=[0,-s.aB,0,1],H=[0,s.aB,0,1],G=[0,0,0,1];s.aA(I,I,O),s.aA(H,H,O),s.aA(G,G,O);const ne=new s.P(I[0]/I[3],I[1]/I[3]),J=new s.P(H[0]/H[3],H[1]/H[3]),re=s.aC(A,ne)&&I[3]<G[3],de=s.aC(A,J)&&H[3]<G[3];if(!re&&!de)return null;const ce=(function(Ye,Ue,qe){for(let Ge=1;Ge<Ye.length;Ge++){const _t=Fi(Ue.pointCoordinate3D(Ye[Ge-1]).x),ct=Fi(Ue.pointCoordinate3D(Ye[Ge]).x);if(qe<0){if(_t<ct)return{idx:Ge,t:-_t/(ct-1-_t)}}else if(ct<_t)return{idx:Ge,t:(1-_t)/(ct+1-_t)}}return null})(A,P,re?-1:1);if(!ce)return null;const{idx:pe,t:me}=ce;let be=pe>1?wr(A.slice(0,pe),P):[],Ne=pe<A.length?wr(A.slice(pe),P):[];be=be.map((Ye=>new s.P(Fi(Ye.x),Ye.y))),Ne=Ne.map((Ye=>new s.P(Fi(Ye.x),Ye.y)));const De=[...be];De.length===0&&De.push(Ne[Ne.length-1]);const Be=s.ai(De[De.length-1].y,(Ne.length===0?be[0]:Ne[0]).y,me);let Ze;return Ze=re?[new s.P(0,Be),new s.P(0,0),new s.P(1,0),new s.P(1,Be)]:[new s.P(1,Be),new s.P(1,1),new s.P(0,1),new s.P(0,Be)],De.push(...Ze),Ne.length===0?De.push(be[0]):De.push(...Ne),{polygon:De.map((Ye=>new s.ac(Ye.x,Ye.y))),unwrapped:!1}})(a,d);if(v)return v;const S=(function(A,P){let O=!1,I=-1/0,H=0;for(let ne=0;ne<A.length-1;ne++)A[ne].x>I&&(I=A[ne].x,H=ne);for(let ne=0;ne<A.length-1;ne++){const J=(H+ne)%(A.length-1),re=A[J],de=A[J+1];Math.abs(re.x-de.x)>.5&&(re.x<de.x?(re.x+=1,J===0&&(A[A.length-1].x+=1)):(de.x+=1,J+1===A.length-1&&(A[0].x+=1)),O=!0)}const G=s.aD(P.center.lng);return O&&G<Math.abs(G-1)&&A.forEach((ne=>{ne.x-=1})),{polygon:A,unwrapped:O}})(wr(a,d).map((A=>new s.P(Fi(A.x),A.y))),d);return{polygon:S.polygon.map((A=>new s.ac(A.x,A.y))),unwrapped:S.unwrapped}}}function wr(y,a){return s.aE(y,(d=>{const v=a.pointCoordinate3D(d);d.x=v.x,d.y=v.y}),1/256)}function Fi(y){return y<0?1+y%1:y%1}function rs(y){return 100*y|0}function Js(y,a,d,v,S){const A=function(O,I){if(O)return S(O);if(I){if(y.url&&I.tiles&&y.tiles&&delete y.tiles,I.variants){if(!Array.isArray(I.variants))return S(new Error("variants must be an array"));for(const G of I.variants){if(G==null||typeof G!="object"||G.constructor!==Object)return S(new Error("variant must be an object"));if(!Array.isArray(G.capabilities))return S(new Error("capabilities must be an array"));if(G.capabilities.length===1&&G.capabilities[0]==="meshopt"){I=s.h(I,G);break}}}const H=s.aF(s.h({},I,y),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);H.tiles=a.canonicalizeTileset(H,y.url),S(null,H)}},P=(function(O,I,H){if(!O)return null;if(!I&&!H)return O;H=H||O.worldview_default;const G=Object.values(O.language||{});if(G.length===0)return null;const ne=Object.values(O.worldview||{});if(ne.length===0)return null;const J=G.every((de=>de===I)),re=ne.every((de=>de===H));return J&&re?O:I in(O.language_options||{})||H in(O.worldview_options||{})?null:O.language_options&&O.worldview_options?O:null})(y.data,d,v);return P?s.q.frame((()=>A(null,P))):y.url?s.n(a.transformRequest(a.normalizeSourceURL(y.url,null,d,v),s.R.Source),A):s.q.frame((()=>{const{data:O,...I}=y;A(null,I)}))}function Na(y,a){const d=Math.pow(2,a.z),v=Math.floor(s.aD(y.getWest())*d),S=Math.floor(s.aH(y.getNorth())*d),A=Math.ceil(s.aD(y.getEast())*d),P=Math.ceil(s.aH(y.getSouth())*d);return a.x>=v&&a.x<A&&a.y>=S&&a.y<P}class Ia{constructor(a,d,v){this.bounds=a?s.aG.convert(this.validateBounds(a)):null,this.minzoom=d||0,this.maxzoom=v||24}validateBounds(a){return Array.isArray(a)&&a.length===4?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]}addExtraBounds(a){if(a){this.extraBounds||(this.extraBounds=[]);for(const d of a)this.extraBounds.push(s.aG.convert(this.validateBounds(d)))}}contains(a){if(a.z>this.maxzoom||a.z<this.minzoom||this.bounds&&!Na(this.bounds,a))return!1;if(!this.extraBounds)return!0;for(const d of this.extraBounds)if(Na(d,a))return!0;return!1}static fromTileJSON(a){if(!a.bounds&&!a.extra_bounds)return null;const d=new Ia(a.bounds,a.minzoom,a.maxzoom);return d.addExtraBounds(a.extra_bounds),d}}class id extends s.E{constructor(a,d,v,S){if(super(),this.id=a,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.h(this,s.aF(d,["url","scheme","tileSize","promoteId"])),this._options=s.h({type:"vector"},d),this._collectResourceTiming=!!d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new s.aI}load(a){this._loaded=!1,this.fire(new s.A("dataloading",{dataType:"source"}));const d=Array.isArray(this.map._language)?this.map._language.join():this.map._language,v=this.map.getWorldview();this._tileJSONRequest=Js(this._options,this.map._requestManager,d,v,((S,A)=>{if(this._tileJSONRequest=null,this._loaded=!0,S)d&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${d}`),v&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${v}`),this.fire(new s.z(S));else if(A){if(s.h(this,A),this.hasWorldviews=!!A.worldview_options,A.worldview_default&&(this.worldviewDefault=A.worldview_default),A.vector_layers){this.vectorLayers=A.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const P of A.vector_layers)this.vectorLayerIds.push(P.id),A.worldview&&A.worldview[P.source]&&this.localizableLayerIds.add(P.id)}this.tileBounds=Ia.fromTileJSON(A),We(A.tiles,this.map._requestManager._customAccessToken),this.fire(new s.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.A("data",{dataType:"source",sourceDataType:"content"}))}a&&a(S)}))}loaded(){return this._loaded}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}onAdd(a){this.map=a,this.load()}reload(){this.cancelTileJSONRequest();const a=s.C(this.id,this.scope);this.load((()=>this.map.style.clearSource(a)))}setTiles(a){return this._options.tiles=a,this.reload(),this}setUrl(a){return this.url=a,this._options.url=a,this.reload(),this}onRemove(a){this.cancelTileJSONRequest()}serialize(){return s.h({},this._options)}loadTile(a,d){const v=a.tileID.canonical.url(this.tiles,this.scheme),S=this.map._requestManager.normalizeTileURL(v),A=this.map._requestManager.transformRequest(S,s.R.Tile),P=this.map.style?this.map.style.getLut(this.scope):null,O=P?{image:P.image.clone()}:null,I={request:A,data:void 0,uid:a.uid,tileID:a.tileID,tileZoom:a.tileZoom,zoom:a.tileID.overscaledZ,maxZoom:this.maxzoom,lut:O,tileSize:this.tileSize*a.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:s.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:a.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:a.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor(),worldview:this.map.getWorldview()||this.worldviewDefault};if(this.hasWorldviews&&s.j(v)&&(I.localizableLayerIds=this.localizableLayerIds),I.request.collectResourceTiming=this._collectResourceTiming,a.actor&&a.state!=="expired")a.state==="loading"?a.reloadCallback=d:a.request=a.actor.send("reloadTile",I,H.bind(this));else if(a.actor=this._tileWorkers[S]=this._tileWorkers[S]||this.dispatcher.getActor(),this.dispatcher.ready)a.request=a.actor.send("loadTile",I,H.bind(this),void 0,!0);else{const G=s.aJ.call({deduped:this._deduped},I,((ne,J)=>{ne||!J?H.call(this,ne):(I.data={cacheControl:J.cacheControl,expires:J.expires,rawData:J.rawData.slice(0)},a.actor&&a.actor.send("loadTile",I,H.bind(this),void 0,!0))}),!0);a.request={cancel:G}}function H(G,ne){return delete a.request,a.aborted?d(null):G&&G.status!==404?d(G):(ne&&ne.resourceTiming&&(a.resourceTiming=ne.resourceTiming),this.map._refreshExpiredTiles&&ne&&a.setExpiryData(ne),a.loadVectorData(ne,this.map.painter),s.aK(this.dispatcher),d(null),void(a.reloadCallback&&(this.loadTile(a,a.reloadCallback),a.reloadCallback=null)))}}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(a,d){a.actor&&a.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id,scope:this.scope}),a.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ua extends s.E{constructor(a,d,v,S){super(),this.id=a,this.dispatcher=v,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.h({type:"raster"},d),s.h(this,s.aF(d,["url","scheme","tileSize"]))}load(a){this._loaded=!1,this.fire(new s.A("dataloading",{dataType:"source"}));const d=this.map.getWorldview();this._tileJSONRequest=Js(this._options,this.map._requestManager,null,d,((v,S)=>{this._tileJSONRequest=null,this._loaded=!0,v?this.fire(new s.z(v)):S&&(s.h(this,S),S.raster_layers&&(this.rasterLayers=S.raster_layers,this.rasterLayerIds=this.rasterLayers.map((A=>A.id))),this.tileBounds=Ia.fromTileJSON(S),We(S.tiles),this.fire(new s.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.A("data",{dataType:"source",sourceDataType:"content"}))),a&&a(v)}))}loaded(){return this._loaded}onAdd(a){this.map=a,this.load()}reload(){this.cancelTileJSONRequest();const a=s.C(this.id,this.scope);this.load((()=>this.map.style.clearSource(a)))}setTiles(a){return this._options.tiles=a,this.reload(),this}setUrl(a){return this.url=a,this._options.url=a,this.reload(),this}onRemove(a){this.cancelTileJSONRequest()}serialize(){return s.h({},this._options)}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}loadTile(a,d){const v=s.q.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),v,this.tileSize);a.request=s.o(this.map._requestManager.transformRequest(S,s.R.Tile),((A,P,O,I)=>(delete a.request,a.aborted?(a.state="unloaded",d(null)):A?(a.state="errored",d(A)):P?(this.map._refreshExpiredTiles&&a.setExpiryData({cacheControl:O,expires:I}),a.setTexture(P,this.map.painter),a.state="loaded",s.aK(this.dispatcher),void d(null)):d(null))))}abortTile(a,d){a.request&&(a.request.cancel(),delete a.request),d&&d()}unloadTile(a,d){a.texture&&a.texture instanceof s.T?(a.destroy(!0),a.texture&&a.texture instanceof s.T&&this.map.painter.saveTileTexture(a.texture)):a.destroy(),d&&d()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ts extends Ua{constructor(a,d,v,S){super(a,d,v,S),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._options=s.h({type:"raster-array"},d)}triggerRepaint(a){const d=this.map.painter._terrain,v=this.map.style.getSourceCache(this.id);d&&d.enabled&&v&&d._clearRenderCacheForTile(v.id,a.tileID),this.map.triggerRepaint()}loadTile(a,d){const v=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),S=this.map._requestManager.transformRequest(v,s.R.Tile),A={request:S,uid:a.uid,tileID:a.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};a.source=this.id,a.scope=this.scope,a.requestParams=S,a.actor||(a.actor=this.dispatcher.getActor());const P=(O,I,H,G)=>{if(delete a.request,a.aborted)return a.state="unloaded",d(null);if(O)return O.name==="AbortError"?void 0:(a.state="errored",d(O));if(this.map._refreshExpiredTiles&&I&&a.setExpiryData({cacheControl:H,expires:G}),this.partial)a.state="empty";else{if(!I)return d(null);a.state="loaded",a._isHeaderLoaded=!0,a._mrt=I}d(null)};a.request=this.partial?a.fetchHeader(void 0,P.bind(this)):a.actor.send("loadTile",A,P.bind(this),void 0,!0)}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(a,d){const v=a.texturePerLayer;if(a.flushAllQueues(),v.size){a.destroy(!0);for(const S of v.values())this.map.painter.saveTileTexture(S)}else a.destroy()}prepareTile(a,d,v,S){a._isHeaderLoaded&&(a.state!=="empty"&&(a.state="reloading"),a.fetchBand(d,v,S,((A,P)=>{if(A)return a.state="errored",this.fire(new s.z(A)),void this.triggerRepaint(a);P&&(a._isHeaderLoaded=!0,a.setTexturePerLayer(v,P,this.map.painter),a.state="loaded",this.triggerRepaint(a))})))}getInitialBand(a){if(!this.rasterLayers)return 0;const d=this.rasterLayers.find((({id:A})=>A===a)),v=d&&d.fields,S=v&&v.bands&&v.bands;return S?S[0]:0}getTextureDescriptor(a,d,v){if(!a)return;const S=d.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!S)return;let A=null;d instanceof s.aN?A=d.paint.get("raster-array-band"):d instanceof s.aO&&(A=d.paint.get("raster-particle-array-band"));const P=A||this.getInitialBand(S);if(P==null)return;if(!a.textureDescriptorPerLayer.get(d.id))return void this.prepareTile(a,S,d.id,P);if(a.updateNeeded(d.id,P)&&!v)return;const O=a.textureDescriptorPerLayer.get(d.id);return Object.assign({},O,{texture:a.texturePerLayer.get(d.id)})}getImages(a,d){const v=new Map;for(const S of a)for(const A of d){const[P,O]=A.split("/"),I=S.getLayer(P);if(!I||!I.hasBand(O)||!I.hasDataForBand(O))continue;const{bytes:H,tileSize:G,buffer:ne}=I.getBandView(O),J=G+2*ne,re={data:new s.r({width:J,height:J},H),pixelRatio:2,sdf:!1,usvg:!1,version:0};v.set(A,re)}return v}}const dc={vector:id,raster:Ua,"raster-dem":class extends Ua{constructor(y,a,d,v){super(y,a,d,v),this.type="raster-dem",this.maxzoom=22,this._options=s.h({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox"}loadTile(y,a){const d=this.map._requestManager.normalizeTileURL(y.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function v(S,A){S&&(y.state="errored",a(S)),A&&(y.dem=A,y.dem.onDeserialize(),y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0,y.state="loaded",a(null))}y.request=s.o(this.map._requestManager.transformRequest(d,s.R.Tile),(function(S,A,P,O){if(delete y.request,y.aborted)y.state="unloaded",a(null);else if(S)y.state="errored",a(S);else if(A){this.map._refreshExpiredTiles&&y.setExpiryData({cacheControl:P,expires:O});const I=ImageBitmap&&A instanceof ImageBitmap&&s.t(),H=1-(A.width-s.aL(A.width))/2;H<1||y.neighboringTiles||(y.neighboringTiles=this._getNeighboringTiles(y.tileID));const G=I?A:s.q.getImageData(A,H),ne={uid:y.uid,tileID:y.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:G,encoding:this.encoding,padding:H};y.actor&&y.state!=="expired"||(y.actor=this.dispatcher.getActor(),y.actor.send("loadTile",ne,v.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(y){const a=y.canonical,d=Math.pow(2,a.z),v=(a.x-1+d)%d,S=a.x===0?y.wrap-1:y.wrap,A=(a.x+1+d)%d,P=a.x+1===d?y.wrap+1:y.wrap,O={};return O[new s.aM(y.overscaledZ,S,a.z,v,a.y).key]={backfilled:!1},O[new s.aM(y.overscaledZ,P,a.z,A,a.y).key]={backfilled:!1},a.y>0&&(O[new s.aM(y.overscaledZ,S,a.z,v,a.y-1).key]={backfilled:!1},O[new s.aM(y.overscaledZ,y.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},O[new s.aM(y.overscaledZ,P,a.z,A,a.y-1).key]={backfilled:!1}),a.y+1<d&&(O[new s.aM(y.overscaledZ,S,a.z,v,a.y+1).key]={backfilled:!1},O[new s.aM(y.overscaledZ,y.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},O[new s.aM(y.overscaledZ,P,a.z,A,a.y+1).key]={backfilled:!1}),O}},"raster-array":ts,geojson:class extends s.E{constructor(y,a,d,v){super(),this.id=y,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(v),this._data=a.data,this._options=s.h({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.minzoom!==void 0&&(this.minzoom=a.minzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const S=s.aj/this.tileSize;this.workerOptions=s.h({source:this.id,scope:this.scope,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*S,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*S,extent:s.aj,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:s.aj,radius:(a.clusterRadius!==void 0?a.clusterRadius:50)*S,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter,dynamic:a.dynamic},a.workerOptions)}onAdd(y){this.map=y,this.setData(this._data)}setData(y){return this._data=y,this._updateWorkerData(),this}updateData(y){if(!this._options.dynamic)return this.fire(new s.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof y!="string"&&(y.type==="Feature"&&(y={type:"FeatureCollection",features:[y]}),y.type!=="FeatureCollection"))return this.fire(new s.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof y!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const a=new Map;for(const d of this._data.features)a.set(d.id,d);for(const d of y.features)a.set(d.id,d);this._data.features=[...a.values()]}else this._data=y;return this._updateWorkerData(!0),this}getClusterExpansionZoom(y,a){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:y,source:this.id,scope:this.scope},a),this}getClusterChildren(y,a){return this.actor.send("geojson.getClusterChildren",{clusterId:y,source:this.id,scope:this.scope},a),this}getClusterLeaves(y,a,d,v){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:y,limit:a,offset:d},v),this}_updateWorkerData(y=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.A("dataloading",{dataType:"source"})),this._loaded=!1;const a=s.h({append:y},this.workerOptions);a.scope=this.scope;const d=this._data;typeof d=="string"?(a.request=this.map._requestManager.transformRequest(s.q.resolveURL(d),s.R.Source),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(d),this._pendingLoad=this.actor.send(`${this.type}.loadData`,a,((v,S)=>{if(this._loaded=!0,this._pendingLoad=null,v)this.fire(new s.z(v));else{const A={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&S&&S.resourceTiming&&S.resourceTiming[this.id]&&(A.resourceTiming=S.resourceTiming[this.id]),y&&(this._partialReload=!0),this.fire(new s.A("data",A)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(y),this._coalesce=!1)}))}loaded(){return this._loaded}reload(){const y=s.C(this.id,this.scope);this.map.style.clearSource(y),this._updateWorkerData()}loadTile(y,a){const d=y.actor?"reloadTile":"loadTile";y.actor=this.actor;const v=this.map.style?this.map.style.getLut(this.scope):null,S=v?{image:v.image.clone()}:null,A=this._partialReload,P={type:this.type,uid:y.uid,tileID:y.tileID,tileZoom:y.tileZoom,zoom:y.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:S,scope:this.scope,pixelRatio:s.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:y.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:A,worldview:this.map.getWorldview()};y.request=this.actor.send(d,P,((O,I)=>A&&!I?(y.state="loaded",a(null)):(delete y.request,y.destroy(),y.aborted?a(null):O?a(O):(y.loadVectorData(I,this.map.painter,d==="reloadTile"),a(null)))),void 0,d==="loadTile")}abortTile(y){y.request&&(y.request.cancel(),delete y.request),y.aborted=!0}unloadTile(y,a){this.actor.send("removeTile",{uid:y.uid,type:this.type,source:this.id,scope:this.scope}),y.destroy()}onRemove(y){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.h({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends s.aP{constructor(y,a,d,v){super(y,a,d,v),this.roundZoom=!0,this.type="video",this.options=a}load(){this._loaded=!1;const y=this.options;this.urls=[];for(const a of y.urls)this.urls.push(this.map._requestManager.transformRequest(a,s.R.Source).url);s.aQ(this.urls,((a,d)=>{this._loaded=!0,a?this.fire(new s.z(a)):d&&(this.video=d,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(y){if(this.video){const a=this.video.seekable;y<a.start(0)||y>a.end(0)?this.fire(new s.z(new s.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=y}}getVideo(){return this.video}onAdd(y){this.map||(this.map=y,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const y=this.map.painter.context,a=y.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new s.T(y,this.video,a.RGBA8),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(y)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:s.aP,model:class extends s.E{constructor(y,a,d,v){super(),this.id=y,this.type="model",this.models=[],this._loaded=!1,this._options=a}load(){const y=[];for(const a in this._options.models){const d=this._options.models[a],v=s.aS(this.map._requestManager.transformRequest(d.uri,s.R.Model).url).then((S=>{if(!S)return;const A=s.aT(S),P=new s.aU(a,d.position,d.orientation,A);P.computeBoundsAndApplyParent(),this.models.push(P)})).catch((S=>{this.fire(new s.z(new Error(`Could not load model ${a} from ${d.uri}: ${S.message}`)))}));y.push(v)}Promise.allSettled(y).then((()=>{this._loaded=!0,this.fire(new s.A("data",{dataType:"source",sourceDataType:"metadata"}))})).catch((a=>{this._loaded=!0,this.fire(new s.z(new Error(`Could not load models: ${a.message}`)))}))}onAdd(y){this.map=y,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(y,a){}serialize(){return this._options}},"batched-model":class extends s.E{constructor(y,a,d,v){super(),this.type="batched-model",this.id=y,this.tileSize=512,this._options=a,this.tiles=this._options.tiles,this.maxzoom=a.maxzoom||19,this.minzoom=a.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=d,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(v)}onAdd(y){this.map=y,this.load()}reload(){this.cancelTileJSONRequest();const y=s.C(this.id,this.scope);this.load((()=>this.map.style.clearSource(y)))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(y){this._loaded=!1,this.fire(new s.A("dataloading",{dataType:"source"}));const a=Array.isArray(this.map._language)?this.map._language.join():this.map._language,d=this.map.getWorldview();this._tileJSONRequest=Js(this._options,this.map._requestManager,a,d,((v,S)=>{this._tileJSONRequest=null,this._loaded=!0,v?(a&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${a}`),d&&d.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${d}`),this.fire(new s.z(v))):S&&(s.h(this,S),S.bounds&&(this.tileBounds=new Ia(S.bounds,this.minzoom,this.maxzoom)),We(S.tiles,this.map._requestManager._customAccessToken),this.fire(new s.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.A("data",{dataType:"source",sourceDataType:"content"}))),y&&y(v)}))}hasTransition(){return!1}hasTile(y){return!this.tileBounds||this.tileBounds.contains(y.canonical)}loaded(){return this._loaded}loadTile(y,a){const d=this.map._requestManager.normalizeTileURL(y.tileID.canonical.url(this.tiles,this.scheme)),v={request:this.map._requestManager.transformRequest(d,s.R.Tile),data:void 0,uid:y.uid,tileID:y.tileID,tileZoom:y.tileZoom,zoom:y.tileID.overscaledZ,tileSize:this.tileSize*y.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:y.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:s.q.devicePixelRatio,promoteId:this.promoteId};if(y.actor&&y.state!=="expired")if(y.state==="loading")y.reloadCallback=a;else{if(y.buckets){const A=Object.values(y.buckets);for(const P of A)P.dirty=!0;return void(y.state="loaded")}y.request=y.actor.send("reloadTile",v,S.bind(this))}else y.actor=this.dispatcher.getActor(),y.request=y.actor.send("loadTile",v,S.bind(this),void 0,!0);function S(A,P){return y.aborted?a(null):A&&A.status!==404?a(A):(this.map._refreshExpiredTiles&&P&&y.setExpiryData(P),y.loadModelData(P,this.map.painter),y.state="loaded",void a(null))}}serialize(){return s.h({},this._options)}},canvas:class extends s.aP{constructor(y,a,d,v){super(y,a,d,v),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some((S=>!Array.isArray(S)||S.length!==2||S.some((A=>typeof A!="number"))))||this.fire(new s.z(new s.V(`sources.${y}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.z(new s.V(`sources.${y}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new s.z(new s.V(`sources.${y}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new s.z(new s.V(`sources.${y}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.z(new s.V(`sources.${y}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(y){this.map=y,this.load(),this.canvas&&this.animate&&this.play()}onRemove(y){this.pause()}prepare(){let y=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,y=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,y=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context;this.texture?!y&&!this._playing||this.texture instanceof s.aR||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.T(a,this.canvas,a.gl.RGBA8,{premultiply:!0}),this._prepareData(a)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const y of[this.canvas.width,this.canvas.height])if(isNaN(y)||y<=0)return!0;return!1}},custom:class extends s.E{constructor(y,a,d,v){super(),this.id=y,this.type="custom",this._dataType="raster",this._dispatcher=d,this._implementation=a,this.setEventedParent(v),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ia(this._implementation.bounds,this.minzoom,this.maxzoom)),a.update=this._update.bind(this),a.clearTiles=this._clearTiles.bind(this),a.coveringTiles=this._coveringTiles.bind(this),s.h(this,s.aF(a,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.aF(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(y){this.map=y,this._loaded=!1,this.fire(new s.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(y),this.load()}onRemove(y){this._implementation.onRemove&&this._implementation.onRemove(y)}hasTile(y){if(this._implementation.hasTile){const{x:a,y:d,z:v}=y.canonical;return this._implementation.hasTile({x:a,y:d,z:v})}return!this.tileBounds||this.tileBounds.contains(y.canonical)}loadTile(y,a){const{x:d,y:v,z:S}=y.tileID.canonical,A=new AbortController;y.request=Promise.resolve(this._implementation.loadTile({x:d,y:v,z:S},{signal:A.signal})).then((function(P){return delete y.request,y.aborted?(y.state="unloaded",a(null)):P===void 0?(y.state="errored",a(null)):P===null?(this.loadTileData(y,{width:this.tileSize,height:this.tileSize,data:null}),y.state="loaded",a(null)):(function(O){return O instanceof ImageData||O instanceof HTMLCanvasElement||O instanceof ImageBitmap||O instanceof HTMLImageElement})(P)?(this.loadTileData(y,P),y.state="loaded",void a(null)):(y.state="errored",a(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch((P=>{P.name!=="AbortError"&&(y.state="errored",a(P))})),y.request.cancel=()=>A.abort()}loadTileData(y,a){y.setTexture(a,this.map.painter)}unloadTile(y,a){if(y.texture&&y.texture instanceof s.T?(y.destroy(!0),y.texture&&y.texture instanceof s.T&&this.map.painter.saveTileTexture(y.texture)):y.destroy(),this._implementation.unloadTile){const{x:d,y:v,z:S}=y.tileID.canonical;this._implementation.unloadTile({x:d,y:v,z:S})}a&&a()}abortTile(y,a){y.request&&y.request.cancel&&(y.request.cancel(),delete y.request),a&&a()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((y=>({x:y.canonical.x,y:y.canonical.y,z:y.canonical.z})))}_clearTiles(){const y=s.C(this.id,this.scope);this.map.style.clearSource(y)}_update(){this.fire(new s.A("data",{dataType:"source",sourceDataType:"content"}))}}},Dl=function(y,a,d,v){const S=new dc[a.type](y,a,d,v);if(S.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${S.id}`);return s.aV(["load","abort","unload","serialize","prepare"],S),S};function hc(y,a,d=""){return`${d}:${a.id||""}:${a.layer.id}:${(function(v){if("layerId"in v)return`layer:${v.layerId}`;{const{featuresetId:S,importId:A}=v;return`featureset:${S}${A?`:import:${A}`:""}`}})(y.target)}`}function Nu(y,a,d,v=""){if(y.uniqueFeatureID){const S=hc(y,a,v);if(d.has(S))return!0;d.add(S)}return!1}function ru(y,a,d,v,S=!1){const A=a.sourceCache.transform,P=a.sourceCache.tilesIn(y,a.has3DLayers,S);P.sort(sd);const O=[];for(const I of P){const H=I.tile.queryRenderedFeatures(a,I,d,v,A,S);Object.keys(H).length&&O.push({wrappedTileID:I.tile.tileID.wrapped().key,queryResults:H})}return O.length===0?{}:(function(I){const H={},G={};for(const ne of I){const J=ne.queryResults,re=ne.wrappedTileID,de=G[re]=G[re]||{};for(const ce in J){const pe=J[ce],me=de[ce]=de[ce]||{},be=H[ce]=H[ce]||[];for(const Ne of pe)me[Ne.featureIndex]||(me[Ne.featureIndex]=!0,be.push(Ne))}}return H})(O)}function fc(y,a,d,v,S,A){const P={},O=v.queryRenderedSymbols(y),I=[];for(const H of Object.keys(O).map(Number))I.push(S[H]);I.sort(sd);for(const H of I){const G=H.featureIndex.lookupSymbolFeatures(O[H.bucketInstanceId],H.bucketIndex,H.sourceLayerIndex,a,d,A);for(const ne in G){const J=P[ne]=P[ne]||[],re=G[ne];re.sort(((de,ce)=>{const pe=H.featureSortOrder;if(pe){const me=pe.indexOf(de.featureIndex);return pe.indexOf(ce.featureIndex)-me}return ce.featureIndex-de.featureIndex}));for(const de of re)J.push(de)}}return P}function Xa(y,a){const d=y.getRenderableIds().map((A=>y.getTileByID(A))),v=[],S={};for(let A=0;A<d.length;A++){const P=d[A],O=P.tileID.canonical.key;S[O]||(S[O]=!0,P.querySourceFeatures(v,a))}return v}function sd(y,a){const d=y.tileID,v=a.tileID;return d.overscaledZ-v.overscaledZ||d.canonical.y-v.canonical.y||d.wrap-v.wrap||d.canonical.x-v.canonical.x}function co(y,a){const d={};if(!a)return d;for(const v of y){const S=v.layerIds.map((A=>a.getLayer(A))).filter(Boolean);if(S.length!==0){v.layers=S,v.stateDependentLayerIds&&(v.stateDependentLayers=v.stateDependentLayerIds.map((A=>S.filter((P=>P.id===A))[0])));for(const A of S)d[A.fqid]=v}}return d}const zo=32,Za=33,Zo=new Uint16Array(8184);for(let y=0;y<2046;y++){let a=y+2,d=0,v=0,S=0,A=0,P=0,O=0;for(1&a?S=A=P=zo:d=v=O=zo;(a>>=1)>1;){const H=d+S>>1,G=v+A>>1;1&a?(S=d,A=v,d=P,v=O):(d=S,v=A,S=P,A=O),P=H,O=G}const I=4*y;Zo[I+0]=d,Zo[I+1]=v,Zo[I+2]=S,Zo[I+3]=A}const Po=new Uint16Array(2178),to=new Uint8Array(1089),Pu=new Uint16Array(1089);function ml(y){return y===0?-.03125:y===32?.03125:0}const pc={type:2,extent:s.aj,loadGeometry:()=>[[new s.P(0,0),new s.P(s.aj+1,0),new s.P(s.aj+1,s.aj+1),new s.P(0,s.aj+1),new s.P(0,0)]]};class Va{constructor(a,d,v,S,A,P){this.tileID=a,this.uid=s.a$(),this.uses=0,this.tileSize=d,this.tileZoom=v,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=A,S&&S.style&&(this._lastUpdatedBrightness=S.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",S&&S.transform&&(this.projection=S.transform.projection),this.worldview=P}registerFadeDuration(a){const d=a+this.timeAdded;d<s.q.now()||this.fadeEndTime&&d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=s.aW(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(a,d,v){if(this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=co(a.buckets,d.style),this.hasSymbolBuckets=!1;for(const S in this.buckets){const A=this.buckets[S];if(A instanceof s.b1){if(this.hasSymbolBuckets=!0,!v)break;A.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const S in this.buckets){const A=this.buckets[S];if(A instanceof s.b1&&A.hasRTLText){this.hasRTLText=!0,s.b2();break}}this.queryPadding=0;for(const S in this.buckets){const A=this.buckets[S],P=d.style.getOwnLayer(S);if(!P)continue;const O=P.queryRadius(A);this.queryPadding=Math.max(this.queryPadding,O)}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage),a.lineAtlas&&(this.lineAtlas=a.lineAtlas),this._lastUpdatedBrightness=a.brightness}else this.collisionBoxArray=new s.b0}unloadVectorData(){if(this.hasData()){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(a,d,v){a&&(a.resourceTiming&&(this.resourceTiming=a.resourceTiming),this.buckets=Object.assign({},this.buckets,co(a.buckets,d.style)),a.featureIndex&&(this.latestFeatureIndex=a.featureIndex))}getBucket(a){return this.buckets[a.fqid]}upload(a){for(const S in this.buckets){const A=this.buckets[S];A.uploadPending()&&A.upload(a)}const d=a.gl,v=this.imageAtlas;v&&!v.uploaded&&(this.imageAtlasTexture=new s.T(a,v.image,d.RGBA8,{useMipmap:!!v.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new s.T(a,this.glyphAtlasImage,d.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new s.T(a,this.lineAtlas.image,d.R8),this.lineAtlas.uploaded=!0)}prepare(a,d,v){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture,v),!d||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const S=d.style.getBrightness();(this._lastUpdatedBrightness||S)&&(this._lastUpdatedBrightness&&S&&Math.abs(this._lastUpdatedBrightness-S)<.001||(this.updateBuckets(d,this._lastUpdatedBrightness!==S),this._lastUpdatedBrightness=S))}queryRenderedFeatures(a,d,v,S,A,P){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const O=(function(I,H){const G=s.bn([],[.5*I.width,.5*-I.height,1]);return s.bo(G,G,[1,-1,0]),s.az(G,G,I.calculateProjMatrix(H.toUnwrapped())),Float32Array.from(G)})(A,this.tileID);return this.latestFeatureIndex.query(a,{tilespaceGeometry:d,pixelPosMatrix:O,transform:S,availableImages:v,tileTransform:this.tileTransform,worldview:this.worldview})}querySourceFeatures(a,d){const v=this.latestFeatureIndex;if(!v||!v.rawTileData)return;const S=v.loadVTLayers(),A=d?d.sourceLayer:"",P=S._geojsonTileLayer||S[A];if(!P)return;const O=s.b3(d&&d.filter),{z:I,x:H,y:G}=this.tileID.canonical,ne={z:I,x:H,y:G};for(let J=0;J<P.length;J++){const re=P.feature(J);if(O.needGeometry){const pe=s.b4(re,!0);if(!O.filter(new s.aa(this.tileID.overscaledZ,{worldview:this.worldview}),pe,this.tileID.canonical))continue}else if(!O.filter(new s.aa(this.tileID.overscaledZ,{worldview:this.worldview}),re))continue;const de=v.getId(re,A),ce=new s.b5(re,I,H,G,de);ce.tile=ne,a.push(ce)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(a){const d=this.expirationTime;if(a.cacheControl){const v=s.b6(a.cacheControl);v["max-age"]&&(this.expirationTime=Date.now()+1e3*v["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){const v=Date.now();let S=!1;if(this.expirationTime>v)S=!1;else if(d)if(this.expirationTime<d)S=!0;else{const A=this.expirationTime-d;A?this.expirationTime=v+Math.max(A,3e4):S=!0}else S=!0;S?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(a){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&a&&this.updateBuckets(a)}updateBuckets(a,d){if(!this.latestFeatureIndex||!a.style)return;const v=this.latestFeatureIndex.loadVTLayers(),S=a.style.listImages(),A=a.style.getBrightness();for(const P in this.buckets){if(!a.style.hasLayer(P))continue;const O=this.buckets[P],I=O.layers[0],H=I.sourceLayer||"_geojsonTileLayer",G=v[H],ne=a.style.getLayerSourceCache(I);let J={};ne&&(J=ne._state.getState(H,void 0));const re=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},de=Object.keys(J).length>0&&!d;de&&!O.stateDependentLayers.length&&!d||O.update(J,G,S,re,de?O.stateDependentLayers:O.layers,d,A),(O instanceof s.b7||O instanceof s.b8)&&a._terrain&&a._terrain.enabled&&ne&&O.uploadPending()&&a._terrain._clearRenderCacheForTile(ne.id,this.tileID);const ce=a&&a.style&&a.style.getOwnLayer(P);ce&&(this.queryPadding=Math.max(this.queryPadding,ce.queryRadius(O)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<s.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=s.q.now()+a}setTexture(a,d){const v=d.context,S=v.gl;this.texture=this.texture||d.getTileTexture(a.width),this.texture&&this.texture instanceof s.T?this.texture.update(a):(this.texture=new s.T(v,a,S.RGBA8,{useMipmap:!0}),this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE))}setDependencies(a,d){const v={};for(const S of d)v[S]=!0;this.dependencies[a]=v}hasDependency(a,d){for(const v of a){const S=this.dependencies[v];if(S){for(const A of d)if(S[A])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(a,d){if(!d||d.name==="mercator"||this._tileDebugBuffer)return;const v=s.b9(pc,this.tileID.canonical,this.tileTransform)[0],S=new s.ba,A=new s.bb;for(let P=0;P<v.length;P++){const{x:O,y:I}=v[P];S.emplaceBack(O,I),A.emplaceBack(P)}A.emplaceBack(0),this._tileDebugIndexBuffer=a.createIndexBuffer(A),this._tileDebugBuffer=a.createVertexBuffer(S,s.bc.members),this._tileDebugSegments=s.bd.simpleSegment(0,0,S.length,A.length)}_makeTileBoundsBuffers(a,d){if(this._tileBoundsBuffer||!d||d.name==="mercator")return;const v=s.b9(pc,this.tileID.canonical,this.tileTransform)[0];let S,A;if(this.isRaster){const P=(function(O,I){const H=s.aW(O,I),G=Math.pow(2,O.z);for(let pe=0;pe<Za;pe++)for(let me=0;me<Za;me++){const be=s.aX((O.x+(me+ml(me))/zo)/G),Ne=s.aY((O.y+(pe+ml(pe))/zo)/G),De=I.project(be,Ne),Be=pe*Za+me;Po[2*Be+0]=Math.round((De.x*H.scale-H.x)*s.aj),Po[2*Be+1]=Math.round((De.y*H.scale-H.y)*s.aj)}to.fill(0),Pu.fill(0);for(let pe=2045;pe>=0;pe--){const me=4*pe,be=Zo[me+0],Ne=Zo[me+1],De=Zo[me+2],Be=Zo[me+3],Ze=be+De>>1,Ye=Ne+Be>>1,Ue=Ze+Ye-Ne,qe=Ye+be-Ze,Ge=Ne*Za+be,_t=Be*Za+De,ct=Ye*Za+Ze,Bt=Math.hypot((Po[2*Ge+0]+Po[2*_t+0])/2-Po[2*ct+0],(Po[2*Ge+1]+Po[2*_t+1])/2-Po[2*ct+1])>=16;to[ct]=to[ct]||(Bt?1:0),pe<1022&&(to[ct]=to[ct]||to[(Ne+qe>>1)*Za+(be+Ue>>1)]||to[(Be+qe>>1)*Za+(De+Ue>>1)])}const ne=new s.aZ,J=new s.a_;let re=0;function de(pe,me){const be=me*Za+pe;return Pu[be]===0&&(ne.emplaceBack(Po[2*be+0],Po[2*be+1],pe*s.aj/zo,me*s.aj/zo),Pu[be]=++re),Pu[be]-1}function ce(pe,me,be,Ne,De,Be){const Ze=pe+be>>1,Ye=me+Ne>>1;if(Math.abs(pe-De)+Math.abs(me-Be)>1&&to[Ye*Za+Ze])ce(De,Be,pe,me,Ze,Ye),ce(be,Ne,De,Be,Ze,Ye);else{const Ue=de(pe,me),qe=de(be,Ne),Ge=de(De,Be);J.emplaceBack(Ue,qe,Ge)}}return ce(0,0,zo,zo,zo,0),ce(zo,zo,0,0,0,zo),{vertices:ne,indices:J}})(this.tileID.canonical,d);S=P.vertices,A=P.indices}else{S=new s.aZ,A=new s.a_;for(const{x:O,y:I}of v)S.emplaceBack(O,I,0,0);const P=s.be(S.int16.subarray(0,4*S.length),void 0,4);for(let O=0;O<P.length;O+=3)A.emplaceBack(P[O],P[O+1],P[O+2])}this._tileBoundsBuffer=a.createVertexBuffer(S,s.bf.members),this._tileBoundsIndexBuffer=a.createIndexBuffer(A),this._tileBoundsSegments=s.bd.simpleSegment(0,0,S.length,A.length)}_makeGlobeTileDebugBuffers(a,d){const v=d.projection;if(!v||v.name!=="globe"||d.freezeTileCoverage)return;const S=this.tileID.canonical,A=s.bg(S,d),P=s.bh(A),O=s.ah(d.zoom);let I;O>0&&(I=s.bi(new Float64Array(16),d.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(a,S,d,P,I,O),this._makeGlobeTileDebugTextBuffer(a,S,d,P,I,O)}_globePoint(a,d,v,S,A,P,O){let I=s.bj(a,d,v);if(P){const H=1<<v.z,G=s.aD(S.center.lng),ne=s.aH(S.center.lat),J=(v.x+.5)/H-G;let re=0;J>.5?re=-1:J<-.5&&(re=1);let de=(a/s.aj+v.x)/H+re,ce=(d/s.aj+v.y)/H;de=(de-G)*S._pixelsPerMercatorPixel+G,ce=(ce-ne)*S._pixelsPerMercatorPixel+ne;const pe=[de*S.worldSize,ce*S.worldSize,0];s.ad(pe,pe,P),I=s.bk(I,pe,O)}return s.ad(I,I,A)}_makeGlobeTileDebugBorderBuffer(a,d,v,S,A,P){const O=new s.ba,I=new s.bb,H=new s.bl,G=(J,re,de,ce,pe)=>{const me=(de-J)/(pe-1),be=(ce-re)/(pe-1),Ne=O.length;for(let De=0;De<pe;De++){const Be=J+De*me,Ze=re+De*be;O.emplaceBack(Be,Ze);const Ye=this._globePoint(Be,Ze,d,v,S,A,P);H.emplaceBack(Ye[0],Ye[1],Ye[2]),I.emplaceBack(Ne+De)}},ne=s.aj;G(0,0,ne,0,16),G(ne,0,ne,ne,16),G(ne,ne,0,ne,16),G(0,ne,0,0,16),this._tileDebugIndexBuffer=a.createIndexBuffer(I),this._tileDebugBuffer=a.createVertexBuffer(O,s.bc.members),this._globeTileDebugBorderBuffer=a.createVertexBuffer(H,s.bm.members),this._tileDebugSegments=s.bd.simpleSegment(0,0,O.length,I.length)}_makeGlobeTileDebugTextBuffer(a,d,v,S,A,P){const O=s.aj/4,I=new s.ba,H=new s.a_,G=new s.bl,ne=25;H.reserve(32),I.reserve(ne),G.reserve(ne);const J=(re,de)=>ne*re+de;for(let re=0;re<ne;re++){const de=re*O;for(let ce=0;ce<ne;ce++){const pe=ce*O;I.emplaceBack(pe,de);const me=this._globePoint(pe,de,d,v,S,A,P);G.emplaceBack(me[0],me[1],me[2])}}for(let re=0;re<4;re++)for(let de=0;de<4;de++){const ce=J(re,de),pe=J(re,de+1),me=J(re+1,de),be=J(re+1,de+1);H.emplaceBack(ce,pe,me),H.emplaceBack(me,pe,be)}this._tileDebugTextIndexBuffer=a.createIndexBuffer(H),this._tileDebugTextBuffer=a.createVertexBuffer(I,s.bc.members),this._globeTileDebugTextBuffer=a.createVertexBuffer(G,s.bm.members),this._tileDebugTextSegments=s.bd.simpleSegment(0,0,ne,32)}destroy(a=!1){for(const d in this.buckets)this.buckets[d].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!a&&this.texture&&this.texture instanceof s.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}s.bp.setPbf(s.bq);class nl extends Va{constructor(a,d,v,S,A){super(a,d,v,S,A),this._workQueuePerLayer=new Map,this._fetchQueuePerLayer=new Map,this._isHeaderLoaded=!1,this.textureDescriptorPerLayer=new Map,this.texturePerLayer=new Map}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(a){return this._mrt&&this._mrt.getLayer(a)}setTexturePerLayer(a,d,v){const S=v.context,A=S.gl;let P=this.texturePerLayer.get(a)||v.getTileTexture(d.width);P&&P instanceof s.T?P.update(d,{premultiply:!1}):P=new s.T(S,d,A.RGBA8,{premultiply:!1}),this.texturePerLayer.has(a)||this.texturePerLayer.set(a,P)}flushQueues(a){const d=this._workQueuePerLayer.get(a)||[],v=this._fetchQueuePerLayer.get(a)||[];for(;d.length;)d.pop()();for(;v.length;)v.pop()()}flushAllQueues(){for(const a of this._workQueuePerLayer.keys()){const d=this._workQueuePerLayer.get(a)||[];for(;d.length;)d.pop()()}for(const a of this._fetchQueuePerLayer.keys()){const d=this._fetchQueuePerLayer.get(a)||[];for(;d.length;)d.pop()()}}fetchHeader(a=16384,d){const v=this._mrt=new s.bp(30),S=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(a-1)}});return this.entireBuffer=null,this.request=s.br(S,((A,P,O,I)=>{if(A)d(A);else try{const H=v.getHeaderLength(P);if(H>a)return void(this.request=this.fetchHeader(H,d));v.parseHeader(P),this._isHeaderLoaded=!0;let G=0;for(const ne of Object.values(v.layers))G=Math.max(G,ne.dataIndex[ne.dataIndex.length-1].lastByte);P.byteLength>=G&&(this.entireBuffer=P),d(null,this.entireBuffer||P,O,I)}catch(H){d(H)}})),this.request}fetchBand(a,d,v,S){const A=this._mrt;if(!this._isHeaderLoaded||!A)return void S(new Error("Tile header is not ready"));const P=this.actor;if(!P)return void S(new Error("Can't fetch tile band without an actor"));let O;const I=(J,re)=>{if(O.complete(J,re),J)return void S(J);this.updateTextureDescriptor(a,d,v);const de=this.textureDescriptorPerLayer.get(d);S(null,de&&de.img)},H=(J,re)=>{if(J)return S(J);const de=P.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:re,task:O},I,void 0,!0),ce=this._workQueuePerLayer.get(d)||[];ce.push((()=>{de&&de.cancel(),O.cancel()})),this._workQueuePerLayer.has(d)||this._workQueuePerLayer.set(d,ce)},G=A.getLayer(a);if(!G)return void S(new Error(`Unknown sourceLayer "${a}"`));if(G.hasDataForBand(v)){this.updateTextureDescriptor(a,d,v);const J=this.textureDescriptorPerLayer.get(d);return void S(null,J?J.img:null)}const ne=G.getDataRange([v]);if(O=A.createDecodingTask(ne),!O||O.tasks.length)if(this.flushQueues(d),this.entireBuffer)H(null,this.entireBuffer.slice(ne.firstByte,ne.lastByte+1));else{const J=Object.assign({},this.requestParams,{headers:{Range:`bytes=${ne.firstByte}-${ne.lastByte}`}}),re=s.br(J,H),de=this._fetchQueuePerLayer.get(d)||[];de.push((()=>{re.cancel(),O.cancel()})),this._fetchQueuePerLayer.has(d)||this._fetchQueuePerLayer.set(d,de)}else S(null)}updateNeeded(a,d){return(!this.textureDescriptorPerLayer.get(a)||this.textureDescriptorPerLayer.get(a).band!==d)&&this.state!=="errored"}updateTextureDescriptor(a,d,v){if(!this._mrt)return;const S=this._mrt.getLayer(a);if(!S||!S.hasBand(v)||!S.hasDataForBand(v))return;const{bytes:A,tileSize:P,buffer:O,offset:I,scale:H}=S.getBandView(v),G=P+2*O,ne=new s.r({width:G,height:G},A),J=this.texturePerLayer.get(d);J&&J instanceof s.T&&J.update(ne,{premultiply:!1}),this.textureDescriptorPerLayer.set(d,{layer:a,band:v,img:ne,buffer:O,offset:I,tileSize:P,format:S.pixelFormat,mix:[H,256*H,65536*H,16777216*H]})}destroy(a=!1){if(super.destroy(a),delete this._mrt,!a)for(const d of this.texturePerLayer.values())d&&d instanceof s.T&&d.destroy();this.texturePerLayer.clear(),this.textureDescriptorPerLayer.clear(),this.fbo&&(this.fbo.destroy(),delete this.fbo),delete this.request,delete this.requestParams,this._isHeaderLoaded=!1}}class ad{constructor(a,d){this.max=a,this.onRemove=d,this.reset()}reset(){for(const a in this.data)for(const d of this.data[a])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(a,d,v){const S=a.wrapped().key;this.data[S]===void 0&&(this.data[S]=[]);const A={value:d,timeout:void 0};if(v!==void 0&&(A.timeout=setTimeout((()=>{this.remove(a,A)}),v)),this.data[S].push(A),this.order.push(S),this.order.length>this.max){const P=this._getAndRemoveByKey(this.order[0]);P&&this.onRemove(P)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const d=this.data[a].shift();return d.timeout&&clearTimeout(d.timeout),this.data[a].length===0&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),d.value}getByKey(a){const d=this.data[a];return d?d[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,d){if(!this.has(a))return this;const v=a.wrapped().key,S=d===void 0?0:this.data[v].indexOf(d),A=this.data[v][S];return this.data[v].splice(S,1),A.timeout&&clearTimeout(A.timeout),this.data[v].length===0&&delete this.data[v],this.onRemove(A.value),this.order.splice(this.order.indexOf(v),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(a){const d=[];for(const v in this.data)for(const S of this.data[v])a(S.value)||d.push(S);for(const v of d)this.remove(v.value.tileID,v)}}class wo{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,d,v){const S=String(d);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][S]=this.stateChanges[a][S]||{},s.h(this.stateChanges[a][S],v),this.deletedStates[a]===null){this.deletedStates[a]={};for(const A in this.state[a])A!==S&&(this.deletedStates[a][A]=null)}else if(this.deletedStates[a]&&this.deletedStates[a][S]===null){this.deletedStates[a][S]={};for(const A in this.state[a][S])v[A]||(this.deletedStates[a][S][A]=null)}else for(const A in v)this.deletedStates[a]&&this.deletedStates[a][S]&&this.deletedStates[a][S][A]===null&&delete this.deletedStates[a][S][A]}removeFeatureState(a,d,v){if(this.deletedStates[a]===null)return;const S=String(d);if(this.deletedStates[a]=this.deletedStates[a]||{},v&&d!==void 0)this.deletedStates[a][S]!==null&&(this.deletedStates[a][S]=this.deletedStates[a][S]||{},this.deletedStates[a][S][v]=null);else if(d!==void 0)if(this.stateChanges[a]&&this.stateChanges[a][S])for(v in this.deletedStates[a][S]={},this.stateChanges[a][S])this.deletedStates[a][S][v]=null;else this.deletedStates[a][S]=null;else this.deletedStates[a]=null}getState(a,d){const v=this.state[a]||{},S=this.stateChanges[a]||{},A=this.deletedStates[a];if(A===null)return{};if(d!==void 0){const O=String(d),I=s.h({},v[O],S[O]);if(A){const H=A[d];if(H===null)return{};for(const G in H)delete I[G]}return I}const P=s.h({},v,S);if(A)for(const O in A)delete P[O];return P}initializeTileState(a,d){a.refreshFeatureState(d)}coalesceChanges(a,d){const v={};for(const S in this.stateChanges){this.state[S]=this.state[S]||{};const A={};for(const P in this.stateChanges[S])this.state[S][P]||(this.state[S][P]={}),s.h(this.state[S][P],this.stateChanges[S][P]),A[P]=this.state[S][P];v[S]=A}for(const S in this.deletedStates){this.state[S]=this.state[S]||{};const A={};if(this.deletedStates[S]===null)for(const P in this.state[S])A[P]={},this.state[S][P]={};else for(const P in this.deletedStates[S]){if(this.deletedStates[S][P]===null)this.state[S][P]={};else if(this.state[S][P])for(const O of Object.keys(this.deletedStates[S][P]))delete this.state[S][P][O];A[P]=this.state[S][P]}v[S]=v[S]||{},s.h(v[S],A)}if(this.stateChanges={},this.deletedStates={},Object.keys(v).length!==0)for(const S in a)a[S].refreshFeatureState(d)}}class $a extends s.E{constructor(a,d,v){super(),this.id=a,this._onlySymbols=v,d.on("data",(S=>{S.dataType==="source"&&S.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))})),d.on("error",(()=>{this._sourceErrored=!0})),this._source=d,this._tiles={},this._cache=new ad(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new wo,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(a){this.map=a,this._minTileCacheSize=this._minTileCacheSize===void 0&&a?a._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&a?a._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const a in this._tiles)if(!this._tiles[a].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(a,d){return a.isSymbolTile=this._onlySymbols,a.isExtraShadowCaster=this._shadowCasterTiles[a.tileID.key],this._source.loadTile(a,d)}_unloadTile(a){if(this._source.unloadTile)return this._source.unloadTile(a)}_abortTile(a){if(this._source.abortTile)return this._source.abortTile(a)}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const v=this._tiles[d];v.upload(a),v.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map((a=>a.tileID)).sort(rl).map((a=>a.key))}getRenderableIds(a,d){const v=[];for(const S in this._tiles)this._isIdRenderable(+S,a,d)&&v.push(this._tiles[S]);return a?v.sort(((S,A)=>{const P=S.tileID,O=A.tileID,I=new s.P(P.canonical.x,P.canonical.y)._rotate(this.transform.angle),H=new s.P(O.canonical.x,O.canonical.y)._rotate(this.transform.angle);return P.overscaledZ-O.overscaledZ||H.y-I.y||H.x-I.x})).map((S=>S.tileID.key)):v.map((S=>S.tileID)).sort(rl).map((S=>S.key))}hasRenderableParent(a){const d=this.findLoadedParent(a,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(a,d,v){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(d||!this._tiles[a].holdingForFade())&&(v||!this._shadowCasterTiles[a])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)this._tiles[a].state!=="errored"&&this._reloadTile(+a,"reloading")}}_reloadTile(a,d){const v=this._tiles[a];v&&(v.state!=="loading"&&(v.state=d),this._loadTile(v,this._tileLoaded.bind(this,v,a,d)))}_tileLoaded(a,d,v,S){if(S)if(a.state="errored",S.status!==404)this._source.fire(new s.z(S,{tile:a}));else{if(this._source.fire(new s.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:a})),!(a.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const A=this.map.painter.terrain;this.update(this.transform,A.getScaledDemTileSize(),!0),A.resetTileLookupCache(this.id)}else this.update(this.transform)}else a.timeAdded=s.q.now(),v==="expired"&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(d,a),this._source.type==="raster-dem"&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),this._source.fire(new s.A("data",{dataType:"source",tile:a,coord:a.tileID,sourceCacheId:this.id}))}_backfillDEM(a){const d=this.getRenderableIds();for(let S=0;S<d.length;S++){const A=d[S];if(a.neighboringTiles&&a.neighboringTiles[A]){const P=this.getTileByID(A);v(a,P),v(P,a)}}function v(S,A){if(!S.dem||S.dem.borderReady)return;S.needsHillshadePrepare=!0,S.needsDEMTextureUpload=!0;let P=A.tileID.canonical.x-S.tileID.canonical.x;const O=A.tileID.canonical.y-S.tileID.canonical.y,I=Math.pow(2,S.tileID.canonical.z),H=A.tileID.key;P===0&&O===0||Math.abs(O)>1||(Math.abs(P)>1&&(Math.abs(P+I)===1?P+=I:Math.abs(P-I)===1&&(P-=I)),A.dem&&S.dem&&(S.dem.backfillBorder(A.dem,P,O),S.neighboringTiles&&S.neighboringTiles[H]&&(S.neighboringTiles[H].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,d,v,S){for(const A in this._tiles){let P=this._tiles[A];if(S[A]||!P.hasData()||P.tileID.overscaledZ<=d||P.tileID.overscaledZ>v)continue;let O=P.tileID;for(;P&&P.tileID.overscaledZ>d+1;){const H=P.tileID.scaledTo(P.tileID.overscaledZ-1);P=this._tiles[H.key],P&&P.hasData()&&(O=H)}let I=O;for(;I.overscaledZ>d;)if(I=I.scaledTo(I.overscaledZ-1),a[I.key]){S[O.key]=O;break}}}findLoadedParent(a,d){if(a.key in this._loadedParentTiles){const v=this._loadedParentTiles[a.key];return v&&v.tileID.overscaledZ>=d?v:null}for(let v=a.overscaledZ-1;v>=d;v--){const S=a.scaledTo(v),A=this._getLoadedTile(S);if(A)return A}}_getLoadedTile(a){const d=this._tiles[a.key];return d&&d.hasData()?d:this._cache.getByKey(this._source.reparseOverscaled?a.wrapped().key:a.canonical.key)}updateCacheSize(a,d){d=d||this._source.tileSize;const v=Math.ceil(a.width/d)+1,S=Math.ceil(a.height/d)+1,A=Math.floor(v*S*5),P=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,A):A,O=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,P):P;this._cache.setMaxSize(O)}handleWrapJump(a){const d=Math.round((a-(this._prevLng===void 0?a:this._prevLng))/360);if(this._prevLng=a,d){const v={};for(const S in this._tiles){const A=this._tiles[S];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+d),v[A.tileID.key]=A}this._tiles=v;for(const S in this._timers)clearTimeout(this._timers[S]),delete this._timers[S];for(const S in this._tiles)this._setTileReloadTimer(+S,this._tiles[S])}}update(a,d,v,S,A){if(this.transform=a,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!v)return;this.updateCacheSize(a,d),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const P=this._source.type==="batched-model";let O,I=this._source.maxzoom;const H=this.map&&this.map.painter?this.map.painter._terrain:null;if(H&&H.sourceCache===this&&H.attenuationRange()){const J=H.attenuationRange()[0],re=Math.floor(J)-Math.log2(H.getDemUpscale());I>re&&(I=re)}if(this.used||this.usedForTerrain){if(this._source.tileID)O=a.getVisibleUnwrappedCoordinates(this._source.tileID).map((J=>new s.aM(J.canonical.z,J.wrap,J.canonical.z,J.canonical.x,J.canonical.y)));else if(this.tileCoverLift!==0){const J=a.clone();J.tileCoverLift=this.tileCoverLift,O=J.coveringTiles({tileSize:d||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:I,roundZoom:this._source.roundZoom&&!v,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:P}),this._source.minzoom<=1&&a.projection.name==="globe"&&(O.push(new s.aM(1,0,1,0,0)),O.push(new s.aM(1,0,1,1,0)),O.push(new s.aM(1,0,1,0,1)),O.push(new s.aM(1,0,1,1,1)))}else if(O=a.coveringTiles({tileSize:d||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:I,roundZoom:this._source.roundZoom&&!v,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:P}),this._source.hasTile){const J=this._source.hasTile.bind(this._source);O=O.filter((re=>J(re)))}}else O=[];if(O.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Ql(this._source.type)){const J=a.coveringZoomLevel({tileSize:d||this._source.tileSize,roundZoom:this._source.roundZoom&&!v}),re=Math.min(J,this._source.maxzoom);if(P){const de=a.extendTileCover(O,re);for(const ce of de)O.push(ce)}else if(A){const de=a.extendTileCoverToNearPlane(O,this.transform.getFrustum(re),re);for(const ce of de)O.push(ce)}else if(this.castsShadows&&S){const de=a.extendTileCover(O,re,S);for(const ce of de)this._shadowCasterTiles[ce.key]=!0,O.push(ce)}}const G=this._updateRetainedTiles(O);if(Ql(this._source.type)&&O.length!==0){const J={},re={},de=Object.keys(G);for(const pe of de){const me=G[pe],be=this._tiles[pe];if(!be||be.fadeEndTime&&be.fadeEndTime<=s.q.now())continue;const Ne=this.findLoadedParent(me,Math.max(me.overscaledZ-$a.maxOverzooming,this._source.minzoom));Ne&&(this._addTile(Ne.tileID),J[Ne.tileID.key]=Ne.tileID),re[pe]=me}const ce=O[O.length-1].overscaledZ;for(const pe in this._tiles){const me=this._tiles[pe];if(G[pe]||!me.hasData())continue;let be=me.tileID;for(;be.overscaledZ>ce;){be=be.scaledTo(be.overscaledZ-1);const Ne=this._tiles[be.key];if(Ne&&Ne.hasData()&&re[be.key]){G[pe]=me.tileID;break}}}for(const pe in J)G[pe]||(this._coveredTiles[pe]=!0,G[pe]=J[pe])}for(const J in G)this._tiles[J].clearFadeHold();const ne=s.bs(this._tiles,G);for(const J of ne){const re=this._tiles[J];re.hasSymbolBuckets&&!re.holdingForFade()?re.setHoldDuration(this.map._fadeDuration):re.hasSymbolBuckets&&!re.symbolFadeFinished()||this._removeTile(+J)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(+a)}_updateRetainedTiles(a){const d={};if(a.length===0)return d;const v={},S=a.reduce(((H,G)=>Math.min(H,G.overscaledZ)),1/0),A=a[0].overscaledZ,P=Math.max(A-$a.maxOverzooming,this._source.minzoom),O=Math.max(A+$a.maxUnderzooming,this._source.minzoom),I={};for(const H of a){const G=this._addTile(H);d[H.key]=H,G.hasData()||S<this._source.maxzoom&&(I[H.key]=H)}this._retainLoadedChildren(I,S,O,d);for(const H of a){let G=this._tiles[H.key];if(G.hasData())continue;if(H.canonical.z>=this._source.maxzoom){const J=H.children(this._source.maxzoom)[0],re=this.getTile(J);if(re&&re.hasData()){d[J.key]=J;continue}}else{const J=H.children(this._source.maxzoom);if(d[J[0].key]&&d[J[1].key]&&d[J[2].key]&&d[J[3].key])continue}let ne=G.wasRequested();for(let J=H.overscaledZ-1;J>=P;--J){const re=H.scaledTo(J);if(v[re.key]||(v[re.key]=!0,G=this.getTile(re),!G&&ne&&(G=this._addTile(re)),G&&(d[re.key]=re,ne=G.wasRequested(),G.hasData())))break}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const a in this._tiles){const d=[];let v,S=this._tiles[a].tileID;for(;S.overscaledZ>0;){if(S.key in this._loadedParentTiles){v=this._loadedParentTiles[S.key];break}d.push(S.key);const A=S.scaledTo(S.overscaledZ-1);if(v=this._getLoadedTile(A),v)break;S=A}for(const A of d)this._loadedParentTiles[A]=v}}_addTile(a){let d=this._tiles[a.key];if(d)return d.isExtraShadowCaster!==!0||this._shadowCasterTiles[a.key]||this._reloadTile(a.key,"reloading"),d;d=this._cache.getAndRemove(a),d&&(this._setTileReloadTimer(a.key,d),d.tileID=a,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,d)));const v=!!d;if(!v){const S=this.map?this.map.painter:null,A=this._source.tileSize*a.overscaleFactor();d=this._source.type==="raster-array"?new nl(a,A,this.transform.tileZoom,S,this._isRaster):new Va(a,A,this.transform.tileZoom,S,this._isRaster,this._source.worldview),this._loadTile(d,this._tileLoaded.bind(this,d,a.key,d.state))}return d.uses++,this._tiles[a.key]=d,v||this._source.fire(new s.A("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(a,d){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);const v=d.getExpiryTimeout();v&&(this._timers[a]=setTimeout((()=>{this._reloadTile(a,"expired"),delete this._timers[a]}),v))}_removeTile(a){const d=this._tiles[a];d&&(d.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),d.uses>0||(d.hasData()&&d.state!=="reloading"||d.state==="empty"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const a in this._tiles)this._removeTile(+a);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(a,d,v){const S=[],A=this.transform;if(!A)return S;const P=A.projection.name==="globe",O=s.aD(A.center.lng);for(const I in this._tiles){const H=this._tiles[I];if(v&&H.clearQueryDebugViz(),H.holdingForFade())continue;let G;if(P){const ne=H.tileID.canonical;if(ne.z===0){const J=[Math.abs(s.ay(O,...gl(ne,-1))-O),Math.abs(s.ay(O,...gl(ne,1))-O)];G=[0,2*J.indexOf(Math.min(...J))-1]}else{const J=[Math.abs(s.ay(O,...gl(ne,-1))-O),Math.abs(s.ay(O,...gl(ne,0))-O),Math.abs(s.ay(O,...gl(ne,1))-O)];G=[J.indexOf(Math.min(...J))-1]}}else G=[0];for(const ne of G){const J=a.containsTile(H,A,d,ne);J&&S.push(J)}}return S}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(a){return this._getRenderableCoordinates(a)}_getRenderableCoordinates(a,d){const v=this.getRenderableIds(a,d).map((A=>this._tiles[A].tileID)),S=this.transform.projection.name==="globe";for(const A of v)A.projMatrix=this.transform.calculateProjMatrix(A.toUnwrapped()),A.expandedProjMatrix=S?this.transform.calculateProjMatrix(A.toUnwrapped(),!1,!0):A.projMatrix;return v}sortCoordinatesByDistance(a){const d=a.slice(),v=this.transform._camera.position,S=this.transform._camera.forward(),A={};for(const P of d){const O=1/(1<<P.canonical.z);A[P.key]=((P.canonical.x+.5)*O+P.wrap-v[0])*S[0]+((P.canonical.y+.5)*O-v[1])*S[1]-v[2]*S[2]}return d.sort(((P,O)=>A[P.key]-A[O.key])),d}hasTransition(){if(this._source.hasTransition())return!0;if(Ql(this._source.type))for(const a in this._tiles){const d=this._tiles[a];if(d.fadeEndTime!==void 0&&d.fadeEndTime>=s.q.now())return!0}return!1}setFeatureState(a,d,v){this._state.updateState(a=a||"_geojsonTileLayer",d,v)}removeFeatureState(a,d,v){this._state.removeFeatureState(a=a||"_geojsonTileLayer",d,v)}getFeatureState(a,d){return this._state.getState(a=a||"_geojsonTileLayer",d)}setDependencies(a,d,v){const S=this._tiles[a];S&&S.setDependencies(d,v)}reloadTilesForDependencies(a,d){for(const v in this._tiles)this._tiles[v].hasDependency(a,d)&&this._reloadTile(+v,"reloading");this._cache.filter((v=>!v.hasDependency(a,d)))}_preloadTiles(a,d){if(!this._sourceLoaded){const I=()=>{this._sourceLoaded&&(this._source.off("data",I),this._preloadTiles(a,d))};return void this._source.on("data",I)}const v=new Map,S=Array.isArray(a)?a:[a],A=this.map.painter.terrain,P=this.usedForTerrain&&A?A.getScaledDemTileSize():this._source.tileSize;for(const I of S){const H=I.coveringTiles({tileSize:P,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const G of H)v.set(G.key,G);this.usedForTerrain&&I.updateElevation(!1)}const O=Array.from(v.values());s.bt(O,((I,H)=>{const G=new Va(I,this._source.tileSize*I.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster,this._source.worldview);this._loadTile(G,(ne=>{this._source.type==="raster-dem"&&G.dem&&this._backfillDEM(G),H(ne,G)}))}),d)}}function rl(y,a){const d=Math.abs(2*y.wrap)-+(y.wrap<0),v=Math.abs(2*a.wrap)-+(a.wrap<0);return y.overscaledZ-a.overscaledZ||v-d||a.canonical.y-y.canonical.y||a.canonical.x-y.canonical.x}function Ql(y){return y==="raster"||y==="image"||y==="video"||y==="custom"}function gl(y,a){const d=1<<y.z;return[y.x/d+a,(y.x+1)/d+a]}$a.maxOverzooming=10,$a.maxUnderzooming=3;class qh{constructor(a){this.style=a,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const a=!1,d=!1;for(const v in this.style._mergedLayers){const S=this.style._mergedLayers[v];if(S.type==="fill-extrusion"||S.type==="building")this.layers.push({layer:S,visible:a,visibilityChanged:d});else if(S.type==="model"){const A=this.style.getLayerSource(S);A&&A.type==="batched-model"&&this.layers.push({layer:S,visible:a,visibilityChanged:d})}}}onNewFrame(a){this.layersGotHidden=!1;for(const d of this.layers){const v=d.layer;let S=!1;v.type==="fill-extrusion"?S=!v.isHidden(a)&&v.paint.get("fill-extrusion-opacity")>0:v.type==="building"?S=!v.isHidden(a)&&v.paint.get("building-opacity")>0:v.type==="model"&&(S=!v.isHidden(a)&&v.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!S&&d.visible,d.visible=S}}updateZOffset(a,d){this.currentBuildingBuckets=[];for(const S of this.layers){const A=S.layer,P=this.style.getLayerSourceCache(A);let O=1;A.type==="fill-extrusion"?O=S.visible?A.paint.get("fill-extrusion-vertical-scale"):0:A.type==="building"&&(O=S.visible?A.paint.get("building-vertical-scale"):0);let I=P?P.getTile(d):null;if(!I&&P)for(const H in P._tiles){const G=P._tiles[H];if(d.canonical.isChildOf(G.tileID.canonical)){I=G;break}}this.currentBuildingBuckets.push({bucket:I?I.getBucket(A):null,tileID:I?I.tileID:d,verticalScale:O})}a.hasAnyZOffset=!1;let v=!1;for(let S=0;S<a.symbolInstances.length;S++){const A=a.symbolInstances.get(S),P=A.zOffset,O=this._getHeightAtTileOffset(d,A.tileAnchorX,A.tileAnchorY);A.zOffset=O!==Number.NEGATIVE_INFINITY?O:P,v||P===A.zOffset||(v=!0),a.hasAnyZOffset||A.zOffset===0||(a.hasAnyZOffset=!0)}v&&(a.zOffsetBuffersNeedUpload=!0,a.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(a,d,v,S){let A=d,P=v;if(a.canonical.z!==S.canonical.z){const O=S.canonical,I=1/(1<<a.canonical.z-O.z);A=(d+a.canonical.x*s.aj)*I-O.x*s.aj|0,P=(v+a.canonical.y*s.aj)*I-O.y*s.aj|0}return{tileX:A,tileY:P}}_getHeightAtTileOffset(a,d,v){let S,A;for(let P=0;P<this.layers.length;++P){const O=this.layers[P].layer;if(O.type!=="fill-extrusion"&&O.type!=="building")continue;const{bucket:I,tileID:H,verticalScale:G}=this.currentBuildingBuckets[P];if(!I)continue;const{tileX:ne,tileY:J}=this._mapCoordToOverlappingTile(a,d,v,H),re=I.getHeightAtTileCoord(ne,J);re&&re.height!==void 0&&(re.hidden?S=re.height:A=Math.max(re.height*G,A||0))}if(A!==void 0)return A;for(let P=0;P<this.layers.length;++P){const O=this.layers[P];if(O.layer.type!=="model"||!O.visible)continue;const{bucket:I,tileID:H}=this.currentBuildingBuckets[P];if(!I)continue;const{tileX:G,tileY:ne}=this._mapCoordToOverlappingTile(a,d,v,H),J=I.getHeightAtTileCoord(G,ne);if(J&&!J.hidden)return J.height===void 0&&S!==void 0?Math.min(J.maxHeight,S)*J.verticalScale:J.height?J.height*J.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Kd(y,a){const d={};for(const v in y)v!=="ref"&&(d[v]=y[v]);return s.bu.forEach((v=>{v in a&&(d[v]=a[v])})),d}function Mu(y){y=y.slice();const a=Object.create(null);for(let d=0;d<y.length;d++)a[y[d].id]=y[d];for(let d=0;d<y.length;d++)"ref"in y[d]&&(y[d]=Kd(y[d],a[y[d].ref]));return y}const bi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function yl(y,a,d){d.push({command:bi.addSource,args:[y,a[y]]})}function mc(y,a,d){a.push({command:bi.removeSource,args:[y]}),d[y]=!0}function gc(y,a,d,v){mc(y,d,v),yl(y,a,d)}function je(y,a,d){let v;for(v in y[d])if(y[d].hasOwnProperty(v)&&v!=="data"&&!s.bv(y[d][v],a[d][v]))return!1;for(v in a[d])if(a[d].hasOwnProperty(v)&&v!=="data"&&!s.bv(y[d][v],a[d][v]))return!1;return!0}function ot(y,a,d,v,S,A){let P;for(P in a=a||{},y=y||{})y.hasOwnProperty(P)&&(s.bv(y[P],a[P])||d.push({command:A,args:[v,P,a[P],S]}));for(P in a)a.hasOwnProperty(P)&&!y.hasOwnProperty(P)&&(s.bv(y[P],a[P])||d.push({command:A,args:[v,P,a[P],S]}))}function vn(y){return y.id}function Sr(y,a){return y[a.id]=a,y}function gr(y,a,d){const v=a.createTileMatrix(y,y.worldSize,d.toUnwrapped());return s.az(new Float32Array(16),y.projMatrix,v)}function Zn(y,a,d){if(a.projection.name===d.projection.name)return y.projMatrix;const v=d.clone();return v.setProjection(a.projection),gr(v,a.getProjection(),y)}function Mo(y,a,d){return a.name===d.projection.name?y.projMatrix:gr(d,a,y)}class ua{constructor(a,d){this.reset(a,d)}reset(a,d){this.points=a||[],this._distances=[0];for(let v=1;v<this.points.length;v++)this._distances[v]=this._distances[v-1]+this.points[v].dist(this.points[v-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(a){if(this.points.length===1)return this.points[0];a=s.ay(a,0,1);let d=1,v=this._distances[d];const S=a*this.paddedLength+this.padding;for(;v<S&&d<this._distances.length;)v=this._distances[++d];const A=d-1,P=this._distances[A],O=v-P,I=O>0?(S-P)/O:0;return this.points[A].mult(1-I).add(this.points[d].mult(I))}}class no{constructor(a,d,v){const S=this.boxCells=[],A=this.circleCells=[];this.xCellCount=Math.ceil(a/v),this.yCellCount=Math.ceil(d/v);for(let P=0;P<this.xCellCount*this.yCellCount;P++)S.push([]),A.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=d,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(a,d,v,S,A){this._forEachCell(d,v,S,A,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(d),this.bboxes.push(v),this.bboxes.push(S),this.bboxes.push(A)}insertCircle(a,d,v,S){this._forEachCell(d-S,v-S,d+S,v+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(d),this.circles.push(v),this.circles.push(S)}_insertBoxCell(a,d,v,S,A,P){this.boxCells[A].push(P)}_insertCircleCell(a,d,v,S,A,P){this.circleCells[A].push(P)}_query(a,d,v,S,A,P){if(v<0||a>this.width||S<0||d>this.height)return!A&&[];const O=[];if(a<=0&&d<=0&&this.width<=v&&this.height<=S){if(A)return!0;for(let I=0;I<this.boxKeys.length;I++)O.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(let I=0;I<this.circleKeys.length;I++){const H=this.circles[3*I],G=this.circles[3*I+1],ne=this.circles[3*I+2];O.push({key:this.circleKeys[I],x1:H-ne,y1:G-ne,x2:H+ne,y2:G+ne})}return P?O.filter(P):O}return this._forEachCell(a,d,v,S,this._queryCell,O,{hitTest:A,seenUids:{box:{},circle:{}}},P),A?O.length>0:O}_queryCircle(a,d,v,S,A){const P=a-v,O=a+v,I=d-v,H=d+v;if(O<0||P>this.width||H<0||I>this.height)return!S&&[];const G=[];return this._forEachCell(P,I,O,H,this._queryCellCircle,G,{hitTest:S,circle:{x:a,y:d,radius:v},seenUids:{box:{},circle:{}}},A),S?G.length>0:G}query(a,d,v,S,A){return this._query(a,d,v,S,!1,A)}hitTest(a,d,v,S,A){return this._query(a,d,v,S,!0,A)}hitTestCircle(a,d,v,S){return this._queryCircle(a,d,v,!0,S)}_queryCell(a,d,v,S,A,P,O,I){const H=O.seenUids,G=this.boxCells[A];if(G!==null){const J=this.bboxes;for(const re of G)if(!H.box[re]){H.box[re]=!0;const de=4*re;if(a<=J[de+2]&&d<=J[de+3]&&v>=J[de+0]&&S>=J[de+1]&&(!I||I(this.boxKeys[re]))){if(O.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[re],x1:J[de],y1:J[de+1],x2:J[de+2],y2:J[de+3]})}}}const ne=this.circleCells[A];if(ne!==null){const J=this.circles;for(const re of ne)if(!H.circle[re]){H.circle[re]=!0;const de=3*re;if(this._circleAndRectCollide(J[de],J[de+1],J[de+2],a,d,v,S)&&(!I||I(this.circleKeys[re]))){if(O.hitTest)return P.push(!0),!0;{const ce=J[de],pe=J[de+1],me=J[de+2];P.push({key:this.circleKeys[re],x1:ce-me,y1:pe-me,x2:ce+me,y2:pe+me})}}}}}_queryCellCircle(a,d,v,S,A,P,O,I){const H=O.circle,G=O.seenUids,ne=this.boxCells[A];if(ne!==null){const re=this.bboxes;for(const de of ne)if(!G.box[de]){G.box[de]=!0;const ce=4*de;if(this._circleAndRectCollide(H.x,H.y,H.radius,re[ce+0],re[ce+1],re[ce+2],re[ce+3])&&(!I||I(this.boxKeys[de])))return P.push(!0),!0}}const J=this.circleCells[A];if(J!==null){const re=this.circles;for(const de of J)if(!G.circle[de]){G.circle[de]=!0;const ce=3*de;if(this._circlesCollide(re[ce],re[ce+1],re[ce+2],H.x,H.y,H.radius)&&(!I||I(this.circleKeys[de])))return P.push(!0),!0}}}_forEachCell(a,d,v,S,A,P,O,I){const H=this._convertToXCellCoord(a),G=this._convertToYCellCoord(d),ne=this._convertToXCellCoord(v),J=this._convertToYCellCoord(S);for(let re=H;re<=ne;re++)for(let de=G;de<=J;de++)if(A.call(this,a,d,v,S,this.xCellCount*de+re,P,O,I))return}_convertToXCellCoord(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}_convertToYCellCoord(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}_circlesCollide(a,d,v,S,A,P){const O=S-a,I=A-d,H=v+P;return H*H>O*O+I*I}_circleAndRectCollide(a,d,v,S,A,P,O){const I=(P-S)/2,H=Math.abs(a-(S+I));if(H>I+v)return!1;const G=(O-A)/2,ne=Math.abs(d-(A+G));if(ne>G+v)return!1;if(H<=I||ne<=G)return!0;const J=H-I,re=ne-G;return J*J+re*re<=v*v}}const La={unknown:0,flipRequired:1,flipNotRequired:2},ta=Math.tan(85*Math.PI/180);function Ta(y,a,d,v,S,A,P){const O=s.bz();if(d)if(A.name==="globe"){const I=s.bA(S,a);s.az(O,O,I)}else{const I=s.bB([],P);O[0]=I[0],O[1]=I[1],O[4]=I[2],O[5]=I[3],v||s.by(O,O,S.angle)}else s.az(O,S.labelPlaneMatrix,y);return O}function kl(y,a,d,v,S,A,P){const O=Ta(y,a,d,v,S,A,P);return A.name==="globe"&&d||(O[2]=O[6]=O[10]=O[14]=0),O}function yc(y,a,d,v,S,A,P){if(d){if(A.name==="globe"){const O=Ta(y,a,d,v,S,A,P);return s.bi(O,O),s.az(O,y,O),O}{const O=s.bw(y),I=s.bx([]);return I[0]=P[0],I[1]=P[1],I[4]=P[2],I[5]=P[3],s.az(O,O,I),v||s.by(O,O,-S.angle),O}}return S.glCoordMatrix}function Fo(y,a,d,v){const S=[y,a,d,1];d?s.aA(S,S,v):Ug(S,S,v);const A=S[3];return S[0]/=A,S[1]/=A,S[2]/=A,S}function Jd(y,a){return Math.min(.5+y/a*.5,1.5)}function fm(y,a){const d=y[0]/y[3],v=y[1]/y[3];return d>=-a[0]&&d<=a[0]&&v>=-a[1]&&v<=a[1]}function od(y,a,d,v,S,A,P,O,I,H){const G=d.transform,ne=v?y.textSizeData:y.iconSizeData,J=s.bH(ne,d.transform.zoom),re=G.projection.name==="globe",de=[256/d.width*2+1,256/d.height*2+1],ce=v?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;ce.clear();let pe=null;re&&(pe=v?y.text.globeExtVertexArray:y.icon.globeExtVertexArray);const me=y.lineVertexArray,be=v?y.text.placedSymbolArray:y.icon.placedSymbolArray,Ne=d.transform.width/d.transform.height;let De,Be=!1;for(let Ze=0;Ze<be.length;Ze++){const Ye=be.get(Ze),{numGlyphs:Ue,writingMode:qe}=Ye;if(qe!==s.bI.vertical||Be||De===s.bI.horizontal||(Be=!0),De=qe,(Ye.hidden||qe===s.bI.vertical)&&!Be){eh(Ue,ce);continue}Be=!1;const Ge=new s.P(Ye.tileAnchorX,Ye.tileAnchorY);let{x:_t,y:ct,z:Bt}=G.projection.projectTilePoint(Ge.x,Ge.y,H.canonical);if(I){const[Pn,Kn,In]=I(Ge);_t+=Pn,ct+=Kn,Bt+=In}const Ct=[_t,ct,Bt,1];if(s.aA(Ct,Ct,a),!fm(Ct,de)){eh(Ue,ce);continue}const Xt=Ct[3],gn=Jd(d.transform.getCameraToCenterDistance(G.projection),Xt),wt=s.bJ(ne,J,Ye),at=P?wt/gn:wt*gn,Dt=Fo(_t,ct,Bt,S);if(Dt[3]<=0){eh(Ue,ce);continue}let At={};const Gt=s.al(y.layers[0].layout.get("text-max-angle")),Yt=Math.cos(Gt),Ht=P?null:I,en=Qd(Ye,at,!1,O,a,S,A,y.glyphOffsetArray,me,ce,pe,Dt,Ge,At,Ne,Ht,G.projection,H,P,Yt);Be=en.useVertical,Ht&&en.needsFlipping&&(At={}),(en.notEnoughRoom||Be||en.needsFlipping&&Qd(Ye,at,!0,O,a,S,A,y.glyphOffsetArray,me,ce,pe,Dt,Ge,At,Ne,Ht,G.projection,H,P,Yt).notEnoughRoom)&&eh(Ue,ce)}v?(y.text.dynamicLayoutVertexBuffer.updateData(ce),pe&&y.text.globeExtVertexBuffer&&y.text.globeExtVertexBuffer.updateData(pe)):(y.icon.dynamicLayoutVertexBuffer.updateData(ce),pe&&y.icon.globeExtVertexBuffer&&y.icon.globeExtVertexBuffer.updateData(pe))}function vl(y,a,d,v,S,A,P,O,I,H,G,ne,J,re,de,ce,pe){const{lineStartIndex:me,glyphStartIndex:be,segment:Ne}=O,De=be+O.numGlyphs,Be=me+O.lineLength,Ze=a.getoffsetX(be),Ye=a.getoffsetX(De-1),Ue=Hh(y*Ze,d,v,S,A,P,Ne,me,Be,I,H,G,ne,J,!0,re,de,ce,pe);if(!Ue)return null;const qe=Hh(y*Ye,d,v,S,A,P,Ne,me,Be,I,H,G,ne,J,!0,re,de,ce,pe);return qe?{first:Ue,last:qe}:null}function Bg(y,a,d,v){return y===s.bI.horizontal&&Math.abs(v)>Math.abs(d)?{useVertical:!0}:y===s.bI.vertical?v>0?{needsFlipping:!0}:null:a!==La.unknown&&(function(S,A){return S===0||Math.abs(A/S)>ta})(d,v)?a===La.flipRequired?{needsFlipping:!0}:null:d<0?{needsFlipping:!0}:null}function Qd(y,a,d,v,S,A,P,O,I,H,G,ne,J,re,de,ce,pe,me,be,Ne){const De=a/24,Be=y.lineOffsetX*De,Ze=y.lineOffsetY*De,{lineStartIndex:Ye,glyphStartIndex:Ue,numGlyphs:qe,segment:Ge,writingMode:_t,flipState:ct}=y,Bt=Ye+y.lineLength,Ct=Xt=>{if(G){const[Dt,At,Gt]=Xt.up,Yt=H.length;s.bK(G,Yt+0,Dt,At,Gt),s.bK(G,Yt+1,Dt,At,Gt),s.bK(G,Yt+2,Dt,At,Gt),s.bK(G,Yt+3,Dt,At,Gt)}const[gn,wt,at]=Xt.point;s.bL(H,gn,wt,at,Xt.angle)};if(qe>1){const Xt=vl(De,O,Be,Ze,d,ne,J,y,I,A,re,ce,!1,pe,me,be,Ne);if(!Xt)return{notEnoughRoom:!0};if(v&&!d){let[gn,wt,at]=Xt.first.point,[Dt,At,Gt]=Xt.last.point;[gn,wt]=Fo(gn,wt,at,P),[Dt,At]=Fo(Dt,At,Gt,P);const Yt=Bg(_t,ct,(Dt-gn)*de,At-wt);if(y.flipState=Yt&&Yt.needsFlipping?La.flipRequired:La.flipNotRequired,Yt)return Yt}Ct(Xt.first);for(let gn=Ue+1;gn<Ue+qe-1;gn++){const wt=Hh(De*O.getoffsetX(gn),Be,Ze,d,ne,J,Ge,Ye,Bt,I,A,re,ce,!1,!1,pe,me,be,Ne);if(!wt)return H.length-=4*(gn-Ue),{notEnoughRoom:!0};Ct(wt)}Ct(Xt.last)}else{if(v&&!d){const gn=Fo(J.x,J.y,0,S),wt=Ye+Ge+1,at=new s.P(I.getx(wt),I.gety(wt)),Dt=Fo(at.x,at.y,0,S),At=Dt[3]>0?Dt:ns(J,at,gn,1,S,void 0,pe,me.canonical),Gt=Bg(_t,ct,(At[0]-gn[0])*de,At[1]-gn[1]);if(y.flipState=Gt&&Gt.needsFlipping?La.flipRequired:La.flipNotRequired,Gt)return Gt}const Xt=Hh(De*O.getoffsetX(Ue),Be,Ze,d,ne,J,Ge,Ye,Bt,I,A,re,ce,!1,!1,pe,me,be,Ne);if(!Xt)return{notEnoughRoom:!0};Ct(Xt)}return{}}function pm(y,a,d,v,S){const{x:A,y:P,z:O}=v.projectTilePoint(y.x,y.y,a);if(!S)return Fo(A,P,O,d);const[I,H,G]=S(y);return Fo(A+I,P+H,O+G,d)}function ns(y,a,d,v,S,A,P,O){const I=pm(y.sub(a)._unit()._add(y),O,S,P,A);return s.at(I,d,I),s.au(I,I),s.bE(I,d,I,v)}function Hh(y,a,d,v,S,A,P,O,I,H,G,ne,J,re,de,ce,pe,me,be){const Ne=v?y-a:y+a;let De=Ne>0?1:-1,Be=0;v&&(De*=-1,Be=Math.PI),De<0&&(Be+=Math.PI);let Ze=O+P+(De>0?0:1)|0,Ye=S,Ue=S,qe=0,Ge=0;const _t=Math.abs(Ne),ct=[],Bt=[];let Ct=A,Xt=Ct,gn=s.bC([]);const wt=()=>ns(Xt,Ct,Ue,_t-qe+1,G,J,ce,pe.canonical);for(;qe+Ge<=_t;){if(Ze+=De,Ze<O||Ze>=I)return null;if(Ue=Ye,Xt=Ct,ct.push(Ue),re&&Bt.push(Xt),Ct=new s.P(H.getx(Ze),H.gety(Ze)),Ye=ne[Ze],!Ye){const In=pm(Ct,pe.canonical,G,ce,J);Ye=In[3]>0?ne[Ze]=In:wt()}qe+=Ge;const Pn=s.at([],Ye,Ue),Kn=s.bD(Ue,Ye);if(d&&Kn>0&&Ge>0&&s.bG(gn,Pn)/(Ge*Kn)<be)return null;Ge=Kn,gn=Pn}de&&J&&(ne[Ze]&&(Ye=wt(),Ge=s.bD(Ue,Ye),gn=s.at([],Ye,Ue)),ne[Ze]=Ye);const at=(_t-qe)/Ge,Dt=Ct.sub(Xt)._mult(at)._add(Xt),At=s.bE([],Ue,gn,at);let Gt=[0,0,1],Yt=gn[0],Ht=gn[1];if(me&&(Gt=ce.upVector(pe.canonical,Dt.x,Dt.y),Gt[0]!==0||Gt[1]!==0||Gt[2]!==1)){const Pn=[Gt[2],0,-Gt[0]],Kn=s.bF([],Gt,Pn);s.au(Pn,Pn),s.au(Kn,Kn),Yt=s.bG(gn,Pn),Ht=s.bG(gn,Kn)}if(d){const Pn=s.bF([],Gt,gn);s.au(Pn,Pn),s.bE(At,At,Pn,d*De)}const en=Be+Math.atan2(Ht,Yt);return ct.push(At),re&&Bt.push(Dt),{point:At,angle:en,path:ct,tilePath:Bt,up:Gt}}function eh(y,a){const d=a.length,v=d+4*y;a.resize(v),a.float32.fill(-1/0,4*d,4*v)}function Ug(y,a,d){const v=a[0],S=a[1];return y[0]=d[0]*v+d[4]*S+d[12],y[1]=d[1]*v+d[5]*S+d[13],y[3]=d[3]*v+d[7]*S+d[15],y}const yr=100;class Vg{constructor(a,d,v=new no(a.width+200,a.height+200,25),S=new no(a.width+200,a.height+200,25)){this.transform=a,this.grid=v,this.ignoredGrid=S,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+yr,this.screenBottomBoundary=a.height+yr,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200,this.fogState=d}placeCollisionBox(a,d,v,S,A,P,O,I,H,G,ne){let J=v.projectedAnchorX,re=v.projectedAnchorY,de=v.projectedAnchorZ;const ce=v.tileAnchorX,pe=v.tileAnchorY,me=v.elevation,be=v.tileID,Ne=a.getProjection();if(me&&be){const[Bt,Ct,Xt]=Ne.upVector(be.canonical,v.tileAnchorX,v.tileAnchorY),gn=Ne.upVectorScale(be.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;J+=Bt*me*gn,re+=Ct*me*gn,de+=Xt*me*gn}const De=a.projection.name==="globe",Be=a.projection.name==="globe"?s.ah(this.transform.zoom):0;if(be&&De&&Be<1&&!P){const Bt=1<<be.canonical.z,Ct=s.bM(ce,pe);s.bN(Ct,Ct,1/s.aj),s.bO(Ct,Ct,s.bM(be.canonical.x,be.canonical.y)),s.bN(Ct,Ct,1/Bt),s.bP(Ct,Ct,s.bM(S[0],S[1])),Ct[0]=s.bQ(Ct[0],-.5,.5),s.bN(Ct,Ct,s.aj);const Xt=s.bR(Ct[0],Ct[1],s.aj/(2*Math.PI),1);s.aA(Xt,Xt,A),J=s.ai(J,Xt[0],Be),re=s.ai(re,Xt[1],Be),de=s.ai(de,Xt[2],Be)}const Ze=this.projectAndGetPerspectiveRatio(G,J,re,de,v.tileID,Ne.name==="globe"||!!me||this.transform.pitch>0,Ne),Ye=H*Ze.perspectiveRatio,Ue=(v.x1*d+O.x-v.padding)*Ye+Ze.point.x,qe=(v.y1*d+O.y-v.padding)*Ye+Ze.point.y,Ge=(v.x2*d+O.x+v.padding)*Ye+Ze.point.x,_t=(v.y2*d+O.y+v.padding)*Ye+Ze.point.y,ct=Ze.perspectiveRatio<=.55||Ze.occluded;return!this.isInsideGrid(Ue,qe,Ge,_t)||!I&&this.grid.hitTest(Ue,qe,Ge,_t,ne)||ct?{box:[],offscreen:!1,occluded:Ze.occluded}:{box:[Ue,qe,Ge,_t],offscreen:this.isOffscreen(Ue,qe,Ge,_t),occluded:!1}}placeCollisionCircles(a,d,v,S,A,P,O,I,H,G,ne,J,re,de,ce){const pe=[],me=this.transform.elevation,be=a.getProjection(),Ne=me?me.getAtTileOffsetFunc(ce,this.transform.center.lat,this.transform.worldSize,be):null,De=new s.P(v.tileAnchorX,v.tileAnchorY);let{x:Be,y:Ze,z:Ye}=be.projectTilePoint(De.x,De.y,ce.canonical);if(Ne){const[Gt,Yt,Ht]=Ne(De);Be+=Gt,Ze+=Yt,Ye+=Ht}const Ue=be.name==="globe",qe=this.projectAndGetPerspectiveRatio(O,Be,Ze,Ye,ce,Ue||!!me||this.transform.pitch>0,be),{perspectiveRatio:Ge}=qe,_t=(ne?P/Ge:P*Ge)/s.bU,ct=Fo(Be,Ze,Ye,I),Bt=v.lineOffsetX*_t,Ct=v.lineOffsetY*_t,Xt=s.al(a.layers[0].layout.get("text-max-angle")),gn=Math.cos(Xt),wt=qe.signedDistanceFromCamera>0?vl(_t,A,Bt,Ct,!1,ct,De,v,S,I,{},me&&!ne?Ne:null,ne&&!!me,be,ce,ne,gn):null;let at=!1,Dt=!1,At=!0;if(wt&&!qe.occluded){const Gt=.5*re*Ge+de,Yt=new s.P(-100,-100),Ht=new s.P(this.screenRightBoundary,this.screenBottomBoundary),en=new ua,{first:Pn,last:Kn}=wt,In=Pn.path.length;let rr=[];for(let Tr=In-1;Tr>=1;Tr--)rr.push(Pn.path[Tr]);for(let Tr=1;Tr<Kn.path.length;Tr++)rr.push(Kn.path[Tr]);const ar=2.5*Gt;H&&(rr=rr.map((([Tr,Zr,ji],Lr)=>(Ne&&!Ue&&(ji=Ne(Lr<In-1?Pn.tilePath[In-1-Lr]:Kn.tilePath[Lr-In+2])[2]),Fo(Tr,Zr,ji,H)))),rr.some((Tr=>Tr[3]<=0))&&(rr=[]));let Er=[];if(rr.length>0){let Tr=1/0,Zr=-1/0,ji=1/0,Lr=-1/0;for(const mi of rr)Tr=Math.min(Tr,mi[0]),ji=Math.min(ji,mi[1]),Zr=Math.max(Zr,mi[0]),Lr=Math.max(Lr,mi[1]);Zr>=Yt.x&&Tr<=Ht.x&&Lr>=Yt.y&&ji<=Ht.y&&(Er=[rr.map((mi=>new s.P(mi[0],mi[1])))],(Tr<Yt.x||Zr>Ht.x||ji<Yt.y||Lr>Ht.y)&&(Er=s.bS(Er,Yt.x,Yt.y,Ht.x,Ht.y)))}for(const Tr of Er){en.reset(Tr,.25*Gt);let Zr=0;Zr=en.length<=.5*Gt?1:Math.ceil(en.paddedLength/ar)+1;for(let ji=0;ji<Zr;ji++){const Lr=ji/Math.max(Zr-1,1),mi=en.lerp(Lr),Ii=mi.x+yr,os=mi.y+yr;pe.push(Ii,os,Gt,0);const Fr=Ii-Gt,Bi=os-Gt,$i=Ii+Gt,Wi=os+Gt;if(At=At&&this.isOffscreen(Fr,Bi,$i,Wi),Dt=Dt||this.isInsideGrid(Fr,Bi,$i,Wi),!d&&this.grid.hitTestCircle(Ii,os,Gt,J)&&(at=!0,!G))return{circles:[],offscreen:!1,collisionDetected:at,occluded:!1}}}}return{circles:!G&&at||!Dt?[]:pe,offscreen:At,collisionDetected:at,occluded:qe.occluded}}queryRenderedSymbols(a){if(a.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let v=1/0,S=1/0,A=-1/0,P=-1/0;for(const G of a){const ne=new s.P(G.x+yr,G.y+yr);v=Math.min(v,ne.x),S=Math.min(S,ne.y),A=Math.max(A,ne.x),P=Math.max(P,ne.y),d.push(ne)}const O=this.grid.query(v,S,A,P).concat(this.ignoredGrid.query(v,S,A,P)),I={},H={};for(const G of O){const ne=G.key;if(I[ne.bucketInstanceId]===void 0&&(I[ne.bucketInstanceId]={}),I[ne.bucketInstanceId][ne.featureIndex])continue;const J=[new s.P(G.x1,G.y1),new s.P(G.x2,G.y1),new s.P(G.x2,G.y2),new s.P(G.x1,G.y2)];s.bT(d,J)&&(I[ne.bucketInstanceId][ne.featureIndex]=!0,H[ne.bucketInstanceId]===void 0&&(H[ne.bucketInstanceId]=[]),H[ne.bucketInstanceId].push(ne.featureIndex))}return H}insertCollisionBox(a,d,v,S,A){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:S,collisionGroupID:A},a[0],a[1],a[2],a[3])}insertCollisionCircles(a,d,v,S,A){const P=d?this.ignoredGrid:this.grid,O={bucketInstanceId:v,featureIndex:S,collisionGroupID:A};for(let I=0;I<a.length;I+=4)P.insertCircle(O,a[I],a[I+1],a[I+2])}projectAndGetPerspectiveRatio(a,d,v,S,A,P,O){const I=[d,v,S,1];let H=!1;S||this.transform.pitch>0?(s.aA(I,I,a),this.fogState&&A&&O.name!=="globe"&&(H=(function(J,re,de,ce,pe,me){const be=me.calculateFogTileMatrix(pe),Ne=[re,de,ce];return s.ad(Ne,Ne,be),ir(J,s.ae(Ne),me.pitch,me._fov)})(this.fogState,d,v,S,A.toUnwrapped(),this.transform)>.9)):Ug(I,I,a);const G=I[3];return{point:new s.P((I[0]/G+1)/2*this.transform.width+yr,(-I[1]/G+1)/2*this.transform.height+yr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(O)/G*.5,1.5),signedDistanceFromCamera:G,occluded:P&&I[2]>G||H}}isOffscreen(a,d,v,S){return v<yr||a>=this.screenRightBoundary||S<yr||d>this.screenBottomBoundary}isInsideGrid(a,d,v,S){return v>=0&&a<this.gridRightBoundary&&S>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const a=s.bx([]);return s.bo(a,a,[-100,-100,0]),a}}class Gh{constructor(a,d,v,S){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?d:-d))):S&&v?1:0,this.placed=v}isHidden(){return this.opacity===0&&!this.placed}}class ld{constructor(a,d,v,S,A,P=!1){this.text=new Gh(a?a.text:null,d,v,A),this.icon=new Gh(a?a.icon:null,d,S,A),this.clipped=P}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Il{constructor(a,d,v,S=!1){this.text=a,this.icon=d,this.skipFade=v,this.clipped=S}}class Wh{constructor(){this.invProjMatrix=s.bz(),this.viewportMatrix=s.bz(),this.circles=[]}}class th{constructor(a,d,v,S,A){this.bucketInstanceId=a,this.featureIndex=d,this.sourceLayerIndex=v,this.bucketIndex=S,this.tileID=A}}class cr{constructor(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}}get(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){const d=++this.maxGroupID;this.collisionGroups[a]={ID:d,predicate:v=>v.collisionGroupID===d}}return this.collisionGroups[a]}}function Qi(y,a,d,v,S){const{horizontalAlign:A,verticalAlign:P}=s.bZ(y),O=-(A-.5)*a,I=-(P-.5)*d,H=s.b_(y,v);return new s.P(O+H[0]*S,I+H[1]*S)}function ri(y,a,d,v,S){const A=new s.P(y,a);return d&&A._rotate(v?S:-S),A}class Yo{constructor(a,d,v,S,A,P){this.transform=a.clone(),this.projection=a.projection.name,this.collisionIndex=new Vg(this.transform,A),this.buildingIndex=P,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new cr(v),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(a,d,v,S,A=1){const P=v.getBucket(d),O=v.latestFeatureIndex;if(!P||!O||d.fqid!==P.layerIds[0])return;const I=P.layers[0].layout,H=P.layers[0].paint,G=v.collisionBoxArray,ne=Math.pow(2,this.transform.zoom-v.tileID.overscaledZ),J=v.tileSize/s.aj,re=v.tileID.toUnwrapped();this.transform.setProjection(P.projection);const de=(ce=v.tileID,pe=P.getProjection(),me=this.transform,pe.name===this.projection?me.calculateProjMatrix(ce.toUnwrapped()):gr(me,pe,ce));var ce,pe,me;const be=I.get("text-pitch-alignment")==="map",Ne=I.get("text-rotation-alignment")==="map";d.compileFilter(d.options);const De=d.dynamicFilter(),Be=d.dynamicFilterNeedsFeature(),Ze=this.transform.calculatePixelsToTileUnitsMatrix(v),Ye=kl(de,v.tileID.canonical,be,Ne,this.transform,P.getProjection(),Ze);let Ue=null;const qe=P.getProjection().createInversionMatrix(this.transform,v.tileID.canonical);if(be){const at=yc(de,v.tileID.canonical,be,Ne,this.transform,P.getProjection(),Ze);Ue=s.az([],this.transform.labelPlaneMatrix,at)}let Ge=null;De&&v.latestFeatureIndex&&(Ge={unwrappedTileID:re,dynamicFilter:De,dynamicFilterNeedsFeature:Be}),this.retainedQueryData[P.bucketInstanceId]=new th(P.bucketInstanceId,O,P.sourceLayerIndex,P.index,v.tileID);const[_t,ct]=P.layers[0].layout.get("text-size-scale-range"),Bt=s.ay(A,_t,ct),[Ct,Xt]=I.get("icon-size-scale-range"),gn=s.ay(A,Ct,Xt),wt={bucket:P,layout:I,paint:H,posMatrix:de,invMatrix:qe,mercatorCenter:[s.aD(this.transform.center.lng),s.aH(this.transform.center.lat)],textLabelPlaneMatrix:Ye,labelToScreenMatrix:Ue,clippingData:Ge,scale:ne,textPixelRatio:J,holdingForFade:v.holdingForFade(),collisionBoxArray:G,partiallyEvaluatedTextSize:s.bH(P.textSizeData,this.transform.zoom,Bt),partiallyEvaluatedIconSize:s.bH(P.iconSizeData,this.transform.zoom,gn),collisionGroup:this.collisionGroups.get(P.sourceID),latestFeatureIndex:v.latestFeatureIndex};if(S)for(const at of P.sortKeyRanges){const{sortKey:Dt,symbolInstanceStart:At,symbolInstanceEnd:Gt}=at;a.push({sortKey:Dt,symbolInstanceStart:At,symbolInstanceEnd:Gt,parameters:wt})}else a.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:wt})}attemptAnchorPlacement(a,d,v,S,A,P,O,I,H,G,ne,J,re,de,ce,pe,me,be,Ne,De,Be){const{textOffset0:Ze,textOffset1:Ye,crossTileID:Ue}=ce,qe=[Ze,Ye],Ge=Qi(a,P,O,qe,I),_t=this.collisionIndex.placeCollisionBox(me,I,d,v,S,A,ri(Ge.x,Ge.y,H,G,this.transform.angle),de,ne,J,re.predicate);if(Ne){const ct=me.getSymbolInstanceIconSize(Be,this.transform.zoom,ce.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(me,ct,Ne,v,S,A,ri(Ge.x,Ge.y,H,G,this.transform.angle),de,ne,J,re.predicate).box.length===0)return}if(_t.box.length>0){let ct;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ue]&&this.prevPlacement.placements[Ue]&&this.prevPlacement.placements[Ue].text&&(ct=this.prevPlacement.variableOffsets[Ue].anchor),this.variableOffsets[Ue]={textOffset:qe,width:P,height:O,anchor:a,textScale:I,prevAnchor:ct},this.markUsedJustification(me,a,ce,be),me.allowVerticalPlacement&&(this.markUsedOrientation(me,be,ce),this.placedOrientations[Ue]=be),{shift:Ge,placedGlyphBoxes:_t}}}placeLayerBucketPart(a,d,v,S,A=1){const{bucket:P,layout:O,paint:I,posMatrix:H,textLabelPlaneMatrix:G,labelToScreenMatrix:ne,clippingData:J,textPixelRatio:re,mercatorCenter:de,invMatrix:ce,holdingForFade:pe,collisionBoxArray:me,partiallyEvaluatedTextSize:be,partiallyEvaluatedIconSize:Ne,collisionGroup:De,latestFeatureIndex:Be}=a.parameters,Ze=O.get("text-optional"),Ye=O.get("icon-optional"),Ue=O.get("text-allow-overlap"),qe=O.get("icon-allow-overlap"),Ge=O.get("text-rotation-alignment")==="map",_t=O.get("icon-rotation-alignment")==="map",ct=O.get("text-pitch-alignment")==="map",Bt=I.get("symbol-z-offset"),Ct=O.get("symbol-elevation-reference")==="sea",Xt=O.get("symbol-placement"),[gn,wt]=O.get("text-size-scale-range"),[at,Dt]=O.get("icon-size-scale-range"),At=s.ay(A,gn,wt),Gt=s.ay(A,at,Dt),Yt=O.get("text-variable-anchor"),Ht=Ge&&Xt!=="point",en=_t&&Xt!=="point",Pn=Yt&&P.hasTextData(),Kn=P.hasIconTextFit()&&Pn&&P.hasIconData();this.transform.setProjection(P.projection);const In=Pn||Ht,rr=en||Kn;let ar=Ue&&(qe||!P.hasIconData()||Ye),Er=qe&&(Ue||!P.hasTextData()||Ze);const Tr=!Bt.isConstant();!P.collisionArrays&&me&&P.deserializeCollisionBoxes(me),v&&S&&P.updateCollisionDebugBuffers(this.transform.zoom,me,At,Gt);const Zr=(Lr,mi,Ii)=>{const{crossTileID:os,numVerticalGlyphVertices:Fr}=Lr;let Bi=null;if(J&&J.dynamicFilterNeedsFeature||Tr){const la=this.retainedQueryData[P.bucketInstanceId];Bi=Be.loadFeature({featureIndex:Lr.featureIndex,bucketIndex:la.bucketIndex,sourceLayerIndex:la.sourceLayerIndex,layoutVertexArrayOffset:0})}if(J&&!(0,J.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},Bi,this.retainedQueryData[P.bucketInstanceId].tileID.canonical,new s.P(Lr.tileAnchorX,Lr.tileAnchorY),this.transform.calculateDistanceTileData(J.unwrappedTileID)))return this.placements[os]=new Il(!1,!1,!1,!0),void d.add(os);const $i=Bt.evaluate(Bi,{});if(d.has(os))return;if(pe)return void(this.placements[os]=new Il(!1,!1,!1));let Wi=!1,ii=!1,Xi=!0,oi=!1,js=!1,Ei=null,Ui={box:null,offscreen:null,occluded:null},fs={box:null},_a=null,ba=null,pa=null,go=0,so=0,ll=0;Ii.textFeatureIndex?go=Ii.textFeatureIndex:Lr.useRuntimeCollisionCircles&&(go=Lr.featureIndex),Ii.verticalTextFeatureIndex&&(so=Ii.verticalTextFeatureIndex);const za=la=>{la.tileID=this.retainedQueryData[P.bucketInstanceId].tileID;const ia=this.transform.elevation;la.elevation=Ct?$i:$i+(ia?ia.getAtTileOffset(la.tileID,la.tileAnchorX,la.tileAnchorY):0),la.elevation+=Lr.zOffset},qo=Ii.textBox;if(qo){za(qo);const la=ls=>{let Ga=s.bI.horizontal;if(P.allowVerticalPlacement&&!ls&&this.prevPlacement){const So=this.prevPlacement.placedOrientations[os];So&&(this.placedOrientations[os]=So,Ga=So,this.markUsedOrientation(P,Ga,Lr))}return Ga},ia=(ls,Ga)=>{if(P.allowVerticalPlacement&&Fr>0&&Ii.verticalTextBox){for(const So of P.writingModes)if(So===s.bI.vertical?(Ui=Ga(),fs=Ui):Ui=ls(),Ui&&Ui.box&&Ui.box.length)break}else Ui=ls()};if(Yt){let ls=Yt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[os]){const ma=this.prevPlacement.variableOffsets[os];ls.indexOf(ma.anchor)>0&&(ls=ls.filter((Vl=>Vl!==ma.anchor)),ls.unshift(ma.anchor))}const Ga=(ma,Vl,Rd)=>{const Th=P.getSymbolInstanceTextSize(be,Lr,this.transform.zoom,mi),Ep=(ma.x2-ma.x1)*Th+2*ma.padding,Cp=(ma.y2-ma.y1)*Th+2*ma.padding,ac=Lr.hasIconTextFit&&!qe?Vl:null;ac&&za(ac);let gu={box:[],offscreen:!1,occluded:!1};const wa=Ue?2*ls.length:ls.length;for(let Tl=0;Tl<wa;++Tl){const Ah=this.attemptAnchorPlacement(ls[Tl%ls.length],ma,de,ce,In,Ep,Cp,Th,Ge,ct,re,H,De,Tl>=ls.length,Lr,mi,P,Rd,ac,be,Ne);if(Ah&&(gu=Ah.placedGlyphBoxes,gu&&gu.box&&gu.box.length)){Wi=!0,Ei=Ah.shift;break}}return gu};ia((()=>Ga(qo,Ii.iconBox,s.bI.horizontal)),(()=>{const ma=Ii.verticalTextBox;return ma&&za(ma),P.allowVerticalPlacement&&!(Ui&&Ui.box&&Ui.box.length)&&Fr>0&&ma?Ga(ma,Ii.verticalIconBox,s.bI.vertical):{box:null,offscreen:null,occluded:null}})),Ui&&(Wi=Ui.box,Xi=Ui.offscreen,oi=Ui.occluded);const So=la(!(!Ui||!Ui.box));if(!Wi&&this.prevPlacement){const ma=this.prevPlacement.variableOffsets[os];ma&&(this.variableOffsets[os]=ma,this.markUsedJustification(P,ma.anchor,Lr,So))}}else{const ls=(Ga,So)=>{const ma=P.getSymbolInstanceTextSize(be,Lr,this.transform.zoom,mi,A),Vl=this.collisionIndex.placeCollisionBox(P,ma,Ga,de,ce,In,new s.P(0,0),Ue,re,H,De.predicate);return Vl&&Vl.box&&Vl.box.length&&(this.markUsedOrientation(P,So,Lr),this.placedOrientations[os]=So),Vl};ia((()=>ls(qo,s.bI.horizontal)),(()=>{const Ga=Ii.verticalTextBox;return P.allowVerticalPlacement&&Fr>0&&Ga?(za(Ga),ls(Ga,s.bI.vertical)):{box:null,offscreen:null,occluded:null}})),la(!!(Ui&&Ui.box&&Ui.box.length))}}if(_a=Ui,Wi=_a&&_a.box&&_a.box.length>0,Xi=_a&&_a.offscreen,oi=_a&&_a.occluded,Lr.useRuntimeCollisionCircles){const la=P.text.placedSymbolArray.get(Lr.centerJustifiedTextSymbolIndex>=0?Lr.centerJustifiedTextSymbolIndex:Lr.verticalPlacedTextSymbolIndex),ia=s.bJ(P.textSizeData,be,la),ls=O.get("text-padding");ba=this.collisionIndex.placeCollisionCircles(P,Ue,la,P.lineVertexArray,P.glyphOffsetArray,ia,H,G,ne,v,ct,De.predicate,Lr.collisionCircleDiameter*ia/s.bU,ls,this.retainedQueryData[P.bucketInstanceId].tileID),Wi=Ue||ba.circles.length>0&&!ba.collisionDetected,Xi=Xi&&ba.offscreen,oi=ba.occluded}if(Ii.iconFeatureIndex&&(ll=Ii.iconFeatureIndex),Ii.iconBox){const la=ia=>{za(ia);const ls=Lr.hasIconTextFit&&Ei?ri(Ei.x,Ei.y,Ge,ct,this.transform.angle):new s.P(0,0),Ga=P.getSymbolInstanceIconSize(Ne,this.transform.zoom,Lr.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(P,Ga,ia,de,ce,rr,ls,qe,re,H,De.predicate)};fs&&fs.box&&fs.box.length&&Ii.verticalIconBox?(pa=la(Ii.verticalIconBox),ii=pa.box.length>0):(pa=la(Ii.iconBox),ii=pa.box.length>0),Xi=Xi&&pa.offscreen,js=pa.occluded}const sc=Ze||Lr.numHorizontalGlyphVertices===0&&Fr===0,Wc=Ye||Lr.numIconVertices===0;if(sc||Wc?Wc?sc||(ii=ii&&Wi):Wi=ii&&Wi:ii=Wi=ii&&Wi,Wi&&_a&&_a.box&&this.collisionIndex.insertCollisionBox(_a.box,O.get("text-ignore-placement"),P.bucketInstanceId,fs&&fs.box&&so?so:go,De.ID),ii&&pa&&this.collisionIndex.insertCollisionBox(pa.box,O.get("icon-ignore-placement"),P.bucketInstanceId,ll,De.ID),ba&&(Wi&&this.collisionIndex.insertCollisionCircles(ba.circles,O.get("text-ignore-placement"),P.bucketInstanceId,go,De.ID),v)){const la=P.bucketInstanceId;let ia=this.collisionCircleArrays[la];ia===void 0&&(ia=this.collisionCircleArrays[la]=new Wh);for(let ls=0;ls<ba.circles.length;ls+=4)ia.circles.push(ba.circles[ls+0]),ia.circles.push(ba.circles[ls+1]),ia.circles.push(ba.circles[ls+2]),ia.circles.push(ba.collisionDetected?1:0)}const Ha=P.projection.name!=="globe";ar=ar&&(Ha||!oi),Er=Er&&(Ha||!js),this.placements[os]=new Il(Wi||ar,ii||Er,Xi||P.justReloaded),d.add(os)},ji=this.retainedQueryData[P.bucketInstanceId].tileID;if(P.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(P,ji),P.elevationType==="road"&&P.updateRoadElevation(ji.canonical),P.updateZOffset(),P.sortFeaturesByY){const Lr=P.getSortedSymbolIndexes(this.transform.angle);for(let mi=Lr.length-1;mi>=0;--mi){const Ii=Lr[mi];Zr(P.symbolInstances.get(Ii),Ii,P.collisionArrays[Ii])}P.hasAnyZOffset&&s.w(`${P.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(P.hasAnyZOffset){const Lr=P.getSortedIndexesByZOffset();for(let mi=0;mi<Lr.length;++mi){const Ii=Lr[mi];Zr(P.symbolInstances.get(Ii),Ii,P.collisionArrays[Ii])}}else for(let Lr=a.symbolInstanceStart;Lr<a.symbolInstanceEnd;Lr++)Zr(P.symbolInstances.get(Lr),Lr,P.collisionArrays[Lr]);if(v&&P.bucketInstanceId in this.collisionCircleArrays){const Lr=this.collisionCircleArrays[P.bucketInstanceId];s.bi(Lr.invProjMatrix,H),Lr.viewportMatrix=this.collisionIndex.getViewportMatrix()}P.justReloaded=!1}markUsedJustification(a,d,v,S){const{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:I,crossTileID:H}=v,G=s.b$(d),ne=S===s.bI.vertical?I:G==="left"?A:G==="center"?P:G==="right"?O:-1;A>=0&&(a.text.placedSymbolArray.get(A).crossTileID=ne>=0&&A!==ne?0:H),P>=0&&(a.text.placedSymbolArray.get(P).crossTileID=ne>=0&&P!==ne?0:H),O>=0&&(a.text.placedSymbolArray.get(O).crossTileID=ne>=0&&O!==ne?0:H),I>=0&&(a.text.placedSymbolArray.get(I).crossTileID=ne>=0&&I!==ne?0:H)}markUsedOrientation(a,d,v){const S=d===s.bI.horizontal||d===s.bI.horizontalOnly?d:0,A=d===s.bI.vertical?d:0,{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:O,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:H}=v,G=a.text.placedSymbolArray;P>=0&&(G.get(P).placedOrientation=S),O>=0&&(G.get(O).placedOrientation=S),I>=0&&(G.get(I).placedOrientation=S),H>=0&&(G.get(H).placedOrientation=A)}commit(a){this.commitTime=a,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let v=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const S=d?d.symbolFadeChange(a):1,A=d?d.opacities:{},P=d?d.variableOffsets:{},O=d?d.placedOrientations:{};for(const I in this.placements){const H=this.placements[I],G=A[I];G?(this.opacities[I]=new ld(G,S,H.text,H.icon,null,H.clipped),v=v||H.text!==G.text.placed||H.icon!==G.icon.placed):(this.opacities[I]=new ld(null,S,H.text,H.icon,H.skipFade,H.clipped),v=v||H.text||H.icon)}for(const I in A){const H=A[I];if(!this.opacities[I]){const G=new ld(H,S,!1,!1);G.isHidden()||(this.opacities[I]=G,v=v||H.text.placed||H.icon.placed)}}for(const I in P)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=P[I]);for(const I in O)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=O[I]);v?this.lastPlacementChangeTime=a:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:a)}updateLayerOpacities(a,d,v,S){const A=new Set;for(const P of d){const O=P.getBucket(a);O&&P.latestFeatureIndex&&a.fqid===O.layerIds[0]&&(this.updateBucketOpacities(O,A,P,P.collisionBoxArray,v,S,P.tileID,a.scope),O.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(O,P.tileID),O.elevationType==="road"&&O.updateRoadElevation(P.tileID.canonical),O.updateZOffset())}}updateBucketOpacities(a,d,v,S,A,P,O,I){a.hasTextData()&&a.text.opacityVertexArray.clear(),a.hasIconData()&&a.icon.opacityVertexArray.clear(),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexArray.clear(),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexArray.clear();const H=a.layers[0].layout,G=a.layers[0].paint,ne=!!a.layers[0].dynamicFilter(),J=new ld(null,0,!1,!1,!0),re=H.get("text-allow-overlap"),de=H.get("icon-allow-overlap"),ce=H.get("text-variable-anchor"),pe=H.get("text-rotation-alignment")==="map",me=H.get("text-pitch-alignment")==="map",be=G.get("symbol-z-offset"),Ne=H.get("symbol-elevation-reference")==="sea",De=!be.isConstant(),Be=new ld(null,0,re&&(de||!a.hasIconData()||H.get("icon-optional")),de&&(re||!a.hasTextData()||H.get("text-optional")),!0);!a.collisionArrays&&S&&(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData())&&a.deserializeCollisionBoxes(S);const Ze=(Ue,qe,Ge)=>{for(let _t=0;_t<qe/4;_t++)Ue.opacityVertexArray.emplaceBack(Ge)};let Ye=0;P&&a.updateReplacement(O,P);for(let Ue=0;Ue<a.symbolInstances.length;Ue++){const qe=a.symbolInstances.get(Ue),{numHorizontalGlyphVertices:Ge,numVerticalGlyphVertices:_t,crossTileID:ct,numIconVertices:Bt,tileAnchorX:Ct,tileAnchorY:Xt}=qe;let gn=null;const wt=this.retainedQueryData[a.bucketInstanceId];De&&qe&&wt&&(gn=v.latestFeatureIndex.loadFeature({featureIndex:qe.featureIndex,bucketIndex:wt.bucketIndex,sourceLayerIndex:wt.sourceLayerIndex,layoutVertexArrayOffset:0}));const at=be.evaluate(gn,{}),Dt=d.has(ct);let At=this.opacities[ct];Dt?At=J:At||(At=Be,this.opacities[ct]=At),d.add(ct);const Gt=Ge>0||_t>0,Yt=Bt>0,Ht=this.placedOrientations[ct],en=Ht===s.bI.vertical,Pn=Ht===s.bI.horizontal||Ht===s.bI.horizontalOnly;!Gt&&!Yt||At.isHidden()||Ye++;let Kn=!1;if((Gt||Yt)&&P)for(const In of a.activeReplacements){if(s.bV(In,A,s.bW.Symbol,I)||In.min.x>Ct||Ct>In.max.x||In.min.y>Xt||Xt>In.max.y)continue;const rr=s.bX(Ct,Xt,O.canonical,In.footprintTileId.canonical);if(Kn=s.bY(rr,In.footprint),Kn)break}if(Gt){const In=Kn?Ti:Xr(At.text);Ze(a.text,Ge,en?Ti:In),Ze(a.text,_t,Pn?Ti:In);const rr=At.text.isHidden(),{leftJustifiedTextSymbolIndex:ar,centerJustifiedTextSymbolIndex:Er,rightJustifiedTextSymbolIndex:Tr,verticalPlacedTextSymbolIndex:Zr}=qe,ji=a.text.placedSymbolArray,Lr=rr||en?1:0;ar>=0&&(ji.get(ar).hidden=Lr),Er>=0&&(ji.get(Er).hidden=Lr),Tr>=0&&(ji.get(Tr).hidden=Lr),Zr>=0&&(ji.get(Zr).hidden=rr||Pn?1:0);const mi=this.variableOffsets[ct];mi&&this.markUsedJustification(a,mi.anchor,qe,Ht);const Ii=this.placedOrientations[ct];Ii&&(this.markUsedJustification(a,"left",qe,Ii),this.markUsedOrientation(a,Ii,qe))}if(Yt){const In=Kn?Ti:Xr(At.icon),{placedIconSymbolIndex:rr,verticalPlacedIconSymbolIndex:ar}=qe,Er=a.icon.placedSymbolArray,Tr=At.icon.isHidden()?1:0;rr>=0&&(Ze(a.icon,Bt,en?Ti:In),Er.get(rr).hidden=Tr),ar>=0&&(Ze(a.icon,qe.numVerticalIconVertices,Pn?Ti:In),Er.get(ar).hidden=Tr)}if(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData()){const In=a.collisionArrays[Ue];if(In){let rr=new s.P(0,0),ar=!0;if(In.textBox||In.verticalTextBox){if(ce){const Tr=this.variableOffsets[ct];Tr?(rr=Qi(Tr.anchor,Tr.width,Tr.height,Tr.textOffset,Tr.textScale),pe&&rr._rotate(me?this.transform.angle:-this.transform.angle)):ar=!1}ne&&(ar=!At.clipped),In.textBox&&iu(a.textCollisionBox.collisionVertexArray,At.text.placed,!ar||en,at,Ne,rr.x,rr.y),In.verticalTextBox&&iu(a.textCollisionBox.collisionVertexArray,At.text.placed,!ar||Pn,at,Ne,rr.x,rr.y)}const Er=ar&&!!(!Pn&&In.verticalIconBox);In.iconBox&&iu(a.iconCollisionBox.collisionVertexArray,At.icon.placed,Er,at,Ne,qe.hasIconTextFit?rr.x:0,qe.hasIconTextFit?rr.y:0),In.verticalIconBox&&iu(a.iconCollisionBox.collisionVertexArray,At.icon.placed,!Er,at,Ne,qe.hasIconTextFit?rr.x:0,qe.hasIconTextFit?rr.y:0)}}}if(a.fullyClipped=Ye===0,a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexBuffer&&a.iconCollisionBox.collisionVertexBuffer.updateData(a.iconCollisionBox.collisionVertexArray),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexBuffer&&a.textCollisionBox.collisionVertexBuffer.updateData(a.textCollisionBox.collisionVertexArray),a.bucketInstanceId in this.collisionCircleArrays){const Ue=this.collisionCircleArrays[a.bucketInstanceId];a.placementInvProjMatrix=Ue.invProjMatrix,a.placementViewportMatrix=Ue.viewportMatrix,a.collisionCircleArray=Ue.circles,delete this.collisionCircleArrays[a.bucketInstanceId]}}symbolFadeChange(a){return this.fadeDuration===0?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(a){return Math.max(0,(this.transform.zoom-a)/1.5)}hasTransitions(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(a,d){const v=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*v>a}setStale(){this.stale=!0}}function iu(y,a,d,v,S,A,P){y.emplaceBack(a?1:0,d?1:0,A||0,P||0,v,S?1:0),y.emplaceBack(a?1:0,d?1:0,A||0,P||0,v,S?1:0),y.emplaceBack(a?1:0,d?1:0,A||0,P||0,v,S?1:0),y.emplaceBack(a?1:0,d?1:0,A||0,P||0,v,S?1:0)}const ve=Math.pow(2,25),oe=Math.pow(2,24),xe=Math.pow(2,17),lt=Math.pow(2,16),vt=Math.pow(2,9),An=Math.pow(2,8),Nr=Math.pow(2,1);function Xr(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const a=y.placed?1:0,d=Math.floor(127*y.opacity);return d*ve+a*oe+d*xe+a*lt+d*vt+a*An+d*Nr+a}const Ti=0;class Ms{constructor(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&a.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(a,d,v,S,A,P){const O=this._bucketParts;for(;this._currentTileIndex<a.length;)if(d.getBucketParts(O,S,a[this._currentTileIndex],this._sortAcrossTiles,P),this._currentTileIndex++,A())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,O.sort(((I,H)=>I.sortKey-H.sortKey)));this._currentPartIndex<O.length;){const I=O[this._currentPartIndex];if(d.placeLayerBucketPart(I,this._seenCrossTileIDs,v,I.symbolInstanceStart===0,P),this._currentPartIndex++,A())return!0}return!1}}class $s{constructor(a,d,v,S,A,P,O,I,H){this.placement=new Yo(a,A,P,O,I,H),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(a,d,v,S,A){const P=s.q.now(),O=()=>{const I=s.q.now()-P;return!this._forceFullPlacement&&I>2};for(;this._currentPlacementIndex>=0;){const I=d[a[this._currentPlacementIndex]],H=this.placement.collisionIndex.transform.zoom;if(I.type==="symbol"&&(!I.minzoom||I.minzoom<=H)&&(!I.maxzoom||I.maxzoom>H)){const G=I,ne=G.layout.get("symbol-z-elevate"),J=G.layout.get("symbol-sort-key").constantOr(1)!==void 0,re=G.layout.get("symbol-z-order"),de=re==="viewport-y"||re==="auto"&&!(re!=="viewport-y"&&J),ce=G.layout.get("text-allow-overlap")||G.layout.get("icon-allow-overlap")||G.layout.get("text-ignore-placement")||G.layout.get("icon-ignore-placement"),pe=de&&ce,me=this._inProgressLayer=this._inProgressLayer||new Ms(G),be=s.C(I.source,I.scope);if(me.continuePlacement(ne||pe?S[be]:v[be],this.placement,this._showCollisionBoxes,I,O,A))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(a){return this.placement.commit(a),this.placement}}const Pa=512/s.aj/2;class Ru{constructor(a,d,v){this.tileID=a,this.bucketInstanceId=v,this.index=new s.c0(d.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const S=a.canonical.x*s.aj,A=a.canonical.y*s.aj;for(let P=0;P<d.length;P++){const{key:O,crossTileID:I,tileAnchorX:H,tileAnchorY:G}=d.get(P),ne=Math.floor((S+H)*Pa),J=Math.floor((A+G)*Pa);this.index.add(ne,J),this.keys.push(O),this.crossTileIDs.push(I)}this.index.finish()}findMatches(a,d,v){const S=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z),A=Pa/Math.pow(2,d.canonical.z-this.tileID.canonical.z),P=d.canonical.x*s.aj,O=d.canonical.y*s.aj;for(let I=0;I<a.length;I++){const H=a.get(I);if(H.crossTileID)continue;const{key:G,tileAnchorX:ne,tileAnchorY:J}=H,re=Math.floor((P+ne)*A),de=Math.floor((O+J)*A),ce=this.index.range(re-S,de-S,re+S,de+S).sort(((pe,me)=>pe-me));for(const pe of ce){const me=this.crossTileIDs[pe];if(this.keys[pe]===G&&!v.has(me)){v.add(me),H.crossTileID=me;break}}}}}class Bo{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class vc{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(a){const d=Math.round((a-this.lng)/360);if(d!==0)for(const v in this.indexes){const S=this.indexes[v],A={};for(const P in S){const O=S[P];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+d),A[O.tileID.key]=O}this.indexes[v]=A}this.lng=a}addBucket(a,d,v){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(let A=0;A<d.symbolInstances.length;A++)d.symbolInstances.get(A).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]=new Set);const S=this.usedCrossTileIDs[a.overscaledZ];for(const A in this.indexes){const P=this.indexes[A];if(Number(A)>a.overscaledZ)for(const O in P){const I=P[O];I.tileID.isChildOf(a)&&I.findMatches(d.symbolInstances,a,S)}else{const O=P[a.scaledTo(Number(A)).key];O&&O.findMatches(d.symbolInstances,a,S)}}for(let A=0;A<d.symbolInstances.length;A++){const P=d.symbolInstances.get(A);P.crossTileID||(P.crossTileID=v.generate(),S.add(P.crossTileID))}return this.indexes[a.overscaledZ]===void 0&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new Ru(a,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(a,d){for(const v of d.crossTileIDs)this.usedCrossTileIDs[a].delete(v)}removeStaleBuckets(a){let d=!1;for(const v in this.indexes){const S=this.indexes[v];for(const A in S)a[S[A].bucketInstanceId]||(this.removeBucketCrossTileIDs(v,S[A]),delete S[A],d=!0)}return d}}class uo{constructor(){this.layerIndexes={},this.crossTileIDs=new Bo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(a,d,v,S){let A=this.layerIndexes[a.fqid];A===void 0&&(A=this.layerIndexes[a.fqid]=new vc);let P=!1;const O={};S.name!=="globe"&&A.handleWrapJump(v);for(const I of d){const H=I.getBucket(a);H&&a.fqid===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),A.addBucket(I.tileID,H,this.crossTileIDs)&&(P=!0),O[H.bucketInstanceId]=!0)}return A.removeStaleBuckets(O)&&(P=!0),P}pruneUnusedLayers(a){const d={};a.forEach((v=>{d[v]=!0}));for(const v in this.layerIndexes)d[v]||delete this.layerIndexes[v]}}const Ou=771;class ei{constructor(a,d,v,S){this.blendFunction=a,this.blendColor=d.toNonPremultipliedRenderColor(null),this.mask=v,this.blendEquation=S}}ei.Replace=[1,0,1,0],ei.disabled=new ei(ei.Replace,s.am.transparent,[!1,!1,!1,!1]),ei.unblended=new ei(ei.Replace,s.am.transparent,[!0,!0,!0,!0]),ei.alphaBlended=new ei([1,Ou,1,Ou],s.am.transparent,[!0,!0,!0,!0]),ei.alphaBlendedNonPremultiplied=new ei([770,Ou,770,Ou],s.am.transparent,[!0,!0,!0,!0]),ei.multiply=new ei([774,0,774,0],s.am.transparent,[!0,!0,!0,!0]);class Fn{constructor(a,d,v){this.func=a,this.mask=d,this.range=v}}Fn.ReadOnly=!1,Fn.ReadWrite=!0,Fn.disabled=new Fn(519,Fn.ReadOnly,[0,1]);const Ll=7680;class Pr{constructor(a,d,v,S,A,P){this.test=a,this.ref=d,this.mask=v,this.fail=S,this.depthFail=A,this.pass=P}}Pr.disabled=new Pr({func:519,mask:0},0,0,Ll,Ll,Ll);const aa=1029,Dc=2305;class _r{constructor(a,d,v){this.enable=a,this.mode=d,this.frontFace=v}}function xc(y,a){const d=s.c6(y,3);s.c8(y,a),s.cc(y,3,d)}function su(y,a){const d=s.c3([]);return s.c4(d,d,-a),s.c5(d,d,-y),d}function kc(y,a){const d=[y[0],y[1],0],v=[a[0],a[1],0];if(s.ae(d)>=1e-15){const P=s.au([],d);s.c1(v,P,s.bG(v,P)),a[0]=v[0],a[1]=v[1]}const S=s.bF([],a,y);if(s.c2(S)<1e-15)return null;const A=Math.atan2(-S[1],S[0]);return su(Math.atan2(Math.sqrt(y[0]*y[0]+y[1]*y[1]),-y[2]),A)}_r.disabled=new _r(!1,aa,Dc),_r.backCCW=new _r(!0,aa,Dc),_r.backCW=new _r(!0,aa,2304),_r.frontCW=new _r(!0,1028,2304),_r.frontCCW=new _r(!0,1028,Dc);class Xf{constructor(a,d){this.position=a,this.orientation=d}get position(){return this._position}set position(a){if(a){const d=a instanceof s.ac?a:new s.ac(a[0],a[1],a[2]);this._renderWorldCopies&&(d.x=s.bQ(d.x,0,1)),this._position=d}else this._position=null}lookAtPoint(a,d){if(this.orientation=null,!this.position)return;const v=this.position,S=this._elevation?this._elevation.getAtPointOrZero(s.ac.fromLngLat(a)):0,A=s.ac.fromLngLat(a,S),P=[A.x-v.x,A.y-v.y,A.z-v.z];d||(d=[0,0,1]),d[2]=Math.abs(d[2]),this.orientation=kc(P,d)}setPitchBearing(a,d){this.orientation=su(s.al(a),s.al(-d))}}class xl{constructor(a,d){this._transform=s.bx([]),this.orientation=d,this.position=a}get mercatorPosition(){const a=this.position;return new s.ac(a[0],a[1],a[2])}get position(){const a=s.c6(this._transform,3);return[a[0],a[1],a[2]]}set position(a){var d;a&&s.cc(this._transform,3,[(d=a)[0],d[1],d[2],1])}get orientation(){return this._orientation}set orientation(a){this._orientation=a||s.c3([]),a&&xc(this._transform,this._orientation)}getPitchBearing(){const a=this.forward(),d=this.right();return{bearing:Math.atan2(-d[1],d[0]),pitch:Math.atan2(Math.sqrt(a[0]*a[0]+a[1]*a[1]),-a[2])}}setPitchBearing(a,d){this._orientation=su(a,d),xc(this._transform,this._orientation)}forward(){const a=s.c6(this._transform,2);return[-a[0],-a[1],-a[2]]}up(){const a=s.c6(this._transform,1);return[-a[0],-a[1],-a[2]]}right(){const a=s.c6(this._transform,0);return[a[0],a[1],a[2]]}getCameraToWorld(a,d){const v=new Float64Array(16);return s.bi(v,this.getWorldToCamera(a,d)),v}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(a,d,v){const S=this.position;s.c1(S,S,-a);const A=new Float64Array(16);return s.bn(A,[v,v,v]),s.bo(A,A,S),A[10]*=d,A}getWorldToCamera(a,d){const v=new Float64Array(16),S=new Float64Array(4),A=this.position;return s.c7(S,this._orientation),s.c1(A,A,-a),s.c8(v,S),s.bo(v,v,A),v[1]*=-1,v[5]*=-1,v[9]*=-1,v[13]*=-1,v[8]*=d,v[9]*=d,v[10]*=d,v[11]*=d,v}getCameraToClipPerspective(a,d,v,S){const A=new Float64Array(16);return s.c9(A,a,d,v,S),A}getCameraToClipOrthographic(a,d,v,S,A,P){const O=new Float64Array(16);return s.ca(O,a,d,v,S,A,P),O}getDistanceToElevation(a,d=!1){const v=a===0?0:s.cb(a,d?s.aY(this.position[1]):this.position[1]),S=this.forward();return(v-this.position[2])/S[2]}clone(){return new xl([...this.position],[...this.orientation])}}const Uo={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class nh{constructor(a=0,d=0,v=0,S=0){if(isNaN(a)||a<0||isNaN(d)||d<0||isNaN(v)||v<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=d,this.left=v,this.right=S}interpolate(a,d,v){return d.top!=null&&a.top!=null&&(this.top=s.ai(a.top,d.top,v)),d.bottom!=null&&a.bottom!=null&&(this.bottom=s.ai(a.bottom,d.bottom,v)),d.left!=null&&a.left!=null&&(this.left=s.ai(a.left,d.left,v)),d.right!=null&&a.right!=null&&(this.right=s.ai(a.right,d.right,v)),this}getCenter(a,d){const v=s.ay((this.left+a-this.right)/2,0,a),S=s.ay((this.top+d-this.bottom)/2,0,d);return new s.P(v,S)}equals(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right}clone(){return new nh(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Ya=15;class wv{constructor(a,d,v,S,A,P,O){this.tileSize=512,this._renderWorldCopies=A===void 0||A,this._minZoom=a||0,this._maxZoom=d||22,this._minPitch=v??0,this._maxPitch=S??60,this.setProjection(P),this.setMaxBounds(O),this.width=0,this.height=0,this._center=new s.ci(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new nh,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new xl,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const a=new wv(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return a._elevation=this._elevation,a._centerAltitude=this._centerAltitude,a._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,a.tileSize=this.tileSize,a.mercatorFromTransition=this.mercatorFromTransition,a.width=this.width,a.height=this.height,a.cameraElevationReference=this.cameraElevationReference,a._center=this._center,a._setZoom(this.zoom),a._seaLevelZoom=this._seaLevelZoom,a.angle=this.angle,a._fov=this._fov,a._pitch=this._pitch,a._nearZ=this._nearZ,a._farZ=this._farZ,a._averageElevation=this._averageElevation,a._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,a._unmodified=this._unmodified,a._edgeInsets=this._edgeInsets.clone(),a._camera=this._camera.clone(),a._calcMatrices(),a.freezeTileCoverage=this.freezeTileCoverage,a.frustumCorners=this.frustumCorners,a._allowWorldUnderZoom=this._allowWorldUnderZoom,a}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<Ya}get elevation(){return this._elevation}set elevation(a){this._elevation!==a&&(this._elevation=a,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(a,d=!1){const v=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||v)&&this._updateCameraOnTerrain(),(a||v)&&this._constrainCamera(d),this._calcMatrices()}getProjection(){return s.aF(this.projection,["name","center","parallels"])}setProjection(a){this.projectionOptions=a||{name:"mercator"};const d=this.projection?this.getProjection():void 0;this.projection=s.cj(this.projectionOptions);const v=this.getProjection(),S=!s.bv(d,v);return S&&this._calcMatrices(),this.mercatorFromTransition=!1,S}setOrthographicProjectionAtLowPitch(a){return this._orthographicProjectionAtLowPitch!==a&&(this._orthographicProjectionAtLowPitch=a,this._calcMatrices(),!0)}setMercatorFromTransition(){const a=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.cj({name:"mercator"});const d=a!==this.projection.name;return d&&this._calcMatrices(),d}get minZoom(){return this._minZoom}set minZoom(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))}get maxZoom(){return this._maxZoom}set maxZoom(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))}get minPitch(){return this._minPitch}set minPitch(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))}get maxPitch(){return this._maxPitch}set maxPitch(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(a){a===void 0?a=!0:a===null&&(a=!1),this._renderWorldCopies=a}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const a=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(a))}get cameraWorldSize(){const a=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(a))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.cb(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this.width,this.height)}get bearing(){return s.bQ(this.rotation,-180,180)}set bearing(a){this.rotation=a}get rotation(){return-this.angle/Math.PI*180}set rotation(a){const d=-a*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=s.ck(),s.cl(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(a){const d=s.ay(a,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=s.al(a),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const a=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/a)}get averageElevation(){return this._averageElevation}set averageElevation(a){this._averageElevation=a,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(a){const d=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._setZoom(d),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(a){this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(a){this._tileCoverLift!==a&&(this._tileCoverLift=a)}_updateCameraOnTerrain(){const a=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,d=this.elevation&&a===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||a===Number.NEGATIVE_INFINITY&&(!d||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const v=this._elevation;d||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&v.exaggeration()&&this._centerAltitudeValidForExaggeration!==v.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*v.exaggeration(),this._centerAltitudeValidForExaggeration=v.exaggeration()):(this._centerAltitude=a||0,this._centerAltitudeValidForExaggeration=v.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){if(this._centerAltitudeValidForExaggeration===void 0)return;const a=Math.max(0,(this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize);this._seaLevelZoom=this._zoomFromMercatorZ(a)}sampleAverageElevation(){if(!this._elevation)return 0;const a=this._elevation,d=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],v=this.horizonLineFromTop();let S=0,A=0;for(let P=0;P<d.length;P++){const O=new s.P(d[P][0]*this.width,v+d[P][1]*(this.height-v)),I=a.pointCoordinate(O);if(!I)continue;const H=1/Math.hypot(I[0]-this._camera.position[0],I[1]-this._camera.position[1]);S+=I[3]*H,A+=H}return A===0?NaN:S/A}get center(){return this._center}set center(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const a=this._seaLevelZoom,d=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),v=this.pixelsPerMeter/this.worldSize*d,S=this._mercatorZfromZoom(a),A=this._mercatorZfromZoom(this._maxZoom),P=Math.max(S-v,A);this._setZoom(this._zoomFromMercatorZ(P))}get padding(){return this._edgeInsets.toJSON()}set padding(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())}computeZoomRelativeTo(a){const d=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,a.toAltitude()));let v;v=a.z<this._camera.position[2]?[d.x,d.y,d.z]:[a.x,a.y,a.z];const S=s.ae(s.at([],this._camera.position,v));return s.ay(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(a){if(!this.height||!a.position&&!a.orientation)return;this._updateCameraState();let d=!1;if(a.orientation&&!s.cm(a.orientation,this._camera.orientation)&&(d=this._setCameraOrientation(a.orientation)),a.position){const v=[a.position.x,a.position.y,a.position.z];s.cn(v,this._camera.position)||(this._setCameraPosition(v),d=!0)}d&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const a=this._camera.position,d=new Xf;return d.position=new s.ac(a[0],a[1],a[2]),d.orientation=this._camera.orientation,d._elevation=this.elevation,d._renderWorldCopies=this.renderWorldCopies,d}_setCameraOrientation(a){if(!s.co(a))return!1;s.cp(a,a);const d=s.cq([],[0,0,-1],a),v=s.cq([],[0,-1,0],a);if(v[2]<0)return!1;const S=kc(d,v);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(a){const d=this.zoomScale(this.minZoom)*this.tileSize,v=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;a[2]=s.ay(a[2],S/v,S/d),this._camera.position=a}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(a){return this._edgeInsets.equals(a)}interpolatePadding(a,d,v){this._unmodified=!1,this._edgeInsets.interpolate(a,d,v),this._constrain(),this._calcMatrices()}coveringZoomLevel(a){const d=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(a){const d=[new s.cr(0,a)];if(this.renderWorldCopies){const v=this.pointCoordinate(new s.P(0,0)),S=this.pointCoordinate(new s.P(this.width,0)),A=this.pointCoordinate(new s.P(this.width,this.height)),P=this.pointCoordinate(new s.P(0,this.height)),O=Math.floor(Math.min(v.x,S.x,A.x,P.x)),I=Math.floor(Math.max(v.x,S.x,A.x,P.x)),H=1;for(let G=O-H;G<=I+H;G++)G!==0&&d.push(new s.cr(G,a))}return d}isLODDisabled(a){return(!a||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(a,d,v){let S=[];const A=v!=null,P=!A;if(P&&this.zoom<d||A&&v[0]===0&&v[1]===0)return S;const O=new Set,I=(G,ne,J,re,de)=>{const ce=s.cV(ne,G,J,re,de);O.has(ce)||(S.push(new s.aM(G,ne,J,re,de)),O.add(ce))};for(let G=0;G<a.length;G++){const ne=a[G];if(P&&ne.canonical.z!==d)continue;const J=ne.canonical,re=ne.overscaledZ,de=ne.wrap,ce=1<<J.z,pe=J.x+1<ce,me=J.x>0,be=J.y+1<ce,Ne=J.y>0,De=ne.wrap-(me?0:1),Be=ne.wrap+(pe?0:1),Ze=me?J.x-1:ce-1,Ye=pe?J.x+1:0;if(A)v[0]<0?(I(re,Be,J.z,Ye,J.y),v[1]<0&&be&&(I(re,de,J.z,J.x,J.y+1),I(re,Be,J.z,Ye,J.y+1)),v[1]>0&&Ne&&(I(re,de,J.z,J.x,J.y-1),I(re,Be,J.z,Ye,J.y-1))):v[0]>0?(I(re,De,J.z,Ze,J.y),v[1]<0&&be&&(I(re,de,J.z,J.x,J.y+1),I(re,De,J.z,Ze,J.y+1)),v[1]>0&&Ne&&(I(re,de,J.z,J.x,J.y-1),I(re,De,J.z,Ze,J.y-1))):v[1]<0&&be?I(re,de,J.z,J.x,J.y+1):Ne&&I(re,de,J.z,J.x,J.y-1);else{const Ue=ne.visibleQuadrants;1&Ue&&(I(re,De,J.z,Ze,J.y),Ne&&(I(re,de,J.z,J.x,J.y-1),I(re,De,J.z,Ze,J.y-1))),2&Ue&&(I(re,Be,J.z,Ye,J.y),Ne&&(I(re,de,J.z,J.x,J.y-1),I(re,Be,J.z,Ye,J.y-1))),4&Ue&&(I(re,De,J.z,Ze,J.y),be&&(I(re,de,J.z,J.x,J.y+1),I(re,De,J.z,Ze,J.y+1))),8&Ue&&(I(re,Be,J.z,Ye,J.y),be&&(I(re,de,J.z,J.x,J.y+1),I(re,Be,J.z,Ye,J.y+1)))}}const H=[];for(const G of S)S.some((ne=>G.isChildOf(ne)))||H.push(G);if(S=H.filter((G=>!a.some((ne=>!!(G.overscaledZ<d&&ne.isChildOf(G))||G.equals(ne)||G.isChildOf(ne))))),P){const G=1<<d,ne=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),J=[G*ne.x,G*ne.y],re=4,de=re*re;S=S.filter((ce=>{const pe=ce.canonical.x+.5-J[0],me=ce.canonical.y+.5-J[1];return pe*pe+me*me<de}))}return S}extendTileCoverToNearPlane(a,d,v){const S=[],A=new Set;for(const be of a)A.add(be.key);const P=(be,Ne,De,Be,Ze)=>{const Ye=s.cV(Ne,be,De,Be,Ze);A.has(Ye)||(S.push(new s.aM(be,Ne,De,Be,Ze)),A.add(Ye))},O=a.reduce(((be,Ne)=>Math.max(be,Ne.overscaledZ)),v),I=1<<v,H=[new s.P(0,0),new s.P(s.aj,0),new s.P(s.aj,s.aj),new s.P(0,s.aj)],G=new s.P(0,0),ne=new s.P(0,0),J=(be,Ne)=>{const De=Math.floor(be[0]),Be=Math.floor(be[1]),Ze=(be[0]-De)*s.aj,Ye=(be[1]-Be)*s.aj,Ue=Math.floor(Ne[0]),qe=Math.floor(Ne[1]),Ge=(Ne[0]-Ue)*s.aj,_t=(Ne[1]-qe)*s.aj;for(let ct=-1;ct<=1;ct++){const Bt=De+ct;if(!(Bt<0||Bt>=I)){G.x=Ze-ct*s.aj,ne.x=Ge-(Bt-Ue)*s.aj;for(let Ct=-1;Ct<=1;Ct++){const Xt=Be+Ct;G.y=Ye-Ct*s.aj,ne.y=_t-(Xt-qe)*s.aj,s.cW(G,ne,H)&&P(O,0,v,Bt,Xt)}}}},re=d.points,de=re[s.cs],ce=re[s.ct],pe=this._projectToGround(de,re[s.cu]),me=this._projectToGround(ce,re[s.cv]);return J(de,pe),J(ce,me),S}_projectToGround(a,d){return s.cw(s.cx(),a,d,a[2]/(a[2]-d[2]))}coveringTiles(a){let d=this.coveringZoomLevel(a);const v=d,S=this.elevation&&this.elevation.exaggeration(),A=S&&!a.isTerrainDEM,P=this.projection.name==="mercator";if(a.minzoom!==void 0&&d<a.minzoom)return[];a.maxzoom!==void 0&&d>a.maxzoom&&(d=a.maxzoom);const O=this.locationCoordinate(this.center),I=this.center.lat,H=1<<d,G=[H*O.x,H*O.y,0],ne=this.projection.name==="globe",J=!ne,re=s.cy.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d,J),de=ne?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ce=H*s.cb(1,this.center.lat),pe=this._camera.position[2]/s.cb(1,this.center.lat),me=[H*de.x,H*de.y,pe*(J?1:ce)],be=ne||S,Ne=this.cameraToCenterDistance/a.tileSize*(a.roundZoom?1:.502),De=this.isLODDisabled(!0)?d:0;let Be;if(this._elevation&&a.isTerrainDEM)Be=1e4*this._elevation.exaggeration();else if(this._elevation){const at=this._elevation.getMinMaxForVisibleTiles();Be=at?at.max:this._centerAltitude}else Be=this._centerAltitude;const Ze=a.isTerrainDEM?-Be:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ye=this.projection.isReprojectedInTileSpace?s.cz(this):1,Ue=at=>{const At=new s.ac(at.x+25e-6,at.y,at.z),Gt=new s.ac(at.x,at.y+25e-6,at.z),Yt=at.toLngLat(),Ht=At.toLngLat(),en=Gt.toLngLat(),Pn=this.locationCoordinate(Yt),Kn=this.locationCoordinate(Ht),In=this.locationCoordinate(en),rr=Math.hypot(Kn.x-Pn.x,Kn.y-Pn.y),ar=Math.hypot(In.x-Pn.x,In.y-Pn.y);return Math.sqrt(rr*ar)*Ye/25e-6},qe=at=>{const Dt=Be,At=Ze;return{aabb:s.cC(this,H,0,0,0,at,At,Dt,this.projection),zoom:0,x:0,y:0,minZ:At,maxZ:Dt,wrap:at,fullyVisible:!1}},Ge=[];let _t=[];const ct=d,Bt=a.reparseOverscaled?v:d,Ct=(pe-this._centerAltitude)*ce,Xt=at=>{if(!this._elevation||!at.tileID||!P)return;const Dt=this._elevation.getMinMaxForTile(at.tileID),At=at.aabb;Dt?(At.min[2]=Dt.min,At.max[2]=Dt.max,At.center[2]=(At.min[2]+At.max[2])/2):(at.shouldSplit=wt(at),at.shouldSplit||(At.min[2]=At.max[2]=At.center[2]=this._centerAltitude))},gn=(at,Dt)=>{if(.707*Dt<at)return 1;const At=Dt/at;return At/(1.4144271570014144+(Math.pow(1.1,At-1.4144271570014144+1)-1)/(1.1-1)-1)},wt=at=>{if(at.zoom<De)return!0;if(at.zoom===ct)return!1;if(at.shouldSplit!=null)return at.shouldSplit;const Dt=at.aabb.distanceX(me),At=at.aabb.distanceY(me);let Gt=Ct,Yt=1;if(ne){Gt=at.aabb.distanceZ(me);const ar=Math.pow(2,at.zoom),Er=s.aY((at.y+1)/ar),Tr=s.aY(at.y/ar),Zr=Math.min(Math.max(I,Er),Tr),ji=s.c_(Zr)/s.c_(I);if(Yt=Zr===I?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,ji/this._mercatorScaleRatio),this.zoom<=s.cX&&at.zoom===ct-1&&ji>=.9)return!0}else if(A&&(Gt=at.aabb.distanceZ(me)*ce),this.projection.isReprojectedInTileSpace&&v<=5){const ar=Math.pow(2,at.zoom),Er=Ue(new s.ac((at.x+.5)/ar,(at.y+.5)/ar));Yt=Er>.85?1:Er}if(!P){const ar=Math.sqrt(Dt*Dt+At*At+Gt*Gt);let Er=(1<<ct-at.zoom)*Ne*Yt;return Er*=gn(Math.max(Gt,Ct),ar),ar<Er}let Ht=Number.MAX_VALUE,en=0;const Pn=at.aabb.getCorners(),Kn=[];for(const ar of Pn){s.at(Kn,ar,me),ne||(A?Kn[2]*=ce:Kn[2]=Ct);const Er=s.bG(Kn,this._camera.forward());Er<Ht&&(Ht=Er,en=Math.abs(Kn[2]))}let In=(1<<ct-at.zoom)*Ne*Yt;if(In*=gn(Math.max(en,Ct),Ht),Ht<In)return!0;const rr=at.aabb.closestPoint(G);return rr[0]===G[0]&&rr[1]===G[1]};if(this.renderWorldCopies)for(let at=1;at<=3;at++)Ge.push(qe(-at)),Ge.push(qe(at));for(Ge.push(qe(0));Ge.length>0;){const at=Ge.pop(),Dt=at.x,At=at.y;let Gt=at.fullyVisible;const Yt=()=>this.projection.name==="globe"&&(at.y===0||at.y===(1<<at.zoom)-1);if(!Gt){let Ht=be?at.aabb.intersects(re):at.aabb.intersectsFlat(re);if(Ht===0&&Yt()){const en=new s.cA(at.zoom,Dt,At);Ht=s.cB(this,H,en,!0).intersects(re)}if(Ht===0)continue;Gt=Ht===2}if(at.zoom!==ct&&wt(at))for(let Ht=0;Ht<4;Ht++){const en=(Dt<<1)+Ht%2,Pn=(At<<1)+(Ht>>1),Kn={aabb:P?at.aabb.quadrant(Ht):s.cC(this,H,at.zoom+1,en,Pn,at.wrap,at.minZ,at.maxZ,this.projection),zoom:at.zoom+1,x:en,y:Pn,wrap:at.wrap,fullyVisible:Gt,tileID:void 0,shouldSplit:void 0,minZ:at.minZ,maxZ:at.maxZ};A&&!ne&&(Kn.tileID=new s.aM(at.zoom+1===ct?Bt:at.zoom+1,at.wrap,at.zoom+1,en,Pn),Xt(Kn)),Ge.push(Kn)}else{const Ht=at.zoom===ct?Bt:at.zoom;if(a.minzoom&&a.minzoom>Ht)continue;let en=0;if(!Gt){let rr=be?at.aabb.intersectsPrecise(re):at.aabb.intersectsPreciseFlat(re);if(rr===0&&Yt()){const ar=new s.cA(at.zoom,Dt,At);rr=s.cB(this,H,ar,!0).intersectsPrecise(re)}if(rr===0)continue;if(a.calculateQuadrantVisibility)if(re.containsPoint(at.aabb.center))en=15;else for(let ar=0;ar<4;ar++)at.aabb.quadrant(ar).intersects(re)!==0&&(en|=1<<ar)}const Pn=G[0]-(.5+Dt+(at.wrap<<at.zoom))*(1<<d-at.zoom),Kn=G[1]-.5-At,In=at.tileID?at.tileID:new s.aM(Ht,at.wrap,at.zoom,Dt,At);a.calculateQuadrantVisibility&&(In.visibleQuadrants=en),_t.push({tileID:In,distanceSq:Pn*Pn+Kn*Kn})}}if(this.fogCullDistSq){const at=this.fogCullDistSq,Dt=this.horizonLineFromTop();_t=_t.filter((At=>{const Gt=[0,0,0,1],Yt=[s.aj,s.aj,0,1],Ht=this.calculateFogTileMatrix(At.tileID.toUnwrapped());s.aA(Gt,Gt,Ht),s.aA(Yt,Yt,Ht);const en=s.cD([],Gt,Yt),Pn=s.cE([],Gt,Yt),Kn=s.cY(en,Pn);if(Kn===0)return!0;let In=!1;const rr=this._elevation;if(rr&&Kn>at&&Dt!==0){const ar=this.calculateProjMatrix(At.tileID.toUnwrapped());let Er;a.isTerrainDEM||(Er=rr.getMinMaxForTile(At.tileID)),Er||(Er={min:Ze,max:Be});const Tr=s.cF(this.rotation),Zr=[Tr[0]*s.aj,Tr[1]*s.aj,Er.max];s.ad(Zr,Zr,ar),In=(1-Zr[1])*this.height*.5<Dt}return Kn<at||In}))}return _t.sort(((at,Dt)=>at.distanceSq-Dt.distanceSq)).map((at=>at.tileID))}resize(a,d){this.width=a,this.height=d,this.pixelsToGLUnits=[2/a,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(a){return Math.pow(2,a)}scaleZoom(a){return Math.log(a)/Math.LN2}project(a){const d=s.ay(a.lat,-s.cG,s.cG),v=this.projection.project(a.lng,d);return new s.P(v.x*this.worldSize,v.y*this.worldSize)}unproject(a){return this.projection.unproject(a.x/this.worldSize,a.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.cb(1,this.center.lat)/this.worldSize}setLocationAtPoint(a,d){let v,S;const A=this.centerPoint;if(this.projection.name==="globe"){const O=this.worldSize;v=(d.x-A.x)/O,S=(d.y-A.y)/O}else{const O=this.pointCoordinate(d),I=this.pointCoordinate(A);v=O.x-I.x,S=O.y-I.y}const P=this.locationCoordinate(a);this.setLocation(new s.ac(P.x-v,P.y-S))}setLocation(a){this.center=this.coordinateLocation(a),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(a,d){return this.projection.locationPoint(this,a,d)}locationPoint3D(a,d){return this.projection.locationPoint(this,a,d,!0)}pointLocation(a){return this.coordinateLocation(this.pointCoordinate(a))}pointLocation3D(a,d){return this.coordinateLocation(this.pointCoordinate3D(a,d))}locationCoordinate(a,d){const v=d?s.cb(d,a.lat):void 0,S=this.projection.project(a.lng,a.lat);return new s.ac(S.x,S.y,v)}coordinateLocation(a){return this.projection.unproject(a.x,a.y)}pointRayIntersection(a,d){const v=d??this._centerAltitude,S=[a.x,a.y,0,1],A=[a.x,a.y,1,1];s.aA(S,S,this.pixelMatrixInverse),s.aA(A,A,this.pixelMatrixInverse);const P=A[3];s.cH(S,S,1/S[3]),s.cH(A,A,1/P);const O=S[2],I=A[2];return{p0:S,p1:A,t:O===I?0:(v-O)/(I-O)}}screenPointToMercatorRay(a){const d=[a.x,a.y,0,1],v=[a.x,a.y,1,1];return s.aA(d,d,this.pixelMatrixInverse),s.aA(v,v,this.pixelMatrixInverse),s.cH(d,d,1/d[3]),s.cH(v,v,1/v[3]),d[2]=s.cb(d[2],this._center.lat)*this.worldSize,v[2]=s.cb(v[2],this._center.lat)*this.worldSize,s.cH(d,d,1/this.worldSize),s.cH(v,v,1/this.worldSize),new s.av([d[0],d[1],d[2]],s.au([],s.at([],v,d)))}rayIntersectionCoordinate(a){const{p0:d,p1:v,t:S}=a,A=s.cb(d[2],this._center.lat),P=s.cb(v[2],this._center.lat);return new s.ac(s.ai(d[0],v[0],S)/this.worldSize,s.ai(d[1],v[1],S)/this.worldSize,s.ai(A,P,S))}pointCoordinate(a,d=this._centerAltitude){return this.projection.pointCoordinate(this,a.x,a.y,d)}pointCoordinate3D(a,d){if(!this.elevation)return this.pointCoordinate(a,d);let v=this.projection.pointCoordinate3D(this,a.x,a.y);if(v)return new s.ac(v[0],v[1],v[2]);let S=0,A=this.horizonLineFromTop();if(a.y>A)return this.pointCoordinate(a,d);const P=.02*A,O=a.clone();for(let I=0;I<10&&A-S>P;I++){O.y=s.ai(S,A,.66);const H=this.projection.pointCoordinate3D(this,O.x,O.y);H?(A=O.y,v=H):S=O.y}return v?new s.ac(v[0],v[1],v[2]):this.pointCoordinate(a)}isPointAboveHorizon(a){return this.projection.isPointAboveHorizon(this,a)}isPointOnSurface(a){if(a.y<0||a.y>this.height||a.x<0||a.x>this.width)return!1;if(this.elevation||this.zoom>=s.cI)return!this.isPointAboveHorizon(a);const d=this.pointCoordinate(a);return d.y>=0&&d.y<=1}_coordinatePoint(a,d){const v=d&&this.elevation?this.elevation.getAtPointOrZero(a,this._centerAltitude):this._centerAltitude,S=[a.x*this.worldSize,a.y*this.worldSize,v+a.toAltitude(),1];return s.aA(S,S,this.pixelMatrix),S[3]>0?new s.P(S[0]/S[3],S[1]/S[3]):new s.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:a,left:d}=this._edgeInsets,v=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,A=this.pointLocation3D(new s.P(d,a)),P=this.pointLocation3D(new s.P(S,a)),O=this.pointLocation3D(new s.P(S,v)),I=this.pointLocation3D(new s.P(d,v));let H=Math.min(A.lng,P.lng,O.lng,I.lng),G=Math.max(A.lng,P.lng,O.lng,I.lng),ne=Math.min(A.lat,P.lat,O.lat,I.lat),J=Math.max(A.lat,P.lat,O.lat,I.lat);const re=Math.pow(2,-this.zoom)/16*270,de=this.projection.name==="globe"?1:4,ce=(pe,me,be,Ne,De)=>{const Be=(pe+be)/2,Ze=(me+Ne)/2,Ye=new s.P(Be,Ze),{lng:Ue,lat:qe}=this.pointLocation3D(Ye),Ge=Math.max(0,H-Ue,ne-qe,Ue-G,qe-J);H=Math.min(H,Ue),G=Math.max(G,Ue),ne=Math.min(ne,qe),J=Math.max(J,qe),(De<de||Ge>re)&&(ce(pe,me,Be,Ze,De+1),ce(Be,Ze,be,Ne,De+1))};if(ce(d,a,S,a,1),ce(S,a,S,v,1),ce(S,v,d,v,1),ce(d,v,d,a,1),this.projection.name==="globe"){const[pe,me]=s.cJ(this);pe?(J=90,G=180,H=-180):me&&(ne=-90,G=180,H=-180)}return new s.aG(new s.ci(H,ne),new s.ci(G,J))}_getBoundsRectangular(a,d){const{top:v,left:S}=this._edgeInsets,A=this.height-this._edgeInsets.bottom,P=this.width-this._edgeInsets.right,O=new s.P(S,v),I=new s.P(P,v),H=new s.P(P,A),G=new s.P(S,A);let ne=this.pointCoordinate(O,a),J=this.pointCoordinate(I,a);const re=this.pointCoordinate(H,d),de=this.pointCoordinate(G,d),ce=(pe,me)=>(me.y-pe.y)/(me.x-pe.x);return ne.y>1&&J.y>=0?ne=new s.ac((1-de.y)/ce(de,ne)+de.x,1):ne.y<0&&J.y<=1&&(ne=new s.ac(-de.y/ce(de,ne)+de.x,0)),J.y>1&&ne.y>=0?J=new s.ac((1-re.y)/ce(re,J)+re.x,1):J.y<0&&ne.y<=1&&(J=new s.ac(-re.y/ce(re,J)+re.x,0)),new s.aG().extend(this.coordinateLocation(ne)).extend(this.coordinateLocation(J)).extend(this.coordinateLocation(de)).extend(this.coordinateLocation(re))}_getBoundsRectangularTerrain(){const a=this.elevation;if(!a.visibleDemTiles.length||a.isUsingMockSource())return this._getBoundsRectangular(0,0);const d=a.visibleDemTiles.reduce(((v,S)=>{if(S.dem){const A=S.dem.tree;v.min=Math.min(v.min,A.minimums[0]),v.max=Math.max(v.max,A.maximums[0])}return v}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(d.min*a.exaggeration(),d.max*a.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(a=!0){const d=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,v=this.height/2-d*(1-this._horizonShift);return a?Math.max(0,v):v}getMaxBounds(){return this.maxBounds}setMaxBounds(a){this.maxBounds=a,this.minLat=-s.cG,this.maxLat=s.cG,this.minLng=-180,this.maxLng=180,a&&(this.minLat=a.getSouth(),this.maxLat=a.getNorth(),this.minLng=a.getWest(),this.maxLng=a.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.aD(this.minLng)*this.tileSize,this.worldMaxX=s.aD(this.maxLng)*this.tileSize,this.worldMinY=s.aH(this.maxLat)*this.tileSize,this.worldMaxY=s.aH(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(a,d){return this.projection.createTileMatrix(this,d,a)}calculateDistanceTileData(a){const d=a.key,v=this._distanceTileDataCache;if(v[d])return v[d];const S=a.canonical,A=1/this.height,P=this.cameraWorldSize,O=P/this.zoomScale(S.z),I=(S.x+Math.pow(2,S.z)*a.wrap)*O,H=S.y*O,G=this.point;G.x*=P/this.worldSize,G.y*=P/this.worldSize;const ne=this.angle,J=Math.sin(-ne),re=-Math.cos(-ne);return v[d]={bearing:[J,re],center:[(G.x-I)*A,(G.y-H)*A],scale:O/s.aj*A},v[d]}calculateFogTileMatrix(a){const d=a.key,v=this._fogTileMatrixCache;if(v[d])return v[d];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,a);return s.az(S,this.worldToFogMatrix,S),v[d]=new Float32Array(S),v[d]}calculateProjMatrix(a,d=!1,v=!1){const S=a.key;let A;if(A=v?this._expandedProjMatrixCache:d?this._alignedProjMatrixCache:this._projMatrixCache,A[S])return A[S];const P=this.calculatePosMatrix(a,this.worldSize);let O;return O=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:v?this.expandedFarZProjMatrix:d?this.alignedProjMatrix:this.projMatrix,s.az(P,O,P),A[S]=new Float32Array(P),A[S]}calculatePixelsToTileUnitsMatrix(a){const d=a.tileID.key,v=this._pixelsToTileUnitsCache;if(v[d])return v[d];const S=s.cK(a,this);return v[d]=S,v[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const a=1/this.worldSize,d=s.bn([],[a,a,a]);return s.az(d,d,this.globeMatrix),d}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const a=this._elevation;this._updateCameraState();const d=s.cb(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(d),S=this._camera.forward(),A=s.cb(1,this._center.lat);v[2]/=A,S[2]/=A,s.au(S,S);const P=a.raycast(v,S,a.exaggeration());if(P){const O=s.bE([],v,S,P),I=new s.ac(O[0],O[1],s.cb(O[2],s.aY(O[1]))),H=(I.z+s.ae([I.x-v[0],I.y-v[1],I.z-v[2]*A]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(H),this._centerAltitude=I.toAltitude(),this._center=this.coordinateLocation(I),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(a=!1){if(!this._elevation)return;const d=this._elevation,v=s.cb(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(v),A=d.getAtPointOrZero(new s.ac(...S)),P=this.pixelsPerMeter/this.worldSize*A,O=this._minimumHeightOverTerrain(),I=S[2]-P;if(I<=O)if(I<0||a){const H=this.locationCoordinate(this._center,this._centerAltitude),G=[S[0],S[1],H.z-S[2]],ne=s.ae(G);G[2]-=(O-I)/this._pixelsPerMercatorPixel;const J=s.ae(G);if(J===0)return;s.c1(G,G,ne/J*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],H.z*this._pixelsPerMercatorPixel-G[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const a=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||a){const J=this.center;return J.lat=s.ay(J.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!a)&&(J.lng=s.ay(J.lng,this.minLng,this.maxLng)),this.center=J,void(this._constraining=!1)}const d=this._unmodified,{x:v,y:S}=this.point;let A=0,P=v,O=S;const I=this.width/2,H=this.height/2,G=this.worldMinY*this.scale,ne=this.worldMaxY*this.scale;if(S-H<G&&(O=G+H),S+H>ne&&(O=ne-H),ne-G<this.height&&(A=Math.max(A,this.height/(ne-G)),O=(ne+G)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const J=this.worldMinX*this.scale,re=this.worldMaxX*this.scale,de=this.worldSize/2-(J+re)/2;P=(v+de+this.worldSize)%this.worldSize-de,P-I<J&&(P=J+I),P+I>re&&(P=re-I),re-J<this.width&&(A=Math.max(A,this.width/(re-J)),P=(re+J)/2)}P===v&&O===S||this._allowWorldUnderZoom||(this.center=this.unproject(new s.P(P,O))),A&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(A)),this._constrainCamera(),this._unmodified=d,this._constraining=!1}_minZoomForBounds(){let a=Math.max(0,this.scaleZoom(Math.max(0,this.height)/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(a=Math.max(a,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),a}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const a=this.centerOffset,d=this.projection.name==="globe",v=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.cb(1,this.center.lat)/s.cb(1,s.c$));const S=s.cL(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,S),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const A=this.projection.zAxisUnit==="meters"?v:1,P=this._camera.getWorldToCamera(this.worldSize,A);let O;const I=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(I[8]=2*-a.x/this.width,I[9]=2*a.y/this.height,this.isOrthographic){let qe=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Ge=qe*this.aspect,_t=-Ge,ct=-qe;Ge-=a.x,_t-=a.x,qe+=a.y,ct+=a.y,O=this._camera.getCameraToClipOrthographic(_t,Ge,ct,qe,this._nearZ,this._farZ),((Bt,Ct,Xt,gn)=>{for(let wt=0;wt<16;wt++)Bt[wt]=s.ai(Ct[wt],Xt[wt],gn)})(O,O,I,s.cZ(this.pitch>=Ya?1:this.pitch/Ya))}else O=I;const H=s.cM([],I,P);let G=s.cM([],O,P);if(this.projection.isReprojectedInTileSpace){const qe=this.locationCoordinate(this.center),Ge=s.bx([]);s.bo(Ge,Ge,[qe.x*this.worldSize,qe.y*this.worldSize,0]),s.az(Ge,Ge,s.cN(this)),s.bo(Ge,Ge,[-qe.x*this.worldSize,-qe.y*this.worldSize,0]),s.az(G,G,Ge),s.az(H,H,Ge),this.inverseAdjustmentMatrix=s.cO(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=s.cP([],G,[this.worldSize,this.worldSize,this.worldSize/A,1]),this.projMatrix=G,this.invProjMatrix=s.bi(new Float64Array(16),this.projMatrix),d){const qe=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);qe[8]=2*-a.x/this.width,qe[9]=2*a.y/this.height,this.expandedFarZProjMatrix=s.cM([],qe,P)}else this.expandedFarZProjMatrix=this.projMatrix;const ne=s.bi([],O);this.frustumCorners=s.cQ.fromInvProjectionMatrix(ne,this.horizonLineFromTop(),this.height),this.cameraFrustum=s.cy.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!d);const J=new Float32Array(16);s.bx(J),s.cP(J,J,[1,-1,1]),s.cR(J,J,this._pitch),s.by(J,J,this.angle);const re=s.c9(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=s.bw(re);const de=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;re[8]=2*-a.x/this.width,re[9]=2*(a.y+de)/this.height,this.skyboxMatrix=s.az(J,re,J);const ce=this.point,pe=ce.x,me=ce.y,be=this.width%2/2,Ne=this.height%2/2,De=Math.cos(this.angle),Be=Math.sin(this.angle),Ze=pe-Math.round(pe)+De*be+Be*Ne,Ye=me-Math.round(me)+De*Ne+Be*be,Ue=new Float64Array(G);if(s.bo(Ue,Ue,[Ze>.5?Ze-1:Ze,Ye>.5?Ye-1:Ye,0]),this.alignedProjMatrix=Ue,G=s.bz(),s.cP(G,G,[this.width/2,-this.height/2,1]),s.bo(G,G,[1,-1,0]),this.labelPlaneMatrix=G,G=s.bz(),s.cP(G,G,[1,-1,1]),s.bo(G,G,[-1,-1,0]),s.cP(G,G,[2/this.width,2/this.height,1]),this.glCoordMatrix=G,this.pixelMatrix=s.az(new Float64Array(16),this.labelPlaneMatrix,H),this._calcFogMatrices(),this._distanceTileDataCache={},G=s.bi(new Float64Array(16),this.pixelMatrix),!G)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=G,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.cS(this);const qe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.ad(qe,qe,P),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=G;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const a=this.cameraWorldSizeForFog,d=this.cameraPixelsPerMeter,v=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,A=[a,a,d];s.c1(A,A,S),s.c1(v,v,-1),s.cT(v,v,A);const P=s.bz();s.bo(P,P,v),s.cP(P,P,A),this.mercatorFogMatrix=P,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(a,d,S)}_computeCameraPosition(a){const d=(a=a||this.pixelsPerMeter)/this.pixelsPerMeter,v=this._camera.forward(),S=this.point,A=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*d-a/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-v[0]*A,S.y/this.worldSize-v[1]*A,a/this.worldSize*this._centerAltitude-v[2]*A]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(a){const d=this._maxCameraBoundsDistance()*Math.cos(this._pitch),v=this._camera.position[2],S=a[2];let A=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(A=Math.min((d-v)/S,1)),this._camera.position=s.bE([],this._camera.position,a,A),this._updateStateFromCamera()}_updateStateFromCamera(){const a=this._camera.position,d=this._camera.forward(),{pitch:v,bearing:S}=this._camera.getPitchBearing(),A=s.cb(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,P=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.al(this._maxPitch)),O=Math.max((a[2]-A)/Math.cos(v),P),I=this._zoomFromMercatorZ(O);s.bE(a,a,d,O),this._pitch=s.ay(v,s.al(this.minPitch),s.al(this.maxPitch)),this.angle=s.bQ(S,-Math.PI,Math.PI),this._setZoom(s.ay(I,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.ac(a[0],a[1],a[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(a){return Math.pow(2,a)*this.tileSize}_mercatorZfromZoom(a){return this.cameraToCenterDistance/this._worldSizeFromZoom(a)}_minimumHeightOverTerrain(){const a=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(a)}_zoomFromMercatorZ(a){return this.scaleZoom(this.cameraToCenterDistance/(Math.max(0,a)*this.tileSize))}zoomFromMercatorZAdjusted(a){let d=0,v=s.cI,S=0,A=1/0;for(;v-d>1e-6&&v>d;){const P=d+.5*(v-d),O=this.tileSize*Math.pow(2,P),I=this.getCameraToCenterDistance(this.projection,P,O),H=this.scaleZoom(I/(Math.max(0,a)*this.tileSize)),G=Math.abs(P-H);G<A&&(A=G,S=P),P<H?d=P:v=P}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(a,d){const v=Math.min(a.x,d.x),S=Math.max(a.x,d.x),A=Math.min(a.y,d.y),P=Math.max(a.y,d.y);if(A<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const O=[new s.P(v,A),new s.P(S,P),new s.P(v,P),new s.P(S,A)],I=this.renderWorldCopies?-3:0,H=this.renderWorldCopies?4:1;for(const G of O){const ne=this.pointRayIntersection(G);if(ne.t<0)return!0;const J=this.rayIntersectionCoordinate(ne);if(J.x<I||J.y<0||J.x>H||J.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.cU(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.P(0,0),new s.P(this.width,this.height))}zoomDeltaToMovement(a,d){const v=s.ae(s.at([],this._camera.position,a)),S=this._zoomFromMercatorZ(v)+d;return v-this._mercatorZfromZoom(S)}getCameraPoint(){if(this.projection.name==="globe"){const a=(function([d,v,S],A){const P=[d,v,S,1];s.aA(P,P,A);const O=P[3]=Math.max(P[3],1e-6);return P[0]/=O,P[1]/=O,P[2]/=O,P})([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.P(a[0],a[1])}{const a=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(0,a))}}getCameraToCenterDistance(a,d=this.zoom,v=this.worldSize){const S=s.cL(a,d,this.width,this.height,1024),A=a.pixelSpaceConversion(this.center.lat,v,S);let P=.5/Math.tan(.5*this._fov)*this.height*A;return this.isOrthographic&&(P=s.ai(1,P,s.cZ(this.pitch>=Ya?1:this.pitch/Ya))),P}getWorldToCameraMatrix(){const a=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.az(a,a,this.globeMatrix),a}getFrustum(a){return s.cy.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a,this.projection.zAxisUnit==="meters")}}const Du=(y,a)=>{if(a>0&&y.terrain&&s.w("Cutoff is currently disabled on terrain"),a<=0||y.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const d=y.transform,v=Math.max(Math.abs(d._zoom-(y.minCutoffZoom-1)),1),S=d.isLODDisabled(!1)?s.af(60,45,d.pitch):s.af(30,15,d.pitch),A=d._farZ-d._nearZ,P=a*d.height,O=((1-(I=S))*d.cameraToCenterDistance+I*(d._farZ+P))*v;var I;return{shouldRenderCutoff:S<1,uniformValues:{u_cutoff_params:[d._nearZ,d._farZ,(O-d._nearZ)/A,(O-P-d._nearZ)/A]}}},il={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class mm{constructor(a,d){this.aabb=a,this.lastCascade=d}}class ew{add(a,d){const v=this.receivers[a.key];v!==void 0?(v.aabb.min[0]=Math.min(v.aabb.min[0],d.min[0]),v.aabb.min[1]=Math.min(v.aabb.min[1],d.min[1]),v.aabb.min[2]=Math.min(v.aabb.min[2],d.min[2]),v.aabb.max[0]=Math.max(v.aabb.max[0],d.max[0]),v.aabb.max[1]=Math.max(v.aabb.max[1],d.max[1]),v.aabb.max[2]=Math.max(v.aabb.max[2],d.max[2])):this.receivers[a.key]=new mm(d,null)}clear(){this.receivers={}}get(a){return this.receivers[a.key]}computeRequiredCascades(a,d,v){const S=s.d6.fromPoints(a.points);let A=0;for(const P in this.receivers){const O=this.receivers[P];if(!O||!S.intersectsAabb(O.aabb))continue;O.aabb.min=S.closestPoint(O.aabb.min),O.aabb.max=S.closestPoint(O.aabb.max);const I=O.aabb.getCorners();for(let H=0;H<v.length;H++){let G=!0;for(const ne of I){const J=[ne[0]*d,ne[1]*d,ne[2]];if(s.ad(J,J,v[H].matrix),J[0]<-1||J[0]>1||J[1]<-1||J[1]>1){G=!1;break}}if(O.lastCascade=H,A=Math.max(A,H),G)break}}return A+1}}class _c{constructor(a){this.painter=a,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new ew,this._depthMode=new Fn(a.context.gl.LEQUAL,Fn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,a.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},(()=>{this.painter.style.map.triggerRepaint()})),a.tp.registerParameter(il,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),a.tp.registerParameter(il,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),a.tp.registerParameter(il,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),a.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const a of this._cascades)a.texture.destroy(),a.framebuffer.destroy();this._cascades=[]}updateShadowParameters(a,d){const v=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!d||!d.properties)return;const S=d.properties.get("shadow-intensity");if(!d.shadowsEnabled()||S<=0||(this._shadowLayerCount=v.style.order.reduce(((de,ce)=>{const pe=v.style._mergedLayers[ce];return de+(pe.hasShadowPass()&&!pe.isHidden(a.zoom)?1:0)}),0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const A=v.context,P=il.shadowMapResolution,O=il.shadowMapResolution;if(this._cascades.length===0||il.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let de=0;de<il.cascadeCount;++de){const ce=v._shadowMapDebug,pe=A.gl,me=A.createFramebuffer(P,O,ce,"texture"),be=new s.T(A,{width:P,height:O,data:null},pe.DEPTH_COMPONENT16);if(me.depthAttachment.set(be.texture),ce){const Ne=new s.T(A,{width:P,height:O,data:null},pe.RGBA8);me.colorAttachment.set(Ne.texture)}this._cascades.push({framebuffer:me,texture:be,matrix:[],far:0,boundingSphereRadius:0,frustum:new s.cy,scale:0})}}this.shadowDirection=Xh(d);let I=0;if(a.elevation){const de=a.elevation,ce=[1e4,-1e4];de.visibleDemTiles.filter((pe=>pe.dem)).forEach((pe=>{const me=pe.dem.tree;ce[0]=Math.min(ce[0],me.minimums[0]),ce[1]=Math.max(ce[1],me.maximums[0])})),ce[0]!==1e4&&(I=(ce[1]-ce[0])*de.exaggeration())}const H=1.5*a.cameraToCenterDistance,G=3*H,ne=new Float64Array(16);for(let de=0;de<this._cascades.length;++de){const ce=this._cascades[de];let pe=a.height/50,me=1;il.cascadeCount===1?me=G:de===0?me=H:(pe=H,me=G);const[be,Ne]=Zh(a,this.shadowDirection,pe,me,il.shadowMapResolution,I);ce.scale=a.scale,ce.matrix=be,ce.boundingSphereRadius=Ne,s.bi(ne,ce.matrix),ce.frustum=s.cy.fromInvProjectionMatrix(ne,1,0,!0),ce.far=me}const J=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[J].far,this._cascades[J].far],this._uniformValues.u_shadow_intensity=S,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/il.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=il.shadowMapResolution,this._uniformValues.u_shadowmap_0=Uo.ShadowMap0,this._uniformValues.u_shadowmap_1=Uo.ShadowMap0+1,this._groundShadowTiles=v.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const re=v.transform.elevation;for(const de of this._groundShadowTiles){let ce={min:0,max:0};if(re){const pe=re.getMinMaxForTile(de);pe&&(ce=pe)}this.addShadowReceiver(de.toUnwrapped(),ce.min,ce.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(a){this._enabled=a}drawShadowPass(a,d){if(!this.enabled)return;const v=this.painter,S=v.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(v.transform.getFrustum(0),v.transform.worldSize,this._cascades),S.viewport.set([0,0,il.shadowMapResolution,il.shadowMapResolution]);for(let A=0;A<this._numCascadesToRender;++A){v.currentShadowCascade=A,S.bindFramebuffer.set(this._cascades[A].framebuffer.framebuffer),S.clear({color:s.am.white,depth:1});for(const P of a.order){const O=a._mergedLayers[P];if(!O.hasShadowPass()||O.isHidden(v.transform.zoom))continue;const I=a.getLayerSourceCache(O),H=I?d[I.id]:void 0;(O.type==="model"||H&&H.length)&&v.renderLayer(v,I,O,H)}}v.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const a=this.painter,d=a.style,v=a.context,S=v.gl,A=d.directionalLight,P=d.ambientLight;if(!A||!P)return;const O=[],I=Du(a,a.longestCutoffRange);I.shouldRenderCutoff&&O.push("RENDER_CUTOFF"),O.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&O.push("NORMAL_OFFSET");const H=rh(d,A,P),G=new Fn(S.LEQUAL,Fn.ReadOnly,a.depthRangeFor3D),ne=new Pr({func:S.EQUAL,mask:255},0,255,S.KEEP,S.KEEP,S.KEEP);for(const J of this._groundShadowTiles){const re=J.toUnwrapped(),de=a.isTileAffectedByFog(J),ce=a.getOrCreateProgram("groundShadow",{defines:O,overrideFog:de});this.setupShadows(re,ce),a.uploadCommonUniforms(v,ce,re,null,I);const pe={u_matrix:a.transform.calculateProjMatrix(re),u_ground_shadow_factor:H};ce.draw(a,S.TRIANGLES,G,ne,ei.multiply,_r.disabled,pe,"ground_shadow",a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments,null,a.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?ei.unblended:ei.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(a){const d=this.painter.transform,v=d.calculatePosMatrix(a,d.worldSize);return s.az(v,this._cascades[this.painter.currentShadowCascade].matrix,v),Float32Array.from(v)}calculateShadowPassMatrixFromMatrix(a){return s.az(a,this._cascades[this.painter.currentShadowCascade].matrix,a),Float32Array.from(a)}setupShadows(a,d,v){if(!this.enabled)return;const S=this.painter.transform,A=this.painter.context,P=A.gl,O=this._uniformValues,I=new Float64Array(16),H=S.calculatePosMatrix(a,S.worldSize);for(let G=0;G<this._cascades.length;G++)s.az(I,this._cascades[G].matrix,H),O[G===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(I),A.activeTexture.set(P.TEXTURE0+Uo.ShadowMap0+G),this._cascades[G].texture.bindExtraParam(P.LINEAR,P.LINEAR,P.CLAMP_TO_EDGE,P.CLAMP_TO_EDGE,P.GREATER);if(this.useNormalOffset=!!v,this.useNormalOffset){const G=s.d4(a.canonical),ne=2/S.tileSize*s.aj/il.shadowMapResolution,J=ne*this._cascades[0].boundingSphereRadius,re=ne*this._cascades[this._cascades.length-1].boundingSphereRadius,de=(v==="vector-tile"?1:3)*(function(ce,pe,me,be,Ne){const De=s.ay((ce-22)/-22,0,1);return .125*(1-De)+4*De})(S.zoom);O.u_shadow_normal_offset=[G,J*de,re*de],O.u_shadow_bias=[1e-4,.0012,.012]}else O.u_shadow_bias=[36e-5,.0012,.012];d.setShadowUniformValues(A,O)}setupShadowsFromMatrix(a,d,v=!1){if(!this.enabled)return;const S=this.painter.context,A=S.gl,P=this._uniformValues,O=new Float64Array(16);for(let I=0;I<il.cascadeCount;I++)s.az(O,this._cascades[I].matrix,a),P[I===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(O),S.activeTexture.set(A.TEXTURE0+Uo.ShadowMap0+I),this._cascades[I].texture.bindExtraParam(A.LINEAR,A.LINEAR,A.CLAMP_TO_EDGE,A.CLAMP_TO_EDGE,A.GREATER);if(this.useNormalOffset=v,v){const I=il.normalOffset;P.u_shadow_normal_offset=[1,I,I],P.u_shadow_bias=[6e-5,.0012,.012]}else P.u_shadow_bias=[36e-5,.0012,.012];d.setShadowUniformValues(S,P)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(a,d,v,S){if(S[2]>=0)return{};const A=(function(I,H,G){const ne=G/(1<<I.canonical.z);return new s.d6([I.canonical.x*ne+I.wrap*G,I.canonical.y*ne+I.wrap*G,0],[(I.canonical.x+1)*ne+I.wrap*G,(I.canonical.y+1)*ne+I.wrap*G,H])})(a,d,v).getCorners(),P=d/-S[2];S[0]<0?(s.d5(A[0],A[0],[S[0]*P,0,0]),s.d5(A[3],A[3],[S[0]*P,0,0])):S[0]>0&&(s.d5(A[1],A[1],[S[0]*P,0,0]),s.d5(A[2],A[2],[S[0]*P,0,0])),S[1]<0?(s.d5(A[0],A[0],[0,S[1]*P,0]),s.d5(A[1],A[1],[0,S[1]*P,0])):S[1]>0&&(s.d5(A[2],A[2],[0,S[1]*P,0]),s.d5(A[3],A[3],[0,S[1]*P,0]));const O={};return O.vertices=A,O.planes=[Ic(A[1],A[0],A[4]),Ic(A[2],A[1],A[5]),Ic(A[3],A[2],A[6]),Ic(A[0],A[3],A[7])],O}addShadowReceiver(a,d,v){this._receivers.add(a,s.d6.fromTileIdAndHeight(a,d,v))}getMaxCascadeForTile(a){const d=this._receivers.get(a);return d&&d.lastCascade?d.lastCascade:0}}function Ic(y,a,d){const v=s.at([],d,a),S=s.at([],y,a),A=s.bF([],v,S),P=s.ae(A);return P===0?[0,0,1,0]:(s.c1(A,A,1/P),[A[0],A[1],A[2],-s.bG(A,a)])}function Xh(y){const a=y.properties.get("direction"),d=s.d1(a.x,a.y,a.z);d[2]=s.ay(d[2],0,75);const v=s.d3([d[0],d[1],d[2]]);return s.d2(v.x,v.y,v.z)}function rh(y,a,d){const v=a.properties.get("color-use-theme")==="none",S=a.properties.get("color"),A=a.properties.get("intensity"),P=a.properties.get("direction"),O=[P.x,P.y,P.z],I=d.properties.get("color-use-theme")==="none",H=d.properties.get("color"),G=d.properties.get("intensity"),ne=Math.max(s.bG([0,0,1],O),0),J=[0,0,0];s.c1(J,H.toPremultipliedRenderColor(I?null:y.getLut(a.scope)).toArray01Linear().slice(0,3),G);const re=[0,0,0];return s.c1(re,S.toPremultipliedRenderColor(v?null:y.getLut(d.scope)).toArray01Linear().slice(0,3),ne*A),s.d8([J[0]>0?J[0]/(J[0]+re[0]):0,J[1]>0?J[1]/(J[1]+re[1]):0,J[2]>0?J[2]/(J[2]+re[2]):0])}function Zh(y,a,d,v,S,A){const P=y.zoom,O=y.scale,I=y.worldSize,H=1/I,G=y.aspect,ne=Math.sqrt(1+G*G)*Math.tan(.5*y.fovX),J=ne*ne,re=v-d,de=v+d;let ce,pe;J>re/de?(ce=v,pe=v*ne):(ce=.5*de*(1+J),pe=.5*Math.sqrt(re*re+2*(v*v+d*d)*J+de*de*J*J));const me=y.projection.pixelsPerMeter(y.center.lat,I),be=y._camera.getCameraToWorldMercator(),Ne=[0,0,-ce*H];s.ad(Ne,Ne,be);let De=pe*H;const Be=y._edgeInsets;if(!(Be.left===0&&Be.top===0&&Be.right===0&&Be.bottom===0||Be.left===Be.right&&Be.top===Be.bottom)){const Gt=y._camera.getWorldToCamera(y.worldSize,y.projection.zAxisUnit==="meters"?me:1),Yt=y._camera.getCameraToClipPerspective(y._fov,y.width/y.height,d,v);Yt[8]=2*-y.centerOffset.x/y.width,Yt[9]=2*y.centerOffset.y/y.height;const Ht=new Float64Array(16);s.cM(Ht,Yt,Gt);const en=new Float64Array(16);s.bi(en,Ht);const Pn=s.cy.fromInvProjectionMatrix(en,I,P,!0);for(const Kn of Pn.points){const In=((Ze=Kn)[0]/=O,Ze[1]/=O,Ze[2]=s.cb(Ze[2],y._center.lat),Ze);De=Math.max(De,s.c2(s.d7([],Ne,In)))}}var Ze;De*=S/(S-1);const Ye=Math.acos(a[2]),Ue=Math.atan2(-a[0],-a[1]),qe=new xl;qe.position=Ne,qe.setPitchBearing(Ye,Ue);const Ge=qe.getWorldToCamera(I,me),_t=De*I,ct=Math.min(y._mercatorZfromZoom(17)*I*-2,-2*_t),Bt=qe.getCameraToClipOrthographic(-_t,_t,-_t,_t,ct,(_t+A*me)/a[2]),Ct=new Float64Array(16);s.az(Ct,Bt,Ge);const Xt=s.d2(Math.floor(1e6*Ne[0])/1e6*I,Math.floor(1e6*Ne[1])/1e6*I,0),gn=.5*S,wt=[0,0,0];s.ad(wt,Xt,Ct),s.c1(wt,wt,gn);const at=[Math.floor(wt[0]),Math.floor(wt[1]),Math.floor(wt[2])],Dt=[0,0,0];s.at(Dt,wt,at),s.c1(Dt,Dt,-1/gn);const At=new Float64Array(16);return s.bx(At),s.bo(At,At,Dt),s.az(Ct,At,Ct),[Ct,_t]}class Sv extends s.E{constructor(a){super(),this.requestManager=a,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(a,d){return s.aS(this.requestManager.transformRequest(d,s.R.Model).url).then((v=>{if(!v)return;const S=s.aT(v),A=new s.aU(a,void 0,void 0,S);return A.computeBoundsAndApplyParent(),A})).catch((v=>{if(v&&v.status===404)return null;this.fire(new s.z(new Error(`Could not load model ${a} from ${d}: ${v.message}`)))}))}load(a,d,v={forceReload:!1}){this.models[d]||(this.models[d]={});const S=Object.keys(a),A=[],P=[];for(const O of S){const I=a[O];this.hasURLBeenRequested(I)&&!v.forceReload||(this.modelByURL[I]={modelId:O,scope:d},A.push(this.loadModel(O,I)),P.push(O)),this.models[d][O]||(this.models[d][O]={model:null,numReferences:1})}this.numModelsLoading[d]=(this.numModelsLoading[d]||0)+P.length,Promise.allSettled(A).then((O=>{for(let I=0;I<O.length;I++){const{status:H}=O[I];if(H==="rejected")continue;const{value:G}=O[I];this.models[d][P[I]]||(this.models[d][P[I]]={model:null,numReferences:1}),this.models[d][P[I]].model=G}this.numModelsLoading[d]-=P.length,this.fire(new s.A("data",{dataType:"style"}))})).catch((O=>{this.fire(new s.z(new Error(`Could not load models: ${O.message}`)))}))}isLoaded(){for(const a in this.numModelsLoading)if(this.numModelsLoading[a]>0)return!1;return!0}hasModel(a,d,v={exactIdMatch:!1}){return!!(v.exactIdMatch?this.getModel(a,d):this.getModelByURL(this.modelUris[d][a]))}getModel(a,d){return this.models[d]||(this.models[d]={}),this.models[d][a]?this.models[d][a].model:void 0}getModelByURL(a){if(!a)return null;const d=this.modelByURL[a];return d?this.models[d.scope][d.modelId].model:null}hasModelBeenAdded(a,d){return this.models[d]&&this.models[d][a]!==void 0}getModelURIs(a){return this.modelUris[a]||{}}addModel(a,d,v){this.models[v]||(this.models[v]={}),this.modelUris[v]||(this.modelUris[v]={});const S=this.requestManager.normalizeModelURL(d);if((this.hasModel(a,v,{exactIdMatch:!0})||this.hasModelBeenAdded(a,v))&&this.modelUris[v][a]===S)this.models[v][a].numReferences++;else if(this.hasURLBeenRequested(S)){const{scope:A,modelId:P}=this.modelByURL[S];this.models[A][P].numReferences++}else this.modelUris[v][a]=S,this.load({[a]:this.modelUris[v][a]},v)}addModelURLs(a,d){this.models[d]||(this.models[d]={}),this.modelUris[d]||(this.modelUris[d]={});const v=this.modelUris[d];for(const S in a)v[S]=this.requestManager.normalizeModelURL(a[S])}reloadModels(a){this.load(this.modelUris[a],a,{forceReload:!0})}addModelsFromBucket(a,d){this.models[d]||(this.models[d]={}),this.modelUris[d]||(this.modelUris[d]={});const v={};for(const S of a)this.hasModel(S,d,{exactIdMatch:!0})||this.hasURLBeenRequested(S)?this.models[d][S].numReferences++:this.modelUris[d][S]&&!this.hasURLBeenRequested(S)?v[S]=this.modelUris[d][S]:!this.hasURLBeenRequested(S)&&s.d9(S,!1)&&(this.modelUris[d][S]=this.requestManager.normalizeModelURL(S),v[S]=this.modelUris[d][S]);this.load(v,d)}hasURLBeenRequested(a){return this.modelByURL[a]!==void 0}removeModel(a,d,v=!1,S=!1){if(this.models[d]&&this.models[d][a]&&(this.models[d][a].numReferences--,this.models[d][a].numReferences===0||S)){const A=this.modelUris[d][a];v||delete this.modelUris[d][a],delete this.modelByURL[A];const P=this.models[d][a].model;if(!P)return;delete this.models[d][a],P.destroy()}}destroy(){for(const a of Object.keys(this.models))for(const d of Object.keys(this.models[a])){const v=this.models[a][d].model;delete this.models[a][d],v&&v.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(a){return this.models[a]||(this.models[a]={}),Object.keys(this.models[a])}upload(a,d){this.models[d]||(this.models[d]={});for(const v in this.models[d])this.models[d][v].model&&this.models[d][v].model.upload(a.context)}}const Zf=new s.a7({data:new s.a8(s.a5.colorTheme.data)});class Tv{constructor(a){this._scope=a,this._buildingQueryParams={target:{featuresetId:"building-outline",importId:this._scope}},this._floorQueryParams={target:{featuresetId:"floor-outline",importId:this._scope}}}execute(a){const d=this._makeBuildingsQueryArea(a),v=this._makeFloorsQueryArea(a),S=a.queryRenderedFeatures(d,this._buildingQueryParams).filter((O=>O.properties.shape_type==="building")).reduce(((O,I)=>{const H=I.properties.id;return I.properties.shape_type!=="building"||O.some((G=>G.properties.id===H))||O.push(I),O}),[]),A=a.queryRenderedFeatures(v,this._floorQueryParams).filter((O=>O.properties.shape_type==="floor")).reduce(((O,I)=>{const H=I.properties.id;return I.properties.shape_type!=="floor"||O.some((G=>G.properties.id===H))||O.push(I),O}),[]),P=[a.getCenter().lng,a.getCenter().lat];return{floors:A,building:this._findBuildingAtCenter(P,S)||(S.length>0?S[0]:null)}}_makeBuildingsQueryArea(a){const d=a.transform.width,v=a.transform.height,S=Math.min(d,v),A=S*(1/8),P=S*(1/8),O=.5*(d-A),I=.5*(v-P);return[new s.P(O,I),new s.P(O+A,I+P)]}_makeFloorsQueryArea(a){const d=a.transform.width,v=a.transform.height,S=d*(2/3),A=v*(2/3),P=.5*(d-S),O=.5*(v-A);return[new s.P(P,O),new s.P(P+S,O+A)]}_findBuildingAtCenter(a,d){for(const v of d)if(v.geometry.type==="Polygon"&&this._pointInPolygon(a,v.geometry.coordinates[0]))return v;return null}_pointInPolygon(a,d){let v=!1;for(let S=0,A=d.length-1;S<d.length;A=S++){const P=d[S][0],O=d[S][1],I=d[A][1];O>a[1]!=I>a[1]&&a[0]<(d[A][0]-P)*(a[1]-O)/(I-O)+P&&(v=!v)}return v}}class bc{constructor(){this._selectedFloorId=null,this._selectedBuildingId=null,this._floors=[]}setBuildingId(a){this._selectedBuildingId=a}setFloors(a){if(this._floors=a.filter((d=>d.properties.building_id===this._selectedBuildingId)),!this._selectedFloorId||!this._floors.map((d=>d.properties.id)).includes(this._selectedFloorId)){const d=this._floors.map((v=>({id:v.properties.id,level:v.properties.floor_level}))).reduce(((v,S)=>{const A=Math.abs(v.level-1),P=Math.abs(S.level-1);return P<A||P===A&&S.level>v.level?S:v}));this._selectedFloorId=d.id}}setFloorId(a){this._selectedFloorId=a}getSelectedFloorId(){return this._selectedFloorId}getCurrentBuildingFloors(){return this._floors}reset(){this._selectedFloorId=null,this._selectedBuildingId=null,this._floors=[]}}const Av={"mbx-indoor-level-selected":{default:["literal",[]]}};function Yf(y){return y=y||{},Object.assign(y,Av)}class jv extends s.E{constructor(a){super(),s.aV(["_onLoad","_onMove"],this),this._map=a,this._floorSelectionState=new bc,this._queryIndoor(),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=null,this._floorSelectionState=null}_onLoad(){this._map.style.forEachFragmentStyle((a=>{a.stylesheet.indoor&&(this._indoorDataQuery?this.fire(new s.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._scope=a.scope,this._indoorDataQuery=new Tv(this._scope)))})),this._map._addIndoorControl(),this._queryIndoor()}_onMove(){this._queryIndoor()}_queryIndoor(){if(!this._indoorDataQuery||!this._map.isStyleLoaded())return;if(this._map.transform.zoom<16)return void this._clearIndoorData();const a=this._indoorDataQuery.execute(this._map);a&&a.floors.length!==0?(this._floorSelectionState.getSelectedFloorId()||this._map._addIndoorControl(),this._selectFloors(a)):this._clearIndoorData()}_selectFloors(a){if(a.building)this._floorSelectionState.setBuildingId(a.building.properties.id),this._floorSelectionState.setFloors(a.floors),this._updateUI();else{const d=this._floorSelectionState.getSelectedFloorId();if(d&&a.floors.some((v=>v.properties.id===d)))return;this._clearIndoorData()}}_clearIndoorData(){this._floorSelectionState.reset(),this._map._removeIndoorControl(),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",[]])}_updateUI(){const a=this._floorSelectionState.getCurrentBuildingFloors().map((v=>({id:v.properties.id,name:v.properties.name,shortName:v.properties.floor_level,levelOrder:v.properties.floor_level}))),d=this._floorSelectionState.getSelectedFloorId();d?(this._updateIndoorConfig(),this.fire(new s.A("indoorupdate",{selectedFloorId:d,floors:a}))):console.warn("IndoorManager: Selected floor is not set")}_updateIndoorConfig(){const a=this._floorSelectionState.getSelectedFloorId();a?this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",[a]]):console.warn("IndoorManager: Selected floor is not set")}selectFloor(a){this._floorSelectionState.setFloorId(a),this._updateIndoorConfig()}}function Ev(y){if(!y.metadata||!y.metadata.content_area)return;const a=s.q.devicePixelRatio,{left:d,top:v,width:S,height:A}=y.metadata.content_area,P=d*a,O=v*a;return[P,O,P+S*a,O+A*a]}function ih(y){if(y)return y.map((([a,d])=>[a*s.q.devicePixelRatio,d*s.q.devicePixelRatio]))}class sh{constructor(a,d,v){this.id=a,this.scope=d,this.sourceCache=v,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(a){this.missingRequests.has(a.name)||this.pendingRequests.has(a.name)||this.pendingRequests.add(a.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const a=new Map;if(!this.sourceCache.loaded())return a;const d=this.sourceCache.getVisibleCoordinates();if(d.length===0)return a;const v=this.sourceCache.getSource();if(!(v instanceof ts))return a;const S=d.map((P=>this.sourceCache.getTile(P))),A=v.getImages(S,Array.from(this.pendingRequests));for(const[P,O]of A)a.set(s.I.from({name:P,iconsetId:this.id}),O),this.pendingRequests.delete(P);for(const P of this.pendingRequests)this.missingRequests.add(P);return this.pendingRequests.clear(),a}}const ku=(y,a)=>Oe(y,a&&a.filter((d=>d.identifier!=="source.canvas"))),Cv=s.aF(bi,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),ah=s.aF(bi,["setCenter","setZoom","setBearing","setPitch"]),gm=new Set(["background","sky","slot","custom"]),cd={version:8,layers:[],sources:{}},Kf={duration:300,delay:0};class Lc extends s.E{constructor(a,d={}){super(),this.map=a,this.scope=d.scope||"",this.globalId=null,this.fragments=[],this.importDepth=d.importDepth||0,this.importsCache=d.importsCache||new Map,this.resolvedImports=d.resolvedImports||new Set,this.transition=s.h({},Kf),this._buildingIndex=new qh(this),this.crossTileSymbolIndex=new uo,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=d.styleChanges||new zr,this.dispatcher=d.dispatcher?d.dispatcher:new s.D(s.db(),this),d.imageManager?this.imageManager=d.imageManager:(this.imageManager=new Rr(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=d.glyphManager?d.glyphManager:new s.dc(a._requestManager,d.localFontFamily?s.dd.all:d.localIdeographFontFamily?s.dd.ideographs:s.dd.none,d.localFontFamily||d.localIdeographFontFamily),d.modelManager?this.modelManager=d.modelManager:(this.modelManager=new Sv(a._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=d.configOptions?d.configOptions:new Map,this._configDependentLayers=d.configDependentLayers?d.configDependentLayers:new Set,this._config=d.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:d.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=d.initialConfig,this.dispatcher.broadcast("setReferrer",s.de());const v=this;this._rtlTextPluginCallback=Lc.registerForPluginStateChange((S=>{v.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},((A,P)=>{if(s.df(A),P&&P.every((O=>O)))for(const O in v._sourceCaches){const I=v._sourceCaches[O],H=I.getSource().type;H!=="vector"&&H!=="geojson"||I.reload()}}))})),this.on("data",(S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const A=this.getOwnSource(S.sourceId);if(A&&A.vectorLayerIds)for(const P in this._layers){const O=this._layers[P];O.source===A.id&&this._validateLayer(O)}}))}load(a){return a?(typeof a=="string"?this.loadURL(a):this.loadJSON(a),this):this}_getGlobalId(a){if(!a)return null;if(typeof a=="string"){if(s.j(a))return a;const d=s.dg(a);if(!d.startsWith("http"))try{return new URL(d,location.href).toString()}catch{return d}return d}return`json://${s.dh(JSON.stringify(a))}`}_diffStyle(a,d,v){this.globalId=this._getGlobalId(a);const S=(A,P)=>{try{P(null,this.setState(A,v))}catch(O){P(O,!1)}};if(typeof a=="string"){const A=this.map._requestManager.normalizeStyleURL(a),P=this.map._requestManager.transformRequest(A,s.R.Style);s.n(P,((O,I)=>{O?this.fire(new s.z(O)):I&&S(I,d)}))}else typeof a=="object"&&S(a,d)}loadURL(a,d={}){this.fire(new s.A("dataloading",{dataType:"style"}));const v=typeof d.validate=="boolean"?d.validate:!s.j(a);this.globalId=this._getGlobalId(a),a=this.map._requestManager.normalizeStyleURL(a,d.accessToken),this.resolvedImports.add(a);const S=this.importsCache.get(a);if(S)return this._load(S,v);const A=this.map._requestManager.transformRequest(a,s.R.Style);this._request=s.n(A,((P,O)=>{if(this._request=null,P)this.fire(new s.z(P));else if(O)return this.importsCache.set(a,O),this._load(O,v)}))}loadJSON(a,d={}){this.fire(new s.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(a),this._request=s.q.frame((()=>{this._request=null,this._load(a,d.validate!==!1)}))}loadEmpty(){this.fire(new s.A("dataloading",{dataType:"style"})),this._load(cd,!1)}_loadImports(a,d,v){if(this.importDepth>=4)return s.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const S=[];for(const A of a){const P=this._createFragmentStyle(A),O=new Promise((G=>{P.once("style.import.load",G),P.once("error",G)})).then((()=>this.mergeAll()));if(S.push(O),this.resolvedImports.has(A.url)){P.loadEmpty();continue}const I=A.data||this.importsCache.get(A.url);I?(P.loadJSON(I,{validate:d}),this._isInternalStyle(I)&&(P.globalId=null)):A.url?P.loadURL(A.url,{validate:d}):P.loadEmpty();const H={style:P,id:A.id,config:A.config};if(v){const G=this.fragments.findIndex((({id:ne})=>ne===v));this.fragments=this.fragments.slice(0,G).concat(H).concat(this.fragments.slice(G))}else this.fragments.push(H)}return Promise.allSettled(S)}getImportGlobalIds(a=this,d=new Set){for(const v of a.fragments)v.style.globalId&&d.add(v.style.globalId),this.getImportGlobalIds(v.style,d);return[...d.values()]}_createFragmentStyle(a){const d=this.scope?s.C(a.id,this.scope):a.id;let v;const S=this._initialConfig&&this._initialConfig[d];(a.config||S)&&(v=s.h({},a.config,S));const A=new Lc(this.map,{scope:d,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:v,configOptions:this.options,colorThemeOverride:a["color-theme"],configDependentLayers:this._configDependentLayers});return A.setEventedParent(this.map,{style:A}),A}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(a){return this.isRootStyle()&&(a.fragment||!!a.schema&&a.fragment!==!1)}_load(a,d){const v=a.indoor?Yf(a.schema):a.schema;if(this._isInternalStyle(a)){const P=s.h({},cd,{imports:[{id:"basemap",data:a,url:""}]});return void this._load(P,d)}if(this.updateConfig(this._config,v),d&&ku(this,Ji(a)))return;this._loaded=!0,this.stylesheet=s.di(a);const S=()=>{for(const H in a.sources)this.addSource(H,a.sources[H],{validate:!1,isInitialLoad:!0});if(a.iconsets)for(const H in a.iconsets)this.addIconset(H,a.iconsets[H]);a.sprite?this._loadIconset(a.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),!this.glyphManager.url&&a.glyphs&&this.glyphManager.setURL(a.glyphs);const P=Mu(this.stylesheet.layers);if(this._order=P.map((H=>H.id)),this.stylesheet.light&&s.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const H=this.stylesheet.lights[0];this.light=new Et(H.properties,H.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Et(this.stylesheet.light)),this._layers={};for(const H of P){const G=s.dn(H,this.scope,this._styleColorTheme.lut,this.options);G.configDependencies.size!==0&&this._configDependentLayers.add(G.fqid),G.setEventedParent(this,{layer:{id:G.id}}),this._layers[G.id]=G;const ne=this.getOwnLayerSourceCache(G),J=!!this.directionalLight&&this.directionalLight.shadowsEnabled();ne&&G.canCastShadows()&&J&&(ne.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const O=this.stylesheet.terrain;O&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(O,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new s.A("data",{dataType:"style"}));const I=this.isRootStyle();a.imports?this._loadImports(a.imports,d).then((()=>{this._reloadImports(),this.fire(new s.A(I?"style.load":"style.import.load"))})).catch((H=>{this.fire(new s.z(new Error("Failed to load imports",H))),this.fire(new s.A(I?"style.load":"style.import.load"))})):(this._reloadImports(),this.fire(new s.A(I?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const A=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(A){const P=this._evaluateColorThemeData(A);this._loadColorTheme(P).then((()=>{S()})).catch((O=>{s.w(`Couldn't load color theme from the stylesheet: ${O}`),S()}))}else this._styleColorTheme.lut=null,S()}isRootStyle(){return this.importDepth===0}mergeAll(){let a,d,v,S,A,P,O,I,H,G;const ne={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((J=>{if(J.stylesheet){if(J.light!=null&&(a=J.light),J.stylesheet.lights)for(const re of J.stylesheet.lights)re.type==="ambient"&&J.ambientLight!=null&&(d=J.ambientLight),re.type==="directional"&&J.directionalLight!=null&&(v=J.directionalLight);S=this._prioritizeTerrain(S,J.terrain,J.stylesheet.terrain),J.stylesheet.fog&&J.fog!=null&&(A=J.fog),J.stylesheet.snow&&J.snow!=null&&(P=J.snow),J.stylesheet.rain&&J.rain!=null&&(O=J.rain),J.stylesheet.camera!=null&&(G=J.stylesheet.camera),J.stylesheet.projection!=null&&(I=J.stylesheet.projection),J.stylesheet.transition!=null&&(H=J.stylesheet.transition),ne[J.scope]=J._styleColorTheme}})),this.light=a,this.ambientLight=d,this.directionalLight=v,this.fog=A,this.snow=P,this.rain=O,this._styleColorThemeForScope=ne,S===null?delete this.terrain:this.terrain=S,this.camera=G||{"camera-projection":"perspective"},this.projection=I||{name:"mercator"},this.transition=s.h({},Kf,H),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(a){const d=v=>{for(const S of v.fragments)d(S.style);a(v)};d(this)}_prioritizeTerrain(a,d,v){const S=a&&a.drapeRenderMode===0;return v===null?d&&d.drapeRenderMode===0?d:S?a:null:d!=null&&(!a||S||d&&d.drapeRenderMode===1)?d:a}mergeTerrain(){let a;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((d=>{a=this._prioritizeTerrain(a,d.terrain,d.stylesheet.terrain)})),a===null?delete this.terrain:this.terrain=a}mergeProjection(){let a;this.forEachFragmentStyle((d=>{d.stylesheet.projection!=null&&(a=d.stylesheet.projection)})),this.projection=a||{name:"mercator"}}mergeSources(){const a={},d={},v={};this.forEachFragmentStyle((S=>{for(const A in S._sourceCaches){const P=s.C(A,S.scope);a[P]=S._sourceCaches[A]}for(const A in S._otherSourceCaches){const P=s.C(A,S.scope);d[P]=S._otherSourceCaches[A]}for(const A in S._symbolSourceCaches){const P=s.C(A,S.scope);v[P]=S._symbolSourceCaches[A]}})),this._mergedSourceCaches=a,this._mergedOtherSourceCaches=d,this._mergedSymbolSourceCaches=v}mergeLayers(){const a={},d=[],v={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle((A=>{for(const P of A._order){const O=A._layers[P];if(O.type==="slot"){const I=s.dj(P);if(a[I])continue;a[I]=[]}O.slot&&a[O.slot]?a[O.slot].push(O):d.push(O)}})),this._mergedOrder=[];const S=(A=[])=>{for(const P of A)if(P.type==="slot"){const O=s.dj(P.id);a[O]&&S(a[O]),this._mergedSlots.push(O)}else{const O=s.C(P.id,P.scope);this._mergedOrder.push(O),v[O]=P,P.is3D(!!this.terrain)&&(this._has3DLayers=!0),P.type==="circle"&&(this._hasCircleLayers=!0),P.type==="symbol"&&(this._hasSymbolLayers=!0),P.type==="clip"&&(this._clipLayerPresent=!0)}};S(d),this._mergedOrder.sort(((A,P)=>{const O=v[A],I=v[P];return O.hasInitialOcclusionOpacityProperties?I.is3D(!!this.terrain)?1:0:O.is3D(!!this.terrain)&&I.hasInitialOcclusionOpacityProperties?-1:0})),this._mergedLayers=v,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(a){return this.stylesheet.camera=s.h({},this.stylesheet.camera,a),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(a){return a.data?(function(d,v,S,A){const P=s.h({},v);for(const I of Object.keys(s.a5.colorTheme))P[I]===void 0&&(P[I]=s.a5.colorTheme[I].default);const O=new s.a6(Zf,d,new Map(S));return O.setTransitionOrValue(P,S),O.untransitioned().possiblyEvaluate(new s.aa(0,{worldview:void 0}))})(this.scope,a,this.options).get("data"):null}_loadColorTheme(a){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const d=this._styleColorTheme.lutLoadingCorrelationID;return new Promise(((v,S)=>{const A="data:image/png;base64,";if(!a||a.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void v();let P=a;P.startsWith(A)||(P=A+P);const O=s.I.from("mapbox-reserved-lut"),I=new Image;I.src=P,I.onerror=()=>{this._styleColorTheme.lutLoading=!1,S(new Error("Failed to load image data"))},I.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==d)return void v();this._styleColorTheme.lutLoading=!1;const{width:H,height:G,data:ne}=s.q.getImageData(I);if(G>32)return void S(new Error("The height of the image must be less than or equal to 32 pixels."));if(H!==G*G)return void S(new Error("The width of the image must be equal to the height squared."));this.getImage(O)&&this.removeImage(O),this.addImage(O,{data:new s.r({width:H,height:G},ne),pixelRatio:1,sdf:!1,usvg:!1,version:0});const J=this.imageManager.getImage(O,this.scope);J?(this._styleColorTheme.lut={image:J.data,data:a},v()):S(new Error("Missing LUT image."))}}))}getLut(a){const d=this._styleColorThemeForScope[a];return d?d.lut:null}setProjection(a){a?this.stylesheet.projection=a:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(a){this._spriteRequest=(function(d,v,S){let A,P,O;const I=s.q.devicePixelRatio>1?"@2x":"";let H=s.n(v.transformRequest(v.normalizeSpriteURL(d,I,".json"),s.R.SpriteJSON),((J,re)=>{H=null,O||(O=J,A=re,ne())})),G=s.o(v.transformRequest(v.normalizeSpriteURL(d,I,".png"),s.R.SpriteImage),((J,re)=>{G=null,O||(O=J,P=re,ne())}));function ne(){if(O)S(O);else if(A&&P){const J=s.q.getImageData(P),re={};for(const de in A){const{width:ce,height:pe,x:me,y:be,sdf:Ne,pixelRatio:De,stretchX:Be,stretchY:Ze,content:Ye}=A[de],Ue=new s.r({width:ce,height:pe});s.r.copy(J,Ue,{x:me,y:be},{x:0,y:0},{width:ce,height:pe},null),re[de]={data:Ue,pixelRatio:De,sdf:Ne,stretchX:Be,stretchY:Ze,content:Ye,usvg:!1}}S(null,re)}}return{cancel(){H&&(H.cancel(),H=null),G&&(G.cancel(),G=null)}}})(a,this.map._requestManager,((d,v)=>{if(this._spriteRequest=null,d)this.fire(new s.z(d));else if(v){const S=new Map;for(const A in v)S.set(s.I.from(A),v[A]);this.addImages(S)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new s.A("data",{dataType:"style"}))}))}addIconset(a,d){if(d.type==="sprite")return void this._loadSprite(d.url);const v=this.getOwnSourceCache(d.source);if(!v)return void this.fire(new s.z(new Error(`Source "${d.source}" as specified by iconset "${a}" does not exist and cannot be used as an iconset source`)));const S=v.getSource();if(S.type!=="raster-array")return void this.fire(new s.z(new Error(`Source "${d.source}" as specified by iconset "${a}" is not a "raster-array" source and cannot be used as an iconset source`)));S.partial=!1;const A=new sh(a,this.scope,v);this.imageManager.addImageProvider(A,this.scope)}removeIconset(a){this.imageManager.removeImageProvider(a,this.scope)}_loadIconset(a){if(!s.j(a)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(a);const d=this.map._spriteFormat==="auto";var v,S;this._spriteRequest=(S=(A,P)=>{if(this._spriteRequest=null,A)d?this._loadSprite(a):this.fire(new s.z(A));else if(P){const O=new Map;for(const I in P)O.set(s.I.from(I),P[I]);this.addImages(O)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new s.A("data",{dataType:"style"}))},s.br((v=this.map._requestManager).transformRequest(v.normalizeIconsetURL(a),s.R.Iconset),((A,P)=>{if(A)return void S(A);const O={},I=s.da(new s.bq(P));for(const H of I.icons){const G={version:1,pixelRatio:s.q.devicePixelRatio,content:Ev(H),stretchX:H.metadata?ih(H.metadata.stretch_x_areas):void 0,stretchY:H.metadata?ih(H.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:H};O[H.name]=G}S(null,O)})))}_validateLayer(a){const d=this.getOwnSource(a.source);if(!d)return;const v=a.sourceLayer;v&&(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(v)===-1)&&this.fire(new s.z(new Error(`Source layer "${v}" does not exist on source "${d.id}" as specified by style layer "${a.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const a in this._sourceCaches)if(!this._sourceCaches[a].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:a}of this.fragments)if(!a.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map(((a,d)=>{const v=this.fragments[d];return v&&v.style&&(a.data=v.style.serialize()),a}))}_serializeSources(){const a={};for(const d in this._sourceCaches){const v=this._sourceCaches[d].getSource();a[v.id]||(a[v.id]=v.serialize())}return a}_serializeLayers(a){const d=[];for(const v of a){const S=this._layers[v];S&&S.type!=="custom"&&d.push(S.serialize())}return d}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const a in this._sourceCaches)if(this._sourceCaches[a].hasTransition())return!0;for(const a in this._layers)if(this._layers[a].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(a){return a?this.order:this._mergedOrder}isLayerDraped(a){return!!this.terrain&&a.isDraped(this.getLayerSourceCache(a))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(a){const d=this.getOwnLayer(a);if(d)return d;this.fire(new s.z(new Error(`The layer '${a}' does not exist in the map's style.`)))}_checkSource(a){const d=this.getOwnSource(a);if(d)return d;this.fire(new s.z(new Error(`The source '${a}' does not exist in the map's style.`)))}precompilePrograms(a,d){const v=this.map.painter;if(v)for(let S=a.minzoom||0;S<(a.maxzoom||25.5);S++){const A=a.getProgramIds();if(A)for(const P of A){const O=a.getDefaultProgramParams(P,d.zoom,this._styleColorTheme.lut);O&&(v.style=this,this.fog&&(v._fogVisible=!0,O.overrideFog=!0,v.getOrCreateProgram(P,O)),v._fogVisible=!1,O.overrideFog=!1,v.getOrCreateProgram(P,O),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(O.overrideRtt=!0,v.getOrCreateProgram(P,O)))}}}update(a){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(a),this.directionalLight&&this.directionalLight.recalculate(a);const d=this.calculateLightsBrightness();a.brightness=d||0,d!==this._brightness&&(this._brightness=d,this.dispatcher.broadcast("setBrightness",d)),a.worldview!==this._worldview&&(this._worldview=a.worldview,this.dispatcher.broadcast("setWorldview",this._worldview));const v=this._changes.isDirty();let S=!1;if(this._changes.isDirty()){const O=this._changes.getLayerUpdatesByScope();for(const I in O){const{updatedIds:H,removedIds:G}=O[I];(H||G)&&(this._updateWorkerLayers(I,H,G),S=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(a),this.light&&this.light.updateTransitions(a),this.ambientLight&&this.ambientLight.updateTransitions(a),this.directionalLight&&this.directionalLight.updateTransitions(a),this.fog&&this.fog.updateTransitions(a),this.snow&&this.snow.updateTransitions(a),this.rain&&this.rain.updateTransitions(a),this._changes.reset()}const A={};for(const O in this._mergedSourceCaches){const I=this._mergedSourceCaches[O];A[O]=I.used,I.used=!1,I.tileCoverLift=0}for(const O of this._mergedOrder){const I=this._mergedLayers[O];if(I.recalculate(a,this._availableImages),!I.isHidden(a.zoom)){const H=this.getLayerSourceCache(I);H&&(H.used=!0,H.tileCoverLift=Math.max(H.tileCoverLift,I.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback((()=>{this.precompilePrograms(I,a)})):this.precompilePrograms(I,a))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&S&&this.mergeLayers();const P=this.imageManager.getPendingImageProviders();for(const O of P)O.sourceCache.used=!0;for(const O in A){const I=this._mergedSourceCaches[O];A[O]!==I.used&&I.getSource().fire(new s.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:I.getSource().id}))}this.light&&this.light.recalculate(a),this.terrain&&this.terrain.recalculate(a),this.fog&&this.fog.recalculate(a),this.snow&&this.snow.recalculate(a),this.rain&&this.rain.recalculate(a),this.z=a.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),v&&this.fire(new s.A("data",{dataType:"style"}))}updateImageProviders(){const a=this.imageManager.getPendingImageProviders();for(const d of a){const v=d.resolvePendingRequests(),S=this.getFragmentStyle(d.scope);S&&S.addImages(v)}}_updateTilesForChangedImages(){const a={};for(const d in this._mergedSourceCaches){const v=this._mergedSourceCaches[d].getSource().scope;a[v]=a[v]||this._changes.getUpdatedImages(v),a[v].length!==0&&this._mergedSourceCaches[d].reloadTilesForDependencies(["icons","patterns"],a[v])}for(const d in a)this._changes.resetUpdatedImages(d)}_updateWorkerLayers(a,d,v){const S=this.getFragmentStyle(a);S&&this.dispatcher.broadcast("updateLayers",{layers:d?S._serializeLayers(d):[],scope:a,removedIds:v||[],options:S.options})}setState(a,d){if(this._checkLoaded(),ku(this,Ji(a)))return!1;(a=s.di(a)).layers=Mu(a.layers);const v=(function(P,O){if(!P)return[{command:bi.setStyle,args:[O]}];let I=[];try{if(!s.bv(P.version,O.version))return[{command:bi.setStyle,args:[O]}];if(s.bv(P.center,O.center)||I.push({command:bi.setCenter,args:[O.center]}),s.bv(P.zoom,O.zoom)||I.push({command:bi.setZoom,args:[O.zoom]}),s.bv(P.bearing,O.bearing)||I.push({command:bi.setBearing,args:[O.bearing]}),s.bv(P.pitch,O.pitch)||I.push({command:bi.setPitch,args:[O.pitch]}),s.bv(P.sprite,O.sprite)||I.push({command:bi.setSprite,args:[O.sprite]}),s.bv(P.glyphs,O.glyphs)||I.push({command:bi.setGlyphs,args:[O.glyphs]}),s.bv(P.imports,O.imports)||(function(re=[],de=[],ce){de=de||[];const pe=(re=re||[]).map(vn),me=de.map(vn),be=re.reduce(Sr,{}),Ne=de.reduce(Sr,{}),De=pe.slice();let Be,Ze,Ye,Ue;for(Be=0,Ze=0;Be<pe.length;Be++)Ye=pe[Be],Ne.hasOwnProperty(Ye)?Ze++:(ce.push({command:bi.removeImport,args:[Ye]}),De.splice(De.indexOf(Ye,Ze),1));for(Be=0,Ze=0;Be<me.length;Be++)Ye=me[me.length-1-Be],De[De.length-1-Be]!==Ye&&(be.hasOwnProperty(Ye)?(ce.push({command:bi.removeImport,args:[Ye]}),De.splice(De.lastIndexOf(Ye,De.length-Ze),1)):Ze++,Ue=De[De.length-Be],ce.push({command:bi.addImport,args:[Ne[Ye],Ue]}),De.splice(De.length-Be,0,Ye));for(const qe of de){const Ge=be[qe.id];Ge&&(delete Ge.data,s.bv(Ge,qe)||ce.push({command:bi.updateImport,args:[qe.id,qe]}))}})(P.imports,O.imports,I),s.bv(P.transition,O.transition)||I.push({command:bi.setTransition,args:[O.transition]}),s.bv(P.light,O.light)||I.push({command:bi.setLight,args:[O.light]}),s.bv(P.fog,O.fog)||I.push({command:bi.setFog,args:[O.fog]}),s.bv(P.snow,O.snow)||I.push({command:bi.setSnow,args:[O.snow]}),s.bv(P.rain,O.rain)||I.push({command:bi.setRain,args:[O.rain]}),s.bv(P.projection,O.projection)||I.push({command:bi.setProjection,args:[O.projection]}),s.bv(P.lights,O.lights)||I.push({command:bi.setLights,args:[O.lights]}),s.bv(P.camera,O.camera)||I.push({command:bi.setCamera,args:[O.camera]}),s.bv(P.iconsets,O.iconsets)||(function(re,de,ce){let pe;for(pe in de=de||{},re=re||{})re.hasOwnProperty(pe)&&(de.hasOwnProperty(pe)||ce.push({command:bi.removeIconset,args:[pe]}));for(pe in de){if(!de.hasOwnProperty(pe))continue;const me=de[pe];re.hasOwnProperty(pe)?s.bv(re[pe],me)||(ce.push({command:bi.removeIconset,args:[pe]}),ce.push({command:bi.addIconset,args:[pe,me]})):ce.push({command:bi.addIconset,args:[pe,me]})}})(P.iconsets,O.iconsets,I),!s.bv(P["color-theme"],O["color-theme"]))return[{command:bi.setStyle,args:[O]}];const H={},G=[];(function(re,de,ce,pe){let me;for(me in de=de||{},re=re||{})re.hasOwnProperty(me)&&(de.hasOwnProperty(me)||mc(me,ce,pe));for(me in de){if(!de.hasOwnProperty(me))continue;const be=de[me];re.hasOwnProperty(me)?s.bv(re[me],be)||(re[me].type==="geojson"&&be.type==="geojson"&&je(re,de,me)?ce.push({command:bi.setGeoJSONSourceData,args:[me,be.data]}):gc(me,de,ce,pe)):yl(me,de,ce)}})(P.sources,O.sources,G,H);const ne=[];P.layers&&P.layers.forEach((re=>{re.source&&H[re.source]?I.push({command:bi.removeLayer,args:[re.id]}):ne.push(re)}));let J=P.terrain;J&&H[J.source]&&(I.push({command:bi.setTerrain,args:[void 0]}),J=void 0),I=I.concat(G),s.bv(J,O.terrain)||I.push({command:bi.setTerrain,args:[O.terrain]}),(function(re,de,ce){de=de||[];const pe=(re=re||[]).map(vn),me=de.map(vn),be=re.reduce(Sr,{}),Ne=de.reduce(Sr,{}),De=pe.slice(),Be=Object.create(null);let Ze,Ye,Ue,qe,Ge,_t,ct;for(Ze=0,Ye=0;Ze<pe.length;Ze++)Ue=pe[Ze],Ne.hasOwnProperty(Ue)?Ye++:(ce.push({command:bi.removeLayer,args:[Ue]}),De.splice(De.indexOf(Ue,Ye),1));for(Ze=0,Ye=0;Ze<me.length;Ze++)Ue=me[me.length-1-Ze],De[De.length-1-Ze]!==Ue&&(be.hasOwnProperty(Ue)?(ce.push({command:bi.removeLayer,args:[Ue]}),De.splice(De.lastIndexOf(Ue,De.length-Ye),1)):Ye++,_t=De[De.length-Ze],ce.push({command:bi.addLayer,args:[Ne[Ue],_t]}),De.splice(De.length-Ze,0,Ue),Be[Ue]=!0);for(Ze=0;Ze<me.length;Ze++)if(Ue=me[Ze],qe=be[Ue],Ge=Ne[Ue],!Be[Ue]&&!s.bv(qe,Ge))if(s.bv(qe.source,Ge.source)&&s.bv(qe["source-layer"],Ge["source-layer"])&&s.bv(qe.type,Ge.type)){for(ct in ot(qe.layout,Ge.layout,ce,Ue,null,bi.setLayoutProperty),ot(qe.paint,Ge.paint,ce,Ue,null,bi.setPaintProperty),s.bv(qe.slot,Ge.slot)||ce.push({command:bi.setSlot,args:[Ue,Ge.slot]}),s.bv(qe.filter,Ge.filter)||ce.push({command:bi.setFilter,args:[Ue,Ge.filter]}),s.bv(qe.minzoom,Ge.minzoom)&&s.bv(qe.maxzoom,Ge.maxzoom)||ce.push({command:bi.setLayerZoomRange,args:[Ue,Ge.minzoom,Ge.maxzoom]}),qe)qe.hasOwnProperty(ct)&&ct!=="layout"&&ct!=="paint"&&ct!=="filter"&&ct!=="metadata"&&ct!=="minzoom"&&ct!=="maxzoom"&&ct!=="slot"&&(ct.indexOf("paint.")===0?ot(qe[ct],Ge[ct],ce,Ue,ct.slice(6),bi.setPaintProperty):s.bv(qe[ct],Ge[ct])||ce.push({command:bi.setLayerProperty,args:[Ue,ct,Ge[ct]]}));for(ct in Ge)Ge.hasOwnProperty(ct)&&!qe.hasOwnProperty(ct)&&ct!=="layout"&&ct!=="paint"&&ct!=="filter"&&ct!=="metadata"&&ct!=="minzoom"&&ct!=="maxzoom"&&ct!=="slot"&&(ct.indexOf("paint.")===0?ot(qe[ct],Ge[ct],ce,Ue,ct.slice(6),bi.setPaintProperty):s.bv(qe[ct],Ge[ct])||ce.push({command:bi.setLayerProperty,args:[Ue,ct,Ge[ct]]}))}else ce.push({command:bi.removeLayer,args:[Ue]}),_t=De[De.lastIndexOf(Ue)+1],ce.push({command:bi.addLayer,args:[Ge,_t]})})(ne,O.layers,I)}catch(H){console.warn("Unable to compute style diff:",H),I=[{command:bi.setStyle,args:[O]}]}return I})(this.serialize(),a).filter((P=>!(P.command in ah)));if(v.length===0)return!1;const S=v.filter((P=>!(P.command in Cv)));if(S.length>0)throw new Error(`Unimplemented: ${S.map((P=>P.command)).join(", ")}.`);const A=[];return v.forEach((P=>{A.push(this[P.command](...P.args))})),d&&Promise.all(A).then(d).catch(d),this.stylesheet=a,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(a){if(a.size===0)return this;for(const[d,v]of a.entries()){if(this.getImage(d))return this.fire(new s.z(new Error(`An image with the name "${d.name}" already exists.`)));this.imageManager.addImage(d,this.scope,v),this._changes.updateImage(d,this.scope)}return this._updateWorkerImages(),this.fire(new s.A("data",{dataType:"style"})),this}addImage(a,d){return this.getImage(a)?this.fire(new s.z(new Error(`An image with the name "${a.name}" already exists.`))):(this.imageManager.addImage(a,this.scope,d),this._changes.updateImage(a,this.scope),this._updateWorkerImages(),this.fire(new s.A("data",{dataType:"style"})),this)}updateImage(a,d,v=!1){this.imageManager.updateImage(a,this.scope,d),v&&(this._changes.updateImage(a,this.scope),this._updateWorkerImages(),this.fire(new s.A("data",{dataType:"style"})))}getImage(a){return this.imageManager.getImage(a,this.scope)}removeImage(a){return this.getImage(a)?(this.imageManager.removeImage(a,this.scope),this._changes.updateImage(a,this.scope),this._updateWorkerImages(),this.fire(new s.A("data",{dataType:"style"})),this):this.fire(new s.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(a){return this.modelManager.addModelURLs(a,this.scope),this._updateWorkerModels(),this.fire(new s.A("data",{dataType:"style"})),this}addModel(a,d,v={}){return this._checkLoaded(),this._validate(Te,`models.${a}`,d,null,v)||(this.modelManager.addModel(a,d,this.scope),this.fire(new s.A("data",{dataType:"style"}))),this}hasModel(a){return this.modelManager.hasModel(a,this.scope)}removeModel(a){return this.hasModel(a)?(this.modelManager.removeModel(a,this.scope,!1,!0),this.fire(new s.A("data",{dataType:"style"})),this):this.fire(new s.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(a,d,v={}){if(this._checkLoaded(),this.getOwnSource(a)!==void 0)throw new Error(`There is already a source with ID "${a}".`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(bs,`sources.${a}`,d,null,v))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const S=Dl(a,d,this.dispatcher,this);S.scope=this.scope,S.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(S.id),source:S.serialize(),sourceId:S.id})));const A=P=>{const O=(P?"symbol:":"other:")+S.id,I=s.C(O,this.scope),H=this._sourceCaches[O]=new $a(I,S,P);(P?this._symbolSourceCaches:this._otherSourceCaches)[S.id]=H,H.onAdd(this.map)};A(!1),d.type!=="vector"&&d.type!=="geojson"||A(!0),S.onAdd&&S.onAdd(this.map),v.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(a){this._checkLoaded();const d=this.getOwnSource(a);if(!d)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===a)return this.fire(new s.z(new Error(`Source "${a}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===a)return this.fire(new s.z(new Error(`Source "${a}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const S=Object.entries(this.stylesheet.iconsets).find((([A,P])=>P.type==="source"&&P.source===a));if(S)return this.fire(new s.z(new Error(`Source "${a}" cannot be removed while iconset "${S[0]}" is using it.`)))}const v=this.getOwnSourceCaches(a);for(const S of v){const A=s.dj(S.id);delete this._sourceCaches[A],this._changes.discardSourceCacheUpdate(S.id),S.fire(new s.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles()}return delete this._otherSourceCaches[a],delete this._symbolSourceCaches[a],this.mergeSources(),d.setEventedParent(null),d.onRemove&&d.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(a,d){this._checkLoaded(),this.getOwnSource(a).setData(d),this._changes.setDirty()}getOwnSource(a){const d=this.getOwnSourceCache(a);return d&&d.getSource()}getOwnSources(){const a=[];for(const d in this._otherSourceCaches){const v=this.getOwnSourceCache(d);v&&a.push(v.getSource())}return a}areTilesLoaded(){const a=this._mergedSourceCaches;for(const d in a){const v=a[d]._tiles;for(const S in v){const A=v[S];if(A.state!=="loaded"&&A.state!=="errored")return!1}}return!0}setLights(a){if(this._checkLoaded(),!a)return delete this.ambientLight,void delete this.directionalLight;const d=this._getTransitionParameters();for(const A of a){if(this._validate(Vr,"lights",A))return;switch(A.type){case"ambient":if(this.ambientLight){const P=this.ambientLight;P.set(A),P.updateTransitions(d)}else this.ambientLight=new fr(A,ai||(ai=new s.a7({color:new s.a8(s.a5.properties_light_ambient.color),"color-use-theme":new s.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new s.a8(s.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const P=this.directionalLight;P.set(A),P.updateTransitions(d)}else this.directionalLight=new fr(A,ws||(ws=new s.a7({direction:new s.an(s.a5.properties_light_directional.direction),color:new s.a8(s.a5.properties_light_directional.color),"color-use-theme":new s.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new s.a8(s.a5.properties_light_directional.intensity),"cast-shadows":new s.a8(s.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new s.a8(s.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new s.a8(s.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const v=Object.assign(d,{worldview:this.map.getWorldview()}),S=new s.aa(this.z||0,v);this.ambientLight&&this.ambientLight.recalculate(S),this.directionalLight&&this.directionalLight.recalculate(S),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const a=this.directionalLight,d=this.ambientLight;if(!a||!d)return;const v=J=>.2126*(J[0]<=.03928?J[0]/12.92:Math.pow((J[0]+.055)/1.055,2.4))+.7152*(J[1]<=.03928?J[1]/12.92:Math.pow((J[1]+.055)/1.055,2.4))+.0722*(J[2]<=.03928?J[2]/12.92:Math.pow((J[2]+.055)/1.055,2.4)),S=a.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),A=a.properties.get("intensity"),P=a.properties.get("direction"),O=1-s.d1(P.x,P.y,P.z)[2]/90,I=v(S)*A*O,H=d.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),G=d.properties.get("intensity"),ne=v(H)*G;return Number(((I+ne)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const a=[];return this.directionalLight&&a.push(this.directionalLight.get()),this.ambientLight&&a.push(this.ambientLight.get()),a}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(a){if(a==null||a===""&&this.isRootStyle())return this;if(s.dk(a)){const d=s.dl(a),v=this.fragments.find((({id:A})=>A===d));if(!v)return;const S=s.dj(a);return v.style.getFragmentStyle(S)}{const d=this.fragments.find((({id:v})=>v===a));return d?d.style:void 0}}setFeaturesetSelectors(a){if(!a)return;const d={},v=(S,A="")=>`${S}::${A}`;this._featuresetSelectors={};for(const S in a){const A=this._featuresetSelectors[S]=[];for(const P of a[S].selectors){if(P.featureNamespace){const I=this.getOwnLayer(P.layer);if(!I){s.w(`Layer is undefined for selector: ${P.layer}`);continue}const H=v(I.source,I.sourceLayer);if(H in d&&d[H]!==P.featureNamespace){s.w(`"featureNamespace ${P.featureNamespace} of featureset ${S}'s selector is not associated to the same source, skip this selector`);continue}d[H]=P.featureNamespace}let O;if(P.properties)for(const I in P.properties){const H=s.X(P.properties[I]);H.result==="success"&&(O=O||{},O[I]=H.value)}A.push({layerId:P.layer,namespace:P.featureNamespace,properties:O,uniqueFeatureID:P._uniqueFeatureID})}}}getFeaturesetDescriptors(a){const d=this.getFragmentStyle(a);if(!d||!d.stylesheet.featuresets)return[];const v=[];for(const S in d.stylesheet.featuresets)v.push({featuresetId:S,importId:d.scope?d.scope:void 0});return v}getFeaturesetLayers(a,d){const v=this.getFragmentStyle(d),S=v.stylesheet.featuresets;if(!S||!S[a])return this.fire(new s.z(new Error(`The featureset '${a}' does not exist in the map's style and cannot be queried.`))),[];const A=[];for(const P of S[a].selectors){const O=v.getOwnLayer(P.layer);O&&A.push(O)}return A}getConfigProperty(a,d){const v=this.getFragmentStyle(a);if(!v)return null;const S=s.C(d,v.scope),A=v.options.get(S),P=A?A.value||A.default:null;return P?P.serialize():null}setConfigProperty(a,d,v){const S=this.getFragmentStyle(a);if(!S)return;const A=S.stylesheet.indoor?Yf(S.stylesheet.schema):S.stylesheet.schema;if(!A||!A[d])return;const P=s.X(v);if(P.result!=="success")return void ku(this,P.value);const O=P.value.expression,I=s.C(d,S.scope),H=S.options.get(I);if(!H)return;let G;const{minValue:ne,maxValue:J,stepValue:re,type:de,values:ce}=A[d],pe=s.X(A[d].default);pe.result==="success"&&(G=pe.value.expression),G?(this.options.set(I,Object.assign({},H,{value:O,default:G,minValue:ne,maxValue:J,stepValue:re,type:de,values:ce})),this.updateConfigDependencies(d)):this.fire(new s.z(new Error(`No schema defined for the config option "${d}" in the "${a}" fragment.`)))}getConfig(a){const d=this.getFragmentStyle(a);if(!d)return null;const v=d.stylesheet.schema;if(!v)return null;const S={};for(const A in v){const P=s.C(A,d.scope),O=d.options.get(P),I=O?O.value||O.default:null;S[A]=I?I.serialize():null}return S}setConfig(a,d){const v=this.getFragmentStyle(a);v&&(v.updateConfig(d,v.stylesheet.schema),this.updateConfigDependencies())}getSchema(a){const d=this.getFragmentStyle(a);return d?d.stylesheet.schema:null}setSchema(a,d){const v=this.getFragmentStyle(a);v&&(v.stylesheet.schema=d,v.updateConfig(v._config,d),this.updateConfigDependencies())}updateConfig(a,d){if(this._config=a,a||d)if(d)for(const v in d){let S,A;const P=s.X(d[v].default);if(P.result==="success"&&(S=P.value.expression),a&&a[v]!==void 0){const J=s.X(a[v]);J.result==="success"&&(A=J.value.expression)}const{minValue:O,maxValue:I,stepValue:H,type:G,values:ne}=d[v];if(S){const J=s.C(v,this.scope);this.options.set(J,{default:S,value:A,minValue:O,maxValue:I,stepValue:H,type:G,values:ne})}else this.fire(new s.z(new Error(`No schema defined for config option "${v}".`)))}else this.fire(new s.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(a){for(const d of this._configDependentLayers){const v=this.getLayer(d);if(v){if(a&&!v.configDependencies.has(a))continue;v.possiblyEvaluateVisibility(),this._updateLayer(v)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle((d=>{const v=d._styleColorTheme.colorThemeOverride?d._styleColorTheme.colorThemeOverride:d._styleColorTheme.colorTheme;if(v){const S=d._evaluateColorThemeData(v);(!d._styleColorTheme.lut&&S!==""||d._styleColorTheme.lut&&S!==d._styleColorTheme.lut.data)&&d.setColorTheme(v)}})),this._changes.setDirty()}addLayer(a,d,v={}){this._checkLoaded();const S=a.id;if(this._layers[S])return void this.fire(new s.z(new Error(`Layer with id "${S}" already exists on this map`)));let A;if(a.type==="custom"){if(ku(this,s.dm(a)))return;A=s.dn(a,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof a.source=="object"&&(this.addSource(S,a.source),a=s.di(a),a=s.h(a,{source:S})),this._validate(Dr,`layers.${S}`,a,{arrayIndex:-1},v))return;A=s.dn(a,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(A),A.setEventedParent(this,{layer:{id:S}})}A.configDependencies.size!==0&&this._configDependentLayers.add(A.fqid);let P=this._order.length;if(d){const G=this._order.indexOf(d);if(G===-1)return void this.fire(new s.z(new Error(`Layer with id "${d}" does not exist on this map.`)));A.slot===this._layers[d].slot?P=G:s.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(P,0,S),this._layerOrderChanged=!0,this._layers[S]=A;const O=this.getOwnLayerSourceCache(A),I=!!this.directionalLight&&this.directionalLight.shadowsEnabled();O&&A.canCastShadows()&&I&&(O.castsShadows=!0);const H=this._changes.getRemovedLayer(A);if(H&&A.source&&O&&A.type!=="custom"){this._changes.discardLayerRemoval(A);const G=s.C(A.source,A.scope);H.type!==A.type?this._changes.updateSourceCache(G,"clear"):(this._changes.updateSourceCache(G,"reload"),O.pause())}this._updateLayer(A),A.onAdd&&A.onAdd(this.map),A.scope=this.scope,this.mergeLayers()}moveLayer(a,d){this._checkLoaded();const v=this._checkLayer(a);if(!v||a===d)return;const S=this._order.indexOf(a);this._order.splice(S,1);let A=this._order.length;if(d){const P=this._order.indexOf(d);if(P===-1)return void this.fire(new s.z(new Error(`Layer with id "${d}" does not exist on this map.`)));v.slot===this._layers[d].slot?A=P:s.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(A,0,a),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(a){this._checkLoaded();const d=this._checkLayer(a);if(!d)return;d.setEventedParent(null);const v=this._order.indexOf(a);this._order.splice(v,1),delete this._layers[a],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(d.fqid),this._changes.removeLayer(d);const S=this.getOwnLayerSourceCache(d);if(S&&S.castsShadows){let A=!1;for(const P in this._layers)if(this._layers[P].source===d.source&&this._layers[P].canCastShadows()){A=!0;break}S.castsShadows=A}d.onRemove&&d.onRemove(this.map),this.mergeLayers()}getOwnLayer(a){return this._layers[a]}hasLayer(a){return a in this._mergedLayers}hasLayerType(a){for(const d in this._layers)if(this._layers[d].type===a)return!0;return!1}setLayerZoomRange(a,d,v){this._checkLoaded();const S=this._checkLayer(a);S&&(S.minzoom===d&&S.maxzoom===v||(d!=null&&(S.minzoom=d),v!=null&&(S.maxzoom=v),this._updateLayer(S)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(a,d){this._checkLoaded();const v=this._checkLayer(a);v&&v.slot!==d&&(v.slot=d,this._updateLayer(v))}setFilter(a,d,v={}){this._checkLoaded();const S=this._checkLayer(a);if(S&&!s.bv(S.filter,d))return d==null?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(gt,`layers.${S.id}.filter`,d,{layerType:S.type},v)||(S.filter=s.di(d),this._updateLayer(S)))}getFilter(a){const d=this._checkLayer(a);if(d)return s.di(d.filter)}setLayoutProperty(a,d,v,S={}){this._checkLoaded();const A=this._checkLayer(a);if(A&&!s.bv(A.getLayoutProperty(d),v)){if(v!=null&&(!S||S.validate!==!1)&&ku(A,fe.call(Ji,{key:`layers.${a}.layout.${d}`,layerType:A.type,objectKey:d,value:v,styleSpec:s.a5,style:{glyphs:!0,sprite:!0}})))return;A.setLayoutProperty(d,v),A.configDependencies.size!==0&&this._configDependentLayers.add(A.fqid),this._updateLayer(A)}}getLayoutProperty(a,d){const v=this._checkLayer(a);if(v)return v.getLayoutProperty(d)}setPaintProperty(a,d,v,S={}){this._checkLoaded();const A=this._checkLayer(a);if(!A||s.bv(A.getPaintProperty(d),v)||v!=null&&(!S||S.validate!==!1)&&ku(A,Q.call(Ji,{key:`layers.${a}.paint.${d}`,layerType:A.type,objectKey:d,value:v,styleSpec:s.a5})))return;const P=A.setPaintProperty(d,v);A.configDependencies.size!==0&&this._configDependentLayers.add(A.fqid),P&&this._updateLayer(A),this._changes.updatePaintProperties(A)}getPaintProperty(a,d){const v=this._checkLayer(a);if(v)return v.getPaintProperty(d)}setFeatureState(a,d){if(this._checkLoaded(),"target"in a){if("featuresetId"in a.target){const{featuresetId:I,importId:H}=a.target,G=this.getFragmentStyle(H),ne=G.getFeaturesetLayers(I);for(const{source:J,sourceLayer:re}of ne)G.setFeatureState({id:a.id,source:J,sourceLayer:re},d)}else if("layerId"in a.target){const{layerId:I}=a.target,H=this.getLayer(I);this.setFeatureState({id:a.id,source:H.source,sourceLayer:H.sourceLayer},d)}return}const v=a.source,S=a.sourceLayer,A=this._checkSource(v);if(!A)return;const P=A.type;if(P==="geojson"&&S)return void this.fire(new s.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(P==="vector"&&!S)return void this.fire(new s.z(new Error("The sourceLayer parameter must be provided for vector source types.")));a.id===void 0&&this.fire(new s.z(new Error("The feature id parameter must be provided.")));const O=this.getOwnSourceCaches(v);for(const I of O)I.setFeatureState(S,a.id,d)}removeFeatureState(a,d){if(this._checkLoaded(),"target"in a){if("featuresetId"in a.target){const{featuresetId:I,importId:H}=a.target,G=this.getFragmentStyle(H),ne=G.getFeaturesetLayers(I);for(const{source:J,sourceLayer:re}of ne)G.removeFeatureState({id:a.id,source:J,sourceLayer:re},d)}else if("layerId"in a.target){const{layerId:I}=a.target,H=this.getLayer(I);this.removeFeatureState({id:a.id,source:H.source,sourceLayer:H.sourceLayer},d)}return}const v=a.source,S=this._checkSource(v);if(!S)return;const A=S.type,P=A==="vector"?a.sourceLayer:void 0;if(A==="vector"&&!P)return void this.fire(new s.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(d&&typeof a.id!="string"&&typeof a.id!="number")return void this.fire(new s.z(new Error("A feature id is required to remove its specific state property.")));const O=this.getOwnSourceCaches(v);for(const I of O)I.removeFeatureState(P,a.id,d)}getFeatureState(a){if(this._checkLoaded(),"target"in a){let A;if("featuresetId"in a.target){const{featuresetId:P,importId:O}=a.target,I=this.getFragmentStyle(O),H=I.getFeaturesetLayers(P);for(const{source:G,sourceLayer:ne}of H){const J=I.getFeatureState({id:a.id,source:G,sourceLayer:ne});if(J&&!A)A=J;else if(!s.bv(A,J))return void this.fire(new s.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in a.target){const{layerId:P}=a.target,O=this.getLayer(P);A=this.getFeatureState({id:a.id,source:O.source,sourceLayer:O.sourceLayer})}return A}const d=a.source,v=a.sourceLayer,S=this._checkSource(d);if(S){if(S.type!=="vector"||v)return a.id===void 0&&this.fire(new s.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(d)[0].getFeatureState(v,a.id);this.fire(new s.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(a){return this.stylesheet.transition=s.h({},this.stylesheet.transition,a),this.transition=this.stylesheet.transition,this}getTransition(){return s.h({},this.stylesheet.transition)}serialize(){this._checkLoaded();const a=this.getTerrain(),d=a&&this.terrain&&this.terrain.scope===this.scope?a:this.stylesheet.terrain;return s.dp({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:d,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},(v=>v!==void 0))}_updateFilteredLayers(a){for(const d of Object.values(this._mergedLayers))a(d)&&this._updateLayer(d)}_updateLayer(a){this._changes.updateLayer(a);const d=this.getLayerSourceCache(a),v=s.C(a.source,a.scope),S=this._changes.getUpdatedSourceCaches();a.source&&!S[v]&&d&&d.getSource().type!=="raster"&&(this._changes.updateSourceCache(v,"reload"),d.pause()),a.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(a){const d=O=>this._mergedLayers[O].is3D(!!this.terrain),v=this.order,S={},A=[];for(let O=v.length-1;O>=0;O--){const I=v[O];if(d(I)){S[I]=O;for(const H of a){const G=H[I];if(G)for(const ne of G)A.push(ne)}}}A.sort(((O,I)=>I.intersectionZ-O.intersectionZ));const P=[];for(let O=v.length-1;O>=0;O--){const I=v[O];if(d(I))for(let H=A.length-1;H>=0;H--){const G=A[H].feature;if(G.layer&&S[G.layer.id]<O)break;P.push(G),A.pop()}else for(const H of a){const G=H[I];if(G)for(const ne of G)P.push(ne.feature)}}return P}queryRenderedFeatures(a,d,v){let S;d&&!Array.isArray(d)&&d.filter&&(this._validate(gt,"queryRenderedFeatures.filter",d.filter,null,d),S=s.b3(d.filter));const A={},P=G=>{if(gm.has(G.type))return;const ne=this.getOwnLayerSourceCache(G),J=A[ne.id]=A[ne.id]||{sourceCache:ne,layers:{},has3DLayers:!1};G.is3D(!!this.terrain)&&(J.has3DLayers=!0),J.layers[G.fqid]=J.layers[G.fqid]||{styleLayer:G,targets:[]},J.layers[G.fqid].targets.push({filter:S})};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new s.z(new Error("parameters.layers must be an Array."))),[];for(const G of d.layers){const ne=this._layers[G];if(!ne)return this.fire(new s.z(new Error(`The layer '${G}' does not exist in the map's style and cannot be queried for features.`))),[];P(ne)}}else for(const G in this._layers)P(this._layers[G]);const O=this._queryRenderedFeatures(a,A,v),I=this._flattenAndSortRenderedFeatures(O),H=[];for(const G of I)s.dq(G.layer.id)===this.scope&&H.push(G);return H}queryRenderedFeatureset(a,d,v){let S;d&&!Array.isArray(d)&&d.filter&&(this._validate(gt,"queryRenderedFeatures.filter",d.filter,null,d),S=s.b3(d.filter));const A="mock",P=[];if(d&&d.target)P.push(Object.assign({},d,{targetId:A,filter:S}));else{const G=this.getFeaturesetDescriptors();for(const ne of G)P.push({targetId:A,filter:S,target:ne});for(const{style:ne}of this.fragments){const J=ne.getFeaturesetDescriptors();for(const re of J)P.push({targetId:A,filter:S,target:re})}}const O=this.queryRenderedTargets(a,P,v),I=[],H=new Set;for(const G of O)for(const ne of G.variants[A])Nu(ne,G,H)||I.push(new s.dr(G,ne));return I}queryRenderedTargets(a,d,v){const S={},A=(O,I,H,G)=>{const ne=S[I.id]=S[I.id]||{sourceCache:I,layers:{},has3DLayers:!1};if(ne.layers[O.fqid]=ne.layers[O.fqid]||{styleLayer:O,targets:[]},O.is3D(!!this.terrain)&&(ne.has3DLayers=!0),!G)return H.uniqueFeatureID=!1,void ne.layers[O.fqid].targets.push(H);ne.layers[O.fqid].targets.push(Object.assign({},H,{namespace:G.namespace,properties:G.properties,uniqueFeatureID:G.uniqueFeatureID}))};for(const O of d)if("featuresetId"in O.target){const{featuresetId:I,importId:H}=O.target,G=this.getFragmentStyle(H);if(!G||!G._featuresetSelectors)continue;const ne=G._featuresetSelectors[I];if(!ne){this.fire(new s.z(new Error(`The featureset '${I}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const J of ne){const re=G.getOwnLayer(J.layerId);re&&!gm.has(re.type)&&A(re,G.getOwnLayerSourceCache(re),O,J)}}else if("layerId"in O.target){const{layerId:I}=O.target,H=this.getLayer(I);if(!H||gm.has(H.type))continue;A(H,this.getLayerSourceCache(H),O)}const P=this._queryRenderedFeatures(a,S,v);return this._flattenAndSortRenderedFeatures(P)}_queryRenderedFeatures(a,d,v){const S=[],A=!!this.map._showQueryGeometry,P=di.createFromScreenPoints(a,v);for(const O in d){const I=ru(P,d[O],this._availableImages,v,A);Object.keys(I).length&&S.push(I)}if(this.placement)for(const O in d){if(!d[O].sourceCache._onlySymbols)continue;const I=fc(P.screenGeometry,d[O],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData,this.map.getWorldview());Object.keys(I).length&&S.push(I)}return S}querySourceFeatures(a,d){const v=d&&d.filter;v&&this._validate(gt,"querySourceFeatures.filter",v,null,d);let S=[];const A=this.getOwnSourceCaches(a);for(const P of A)S=S.concat(Xa(P,d));return S}addSourceType(a,d,v){return Lc.getSourceType(a)?v(new Error(`A source type called "${a}" already exists.`)):(Lc.setSourceType(a,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:d.workerSourceURL},v):v(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(a,d,v={}){this._checkLoaded();const S=this.light.getLight();let A=!1;for(const O in a)if(!s.bv(a[O],S[O])){A=!0;break}if(!A)return;const P=this._getTransitionParameters();this.light.setLight(a,d,v),this.light.updateTransitions(P)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=s.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&s.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(a,d=1){if(this._checkLoaded(),!a)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),d===0&&delete this.terrain,a===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let v=a;const S=a.source==null;if(d===1){if(this.disableElevatedTerrain)return;if(typeof v.source=="object"){const O="terrain-dem-src";this.addSource(O,v.source),v=s.di(v),v=s.h(v,{source:O})}const A=s.h({},v),P={};if(this.terrain&&S){A.source=this.terrain.get().source;const O=this.terrain?this.getFragmentStyle(this.terrain.scope):null;O&&(P.style=O.serialize())}if(this._validate(Rt,"terrain",A,P))return}if(!this.terrain||this.terrain.scope!==this.scope&&!S||this.terrain&&d!==this.terrain.drapeRenderMode){if(!v)return;this._createTerrain(v,d),this.fire(new s.A("data",{dataType:"style"}))}else{const A=this.terrain,P=A.get();for(const O of Object.keys(s.a5.terrain))!v.hasOwnProperty(O)&&s.a5.terrain[O].default&&(v[O]=s.a5.terrain[O].default);for(const O in a)if(!s.bv(a[O],P[O])){A.set(a,this.options),this.stylesheet.terrain=a;const I=this._getTransitionParameters({duration:0});A.updateTransitions(I),this.fire(new s.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(a){const d=this.fog=new Gr(a,this.map.transform,this.scope,this.options);this.stylesheet.fog=d.get();const v=this._getTransitionParameters({duration:0});d.updateTransitions(v)}_createSnow(a){const d=this.snow=new Ks(a,this.map.transform,this.scope,this.options);this.stylesheet.snow=d.get();const v=this._getTransitionParameters({duration:0});d.updateTransitions(v)}_createRain(a){const d=this.rain=new ca(a,this.map.transform,this.scope,this.options);this.stylesheet.rain=d.get();const v=this._getTransitionParameters({duration:0});d.updateTransitions(v)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask((()=>{for(const a of this.map._markers)a._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(a){if(this._checkLoaded(),!a)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const d=this.fog;if(!s.bv(d.get(),a)){d.set(a,this.options),this.stylesheet.fog=d.get();const v=this._getTransitionParameters({duration:0});d.updateTransitions(v)}}else this._createFog(a);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(a){if(this._checkLoaded(),!a)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const d=this.snow;if(!s.bv(d.get(),a)){d.set(a,this.options),this.stylesheet.snow=d.get();const v=this._getTransitionParameters({duration:0});d.updateTransitions(v)}}else this._createSnow(a);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(a){if(this._checkLoaded(),!a)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const d=this.rain;if(!s.bv(d.get(),a)){d.set(a,this.options),this.stylesheet.rain=d.get();const v=this._getTransitionParameters({duration:0});d.updateTransitions(v)}}else this._createRain(a);this._markersNeedUpdate=!0}_reloadColorTheme(){const a=()=>{for(const S in this._layers)this._layers[S].lut=this._styleColorTheme.lut;for(const S in this._sourceCaches)this._sourceCaches[S].clearTiles()},d=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!d)return this._styleColorTheme.lut=null,void a();const v=this._evaluateColorThemeData(d);this._loadColorTheme(v).then((()=>{this.fire(new s.A("colorthemeset")),a()})).catch((S=>{s.w(`Couldn't set color theme: ${S}`)}))}setColorTheme(a){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&s.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=a,this._reloadColorTheme()}setImportColorTheme(a,d){const v=this.getFragmentStyle(a);v&&(v._styleColorTheme.colorThemeOverride=d,v._reloadColorTheme())}_getTransitionParameters(a){return{now:s.q.now(),transition:s.h(this.transition,a)}}updateDrapeFirstLayers(){if(!this.terrain)return;const a=[],d=[];for(const v of this._mergedOrder)this.isLayerDraped(this._mergedLayers[v])?a.push(v):d.push(v);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...a),this._drapedFirstOrder.push(...d)}_createTerrain(a,d){const v=this.terrain=new ht(a,d,this.scope,this.options,this.map.getWorldview());d===1&&(this.stylesheet.terrain=a),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const S=this._getTransitionParameters({duration:0});v.updateTransitions(S)}_force3DLayerUpdate(){for(const a in this._layers){const d=this._layers[a];d.type==="fill-extrusion"&&this._updateLayer(d)}}_forceSymbolLayerUpdate(){for(const a in this._layers){const d=this._layers[a];d.type==="symbol"&&this._updateLayer(d)}}_validate(a,d,v,S,A={}){if(A&&A.validate===!1)return!1;const P=s.h({},this.serialize());return ku(this,a.call(Ji,s.h({key:d,style:P,value:v,styleSpec:s.a5},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.ds.off("pluginStateChange",this._rtlTextPluginCallback);for(const a in this._mergedLayers)this._mergedLayers[a].setEventedParent(null);for(const a in this._mergedSourceCaches)this._mergedSourceCaches[a].clearTiles(),this._mergedSourceCaches[a].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(a){const d=this.getSourceCaches(a);for(const v of d)v.clearTiles()}clearSources(){for(const a in this._mergedSourceCaches)this._mergedSourceCaches[a].clearTiles()}clearLayers(){for(const a in this._mergedLayers){const d=this._mergedLayers[a];d._clear&&d._clear()}}reloadSource(a){const d=this.getSourceCaches(a);for(const v of d)v.resume(),v.reload()}reloadSources(){for(const a of this.getSources())a.reload&&a.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle((a=>{a.modelManager.reloadModels(a.scope)}))}updateSources(a){let d;this.directionalLight&&(d=Xh(this.directionalLight));const v=new Set;for(const S in this._mergedLayers){const A=this._mergedLayers[S];A.hasElevation()&&!v.has(A.source)&&v.add(A.source)}for(const S in this._mergedSourceCaches){const A=this._mergedSourceCaches[S],P=v.has(A._source.id);A.update(a,void 0,void 0,d,P)}}_generateCollisionBoxes(){for(const a in this._sourceCaches){const d=this._sourceCaches[a];d.resume(),d.reload()}}_updatePlacement(a,d,v,S,A,P,O=!1){let I=!1,H=!1;const G={},ne={};for(const J of this._mergedOrder){const re=this._mergedLayers[J];if(re.type!=="symbol")continue;const de=s.C(re.source,re.scope);let ce=G[de];if(!ce){const me=this.getLayerSourceCache(re);if(!me)continue;const be=me.getRenderableIds(!0).map((Ne=>me.getTileByID(Ne)));ne[de]=be.slice(),ce=G[de]=be.sort(((Ne,De)=>De.tileID.overscaledZ-Ne.tileID.overscaledZ||(Ne.tileID.isLessThan(De.tileID)?-1:1)))}const pe=this.crossTileSymbolIndex.addLayer(re,ce,d.center.lng,d.projection);I=I||pe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),O=O||this._layerOrderChanged||S===0,this._layerOrderChanged&&this.fire(new s.A("neworder")),(O||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.q.now(),d.zoom))&&(this.pauseablePlacement=new $s(d,this._mergedOrder,O,v,S,A,this.placement,this.fog&&d.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,G,ne,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.q.now()),H=!0),I&&this.pauseablePlacement.placement.setStale()),H||I){this._buildingIndex.onNewFrame(d.zoom);for(let J=0;J<this._mergedOrder.length;J++){const re=this._mergedLayers[this._mergedOrder[J]];if(re.type!=="symbol")continue;const de=this.isLayerClipped(re);this.placement.updateLayerOpacities(re,G[s.C(re.source,re.scope)],J,de?P:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.q.now())}}_releaseSymbolFadeTiles(){for(const a in this._sourceCaches)this._sourceCaches[a].releaseSymbolFadeTiles()}addImport(a,d){this._checkLoaded();const v=this.stylesheet.imports=this.stylesheet.imports||[];if(v.findIndex((({id:A})=>A===a.id))!==-1)return void this.fire(new s.z(new Error(`Import with id '${a.id}' already exists in the map's style.`)));if(!d)return v.push(a),this._loadImports([a],!0);const S=v.findIndex((({id:A})=>A===d));return S===-1&&this.fire(new s.z(new Error(`Import with id "${d}" does not exist on this map.`))),this.stylesheet.imports=v.slice(0,S).concat(a).concat(v.slice(S)),this._loadImports([a],!0,d)}updateImport(a,d){this._checkLoaded();const v=this.stylesheet.imports||[],S=this.getImportIndex(a);return S===-1?this:typeof d=="string"?(this.setImportUrl(a,d),this):(d.url&&d.url!==v[S].url&&this.setImportUrl(a,d.url),s.bv(d.config,v[S].config)||this.setImportConfig(a,d.config,d.data.schema),s.bv(d.data,v[S].data)||this.setImportData(a,d.data),this)}moveImport(a,d){this._checkLoaded();let v=this.stylesheet.imports||[];const S=this.getImportIndex(a);if(S===-1)return this;const A=this.getImportIndex(d);if(A===-1)return this;const P=v[S],O=this.fragments[S];return v=v.filter((({id:I})=>I!==a)),this.fragments=this.fragments.filter((({id:I})=>I!==a)),this.stylesheet.imports=v.slice(0,A).concat(P).concat(v.slice(A)),this.fragments=this.fragments.slice(0,A).concat(O).concat(this.fragments.slice(A)),this.mergeLayers(),this}setImportUrl(a,d){this._checkLoaded();const v=this.stylesheet.imports||[],S=this.getImportIndex(a);if(S===-1)return this;v[S].url=d;const A=this.fragments[S];return A.style=this._createFragmentStyle(v[S]),A.style.on("style.import.load",(()=>this.mergeAll())),A.style.loadURL(d),this}setImportData(a,d){this._checkLoaded();const v=this.getImportIndex(a),S=this.stylesheet.imports||[];return v===-1?this:d?(this.fragments[v].style.setState(d),this._reloadImports(),this):(delete S[v].data,this.setImportUrl(a,S[v].url))}setImportConfig(a,d,v){this._checkLoaded();const S=this.getImportIndex(a),A=this.stylesheet.imports||[];if(S===-1)return this;d?A[S].config=d:delete A[S].config;const P=this.fragments[S];v&&P.style.stylesheet&&(P.style.stylesheet.schema=v);const O=P.style.stylesheet&&P.style.stylesheet.schema;return P.config=d,P.style.updateConfig(d,O),this.updateConfigDependencies(),this}removeImport(a){this._checkLoaded();const d=this.stylesheet.imports||[],v=this.getImportIndex(a);v!==-1&&(d.splice(v,1),this.fragments[v].style._remove(),this.fragments.splice(v,1),this._reloadImports())}getImportIndex(a){const d=(this.stylesheet.imports||[]).findIndex((v=>v.id===a));return d===-1&&this.fire(new s.z(new Error(`Import '${a}' does not exist in the map's style and cannot be updated.`))),d}getLayer(a){return this._mergedLayers[a]}getSources(){const a=[];for(const d in this._mergedOtherSourceCaches){const v=this._mergedOtherSourceCaches[d];v&&a.push(v.getSource())}return a}getSource(a,d){const v=this.getSourceCache(a,d);return v&&v.getSource()}getLayerSource(a){const d=this.getLayerSourceCache(a);return d&&d.getSource()}getSourceCache(a,d){const v=s.C(a,d);return this._mergedOtherSourceCaches[v]}getLayerSourceCache(a){const d=s.C(a.source,a.scope);return a.type==="symbol"?this._mergedSymbolSourceCaches[d]:this._mergedOtherSourceCaches[d]}getSourceCaches(a){if(a==null)return Object.values(this._mergedSourceCaches);const d=[];return this._mergedOtherSourceCaches[a]&&d.push(this._mergedOtherSourceCaches[a]),this._mergedSymbolSourceCaches[a]&&d.push(this._mergedSymbolSourceCaches[a]),d}updateSourceCaches(){const a=this._changes.getUpdatedSourceCaches();for(const d in a){const v=a[d];v==="reload"?this.reloadSource(d):v==="clear"&&this.clearSource(d)}}updateLayers(a){const d=this._changes.getUpdatedPaintProperties();for(const v of d){const S=this.getLayer(v);S&&S.updateTransitions(a)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(a){this.stylesheet.glyphs=a,this.glyphManager.setURL(a)}getImages(a,d,v){this.imageManager.getImages(d.images,d.scope,v),this._updateTilesForChangedImages();const S=P=>{if(P){const O=d.images.map((I=>s.I.toString(I)));P.setDependencies(d.tileID.key,d.type,O)}},A=s.C(d.source,d.scope);S(this._mergedOtherSourceCaches[A]),S(this._mergedSymbolSourceCaches[A]),d.images.some((P=>P.iconsetId))&&this.fire(new s.A("data",{dataType:"style"}))}rasterizeImages(a,d,v){this.imageManager.rasterizeImages(d,v)}getGlyphs(a,d,v){this.glyphManager.getGlyphs(d.stacks,v)}getResource(a,d,v){return s.dt(d,v)}getOwnSourceCache(a){return this._otherSourceCaches[a]}getOwnLayerSourceCache(a){return a.type==="symbol"?this._symbolSourceCaches[a.source]:this._otherSourceCaches[a.source]}getOwnSourceCaches(a){const d=[];return this._otherSourceCaches[a]&&d.push(this._otherSourceCaches[a]),this._symbolSourceCaches[a]&&d.push(this._symbolSourceCaches[a]),d}_isSourceCacheLoaded(a){const d=this.getOwnSourceCaches(a);return d.length===0?(this.fire(new s.z(new Error(`There is no source with ID '${a}'`))),!1):d.every((v=>v.loaded()))}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(a,d){if(!this._clipLayerPresent&&a.type!=="fill-extrusion"&&a.type!=="building")return!1;const v=a.type==="fill-extrusion"&&(a.sourceLayer==="building"||a.sourceLayer==="procedural_buildings"),S=a.type==="building";if(a.is3D(!!this.terrain)){if(v||S||d&&d.type==="batched-model"||a.type==="model")return!0}else if(a.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach((a=>{a.style._remove()})),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Lc.getSourceType=function(y){return dc[y]},Lc.setSourceType=function(y,a){dc[y]=a},Lc.registerForPluginStateChange=s.du;var Nv=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,Jf=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Yh=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,$g="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Qf=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,ro=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,ym=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,mn=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,ec=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,ud=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,ep=`#ifdef RENDER_SHADOWS
precision highp sampler2DShadow;uniform sampler2DShadow u_shadowmap_0;uniform sampler2DShadow u_shadowmap_1;uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;float shadow_sample(sampler2DShadow shadowmap,highp vec3 pos,highp float bias) {
#ifdef CLIP_ZERO_TO_ONE
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z-bias);
#else
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z*0.5+0.5-bias);
#endif
return texture(shadowmap,coord);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;
#ifdef SHADOWS_SINGLE_CASCADE
vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);
#else
light_view_pos1.xyz/=light_view_pos1.w;vec4 abs_bounds=abs(vec4(light_view_pos0.xy,light_view_pos1.xy));if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}float occlusion1=shadow_sample(u_shadowmap_1,light_view_pos1.xyz,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const oh=[];_l(Nv,oh),_l(Yh,oh),_l(Jf,oh);const Iu={"_prelude_fog.vertex.glsl":ro,"_prelude_terrain.vertex.glsl":Qf,"_prelude_shadow.vertex.glsl":ud,"_prelude_fog.fragment.glsl":ym,"_prelude_shadow.fragment.glsl":ep,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":mn,"_prelude_raster_particle.glsl":ec},tc={};Pi("",Qf),Pi(ym,ro),Pi(ep,ud),Pi(mn,""),Pi(ec,"");const dd=Pi(Jf,Yh),hd=Nv;var lh={background:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
const float window_depth=0.5;const float ao_radius=0.2;in vec4 v_color;in highp vec3 v_normal;in highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
in lowp float v_faux_facade;in highp float v_faux_facade_ed;in highp vec2 v_faux_facade_window;in highp vec2 v_faux_facade_floor;in highp vec2 v_faux_facade_range;in highp float v_aspect;in highp vec3 v_tbn_0;in highp vec3 v_tbn_1;in highp vec3 v_tbn_2;in highp vec4 v_faux_color_emissive;uniform float u_faux_facade_ao_intensity;
#endif
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;uniform vec3 u_camera_pos;uniform highp float u_tile_to_meter;uniform float u_facade_emissive_chance;vec3 linearTosRGB(in vec3 color) {return pow(color,vec3(1./2.2));}
#ifdef BUILDING_FAUX_FACADE
float hash12(in vec2 p) {vec3 p3 =fract(vec3(p.xyx)*0.1031);p3+=dot(p3,p3.yzx+33.33);return fract((p3.x+p3.y)*p3.z);}float min3(in vec3 v) {return min(min(v.x,v.y),v.z);}vec2 get_uv_mask_id(in vec2 q,out float mask,out vec2 id) {vec2 p=q;mask=step(v_faux_facade_range.x,p.y)*step(p.y,v_faux_facade_range.y);p.y=p.y-v_faux_facade_range.x;vec2 uv=modf(p/v_faux_facade_floor,id);vec4 d=(v_faux_facade_floor.xyxy+vec4(-v_faux_facade_window,v_faux_facade_window))*0.5;vec4 edge=d/v_faux_facade_floor.xyxy;vec2 m=step(edge.xy,uv)*step(uv,edge.zw);mask*=m.x*m.y;uv-=vec2(0.5);uv*=vec2(0.5)/(vec2(0.5)-edge.xy);uv+=vec2(0.5);return uv;}float ray_unit_box(in vec3 ray_o,in vec3 ray_d,in vec3 bmin,in vec3 bmax) {vec3 planes=mix(bmin,bmax,step(0.0,ray_d));vec3 t=(planes-ray_o)/ray_d;return min3(t);}float get_emissive(in vec2 id) {if (u_facade_emissive_chance > 0.0) {return (step(hash12(id),u_facade_emissive_chance)+0.05)*v_faux_color_emissive.a;}return 0.0;}vec3 get_shade_info(in vec3 v,in vec3 v_normalized,in vec3 color,in vec2 id,in mat3 tbn,inout vec3 out_normal,inout float out_emissive) {vec3 out_color=color;vec3 abs_v=abs(v_normalized);bool x_major=abs_v.x >=abs_v.y && abs_v.x >=abs_v.z;bool y_major=abs_v.y >=abs_v.x && abs_v.y >=abs_v.z;bool z_major=abs_v.z >=abs_v.x && abs_v.z >=abs_v.y;
#if 0
if (x_major) {out_color=v.x > 0.0 ? vec3(1.0,0.0,0.0) : vec3(0.0,1.0,1.0);} else if (y_major) {out_color=v.y > 0.0 ? vec3(0.0,1.0,0.0) : vec3(1.0,0.0,1.0);} else if (z_major) {out_color=v.z > 0.0 ? vec3(0.0,0.0,1.0) : vec3(1.0,1.0,0.0);}out_emissive=1.0;
#else
if (x_major) {out_normal=sign(v.x)*tbn[0];} else if (y_major) {out_normal=vec3(0.0,0.0,-sign(v.y));} else if (z_major) {out_color=v_faux_color_emissive.rgb;out_emissive=v.z <=0.0 ? get_emissive(id) : out_emissive;}float ao=1.0;if (u_faux_facade_ao_intensity > 0.0) {vec4 ao_range=v_faux_facade_window.xxyy*0.5-vec4(0,ao_radius,0,ao_radius);vec2 ao_range_z=vec2(window_depth*0.5)-vec2(0.0,ao_radius);if (x_major || y_major) {ao*=smoothstep(-ao_range_z.x,-ao_range_z.y,v.z);} else if (z_major) {ao*=smoothstep(-ao_range.x,-ao_range.y,v.x)*(1.0-smoothstep(ao_range.y,ao_range.x,v.x));ao*=smoothstep(-ao_range.z,-ao_range.w,v.y)*(1.0-smoothstep(ao_range.w,ao_range.z,v.y));}ao=mix(1.0,min(1.0,ao+0.25),u_faux_facade_ao_intensity);}out_color*=ao;
#endif
return out_color;}
#endif
vec3 apply_lighting_linear(in vec3 color,in vec3 normal,in float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec3 normal=normalize(v_normal);vec3 base_color=v_color.rgb;float emissive=v_color.a;
#ifdef BUILDING_FAUX_FACADE
if (v_faux_facade > 0.0) {mat3 tbn=mat3(v_tbn_0,v_tbn_1,v_tbn_2);vec3 v=vec3(v_pos.xy,v_pos.z/u_tile_to_meter)-u_camera_pos;vec3 view_tangent=transpose(tbn)*v;vec2 q=vec2(v_faux_facade_ed,v_pos.z);float mask=0.0;vec2 id=vec2(0.0);vec2 uv=get_uv_mask_id(q,mask,id);uv*=v_faux_facade_window;vec3 bmin=vec3(0.0,0.0,-window_depth);vec3 bmax=bmin+vec3(v_faux_facade_window,window_depth);vec3 ray_o=vec3(uv,0.0);vec3 ray_d=normalize(view_tangent);float t_min=ray_unit_box(ray_o,ray_d,bmin,bmax);vec3 hit=ray_o+t_min*ray_d;vec3 r=vec3(v_faux_facade_window,-window_depth);hit-=r*0.5;vec3 normalized=hit/r;vec3 out_normal=normal;float out_emissive=emissive;vec3 room_color=get_shade_info(hit,normalized,base_color,id,tbn,out_normal,out_emissive);base_color=mix(base_color,room_color,mask);normal=mix(normal,out_normal,mask);emissive=mix(emissive,out_emissive,mask);}
#endif
vec4 color=vec4(base_color,1.0);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,base_color.rgb,emissive);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_pos.z));
#endif
color.rgb=linearTosRGB(color.rgb);color*=u_opacity;
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_pos.z);
#endif
glFragColor=color; 
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3;in vec3 a_centroid_3;in vec4 a_faux_facade_data;in vec2 a_faux_facade_vertical_range;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;uniform highp float u_tile_to_meter;out vec4 v_color;out vec3 v_normal;out highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
out lowp float v_faux_facade;out highp float v_faux_facade_ed;out highp vec2 v_faux_facade_window;out highp vec2 v_faux_facade_floor;out highp vec2 v_faux_facade_range;out highp float v_aspect;out highp vec3 v_tbn_0;out highp vec3 v_tbn_1;out highp vec3 v_tbn_2;out highp vec4 v_faux_color_emissive;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
const float MAX_UINT_16=65535.0;const float MAX_INT_16=32767.0;const float MAX_UINT_8=255.0;const float TWO_POW_8=256.0;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#ifdef BUILDING_FAUX_FACADE
mat3 get_tbn(in vec3 normal) {const vec3 bitangent=vec3(0.0,0.0,1.0);vec3 tangent=normalize(vec3(normal.y,-normal.x,0.0));return mat3(tangent,bitangent,normal);}
#endif
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 faux_facade_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute-custom highp vec2 faux_facade_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);vec3 a_normal_3f=a_normal_3/MAX_INT_16;v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));float hidden=0.0;
#ifdef BUILDING_FAUX_FACADE
v_faux_facade=a_faux_facade_data.x;if (v_faux_facade > 0.0) {v_faux_facade_ed=a_faux_facade_data.x *u_tile_to_meter;float window_x_perc=floor(a_faux_facade_data.y/TWO_POW_8);float window_y_perc=a_faux_facade_data.y-TWO_POW_8*window_x_perc;vec2 window_perc=vec2(window_x_perc,window_y_perc)/MAX_UINT_8;v_faux_facade_floor=(a_faux_facade_data.zw/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_faux_facade_window=window_perc*v_faux_facade_floor;v_faux_facade_range=(a_faux_facade_vertical_range/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_aspect=v_faux_facade_window.x/v_faux_facade_window.y;mat3 tbn=get_tbn(normalize(v_normal));v_tbn_0=tbn[0];v_tbn_1=tbn[1];v_tbn_2=tbn[2];v_faux_color_emissive=decode_color(faux_facade_color_emissive);v_faux_color_emissive.rgb=sRGBToLinear(v_faux_color_emissive.rgb);}
#endif
v_pos=a_pos_3f;
#ifdef RENDER_CUTOFF
vec4 ground=u_matrix*vec4(a_centroid_3,1.0);v_cutoff_opacity=cutoff_opacity(u_cutoff_params,ground.z);hidden=float(v_cutoff_opacity==0.0);v_pos.z*=v_cutoff_opacity;
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=v_pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(v_pos);
#endif
gl_Position=mix(u_matrix*vec4(v_pos,1),AWAY,hidden);}`),buildingBloom:Pi(`in vec4 v_color_emissive;
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
float saturate(float val) {return clamp(val,0.0,1.0);}void main() {float emission=v_color_emissive.a;float opacity=1.0;
#ifdef HAS_ATTRIBUTE_a_bloom_attenuation
float distance=length(vec2(1.3*max(0.0,abs(bloom_attenuation.x)-bloom_attenuation.z),bloom_attenuation.y));distance+= mix(0.5,0.0,clamp(emission-1.0,0.0,1.0));opacity*=saturate(1.0-distance*distance);
#endif
glFragColor=vec4(v_color_emissive.rgb,1.0)*opacity;}`,`in vec3 a_pos_3f;
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
out vec4 v_color_emissive;uniform mat4 u_matrix;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
#ifdef HAS_ATTRIBUTE_a_part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);float part_emissive=color_emissive.a*5.0;v_color_emissive=vec4(sRGBToLinear(color_emissive.rgb),part_emissive);
#else
v_color_emissive=vec4(1.0);
#endif
gl_Position=u_matrix*vec4(a_pos_3f,1.0);}`),buildingDepth:Pi(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Pi("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Pi(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Pi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Pi("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform float u_zoom_transition;
#endif
out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec3 proj_pos=a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation);
#ifdef PROJECTION_GLOBE_VIEW
#ifndef PROJECTED_POS_ON_VIEWPORT
vec3 globe_pos=proj_pos;vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,a_anchor_pos,u_tile_id,u_merc_center);proj_pos=mix_globe_mercator(globe_pos,mercator_pos,u_zoom_transition);
#endif
#endif
vec4 projectedPoint=u_matrix*vec4(proj_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Pi("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Pi("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:Pi(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:Pi(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}vec3 compute_view_dependent_emissive_color(float ndotl,float emissive_strength,vec3 color)
{color=sRGBToLinear(color);color=color*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);color=linearTosRGB(color.rgb);return color;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
vec3 color=structure_color.xyz;
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);vec3 transformed_normal=vec3(-normal.xy,normal.z);float ndotl=calculate_NdotL(transformed_normal);float emissive_strength=u_emissive_strength;emissive_strength=0.0;vec3 emissive_color=compute_view_dependent_emissive_color(ndotl,emissive_strength,color.xyz);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,transformed_normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,transformed_normal);
#endif
color=mix(color,emissive_color,emissive_strength);if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(-v_normal.xy,v_normal.z));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FLIP_Y
v_pos=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FLIP_Y
v_pos_world=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
#ifdef FEATURE_CUTOUT
color=apply_feature_cutout(color,gl_FragCoord);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);
#ifdef CLIP_ZERO_TO_ONE
cutoff=cutoff_opacity(u_cutoff_params,ground.z*2.0-ground.w);
#else
cutoff=cutoff_opacity(u_cutoff_params,ground.z);
#endif
if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Pi(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Pi(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Pi(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Pi(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Pi("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Pi("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Pi(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Pi(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef TERRAIN
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#else
out_color.rgb*=mix(v_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
}`),terrainRaster:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Pi("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Pi(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,$g),skyboxGradient:Pi(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,$g),skyboxCapture:Pi(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Pi(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Pi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;
#ifdef FLIP_Y
T=-T;B=-B;
#endif
highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));
#ifdef FLIP_Y
n=normalize(cross(fdx,fdy));
#else
n=normalize(cross(fdx,fdy))*-1.0;
#endif
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
#ifdef FEATURE_CUTOUT
finalColor=apply_feature_cutout(finalColor,gl_FragCoord);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Pi(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Pi(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:Pi("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:Pi("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:Pi("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:Pi("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function _l(y,a){const d=y.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let v of d)if(v=v.trim(),v[0]==="#"&&v.includes("if")&&!v.includes("endif")){v=v.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=v.split(" ");for(const A of S)a.includes(A)||a.push(A)}}function Pi(y,a){const d=/#include\s+"([^"]+)"/g,v=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let S=a.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);S&&(S=S.map((H=>{const G=H.split(" ");return G[G.length-1]})),S=[...new Set(S)]);const A={},P=[],O=[];if(y=y.replace(d,((H,G)=>(O.push(G),""))),(a=a.replace(d,((H,G)=>(P.push(G),"")))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let I=[...oh];_l(y,I),_l(a,I);for(const H of[...P,...O])Iu[H]||console.error(`Undefined include: ${H}`),tc[H]||(tc[H]=[],_l(Iu[H],tc[H])),I=[...I,...tc[H]];return{fragmentSource:y=y.replace(v,((H,G,ne,J,re)=>(A[re]=!0,G==="define"?`
#ifndef HAS_UNIFORM_u_${re}
in ${ne} ${J} ${re};
#else
uniform ${ne} ${J} u_${re};
#endif
`:G==="initialize"?`
#ifdef HAS_UNIFORM_u_${re}
    ${ne} ${J} ${re} = u_${re};
#endif
`:G==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${re}
    in ${ne} ${J} ${re};
#endif
`:G==="initialize-attribute"?"":void 0))),vertexSource:a=a.replace(v,((H,G,ne,J,re)=>{const de=J==="float"?"vec2":J,ce=re.match(/color/)?"color":de;return G==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${re}
in ${ne} ${J} a_${re};
#endif
`:A[re]?G==="define"?`
#ifndef HAS_UNIFORM_u_${re}
uniform lowp float u_${re}_t;
in ${ne} ${de} a_${re};
out ${ne} ${J} ${re};
#else
uniform ${ne} ${J} u_${re};
#endif
`:G==="initialize"?ce==="vec4"?`
#ifndef HAS_UNIFORM_u_${re}
    ${re} = a_${re};
#else
    ${ne} ${J} ${re} = u_${re};
#endif
`:`
#ifndef HAS_UNIFORM_u_${re}
    ${re} = unpack_mix_${ce}(a_${re}, u_${re}_t);
#else
    ${ne} ${J} ${re} = u_${re};
#endif
`:G==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${re}
    in ${ne} ${J} a_${re};
    out ${ne} ${J} ${re};
#endif
`:G==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${re}
    ${re} = a_${re};
#endif
`:void 0:G==="define"?`
#ifndef HAS_UNIFORM_u_${re}
uniform lowp float u_${re}_t;
in ${ne} ${de} a_${re};
#else
uniform ${ne} ${J} u_${re};
#endif
`:G==="define-instanced"?ce==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${re}0;
in vec4 a_${re}1;
in vec4 a_${re}2;
in vec4 a_${re}3;
#else
uniform ${ne} ${J} u_${re};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${ne} ${de} a_${re};
#else
uniform ${ne} ${J} u_${re};
#endif
`:G==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${re}
    ${ne} ${J} ${re} = a_${re};
#endif
`:ce==="vec4"?`
#ifndef HAS_UNIFORM_u_${re}
    ${ne} ${J} ${re} = a_${re};
#else
    ${ne} ${J} ${re} = u_${re};
#endif
`:`
#ifndef HAS_UNIFORM_u_${re}
    ${ne} ${J} ${re} = unpack_mix_${ce}(a_${re}, u_${re}_t);
#else
    ${ne} ${J} ${re} = u_${re};
#endif
`})),staticAttributes:S,usedDefines:I,vertexIncludes:P,fragmentIncludes:O}}class wc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(a,d,v,S,A,P,O,I){this.context=a;let H=this.boundPaintVertexBuffers.length!==S.length;for(let ne=0;!H&&ne<S.length;ne++)this.boundPaintVertexBuffers[ne]!==S[ne]&&(H=!0);let G=this.boundDynamicVertexBuffers.length!==O.length;for(let ne=0;!G&&ne<O.length;ne++)this.boundDynamicVertexBuffers[ne]!==O[ne]&&(G=!0);if(!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==v||H||G||this.boundIndexBuffer!==A||this.boundVertexOffset!==P)this.freshBind(d,v,S,A,P,O,I);else{a.bindVertexArrayOES.set(this.vao);for(const ne of O)ne&&(ne.bind(),I&&ne.instanceCount&&ne.setVertexAttribDivisor(a.gl,d,I));A&&A.dynamicDraw&&A.bind()}}freshBind(a,d,v,S,A,P,O){const I=a.numAttributes,H=this.context,G=H.gl;this.vao&&this.destroy(),this.vao=H.gl.createVertexArray(),H.bindVertexArrayOES.set(this.vao),this.boundProgram=a,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=v,this.boundIndexBuffer=S,this.boundVertexOffset=A,this.boundDynamicVertexBuffers=P,d.enableAttributes(G,a),d.bind(),d.setVertexAttribPointers(G,a,A);for(const ne of v)ne.enableAttributes(G,a),ne.bind(),ne.setVertexAttribPointers(G,a,A);for(const ne of P)ne&&(ne.enableAttributes(G,a),ne.bind(),ne.setVertexAttribPointers(G,a,A),O&&ne.instanceCount&&ne.setVertexAttribDivisor(G,a,O));S&&S.bind(),H.currentNumAttributes=I}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function vm(y,a){const d=Math.pow(2,a.canonical.z),v=a.canonical.y;return[new s.ac(0,v/d).toLngLat().lat,new s.ac(0,(v+1)/d).toLngLat().lat]}function fd(y,a,d,v,S,A,P){const O=y.context,I=O.gl,H=d.hillshadeFBO;if(!H)return;y.prepareDrawTile();const G=y.isTileAffectedByFog(a),ne=y.getOrCreateProgram("hillshade",{overrideFog:G});O.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,H.colorAttachment.get());const J=((pe,me,be,Ne)=>{const De=be.paint.get("hillshade-shadow-color"),Be=be.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Ze=be.paint.get("hillshade-highlight-color"),Ye=be.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Ue=be.paint.get("hillshade-accent-color"),qe=be.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",Ge=be.paint.get("hillshade-emissive-strength");let _t=s.al(be.paint.get("hillshade-illumination-direction"));if(be.paint.get("hillshade-illumination-anchor")==="viewport")_t-=pe.transform.angle;else if(pe.style&&pe.style.enable3dLights()&&pe.style.directionalLight){const Bt=pe.style.directionalLight.properties.get("direction"),Ct=s.d1(Bt.x,Bt.y,Bt.z);_t=s.al(Ct[1])}const ct=!pe.options.moving;return{u_matrix:Ne||pe.transform.calculateProjMatrix(me.tileID.toUnwrapped(),ct),u_image:0,u_latrange:vm(0,me.tileID),u_light:[be.paint.get("hillshade-exaggeration"),_t],u_shadow:De.toPremultipliedRenderColor(Be?null:be.lut),u_highlight:Ze.toPremultipliedRenderColor(Ye?null:be.lut),u_emissive_strength:Ge,u_accent:Ue.toPremultipliedRenderColor(qe?null:be.lut)}})(y,d,v,y.terrain?a.projMatrix:null);y.uploadCommonUniforms(O,ne,a.toUnwrapped());const{tileBoundsBuffer:re,tileBoundsIndexBuffer:de,tileBoundsSegments:ce}=y.getTileBoundsBuffers(d);ne.draw(y,I.TRIANGLES,S,A,P,_r.disabled,J,v.id,re,de,ce)}function qg(y,a,d){if(!a.needsDEMTextureUpload)return;const v=y.context,S=v.gl;v.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||y.getTileTexture(d.stride);const A=d.getPixels();a.demTexture?a.demTexture.update(A,{premultiply:!1}):a.demTexture=new s.T(v,A,S.R32F,{premultiply:!1}),a.needsDEMTextureUpload=!1}function xm(y,a,d){const v=y.context,S=v.gl;if(!a.dem)return;const A=a.dem;if(v.activeTexture.set(S.TEXTURE1),qg(y,a,A),!a.demTexture)return;a.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);const P=A.dim;v.activeTexture.set(S.TEXTURE0);let O=a.hillshadeFBO;if(!O){const J=new s.T(v,{width:P,height:P,data:null},S.RGBA8);J.bind(S.LINEAR,S.CLAMP_TO_EDGE),O=a.hillshadeFBO=v.createFramebuffer(P,P,!0,"renderbuffer"),O.colorAttachment.set(J.texture)}v.bindFramebuffer.set(O.framebuffer),v.viewport.set([0,0,P,P]);const{tileBoundsBuffer:I,tileBoundsIndexBuffer:H,tileBoundsSegments:G}=y.getMercatorTileBoundsBuffers(),ne=[];y.linearFloatFilteringSupported()&&ne.push("TERRAIN_DEM_FLOAT_FORMAT"),y.getOrCreateProgram("hillshadePrepare",{defines:ne}).draw(y,S.TRIANGLES,Fn.disabled,Pr.disabled,ei.unblended,_r.disabled,((J,re)=>{const de=re.stride,ce=s.bz();return s.ca(ce,0,s.aj,-s.aj,0,0,1),s.bo(ce,ce,[0,-s.aj,0]),{u_matrix:ce,u_image:1,u_dimension:[de,de],u_zoom:J.overscaledZ}})(a.tileID,A),d.id,I,H,G),a.needsHillshadePrepare=!1}class Ss{constructor(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(a){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Pv extends Ss{getDefault(){return s.am.transparent.toNonPremultipliedRenderColor(null)}set(a){const d=this.current;(a.r!==d.r||a.g!==d.g||a.b!==d.b||a.a!==d.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class Mv extends Ss{getDefault(){return 1}set(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)}}class tp extends Ss{getDefault(){return 0}set(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)}}class np extends Ss{getDefault(){return[!0,!0,!0,!0]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||a[2]!==d[2]||a[3]!==d[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class _m extends Ss{getDefault(){return!0}set(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)}}class Hg extends Ss{getDefault(){return 255}set(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)}}class zl extends Ss{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(a){const d=this.current;(a.func!==d.func||a.ref!==d.ref||a.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)}}class zc extends Ss{getDefault(){const a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||a[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)}}class ch extends Ss{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=a,this.dirty=!1}}class au extends Ss{getDefault(){return[0,1]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)}}class Fc extends Ss{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=a,this.dirty=!1}}class pd extends Ss{getDefault(){return this.gl.LESS}set(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)}}class uh extends Ss{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.BLEND):d.disable(d.BLEND),this.current=a,this.dirty=!1}}class dh extends Ss{getDefault(){const a=this.gl;return[a.ONE,a.ZERO,a.ONE,a.ZERO]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||a[2]!==d[2]||a[3]!==d[3]||this.dirty)&&(this.gl.blendFuncSeparate(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class rp extends Ss{getDefault(){return s.am.transparent.toNonPremultipliedRenderColor(null)}set(a){const d=this.current;(a.r!==d.r||a.g!==d.g||a.b!==d.b||a.a!==d.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class Ko extends Ss{getDefault(){return this.gl.FUNC_ADD}set(a){(a!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(a,a),this.current=a,this.dirty=!1)}}class Ma extends Ss{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=a,this.dirty=!1}}class oa extends Ss{getDefault(){return this.gl.BACK}set(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)}}class md extends Ss{getDefault(){return this.gl.CCW}set(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)}}let ou=class extends Ss{getDefault(){return null}set(y){(y!==this.current||this.dirty)&&(this.gl.useProgram(y),this.current=y,this.dirty=!1)}};class hh extends Ss{getDefault(){return this.gl.TEXTURE0}set(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)}}class Lu extends Ss{getDefault(){const a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||a[2]!==d[2]||a[3]!==d[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class bm extends Ss{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,a),this.current=a,this.dirty=!1}}class Gg extends Ss{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class fh extends Ss{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,a),this.current=a,this.dirty=!1}}class gd extends Ss{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class Rv extends Ss{getDefault(){return null}set(a){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class ip extends Ss{getDefault(){return null}set(a){this.gl&&(a!==this.current||this.dirty)&&(this.gl.bindVertexArray(a),this.current=a,this.dirty=!1)}}class Wg extends Ss{getDefault(){return 4}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}}class Bc extends Ss{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}}class zu extends Ss{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}}class Fu extends Ss{constructor(a,d){super(a),this.context=a,this.parent=d}getDefault(){return null}}class yd extends Fu{setDirty(){this.dirty=!0}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class Xg extends Fu{attachment(){return this.gl.DEPTH_ATTACHMENT}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,this.attachment(),d.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class wm extends Fu{attachment(){return this.gl.DEPTH_ATTACHMENT}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,this.attachment(),d.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class Kh extends Xg{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const sp=(y,a,d)=>({u_matrix:y,u_image0:0,u_skirt_height:a,u_ground_shadow_factor:d}),Bu=(y,a,d,v,S,A,P,O,I,H,G,ne,J,re,de,ce)=>({u_proj_matrix:Float32Array.from(y),u_globe_matrix:a,u_normalize_matrix:Float32Array.from(v),u_merc_matrix:d,u_zoom_transition:S,u_merc_center:A,u_image0:0,u_frustum_tl:P,u_frustum_tr:O,u_frustum_br:I,u_frustum_bl:H,u_globe_pos:G,u_globe_radius:ne,u_viewport:J,u_grid_matrix:ce?Float32Array.from(ce):new Float32Array(9),u_skirt_height:re,u_far_z_cutoff:de});function Jo(y,a){return y!=null&&a!=null&&!(!y.hasData()||!a.hasData())&&y.demTexture!=null&&a.demTexture!=null&&y.tileID.key!==a.tileID.key}const Uu=new class{constructor(){this.operations={}}newMorphing(y,a,d,v,S){if(y in this.operations){const A=this.operations[y];A.to.tileID.key!==d.tileID.key&&(A.queued=d)}else this.operations[y]={startTime:v,phase:0,duration:S,from:a,to:d,queued:null}}getMorphValuesForProxy(y){if(!(y in this.operations))return null;const a=this.operations[y];return{from:a.from,to:a.to,phase:a.phase}}update(y){for(const a in this.operations){const d=this.operations[a];for(d.phase=(y-d.startTime)/d.duration;d.phase>=1||!this._validOp(d);)if(!this._nextOp(d,y)){delete this.operations[a];break}}}_nextOp(y,a){return!!y.queued&&(y.from=y.to,y.to=y.queued,y.queued=null,y.phase=0,y.startTime=a,!0)}_validOp(y){return y.from.hasData()&&y.to.hasData()}},Ov={0:null,1:"TERRAIN_VERTEX_MORPHING"};function ap(y,a,d){if(a===0)return 0;const v=a<1&&d===514?.25/a:1;return 6*Math.pow(1.5,22-y)*Math.max(a,1)*v}function Sm(y,a){const d=1<<y.z;return!a&&(y.x===0||y.x===d-1)||y.y===0||y.y===d-1}const Zg=y=>({u_matrix:y});function na(y,a,d,v,S){if(S>0){const A=s.q.now(),P=(A-y.timeAdded)/S,O=a?(A-a.timeAdded)/S:-1,I=d.getSource(),H=v.coveringZoomLevel({tileSize:I.tileSize,roundZoom:I.roundZoom}),G=!a||Math.abs(a.tileID.overscaledZ-H)>Math.abs(y.tileID.overscaledZ-H),ne=G&&y.refreshedUponExpiration?1:s.ay(G?P:1-O,0,1);return y.refreshedUponExpiration&&P>=1&&(y.refreshedUponExpiration=!1),a?{opacity:1,mix:1-ne}:{opacity:ne,mix:0}}return{opacity:1,mix:0}}class Tm extends $a{constructor(a){const d=Dl("mock-dem",{type:"raster-dem",maxzoom:a.transform.maxZoom},a.style.dispatcher,a.style);super("mock-dem",d,!1),d.setEventedParent(this),this._sourceLoaded=!0}_loadTile(a,d){a.state="loaded",d(null)}}class ph extends $a{constructor(a){const d=Dl("proxy",{type:"geojson",maxzoom:a.transform.maxZoom},a.style.dispatcher,a.style);super("proxy",d,!1),d.setEventedParent(this),this.map=this.getSource().map=a,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(a,d,v){if(a.freezeTileCoverage)return;this.transform=a;const S=a.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((A,P)=>{if(A[P.key]="",!this._tiles[P.key]){const O=new Va(P,this._source.tileSize*P.overscaleFactor(),a.tileZoom,void 0,void 0,this._source.worldview);O.state="loaded",this._tiles[P.key]=O}return A}),{});for(const A in this._tiles)A in S||(this.freeFBO(A),this._tiles[A].unloadVectorData(),delete this._tiles[A])}freeFBO(a){const d=this.proxyCachedFBO[a];if(d!==void 0){const v=Object.values(d);this.renderCachePool.push(...v),delete this.proxyCachedFBO[a]}}deallocRenderCache(){this.renderCache.forEach((a=>a.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class vd extends s.aM{constructor(a,d,v){super(a.overscaledZ,a.wrap,a.canonical.z,a.canonical.x,a.canonical.y),this.proxyTileKey=d,this.projMatrix=v}}class op extends s.dF{constructor(a,d){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},a.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},(()=>{this._style.map.triggerRepaint()})),a.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},(()=>{this._style.map.triggerRepaint()})),a.tp.registerButton(["Terrain"],"Invalidate Render Cache",(()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()})),this.painter=a,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[v,S,A]=(function(I){const H=new s.ba,G=new s.a_,ne=131;H.reserve(17161),G.reserve(33800);const J=s.aj/128,re=s.aj+J/2,de=re+J;for(let pe=-J;pe<de;pe+=J)for(let me=-J;me<de;me+=J){const be=me<0||me>re||pe<0||pe>re?24575:0,Ne=s.ay(Math.round(me),0,s.aj),De=s.ay(Math.round(pe),0,s.aj);H.emplaceBack(Ne+be,De)}const ce=(pe,me)=>{const be=me*ne+pe;G.emplaceBack(be+1,be,be+ne),G.emplaceBack(be+ne,be+ne+1,be+1)};for(let pe=1;pe<129;pe++)for(let me=1;me<129;me++)ce(me,pe);return[0,129].forEach((pe=>{for(let me=0;me<130;me++)ce(me,pe),ce(pe,me)})),[H,G,32768]})(),P=a.context;this.gridBuffer=P.createVertexBuffer(v,s.bc.members),this.gridIndexBuffer=P.createIndexBuffer(S),this.gridSegments=s.bd.simpleSegment(0,0,v.length,S.length),this.gridNoSkirtSegments=s.bd.simpleSegment(0,0,v.length,A),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ph(d.map),this.orthoMatrix=s.bz(),s.ca(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.aj,0,s.aj,0,1);const O=P.gl;this._overlapStencilMode=new Pr({func:O.GEQUAL,mask:255},0,255,O.KEEP,O.KEEP,O.REPLACE),this._previousZoom=a.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=d,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Tm(d.map),this._pendingGroundEffectLayers=[]}set style(a){a.on("data",this._onStyleDataEvent.bind(this)),this._style=a,this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(a,d,v){if(a&&a.terrain){this._style!==a&&(this.style=a,this._evaluationZoom=void 0);const S=a.terrain.properties,A=a.terrain.drapeRenderMode===0,P=a.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=s.q.now();const O=a.terrain&&a.terrain.scope,I=S.get("source"),H=A?this._mockSourceCache:a.getSourceCache(I,O);if(!H)return void s.w(`Couldn't find terrain source "${I}".`);if(this.sourceCache=H,this._attenuationRange=a.terrain.getAttenuationRange(),this._exaggeration=P?this.calculateExaggeration(d):S.get("exaggeration"),!d.projection.requiresDraping&&P&&this._exaggeration===0)return void this._disable();this.enabled=!0;const G=()=>{this.sourceCache.used&&s.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const ne=this.getScaledDemTileSize();this.sourceCache.update(d,ne,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,G(),this._initializing=!0),G(),d.updateElevation(!0,v),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(d),this._emptyDEMTextureDirty=!0,this._previousZoom=d.zoom}else this._disable()}calculateExaggeration(a){if(this._attenuationRange&&a.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(a.zoom);const d=this._previousCameraAltitude,v=a.getFreeCameraOptions().position.z/a.pixelsPerMeter*a.worldSize;this._previousCameraAltitude=v;const S=d!=null?v-d:Number.MAX_VALUE;if(Math.abs(S)<2)return this._exaggeration;const A=a.zoom,P=this._style.terrain;if(!this._previousUpdateTimestamp)return P.getExaggeration(A);let O=A-this._previousZoom;const I=this._previousUpdateTimestamp;let H=A;this._evaluationZoom!=null&&(H=this._evaluationZoom,Math.abs(A-H)>.5&&(O=.5*(A-H+O)),O*S<0&&(H+=O)),this._evaluationZoom=H;const G=P.getExaggeration(H),ne=G===P.getExaggeration(Math.max(0,H-.1));if(ne&&Math.abs(G-this._exaggeration)<.01)return G;let J=Math.min(.1,.00375*(this._updateTimestamp-I));return(ne||G<.1||Math.abs(O)<1e-4)&&(J=Math.min(.2,4*J)),s.ai(this._exaggeration,G,J)}resetTileLookupCache(a){this._findCoveringTileCache[a]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(a){a.coord&&a.dataType==="source"?this._clearRenderCacheForTile(a.sourceCacheId,a.coord):a.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const a in this._style._mergedSourceCaches)this._style._mergedSourceCaches[a].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach((a=>a.fb.destroy())),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const a=2*this.proxySourceCache.getSource().tileSize;return[a,a]}set useVertexMorphing(a){this._useVertexMorphing=a}updateTileBinding(a){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const d=this.proxySourceCache,v=this.painter.transform;this._initializing&&(this._initializing=v._centerAltitude===0&&this.getAtPointOrZero(s.ac.fromLngLat(v.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=d.getIds().map((I=>{const H=d.getTileByID(I).tileID;return H.projMatrix=v.calculateProjMatrix(H.toUnwrapped()),H}));(function(I,H){const G=H.transform.pointCoordinate(H.transform.getCameraPoint()),ne=new s.P(G.x,G.y);I.sort(((J,re)=>{if(re.overscaledZ-J.overscaledZ)return re.overscaledZ-J.overscaledZ;const de=new s.P(J.canonical.x+(1<<J.canonical.z)*J.wrap,J.canonical.y),ce=new s.P(re.canonical.x+(1<<re.canonical.z)*re.wrap,re.canonical.y),pe=ne.mult(1<<J.canonical.z);return pe.x-=.5,pe.y-=.5,pe.distSqr(de)-pe.distSqr(ce)}))})(S,this.painter);const A=this.proxyToSource||{};this.proxyToSource={},S.forEach((I=>{this.proxyToSource[I.key]={}})),this.terrainTileForTile={};const P=this._style._mergedSourceCaches;for(const I in P){const H=P[I];if(!H.used||(H!==this.sourceCache&&this.resetTileLookupCache(H.id),this._setupProxiedCoordsForOrtho(H,a[I],A),H.usedForTerrain))continue;const G=a[I];H.getSource().reparseOverscaled&&this._assignTerrainTiles(G)}this.proxiedCoords[d.id]=S.map((I=>new vd(I,I.key,this.orthoMatrix))),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(A),this.renderingToTexture=!1;const O={};this._visibleDemTiles=[];for(const I of this.proxyCoords){const H=this.terrainTileForTile[I.key];if(!H)continue;const G=H.tileID.key;G in O||(this._visibleDemTiles.push(H),O[G]=G)}}_assignTerrainTiles(a){this._initializing||a.forEach((d=>{if(this.terrainTileForTile[d.key])return;const v=this._findTileCoveringTileID(d,this.sourceCache);v&&(this.terrainTileForTile[d.key]=v)}))}_prepareDEMTextures(){const a=this.painter.context,d=a.gl;for(const v in this.terrainTileForTile){const S=this.terrainTileForTile[v],A=S.dem;!A||S.demTexture&&!S.needsDEMTextureUpload||(a.activeTexture.set(d.TEXTURE1),qg(this.painter,S,A))}}_prepareDemTileUniforms(a,d,v,S){if(!d||d.demTexture==null)return!1;const A=a.tileID.canonical,P=Math.pow(2,d.tileID.canonical.z-A.z),O=S||"";return v[`u_dem_tl${O}`]=[A.x*P%1,A.y*P%1],v[`u_dem_scale${O}`]=P,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let a=0;const d=this._visibleDemTiles.reduce(((v,S)=>{if(!S.dem)return v;const A=S.dem.tree.minimums[0];return A>0&&a++,v+A}),0);return a?d/a:0}_updateEmptyDEMTexture(){const a=this.painter.context,d=a.gl;a.activeTexture.set(d.TEXTURE2);const v=this._getLoadedAreaMinimum(),S=new s.dG({width:1,height:1},new Float32Array([v]));this._emptyDEMTextureDirty=!1;let A=this._emptyDEMTexture;return A?A.update(S,{premultiply:!1}):A=this._emptyDEMTexture=new s.T(a,S,d.R32F,{premultiply:!1}),A}setupElevationDraw(a,d,v){const S=this.painter.context,A=S.gl,P={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};P.u_exaggeration=this.exaggeration();let O=null,I=null,H=1;if(v&&v.morphing&&this._useVertexMorphing){const re=v.morphing.srcDemTile,de=v.morphing.dstDemTile;H=v.morphing.phase,re&&de&&(this._prepareDemTileUniforms(a,re,P,"_prev")&&(I=re),this._prepareDemTileUniforms(a,de,P)&&(O=de))}const G=re=>re&&re.demTexture&&this.painter.linearFloatFilteringSupported()?A.LINEAR:A.NEAREST;let ne=null;var J;if(this.enabled?I&&O?(ne=O.demTexture,S.activeTexture.set(A.TEXTURE4),I.demTexture.bind(G(I),A.CLAMP_TO_EDGE),P.u_dem_lerp=H):(O=this.terrainTileForTile[a.tileID.key],ne=this._prepareDemTileUniforms(a,O,P)?O.demTexture:this.emptyDEMTexture):ne=this.emptyDEMTexture,S.activeTexture.set(A.TEXTURE2),ne&&(P.u_dem_size=(J=ne).size[0]===1?1:J.size[0]-2,ne.bind(G(O),A.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(v&&v.useDepthForOcclusion,d,P),v&&v.useMeterToDem&&O){const re=(1<<O.tileID.canonical.z)*s.cb(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;P.u_meter_to_dem=re}if(v&&v.labelPlaneMatrixInv&&(P.u_label_plane_matrix_inv=v.labelPlaneMatrixInv),d.setTerrainUniformValues(S,P),this.painter.transform.projection.name==="globe"){const re=this.globeUniformValues(this.painter.transform,a.tileID.canonical,v&&v.useDenormalizedUpVectorScale);d.setGlobeUniformValues(S,re)}}globeUniformValues(a,d,v){const S=a.projection;return{u_tile_tl_up:S.upVector(d,0,0),u_tile_tr_up:S.upVector(d,s.aj,0),u_tile_br_up:S.upVector(d,s.aj,s.aj),u_tile_bl_up:S.upVector(d,0,s.aj),u_tile_up_scale:v?s.dH(1):S.upVectorScale(d,a.center.lat,a.worldSize).metersToTile}}renderToBackBuffer(a){const d=this.painter,v=this.painter.context;a.length!==0&&(v.bindFramebuffer.set(null),v.viewport.set([0,0,d.width,d.height]),d.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,(function(S,A,P,O,I){if(S.transform.projection.name==="globe")(function(H,G,ne,J,re){const de=H.context,ce=de.gl;let pe,me;const be=H.transform,Ne=s.dy(H,de,be),De=(Bt,Ct)=>{if(me===Ct)return;const Xt=[Ov[Ct],"PROJECTION_GLOBE_VIEW"];Ne&&Xt.push("CUSTOM_ANTIALIASING");const gn=H.isTileAffectedByFog(Bt);pe=H.getOrCreateProgram("globeRaster",{defines:Xt,overrideFog:gn}),me=Ct},Be=H.colorModeForRenderPass(),Ze=new Fn(ce.LEQUAL,Fn.ReadWrite,H.depthRangeFor3D);Uu.update(re);const Ye=s.dz(be),Ue=[s.aD(be.center.lng),s.aH(be.center.lat)],qe=H.globeSharedBuffers,Ge=[be.width*s.q.devicePixelRatio,be.height*s.q.devicePixelRatio],_t=Float32Array.from(be.globeMatrix),ct={useDenormalizedUpVectorScale:!0};{const Bt=H.transform,Ct=ap(Bt.zoom,G.exaggeration(),G.sourceCache._source.tileSize);me=-1;const Xt=ce.TRIANGLES;for(const gn of J){const wt=ne.getTile(gn),at=Pr.disabled,Dt=G.prevTerrainTileForTile[gn.key],At=G.terrainTileForTile[gn.key];Jo(Dt,At)&&Uu.newMorphing(gn.key,Dt,At,re,250),de.activeTexture.set(ce.TEXTURE0),wt.texture&&wt.texture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);const Gt=Uu.getMorphValuesForProxy(gn.key),Yt=Gt?1:0;Gt&&s.L(ct,{morphing:{srcDemTile:Gt.from,dstDemTile:Gt.to,phase:s.dx(Gt.phase)}});const Ht=s.dA(gn.canonical),en=s.dB(Ht.getCenter().lat),Pn=s.dC(gn.canonical,Ht,en,Bt.worldSize/Bt._pixelsPerMercatorPixel),Kn=s.bh(s.dD(gn.canonical)),In=Bu(Bt.expandedFarZProjMatrix,_t,Ye,Kn,s.ah(Bt.zoom),Ue,Bt.frustumCorners.TL,Bt.frustumCorners.TR,Bt.frustumCorners.BR,Bt.frustumCorners.BL,Bt.globeCenterInViewSpace,Bt.globeRadius,Ge,Ct,Bt._farZ,Pn);if(De(gn,Yt),pe&&(G.setupElevationDraw(wt,pe,ct),H.uploadCommonUniforms(de,pe,gn.toUnwrapped()),qe)){const[rr,ar,Er]=qe.getGridBuffers(en,Ct!==0);pe.draw(H,Xt,Ze,at,Be,_r.backCCW,In,"globe_raster",rr,ar,Er)}}}if(qe&&(H.renderDefaultNorthPole||H.renderDefaultSouthPole)){const Bt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ne&&Bt.push("CUSTOM_ANTIALIASING"),pe=H.getOrCreateProgram("globeRaster",{defines:Bt});for(const Ct of J){const{x:Xt,y:gn,z:wt}=Ct.canonical,at=gn===0,Dt=gn===(1<<wt)-1,[At,Gt,Yt,Ht]=qe.getPoleBuffers(wt,!1);if(Ht&&(at||Dt)){const en=ne.getTile(Ct);de.activeTexture.set(ce.TEXTURE0),en.texture&&en.texture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);let Pn=s.dE(wt,Xt,be);const Kn=s.bh(s.dD(Ct.canonical)),In=(rr,ar)=>rr.draw(H,ce.TRIANGLES,Ze,Pr.disabled,Be,_r.disabled,Bu(be.expandedFarZProjMatrix,Pn,Pn,Kn,0,Ue,be.frustumCorners.TL,be.frustumCorners.TR,be.frustumCorners.BR,be.frustumCorners.BL,be.globeCenterInViewSpace,be.globeRadius,Ge,0,be._farZ),"globe_pole_raster",ar,Yt,Ht);G.setupElevationDraw(en,pe,ct),H.uploadCommonUniforms(de,pe,Ct.toUnwrapped()),at&&H.renderDefaultNorthPole&&In(pe,At),Dt&&H.renderDefaultSouthPole&&(Pn=s.cP(s.bz(),Pn,[1,-1,1]),In(pe,Gt))}}}})(S,A,P,O,I);else{const H=S.context,G=H.gl;let ne,J;const re=S.shadowRenderer,de=Du(S,S.longestCutoffRange),ce=Be=>{if(J===Be)return;const Ze=[];Ze.push(Ov[Be]),de.shouldRenderCutoff&&Ze.push("RENDER_CUTOFF"),re&&(Ze.push("RENDER_SHADOWS","DEPTH_TEXTURE"),re.useNormalOffset&&Ze.push("NORMAL_OFFSET")),ne=S.getOrCreateProgram("terrainRaster",{defines:Ze}),J=Be},pe=S.colorModeForRenderPass(),me=new Fn(G.LEQUAL,Fn.ReadWrite,S.depthRangeFor3D);Uu.update(I);const be=S.transform,Ne=ap(be.zoom,A.exaggeration(),A.sourceCache._source.tileSize);let De=[0,0,0];if(re){const Be=S.style.directionalLight,Ze=S.style.ambientLight;Be&&Ze&&(De=rh(S.style,Be,Ze))}{J=-1;const Be=G.TRIANGLES,[Ze,Ye]=[A.gridIndexBuffer,A.gridSegments];for(const Ue of O){const qe=P.getTile(Ue),Ge=Pr.disabled,_t=A.prevTerrainTileForTile[Ue.key],ct=A.terrainTileForTile[Ue.key];Jo(_t,ct)&&Uu.newMorphing(Ue.key,_t,ct,I,250),H.activeTexture.set(G.TEXTURE0),qe.texture&&qe.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE);const Bt=Uu.getMorphValuesForProxy(Ue.key),Ct=Bt?1:0;let Xt;Bt&&(Xt={morphing:{srcDemTile:Bt.from,dstDemTile:Bt.to,phase:s.dx(Bt.phase)}});const gn=sp(Ue.projMatrix,Sm(Ue.canonical,be.renderWorldCopies)?Ne/10:Ne,De);if(ce(Ct),!ne)continue;A.setupElevationDraw(qe,ne,Xt);const wt=Ue.toUnwrapped();re&&re.setupShadows(wt,ne),S.uploadCommonUniforms(H,ne,wt,null,de),ne.draw(S,Be,me,Ge,pe,_r.backCCW,gn,"terrain_raster",A.gridBuffer,Ze,Ye)}}}})(d,this,this.proxySourceCache,a,this._updateTimestamp),this.renderingToTexture=!0,d.gpuTimingDeferredRenderEnd(),a.splice(0,a.length))}renderBatch(a){if(this._drapedRenderBatches.length===0)return a+1;this.renderingToTexture=!0;const d=this.painter,v=this.painter.context,S=this.proxySourceCache,A=this.proxiedCoords[S.id],P=this._drapedRenderBatches.shift(),O=d.style.order,I=[];let H=0;for(const G of A){const ne=S.getTileByID(G.proxyTileKey),J=S.proxyCachedFBO[G.key]?S.proxyCachedFBO[G.key][a]:void 0,re=J!==void 0?S.renderCache[J]:this.pool[H++],de=J!==void 0;if(ne.texture=re.tex,de&&!re.dirty){I.push(ne.tileID);continue}let ce;v.bindFramebuffer.set(re.fb.framebuffer),this.renderedToTile=!1,re.dirty&&(v.clear({color:s.am.transparent,stencil:0}),re.dirty=!1);for(let pe=P.start;pe<=P.end;++pe){const me=d.style._mergedLayers[O[pe]];if(me.isHidden(d.transform.zoom))continue;const be=d.style.getLayerSourceCache(me),Ne=be?this.proxyToSource[G.key][be.id]:[G];if(!Ne)continue;const De=Ne;v.viewport.set([0,0,re.fb.width,re.fb.height]),ce!==(be?be.id:null)&&(this._setupStencil(re,Ne,me,be),ce=be?be.id:null),d.renderLayer(d,be,me,De)}if(this._drapedRenderBatches.length===0)for(const pe of this._pendingGroundEffectLayers){const me=d.style._mergedLayers[O[pe]];if(me.isHidden(d.transform.zoom))continue;const be=d.style.getLayerSourceCache(me),Ne=be?this.proxyToSource[G.key][be.id]:[G];if(!Ne)continue;const De=Ne;v.viewport.set([0,0,re.fb.width,re.fb.height]),ce!==(be?be.id:null)&&(this._setupStencil(re,Ne,me,be),ce=be?be.id:null),d.renderLayer(d,be,me,De)}this.renderedToTile?(re.dirty=!0,I.push(ne.tileID)):de||--H,H===5&&(H=0,this.renderToBackBuffer(I))}return this.renderToBackBuffer(I),this.renderingToTexture=!1,v.bindFramebuffer.set(null),v.viewport.set([0,0,d.width,d.height]),P.end+1}postRender(){}isLayerOrderingCorrect(a){const d=a.order.length;let v=-1,S=d;for(let A=0;A<d;++A)this._style.isLayerDraped(a._mergedLayers[a.order[A]])?v=Math.max(v,A):S=Math.min(S,A);return S>v}getMinElevationBelowMSL(){let a=0;return this._visibleDemTiles.filter((d=>d.dem)).forEach((d=>{a=Math.min(a,d.dem.tree.minimums[0])})),a===0?a:(a-30)*this._exaggeration}raycast(a,d,v){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter((A=>A.dem)).map((A=>{const P=A.tileID,O=1<<P.overscaledZ,{x:I,y:H}=P.canonical,G=I/O,ne=(I+1)/O,J=H/O,re=(H+1)/O;return{minx:G,miny:J,maxx:ne,maxy:re,t:A.dem.tree.raycastRoot(G,J,ne,re,a,d,v),tile:A}}));S.sort(((A,P)=>(A.t!==null?A.t:Number.MAX_VALUE)-(P.t!==null?P.t:Number.MAX_VALUE)));for(const A of S){if(A.t==null)return null;const P=A.tile.dem.tree.raycast(A.minx,A.miny,A.maxx,A.maxy,a,d,v);if(P!=null)return P}return null}_createFBO(){const a=this.painter.context,d=a.gl,v=this.drapeBufferSize;a.activeTexture.set(d.TEXTURE0);const S=new s.T(a,{width:v[0],height:v[1],data:null},d.RGBA8);S.bind(d.LINEAR,d.CLAMP_TO_EDGE);const A=a.createFramebuffer(v[0],v[1],!0,null);return A.colorAttachment.set(S.texture),A.depthAttachment=new Kh(a,A.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=a.createRenderbuffer(a.gl.DEPTH_STENCIL,v[0],v[1]),this._stencilRef=0,A.depthAttachment.set(this._sharedDepthStencil),a.clear({stencil:0})):A.depthAttachment.set(this._sharedDepthStencil),a.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax),{fb:A,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const a in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[a].hasTransition())return!0;return this._style.order.some((a=>{const d=this._style._mergedLayers[a],v=d.isHidden(this.painter.transform.zoom);return d.type==="hillshade"||d.type==="custom"?!v&&d.shouldRedrape():!v&&d.hasTransition()}))}_clearLineLayersFromRenderCache(){let a=!1;for(const v of this._style.getSources())if(v instanceof id){a=!0;break}if(!a)return;const d={};for(let v=0;v<this._style.order.length;++v){const S=this._style._mergedLayers[this._style.order[v]],A=this._style.getLayerSourceCache(S);if(A&&!d[A.id]&&!S.isHidden(this.painter.transform.zoom)&&S.type==="line"&&S.widthExpression()instanceof s.ab){d[A.id]=!0;for(const P of this.proxyCoords){const O=this.proxyToSource[P.key][A.id];if(O)for(const I of O)this._clearRenderCacheForTile(A.id,I)}}}}_clearRasterLayersFromRenderCache(){let a=!1;for(const v in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[v]._source instanceof Ua){a=!0;break}if(!a)return;const d={};for(let v=0;v<this._style.order.length;++v){const S=this._style._mergedLayers[this._style.order[v]],A=this._style.getLayerSourceCache(S);if(!A||d[A.id]||S.isHidden(this.painter.transform.zoom)||S.type!=="raster")continue;const P=S.paint.get("raster-fade-duration");for(const O of this.proxyCoords){const I=this.proxyToSource[O.key][A.id];if(I)for(const H of I){const G=na(A.getTile(H),A.findLoadedParent(H,0),A,this.painter.transform,P);(G.opacity!==1||G.mix!==0)&&this._clearRenderCacheForTile(A.id,H)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const a=this._style.order,d=a.length;if(d===0)return;const v=[];this._pendingGroundEffectLayers=[];let S,A=0,P=this._style._mergedLayers[a[A]];for(;!this._style.isLayerDraped(P)&&P.isHidden(this.painter.transform.zoom)&&++A<d;)P=this._style._mergedLayers[a[A]];for(;A<d;++A){const O=this._style._mergedLayers[a[A]];O.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(O)?S===void 0&&(S=A):(O.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(A),S!==void 0&&(v.push({start:S,end:A-1}),S=void 0)))}if(S!==void 0&&v.push({start:S,end:A-1}),v.length!==0){const O=v[v.length-1];this._pendingGroundEffectLayers.every((I=>I>O.end))||s.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=v}_setupRenderCache(a){const d=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,d.renderCache.length>d.renderCachePool.length){const P=Object.values(d.proxyCachedFBO);d.proxyCachedFBO={};for(let O=0;O<P.length;++O){const I=Object.values(P[O]);d.renderCachePool.push(...I)}}return}this._clearRasterLayersFromRenderCache();const v=this.proxyCoords,S=this._tilesDirty;for(let P=v.length-1;P>=0;P--){const O=v[P];if(d.getTileByID(O.key),d.proxyCachedFBO[O.key]!==void 0){const I=a[O.key],H=this.proxyToSource[O.key];let G=0;for(const ne in H){const J=H[ne],re=I[ne];if(!re||re.length!==J.length||J.some(((de,ce)=>de!==re[ce]||S[ne]&&S[ne].hasOwnProperty(de.key)))){G=-1;break}++G}for(const ne in d.proxyCachedFBO[O.key])d.renderCache[d.proxyCachedFBO[O.key][ne]].dirty=G<0||G!==Object.values(I).length}}const A=[...this._drapedRenderBatches];A.sort(((P,O)=>O.end-O.start-(P.end-P.start)));for(const P of A)for(const O of v){if(d.proxyCachedFBO[O.key])continue;let I=d.renderCachePool.pop();I===void 0&&d.renderCache.length<50&&(I=d.renderCache.length,d.renderCache.push(this._createFBO())),I!==void 0&&(d.proxyCachedFBO[O.key]={},d.proxyCachedFBO[O.key][P.start]=I,d.renderCache[I].dirty=!0)}this._tilesDirty={}}_setupStencil(a,d,v,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const A=this.painter.context,P=A.gl;if(d.length<=1)return void(this._overlapStencilType=!1);let O;if(v.isTileClipped())O=d.length,this._overlapStencilMode.test={func:P.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(d[0].overscaledZ>d[d.length-1].overscaledZ))return void(this._overlapStencilType=!1);O=1,this._overlapStencilMode.test={func:P.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+O>255&&(A.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=O,this._overlapStencilMode.ref=this._stencilRef,v.isTileClipped()&&this._renderTileClippingMasks(d,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(a){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[a.key]),this._overlapStencilMode):Pr.disabled}_renderTileClippingMasks(a,d){const v=this.painter,S=this.painter.context,A=S.gl;v._tileClippingMaskIDs={},S.setColorMode(ei.disabled),S.setDepthMode(Fn.disabled);const P=v.getOrCreateProgram("clippingMask");for(const O of a){const I=v._tileClippingMaskIDs[O.key]=--d;P.draw(v,A.TRIANGLES,Fn.disabled,new Pr({func:A.ALWAYS,mask:0},I,255,A.KEEP,A.KEEP,A.REPLACE),ei.disabled,_r.disabled,Zg(O.projMatrix),"$clipping",v.tileExtentBuffer,v.quadTriangleIndexBuffer,v.tileExtentSegments)}}pointCoordinate(a){const d=this.painter.transform;if(a.x<0||a.x>d.width||a.y<0||a.y>d.height)return null;const v=[a.x,a.y,1,1];s.aA(v,v,d.pixelMatrixInverse),s.cH(v,v,1/v[3]),v[0]/=d.worldSize,v[1]/=d.worldSize;const S=d._camera.position,A=s.cb(1,d.center.lat),P=[S[0],S[1],S[2]/A,0],O=s.d7([],v.slice(0,3),P);s.au(O,O);const I=this.raycast(P,O,this._exaggeration);return I!==null&&I?(s.bE(P,P,O,I),P[3]=P[2],P[2]*=A,P):null}_setupProxiedCoordsForOrtho(a,d,v){if(a.getSource()instanceof s.aP)return this._setupProxiedCoordsForImageSource(a,d,v);this._findCoveringTileCache[a.id]=this._findCoveringTileCache[a.id]||{};const S=this.proxiedCoords[a.id]=[],A=this.proxyCoords;for(let I=0;I<A.length;I++){const H=A[I],G=this._findTileCoveringTileID(H,a);if(G){const ne=this._createProxiedId(H,G,v[H.key]&&v[H.key][a.id]);S.push(ne),this.proxyToSource[H.key][a.id]=[ne]}}let P=!1;const O=new Set;for(let I=0;I<d.length;I++){const H=a.getTile(d[I]);if(!H||!H.hasData())continue;const G=this._findTileCoveringTileID(H.tileID,this.proxySourceCache);if(G&&G.tileID.canonical.z!==H.tileID.canonical.z){const ne=this.proxyToSource[G.tileID.key][a.id],J=this._createProxiedId(G.tileID,H,v[G.tileID.key]&&v[G.tileID.key][a.id]);ne?ne.splice(ne.length-1,0,J):this.proxyToSource[G.tileID.key][a.id]=[J];const re=this.proxyToSource[G.tileID.key][a.id];O.has(re)||O.add(re),S.push(J),P=!0}}if(this._sourceTilesOverlap[a.id]=P,P&&this._debugParams.sortTilesHiZFirst)for(const I of O)I.sort(((H,G)=>G.overscaledZ-H.overscaledZ))}_setupProxiedCoordsForImageSource(a,d,v){if(!a.getSource().loaded())return;const S=this.proxiedCoords[a.id]=[],A=this.proxyCoords,P=a.getSource(),O=P.tileID;if(!O)return;const I=new s.P(O.x,O.y)._div(1<<O.z),H=P.coordinates.map(s.ac.fromLngLat).reduce(((ne,J)=>(ne.min.x=Math.min(ne.min.x,J.x-I.x),ne.min.y=Math.min(ne.min.y,J.y-I.y),ne.max.x=Math.max(ne.max.x,J.x-I.x),ne.max.y=Math.max(ne.max.y,J.y-I.y),ne)),{min:new s.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),G=(ne,J)=>{const re=ne.wrap+ne.canonical.x/(1<<ne.canonical.z),de=ne.canonical.y/(1<<ne.canonical.z),ce=s.aj/(1<<ne.canonical.z),pe=J.wrap+J.canonical.x/(1<<J.canonical.z),me=J.canonical.y/(1<<J.canonical.z);return re+ce<pe+H.min.x||re>pe+H.max.x||de+ce<me+H.min.y||de>me+H.max.y};for(let ne=0;ne<A.length;ne++){const J=A[ne];for(let re=0;re<d.length;re++){const de=a.getTile(d[re]);if(!de||!de.hasData()||G(J,de.tileID))continue;const ce=this._createProxiedId(J,de,v[J.key]&&v[J.key][a.id]),pe=this.proxyToSource[J.key][a.id];pe?pe.push(ce):this.proxyToSource[J.key][a.id]=[ce],S.push(ce)}}}_createProxiedId(a,d,v){let S=this.orthoMatrix;if(v){const A=v.find((P=>P.key===d.tileID.key));if(A)return A}if(d.tileID.key!==a.key){const A=a.canonical.z-d.tileID.canonical.z;let P,O,I;S=s.bz();const H=d.tileID.wrap-a.wrap<<a.overscaledZ;A>0?(P=s.aj>>A,O=P*((d.tileID.canonical.x<<A)-a.canonical.x+H),I=P*((d.tileID.canonical.y<<A)-a.canonical.y)):(P=s.aj<<-A,O=s.aj*(d.tileID.canonical.x-(a.canonical.x+H<<-A)),I=s.aj*(d.tileID.canonical.y-(a.canonical.y<<-A))),s.ca(S,0,P,0,P,0,1),s.bo(S,S,[O,I,0])}return new vd(d.tileID,a.key,S)}_findTileCoveringTileID(a,d){let v=d.getTile(a);if(v&&v.hasData())return v;const S=this._findCoveringTileCache[d.id],A=S[a.key];if(v=A?d.getTileByID(A):null,v&&v.hasData()||A===null)return v;let P=v?v.tileID:a,O=P.overscaledZ;const I=d.getSource().minzoom,H=[];if(!A){const ne=d.getSource().maxzoom;if(a.canonical.z>=ne){const J=a.canonical.z-ne;d.getSource().reparseOverscaled?(O=Math.max(a.canonical.z+2,d.transform.tileZoom),P=new s.aM(O,a.wrap,ne,a.canonical.x>>J,a.canonical.y>>J)):J!==0&&(O=ne,P=new s.aM(O,a.wrap,ne,a.canonical.x>>J,a.canonical.y>>J))}P.key!==a.key&&(H.push(P.key),v=d.getTile(P))}const G=ne=>{H.forEach((J=>{S[J]=ne})),H.length=0};for(O-=1;O>=I&&(!v||!v.hasData());O--){v&&G(v.tileID.key);const ne=P.calculateScaledKey(O);if(v=d.getTileByID(ne),v&&v.hasData())break;const J=S[ne];if(J===null)break;J===void 0?H.push(ne):v=d.getTileByID(J)}return G(v?v.tileID.key:null),v&&v.hasData()?v:null}findDEMTileFor(a){return this.enabled?this._findTileCoveringTileID(a,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(a,d){let v=this._tilesDirty[a];v||(v=this._tilesDirty[a]={}),v[d.key]=!0}}function mh(y,a,d){const v=(function(O,I,H){const G=s.bG(I,O),ne=s.bG(H,[.2126,.7152,.0722]),J=(de,ce,pe)=>(1-pe)*de+pe*ce,re=J(1-.3*Math.min(ne,1),1,Math.min(G+1,1));return J(.92,1,Math.asin(s.ay(I[2],-1,1))/Math.PI+.5)*re})(y,[0,0,1],a),S=[0,0,0];s.c1(S,d.slice(0,3),v);const A=[0,0,0];s.c1(A,a.slice(0,3),y[2]);const P=[0,0,0];return s.d5(P,S,A),s.d8(P)}const gh=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Yg=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class Am{static cacheKey(a,d,v,S){let A=`${d}${S?S.cacheKey:""}`;for(const P of v)a.usedDefines.includes(P)&&(A+=`/${P}`);return A}constructor(a,d,v,S,A,P){const O=a.gl;this.program=O.createProgram(),this.configuration=S,this.name=d,this.fixedDefines=[...P];const I=S?S.getBinderAttributes():[],H=(v.staticAttributes||[]).concat(I);let G=S?S.defines():[];G=G.concat(P.map((pe=>`#define ${pe}`)));const ne=`#version 300 es
`;let J=ne+G.concat("precision mediump float;",hd,dd.fragmentSource).join(`
`);for(const pe of v.fragmentIncludes)J+=`
${Iu[pe]}`;J+=`
${v.fragmentSource}`;let re=ne+G.concat("precision highp float;",hd,dd.vertexSource).join(`
`);for(const pe of v.vertexIncludes)re+=`
${Iu[pe]}`;this.forceManualRenderingForInstanceIDShaders=a.forceManualRenderingForInstanceIDShaders&&v.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(re+=`
uniform int u_instanceID;
`),re+=`
${v.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(re=re.replaceAll("gl_InstanceID","u_instanceID"));const de=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);O.shaderSource(de,J),O.compileShader(de),O.attachShader(this.program,de);const ce=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())this.failedToCreate=!0;else{O.shaderSource(ce,re),O.compileShader(ce),O.attachShader(this.program,ce),this.attributes={},this.numAttributes=H.length;for(let pe=0;pe<this.numAttributes;pe++)if(H[pe]){const me=H[pe].startsWith("a_")?H[pe]:`a_${H[pe]}`;O.bindAttribLocation(this.program,pe,me),this.attributes[me]=pe}O.linkProgram(this.program),O.deleteShader(ce),O.deleteShader(de),this.fixedUniforms=A(a),this.binderUniforms=S?S.getUniforms(a):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(pe=>({u_instanceID:new s.cd(pe)}))(a)),(P.includes("TERRAIN")||d.indexOf("symbol")!==-1||d.indexOf("circle")!==-1)&&(this.terrainUniforms=(pe=>({u_dem:new s.cd(pe),u_dem_prev:new s.cd(pe),u_dem_tl:new s.cg(pe),u_dem_scale:new s.cf(pe),u_dem_tl_prev:new s.cg(pe),u_dem_scale_prev:new s.cf(pe),u_dem_size:new s.cf(pe),u_dem_lerp:new s.cf(pe),u_exaggeration:new s.cf(pe),u_depth:new s.cd(pe),u_depth_size_inv:new s.cg(pe),u_depth_range_unpack:new s.cg(pe),u_occluder_half_size:new s.cf(pe),u_occlusion_depth_offset:new s.cf(pe),u_meter_to_dem:new s.cf(pe),u_label_plane_matrix_inv:new s.ch(pe)}))(a)),P.includes("GLOBE")&&(this.globeUniforms=(pe=>({u_tile_tl_up:new s.ce(pe),u_tile_tr_up:new s.ce(pe),u_tile_br_up:new s.ce(pe),u_tile_bl_up:new s.ce(pe),u_tile_up_scale:new s.cf(pe)}))(a)),P.includes("FOG")&&(this.fogUniforms=(pe=>({u_fog_matrix:new s.ch(pe),u_fog_range:new s.cg(pe),u_fog_color:new s.d0(pe),u_fog_horizon_blend:new s.cf(pe),u_fog_vertical_limit:new s.cg(pe),u_fog_temporal_offset:new s.cf(pe),u_frustum_tl:new s.ce(pe),u_frustum_tr:new s.ce(pe),u_frustum_br:new s.ce(pe),u_frustum_bl:new s.ce(pe),u_globe_pos:new s.ce(pe),u_globe_radius:new s.cf(pe),u_globe_transition:new s.cf(pe),u_is_globe:new s.cd(pe),u_viewport:new s.cg(pe)}))(a)),P.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(pe=>({u_cutoff_params:new s.d0(pe)}))(a)),P.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(pe=>({u_lighting_ambient_color:new s.ce(pe),u_lighting_directional_dir:new s.ce(pe),u_lighting_directional_color:new s.ce(pe),u_ground_radiance:new s.ce(pe)}))(a)),P.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(pe=>({u_light_matrix_0:new s.ch(pe),u_light_matrix_1:new s.ch(pe),u_fade_range:new s.cg(pe),u_shadow_normal_offset:new s.ce(pe),u_shadow_intensity:new s.cf(pe),u_shadow_texel_size:new s.cf(pe),u_shadow_map_resolution:new s.cf(pe),u_shadow_direction:new s.ce(pe),u_shadow_bias:new s.ce(pe),u_shadowmap_0:new s.cd(pe),u_shadowmap_1:new s.cd(pe)}))(a))}}setTerrainUniformValues(a,d){if(!this.terrainUniforms)return;const v=this.terrainUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const S in d)v[S]&&v[S].set(this.program,S,d[S])}}setGlobeUniformValues(a,d){if(!this.globeUniforms)return;const v=this.globeUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const S in d)v[S]&&v[S].set(this.program,S,d[S])}}setFogUniformValues(a,d){if(!this.fogUniforms)return;const v=this.fogUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const S in d)v[S].set(this.program,S,d[S])}}setCutoffUniformValues(a,d){if(!this.cutoffUniforms)return;const v=this.cutoffUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const S in d)v[S].set(this.program,S,d[S])}}setLightsUniformValues(a,d){if(!this.lightsUniforms)return;const v=this.lightsUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const S in d)v[S].set(this.program,S,d[S])}}setShadowUniformValues(a,d){if(this.failedToCreate||!this.shadowUniforms)return;const v=this.shadowUniforms;a.program.set(this.program);for(const S in d)v[S].set(this.program,S,d[S])}_drawDebugWireframe(a,d,v,S,A,P,O,I,H,G){const ne=a.options.wireframe;if(ne.terrain===!1&&ne.layers2D===!1&&ne.layers3D===!1)return;const J=a.context;if(!(!(!ne.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!ne.layers2D||a._terrain&&a._terrain.renderingToTexture||!gh.includes(this.name))||!(!ne.layers3D||!Yg.includes(this.name))))return;const re=J.gl,de=a.wireframeDebugCache.getLinesFromTrianglesBuffer(a.frameCounter,A,J);if(!de)return;const ce=[...this.fixedDefines];ce.push("DEBUG_WIREFRAME");const pe=a.getOrCreateProgram(this.name,{config:this.configuration,defines:ce});J.program.set(pe.program);const me=(De,Be,Ze)=>{if(Be[De]&&Ze[De])for(const Ye in Be[De])Ze[De][Ye]&&Ze[De][Ye].set(Ze.program,Ye,Be[De][Ye].current)};H&&H.setUniforms(pe.program,J,pe.binderUniforms,O,{zoom:I}),me("fixedUniforms",this,pe),me("terrainUniforms",this,pe),me("globeUniforms",this,pe),me("fogUniforms",this,pe),me("lightsUniforms",this,pe),me("shadowUniforms",this,pe),de.bind(),J.setColorMode(new ei([re.ONE,re.ONE_MINUS_SRC_ALPHA,re.ZERO,re.ONE],s.am.transparent,[!0,!0,!0,!1])),J.setDepthMode(new Fn(d.func===re.LESS?re.LEQUAL:d.func,Fn.ReadOnly,d.range)),J.setStencilMode(Pr.disabled);const be=3*P.primitiveLength*2,Ne=3*P.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const De=G||1;for(let Be=0;Be<De;++Be)pe.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Be),re.drawElements(re.LINES,be,re.UNSIGNED_SHORT,Ne)}else G&&G>1?re.drawElementsInstanced(re.LINES,be,re.UNSIGNED_SHORT,Ne,G):re.drawElements(re.LINES,be,re.UNSIGNED_SHORT,Ne);A.bind(),J.program.set(this.program),J.setDepthMode(d),J.setStencilMode(v),J.setColorMode(S)}checkUniforms(a,d,v){if(this.fixedDefines.includes(d)){for(const S of Object.keys(v))if(!v[S].initialized)throw new Error(`Program '${this.name}', from draw '${a}': uniform ${S} not set but required by ${d} being defined`)}}draw(a,d,v,S,A,P,O,I,H,G,ne,J,re,de,ce,pe){const me=a.context,be=me.gl;if(this.failedToCreate)return;me.program.set(this.program),me.setDepthMode(v),me.setStencilMode(S),me.setColorMode(A),me.setCullFace(P);for(const Be of Object.keys(this.fixedUniforms))this.fixedUniforms[Be].set(this.program,Be,O[Be]);de&&de.setUniforms(this.program,me,this.binderUniforms,J,{zoom:re});const Ne={[be.POINTS]:1,[be.LINES]:2,[be.TRIANGLES]:3,[be.LINE_STRIP]:1}[d];this.checkUniforms(I,"RENDER_SHADOWS",this.shadowUniforms);const De=pe&&pe>0?1:void 0;for(const Be of ne.get()){const Ze=Be.vaos||(Be.vaos={});if((Ze[I]||(Ze[I]=new wc)).bind(me,this,H,de?de.getPaintVertexBuffers():[],G,Be.vertexOffset,ce||[],De),this.forceManualRenderingForInstanceIDShaders){const Ye=pe||1;for(let Ue=0;Ue<Ye;++Ue)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ue),G?be.drawElements(d,Be.primitiveLength*Ne,be.UNSIGNED_SHORT,Be.primitiveOffset*Ne*2):be.drawArrays(d,Be.vertexOffset,Be.vertexLength)}else pe&&pe>1?be.drawElementsInstanced(d,Be.primitiveLength*Ne,be.UNSIGNED_SHORT,Be.primitiveOffset*Ne*2,pe):G?be.drawElements(d,Be.primitiveLength*Ne,be.UNSIGNED_SHORT,Be.primitiveOffset*Ne*2):be.drawArrays(d,Be.vertexOffset,Be.vertexLength);d===be.TRIANGLES&&G&&this._drawDebugWireframe(a,v,S,A,G,Be,J,re,de,pe)}}}function Kg(y,a,d=0){const v=Math.pow(2,a.tileID.overscaledZ),S=a.tileSize*Math.pow(2,y.transform.tileZoom)/v,A=S*(a.tileID.canonical.x+a.tileID.wrap*v),P=S*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture?a.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/s.aw(a,1,y.transform.tileZoom),u_pixel_coord_upper:[A>>16,P>>16],u_pixel_coord_lower:[65535&A,65535&P],u_pattern_transition:d}}const yh={terrain:0,flat:1},xd=s.bz(),jm=(y,a,d,v,S,A,P,O,I,H,G,ne,J,re,de,ce,pe,me)=>{const be=a.style.light,Ne=be.properties.get("position"),De=[Ne.x,Ne.y,Ne.z],Be=s.dJ();be.properties.get("anchor")==="viewport"&&(s.dK(Be,-a.transform.angle),s.dL(De,De,Be));const Ze=be.properties.get("color").toPremultipliedRenderColor(null),Ye=a.transform,Ue={u_matrix:y,u_lightpos:De,u_lightintensity:be.properties.get("intensity"),u_lightcolor:[Ze.r,Ze.g,Ze.b],u_vertical_gradient:+d,u_opacity:v,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:xd,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:yh[H],u_base_type:yh[G],u_ao:S,u_edge_radius:A,u_width_scale:P,u_flood_light_color:de,u_vertical_scale:ce,u_flood_light_intensity:pe,u_ground_shadow_factor:me};return Ye.projection.name==="globe"&&(Ue.u_tile_id=[O.canonical.x,O.canonical.y,1<<O.canonical.z],Ue.u_zoom_transition=ne,Ue.u_inv_rot_matrix=re,Ue.u_merc_center=J,Ue.u_up_dir=Ye.projection.upVector(new s.cA(0,0,0),J[0]*s.aj,J[1]*s.aj),Ue.u_height_lift=I),Ue},Em=(y,a,d,v,S,A)=>({u_matrix:y,u_edge_radius:a,u_width_scale:d,u_vertical_scale:v,u_height_type:yh[S],u_base_type:yh[A]}),Jh=(y,a,d,v,S,A,P,O,I,H,G,ne,J,re,de,ce,pe,me)=>{const be=jm(y,a,d,v,S,A,P,O,H,G,ne,J,re,de,ce,pe,1,[0,0,0]),Ne={u_height_factor:-Math.pow(2,O.overscaledZ)/I.tileSize/8};return s.h(be,Kg(a,I,me),Ne)},lp=(y,a,d)=>({u_matrix:y,u_emissive_strength:a,u_ground_shadow_factor:d}),Dv=(y,a,d,v,S,A=0)=>s.h(lp(y,a,S),Kg(d,v,A)),Jg=(y,a,d,v)=>({u_matrix:y,u_world:d,u_emissive_strength:a,u_ground_shadow_factor:v}),kv=(y,a,d,v,S,A,P=0)=>s.h(Dv(y,a,d,v,A,P),{u_world:S}),x_=(y,a)=>({u_matrix:y,u_ground_shadow_factor:a}),Qh=(y,a,d,v,S)=>({u_matrix:y,u_camera_pos:[a[0],a[1],a[2]],u_depth_bias:d,u_height_scale:v,u_reset_depth:S}),Qg=(y,a)=>({u_matrix:y,u_normal_matrix:a,u_opacity:1}),ef=y=>({u_matrix:y}),Iv=y=>({u_matrix:y}),tf=(y,a,d,v,S,A,P,O)=>{const I=s.aj/A.tileSize;return{u_matrix:y,u_inv_rot_matrix:a,u_camera_to_center_distance:d.getCameraToCenterDistance(O),u_extrude_scale:[d.pixelsToGLUnits[0]/I,d.pixelsToGLUnits[1]/I],u_zoom_transition:v,u_tile_id:P,u_merc_center:S}},Vu=(y,a,d=1)=>({u_matrix:y,u_color:a,u_overlay:0,u_overlay_scale:d}),ey=s.bz(),ty=(y,a,d,v,S,A,P)=>{const O=y.transform,I=O.projection.name==="globe",H=I?s.dM(O.zoom,a.canonical)*O._pixelsPerMercatorPixel:s.aw(d,1,A),G={u_matrix:a.projMatrix,u_extrude_scale:H,u_intensity:P,u_inv_rot_matrix:ey,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){G.u_inv_rot_matrix=v,G.u_merc_center=S,G.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],G.u_zoom_transition=s.ah(O.zoom);const ne=S[0]*s.aj,J=S[1]*s.aj;G.u_up_dir=O.projection.upVector(new s.cA(0,0,0),ne,J)}return G};function lu(y,[a,d,v,S],[A,P]){if(A===P)return[0,0,0,0];const O=255*(y-1)/(y*(P-A));return[a*O,d*O,v*O,S*O]}function Fl(y,a,[d,v]){return d===v?0:.5/y+(a-d)*(y-1)/(y*(v-d))}const nf=(y,a,d,v,S,A,P,O,I,H,G,ne,J,re,de,ce,pe,me,be,Ne,De)=>({u_matrix:y,u_normalize_matrix:a,u_globe_matrix:d,u_merc_matrix:v,u_grid_matrix:S,u_tl_parent:A,u_scale_parent:H,u_fade_t:G.mix,u_opacity:G.opacity*ne.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:ne.paint.get("raster-brightness-min"),u_brightness_high:ne.paint.get("raster-brightness-max"),u_saturation_factor:s.dO(ne.paint.get("raster-saturation")),u_contrast_factor:s.dN(ne.paint.get("raster-contrast")),u_spin_weights:$u(ne.paint.get("raster-hue-rotate")),u_perspective_transform:J,u_raster_elevation:re,u_zoom_transition:P,u_merc_center:O,u_cutoff_params:I,u_colorization_mix:lu(s.dP,ce,me),u_colorization_offset:Fl(s.dP,pe,me),u_color_ramp:de,u_texture_offset:[Ne/(be+2*Ne),be/(be+2*Ne)],u_texture_res:[be+2*Ne,be+2*Ne],u_emissive_strength:De});function $u(y){y*=Math.PI/180;const a=Math.sin(y),d=Math.cos(y);return[(2*d+1)/3,(-Math.sqrt(3)*a-d+1)/3,(Math.sqrt(3)*a-d+1)/3]}const qu=.05,vh=(y,a,d,v,S,A,P,O,I,H,G,ne)=>({u_matrix:y,u_normalize_matrix:a,u_globe_matrix:d,u_merc_matrix:v,u_grid_matrix:S,u_tl_parent:A,u_scale_parent:H,u_fade_t:G.mix,u_opacity:G.opacity,u_image0:0,u_image1:1,u_raster_elevation:ne,u_zoom_transition:P,u_merc_center:O,u_cutoff_params:I}),cp=(y,a,d,v,S,A,P,O,I,H)=>({u_particle_texture:y,u_particle_texture_side_len:a,u_tile_offset:d,u_velocity:v,u_color_ramp:A,u_velocity_res:S,u_max_speed:P,u_uv_offset:O,u_data_scale:[255*I[0],255*I[1]],u_data_offset:H,u_particle_pos_scale:1.1,u_particle_pos_offset:[qu,qu]}),Lv=(y,a,d,v,S,A,P,O,I,H)=>({u_particle_texture:y,u_particle_texture_side_len:a,u_velocity:d,u_velocity_res:v,u_max_speed:S,u_speed_factor:A,u_reset_rate:P,u_rand_seed:Math.random(),u_uv_offset:O,u_data_scale:[255*I[0],255*I[1]],u_data_offset:H,u_particle_pos_scale:1.1,u_particle_pos_offset:[qu,qu]}),Cm=s.bz(),_d=(y,a,d,v,S,A,P,O,I,H,G,ne,J,re,de,ce,pe,me,be,Ne,De,Be,Ze,Ye)=>{const Ue=S.transform,qe={u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:Ue.getCameraToCenterDistance(be),u_rotate_symbol:+d,u_aspect_ratio:Ue.width/Ue.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:A,u_label_plane_matrix:P,u_coord_matrix:O,u_is_text:+H,u_elevation_from_sea:I?1:0,u_pitch_with_map:+v,u_texsize:G,u_texsize_icon:ne,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Cm,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Cm,u_up_vector:[0,-1,0],u_color_adj_mat:Be,u_icon_transition:Ze||0,u_gamma_scale:v?S.transform.getCameraToCenterDistance(be)*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:s.q.devicePixelRatio,u_is_halo:1,u_scale_factor:Ye||1,u_ground_shadow_factor:Ne,u_inv_matrix:s.bi(s.bz(),P),u_normal_scale:De};return be.name==="globe"&&(qe.u_tile_id=[re.canonical.x,re.canonical.y,1<<re.canonical.z],qe.u_zoom_transition=de,qe.u_inv_rot_matrix=pe,qe.u_merc_center=ce,qe.u_camera_forward=Ue._camera.forward(),qe.u_ecef_origin=s.dQ(Ue.globeMatrix,re.toUnwrapped()),qe.u_tile_matrix=Float32Array.from(Ue.globeMatrix),qe.u_up_vector=me),qe},Nm=(y,a,d,v)=>({u_matrix:y,u_emissive_strength:a,u_opacity:d,u_color:v}),ny=(y,a,d,v,S,A,P,O,I)=>s.h((function(H,G,ne,J,re,de){const{width:ce,height:pe}=J.imageManager.getPixelSize(G),me=Math.pow(2,de.tileID.overscaledZ),be=de.tileSize*Math.pow(2,J.transform.tileZoom)/me,Ne=be*(de.tileID.canonical.x+de.tileID.wrap*me),De=be*de.tileID.canonical.y;return{u_image:0,u_pattern_tl:ne.tl,u_pattern_br:ne.br,u_texsize:[ce,pe],u_pattern_size:ne.displaySize,u_pattern_units_to_pixels:re?[J.transform.width,-1*J.transform.height]:[1/s.aw(de,1,J.transform.tileZoom),1/s.aw(de,1,J.transform.tileZoom)],u_pixel_coord_upper:[Ne>>16,De>>16],u_pixel_coord_lower:[65535&Ne,65535&De]}})(0,A,P,v,O,I),{u_matrix:y,u_emissive_strength:a,u_opacity:d}),bd=new Float32Array(s.bx([])),Pm=(y,a,d,v,S,A,P,O,I,H,G,ne,J,re=[0,0,0],de)=>{const ce=S.style.light,pe=ce.properties.get("position"),me=[-pe.x,-pe.y,pe.z],be=s.dJ();ce.properties.get("anchor")==="viewport"&&(s.dK(be,-S.transform.angle),s.dL(me,me,be));const Ne=G.alphaMode==="MASK",De=ce.properties.get("color").toNonPremultipliedRenderColor(null),Be=J.paint.get("model-ambient-occlusion-intensity"),Ze=J.paint.get("model-color").constantOr(s.am.white).toNonPremultipliedRenderColor(null);return Ze.a=J.paint.get("model-color-mix-intensity").constantOr(0),{u_matrix:y,u_lighting_matrix:a,u_normal_matrix:d,u_node_matrix:v||bd,u_lightpos:me,u_lightintensity:ce.properties.get("intensity"),u_lightcolor:[De.r,De.g,De.b],u_camera_pos:re,u_opacity:A,u_baseTextureIsAlpha:0,u_alphaMask:+Ne,u_alphaCutoff:G.alphaCutoff,u_baseColorFactor:P.toNonPremultipliedRenderColor(null).toArray01(),u_emissiveFactor:O.toNonPremultipliedRenderColor(null).toArray01(),u_metallicFactor:I,u_roughnessFactor:H,u_baseColorTexture:Uo.BaseColor,u_metallicRoughnessTexture:Uo.MetallicRoughness,u_normalTexture:Uo.Normal,u_occlusionTexture:Uo.Occlusion,u_emissionTexture:Uo.Emission,u_lutTexture:Uo.LUT,u_color_mix:Ze.toArray01(),u_aoIntensity:Be,u_emissive_strength:ne,u_occlusionTextureTransform:de||[0,0,0,0]}},wd=(y,a=bd,d=bd)=>({u_matrix:y,u_instance:a,u_node_matrix:d}),Ts={fillExtrusion:y=>({u_matrix:new s.ch(y),u_lightpos:new s.ce(y),u_lightintensity:new s.cf(y),u_lightcolor:new s.ce(y),u_vertical_gradient:new s.cf(y),u_opacity:new s.cf(y),u_edge_radius:new s.cf(y),u_width_scale:new s.cf(y),u_ao:new s.cg(y),u_height_type:new s.cd(y),u_base_type:new s.cd(y),u_tile_id:new s.ce(y),u_zoom_transition:new s.cf(y),u_inv_rot_matrix:new s.ch(y),u_merc_center:new s.cg(y),u_up_dir:new s.ce(y),u_height_lift:new s.cf(y),u_flood_light_color:new s.ce(y),u_vertical_scale:new s.cf(y),u_flood_light_intensity:new s.cf(y),u_ground_shadow_factor:new s.ce(y)}),fillExtrusionDepth:y=>({u_matrix:new s.ch(y),u_edge_radius:new s.cf(y),u_width_scale:new s.cf(y),u_vertical_scale:new s.cf(y),u_height_type:new s.cd(y),u_base_type:new s.cd(y)}),fillExtrusionPattern:y=>({u_matrix:new s.ch(y),u_lightpos:new s.ce(y),u_lightintensity:new s.cf(y),u_lightcolor:new s.ce(y),u_vertical_gradient:new s.cf(y),u_height_factor:new s.cf(y),u_edge_radius:new s.cf(y),u_width_scale:new s.cf(y),u_ao:new s.cg(y),u_height_type:new s.cd(y),u_base_type:new s.cd(y),u_tile_id:new s.ce(y),u_zoom_transition:new s.cf(y),u_inv_rot_matrix:new s.ch(y),u_merc_center:new s.cg(y),u_up_dir:new s.ce(y),u_height_lift:new s.cf(y),u_image:new s.cd(y),u_texsize:new s.cg(y),u_pixel_coord_upper:new s.cg(y),u_pixel_coord_lower:new s.cg(y),u_tile_units_to_pixels:new s.cf(y),u_opacity:new s.cf(y),u_pattern_transition:new s.cf(y)}),fillExtrusionGroundEffect:y=>({u_matrix:new s.ch(y),u_opacity:new s.cf(y),u_ao_pass:new s.cf(y),u_meter_to_tile:new s.cf(y),u_ao:new s.cg(y),u_flood_light_intensity:new s.cf(y),u_flood_light_color:new s.ce(y),u_attenuation:new s.cf(y),u_edge_radius:new s.cf(y),u_fb:new s.cd(y),u_fb_size:new s.cf(y),u_dynamic_offset:new s.cf(y)}),fill:y=>({u_matrix:new s.ch(y),u_emissive_strength:new s.cf(y),u_ground_shadow_factor:new s.ce(y)}),fillPattern:y=>({u_matrix:new s.ch(y),u_emissive_strength:new s.cf(y),u_image:new s.cd(y),u_texsize:new s.cg(y),u_pixel_coord_upper:new s.cg(y),u_pixel_coord_lower:new s.cg(y),u_tile_units_to_pixels:new s.cf(y),u_ground_shadow_factor:new s.ce(y),u_pattern_transition:new s.cf(y)}),fillOutline:y=>({u_matrix:new s.ch(y),u_emissive_strength:new s.cf(y),u_world:new s.cg(y),u_ground_shadow_factor:new s.ce(y)}),fillOutlinePattern:y=>({u_matrix:new s.ch(y),u_emissive_strength:new s.cf(y),u_world:new s.cg(y),u_image:new s.cd(y),u_texsize:new s.cg(y),u_pixel_coord_upper:new s.cg(y),u_pixel_coord_lower:new s.cg(y),u_tile_units_to_pixels:new s.cf(y),u_ground_shadow_factor:new s.ce(y),u_pattern_transition:new s.cf(y)}),building:y=>({u_matrix:new s.ch(y),u_normal_matrix:new s.ch(y),u_opacity:new s.cf(y)}),buildingBloom:y=>({u_matrix:new s.ch(y)}),buildingDepth:y=>({u_matrix:new s.ch(y)}),elevatedStructuresDepth:y=>({u_matrix:new s.ch(y),u_depth_bias:new s.cf(y)}),elevatedStructures:y=>({u_matrix:new s.ch(y),u_ground_shadow_factor:new s.ce(y)}),elevatedStructuresDepthReconstruct:y=>({u_matrix:new s.ch(y),u_camera_pos:new s.ce(y),u_depth_bias:new s.cf(y),u_height_scale:new s.cf(y),u_reset_depth:new s.cf(y)}),circle:s.dT,collisionBox:y=>({u_matrix:new s.ch(y),u_inv_rot_matrix:new s.ch(y),u_camera_to_center_distance:new s.cf(y),u_extrude_scale:new s.cg(y),u_zoom_transition:new s.cf(y),u_merc_center:new s.cg(y),u_tile_id:new s.ce(y)}),collisionCircle:y=>({u_matrix:new s.ch(y),u_inv_matrix:new s.ch(y),u_camera_to_center_distance:new s.cf(y),u_viewport_size:new s.cg(y)}),debug:y=>({u_color:new s.dv(y),u_matrix:new s.ch(y),u_overlay:new s.cd(y),u_overlay_scale:new s.cf(y)}),clippingMask:y=>({u_matrix:new s.ch(y)}),heatmap:y=>({u_extrude_scale:new s.cf(y),u_intensity:new s.cf(y),u_matrix:new s.ch(y),u_inv_rot_matrix:new s.ch(y),u_merc_center:new s.cg(y),u_tile_id:new s.ce(y),u_zoom_transition:new s.cf(y),u_up_dir:new s.ce(y)}),heatmapTexture:y=>({u_image:new s.cd(y),u_color_ramp:new s.cd(y),u_opacity:new s.cf(y)}),hillshade:y=>({u_matrix:new s.ch(y),u_image:new s.cd(y),u_latrange:new s.cg(y),u_light:new s.cg(y),u_shadow:new s.dv(y),u_highlight:new s.dv(y),u_emissive_strength:new s.cf(y),u_accent:new s.dv(y)}),hillshadePrepare:y=>({u_matrix:new s.ch(y),u_image:new s.cd(y),u_dimension:new s.cg(y),u_zoom:new s.cf(y)}),line:s.dS,linePattern:s.dR,raster:y=>({u_matrix:new s.ch(y),u_normalize_matrix:new s.ch(y),u_globe_matrix:new s.ch(y),u_merc_matrix:new s.ch(y),u_grid_matrix:new s.dw(y),u_tl_parent:new s.cg(y),u_scale_parent:new s.cf(y),u_fade_t:new s.cf(y),u_opacity:new s.cf(y),u_image0:new s.cd(y),u_image1:new s.cd(y),u_brightness_low:new s.cf(y),u_brightness_high:new s.cf(y),u_saturation_factor:new s.cf(y),u_contrast_factor:new s.cf(y),u_spin_weights:new s.ce(y),u_perspective_transform:new s.cg(y),u_raster_elevation:new s.cf(y),u_zoom_transition:new s.cf(y),u_merc_center:new s.cg(y),u_cutoff_params:new s.d0(y),u_colorization_mix:new s.d0(y),u_colorization_offset:new s.cf(y),u_color_ramp:new s.cd(y),u_texture_offset:new s.cg(y),u_texture_res:new s.cg(y),u_emissive_strength:new s.cf(y)}),rasterParticle:y=>({u_matrix:new s.ch(y),u_normalize_matrix:new s.ch(y),u_globe_matrix:new s.ch(y),u_merc_matrix:new s.ch(y),u_grid_matrix:new s.dw(y),u_tl_parent:new s.cg(y),u_scale_parent:new s.cf(y),u_fade_t:new s.cf(y),u_opacity:new s.cf(y),u_image0:new s.cd(y),u_image1:new s.cd(y),u_raster_elevation:new s.cf(y),u_zoom_transition:new s.cf(y),u_merc_center:new s.cg(y),u_cutoff_params:new s.d0(y)}),rasterParticleTexture:y=>({u_texture:new s.cd(y),u_opacity:new s.cf(y)}),rasterParticleDraw:y=>({u_particle_texture:new s.cd(y),u_particle_texture_side_len:new s.cf(y),u_tile_offset:new s.cg(y),u_velocity:new s.cd(y),u_color_ramp:new s.cd(y),u_velocity_res:new s.cg(y),u_max_speed:new s.cf(y),u_uv_offset:new s.cg(y),u_data_scale:new s.cg(y),u_data_offset:new s.cf(y),u_particle_pos_scale:new s.cf(y),u_particle_pos_offset:new s.cg(y)}),rasterParticleUpdate:y=>({u_particle_texture:new s.cd(y),u_particle_texture_side_len:new s.cf(y),u_velocity:new s.cd(y),u_velocity_res:new s.cg(y),u_max_speed:new s.cf(y),u_speed_factor:new s.cf(y),u_reset_rate:new s.cf(y),u_rand_seed:new s.cf(y),u_uv_offset:new s.cg(y),u_data_scale:new s.cg(y),u_data_offset:new s.cf(y),u_particle_pos_scale:new s.cf(y),u_particle_pos_offset:new s.cg(y)}),symbol:y=>({u_is_size_zoom_constant:new s.cd(y),u_is_size_feature_constant:new s.cd(y),u_size_t:new s.cf(y),u_size:new s.cf(y),u_camera_to_center_distance:new s.cf(y),u_rotate_symbol:new s.cd(y),u_aspect_ratio:new s.cf(y),u_fade_change:new s.cf(y),u_matrix:new s.ch(y),u_label_plane_matrix:new s.ch(y),u_coord_matrix:new s.ch(y),u_is_text:new s.cd(y),u_elevation_from_sea:new s.cd(y),u_pitch_with_map:new s.cd(y),u_texsize:new s.cg(y),u_texsize_icon:new s.cg(y),u_texture:new s.cd(y),u_texture_icon:new s.cd(y),u_gamma_scale:new s.cf(y),u_device_pixel_ratio:new s.cf(y),u_tile_id:new s.ce(y),u_zoom_transition:new s.cf(y),u_inv_rot_matrix:new s.ch(y),u_merc_center:new s.cg(y),u_camera_forward:new s.ce(y),u_tile_matrix:new s.ch(y),u_up_vector:new s.ce(y),u_ecef_origin:new s.ce(y),u_is_halo:new s.cd(y),u_icon_transition:new s.cf(y),u_color_adj_mat:new s.ch(y),u_scale_factor:new s.cf(y),u_ground_shadow_factor:new s.ce(y),u_inv_matrix:new s.ch(y),u_normal_scale:new s.cf(y)}),background:y=>({u_matrix:new s.ch(y),u_emissive_strength:new s.cf(y),u_opacity:new s.cf(y),u_color:new s.dv(y)}),backgroundPattern:y=>({u_matrix:new s.ch(y),u_emissive_strength:new s.cf(y),u_opacity:new s.cf(y),u_image:new s.cd(y),u_pattern_tl:new s.cg(y),u_pattern_br:new s.cg(y),u_texsize:new s.cg(y),u_pattern_size:new s.cg(y),u_pixel_coord_upper:new s.cg(y),u_pixel_coord_lower:new s.cg(y),u_pattern_units_to_pixels:new s.cg(y)}),terrainRaster:y=>({u_matrix:new s.ch(y),u_image0:new s.cd(y),u_skirt_height:new s.cf(y),u_ground_shadow_factor:new s.ce(y)}),skybox:y=>({u_matrix:new s.ch(y),u_sun_direction:new s.ce(y),u_cubemap:new s.cd(y),u_opacity:new s.cf(y),u_temporal_offset:new s.cf(y)}),skyboxGradient:y=>({u_matrix:new s.ch(y),u_color_ramp:new s.cd(y),u_center_direction:new s.ce(y),u_radius:new s.cf(y),u_opacity:new s.cf(y),u_temporal_offset:new s.cf(y)}),skyboxCapture:y=>({u_matrix_3f:new s.dw(y),u_sun_direction:new s.ce(y),u_sun_intensity:new s.cf(y),u_color_tint_r:new s.d0(y),u_color_tint_m:new s.d0(y),u_luminance:new s.cf(y)}),globeRaster:y=>({u_proj_matrix:new s.ch(y),u_globe_matrix:new s.ch(y),u_normalize_matrix:new s.ch(y),u_merc_matrix:new s.ch(y),u_zoom_transition:new s.cf(y),u_merc_center:new s.cg(y),u_image0:new s.cd(y),u_grid_matrix:new s.dw(y),u_skirt_height:new s.cf(y),u_far_z_cutoff:new s.cf(y),u_frustum_tl:new s.ce(y),u_frustum_tr:new s.ce(y),u_frustum_br:new s.ce(y),u_frustum_bl:new s.ce(y),u_globe_pos:new s.ce(y),u_globe_radius:new s.cf(y),u_viewport:new s.cg(y)}),globeAtmosphere:y=>({u_frustum_tl:new s.ce(y),u_frustum_tr:new s.ce(y),u_frustum_br:new s.ce(y),u_frustum_bl:new s.ce(y),u_horizon:new s.cf(y),u_transition:new s.cf(y),u_fadeout_range:new s.cf(y),u_color:new s.d0(y),u_high_color:new s.d0(y),u_space_color:new s.d0(y),u_temporal_offset:new s.cf(y),u_horizon_angle:new s.cf(y)}),model:y=>({u_matrix:new s.ch(y),u_lighting_matrix:new s.ch(y),u_normal_matrix:new s.ch(y),u_node_matrix:new s.ch(y),u_lightpos:new s.ce(y),u_lightintensity:new s.cf(y),u_lightcolor:new s.ce(y),u_camera_pos:new s.ce(y),u_opacity:new s.cf(y),u_baseColorFactor:new s.d0(y),u_emissiveFactor:new s.d0(y),u_metallicFactor:new s.cf(y),u_roughnessFactor:new s.cf(y),u_baseTextureIsAlpha:new s.cd(y),u_alphaMask:new s.cd(y),u_alphaCutoff:new s.cf(y),u_baseColorTexture:new s.cd(y),u_metallicRoughnessTexture:new s.cd(y),u_normalTexture:new s.cd(y),u_occlusionTexture:new s.cd(y),u_emissionTexture:new s.cd(y),u_lutTexture:new s.cd(y),u_color_mix:new s.d0(y),u_aoIntensity:new s.cf(y),u_emissive_strength:new s.cf(y),u_occlusionTextureTransform:new s.d0(y)}),modelDepth:y=>({u_matrix:new s.ch(y),u_instance:new s.ch(y),u_node_matrix:new s.ch(y)}),groundShadow:y=>({u_matrix:new s.ch(y),u_ground_shadow_factor:new s.ce(y)}),stars:y=>({u_matrix:new s.ch(y),u_up:new s.ce(y),u_right:new s.ce(y),u_intensity_multiplier:new s.cf(y)}),snowParticle:y=>({u_modelview:new s.ch(y),u_projection:new s.ch(y),u_time:new s.cf(y),u_cam_pos:new s.ce(y),u_velocityConeAperture:new s.cf(y),u_velocity:new s.cf(y),u_horizontalOscillationRadius:new s.cf(y),u_horizontalOscillationRate:new s.cf(y),u_boxSize:new s.cf(y),u_billboardSize:new s.cf(y),u_simpleShapeParameters:new s.cg(y),u_screenSize:new s.cg(y),u_thinningCenterPos:new s.cg(y),u_thinningShape:new s.ce(y),u_thinningAffectedRatio:new s.cf(y),u_thinningParticleOffset:new s.cf(y),u_particleColor:new s.d0(y),u_direction:new s.ce(y)}),rainParticle:y=>({u_modelview:new s.ch(y),u_projection:new s.ch(y),u_time:new s.cf(y),u_cam_pos:new s.ce(y),u_texScreen:new s.cd(y),u_velocityConeAperture:new s.cf(y),u_velocity:new s.cf(y),u_boxSize:new s.cf(y),u_rainDropletSize:new s.cg(y),u_distortionStrength:new s.cf(y),u_rainDirection:new s.ce(y),u_color:new s.d0(y),u_screenSize:new s.cg(y),u_thinningCenterPos:new s.cg(y),u_thinningShape:new s.ce(y),u_thinningAffectedRatio:new s.cf(y),u_thinningParticleOffset:new s.cf(y),u_shapeDirectionalPower:new s.cf(y),u_shapeNormalPower:new s.cf(y),u_mode:new s.cf(y)}),vignette:y=>({u_vignetteShape:new s.ce(y),u_vignetteColor:new s.d0(y)}),occlusion:y=>({u_matrix:new s.ch(y),u_anchorPos:new s.ce(y),u_screenSizePx:new s.cg(y),u_occluderSizePx:new s.cg(y),u_color:new s.d0(y)})};class qs{constructor(a,d,v,S){this.id=qs.uniqueIdxCounter,qs.uniqueIdxCounter++,this.context=a;const A=a.gl;this.buffer=A.createBuffer(),this.dynamicDraw=!!v,this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),A.bufferData(A.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||S||d.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(a){this.id=qs.uniqueIdxCounter,qs.uniqueIdxCounter++;const d=this.context.gl;this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}qs.uniqueIdxCounter=0;const ho={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class up{constructor(a,d,v,S,A,P){this.length=d.length,this.attributes=v,this.itemSize=d.bytesPerElement,this.dynamicDraw=S,this.instanceCount=P,this.context=a;const O=a.gl;this.buffer=O.createBuffer(),a.bindVertexBuffer.set(this.buffer),O.bufferData(O.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||A||d.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(a){const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,a.arrayBuffer)}enableAttributes(a,d){for(let v=0;v<this.attributes.length;v++){const S=d.attributes[this.attributes[v].name];S!==void 0&&a.enableVertexAttribArray(S)}}setVertexAttribPointers(a,d,v){for(let S=0;S<this.attributes.length;S++){const A=this.attributes[S],P=d.attributes[A.name];P!==void 0&&a.vertexAttribPointer(P,A.components,a[ho[A.type]],!1,this.itemSize,A.offset+this.itemSize*(v||0))}}setVertexAttribDivisor(a,d,v){for(let S=0;S<this.attributes.length;S++){const A=d.attributes[this.attributes[S].name];A!==void 0&&this.instanceCount&&this.instanceCount>0&&a.vertexAttribDivisor(A,v)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Uc{constructor(a,d,v,S,A){this.context=a,this.width=d,this.height=v;const P=this.framebuffer=a.gl.createFramebuffer();S&&(this.colorAttachment=new yd(a,P)),A&&(this.depthAttachmentType=A,this.depthAttachment=A==="renderbuffer"?new Xg(a,P):new wm(a,P))}destroy(){const a=this.context.gl;if(this.colorAttachment){const d=this.colorAttachment.get();d&&a.deleteTexture(d)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const d=this.depthAttachment.get();d&&a.deleteRenderbuffer(d)}else{const d=this.depthAttachment.get();d&&a.deleteTexture(d)}a.deleteFramebuffer(this.framebuffer)}}class Hu{constructor(a,d){this.gl=a,this.clearColor=new Pv(this),this.clearDepth=new Mv(this),this.clearStencil=new tp(this),this.colorMask=new np(this),this.depthMask=new _m(this),this.stencilMask=new Hg(this),this.stencilFunc=new zl(this),this.stencilOp=new zc(this),this.stencilTest=new ch(this),this.depthRange=new au(this),this.depthTest=new Fc(this),this.depthFunc=new pd(this),this.blend=new uh(this),this.blendFunc=new dh(this),this.blendColor=new rp(this),this.blendEquation=new Ko(this),this.cullFace=new Ma(this),this.cullFaceSide=new oa(this),this.frontFace=new md(this),this.program=new ou(this),this.activeTexture=new hh(this),this.viewport=new Lu(this),this.bindFramebuffer=new bm(this),this.bindRenderbuffer=new Gg(this),this.bindTexture=new fh(this),this.bindVertexBuffer=new gd(this),this.bindElementBuffer=new Rv(this),this.bindVertexArrayOES=new ip(this),this.pixelStoreUnpack=new Wg(this),this.pixelStoreUnpackPremultiplyAlpha=new Bc(this),this.pixelStoreUnpackFlipY=new zu(this),this.options=d?Object.assign({},d):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=a.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=a.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=a.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=d&&!!d.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=a.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE),this.maxPointSize=a.getParameter(a.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(a,d,v){return new qs(this,a,d,v)}createVertexBuffer(a,d,v,S,A){return new up(this,a,d,v,S,A)}createRenderbuffer(a,d,v){const S=this.gl,A=S.createRenderbuffer();return this.bindRenderbuffer.set(A),S.renderbufferStorage(S.RENDERBUFFER,a,d,v),this.bindRenderbuffer.set(null),A}createFramebuffer(a,d,v,S){return new Uc(this,a,d,v,S)}clear({color:a,depth:d,stencil:v,colorMask:S}){const A=this.gl;let P=0;a&&(P|=A.COLOR_BUFFER_BIT,this.clearColor.set(a.toNonPremultipliedRenderColor(null)),this.colorMask.set(S||[!0,!0,!0,!0])),d!==void 0&&(P|=A.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),v!==void 0&&(P|=A.STENCIL_BUFFER_BIT,this.clearStencil.set(v),this.stencilMask.set(255)),A.clear(P)}setCullFace(a){a.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))}setDepthMode(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)}setStencilMode(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)}setColorMode(a){s.bv(a.blendFunction,ei.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(a.blendFunction),this.blendColor.set(a.blendColor),a.blendEquation?this.blendEquation.set(a.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(a.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let cu;function rf(y,a,d,v,S,A,P){const O=y.context,I=O.gl,H=y.transform,G=[s.aD(H.center.lng),s.aH(H.center.lat)],ne=d.layout.get("symbol-placement"),J=d.layout.get("text-variable-anchor"),re=d.layout.get("icon-rotation-alignment")==="map",de=d.layout.get("text-rotation-alignment")==="map",ce=ne!=="point",pe=[];let me=0,be=0;for(let qe=0;qe<v.length;qe++){const Ge=v[qe],_t=a.getTile(Ge),ct=_t.getBucket(d);if(!ct)continue;const Bt=ct.getProjection().createInversionMatrix(H,Ge.canonical),Ct=[],Xt=Zn(Ge,ct,H),gn=!P&&re&&ce,wt=P&&de&&ce,at=J&&ct.hasTextData(),Dt=ct.hasIconTextFit()&&at&&ct.hasIconData(),At=gn||wt||P&&at||Dt,Gt=ct.projection.name==="globe",Yt=Gt?s.ah(H.zoom):0;Gt&&(Ct.push("PROJECTION_GLOBE_VIEW"),At&&Ct.push("PROJECTED_POS_ON_VIEWPORT"));const Ht=y.getOrCreateProgram("collisionBox",{defines:Ct});let en=Xt;S[0]===0&&S[1]===0||(en=y.translatePosMatrix(Xt,_t,S,A));const Pn=P?ct.textCollisionBox:ct.iconCollisionBox,Kn=ct.collisionCircleArray;if(Kn.length>0){const rr=s.bz(),ar=en;s.cM(rr,ct.placementInvProjMatrix,H.glCoordMatrix),s.cM(rr,rr,ct.placementViewportMatrix),pe.push({circleArray:Kn,circleOffset:be,transform:ar,invTransform:rr,projection:ct.getProjection()}),me+=Kn.length/4,be=me}if(!Pn)continue;y.terrain&&y.terrain.setupElevationDraw(_t,Ht);const In=Gt?[Ge.canonical.x,Ge.canonical.y,1<<Ge.canonical.z]:[0,0,0];Ht.draw(y,I.LINES,Fn.disabled,Pr.disabled,y.colorModeForRenderPass(),_r.disabled,tf(en,Bt,H,Yt,G,_t,In,ct.getProjection()),d.id,Pn.layoutVertexBuffer,Pn.indexBuffer,Pn.segments,null,H.zoom,null,[Pn.collisionVertexBuffer,Pn.collisionVertexBufferExt])}if(!P||!pe.length)return;const Ne=y.getOrCreateProgram("collisionCircle"),De=new s.dU;De.resize(4*me),De._trim();let Be=0;for(const qe of pe)for(let Ge=0;Ge<qe.circleArray.length/4;Ge++){const _t=4*Ge,ct=qe.circleArray[_t+0],Bt=qe.circleArray[_t+1],Ct=qe.circleArray[_t+2],Xt=qe.circleArray[_t+3];De.emplace(Be++,ct,Bt,Ct,Xt,0),De.emplace(Be++,ct,Bt,Ct,Xt,1),De.emplace(Be++,ct,Bt,Ct,Xt,2),De.emplace(Be++,ct,Bt,Ct,Xt,3)}(!cu||cu.length<2*me)&&(cu=(function(qe){const Ge=2*qe,_t=new s.a_;_t.resize(Ge),_t._trim();for(let ct=0;ct<Ge;ct++){const Bt=6*ct;_t.uint16[Bt+0]=4*ct+0,_t.uint16[Bt+1]=4*ct+1,_t.uint16[Bt+2]=4*ct+2,_t.uint16[Bt+3]=4*ct+2,_t.uint16[Bt+4]=4*ct+3,_t.uint16[Bt+5]=4*ct+0}return _t})(me));const Ze=O.createIndexBuffer(cu,!0),Ye=O.createVertexBuffer(De,s.dV.members,!0);for(const qe of pe){const Ge={u_matrix:qe.transform,u_inv_matrix:qe.invTransform,u_camera_to_center_distance:(Ue=H).getCameraToCenterDistance(qe.projection),u_viewport_size:[Ue.width,Ue.height]};Ne.draw(y,I.TRIANGLES,Fn.disabled,Pr.disabled,y.colorModeForRenderPass(),_r.disabled,Ge,d.id,Ye,Ze,s.bd.simpleSegment(0,2*qe.circleOffset,qe.circleArray.length,qe.circleArray.length/2),null,H.zoom)}var Ue;Ye.destroy(),Ze.destroy()}const Vc=s.bz();function Mm(y){const a=y._camera.getWorldToCamera(y.worldSize,1),d=s.az([],a,y.globeMatrix);s.bi(d,d);const v=[0,0,0],S=[0,1,0,0];return s.aA(S,S,d),v[0]=S[0],v[1]=S[1],v[2]=S[2],s.au(v,v),v}function io({width:y,height:a,anchor:d,textOffset:v,textScale:S},A){const{horizontalAlign:P,verticalAlign:O}=s.bZ(d),I=-(P-.5)*y,H=-(O-.5)*a,G=s.b_(d,v);return new s.P((I/S+G[0])*A,(H/S+G[1])*A)}function ry(y,a,d,v,S,A,P,O,I,H){const G=y.text.placedSymbolArray,ne=y.text.dynamicLayoutVertexArray,J=y.icon.dynamicLayoutVertexArray,re={},de=y.getProjection(),ce=Mo(P,de,S),pe=S.elevation,me=de.upVectorScale(P.canonical,S.center.lat,S.worldSize).metersToTile;ne.clear();for(let be=0;be<G.length;be++){const Ne=G.get(be),{tileAnchorX:De,tileAnchorY:Be,numGlyphs:Ze}=Ne,Ye=Ne.hidden||!Ne.crossTileID||y.allowVerticalPlacement&&!Ne.placedOrientation?null:v[Ne.crossTileID];if(Ye){let Ue=0,qe=0,Ge=0;if(pe){const Dt=pe?pe.getAtTileOffset(P,De,Be):0,[At,Gt,Yt]=de.upVector(P.canonical,De,Be);Ue=Dt*At*me,qe=Dt*Gt*me,Ge=Dt*Yt*me}let[_t,ct,Bt,Ct]=Fo(Ne.projectedAnchorX+Ue,Ne.projectedAnchorY+qe,Ne.projectedAnchorZ+Ge,d?ce:A);const Xt=Jd(S.getCameraToCenterDistance(de),Ct);let gn=s.bJ(y.textSizeData,I,Ne)*Xt/s.bU;d&&(gn*=y.tilePixelRatio/O);const wt=io(Ye,gn);d?({x:_t,y:ct,z:Bt}=de.projectTilePoint(De+wt.x,Be+wt.y,P.canonical),[_t,ct,Bt]=Fo(_t+Ue,ct+qe,Bt+Ge,A)):(a&&wt._rotate(-S.angle),_t+=wt.x,ct+=wt.y,Bt=0);const at=y.allowVerticalPlacement&&Ne.placedOrientation===s.bI.vertical?Math.PI/2:0;for(let Dt=0;Dt<Ze;Dt++)s.bL(ne,_t,ct,Bt,at);H&&Ne.associatedIconIndex>=0&&(re[Ne.associatedIconIndex]={x:_t,y:ct,z:Bt,angle:at})}else eh(Ze,ne)}if(H){J.clear();const be=y.icon.placedSymbolArray;for(let Ne=0;Ne<be.length;Ne++){const De=be.get(Ne),{numGlyphs:Be}=De,Ze=re[Ne];if(De.hidden||!Ze)eh(Be,J);else{const{x:Ye,y:Ue,z:qe,angle:Ge}=Ze;for(let _t=0;_t<Be;_t++)s.bL(J,Ye,Ue,qe,Ge)}}y.icon.dynamicLayoutVertexBuffer.updateData(J)}y.text.dynamicLayoutVertexBuffer.updateData(ne)}function Rm(y,a,d,v,S,A,P={}){const O=d.paint.get("icon-translate"),I=d.paint.get("text-translate"),H=d.paint.get("icon-translate-anchor"),G=d.paint.get("text-translate-anchor"),ne=d.layout.get("icon-rotation-alignment"),J=d.layout.get("text-rotation-alignment"),re=d.layout.get("icon-pitch-alignment"),de=d.layout.get("text-pitch-alignment"),ce=d.layout.get("icon-keep-upright"),pe=d.layout.get("text-keep-upright"),me=d.paint.get("icon-color-saturation"),be=d.paint.get("icon-color-contrast"),Ne=d.paint.get("icon-color-brightness-min"),De=d.paint.get("icon-color-brightness-max"),Be=d.layout.get("symbol-elevation-reference")==="sea",Ze=y.context,Ye=Ze.gl,Ue=y.transform,qe=ne==="map",Ge=J==="map",_t=re==="map",ct=de==="map",Bt=d.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Ct=!1;const Xt=y.depthModeForSublayer(0,Fn.ReadOnly),gn=new Fn(y.context.gl.LEQUAL,Fn.ReadOnly,y.depthRangeFor3D),wt=[s.aD(Ue.center.lng),s.aH(Ue.center.lat)],at=d.layout.get("text-variable-anchor"),Dt=Ue.projection.name==="globe",At=[],Gt=[0,-1,0];for(const Yt of v){const Ht=a.getTile(Yt),en=Ht.getBucket(d);if(!en||en.projection.name==="mercator"&&Dt||en.fullyClipped)continue;const Pn=en.projection.name==="globe",Kn=Pn?s.ah(Ue.zoom):0,In=Mo(Yt,en.getProjection(),Ue),rr=Ue.calculatePixelsToTileUnitsMatrix(Ht),ar=at&&en.hasTextData(),Er=en.hasIconTextFit()&&ar&&en.hasIconData(),Tr=en.getProjection().createInversionMatrix(Ue,Yt.canonical),Zr=(1<<Ht.tileID.canonical.z)*s.aj/y.transform.worldSize,ji=Xi=>{let oi=[0,0,0];if(Xi){const js=y.style.directionalLight,Ei=y.style.ambientLight;js&&Ei&&(oi=rh(y.style,js,Ei))}return oi},Lr=Xi=>{Ue.depthOcclusionForSymbolsAndCircles&&(d.hasInitialOcclusionOpacityProperties||y.terrain)&&(Xi.push("DEPTH_D24"),Xi.push("DEPTH_OCCLUSION"))},mi=()=>{const Xi=qe&&d.layout.get("symbol-placement")!=="point",oi=[];Lr(oi);const js=Xi||Er,Ei=en.elevationType==="road",Ui=y.shadowRenderer,fs=Ei&&_t&&!!Ui&&Ui.enabled,_a=ji(fs),ba=Ei&&_t&&!y.terrain?gn:Xt,pa=d.paint.get("icon-image-cross-fade");y.terrainRenderModeElevated()&&_t&&oi.push("PITCH_WITH_MAP_TERRAIN"),Pn&&(oi.push("PROJECTION_GLOBE_VIEW"),js&&oi.push("PROJECTED_POS_ON_VIEWPORT")),pa>0&&en.hasAnySecondaryIcon&&oi.push("ICON_TRANSITION"),!en.icon.zOffsetVertexBuffer||Ei&&y.terrain||oi.push("Z_OFFSET"),me===0&&be===0&&Ne===0&&De===1||oi.push("COLOR_ADJUSTMENT"),en.sdfIcons&&oi.push("RENDER_SDF"),fs&&oi.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ei&&_t&&!y.terrain&&en.icon.orientationVertexBuffer&&oi.push("ELEVATED_ROADS");const go=en.icon.programConfigurations.get(d.id),so=y.getOrCreateProgram("symbol",{config:go,defines:oi}),ll=Ht.imageAtlasTexture?Ht.imageAtlasTexture.size:[0,0],za=en.iconSizeData,qo=s.bH(za,Ue.zoom),sc=_t||!Ue.isOrthographic,Wc=Ta(In,Ht.tileID.canonical,_t,qe,Ue,en.getProjection(),rr),Ha=yc(In,Ht.tileID.canonical,_t,qe,Ue,en.getProjection(),rr),la=y.translatePosMatrix(Ha,Ht,O,H,!0),ia=y.translatePosMatrix(In,Ht,O,H),ls=js?Vc:Wc,Ga=qe&&!_t&&!Xi;let So=Gt;!Dt&&!Ue.mercatorFromTransition||qe||(So=Mm(Ue));const ma=Pn?So:Gt,Vl=d.getColorAdjustmentMatrix(me,be,Ne,De),Rd=_d(za.kind,qo,Ga,_t,y,ia,ls,la,Be,!1,ll,[0,0],0,Yt,Kn,wt,Tr,ma,en.getProjection(),_a,Zr,Vl,pa,null),Th=Ht.imageAtlasTexture?Ht.imageAtlasTexture:null,Ep=d.layout.get("icon-size").constantOr(0)!==1||en.iconsNeedLinear,Cp=en.sdfIcons||y.options.rotating||y.options.zooming||Ep||sc?Ye.LINEAR:Ye.NEAREST,ac=en.sdfIcons&&d.paint.get("icon-halo-width").constantOr(1)!==0,gu=y.terrain&&_t&&Xi?s.bi(s.bz(),Wc):Vc;if(Xi&&en.icon){const wa=Ue.elevation,Tl=wa?wa.getAtTileOffsetFunc(Yt,Ue.center.lat,Ue.worldSize,en.getProjection()):null,Ah=kl(In,Ht.tileID.canonical,_t,qe,Ue,en.getProjection(),rr);od(en,In,y,!1,Ah,Ha,_t,ce,Tl,Yt)}return{program:so,buffers:en.icon,uniformValues:Rd,atlasTexture:Th,atlasTextureIcon:null,atlasInterpolation:Cp,atlasInterpolationIcon:null,isSDF:en.sdfIcons,hasHalo:ac,depthMode:ba,tile:Ht,renderWithShadows:fs,labelPlaneMatrixInv:gu}},Ii=()=>{const Xi=Ge&&d.layout.get("symbol-placement")!=="point",oi=[],js=Xi||at||Er,Ei=en.elevationType==="road",Ui=y.shadowRenderer,fs=Ei&&ct&&!!Ui&&Ui.enabled,_a=ji(fs),ba=Ei&&ct&&!y.terrain?gn:Xt;y.terrainRenderModeElevated()&&ct&&oi.push("PITCH_WITH_MAP_TERRAIN"),Pn&&(oi.push("PROJECTION_GLOBE_VIEW"),js&&oi.push("PROJECTED_POS_ON_VIEWPORT")),!en.text.zOffsetVertexBuffer||Ei&&y.terrain||oi.push("Z_OFFSET"),en.iconsInText&&oi.push("RENDER_TEXT_AND_SYMBOL"),oi.push("RENDER_SDF"),fs&&oi.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ei&&ct&&!y.terrain&&en.text.orientationVertexBuffer&&oi.push("ELEVATED_ROADS"),Lr(oi);const pa=en.text.programConfigurations.get(d.id),go=y.getOrCreateProgram("symbol",{config:pa,defines:oi});let so,ll=[0,0],za=null;const qo=en.textSizeData;en.iconsInText&&(ll=Ht.imageAtlasTexture?Ht.imageAtlasTexture.size:[0,0],za=Ht.imageAtlasTexture?Ht.imageAtlasTexture:null,so=ct||!Ue.isOrthographic||y.options.rotating||y.options.zooming||qo.kind==="composite"||qo.kind==="camera"?Ye.LINEAR:Ye.NEAREST);const sc=Ht.glyphAtlasTexture?Ht.glyphAtlasTexture.size:[0,0],Wc=d.layout.get("text-size-scale-range"),Ha=s.ay(y.scaleFactor,Wc[0],Wc[1]),la=s.bH(qo,Ue.zoom,Ha),ia=Ta(In,Ht.tileID.canonical,ct,Ge,Ue,en.getProjection(),rr),ls=yc(In,Ht.tileID.canonical,ct,Ge,Ue,en.getProjection(),rr),Ga=y.translatePosMatrix(ls,Ht,I,G,!0),So=y.translatePosMatrix(In,Ht,I,G),ma=js?Vc:ia,Vl=Ge&&!ct&&!Xi;let Rd=Gt;!Dt&&!Ue.mercatorFromTransition||Ge||(Rd=Mm(Ue));const Th=_d(qo.kind,la,Vl,ct,y,So,ma,Ga,Be,!0,sc,ll,0,Yt,Kn,wt,Tr,Pn?Rd:Gt,en.getProjection(),_a,Zr,null,null,Ha),Ep=Ht.glyphAtlasTexture?Ht.glyphAtlasTexture:null,Cp=Ye.LINEAR,ac=d.paint.get("text-halo-width").constantOr(1)!==0,gu=y.terrain&&ct&&Xi?s.bi(s.bz(),ia):Vc;if(Xi&&en.text){const wa=Ue.elevation,Tl=wa?wa.getAtTileOffsetFunc(Yt,Ue.center.lat,Ue.worldSize,en.getProjection()):null,Ah=kl(In,Ht.tileID.canonical,ct,Ge,Ue,en.getProjection(),rr);od(en,In,y,!0,Ah,ls,ct,pe,Tl,Yt)}return{program:go,buffers:en.text,uniformValues:Th,atlasTexture:Ep,atlasTextureIcon:za,atlasInterpolation:Cp,atlasInterpolationIcon:so,isSDF:!0,hasHalo:ac,depthMode:ba,tile:Ht,renderWithShadows:fs,labelPlaneMatrixInv:gu}},os=en.icon.segments.get().length,Fr=en.text.segments.get().length,Bi=os&&!P.onlyText?mi():null,$i=Fr&&!P.onlyIcons?Ii():null,Wi=d.paint.get("icon-opacity").constantOr(1),ii=d.paint.get("text-opacity").constantOr(1);if(Bt&&en.canOverlap){Ct=!0;const Xi=Wi&&!P.onlyText?en.icon.segments.get():[],oi=ii&&!P.onlyIcons?en.text.segments.get():[];for(const js of Xi)At.push({segments:new s.bd([js]),sortKey:js.sortKey,state:Bi});for(const js of oi)At.push({segments:new s.bd([js]),sortKey:js.sortKey,state:$i})}else P.onlyText||At.push({segments:Wi?en.icon.segments:new s.bd([]),sortKey:0,state:Bi}),P.onlyIcons||At.push({segments:ii?en.text.segments:new s.bd([]),sortKey:0,state:$i})}Ct&&At.sort(((Yt,Ht)=>Yt.sortKey-Ht.sortKey));for(const Yt of At){const Ht=Yt.state;if(Ht)if(y.terrain?y.terrain.setupElevationDraw(Ht.tile,Ht.program,{useDepthForOcclusion:Ue.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Ht.labelPlaneMatrixInv}):y.setupDepthForOcclusion(Ue.depthOcclusionForSymbolsAndCircles,Ht.program),Ze.activeTexture.set(Ye.TEXTURE0),Ht.atlasTexture&&Ht.atlasTexture.bind(Ht.atlasInterpolation,Ye.CLAMP_TO_EDGE,!0),Ht.atlasTextureIcon&&(Ze.activeTexture.set(Ye.TEXTURE1),Ht.atlasTextureIcon&&Ht.atlasTextureIcon.bind(Ht.atlasInterpolationIcon,Ye.CLAMP_TO_EDGE,!0)),Ht.renderWithShadows&&y.shadowRenderer.setupShadows(Ht.tile.tileID.toUnwrapped(),Ht.program,"vector-tile"),y.uploadCommonLightUniforms(y.context,Ht.program),Ht.hasHalo){const en=Ht.uniformValues;en.u_is_halo=1,Sd(Ht.buffers,Yt.segments,d,y,Ht.program,Ht.depthMode,S,A,en,2),en.u_is_halo=0}else{if(Ht.isSDF){const en=Ht.uniformValues;Ht.hasHalo&&(en.u_is_halo=1,Sd(Ht.buffers,Yt.segments,d,y,Ht.program,Ht.depthMode,S,A,en,1)),en.u_is_halo=0}Sd(Ht.buffers,Yt.segments,d,y,Ht.program,Ht.depthMode,S,A,Ht.uniformValues,1)}}}function Sd(y,a,d,v,S,A,P,O,I,H){const G=[y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer,y.iconTransitioningVertexBuffer,y.globeExtVertexBuffer,y.zOffsetVertexBuffer,y.orientationVertexBuffer];S.draw(v,v.context.gl.TRIANGLES,A,P,O,_r.disabled,I,d.id,y.layoutVertexBuffer,y.indexBuffer,a,d.paint,v.transform.zoom,y.programConfigurations.get(d.id),G,H)}function dp(y,a){const d=1<<y.canonical.z,v=(a.x*d-y.canonical.x-y.wrap*d)*s.aj,S=(a.y*d-y.canonical.y)*s.aj,A=s.e2(a.z,a.y);return s.d2(v,S,A)}function Hn(y,a,d,v,S){if(!d.layout||d.layout.get("fill-elevation-reference")==="none")return;const A=y.context.gl,P=new Fn(y.context.gl.LEQUAL,Fn.ReadWrite,y.depthRangeFor3D),O=new Fn(y.context.gl.GREATER,Fn.ReadWrite,y.depthRangeFor3D),I=(function(re){const de=s.cU(re.pitch);let ce=.01;return re.isOrthographic&&(ce=s.ai(1e-4,ce,s.cZ(de>=Ya?1:de/Ya))),2*ce})(y.transform),H=y.transform.getFreeCameraOptions().position,G="elevatedStructuresDepthReconstruct",ne=y.getOrCreateProgram(G,{defines:["DEPTH_RECONSTRUCTION"]}),J=y.getOrCreateProgram(G);for(const re of v){const de=a.getTile(re),ce=de.getBucket(d);if(!ce)continue;const pe=ce.elevatedStructures;if(!pe)continue;const me=ce.elevationBufferData.heightRange,be=dp(re.toUnwrapped(),H),Ne=y.translatePosMatrix(re.projMatrix,de,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));let De,Be,Ze,Ye;if(S==="initialize"){if(!me||me.min>=1||pe.depthSegments.segments[0].primitiveLength===0)continue;De=Qh(Ne,be,I,1,0),Be=P,Ze=pe.depthSegments,Ye=ne}else if(S==="reset"){if(!me||me.min>=0||pe.maskSegments.segments[0].primitiveLength===0)continue;De=Qh(Ne,be,0,0,1),Be=O,Ze=pe.maskSegments,Ye=ne}else if(S==="geometry"){if(pe.depthSegments.segments[0].primitiveLength===0)continue;De=Qh(Ne,be,I,1,0),Be=P,Ze=pe.depthSegments,Ye=J}Ye.draw(y,A.TRIANGLES,Be,Pr.disabled,ei.disabled,_r.disabled,De,d.id,pe.vertexBuffer,pe.indexBuffer,Ze,d.paint,y.transform.zoom)}}function hp(y,a,d){const{painter:v,sourceCache:S,layer:A,coords:P,colorMode:O,elevationType:I,terrainEnabled:H,pass:G}=y,ne=v.context.gl,J=A.paint.get("fill-pattern"),re=A.paint.get("fill-pattern-cross-fade"),de=J.constantOr(null);let ce=I;I!=="road"||a&&!H||(ce="none");const pe=ce==="road",me=y.painter.shadowRenderer,be=pe&&!!me&&me.enabled,Ne=new Fn(v.context.gl.LEQUAL,Fn.ReadOnly,v.depthRangeFor3D);let De=[0,0,0];if(be){const Ye=v.style.directionalLight,Ue=v.style.ambientLight;Ye&&Ue&&(De=rh(v.style,Ye,Ue))}const Be=J&&J.constantOr(1),Ze=(Ye,Ue)=>{let qe,Ge,_t,ct,Bt;Ue?(qe=Be&&!A.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",_t=ne.LINES):(qe=Be?"fillPattern":"fill",_t=ne.TRIANGLES);for(const Ct of P){const Xt=S.getTile(Ct);if(Be&&!Xt.patternsLoaded())continue;const gn=Xt.getBucket(A);if(!gn)continue;const wt=a?gn.elevationBufferData:gn.bufferData;if(wt.isEmpty())continue;v.prepareDrawTile();const at=wt.programConfigurations.get(A.id),Dt=v.isTileAffectedByFog(Ct),At=[],Gt=[];pe&&(At.push("ELEVATED_ROADS"),Gt.push(wt.elevatedLayoutVertexBuffer)),be&&At.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Be&&(v.context.activeTexture.set(ne.TEXTURE0),Xt.imageAtlasTexture&&Xt.imageAtlasTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),at.updatePaintBuffers());let Yt=!1;if(de&&Xt.imageAtlas){const In=Xt.imageAtlas,rr=s.dZ.from(de),ar=rr.getPrimary().scaleSelf(s.q.devicePixelRatio).toString(),Er=rr.getSecondary(),Tr=In.patternPositions.get(ar),Zr=Er?In.patternPositions.get(Er.scaleSelf(s.q.devicePixelRatio).toString()):null;Yt=!!Tr&&!!Zr,Tr&&at.setConstantPatternPositions(Tr,Zr)}re>0&&(Yt||at.getPatternTransitionVertexBuffer("fill-pattern"))&&At.push("FILL_PATTERN_TRANSITION");const Ht=v.getOrCreateProgram(qe,{config:at,overrideFog:Dt,defines:At}),en=v.translatePosMatrix(Ct.projMatrix,Xt,A.paint.get("fill-translate"),A.paint.get("fill-translate-anchor"));be&&me.setupShadows(Xt.tileID.toUnwrapped(),Ht,"vector-tile");const Pn=A.paint.get("fill-emissive-strength");if(Ue){ct=wt.lineIndexBuffer,Bt=wt.lineSegments;const In=v.terrain&&v.terrain.renderingToTexture?v.terrain.drapeBufferSize:[ne.drawingBufferWidth,ne.drawingBufferHeight];Ge=qe==="fillOutlinePattern"&&Be?kv(en,Pn,v,Xt,In,De,re):Jg(en,Pn,In,De)}else ct=wt.indexBuffer,Bt=wt.triangleSegments,Ge=Be?Dv(en,Pn,v,Xt,De,re):lp(en,Pn,De);v.uploadCommonUniforms(v.context,Ht,Ct.toUnwrapped());let Kn=Ye;(I==="road"&&!H||I==="offset")&&(Kn=Ne),Ht.draw(v,_t,Kn,d||v.stencilModeForClipping(Ct),O,_r.disabled,Ge,A.id,wt.layoutVertexBuffer,ct,Bt,A.paint,v.transform.zoom,at,Gt)}};v.renderPass===G&&Ze(v.depthModeForSublayer(1,v.renderPass==="opaque"?Fn.ReadWrite:Fn.ReadOnly),!1),ce==="none"&&v.renderPass==="translucent"&&A.paint.get("fill-antialias")&&Ze(v.depthModeForSublayer(A.getPaintProperty("fill-outline-color")?2:0,Fn.ReadOnly),!0)}function sf(y,a,d,v,S,A,P,O){d.resetLayerRenderingStats(y);const I=y.context,H=I.gl,G=y.transform,ne=d.paint.get("fill-extrusion-pattern"),J=d.paint.get("fill-extrusion-pattern-cross-fade"),re=ne.constantOr(null),de=ne.constantOr(1),ce=d.paint.get("fill-extrusion-opacity"),pe=y.style.enable3dLights(),me=d.paint.get(pe&&!de?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),be=[d.paint.get("fill-extrusion-ambient-occlusion-intensity"),me],Ne=d.layout.get("fill-extrusion-edge-radius"),De=Ne>0&&!d.paint.get("fill-extrusion-rounded-roof"),Be=De?0:Ne,Ze=G.projection.name==="globe"?s.e5():0,Ye=G.projection.name==="globe",Ue=Ye?s.ah(G.zoom):0,qe=[s.aD(G.center.lng),s.aH(G.center.lat)],Ge=d.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",_t=d.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(Ge?null:d.lut).toArray01().slice(0,3),ct=d.paint.get("fill-extrusion-flood-light-intensity"),Bt=d.paint.get("fill-extrusion-vertical-scale"),Ct=d.paint.get("fill-extrusion-line-width").constantOr(1)!==0,Xt=d.paint.get("fill-extrusion-height-alignment"),gn=d.paint.get("fill-extrusion-base-alignment"),wt=Du(y,d.paint.get("fill-extrusion-cutoff-fade-range")),at=[];let Dt;Ye&&at.push("PROJECTION_GLOBE_VIEW"),be[0]>0&&at.push("FAUX_AO"),De&&at.push("ZERO_ROOF_RADIUS"),O&&at.push("HAS_CENTROID"),ct>0&&at.push("FLOOD_LIGHT"),wt.shouldRenderCutoff&&at.push("RENDER_CUTOFF"),Ct&&at.push("RENDER_WALL_MODE");const At=y.renderPass==="shadow",Gt=y.shadowRenderer,Yt=At&&!!Gt,Ht=At?_r.disabled:_r.backCCW;y.shadowRenderer&&(y.shadowRenderer.useNormalOffset=!0);let en=[0,0,0];if(Gt){const In=y.style.directionalLight,rr=y.style.ambientLight;In&&rr&&(en=rh(y.style,In,rr)),At||(at.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Gt.useNormalOffset&&at.push("NORMAL_OFFSET")),Dt=at.concat(["SHADOWS_SINGLE_CASCADE"])}const Pn=Yt?"fillExtrusionDepth":de?"fillExtrusionPattern":"fillExtrusion",Kn=d.getLayerRenderingStats();for(const In of v){const rr=a.getTile(In),ar=rr.getBucket(d);if(!ar||ar.projection.name!==G.projection.name)continue;let Er=!1;Gt&&(Er=Gt.getMaxCascadeForTile(In.toUnwrapped())===0);const Tr=y.isTileAffectedByFog(In),Zr=ar.programConfigurations.get(d.id);let ji=!1;if(re&&rr.imageAtlas){const $i=rr.imageAtlas,Wi=s.dZ.from(re),ii=Wi.getPrimary().scaleSelf(s.q.devicePixelRatio).toString(),Xi=Wi.getSecondary(),oi=$i.patternPositions.get(ii),js=Xi?$i.patternPositions.get(Xi.scaleSelf(s.q.devicePixelRatio).toString()):null;ji=!!oi&&!!js,oi&&Zr.setConstantPatternPositions(oi,js)}J>0&&(ji||Zr.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&at.push("FILL_EXTRUSION_PATTERN_TRANSITION");const Lr=y.getOrCreateProgram(Pn,{config:Zr,defines:Er?Dt:at,overrideFog:Tr});if(y.terrain&&y.terrain.setupElevationDraw(rr,Lr,{useMeterToDem:!0}),!ar.centroidVertexBuffer){const $i=Lr.attributes.a_centroid_pos;$i!==void 0&&H.vertexAttrib2f($i,0,0)}!At&&Gt&&Gt.setupShadows(rr.tileID.toUnwrapped(),Lr,"vector-tile"),de&&(y.context.activeTexture.set(H.TEXTURE0),rr.imageAtlasTexture&&rr.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),Zr.updatePaintBuffers());const mi=d.paint.get("fill-extrusion-vertical-gradient"),Ii=1/ar.tileToMeter;let os;if(At&&Gt){if(fp(rr.tileID,ar.maxHeight,y))continue;const $i=Gt.calculateShadowPassMatrixFromTile(rr.tileID.toUnwrapped());os=Em($i,Be,Ii,Bt,Xt,gn)}else{const $i=y.translatePosMatrix(In.expandedProjMatrix,rr,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Wi=G.projection.createInversionMatrix(G,In.canonical);os=de?Jh($i,y,mi,ce,be,Be,Ii,In,rr,Ze,Xt,gn,Ue,qe,Wi,_t,Bt,J):jm($i,y,mi,ce,be,Be,Ii,In,Ze,Xt,gn,Ue,qe,Wi,_t,Bt,ct,en)}y.uploadCommonUniforms(I,Lr,In.toUnwrapped(),null,wt);let Fr=ar.segments;if(G.projection.name==="mercator"&&!At&&(Fr=ar.getVisibleSegments(rr.tileID,y.terrain,y.transform.getFrustum(0)),!Fr.get().length))continue;if(Kn)if(At)for(const $i of Fr.get())Kn.numRenderedVerticesInShadowPass+=$i.primitiveLength;else for(const $i of Fr.get())Kn.numRenderedVerticesInTransparentPass+=$i.primitiveLength;const Bi=[];(y.terrain||O)&&Bi.push(ar.centroidVertexBuffer),Ye&&Bi.push(ar.layoutVertexExtBuffer),Ct&&Bi.push(ar.wallVertexBuffer),Lr.draw(y,I.gl.TRIANGLES,S,A,P,Ht,os,d.id,ar.layoutVertexBuffer,ar.indexBuffer,Fr,d.paint,y.transform.zoom,Zr,Bi)}y.shadowRenderer&&(y.shadowRenderer.useNormalOffset=!1)}class uu{constructor(){this.translate=[0,0],this.translateAnchor="map",this.edgeRadius=0,this.cutoffFadeRange=0}}function Aa(y,a,d,v,S,A,P,O,I,H,G,ne,J,re,de,ce,pe,me,be,Ne){const De=a.context,Be=De.gl,Ze=a.transform,Ye=a.transform.zoom,Ue=[],qe=y.translate,Ge=y.translateAnchor,_t=y.edgeRadius,ct=Du(a,y.cutoffFadeRange);G==="clear"?(Ue.push("CLEAR_SUBPASS"),Ne&&(Ue.push("CLEAR_FROM_TEXTURE"),De.activeTexture.set(Be.TEXTURE0),Ne.bind(Be.LINEAR,Be.CLAMP_TO_EDGE))):G==="sdf"&&Ue.push("SDF_SUBPASS"),me&&Ue.push("HAS_CENTROID"),ct.shouldRenderCutoff&&Ue.push("RENDER_CUTOFF");const Bt=(Ct,Xt,gn,wt,at)=>{const Dt=Xt.programConfigurations.get(v.id),At=a.isTileAffectedByFog(Ct),Gt=a.getOrCreateProgram("fillExtrusionGroundEffect",{config:Dt,defines:Ue,overrideFog:At}),Yt=((en,Pn,Kn,In,rr,ar,Er,Tr,Zr,ji,Lr)=>({u_matrix:Pn,u_opacity:Kn,u_ao_pass:In?1:0,u_meter_to_tile:rr,u_ao:ar,u_flood_light_intensity:Er,u_flood_light_color:Tr,u_attenuation:Zr,u_edge_radius:ji,u_fb:0,u_fb_size:Lr,u_dynamic_offset:1}))(0,wt,ne,H,at,[J,re*at],de,ce,pe,Ye>=17?0:_t*at,Ne?Ne.size[0]:0),Ht=[];me&&Ht.push(Xt.hiddenByLandmarkVertexBuffer),a.uploadCommonUniforms(De,Gt,Ct.toUnwrapped(),null,ct),Gt.draw(a,De.gl.TRIANGLES,A,P,O,I,Yt,v.id,Xt.vertexBuffer,Xt.indexBuffer,gn,v.paint,Ye,Dt,Ht)};for(const Ct of S){const Xt=d.getTile(Ct),gn=Xt.getBucket(v);if(!gn||gn.projection.name!==Ze.projection.name||!gn.groundEffect||gn.groundEffect&&!gn.groundEffect.hasData())continue;const wt=gn.groundEffect,at=1/gn.tileToMeter;{const Dt=a.translatePosMatrix(Ct.projMatrix,Xt,qe,Ge),At=wt.getDefaultSegment();Bt(Ct,wt,At,Dt,at)}if(be)for(let Dt=0;Dt<4;Dt++){const At=s.e3[Dt](Ct),Gt=d.getTile(At);if(!Gt)continue;const Yt=Gt.getBucket(v);if(!Yt||Yt.projection.name!==Ze.projection.name||!Yt.groundEffect||Yt.groundEffect&&!Yt.groundEffect.hasData())continue;const Ht=Yt.groundEffect;let en,Pn;Dt===0?(en=[-s.aj,0,0],Pn=1):Dt===1?(en=[s.aj,0,0],Pn=0):Dt===2?(en=[0,-s.aj,0],Pn=3):(en=[0,s.aj,0],Pn=2);const Kn=Ht.regionSegments[Pn];if(!Kn)continue;const In=new Float32Array(16);s.bo(In,Ct.projMatrix,en),Bt(Ct,Ht,Kn,a.translatePosMatrix(In,Xt,qe,Ge),at)}}}function sr(y,a,d,v,S,A,P){v.centroidVertexArray.length===0&&v.createCentroidsBuffer();const O=A?A.findDEMTileFor(d):null;if(!(O&&O.dem||P))return;A&&O&&O.dem&&v.selfDEMTileTimestamp!==O.dem._timestamp&&(v.borderDoneWithNeighborZ=[-1,-1,-1,-1],v.selfDEMTileTimestamp=O.dem._timestamp);const I=me=>new s.P(Math.ceil((me+s.e7)*s.e8),0),H=me=>{const be=a.getSource().minzoom,Ne=Be=>{const Ze=a.getTileByID(Be);if(Ze&&Ze.hasData())return Ze.getBucket(S)},De=[0,-1,1];for(const Be of De){if(me.overscaledZ+Be<be)continue;const Ze=Ne(me.calculateScaledKey(me.overscaledZ+Be));if(Ze)return Ze}},G=[0,0,0],ne=(me,be)=>(G[0]=Math.min(me.min.y,be.min.y),G[1]=Math.max(me.max.y,be.max.y),G[2]=s.aj-be.min.x>me.max.x?be.min.x-s.aj:me.max.x,G),J=(me,be)=>(G[0]=Math.min(me.min.x,be.min.x),G[1]=Math.max(me.max.x,be.max.x),G[2]=s.aj-be.min.y>me.max.y?be.min.y-s.aj:me.max.y,G),re=[(me,be)=>ne(me,be),(me,be)=>ne(be,me),(me,be)=>J(me,be),(me,be)=>J(be,me)],de=(me,be,Ne,De,Be,Ze,Ye)=>{if(!A)return 0;const Ue=[[Ze?Ne:me,Ze?me:Ne,0],[Ze?Ne:be,Ze?be:Ne,0]],qe=Ye<0?s.aj+Ye:Ye,Ge=[Ze?qe:(me+be)/2,Ze?(me+be)/2:qe,0];return Ne===0&&Ye<0||Ne!==0&&Ye>0?A.getForTilePoints(Be,[Ge],!0,De):Ue.push(Ge),A.getForTilePoints(d,Ue,!0,O),Math.max(Ue[0][2],Ue[1][2],Ge[2])/A.exaggeration()};for(let me=0;me<4;me++){const be=v.borderFeatureIndices[me];if(be.length===0)continue;const Ne=s.e3[me](d),De=H(Ne);if(!(De&&De instanceof s.e4))continue;const Be=A?A.findDEMTileFor(Ne):null;if(!(Be&&Be.dem||P)||(A&&Be&&Be.dem&&v.borderDEMTileTimestamp[me]!==Be.dem._timestamp&&(v.borderDoneWithNeighborZ[me]=-1,v.borderDEMTileTimestamp[me]=Be.dem._timestamp),v.borderDoneWithNeighborZ[me]===De.canonical.z))continue;De.centroidVertexArray.length===0&&De.createCentroidsBuffer();const Ze=(me<2?1:5)-me,Ye=De.borderDoneWithNeighborZ[Ze]!==v.canonical.z,Ue=De.borderFeatureIndices[Ze];let qe=0;if(v.canonical.z!==De.canonical.z){for(const Ge of be)v.showCentroid(v.featuresOnBorder[Ge]);if(Ye)for(const Ge of Ue)De.showCentroid(De.featuresOnBorder[Ge]);v.borderDoneWithNeighborZ[me]=De.canonical.z,De.borderDoneWithNeighborZ[Ze]=v.canonical.z}for(const Ge of be){const _t=v.featuresOnBorder[Ge],ct=v.centroidData[_t.centroidDataIndex],Bt=_t.borders[me];let Ct;for(;qe<Ue.length;){Ct=De.featuresOnBorder[Ue[qe]];const Xt=Ct.borders[Ze];if(Xt[1]>Bt[0]+3||Xt[0]>Bt[0]-3)break;De.showCentroid(Ct),qe++}if(Ct&&qe<Ue.length){const Xt=qe;let gn=0;for(;!(Ct.borders[Ze][0]>Bt[1]-3)&&(gn++,++qe!==Ue.length);)Ct=De.featuresOnBorder[Ue[qe]];Ct=De.featuresOnBorder[Ue[Xt]];let wt=!1;if(gn>=1){const At=Ct.borders[Ze];Math.abs(Bt[0]-At[0])<3&&Math.abs(Bt[1]-At[1])<3&&(gn=1,wt=!0,qe=Xt+1)}else if(gn===0){v.showCentroid(_t);continue}const at=De.centroidData[Ct.centroidDataIndex];P&&wt&&(((ce=ct).flags|(pe=at).flags)&s.e6?(ce.flags|=s.e6,pe.flags|=s.e6):(ce.flags&=~s.e6,pe.flags&=~s.e6));const Dt=_t.intersectsCount()>1||Ct.intersectsCount()>1;if(gn>1)qe=Xt,ct.centroidXY=at.centroidXY=new s.P(0,0);else if(Be&&Be.dem&&!Dt){const At=re[me](ct,at),Gt=me%2?s.aj-1:0,Yt=de(At[0],Math.min(s.aj-1,At[1]),Gt,Be,Ne,me<2,At[2]);ct.centroidXY=at.centroidXY=I(Yt)}else Dt?ct.centroidXY=at.centroidXY=new s.P(0,0):(ct.centroidXY=v.encodeBorderCentroid(_t),at.centroidXY=De.encodeBorderCentroid(Ct));v.writeCentroidToBuffer(ct),De.writeCentroidToBuffer(at)}else v.showCentroid(_t)}v.borderDoneWithNeighborZ[me]=De.canonical.z,De.borderDoneWithNeighborZ[Ze]=v.canonical.z}var ce,pe;(v.needsCentroidUpdate||!v.centroidVertexBuffer&&v.centroidVertexArray.length!==0)&&v.uploadCentroid(y)}const Om=[1,0,0],Dm=[0,1,0],iy=[0,0,1];function fp(y,a,d){const v=d.transform,S=d.shadowRenderer;if(!S)return!0;const A=y.toUnwrapped(),P=v.tileSize*S._cascades[d.currentShadowCascade].scale;let O=a;if(v.elevation){const ce=v.elevation.getMinMaxForTile(y);ce&&(O+=ce.max)}const I=[...S.shadowDirection];I[2]=-I[2];const H=S.computeSimplifiedTileShadowVolume(A,O,P,I);if(!H)return!1;const G=[Om,Dm,iy,I,[I[0],0,I[2]],[0,I[1],I[2]]],ne=v.projection.name==="globe",J=v.scaleZoom(P),re=s.cy.fromInvProjectionMatrix(v.invProjMatrix,v.worldSize,J,!ne),de=S.getCurrentCascadeFrustum();return re.intersectsPrecise(H.vertices,H.planes,G)===0||de.intersectsPrecise(H.vertices,H.planes,G)===0}function $c(y){const{painter:a,source:d,layer:v,coords:S}=y,A=y.defines,P=a.context,O=a.renderPass==="shadow",I=a.renderPass==="light-beam",H=a.shadowRenderer;let G;H&&(G=A.concat(["SHADOWS_SINGLE_CASCADE"]));const ne=s.e9(a.transform.center.lat,a.transform.zoom);for(const J of S){const re=d.getTile(J),de=re.getBucket(v);if(!de)continue;let ce=!1;H&&(ce=H.getMaxCascadeForTile(J.toUnwrapped())===0);const pe=de.programConfigurations.get(v.id);let me,be,Ne=a.translatePosMatrix(J.expandedProjMatrix,re,[0,0],"map");if(Ne=s.cP(s.bz(),Ne,[1,1,y.verticalScale]),O&&H){if(fp(re.tileID,de.maxHeight*ne,a))continue;let De=H.calculateShadowPassMatrixFromTile(re.tileID.toUnwrapped());De=s.cP(s.bz(),De,[1,1,y.verticalScale]),be=Iv(De),me=a.getOrCreateProgram("buildingDepth",{config:pe,defines:ce?G:A,overrideFog:!1})}else if(I)me=a.getOrCreateProgram("buildingBloom",{config:pe,defines:ce?G:A,overrideFog:!1}),be=ef(Ne);else{const De=a.transform.calculatePosMatrix(J.toUnwrapped(),a.transform.worldSize);s.cP(De,De,[1,1,y.verticalScale]);const Be=s.bz();s.cP(Be,De,[1,-1,1/ne]),s.bi(Be,Be),s.ea(Be,Be),be=Qg(Ne,Be),me=a.getOrCreateProgram("building",{config:pe,defines:ce?G:A,overrideFog:!1}),H&&H.setupShadowsFromMatrix(De,me,!0)}if(a.uploadCommonUniforms(P,me,J.toUnwrapped(),null,null),I){const De=de.bloomGeometry;me.draw(a,P.gl.TRIANGLES,y.depthMode,Pr.disabled,y.blendMode,_r.disabled,be,v.id,De.layoutVertexBuffer,De.indexBuffer,De.segmentsBucket,v.paint,a.transform.zoom,pe,[De.layoutAttenuationBuffer,De.layoutColorBuffer])}else me.draw(a,P.gl.TRIANGLES,y.depthMode,Pr.disabled,y.blendMode,O?_r.disabled:_r.backCW,be,v.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,v.paint,a.transform.zoom,pe,[de.layoutNormalBuffer,de.layoutColorBuffer])}}function km(y){return[y[0]*s.eb,y[1]*s.eb,y[2]*s.eb,0]}function pp(y,a,d,v,S,A,P,O,I){const H=v.getSource(),G=d.globeSharedBuffers;if(!G)return;let ne,J,re;if(a&&(ne=v.getTile(a)),H instanceof s.aP?(J=H.texture,re=s.dE(0,0,d.transform)):ne&&a&&(J=ne.texture,re=s.dE(a.canonical.z,a.canonical.x,d.transform)),!J||!re)return;y||(re=s.cP(s.bz(),re,[1,-1,1]));const de=d.context,ce=de.gl,pe=S.paint.get("raster-resampling")==="nearest"?ce.NEAREST:ce.LINEAR,me=d.colorModeForDrapableLayerRenderPass(A),be=P.defines;be.push("GLOBE_POLES");const Ne=new Fn(ce.LEQUAL,Fn.ReadWrite,d.depthRangeFor3D),De=Float32Array.from(d.transform.expandedFarZProjMatrix),Be=Float32Array.from(s.bh(s.dD(new s.cA(0,0,0))));d.terrain&&d.terrain.prepareDrawTile(),de.activeTexture.set(ce.TEXTURE0),J.bind(pe,ce.CLAMP_TO_EDGE),de.activeTexture.set(ce.TEXTURE1),J.bind(pe,ce.CLAMP_TO_EDGE),"useMipmap"in J&&de.extTextureFilterAnisotropic&&d.transform.pitch>20&&ce.texParameterf(ce.TEXTURE_2D,de.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,de.extTextureFilterAnisotropicMax);const[Ze,Ye,Ue,qe]=a?G.getPoleBuffers(a.canonical.z,!1):G.getPoleBuffers(0,!0),Ge=S.paint.get("raster-elevation");let _t;y?(_t=Ze,d.renderDefaultNorthPole=Ge!==0):(_t=Ye,d.renderDefaultSouthPole=Ge!==0);const ct=km(P.mix),Bt=((Xt,gn,wt,at,Dt,At,Gt,Yt,Ht,en,Pn,Kn,In)=>nf(Xt,gn,wt,new Float32Array(16),new Float32Array(9),[0,0],at,[0,0],[0,0,0,0],1,{opacity:1,mix:0},At,[0,0],Yt,2,en,Pn,Kn,1,0,In))(De,Be,re,s.ah(d.transform.zoom),0,S,0,Ge,0,ct,P.offset,P.range,A),Ct=d.getOrCreateProgram("raster",{defines:be});d.uploadCommonUniforms(de,Ct,null),Ct.draw(d,ce.TRIANGLES,Ne,I,me,O,Bt,S.id,_t,Ue,qe)}function zv(y){const a=y._nearZ,d=y.projection.farthestPixelDistance(y),v=d-a,S=.2*y.height,A=a+S;return[a,d,(A-S-a)/v,(A-a)/v]}function __(y,a,d,v){if(y)return a instanceof ts&&y instanceof nl?a.getTextureDescriptor(y,d,!0):{texture:y.texture,mix:km(v.mix),offset:v.offset,buffer:0,tileSize:1}}var Bl=s.ec([{name:"a_index",type:"Int16",components:1}]);class sy{constructor(a,d,v,S){const A={width:v[0],height:v[1],data:null},P=a.gl;this.targetColorTexture=new s.T(a,A,P.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new s.T(a,A,P.RGBA8,{useMipmap:!1}),this.context=a,this.updateParticleTexture(d,S),this.lastInvalidatedAt=0}updateParticleTexture(a,d){if(this.particleTextureDimension===d.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const v=this.context.gl,S=d.width*d.height;this.particleTexture0=new s.T(this.context,d,v.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new s.T(this.context,d,v.RGBA8,{premultiply:!1,useMipmap:!1});const A=new s.ed;A.reserve(S);for(let P=0;P<S;P++)A.emplaceBack(P);this.particleIndexBuffer=this.context.createVertexBuffer(A,Bl.members,!0),this.particleSegment=s.bd.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=d.width}update(a){return!(this.lastInvalidatedAt<a&&(this.lastInvalidatedAt=s.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function sl(y,a,d){if(!y)return null;const v=a.getTextureDescriptor(y,d,!0);if(!v)return null;let{texture:S,mix:A,offset:P,tileSize:O,buffer:I,format:H}=v;if(!S||!H)return null;let G=!1;return H==="uint32"&&(G=!0,A[3]=0,A=lu(s.ee,A,[0,d.paint.get("raster-particle-max-speed")]),P=Fl(s.ee,P,[0,d.paint.get("raster-particle-max-speed")])),{texture:S,textureOffset:[I/(O+2*I),O/(O+2*I)],tileSize:O,scalarData:G,scale:A,offset:P,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[H]]}}function Td(y){const a=y._nearZ,d=y.projection.farthestPixelDistance(y),v=d-a,S=.2*y.height,A=a+S;return[a,d,(A-S-a)/v,(A-a)/v]}const Fv=new s.am(1,0,0,1),Im=new s.am(0,1,0,1),ay=new s.am(0,0,1,1),Bv=new s.am(1,0,1,1),Uv=new s.am(0,1,1,1);function du(y,a,d,v,S,A){for(let P=0;P<d.length;P++)if(S){const H=new s.am(v.r*.8,v.g*.8,v.b*.8,1);hs(y,a,d[P],v,-1,-1,A),hs(y,a,d[P],v,-1,1,A),hs(y,a,d[P],v,1,1,A),hs(y,a,d[P],v,1,-1,A),hs(y,a,d[P],H,0,0,A)}else hs(y,a,d[P],v,0,0,A)}function hs(y,a,d,v,S,A,P){const O=y.context,I=y.transform,H=O.gl,G=I.projection.name==="globe",ne=G?["PROJECTION_GLOBE_VIEW"]:[];let J=s.bw(d.projMatrix);if(G&&s.ah(I.zoom)>0){const ct=s.bg(d.canonical,I),Bt=s.ef(ct);J=s.az(new Float32Array(16),I.globeMatrix,Bt),s.az(J,I.projMatrix,J)}const re=s.bz();re[12]+=2*S/(s.q.devicePixelRatio*I.width),re[13]+=2*A/(s.q.devicePixelRatio*I.height),s.az(J,re,J);const de=y.getOrCreateProgram("debug",{defines:ne}),ce=a.getTileByID(d.key);y.terrain&&y.terrain.setupElevationDraw(ce,de);const pe=Fn.disabled,me=Pr.disabled,be=y.colorModeForRenderPass(),Ne="$debug";O.activeTexture.set(H.TEXTURE0),y.emptyTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),G?ce._makeGlobeTileDebugBuffers(y.context,I):ce._makeDebugTileBoundsBuffers(y.context,I.projection);const De=ce._tileDebugBuffer||y.debugBuffer,Be=ce._tileDebugIndexBuffer||y.debugIndexBuffer,Ze=ce._tileDebugSegments||y.debugSegments;if(de.draw(y,H.LINE_STRIP,pe,me,be,_r.disabled,Vu(J,v.toPremultipliedRenderColor(null)),Ne,De,Be,Ze,null,null,null,[ce._globeTileDebugBorderBuffer]),P){const ct=ce.latestRawTileData,Bt=Math.floor((ct&&ct.byteLength||0)/1024);let Ct=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(Ct+=` => ${d.overscaledZ}`),Ct+=` ${ce.state}`,Ct+=` ${Bt}kb`,(function(Xt,gn){Xt.initDebugOverlayCanvas();const wt=Xt.debugOverlayCanvas,at=Xt.context.gl,Dt=Xt.debugOverlayCanvas.getContext("2d");Dt.clearRect(0,0,wt.width,wt.height),Dt.shadowColor="white",Dt.shadowBlur=2,Dt.lineWidth=1.5,Dt.strokeStyle="white",Dt.textBaseline="top",Dt.font="bold 36px Open Sans, sans-serif",Dt.fillText(gn,5,5),Dt.strokeText(gn,5,5),Xt.debugOverlayTexture.update(wt),Xt.debugOverlayTexture.bind(at.LINEAR,at.CLAMP_TO_EDGE)})(y,Ct)}const Ye=a.getTile(d).tileSize,Ue=512/Math.min(Ye,512)*(d.overscaledZ/I.zoom)*.5,qe=ce._tileDebugTextBuffer||y.debugBuffer,Ge=ce._tileDebugTextIndexBuffer||y.quadTriangleIndexBuffer,_t=ce._tileDebugTextSegments||y.debugSegments;de.draw(y,H.TRIANGLES,pe,me,ei.alphaBlended,_r.disabled,Vu(J,s.am.transparent.toPremultipliedRenderColor(null),Ue),Ne,qe,Ge,_t,null,null,null,[ce._globeTileDebugTextBuffer])}function af(y,a,d,v){mp(y,0,a+d/2,y.transform.width,d,v)}function Lm(y,a,d,v){mp(y,a-d/2,0,d,y.transform.height,v)}function mp(y,a,d,v,S,A){const P=y.context,O=P.gl;O.enable(O.SCISSOR_TEST),O.scissor(a*s.q.devicePixelRatio,d*s.q.devicePixelRatio,v*s.q.devicePixelRatio,S*s.q.devicePixelRatio),P.clear({color:A}),O.disable(O.SCISSOR_TEST)}const Vv=s.ec([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:$v}=Vv;function Ad(y,a,d,v){y.emplaceBack(a,d,v)}class of{constructor(a){this.vertexArray=new s.eg,this.indices=new s.a_,Ad(this.vertexArray,-1,-1,1),Ad(this.vertexArray,1,-1,1),Ad(this.vertexArray,-1,1,1),Ad(this.vertexArray,1,1,1),Ad(this.vertexArray,-1,-1,-1),Ad(this.vertexArray,1,-1,-1),Ad(this.vertexArray,-1,1,-1),Ad(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=a.createVertexBuffer(this.vertexArray,$v),this.indexBuffer=a.createIndexBuffer(this.indices),this.segment=s.bd.simpleSegment(0,0,36,12)}}function qc(y,a,d,v,S,A){const P=y.context.gl,O=a.paint.get("sky-atmosphere-color"),I=a.paint.get("sky-atmosphere-halo-color"),H=a.paint.get("sky-atmosphere-sun-intensity"),G=((ne,J,re,de,ce)=>({u_matrix_3f:ne,u_sun_direction:J,u_sun_intensity:re,u_color_tint_r:[de.r,de.g,de.b,de.a],u_color_tint_m:[ce.r,ce.g,ce.b,ce.a],u_luminance:5e-5}))(s.ei(s.dJ(),v),S,H,O.toPremultipliedRenderColor(null),I.toPremultipliedRenderColor(null));P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_CUBE_MAP_POSITIVE_X+A,a.skyboxTexture,0),d.draw(y,P.TRIANGLES,Fn.disabled,Pr.disabled,ei.unblended,_r.frontCW,G,"skyboxCapture",a.skyboxGeometry.vertexBuffer,a.skyboxGeometry.indexBuffer,a.skyboxGeometry.segment)}const fn=s.ec([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Ln{constructor(a){const d=new s.ej;d.emplaceBack(-1,1,1,0,0),d.emplaceBack(1,1,1,1,0),d.emplaceBack(1,-1,1,1,1),d.emplaceBack(-1,-1,1,0,1);const v=new s.a_;v.emplaceBack(0,1,2),v.emplaceBack(2,3,0),this.vertexBuffer=a.createVertexBuffer(d,fn.members),this.indexBuffer=a.createIndexBuffer(v),this.segments=s.bd.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const lf=s.ec([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class ra{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class yt{constructor(a){this.colorModeAlphaBlendedWriteRGB=new ei([1,Ou,1,Ou],s.am.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new ei([1,0,1,0],s.am.transparent,[!1,!1,!1,!0]),this.params=new ra,this.updateNeeded=!0,a.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},(()=>{this.updateNeeded=!0})),a.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),a.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0})),a.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0}))}update(a){const d=a.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Ln(d);const v=this.params.sizeRange,S=this.params.intensityRange,A=(function(G){const ne=s.el(30),J=[];for(let re=0;re<G;++re){const de=2*Math.PI*ne(),ce=Math.acos(1-2*ne())-.5*Math.PI;J.push(s.d2(Math.cos(ce)*Math.cos(de),Math.cos(ce)*Math.sin(de),Math.sin(ce)))}return J})(this.params.starsCount),P=s.el(300),O=new s.ek,I=new s.a_;let H=0;for(let G=0;G<A.length;++G){const ne=s.c1([],A[G],200),J=Math.max(0,1+.01*v*(1*P()-.5)),re=Math.max(0,1+.01*S*(1*P()-.5));O.emplaceBack(ne[0],ne[1],ne[2],-1,-1,J,re),O.emplaceBack(ne[0],ne[1],ne[2],1,-1,J,re),O.emplaceBack(ne[0],ne[1],ne[2],1,1,J,re),O.emplaceBack(ne[0],ne[1],ne[2],-1,1,J,re),I.emplaceBack(H+0,H+1,H+2),I.emplaceBack(H+0,H+2,H+3),H+=4}this.starsVx=d.createVertexBuffer(O,lf.members),this.starsIdx=d.createIndexBuffer(I),this.starsSegments=s.bd.simpleSegment(0,0,O.length,I.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(a,d){const v=a.context,S=v.gl,A=a.transform,P=new Fn(S.LEQUAL,Fn.ReadOnly,[0,1]),O=s.ah(A.zoom),I=a.style.getLut(d.scope),H=d.properties.get("color-use-theme")==="none",G=d.properties.get("color").toNonPremultipliedRenderColor(H?null:I).toArray01(),ne=d.properties.get("high-color-use-theme")==="none",J=d.properties.get("high-color").toNonPremultipliedRenderColor(ne?null:I).toArray01(),re=d.properties.get("space-color-use-theme")==="none",de=d.properties.get("space-color").toNonPremultipliedRenderColor(re?null:I).toArray01(),ce=5e-4,pe=s.em(d.properties.get("horizon-blend"),0,1,ce,.25),me=s.dy(a,v,A)&&pe===ce?A.worldSize/(2*Math.PI*1.025)-1:A.globeRadius,be=a.frameCounter/1e3%1,Ne=s.ae(A.globeCenterInViewSpace),De=Math.sqrt(Math.pow(Ne,2)-Math.pow(me,2)),Be=Math.acos(De/Ne),Ze=Ye=>{const Ue=A.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ye&&Ue.push("ALPHA_PASS");const qe=a.getOrCreateProgram("globeAtmosphere",{defines:Ue}),Ge=((ct,Bt,Ct,Xt,gn,wt,at,Dt,At,Gt,Yt,Ht)=>({u_frustum_tl:ct,u_frustum_tr:Bt,u_frustum_br:Ct,u_frustum_bl:Xt,u_horizon:gn,u_transition:wt,u_fadeout_range:at,u_color:Dt,u_high_color:At,u_space_color:Gt,u_temporal_offset:Yt,u_horizon_angle:Ht}))(A.frustumCorners.TL,A.frustumCorners.TR,A.frustumCorners.BR,A.frustumCorners.BL,A.frustumCorners.horizon,O,pe,G,J,de,be,Be);a.uploadCommonUniforms(v,qe);const _t=this.atmosphereBuffer;_t&&qe.draw(a,S.TRIANGLES,P,Pr.disabled,Ye?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,_r.backCW,Ge,Ye?"atmosphere_glow_alpha":"atmosphere_glow",_t.vertexBuffer,_t.indexBuffer,_t.segments)};Ze(!1),Ze(!0)}drawStars(a,d){const v=s.ay(d.properties.get("star-intensity"),0,1);if(v===0)return;const S=a.context,A=S.gl,P=a.transform,O=a.getOrCreateProgram("stars"),I=s.c3([]);s.c5(I,I,-P._pitch),s.c4(I,I,-P.angle),s.c5(I,I,s.al(P._center.lat)),s.en(I,I,-s.al(P._center.lng));const H=s.c8(new Float32Array(16),I),G=s.az([],P.starsProjMatrix,H),ne=s.ei([],H),J=s.eo([],ne),re=[0,1,0];s.dL(re,re,J),s.c1(re,re,this.params.sizeMultiplier);const de=[1,0,0];s.dL(de,de,J),s.c1(de,de,this.params.sizeMultiplier);const ce=(pe=re,me=de,be=v,{u_matrix:Float32Array.from(G),u_up:pe,u_right:me,u_intensity_multiplier:be});var pe,me,be;a.uploadCommonUniforms(S,O),this.starsVx&&this.starsIdx&&O.draw(a,A.TRIANGLES,Fn.disabled,Pr.disabled,this.colorModeAlphaBlendedWriteRGB,_r.disabled,ce,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}class qv{constructor(){this.visibleTiles=[]}updateBorders(a,d){const v=[],S=[],A=a._getRenderableCoordinates(!1,!0);for(const I of A){const H=a.getTile(I);if(!H.hasData())continue;const G=H.getBucket(d);G&&(G.isEmpty()||(v.push(I.key),S.push({bucket:G,tileID:I.canonical})))}let P=v.length!==this.visibleTiles.length;if(!P){v.sort();for(let I=0;I<v.length;I++)if(v[I]!==this.visibleTiles[I]){P=!0;break}}if(!P)return;const O=new Set;this.visibleTiles=v,S.sort(((I,H)=>I.tileID.z-H.tileID.z||I.tileID.x-H.tileID.x||I.tileID.y-H.tileID.y));for(const I of S){const H=new Array,G=new Array,ne=I.bucket;for(const J of ne.featuresOnBorder)O.has(J.featureId)?G.push(J.footprintIndex):(O.add(J.featureId),H.push(J.footprintIndex));ne.updateFootprintHiddenFlags(H,s.ep,!1),ne.updateFootprintHiddenFlags(G,s.ep,!0)}}}function gp(y,a){const d=[...y],v=a.cameraWorldSizeForFog/a.worldSize,S=s.bx([]);return s.cP(S,S,[v,v,1]),s.az(d,S,d),s.az(d,a.worldToFogMatrix,d),d}function yp(y,a,d,v,S){const A=d.material,P=v.context,{baseColorTexture:O,metallicRoughnessTexture:I}=A.pbrMetallicRoughness,{normalTexture:H,occlusionTexture:G,emissionTexture:ne}=A;function J(de,ce,pe){if(de&&(y.push(ce),P.activeTexture.set(P.gl.TEXTURE0+pe),de.gfxTexture)){const{minFilter:me,magFilter:be,wrapS:Ne,wrapT:De}=de.sampler;de.gfxTexture.bindExtraParam(me,be,Ne,De)}}J(O,"HAS_TEXTURE_u_baseColorTexture",Uo.BaseColor),J(I,"HAS_TEXTURE_u_metallicRoughnessTexture",Uo.MetallicRoughness),J(H,"HAS_TEXTURE_u_normalTexture",Uo.Normal),J(G,"HAS_TEXTURE_u_occlusionTexture",Uo.Occlusion),J(ne,"HAS_TEXTURE_u_emissionTexture",Uo.Emission),S&&(S.texture||(S.texture=new s.et(v.context,S.image,[S.image.height,S.image.height,S.image.height],P.gl.RGBA8)),P.activeTexture.set(P.gl.TEXTURE0+Uo.LUT),S.texture&&S.texture.bind(P.gl.LINEAR,P.gl.CLAMP_TO_EDGE),y.push("APPLY_LUT_ON_GPU")),d.texcoordBuffer&&(y.push("HAS_ATTRIBUTE_a_uv_2f"),a.push(d.texcoordBuffer)),d.colorBuffer&&(y.push(d.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),a.push(d.colorBuffer)),d.normalBuffer&&(y.push("HAS_ATTRIBUTE_a_normal_3f"),a.push(d.normalBuffer)),d.pbrBuffer&&(y.push("HAS_ATTRIBUTE_a_pbr"),y.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),a.push(d.pbrBuffer)),A.alphaMode!=="OPAQUE"&&A.alphaMode!=="MASK"||y.push("UNPREMULT_TEXTURE_IN_SHADER"),A.defined||y.push("DIFFUSE_SHADED");const re=v.shadowRenderer;re&&(y.push("RENDER_SHADOWS","DEPTH_TEXTURE"),re.useNormalOffset&&y.push("NORMAL_OFFSET"))}function cf(y,a,d,v,S,A){const P=d.paint.get("model-opacity").constantOr(1),O=a.context,I=new Fn(a.context.gl.LEQUAL,Fn.ReadWrite,a.depthRangeFor3D),H=a.transform,G=y.mesh,ne=G.material,J=ne.pbrMetallicRoughness,re=a.style.fog;let de;de=a.transform.projection.zAxisUnit==="pixels"?[...y.nodeModelMatrix]:s.az([],v.zScaleMatrix,y.nodeModelMatrix),s.az(de,v.negCameraPosMatrix,de);const ce=s.bi([],de);s.ea(ce,ce);const pe=d.paint.get("model-color-use-theme").constantOr("default")==="none",me=d.paint.get("model-emissive-strength").constantOr(0),be=Pm(new Float32Array(y.worldViewProjection),new Float32Array(de),new Float32Array(ce),null,a,P,J.baseColorFactor,ne.emissiveFactor,J.metallicFactor,J.roughnessFactor,ne,me,d),Ne={defines:[]},De=[],Be=a.shadowRenderer;Be&&(Be.useNormalOffset=!1),yp(Ne.defines,De,G,a,pe?null:d.lut);let Ze=null;if(re){const qe=gp(y.nodeModelMatrix,a.transform);if(Ze=new Float32Array(qe),H.projection.name!=="globe"){const Ge=G.aabb.min,_t=G.aabb.max,[ct,Bt]=re.getOpacityForBounds(qe,Ge[0],Ge[1],_t[0],_t[1]);Ne.overrideFog=ct>=Kt||Bt>=Kt}}const Ye=Du(a,d.paint.get("model-cutoff-fade-range"));Ye.shouldRenderCutoff&&Ne.defines.push("RENDER_CUTOFF");const Ue=a.getOrCreateProgram("model",Ne);a.uploadCommonUniforms(O,Ue,null,Ze,Ye),a.renderPass!=="shadow"&&Be&&Be.setupShadowsFromMatrix(y.nodeModelMatrix,Ue),Ue.draw(a,O.gl.TRIANGLES,I,S,A,G.material.doubleSided?_r.disabled:_r.backCCW,be,d.id,G.vertexBuffer,G.indexBuffer,G.segments,d.paint,a.transform.zoom,void 0,De)}function oy(y,a,d,v,S,A,P){let O;O=y.projection.name==="globe"?s.er(d,y):[...d],s.az(O,O,a.matrix);const I=s.az([],v,O);if(a.meshes)for(const H of a.meshes){if(H.material.alphaMode!=="BLEND"){P.push({mesh:H,depth:0,modelIndex:S,worldViewProjection:I,nodeModelMatrix:O});continue}const G=s.ad([],H.centroid,I);!y.isOrthographic&&G[2]<=0||A.push({mesh:H,depth:G[2],modelIndex:S,worldViewProjection:I,nodeModelMatrix:O})}if(a.children)for(const H of a.children)oy(y,H,d,v,S,A,P)}function zm(y,a,d,v){const S=d.shadowRenderer;if(!S)return;const A=S.getShadowPassDepthMode(),P=S.getShadowPassColorMode(),O=S.calculateShadowPassMatrixFromMatrix(a),I=wd(O);d.getOrCreateProgram("modelDepth",{defines:d._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(d,d.context.gl.TRIANGLES,A,Pr.disabled,P,_r.backCCW,I,v.id,y.vertexBuffer,y.indexBuffer,y.segments,v.paint,d.transform.zoom,void 0,void 0)}function xh(y,a,d){const v=a.updateZoomBasedPaintProperties(),S=(function(A,P,O){let I,H,G,ne=A.terrain?A.terrain.exaggeration():0;if(A.terrain&&ne>0){const J=A.terrain,re=J.findDEMTileFor(O);re&&re.dem?I=s.eu.create(J,O,re):ne=0}if(ne===0&&(P.terrainElevationMin=0,P.terrainElevationMax=0),ne===P.validForExaggeration&&(ne===0||I&&I._demTile&&I._demTile.tileID===P.validForDEMTile.id&&I._dem._timestamp===P.validForDEMTile.timestamp))return!1;for(const J in P.instancesPerModel){const re=P.instancesPerModel[J];for(let de=0;de<re.instancedDataArray.length;++de){const ce=(I?ne*I.getElevationAt(0|re.instancedDataArray.float32[16*de],0|re.instancedDataArray.float32[16*de+1],!0,!0):0)+re.instancesEvaluatedElevation[de];re.instancedDataArray.float32[16*de+6]=ce,H=H?Math.min(P.terrainElevationMin,ce):ce,G=G?Math.max(P.terrainElevationMax,ce):ce}}return P.terrainElevationMin=H||0,P.terrainElevationMax=G||0,P.validForExaggeration=ne,P.validForDEMTile=I&&I._demTile?{id:I._demTile.tileID,timestamp:I._dem._timestamp}:{id:void 0,timestamp:0},!0})(y,a,d);(v||S)&&(a.uploaded=!1,a.upload(y.context))}const hu={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new s.d6([0,0,0],[s.aj,s.aj,0])};function b_(y,a){const d=1<<y.canonical.z,v=a.getFreeCameraOptions().position,S=a.elevation,A=y.canonical.x/d,P=(y.canonical.x+1)/d,O=y.canonical.y/d,I=(y.canonical.y+1)/d;let H=a._centerAltitude;if(S){const re=S.getMinMaxForTile(y);re&&re.max>H&&(H=re.max)}const G=s.ay(v.x,A,P)-v.x,ne=s.ay(v.y,O,I)-v.y,J=s.cb(H,a.center.lat)-v.z;return a._zoomFromMercatorZ(Math.sqrt(G*G+ne*ne+J*J))}function Fm(y,a,d,v,S,A,P){const O=y.context,I=y.renderPass==="shadow",H=y.shadowRenderer,G=I&&H?H.getShadowPassDepthMode():new Fn(O.gl.LEQUAL,Fn.ReadWrite,y.depthRangeFor3D),ne=y.isTileAffectedByFog(A);if(d.meshes)for(const J of d.meshes){const re=["MODEL_POSITION_ON_GPU"],de=[];let ce,pe,me;v.instancedDataArray.length>20&&re.push("INSTANCED_ARRAYS");const be=Du(y,a.paint.get("model-cutoff-fade-range"));if(be.shouldRenderCutoff&&re.push("RENDER_CUTOFF"),I&&H)ce=y.getOrCreateProgram("modelDepth",{defines:re}),pe=wd(P.shadowTileMatrix,P.shadowTileMatrix,Float32Array.from(d.matrix)),me=H.getShadowPassColorMode();else{yp(re,de,J,y,a.paint.get("model-color-use-theme").constantOr("default")==="none"?null:a.lut),ce=y.getOrCreateProgram("model",{defines:re,overrideFog:ne});const De=J.material,Be=De.pbrMetallicRoughness,Ze=a.paint.get("model-opacity").constantOr(1),Ye=a.paint.get("model-emissive-strength").constantOr(0);pe=Pm(A.expandedProjMatrix,Float32Array.from(d.matrix),new Float32Array(16),null,y,Ze,Be.baseColorFactor,De.emissiveFactor,Be.metallicFactor,Be.roughnessFactor,De,Ye,a,S),H&&(P.shadowUniformsInitialized?ce.setShadowUniformValues(O,H.getShadowUniformValues()):(H.setupShadows(A.toUnwrapped(),ce,"model-tile"),P.shadowUniformsInitialized=!0)),me=be.shouldRenderCutoff||Ze<1||De.alphaMode!=="OPAQUE"?ei.alphaBlended:ei.unblended}y.uploadCommonUniforms(O,ce,A.toUnwrapped(),null,be);const Ne=J.material.doubleSided?_r.disabled:_r.backCCW;if(v.instancedDataArray.length>20)de.push(v.instancedDataBuffer),ce.draw(y,O.gl.TRIANGLES,G,Pr.disabled,me,Ne,pe,a.id,J.vertexBuffer,J.indexBuffer,J.segments,a.paint,y.transform.zoom,void 0,de,v.instancedDataArray.length);else{const De=I?"u_instance":"u_normal_matrix";for(let Be=0;Be<v.instancedDataArray.length;++Be)pe[De]=new Float32Array(v.instancedDataArray.arrayBuffer,64*Be,16),ce.draw(y,O.gl.TRIANGLES,G,Pr.disabled,me,Ne,pe,a.id,J.vertexBuffer,J.indexBuffer,J.segments,a.paint,y.transform.zoom,void 0,de)}}if(d.children)for(const J of d.children)Fm(y,a,J,v,S,A,P)}const Bm=[1,-1,1];function ly(y,a,d,v){if(!d.modelManager)return!0;const S=d.modelManager;if(!d.shadowRenderer)return!0;const A=d.shadowRenderer,P=a.aabb;let O=!0,I=y.maxHeight;if(I===0){let G=0;for(const ne in y.instancesPerModel){const J=S.getModel(ne,v);J?G=Math.max(G,Math.max(Math.max(J.aabb.max[0],J.aabb.max[1]),J.aabb.max[2])):O=!1}I=y.maxScale*G*1.41+y.maxVerticalOffset,O&&(y.maxHeight=I)}P.max[2]=I,P.min[2]+=y.terrainElevationMin,P.max[2]+=y.terrainElevationMax,s.ad(P.min,P.min,a.tileMatrix),s.ad(P.max,P.max,a.tileMatrix);const H=P.intersects(A.getCurrentCascadeFrustum());return d.currentShadowCascade===0&&(y.isInsideFirstShadowMapFrustum=H===2),H===0}function w_(y,a){const d=y.uniformValues.u_cutoff_params[0],v=y.uniformValues.u_cutoff_params[1],S=y.uniformValues.u_cutoff_params[2],A=y.uniformValues.u_cutoff_params[3];return v===d||A===S?1:s.ay(((a-d)/(v-d)-S)/(A-S),0,1)}function cy(y,a,d,v){if(a.pitch<20)return 1;const S=a.getWorldToCameraMatrix();s.az(S,S,y);const A=s.bR(d.min[0],d.min[1],d.min[2],1);let P=s.aA(s.ev(),A,S),O=P,I=P;A[1]=d.max[1],P=s.aA(s.ev(),A,S),O=P[1]<O[1]?P:O,I=P[1]>I[1]?P:I,A[0]=d.max[0],P=s.aA(s.ev(),A,S),O=P[1]<O[1]?P:O,I=P[1]>I[1]?P:I,A[1]=d.min[1],P=s.aA(s.ev(),A,S),O=P[1]<O[1]?P:O,I=P[1]>I[1]?P:I;const H=s.ay(v[0],0,1),G=100*a.pixelsPerMeter*s.ay(v[1],0,1),ne=s.ay(v[2],0,1),J=s.ew(s.ev(),O,I,H),re=Math.tan(.5*a.fovX),de=-J[2]*re;if(G===0)return J[1]<-Math.abs(de)?ne:1;const ce=(-Math.abs(de)-J[1])/G,pe=(be,Ne,De)=>(1-De)*be+De*Ne,me=s.ay(pe(1,ne,ce),ne,1);return pe(1,me,s.ay((a.pitch-20)/20,0,1))}class Um{}class vp{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(a,d,v){{const ne=this._storage.get(d.id);if(ne)return ne.lastUsedFrameIdx=a,ne.buf}const S=v.gl,A=S.getBufferParameter(S.ELEMENT_ARRAY_BUFFER,S.BUFFER_SIZE),P=new ArrayBuffer(A),O=new Int16Array(P);S.getBufferSubData(S.ELEMENT_ARRAY_BUFFER,0,new Int16Array(P));const I=new s.ey;for(let ne=0;ne<A/2;ne+=3){const J=O[ne],re=O[ne+1],de=O[ne+2];I.emplaceBack(J,re),I.emplaceBack(re,de),I.emplaceBack(de,J)}const H=v.bindVertexArrayOES.current,G=new Um;return G.buf=new qs(v,I),G.lastUsedFrameIdx=a,this._storage.set(d.id,G),v.bindVertexArrayOES.set(H),G.buf}update(a){for(const[d,v]of this._storage)a-v.lastUsedFrameIdx>30&&(v.buf.destroy(),this._storage.delete(d))}destroy(){for(const[a,d]of this._storage)d.buf.destroy(),this._storage.delete(a)}}class _h{constructor(a){this.occluderSize=30,this.depthOffset=-1e-4,a.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),a.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Hv=s.ec([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class S_{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class al{constructor(a,d){this.revealStart=11,this.revealRange=2,a.registerParameter(this,[...d,"Reveal"],"revealStart",{min:0,max:17,step:.05}),a.registerParameter(this,[...d,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const tw=s.ec([{type:"Float32",name:"a_pos_2f",components:2}]);class xp{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(a,d){const v=a.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const P=new s.ez,O=new s.a_;P.emplaceBack(-1,-1),P.emplaceBack(1,-1),P.emplaceBack(1,1),P.emplaceBack(-1,1),O.emplaceBack(0,1,2),O.emplaceBack(0,2,3),this.vignetteVx=a.context.createVertexBuffer(P,tw.members),this.vignetteIdx=a.context.createIndexBuffer(O)}const S=s.bd.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){a.uploadCommonUniforms(a.context,v);const P={u_vignetteShape:(A={vignetteShape:[d.start,d.range,Math.pow(10,d.fadePower)],vignetteColor:[d.color.r,d.color.g,d.color.b,d.color.a*d.strength]}).vignetteShape,u_vignetteColor:A.vignetteColor};v.draw(a,a.context.gl.TRIANGLES,Fn.disabled,Pr.disabled,ei.alphaBlended,_r.disabled,P,"vignette",this.vignetteVx,this.vignetteIdx,S)}var A}}class As{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(a,d){const v=a.getFreeCameraOptions().position,S=v.toAltitude(),A=v.toLngLat(),P=s.al(A.lng),O=s.al(A.lat),I=a.pixelsPerMeter/d,H=P*s.eB,G=s.eB*Math.log(Math.tan(Math.PI/4+O/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const ne=-this._offsetYPrev+G,J=-this._elevationPrev+S;this._accumulatedOffsetX+=(-this._offsetXPrev+H)*I,this._accumulatedOffsetY+=ne*I,this._accumulatedElevation+=J*I,this._offsetXPrev=H,this._offsetYPrev=G,this._elevationPrev=S}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Ai(y,a){return[-(y[0]-Math.floor(y[0]/a)*a),-(y[1]-Math.floor(y[1]/a)*a),-(y[2]-Math.floor(y[2]/a)*a)]}function _p(y){const a=s.el(1323123451230),d=[];for(let v=0;v<y;++v){const S=2*a()-1,A=2*a()-1,P=2*a()-1;d.push(s.d2(S,A,P))}return d}function bl(y,a,d,v,S){const A=s.ay((S-d)/(v-d),0,1);return(1-A)*y+A*a}class uf{constructor(a){this._movement=new As,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new xp,this._ppmScaleFactor=a}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(a,d){const v=a.transform;this._movement.update(v,this._ppmScaleFactor);const S=v.starsProjMatrix,A=s.c3([]);s.c5(A,A,s.al(90)-v._pitch),s.c4(A,A,-v.angle);const P=s.c8(new Float32Array(16),A),O=s.eA(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),I=s.ea([],O),H=s.az([],I,P),G=Date.now()/1e3;return this._accumulatedTimeFromStart+=(G-this._prevTime)*d,this._prevTime=G,{projectionMatrix:S,modelviewMatrix:H}}}class jd extends uf{constructor(a){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new al(a.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(a){const d=a.context;if(!this.particlesVx){const v=_p(this.particlesCount),S=new s.eC,A=new s.a_;let P=0;const O=s.el(1323123451230);for(let I=0;I<v.length;++I){const H=v[I],G=[2*O()-1,O(),O(),O()];S.emplaceBack(H[0],H[1],H[2],-1,-1,...G),S.emplaceBack(H[0],H[1],H[2],1,-1,...G),S.emplaceBack(H[0],H[1],H[2],1,1,...G),S.emplaceBack(H[0],H[1],H[2],-1,1,...G),A.emplaceBack(P+0,P+1,P+2),A.emplaceBack(P+0,P+2,P+3),P+=4}this.particlesVx=d.createVertexBuffer(S,Hv.members),this.particlesIdx=d.createIndexBuffer(A)}}draw(a){if(!this._params.overrideStyleParameters&&!a.style.rain)return;const d=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},v=a.transform.zoom;if(d.revealStart>v)return;const S=bl(0,1,d.revealStart,d.revealStart+d.revealRange,v);if(!this.particlesVx||!this.particlesIdx)return;const A=structuredClone(this._params);let P=[-A.direction.x,A.direction.y,-100];s.au(P,P);const O=structuredClone(this._vignetteParams);O.strength*=S,A.overrideStyleParameters||(A.intensity=a.style.rain.state.density,A.timeFactor=a.style.rain.state.intensity,A.color=structuredClone(a.style.rain.state.color),P=structuredClone(a.style.rain.state.direction),A.screenThinning.intensity=a.style.rain.state.centerThinning,A.dropletSizeX=a.style.rain.state.dropletSize[0],A.dropletSizeYScale=a.style.rain.state.dropletSize[1]/a.style.rain.state.dropletSize[0],A.distortionStrength=100*a.style.rain.state.distortionStrength,O.strength=1,O.color=structuredClone(a.style.rain.state.vignetteColor));const I=this.updateOnRender(a,A.timeFactor),H=a.context,G=H.gl,ne=a.transform;this.screenTexture&&this.screenTexture.size[0]===a.width&&this.screenTexture.size[1]===a.height||(this.screenTexture=new s.T(H,{width:a.width,height:a.height,data:null},G.RGBA8)),A.distortionStrength>0&&(H.activeTexture.set(G.TEXTURE0),this.screenTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),G.copyTexSubImage2D(G.TEXTURE_2D,0,0,0,0,0,a.width,a.height));const J=a.getOrCreateProgram("rainParticle");a.uploadCommonUniforms(H,J),H.activeTexture.set(G.TEXTURE0),this.screenTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE);const re=[A.color.r,A.color.g,A.color.b,A.color.a],de=(ce,pe)=>{const me=Ai(this._movement.getPosition(),ce),be=A.dropletSizeX,Ne=A.dropletSizeX*A.dropletSizeYScale,De=a.width/2,Be=a.height/2,Ze=bl(0,A.screenThinning.start,0,1,A.screenThinning.intensity),Ye=bl(.001,A.screenThinning.range,0,1,A.screenThinning.intensity),Ue=bl(0,A.screenThinning.particleOffset,0,1,A.screenThinning.intensity),qe=(Ge={modelview:I.modelviewMatrix,projection:I.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:me,velocityConeAperture:A.velocityConeAperture,velocity:A.velocity,boxSize:ce,rainDropletSize:[be,Ne],distortionStrength:A.distortionStrength,rainDirection:P,color:re,screenSize:[ne.width,ne.height],thinningCenterPos:[De,Be],thinningShape:[Ze,Ye,Math.pow(10,A.screenThinning.fadePower)],thinningAffectedRatio:A.screenThinning.affectedRatio,thinningParticleOffset:Ue,shapeDirectionalPower:A.shapeDirPower,shapeNormalPower:A.shapeNormalPower,mode:pe?0:1},{u_modelview:Float32Array.from(Ge.modelview),u_projection:Float32Array.from(Ge.projection),u_time:Ge.time,u_cam_pos:Ge.camPos,u_texScreen:0,u_velocityConeAperture:Ge.velocityConeAperture,u_velocity:Ge.velocity,u_boxSize:Ge.boxSize,u_rainDropletSize:Ge.rainDropletSize,u_distortionStrength:Ge.distortionStrength,u_rainDirection:Ge.rainDirection,u_color:Ge.color,u_screenSize:Ge.screenSize,u_thinningCenterPos:Ge.thinningCenterPos,u_thinningShape:Ge.thinningShape,u_thinningAffectedRatio:Ge.thinningAffectedRatio,u_thinningParticleOffset:Ge.thinningParticleOffset,u_shapeDirectionalPower:Ge.shapeDirectionalPower,u_shapeNormalPower:Ge.shapeNormalPower,u_mode:Ge.mode});var Ge;const _t=Math.round(A.intensity*this.particlesCount),ct=s.bd.simpleSegment(0,0,4*_t,2*_t);J.draw(a,G.TRIANGLES,Fn.disabled,Pr.disabled,ei.alphaBlended,_r.disabled,qe,"rain_particles",this.particlesVx,this.particlesIdx,ct)};A.distortionStrength>0&&de(A.boxSize,!0),de(A.boxSize,!1),this._vignette.draw(a,O)}}const bh=s.ec([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class uy extends uf{constructor(a){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new al(a.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(a){const d=a.context;if(!this.particlesVx){const v=_p(this.particlesCount),S=new s.eD,A=new s.a_;let P=0;const O=s.el(1323123451230);for(let I=0;I<v.length;++I){const H=v[I],G=O(),ne=O(),J=O(),re=[I/v.length,G,ne,J],de=[O(),O()];S.emplaceBack(H[0],H[1],H[2],-1,-1,...re,...de),S.emplaceBack(H[0],H[1],H[2],1,-1,...re,...de),S.emplaceBack(H[0],H[1],H[2],1,1,...re,...de),S.emplaceBack(H[0],H[1],H[2],-1,1,...re,...de),A.emplaceBack(P+0,P+1,P+2),A.emplaceBack(P+0,P+2,P+3),P+=4}this.particlesVx=d.createVertexBuffer(S,bh.members),this.particlesIdx=d.createIndexBuffer(A)}}draw(a){if(!this._params.overrideStyleParameters&&!a.style.snow)return;const d=structuredClone(this._params);let v=[-d.direction.x,d.direction.y,-100];s.au(v,v);const S=structuredClone(this._vignetteParams),A=d.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},P=a.transform.zoom;if(A.revealStart>P)return;const O=bl(0,1,A.revealStart,A.revealStart+A.revealRange,P);S.strength*=O,d.overrideStyleParameters||(d.intensity=a.style.snow.state.density,d.timeFactor=a.style.snow.state.intensity,d.color=structuredClone(a.style.snow.state.color),v=structuredClone(a.style.snow.state.direction),d.screenThinning.intensity=a.style.snow.state.centerThinning,d.billboardSize=2.79*a.style.snow.state.flakeSize,S.strength=1,S.color=structuredClone(a.style.snow.state.vignetteColor));const I=this.updateOnRender(a,d.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const H=a.context,G=H.gl,ne=a.transform,J=a.getOrCreateProgram("snowParticle");a.uploadCommonUniforms(H,J),((re,de,ce)=>{const pe=Ai(this._movement.getPosition(),re),me=ne.width/2,be=ne.height/2,Ne=bl(0,ce.screenThinning.start,0,1,ce.screenThinning.intensity),De=bl(.001,ce.screenThinning.range,0,1,ce.screenThinning.intensity),Be=bl(0,ce.screenThinning.particleOffset,0,1,ce.screenThinning.intensity),Ze=(Ye={modelview:I.modelviewMatrix,projection:I.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:pe,velocityConeAperture:ce.velocityConeAperture,velocity:ce.velocity,horizontalOscillationRadius:ce.horizontalOscillationRadius,horizontalOscillationRate:ce.horizontalOscillationRate,boxSize:re,billboardSize:1*ce.billboardSize,simpleShapeParameters:[ce.shapeFadeStart,ce.shapeFadePower],screenSize:[ne.width,ne.height],thinningCenterPos:[me,be],thinningShape:[Ne,De,Math.pow(10,ce.screenThinning.fadePower)],thinningAffectedRatio:ce.screenThinning.affectedRatio,thinningParticleOffset:Be,color:[ce.color.r,ce.color.g,ce.color.b,ce.color.a],direction:v},{u_modelview:Float32Array.from(Ye.modelview),u_projection:Float32Array.from(Ye.projection),u_time:Ye.time,u_cam_pos:Ye.camPos,u_velocityConeAperture:Ye.velocityConeAperture,u_velocity:Ye.velocity,u_horizontalOscillationRadius:Ye.horizontalOscillationRadius,u_horizontalOscillationRate:Ye.horizontalOscillationRate,u_boxSize:Ye.boxSize,u_billboardSize:Ye.billboardSize,u_simpleShapeParameters:Ye.simpleShapeParameters,u_screenSize:Ye.screenSize,u_thinningCenterPos:Ye.thinningCenterPos,u_thinningShape:Ye.thinningShape,u_thinningAffectedRatio:Ye.thinningAffectedRatio,u_thinningParticleOffset:Ye.thinningParticleOffset,u_particleColor:Ye.color,u_direction:Ye.direction});var Ye;const Ue=Math.round(ce.intensity*this.particlesCount),qe=s.bd.simpleSegment(0,0,4*Ue,2*Ue);this.particlesVx&&this.particlesIdx&&J.draw(a,G.TRIANGLES,Fn.disabled,Pr.disabled,ei.alphaBlended,_r.disabled,Ze,"snow_particles",this.particlesVx,this.particlesIdx,qe)})(d.boxSize,0,d),this._vignette.draw(a,S)}}const Gv={symbol:function(y,a,d,v,S){if(y.renderPass!=="translucent")return;const A=Pr.disabled,P=y.colorModeForRenderPass(),O=d.layout.get("text-variable-anchor"),I=d.layout.get("text-size-scale-range"),H=s.ay(y.scaleFactor,I[0],I[1]);O&&(function(J,re,de,ce,pe,me,be,Ne){const De=re.transform,Be=pe==="map",Ze=me==="map";for(const Ye of J){const Ue=ce.getTile(Ye),qe=Ue.getBucket(de);if(!qe||!qe.text||!qe.text.segments.get().length)continue;const Ge=s.bH(qe.textSizeData,De.zoom,Ne),_t=Mo(Ye,qe.getProjection(),De),ct=De.calculatePixelsToTileUnitsMatrix(Ue),Bt=Ta(_t,Ue.tileID.canonical,Ze,Be,De,qe.getProjection(),ct),Ct=qe.hasIconTextFit()&&qe.hasIconData();Ge&&ry(qe,Be,Ze,be,De,Bt,Ye,Math.pow(2,De.zoom-Ue.tileID.overscaledZ),Ge,Ct)}})(v,y,d,a,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),S,H);const G=d.paint.get("icon-opacity").constantOr(1)!==0,ne=d.paint.get("text-opacity").constantOr(1)!==0;d.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(G||ne)?Rm(y,a,d,v,A,P):(G&&Rm(y,a,d,v,A,P,{onlyIcons:!0}),ne&&Rm(y,a,d,v,A,P,{onlyText:!0})),a.map.showCollisionBoxes&&(rf(y,a,d,v,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),rf(y,a,d,v,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(y,a,d,v){if(y.renderPass!=="translucent")return;const S=d.paint.get("circle-opacity"),A=d.paint.get("circle-stroke-width"),P=d.paint.get("circle-stroke-opacity"),O=d.layout.get("circle-sort-key").constantOr(1)!==void 0,I=d.paint.get("circle-emissive-strength");if(S.constantOr(1)===0&&(A.constantOr(1)===0||P.constantOr(1)===0))return;const H=y.context,G=H.gl,ne=y.transform,J=!(!y.terrain||!y.terrain.enabled),re=d.layout.get("circle-elevation-reference"),de=y.depthModeForSublayer(0,Fn.ReadOnly),ce=new Fn(y.context.gl.LEQUAL,Fn.ReadOnly,y.depthRangeFor3D),pe=re==="none"||J?de:ce,me=Pr.disabled,be=y.colorModeForDrapableLayerRenderPass(I),Ne=ne.projection.name==="globe",De=[s.aD(ne.center.lng),s.aH(ne.center.lat)],Be=[];for(let Ye=0;Ye<v.length;Ye++){const Ue=v[Ye],qe=a.getTile(Ue),Ge=qe.getBucket(d);if(!Ge||Ge.projection.name!==ne.projection.name)continue;const _t=Ge.programConfigurations.get(d.id),ct=Ge.layoutVertexBuffer,Bt=Ge.globeExtVertexBuffer,Ct=Ge.indexBuffer,Xt=s.dW(d),gn=[Bt],wt=y.isTileAffectedByFog(Ue);Ne&&Xt.push("PROJECTION_GLOBE_VIEW"),Xt.push("DEPTH_D24"),y.terrain&&ne.depthOcclusionForSymbolsAndCircles&&Xt.push("DEPTH_OCCLUSION"),Ge.hasElevation&&!y.terrain&&(Xt.push("ELEVATED_ROADS"),gn.push(Ge.elevatedLayoutVertexBuffer));const at=y.getOrCreateProgram("circle",{config:_t,defines:Xt,overrideFog:wt}),Dt=ne.projection.createInversionMatrix(ne,Ue.canonical),At={programConfiguration:_t,program:at,layoutVertexBuffer:ct,dynamicBuffers:gn,indexBuffer:Ct,uniformValues:s.dX(y,Ue,qe,Dt,De,d),tile:qe};if(O){const Gt=Ge.segments.get();for(const Yt of Gt)Be.push({segments:new s.bd([Yt]),sortKey:Yt.sortKey,state:At})}else Be.push({segments:Ge.segments,sortKey:0,state:At})}O&&Be.sort(((Ye,Ue)=>Ye.sortKey-Ue.sortKey));const Ze={useDepthForOcclusion:ne.depthOcclusionForSymbolsAndCircles};for(const Ye of Be){const{programConfiguration:Ue,program:qe,layoutVertexBuffer:Ge,dynamicBuffers:_t,indexBuffer:ct,uniformValues:Bt,tile:Ct}=Ye.state,Xt=Ye.segments;y.terrain&&y.terrain.setupElevationDraw(Ct,qe,Ze),y.uploadCommonUniforms(H,qe,Ct.tileID.toUnwrapped()),qe.draw(y,G.TRIANGLES,pe,me,be,_r.disabled,Bt,d.id,Ge,ct,Xt,d.paint,ne.zoom,Ue,_t)}},heatmap:function(y,a,d,v){if(d.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const S=y.context,A=S.gl,P=Pr.disabled,O=new ei([A.ONE,A.ONE,A.ONE,A.ONE],s.am.transparent,[!0,!0,!0,!0]);(function(re,de,ce,pe){const me=re.gl,be=de.width*pe,Ne=de.height*pe;re.activeTexture.set(me.TEXTURE1),re.viewport.set([0,0,be,Ne]);let De=ce.heatmapFbo;if(!De||De&&(De.width!==be||De.height!==Ne)){De&&De.destroy();const Be=me.createTexture();me.bindTexture(me.TEXTURE_2D,Be),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_S,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_T,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MIN_FILTER,me.LINEAR),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MAG_FILTER,me.LINEAR),De=ce.heatmapFbo=re.createFramebuffer(be,Ne,!0,null),(function(Ze,Ye,Ue,qe,Ge,_t){const ct=Ze.gl;ct.texImage2D(ct.TEXTURE_2D,0,Ze.extRenderToTextureHalfFloat?ct.RGBA16F:ct.RGBA,Ge,_t,0,ct.RGBA,Ze.extRenderToTextureHalfFloat?ct.HALF_FLOAT:ct.UNSIGNED_BYTE,null),qe.colorAttachment.set(Ue)})(re,0,Be,De,be,Ne)}else me.bindTexture(me.TEXTURE_2D,De.colorAttachment.get()),re.bindFramebuffer.set(De.framebuffer)})(S,y,d,y.transform.projection.name==="globe"?.5:.25),S.clear({color:s.am.transparent});const I=y.transform,H=I.projection.name==="globe",G=H?["PROJECTION_GLOBE_VIEW"]:[],ne=H?_r.frontCCW:_r.disabled,J=[s.aD(I.center.lng),s.aH(I.center.lat)];for(let re=0;re<v.length;re++){const de=v[re];if(a.hasRenderableParent(de))continue;const ce=a.getTile(de),pe=ce.getBucket(d);if(!pe||pe.projection.name!==I.projection.name)continue;const me=y.isTileAffectedByFog(de),be=pe.programConfigurations.get(d.id),Ne=y.getOrCreateProgram("heatmap",{config:be,defines:G,overrideFog:me}),{zoom:De}=y.transform;y.terrain&&y.terrain.setupElevationDraw(ce,Ne),y.uploadCommonUniforms(S,Ne,de.toUnwrapped());const Be=I.projection.createInversionMatrix(I,de.canonical);Ne.draw(y,A.TRIANGLES,Fn.disabled,P,O,ne,ty(y,de,ce,Be,J,De,d.paint.get("heatmap-intensity")),d.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,d.paint,y.transform.zoom,be,H?[pe.globeExtVertexBuffer]:null)}S.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),(function(S,A){const P=S.context,O=P.gl,I=A.heatmapFbo;if(!I)return;P.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,I.colorAttachment.get()),P.activeTexture.set(O.TEXTURE1);let H=A.colorRampTexture;H||(H=A.colorRampTexture=new s.T(P,A.colorRamp,O.RGBA8)),H.bind(O.LINEAR,O.CLAMP_TO_EDGE),S.getOrCreateProgram("heatmapTexture").draw(S,O.TRIANGLES,Fn.disabled,Pr.disabled,S.colorModeForRenderPass(),_r.disabled,((G,ne,J,re)=>({u_image:0,u_color_ramp:1,u_opacity:ne.paint.get("heatmap-opacity")}))(0,A),A.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,A.paint,S.transform.zoom)})(y,d))},line:function(y,a,d,v){if(y.renderPass!=="translucent")return;const S=d.paint.get("line-opacity"),A=d.paint.get("line-width");if(S.constantOr(1)===0||A.constantOr(1)===0)return;const P=d.paint.get("line-emissive-strength"),O=d.paint.get("line-occlusion-opacity"),I=d.layout.get("line-elevation-reference"),H=d.layout.get("line-width-unit")==="meters",G=I==="sea",ne=!(!y.terrain||!y.terrain.enabled),J=y.context,re=J.gl;if(d.hasElevatedBuckets&&y.transform.projection.name==="globe")return;const de=d.layout.get("line-cross-slope"),ce=de!==void 0,pe=de<1,me=y.colorModeForDrapableLayerRenderPass(P),be=y.terrain&&y.terrain.renderingToTexture,Ne=be?1:s.q.devicePixelRatio,De=d.paint.get("line-dasharray"),Be=De.constantOr(1),Ze=d.layout.get("line-cap"),Ye=De.constantOr(null),Ue=Ze.constantOr(null),qe=d.paint.get("line-pattern"),Ge=qe.constantOr(1),_t=d.paint.get("line-pattern-cross-fade"),ct=qe.constantOr(null),Bt=d.paint.get("line-opacity").constantOr(1);let Ct=!Ge&&Bt!==1||y.depthOcclusion&&O>0&&O<1;const Xt=d.paint.get("line-gradient"),gn=Ge?"linePattern":"line",wt=s.dY(d);let at;if(be&&y.terrain&&y.terrain.clipOrMaskOverlapStencilType()&&(Ct=!1),O!==0&&y.depthOcclusion){const Yt=d.paint._values["line-opacity"];Yt&&Yt.value&&Yt.value.kind==="constant"?at=Yt.value:s.w(`Occlusion opacity for layer ${d.id} is supported only when line-opacity isn't data-driven.`)}A.value.kind!=="constant"&&A.value.isLineProgressConstant===!1&&wt.push("VARIABLE_LINE_WIDTH");const Dt=(Yt,Ht,en,Pn,Kn,In)=>{for(const rr of Yt){const ar=a.getTile(rr);if(Ge&&!ar.patternsLoaded())continue;const Er=ar.getBucket(d);if(!Er||Er.elevationType!=="none"&&!Kn||Er.elevationType==="none"&&Kn)continue;y.prepareDrawTile();const Tr=[...Ht],Zr=y.shadowRenderer,ji=Er.elevationType==="road"&&!!Zr&&Zr.enabled;let Lr=[0,0,0];if(ji){const Ei=y.style.directionalLight,Ui=y.style.ambientLight;Ei&&Ui&&(Lr=rh(y.style,Ei,Ui)),Tr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const mi=Er.programConfigurations.get(d.id);let Ii=!1;if(ct&&ar.imageAtlas){const Ei=s.dZ.from(ct),Ui=Ei.getPrimary().scaleSelf(Ne).toString(),fs=ar.imageAtlas.patternPositions.get(Ui),_a=Ei.getSecondary(),ba=_a?ar.imageAtlas.patternPositions.get(_a.scaleSelf(Ne).toString()):null;Ii=!!fs&&!!ba,fs&&mi.setConstantPatternPositions(fs,ba)}_t>0&&(Ii||mi.getPatternTransitionVertexBuffer("line-pattern"))&&Tr.push("LINE_PATTERN_TRANSITION");const os=y.isTileAffectedByFog(rr),Fr=y.getOrCreateProgram(gn,{config:mi,defines:Tr,overrideFog:os});if(!Ge&&Ye&&Ue&&ar.lineAtlas){const Ei=ar.lineAtlas.getDash(Ye,Ue);Ei&&mi.setConstantPatternPositions(Ei)}ji&&Zr.setupShadows(ar.tileID.toUnwrapped(),Fr,"vector-tile");let[Bi,$i]=d.paint.get("line-trim-offset");(Ue==="round"||Ue==="square")&&Bi!==$i&&(Bi===0&&(Bi-=1),$i===1&&($i+=1));const Wi=be?rr.projMatrix:null,ii=H?1/Er.tileToMeter/s.aw(ar,1,y.transform.zoom):1,Xi=H?1/Er.tileToMeter/s.aw(ar,1,Math.floor(y.transform.zoom)):1,oi=Ge?s.d_(y,ar,d,Wi,Ne,ii,Xi,[Bi,$i],Lr,_t):s.d$(y,ar,d,Wi,Er.lineClipsArray.length,Ne,ii,Xi,[Bi,$i],Lr);if(Xt){const Ei=Er.gradients[d.id];let Ui=Ei.texture;if(d.gradientVersion!==Ei.version){let fs=256;if(d.stepInterpolant){const _a=a.getSource().maxzoom,ba=rr.canonical.z===_a?Math.ceil(1<<y.transform.maxZoom-rr.canonical.z):1;fs=s.ay(s.e0(Er.maxLineLength/s.aj*1024*ba),256,J.maxTextureSize)}Ei.gradient=s.e1({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:fs,image:Ei.gradient||void 0,clips:Er.lineClipsArray}),Ei.texture?Ei.texture.update(Ei.gradient):Ei.texture=new s.T(J,Ei.gradient,re.RGBA8),Ei.version=d.gradientVersion,Ui=Ei.texture}J.activeTexture.set(re.TEXTURE1),Ui.bind(d.stepInterpolant?re.NEAREST:re.LINEAR,re.CLAMP_TO_EDGE)}Be&&(J.activeTexture.set(re.TEXTURE0),ar.lineAtlasTexture&&ar.lineAtlasTexture.bind(re.LINEAR,re.REPEAT),mi.updatePaintBuffers()),Ge&&(J.activeTexture.set(re.TEXTURE0),ar.imageAtlasTexture&&ar.imageAtlasTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),mi.updatePaintBuffers()),Kn&&!G&&y.terrain.setupElevationDraw(ar,Fr),y.uploadCommonUniforms(J,Fr,rr.toUnwrapped());const js=Ei=>{at!=null&&(at.value=Bt*O),Fr.draw(y,re.TRIANGLES,en,Ei,me,_r.disabled,oi,d.id,Er.layoutVertexBuffer,Er.indexBuffer,Er.segments,d.paint,y.transform.zoom,mi,[Er.layoutVertexBuffer2,Er.patternVertexBuffer,Er.zOffsetVertexBuffer]),at!=null&&(at.value=Bt)};if(Ct&&!Kn){const Ei=y.stencilModeForClipping(rr).ref;Ei===0&&be&&J.clear({stencil:0});const Ui={func:re.EQUAL,mask:255};oi.u_alpha_discard_threshold=.8,js(new Pr(Ui,Ei,255,re.KEEP,re.KEEP,re.INVERT)),oi.u_alpha_discard_threshold=0,js(new Pr(Ui,Ei,255,re.KEEP,re.KEEP,re.KEEP))}else oi.u_alpha_discard_threshold=Ct&&Kn&&In?.8:0,js(Kn?Pn:y.stencilModeForClipping(rr))}};let At=y.depthModeForSublayer(0,Fn.ReadOnly);const Gt=new Fn(y.depthOcclusion?re.GREATER:re.LEQUAL,Fn.ReadOnly,y.depthRangeFor3D);if(d.hasNonElevatedBuckets){const Yt=!be&&y.terrain;O!==0&&Yt?s.w(`Occlusion opacity for layer ${d.id} is supported on terrain only if the layer has line-z-offset enabled.`):Yt?s.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${d.id}.`):Dt(v,wt,At,Pr.disabled,!1,!0)}if(d.hasElevatedBuckets){I==="hd-road-markup"?ne||(At=Gt,wt.push("ELEVATED_ROADS")):(wt.push("ELEVATED"),At=Gt,ce&&wt.push(pe?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),G&&wt.push("ELEVATION_REFERENCE_SEA"));const Yt=Ct?y.stencilModeFor3D():Pr.disabled;y.forceTerrainMode=!0,Dt(v,wt,At,Yt,!0,!0),Ct&&Dt(v,wt,At,Yt,!0,!1),y.forceTerrainMode=!1}Ct&&(y.resetStencilClippingMasks(),be&&J.clear({stencil:0})),O===0||y.depthOcclusion||be||y.layersWithOcclusionOpacity.push(y.currentLayer)},fill:function(y,a,d,v){const S=d.paint.get("fill-color"),A=d.paint.get("fill-opacity");if(A.constantOr(1)===0)return;const P=d.paint.get("fill-emissive-strength"),O=y.colorModeForDrapableLayerRenderPass(P),I=d.paint.get("fill-pattern"),H=y.opaquePassEnabledForLayer()&&!I.constantOr(1)&&S.constantOr(s.am.transparent).a===1&&A.constantOr(0)===1?"opaque":"translucent";let G="none";d.layout.get("fill-elevation-reference")!=="none"?G="road":d.paint.get("fill-z-offset").constantOr(1)!==0&&(G="offset");const ne=!(!y.terrain||!y.terrain.enabled),J={painter:y,sourceCache:a,layer:d,coords:v,colorMode:O,elevationType:G,terrainEnabled:ne,pass:H};if(y.renderPass!=="shadow")if(G!=="offset"){if(hp(J,!1),G==="road"){const re=!ne&&y.renderPass==="translucent";re&&Hn(y,a,d,v,"geometry"),hp(J,!0,Pr.disabled),re&&(function(de){const{painter:ce,sourceCache:pe,layer:me,coords:be,colorMode:Ne}=de,De=ce.context.gl,Be=de.painter.shadowRenderer,Ze=!!Be&&Be.enabled,Ye=new Fn(ce.context.gl.LEQUAL,Fn.ReadOnly,ce.depthRangeFor3D);let Ue=[0,0,0];if(Ze){const Ge=ce.style.directionalLight,_t=ce.style.ambientLight;Ge&&_t&&(Ue=rh(ce.style,Ge,_t))}const qe=Ge=>{for(const _t of be){const ct=pe.getTile(_t),Bt=ct.getBucket(me);if(!Bt)continue;const Ct=Bt.elevatedStructures;if(!Ct)continue;let Xt,gn;if(Ge?(Xt=Ct.renderableBridgeSegments,gn=Ct.bridgeProgramConfigurations.get(me.id)):(Xt=Ct.renderableTunnelSegments,gn=Ct.tunnelProgramConfigurations.get(me.id)),!Xt||Xt.segments[0].primitiveLength===0)continue;gn.updatePaintBuffers(),ce.prepareDrawTile();const wt=ce.isTileAffectedByFog(_t),at=[];Ze&&at.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const Dt=ce.getOrCreateProgram("elevatedStructures",{config:gn,overrideFog:wt,defines:at}),At=ce.translatePosMatrix(_t.projMatrix,ct,me.paint.get("fill-translate"),me.paint.get("fill-translate-anchor"));Ze&&Be.setupShadows(ct.tileID.toUnwrapped(),Dt,"vector-tile");const Gt=x_(At,Ue);ce.uploadCommonUniforms(ce.context,Dt,_t.toUnwrapped()),Dt.draw(ce,De.TRIANGLES,Ye,Pr.disabled,Ne,_r.backCCW,Gt,me.id,Ct.vertexBuffer,Ct.indexBuffer,Xt,me.paint,ce.transform.zoom,gn,[Ct.vertexBufferNormal])}};qe(!0),qe(!1)})(J)}}else hp(J,!1,y.stencilModeFor3D());else y.shadowRenderer&&G==="road"&&!ne&&(function(re){const{painter:de,sourceCache:ce,layer:pe,coords:me}=re,be=de.context.gl,Ne=re.painter.shadowRenderer;for(const De of me){const Be=ce.getTile(De),Ze=Be.getBucket(pe);if(!Ze)continue;const Ye=Ze.elevatedStructures;if(!Ye||!Ye.shadowCasterSegments||Ye.shadowCasterSegments.segments[0].primitiveLength===0)continue;de.prepareDrawTile();const Ue=Ze.bufferData.programConfigurations.get(pe.id),qe=de.isTileAffectedByFog(De),Ge=de.getOrCreateProgram("elevatedStructuresDepth",{config:Ue,overrideFog:qe}),_t=Ne.calculateShadowPassMatrixFromTile(Be.tileID.toUnwrapped());de.uploadCommonUniforms(de.context,Ge,De.toUnwrapped());const ct={u_matrix:_t,u_depth_bias:0};Ge.draw(de,be.TRIANGLES,Ne.getShadowPassDepthMode(),Pr.disabled,Ne.getShadowPassColorMode(),_r.disabled,ct,pe.id,Ye.vertexBuffer,Ye.indexBuffer,Ye.shadowCasterSegments,pe.paint,de.transform.zoom,Ue)}})(J)},"fill-extrusion":function(y,a,d,v){const S=d.paint.get("fill-extrusion-opacity"),A=y.context,P=A.gl,O=y.terrain,I=O&&O.renderingToTexture;if(S===0)return;const H=y.conflationActive&&y.style.isLayerClipped(d,a.getSource()),G=y.style.order.indexOf(d.fqid);if(H&&(function(ne,J,re,de,ce){for(const pe of de){const me=J.getTile(pe).getBucket(re);me&&(me.updateReplacement(pe,ne.replacementSource,ce),me.uploadCentroid(ne.context))}})(y,a,d,v,G),O||H)for(const ne of v){const J=a.getTile(ne).getBucket(d);J&&sr(y.context,a,ne,J,d,O,H)}if(y.renderPass==="shadow"&&y.shadowRenderer){const ne=y.shadowRenderer;if(O&&S<.65&&d._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof s.ab)return;const J=ne.getShadowPassDepthMode(),re=ne.getShadowPassColorMode();sf(y,a,d,v,J,Pr.disabled,re,H)}else if(y.renderPass==="translucent"){const ne=!d.paint.get("fill-extrusion-pattern").constantOr(1),J=d.paint.get("fill-extrusion-color").constantOr(s.am.white);if(!I&&J.a!==0){const re=new Fn(y.context.gl.LEQUAL,Fn.ReadWrite,y.depthRangeFor3D);S===1&&ne?sf(y,a,d,v,re,Pr.disabled,ei.unblended,H):(sf(y,a,d,v,re,Pr.disabled,ei.disabled,H),sf(y,a,d,v,re,y.stencilModeFor3D(),y.colorModeForRenderPass(),H),y.resetStencilClippingMasks())}if(y.style.enable3dLights()&&ne&&(!O&&y.transform.projection.name!=="globe"||I)){const re=d.paint.get("fill-extrusion-opacity"),de=d.paint.get("fill-extrusion-ambient-occlusion-intensity"),ce=d.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),pe=d.paint.get("fill-extrusion-flood-light-intensity"),me=d.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",be=d.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(me?null:d.lut).toArray01().slice(0,3),Ne=de>0&&ce>0,De=pe>0,Be=(Ue,qe,Ge)=>(1-Ge)*Ue+Ge*qe,Ze=new uu;Ze.translate=d.paint.get("fill-extrusion-translate"),Ze.translateAnchor=d.paint.get("fill-extrusion-translate-anchor"),Ze.edgeRadius=d.layout.get("fill-extrusion-edge-radius"),Ze.cutoffFadeRange=d.paint.get("fill-extrusion-cutoff-fade-range");const Ye=Ue=>{const qe=y.depthModeForSublayer(1,Fn.ReadOnly,P.LEQUAL,!0),Ge=d.paint.get(Ue?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),_t=Be(.1,3,Ge),ct=y._showOverdrawInspector;if(!ct){const Bt=new Pr({func:P.ALWAYS,mask:255},255,255,P.KEEP,P.KEEP,P.REPLACE),Ct=new ei([P.ONE,P.ONE,P.ONE,P.ONE],s.am.transparent,[!1,!1,!1,!0],P.MIN);Aa(Ze,y,a,d,v,qe,Bt,Ct,_r.disabled,Ue,"sdf",re,de,ce,pe,be,_t,H,!1)}{const Bt=ct?Pr.disabled:new Pr({func:P.EQUAL,mask:255},255,255,P.KEEP,P.DECR,P.DECR),Ct=ct?y.colorModeForRenderPass():new ei([P.ONE_MINUS_DST_ALPHA,P.DST_ALPHA,P.ONE,P.ONE],s.am.transparent,[!0,!0,!0,!0]);Aa(Ze,y,a,d,v,qe,Bt,Ct,_r.disabled,Ue,"color",re,de,ce,pe,be,_t,H,!1)}};if(I){const Ue=(qe,Ge,_t)=>{const ct=y.depthModeForSublayer(1,Fn.ReadOnly,P.LEQUAL,!1),Bt=d.paint.get(qe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Ct=Be(.1,3,Bt);{const Xt=new ei([P.ONE,P.ONE,P.ONE,P.ONE],s.am.transparent,[!1,!1,!1,!0]);Aa(Ze,y,a,d,v,ct,Pr.disabled,Xt,_r.disabled,qe,"clear",re,de,ce,pe,be,Ct,H,Ge)}{const Xt=new Pr({func:P.ALWAYS,mask:255},255,255,P.KEEP,P.KEEP,P.REPLACE),gn=new ei([P.ONE,P.ONE,P.ONE,P.ONE],s.am.transparent,[!1,!1,!1,!0],P.MIN);Aa(Ze,y,a,d,v,ct,Xt,gn,_r.disabled,qe,"sdf",re,de,ce,pe,be,Ct,H,Ge)}{const Xt=qe?P.ZERO:P.ONE_MINUS_DST_ALPHA,gn=new Pr({func:P.EQUAL,mask:255},255,255,P.KEEP,P.DECR,P.DECR),wt=new ei([Xt,P.DST_ALPHA,P.ONE_MINUS_DST_ALPHA,P.ZERO],s.am.transparent,[!0,!0,!0,!0]);Aa(Ze,y,a,d,v,ct,gn,wt,_r.disabled,qe,"color",re,de,ce,pe,be,Ct,H,Ge)}{const Xt=new ei([P.ONE,P.ONE,P.ONE,qe?P.ZERO:P.ONE],s.am.transparent,[!1,!1,!1,!0],qe?P.FUNC_ADD:P.MAX);Aa(Ze,y,a,d,v,ct,Pr.disabled,Xt,_r.disabled,qe,"clear",re,de,ce,pe,be,Ct,H,Ge,_t)}};if(Ne||De){let qe;if(y.prepareDrawTile(),O){const Ge=O.drapeBufferSize[0],_t=O.drapeBufferSize[1];qe=O.framebufferCopyTexture,qe&&(!qe||qe.size[0]===Ge&&qe.size[1]===_t)||(qe&&qe.destroy(),qe=O.framebufferCopyTexture=new s.T(A,new s.r({width:Ge,height:_t}),P.RGBA8)),qe.bind(P.LINEAR,P.CLAMP_TO_EDGE),P.copyTexSubImage2D(P.TEXTURE_2D,0,0,0,0,0,Ge,_t)}Ne&&Ue(!0,!1,qe),De&&Ue(!1,!0,qe)}}else Ne&&Ye(!0),De&&Ye(!1),(Ne||De)&&y.resetStencilClippingMasks()}}},building:function(y,a,d,v){y.currentLayer<y.firstLightBeamLayer&&(y.firstLightBeamLayer=y.currentLayer);const S=d.paint.get("building-ambient-occlusion-ground-intensity"),A=d.paint.get("building-ambient-occlusion-ground-radius"),P=d.paint.get("building-ambient-occlusion-ground-attenuation");let O=S>0&&A>0,I=!0;const H=d.paint.get("building-vertical-scale");H<1&&(I=!1);const G=y.conflationActive&&y.style.isLayerClipped(d,a.getSource()),ne=y.style.order.indexOf(d.fqid);if((function(J,re,de,ce,pe,me){for(const be of me){const Ne=re.getTile(be).getBucket(de);Ne&&(pe&&Ne.updateReplacement(be,J.replacementSource,ce),Ne.uploadUpdatedIndexBuffer(J.context))}})(y,a,d,ne,G,v),(function(J,re,de,ce){for(const pe of ce){const me=re.getTile(pe).getBucket(de);me&&me.needsEvaluation(J,de)&&(me.evaluate(de),me.uploadUpdatedColorBuffer(J.context))}})(y,a,d,v),d.resetLayerRenderingStats(y),y.shadowRenderer&&(y.shadowRenderer.useNormalOffset=!0),y.renderPass==="shadow"&&y.shadowRenderer){const J=y.shadowRenderer,re=[],de=J.getShadowPassDepthMode();$c({painter:y,source:a,layer:d,coords:v,defines:re,blendMode:J.getShadowPassColorMode(),depthMode:de,verticalScale:H})}else if(y.renderPass==="translucent"){O&&(function(ce,pe,me,be,Ne,De,Be,Ze,Ye,Ue,qe,Ge,_t){const ct=ce.context.gl,Bt=ce.depthModeForSublayer(1,Fn.ReadOnly,ct.LEQUAL,!0),Ct=.1*(1-(Xt=qe))+3*Xt;var Xt;const gn=ce._showOverdrawInspector,wt=Ge,at=new uu;gn||Aa(at,ce,pe,me,be,Bt,new Pr({func:ct.ALWAYS,mask:255},255,255,ct.KEEP,ct.KEEP,ct.REPLACE),new ei([ct.ONE,ct.ONE,ct.ONE,ct.ONE],s.am.transparent,[!1,!1,!1,!0],ct.MIN),_r.disabled,Ne,"sdf",1,Be,Ze,0,Ue,Ct,wt,!1);{const Dt=gn?Pr.disabled:new Pr({func:ct.EQUAL,mask:255},255,255,ct.KEEP,ct.DECR,ct.DECR),At=gn?ce.colorModeForRenderPass():new ei([ct.ONE_MINUS_DST_ALPHA,ct.DST_ALPHA,ct.ONE,ct.ONE],s.am.transparent,[!0,!0,!0,!0]);Aa(at,ce,pe,me,be,Bt,Dt,At,_r.disabled,Ne,"color",1,Be,Ze,0,Ue,Ct,wt,!1)}})(y,a,d,v,!0,0,S,A,0,[0,0,0],P,G);let J=["HAS_ATTRIBUTE_a_part_color_emissive","LIGHTING_3D_MODE"];I&&(J=J.concat("RENDER_SHADOWS","DEPTH_TEXTURE")),y.shadowRenderer.useNormalOffset&&(J=J.concat("NORMAL_OFFSET"));const re=new Fn(y.context.gl.LEQUAL,Fn.ReadWrite,y.depthRangeFor3D),de=y.colorModeForRenderPass();$c({painter:y,source:a,layer:d,coords:v,defines:J,blendMode:de,depthMode:re,verticalScale:H})}else if(y.renderPass==="light-beam"){const J=["HAS_ATTRIBUTE_a_part_color_emissive","HAS_ATTRIBUTE_a_bloom_attenuation"],re=new Fn(y.context.gl.LEQUAL,Fn.ReadOnly,y.depthRangeFor3D);$c({painter:y,source:a,layer:d,coords:v,defines:J,blendMode:ei.alphaBlended,depthMode:re,verticalScale:H})}y.shadowRenderer&&(y.shadowRenderer.useNormalOffset=!1),y.resetStencilClippingMasks()},hillshade:function(y,a,d,v){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent"||y.style.disableElevatedTerrain)return;const S=y.context,A=y.terrain&&y.terrain.renderingToTexture,[P,O]=y.renderPass!=="translucent"||A?[{},v]:y.stencilConfigForOverlap(v);for(const I of O){const H=a.getTile(I);if(H.needsHillshadePrepare&&y.renderPass==="offscreen")xm(y,H,d);else if(y.renderPass==="translucent"){const G=y.depthModeForSublayer(0,Fn.ReadOnly),ne=d.paint.get("hillshade-emissive-strength"),J=y.colorModeForDrapableLayerRenderPass(ne),re=A&&y.terrain?y.terrain.stencilModeForRTTOverlap(I):P[I.overscaledZ];fd(y,I,H,d,G,re,J)}}S.viewport.set([0,0,y.width,y.height]),y.resetStencilClippingMasks()},raster:function(y,a,d,v,S,A){if(y.renderPass!=="translucent"||d.paint.get("raster-opacity")===0)return;const P=y.transform.projection.name==="globe",O=d.paint.get("raster-elevation")!==0,I=O&&P;if(y.renderElevatedRasterBackface&&!I)return;const H=y.context,G=H.gl,ne=a.getSource(),J=(function(Ze,Ye,Ue,qe){const Ge=Ye.paint.get("raster-color"),_t=Ze.type==="raster-array",ct=[],Bt=Ye.paint.get("raster-resampling"),Ct=Ye.paint.get("raster-color-mix");let Xt=Ye.paint.get("raster-color-range");const gn=[Ct[0],Ct[1],Ct[2],0],wt=Ct[3];let at=Bt==="nearest"?qe.NEAREST:qe.LINEAR;if(_t&&(ct.push("RASTER_ARRAY"),Ge||ct.push("RASTER_COLOR"),Bt==="linear"&&ct.push("RASTER_ARRAY_LINEAR"),at=qe.NEAREST,!Xt&&Ze.rasterLayers)){const Dt=Ze.rasterLayers.find((({id:At})=>At===Ye.sourceLayer));Dt&&Dt.fields&&Dt.fields.range&&(Xt=Dt.fields.range)}if(Xt=Xt||[0,1],Ge){ct.push("RASTER_COLOR"),Ue.activeTexture.set(qe.TEXTURE2),Ye.updateColorRamp(Xt);let Dt=Ye.colorRampTexture;Dt||(Dt=Ye.colorRampTexture=new s.T(Ue,Ye.colorRamp,qe.RGBA8)),Dt.bind(qe.LINEAR,qe.CLAMP_TO_EDGE)}return{mix:gn,range:Xt,offset:wt,defines:ct,resampling:at}})(ne,d,H,G);if(ne instanceof s.aP&&!v.length&&!P)return;const re=d.paint.get("raster-emissive-strength"),de=y.colorModeForDrapableLayerRenderPass(re),ce=y.terrain&&y.terrain.renderingToTexture,pe=!y.options.moving,me=d.paint.get("raster-resampling")==="nearest"?G.NEAREST:G.LINEAR;if(ne instanceof s.aP&&!v.length&&(ne.onNorthPole||ne.onSouthPole)){const Ze=O?y.stencilModeFor3D():Pr.disabled;return void pp(!!ne.onNorthPole,null,y,a,d,re,J,_r.disabled,Ze)}if(!v.length)return;const[be,Ne]=ne instanceof s.aP||ce?[{},v]:y.stencilConfigForOverlap(v),De=Ne[Ne.length-1].overscaledZ;I&&J.defines.push("PROJECTION_GLOBE_VIEW"),O&&J.defines.push("RENDER_CUTOFF");const Be=(Ze,Ye,Ue)=>{for(const qe of Ze){const Ge=qe.toUnwrapped(),_t=a.getTile(qe);if(ce&&(!_t||!_t.hasData()))continue;H.activeTexture.set(G.TEXTURE0);const ct=__(_t,ne,d,J);if(!ct||!ct.texture)continue;const{texture:Bt,mix:Ct,offset:Xt,tileSize:gn,buffer:wt}=ct;let at,Dt;ce?(at=Fn.disabled,Dt=qe.projMatrix):O?(at=new Fn(G.LEQUAL,Fn.ReadWrite,y.depthRangeFor3D),Dt=P?Float32Array.from(y.transform.expandedFarZProjMatrix):y.transform.calculateProjMatrix(Ge,pe)):(at=y.depthModeForSublayer(qe.overscaledZ-De,d.paint.get("raster-opacity")===1?Fn.ReadWrite:Fn.ReadOnly,G.LESS),Dt=y.transform.calculateProjMatrix(Ge,pe));const At=y.terrain&&ce?y.terrain.stencilModeForRTTOverlap(qe):be[qe.overscaledZ],Gt=A?0:d.paint.get("raster-fade-duration");_t.registerFadeDuration(Gt);const Yt=a.findLoadedParent(qe,0),Ht=na(_t,Yt,a,y.transform,Gt);let en,Pn;y.terrain&&y.terrain.prepareDrawTile(),H.activeTexture.set(G.TEXTURE0),Bt.bind(me,G.CLAMP_TO_EDGE),H.activeTexture.set(G.TEXTURE1),Yt?(Yt.texture&&Yt.texture.bind(me,G.CLAMP_TO_EDGE),en=Math.pow(2,Yt.tileID.overscaledZ-_t.tileID.overscaledZ),Pn=[_t.tileID.canonical.x*en%1,_t.tileID.canonical.y*en%1]):Bt.bind(me,G.CLAMP_TO_EDGE),"useMipmap"in Bt&&H.extTextureFilterAnisotropic&&y.transform.pitch>20&&G.texParameterf(G.TEXTURE_2D,H.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,H.extTextureFilterAnisotropicMax);const Kn=y.transform;let In;const rr=O?zv(Kn):[0,0,0,0];let ar,Er,Tr,Zr,ji,Lr=0;if(I&&ne instanceof s.aP&&ne.coordinates.length>3)ar=Float32Array.from(s.bh(s.dD(new s.cA(0,0,0)))),Er=Float32Array.from(Kn.globeMatrix),Tr=Float32Array.from(s.dz(Kn)),Zr=[s.aD(Kn.center.lng),s.aH(Kn.center.lat)],In=ne.elevatedGlobePerspectiveTransform,ji=ne.elevatedGlobeGridMatrix||new Float32Array(9);else if(I){const Fr=s.dA(qe.canonical);Lr=s.dB(Fr.getCenter().lat),ar=Float32Array.from(s.bh(s.dD(qe.canonical))),Er=Float32Array.from(Kn.globeMatrix),Tr=Float32Array.from(s.dz(Kn)),Zr=[s.aD(Kn.center.lng),s.aH(Kn.center.lat)],In=[0,0],ji=Float32Array.from(s.dC(qe.canonical,Fr,Lr,Kn.worldSize/Kn._pixelsPerMercatorPixel))}else In=ne instanceof s.aP?ne.perspectiveTransform:[0,0],ar=new Float32Array(16),Er=new Float32Array(9),Tr=new Float32Array(16),Zr=[0,0],ji=new Float32Array(9);const mi=nf(Dt,ar,Er,Tr,ji,Pn||[0,0],s.ah(y.transform.zoom),Zr,rr,en||1,Ht,d,In,O?d.paint.get("raster-elevation"):0,2,Ct,Xt,J.range,gn,wt,re),Ii=y.isTileAffectedByFog(qe),os=y.getOrCreateProgram("raster",{defines:J.defines,overrideFog:Ii});if(y.uploadCommonUniforms(H,os,Ge),ne instanceof s.aP){const Fr=ne.elevatedGlobeVertexBuffer,Bi=ne.elevatedGlobeIndexBuffer;if(ce||!P)ne.boundsBuffer&&ne.boundsSegments&&os.draw(y,G.TRIANGLES,at,Pr.disabled,de,_r.disabled,mi,d.id,ne.boundsBuffer,y.quadTriangleIndexBuffer,ne.boundsSegments);else if(Fr&&Bi){const $i=Kn.zoom<=s.cX?ne.elevatedGlobeSegments:ne.getSegmentsForLongitude(Kn.center.lng);$i&&os.draw(y,G.TRIANGLES,at,Pr.disabled,de,Ye,mi,d.id,Fr,Bi,$i)}}else if(I){at=new Fn(G.LEQUAL,Fn.ReadOnly,y.depthRangeFor3D);const Fr=y.globeSharedBuffers;if(Fr){const[Bi,$i,Wi]=Fr.getGridBuffers(Lr,!1);os.draw(y,G.TRIANGLES,at,Ue||At,y.colorModeForRenderPass(),Ye,mi,d.id,Bi,$i,Wi)}}else{const{tileBoundsBuffer:Fr,tileBoundsIndexBuffer:Bi,tileBoundsSegments:$i}=y.getTileBoundsBuffers(_t);os.draw(y,G.TRIANGLES,at,At,de,_r.disabled,mi,d.id,Fr,Bi,$i)}}if(!(ne instanceof s.aP)&&I)for(const qe of Ze){const Ge=qe.canonical.y===(1<<qe.canonical.z)-1;qe.canonical.y===0&&pp(!0,qe,y,a,d,re,J,Ye,Ue||Pr.disabled),Ge&&pp(!1,qe,y,a,d,re,J,Ye===_r.frontCW?_r.backCW:_r.frontCW,Ue||Pr.disabled)}};I?Be(Ne,y.renderElevatedRasterBackface?_r.backCW:_r.frontCW,y.stencilModeFor3D()):Be(Ne,_r.disabled,void 0),y.resetStencilClippingMasks()},"raster-particle":function(y,a,d,v,S,A){y.renderPass==="offscreen"&&(function(P,O,I,H){if(!H.length)return;const G=P.context,ne=G.gl,J=O.getSource();if(!(J instanceof ts))return;const re=Math.ceil(Math.sqrt(I.paint.get("raster-particle-count")));let de=I.particlePositionRGBAImage;if(!de||de.width!==re){const Ne=(function(De){const Be=De*De,Ze=new Uint8Array(4*Be),Ye=function(qe){return qe|=0,qe=Math.imul(2747636419^qe,2654435769),qe=Math.imul(qe^qe>>>16,2654435769),((qe=Math.imul(qe^qe>>>16,2654435769))>>>0)/4294967296},Ue=1/1.1;for(let qe=0;qe<Be;qe++){const Ge=Ue*(Ye(2*qe+0)+qu),_t=Ue*(Ye(2*qe+1)+qu),ct=255*Ge%1,Bt=255*_t%1,Ct=ct,Xt=_t-Bt/255,gn=Bt;Ze[4*qe+0]=255*(Ge-ct/255),Ze[4*qe+1]=255*Ct,Ze[4*qe+2]=255*Xt,Ze[4*qe+3]=255*gn}return Ze})(re);de=I.particlePositionRGBAImage=new s.r({width:re,height:re},Ne)}let ce=I.particleFramebuffer;ce?ce.width!==re&&(ce.destroy(),ce=I.particleFramebuffer=G.createFramebuffer(re,re,!0,null)):ce=I.particleFramebuffer=G.createFramebuffer(re,re,!0,null);const pe=[];for(const Ne of H){const De=O.getTile(Ne);if(!(De instanceof nl))continue;const Be=sl(De,J,I);if(!Be)continue;const Ze=[De.tileSize,De.tileSize];let Ye=I.tileFramebuffer;Ye||(Ye=I.tileFramebuffer=G.createFramebuffer(Ze[0],Ze[1],!0,null));let Ue=De.rasterParticleState;Ue||(Ue=De.rasterParticleState=new sy(G,Ne,Ze,de));const qe=Ue.update(I.lastInvalidatedAt);Ue.particleTextureDimension!==re&&Ue.updateParticleTexture(Ne,de);const Ge=Ue.targetColorTexture;Ue.targetColorTexture=Ue.backgroundColorTexture,Ue.backgroundColorTexture=Ge;const _t=Ue.particleTexture0;Ue.particleTexture0=Ue.particleTexture1,Ue.particleTexture1=_t,pe.push([Ne,Be,Ue,qe])}if(pe.length===0)return;const me=s.q.now(),be=I.previousDrawTimestamp?.001*(me-I.previousDrawTimestamp):.0167;if(I.previousDrawTimestamp=me,I.hasColorMap()){G.activeTexture.set(ne.TEXTURE0+2);let Ne=I.colorRampTexture;Ne||(Ne=I.colorRampTexture=new s.T(G,I.colorRamp,ne.RGBA8)),Ne.bind(ne.LINEAR,ne.CLAMP_TO_EDGE)}G.bindFramebuffer.set(I.tileFramebuffer.framebuffer),(function(Ne,De,Be){const Ze=Ne.context,Ye=Ze.gl,Ue=De.tileFramebuffer;Ze.activeTexture.set(Ye.TEXTURE0);const qe={u_texture:0,u_opacity:1.05*(_t=De.paint.get("raster-particle-fade-opacity-factor"))/(_t+.05)},Ge=Ne.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var _t;for(const ct of Be){const[,,Bt,Ct]=ct;Ue.colorAttachment.set(Bt.targetColorTexture.texture),Ze.viewport.set([0,0,Ue.width,Ue.height]),Ze.clear({color:s.am.transparent}),Ct&&(Bt.backgroundColorTexture.bind(Ye.NEAREST,Ye.CLAMP_TO_EDGE),Ge.draw(Ne,Ye.TRIANGLES,Fn.disabled,Pr.disabled,ei.alphaBlended,_r.disabled,qe,De.id,Ne.viewportBuffer,Ne.quadTriangleIndexBuffer,Ne.viewportSegments))}})(P,I,pe),(function(Ne,De,Be,Ze){const Ye=Ne.context,Ue=Ye.gl,qe=Be.tileFramebuffer,Ge=Ne.transform.projection.name==="globe",_t=Be.paint.get("raster-particle-max-speed");for(const ct of Ze){const[Bt,Ct,Xt]=ct;Ye.activeTexture.set(Ue.TEXTURE0+0),Ct.texture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE),qe.colorAttachment.set(Xt.targetColorTexture.texture);const gn=Ne.getOrCreateProgram("rasterParticleDraw",{defines:Ct.defines,overrideFog:!1});Ye.activeTexture.set(Ue.TEXTURE0+1);const wt=Ct.scalarData?[]:[0,1,2,3].map((At=>s.e3[At](Bt)));wt.push(Bt);const at=Bt.canonical.x,Dt=Bt.canonical.y;for(const At of wt){const Gt=De.getTile(Ge?At.wrapped():At);if(!Gt)continue;const Yt=Gt.rasterParticleState;if(!Yt)continue;const Ht=At.canonical.x+(1<<At.canonical.z)*(At.wrap-Bt.wrap),en=At.canonical.y;Yt.particleTexture0.bind(Ue.NEAREST,Ue.CLAMP_TO_EDGE);const Pn=cp(1,Yt.particleTexture0.size[0],[Ht-at,en-Dt],0,Ct.texture.size,2,_t,Ct.textureOffset,Ct.scale,Ct.offset);gn.draw(Ne,Ue.POINTS,Fn.disabled,Pr.disabled,ei.alphaBlended,_r.disabled,Pn,Be.id,Yt.particleIndexBuffer,void 0,Yt.particleSegment)}}})(P,O,I,pe),G.bindFramebuffer.set(I.particleFramebuffer.framebuffer),(function(Ne,De,Be,Ze){const Ye=Ne.context,Ue=Ye.gl,qe=De.paint.get("raster-particle-max-speed"),Ge=Ze*De.paint.get("raster-particle-speed-factor")*.15,_t=(function(Bt){return Math.pow(Bt,6)})(.01+1*De.paint.get("raster-particle-reset-rate-factor")),ct=De.particleFramebuffer;Ye.viewport.set([0,0,ct.width,ct.height]);for(const Bt of Be){const[,Ct,Xt]=Bt;Ye.activeTexture.set(Ue.TEXTURE0+0),Ct.texture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE),Ye.activeTexture.set(Ue.TEXTURE0+1);const gn=Xt.particleTexture0;gn.bind(Ue.NEAREST,Ue.CLAMP_TO_EDGE);const wt=Lv(1,gn.size[0],0,Ct.texture.size,qe,Ge,_t,Ct.textureOffset,Ct.scale,Ct.offset);ct.colorAttachment.set(Xt.particleTexture1.texture),Ye.clear({color:s.am.transparent}),Ne.getOrCreateProgram("rasterParticleUpdate",{defines:Ct.defines}).draw(Ne,Ue.TRIANGLES,Fn.disabled,Pr.disabled,ei.unblended,_r.disabled,wt,De.id,Ne.viewportBuffer,Ne.quadTriangleIndexBuffer,Ne.viewportSegments)}})(P,I,pe,be)})(y,a,d,v),y.renderPass==="translucent"&&((function(P,O,I,H,G){const ne=P.context,J=ne.gl,re=O.getSource().tileSize,de=5*(1-s.af(s.cI,s.cI+1,P.transform.zoom))*re+I.paint.get("raster-particle-elevation"),ce=!P.options.moving,pe=P.transform.projection.name==="globe";if(!H.length)return;const[me,be]=P.stencilConfigForOverlap(H),Ne=[];pe&&Ne.push("PROJECTION_GLOBE_VIEW");const De=P.stencilModeFor3D();for(const Be of be){const Ze=Be.toUnwrapped(),Ye=O.getTile(Be);if(!Ye.rasterParticleState)continue;const Ue=Ye.rasterParticleState,qe=100;Ye.registerFadeDuration(qe);const Ge=O.findLoadedParent(Be,0),_t=na(Ye,Ge,O,P.transform,qe);let ct,Bt;P.terrain&&P.terrain.prepareDrawTile(),ne.activeTexture.set(J.TEXTURE0),Ue.targetColorTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),ne.activeTexture.set(J.TEXTURE1),Ge&&Ge.rasterParticleState?(Ge.rasterParticleState.targetColorTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),ct=Math.pow(2,Ge.tileID.overscaledZ-Ye.tileID.overscaledZ),Bt=[Ye.tileID.canonical.x*ct%1,Ye.tileID.canonical.y*ct%1]):Ue.targetColorTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE);const Ct=pe?Float32Array.from(P.transform.expandedFarZProjMatrix):P.transform.calculateProjMatrix(Ze,ce),Xt=P.transform,gn=Td(Xt),wt=s.dA(Be.canonical),at=s.dB(wt.getCenter().lat);let Dt,At,Gt,Yt,Ht;pe?(Dt=Float32Array.from(s.bh(s.dD(Be.canonical))),At=Float32Array.from(Xt.globeMatrix),Gt=Float32Array.from(s.dz(Xt)),Yt=[s.aD(Xt.center.lng),s.aH(Xt.center.lat)],Ht=Float32Array.from(s.dC(Be.canonical,wt,at,Xt.worldSize/Xt._pixelsPerMercatorPixel))):(Dt=new Float32Array(16),At=new Float32Array(9),Gt=new Float32Array(16),Yt=[0,0],Ht=new Float32Array(9));const en=vh(Ct,Dt,At,Gt,Ht,Bt||[0,0],s.ah(P.transform.zoom),Yt,gn,ct||1,_t,de),Pn=P.isTileAffectedByFog(Be),Kn=P.getOrCreateProgram("rasterParticle",{defines:Ne,overrideFog:Pn});if(P.uploadCommonUniforms(ne,Kn,Ze),pe){const In=new Fn(J.LEQUAL,Fn.ReadOnly,P.depthRangeFor3D),rr=0,ar=P.globeSharedBuffers;if(ar){const[Er,Tr,Zr]=ar.getGridBuffers(at,rr!==0);Kn.draw(P,J.TRIANGLES,In,De,ei.alphaBlended,P.renderElevatedRasterBackface?_r.frontCCW:_r.backCCW,en,I.id,Er,Tr,Zr)}}else{const In=P.depthModeForSublayer(0,Fn.ReadOnly),rr=me[Be.overscaledZ],{tileBoundsBuffer:ar,tileBoundsIndexBuffer:Er,tileBoundsSegments:Tr}=P.getTileBoundsBuffers(Ye);Kn.draw(P,J.TRIANGLES,In,rr,ei.alphaBlended,_r.disabled,en,I.id,ar,Er,Tr)}}P.resetStencilClippingMasks()})(y,a,d,v),y.style.map.triggerRepaint())},background:function(y,a,d,v){const S=d.paint.get("background-color"),A=d.paint.get("background-color-use-theme").constantOr("default")==="none",P=d.paint.get("background-opacity"),O=d.paint.get("background-emissive-strength"),I=d.paint.get("background-pitch-alignment")==="viewport";if(P===0)return;const H=y.context,G=H.gl,ne=y.transform,J=ne.tileSize,re=d.paint.get("background-pattern");let de;if(re!==void 0&&(re===null||(de=y.imageManager.getPattern(s.I.from(re.toString()),d.scope,y.style.getLut(d.scope)),!de)))return;const ce=!re&&S.a===1&&P===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==ce)return;const pe=Pr.disabled,me=y.depthModeForSublayer(0,ce==="opaque"?Fn.ReadWrite:Fn.ReadOnly),be=y.colorModeForDrapableLayerRenderPass(O),Ne=re?"backgroundPattern":"background";let De,Be=v;if(Be||(De=y.getBackgroundTiles(),Be=Object.values(De).map((Ze=>Ze.tileID))),re&&(H.activeTexture.set(G.TEXTURE0),y.imageManager.bind(y.context,d.scope)),I){const Ze=y.getOrCreateProgram(Ne,{overrideFog:!1,overrideRtt:!0}),Ye=new Float32Array(s.bx([])),Ue=new s.aM(0,0,0,0,0),qe=re?ny(Ye,O,P,y,0,d.scope,de,I,{tileID:Ue,tileSize:J}):Nm(Ye,O,P,S.toPremultipliedRenderColor(A?null:d.lut));Ze.draw(y,G.TRIANGLES,me,pe,be,_r.disabled,qe,d.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments)}else for(const Ze of Be){const Ye=y.isTileAffectedByFog(Ze),Ue=y.getOrCreateProgram(Ne,{overrideFog:Ye}),qe=Ze.toUnwrapped(),Ge=v?Ze.projMatrix:y.transform.calculateProjMatrix(qe);y.prepareDrawTile();const _t=a?a.getTile(Ze):De?De[Ze.key]:new Va(Ze,J,ne.zoom,y),ct=re?ny(Ge,O,P,y,0,d.scope,de,I,{tileID:Ze,tileSize:J}):Nm(Ge,O,P,S.toPremultipliedRenderColor(A?null:d.lut));y.uploadCommonUniforms(H,Ue,qe);const{tileBoundsBuffer:Bt,tileBoundsIndexBuffer:Ct,tileBoundsSegments:Xt}=y.getTileBoundsBuffers(_t);Ue.draw(y,G.TRIANGLES,me,pe,be,_r.disabled,ct,d.id,Bt,Ct,Xt)}},sky:function(y,a,d){const v=y._atmosphere?s.ah(y.transform.zoom):1,S=d.paint.get("sky-opacity")*v;if(S===0)return;const A=y.context,P=d.paint.get("sky-type"),O=new Fn(A.gl.LEQUAL,Fn.ReadOnly,[0,1]),I=y.frameCounter/1e3%1;P==="atmosphere"?y.renderPass==="offscreen"?d.needsSkyboxCapture(y)&&((function(H,G,ne,J){const re=H.context,de=re.gl;let ce=G.skyboxFbo;if(!ce){ce=G.skyboxFbo=re.createFramebuffer(32,32,!0,null),G.skyboxGeometry=new of(re),G.skyboxTexture=re.gl.createTexture(),de.bindTexture(de.TEXTURE_CUBE_MAP,G.skyboxTexture),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_S,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_T,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MIN_FILTER,de.LINEAR),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MAG_FILTER,de.LINEAR);for(let Ne=0;Ne<6;++Ne)de.texImage2D(de.TEXTURE_CUBE_MAP_POSITIVE_X+Ne,0,de.RGBA,32,32,0,de.RGBA,de.UNSIGNED_BYTE,null)}re.bindFramebuffer.set(ce.framebuffer),re.viewport.set([0,0,32,32]);const pe=G.getCenter(H,!0),me=H.getOrCreateProgram("skyboxCapture"),be=new Float64Array(16);s.bx(be),s.eh(be,be,.5*-Math.PI),qc(H,G,me,be,pe,0),s.bx(be),s.eh(be,be,.5*Math.PI),qc(H,G,me,be,pe,1),s.bx(be),s.cR(be,be,.5*-Math.PI),qc(H,G,me,be,pe,2),s.bx(be),s.cR(be,be,.5*Math.PI),qc(H,G,me,be,pe,3),s.bx(be),qc(H,G,me,be,pe,4),s.bx(be),s.eh(be,be,Math.PI),qc(H,G,me,be,pe,5),re.viewport.set([0,0,H.width,H.height])})(y,d),d.markSkyboxValid(y)):y.renderPass==="sky"&&(function(H,G,ne,J,re){const de=H.context,ce=de.gl,pe=H.transform,me=H.getOrCreateProgram("skybox");de.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_CUBE_MAP,G.skyboxTexture);const be=((Ne,De,Be,Ze,Ye)=>({u_matrix:Ne,u_sun_direction:De,u_cubemap:0,u_opacity:Ze,u_temporal_offset:Ye}))(pe.skyboxMatrix,G.getCenter(H,!1),0,J,re);H.uploadCommonUniforms(de,me),me.draw(H,ce.TRIANGLES,ne,Pr.disabled,H.colorModeForRenderPass(),_r.backCW,be,"skybox",G.skyboxGeometry.vertexBuffer,G.skyboxGeometry.indexBuffer,G.skyboxGeometry.segment)})(y,d,O,S,I):P==="gradient"&&y.renderPass==="sky"&&(function(H,G,ne,J,re){const de=H.context,ce=de.gl,pe=H.transform,me=H.getOrCreateProgram("skyboxGradient");G.skyboxGeometry||(G.skyboxGeometry=new of(de)),de.activeTexture.set(ce.TEXTURE0);let be=G.colorRampTexture;be||(be=G.colorRampTexture=new s.T(de,G.colorRamp,ce.RGBA8)),be.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);const Ne=((De,Be,Ze,Ye,Ue)=>({u_matrix:De,u_color_ramp:0,u_center_direction:Be,u_radius:s.al(Ze),u_opacity:Ye,u_temporal_offset:Ue}))(pe.skyboxMatrix,G.getCenter(H,!1),G.paint.get("sky-gradient-radius"),J,re);H.uploadCommonUniforms(de,me),me.draw(H,ce.TRIANGLES,ne,Pr.disabled,H.colorModeForRenderPass(),_r.backCW,Ne,"skyboxGradient",G.skyboxGeometry.vertexBuffer,G.skyboxGeometry.indexBuffer,G.skyboxGeometry.segment)})(y,d,O,S,I)},custom:function(y,a,d,v){const S=y.context,A=d.implementation;if(!y.transform.projection.unsupportedLayers||!y.transform.projection.unsupportedLayers.includes("custom")||y.terrain&&(y.terrain.renderingToTexture||y.renderPass==="offscreen")&&d.isDraped(a)){if(y.renderPass==="offscreen"){const P=A.prerender;if(P){if(y.setCustomLayerDefaults(),S.setColorMode(y.colorModeForRenderPass()),y.transform.projection.name==="globe"){const O=y.transform.pointMerc;P.call(A,S.gl,y.transform.customLayerMatrix(),y.transform.getProjection(),y.transform.globeToMercatorMatrix(),s.ah(y.transform.zoom),[O.x,O.y],y.transform.pixelsPerMeterRatio)}else P.call(A,S.gl,y.transform.customLayerMatrix());S.setDirty(),y.setBaseState()}}else if(y.renderPass==="translucent"){if(y.terrain&&y.terrain.renderingToTexture){const O=A.renderToTile;if(O){const I=v[0].canonical,H={x:I.x+v[0].wrap*(A.wrapTileId?0:1<<I.z),y:I.y,z:I.z};S.setDepthMode(Fn.disabled),S.setStencilMode(Pr.disabled),S.setColorMode(y.colorModeForRenderPass()),y.setCustomLayerDefaults(),O.call(A,S.gl,H),S.setDirty(),y.setBaseState()}return}y.setCustomLayerDefaults(),S.setColorMode(y.colorModeForRenderPass()),S.setStencilMode(Pr.disabled);const P=A.renderingMode==="3d"?new Fn(y.context.gl.LEQUAL,Fn.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,Fn.ReadOnly);if(S.setDepthMode(P),y.transform.projection.name==="globe"){const O=y.transform.pointMerc;A.render(S.gl,y.transform.customLayerMatrix(),y.transform.getProjection(),y.transform.globeToMercatorMatrix(),s.ah(y.transform.zoom),[O.x,O.y],y.transform.pixelsPerMeterRatio)}else A.render(S.gl,y.transform.customLayerMatrix());S.setDirty(),y.setBaseState(),S.bindFramebuffer.set(null)}}else s.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(y,a,d,v){if(y.renderPass==="opaque")return;const S=d.paint.get("model-opacity").constantOr(1);if(S===0)return;const A=d.paint.get("model-cast-shadows");if(y.renderPass==="shadow"&&(!A||y.terrain&&S<.65&&d._transitionablePaint._values["model-opacity"].value.expression instanceof s.ab))return;const P=y.shadowRenderer,O=d.paint.get("model-receive-shadows");P&&(P.useNormalOffset=!0,O||(P.enabled=!1));const I=()=>{P&&(P.useNormalOffset=!0,O||(P.enabled=!0))},H=a.getSource();if(y.renderPass==="light-beam"&&H.type!=="batched-model")return;if(H.type==="vector"||H.type==="geojson")return(function(me,be,Ne,De,Be){const Ze=me.transform;if(Ze.projection.name!=="mercator")return void s.w(`Drawing 3D models for ${Ze.projection.name} projection is not yet implemented`);const Ye=Ze.getFreeCameraOptions().position;if(!me.modelManager)return;const Ue=me.modelManager;Ne.modelManager=Ue;const qe=me.shadowRenderer;if(!Ne._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Ge=Ne._unevaluatedLayout._values["model-id"],_t=Object.assign({},Ne.layout.get("model-id").parameters),ct=me.style.order.indexOf(Ne.fqid);for(const Bt of De){const Ct=be.getTile(Bt).getBucket(Ne);if(!Ct||Ct.projection.name!==Ze.projection.name)continue;const Xt=Ct.getModelUris();Xt&&!Ct.modelsRequested&&(Ue.addModelsFromBucket(Xt,Be),Ct.modelsRequested=!0);const gn=b_(Bt,Ze);_t.zoom=gn;const wt=Ge.possiblyEvaluate(_t);if(xh(me,Ct,Bt),hu.shadowUniformsInitialized=!1,hu.useSingleShadowCascade=!!qe&&qe.getMaxCascadeForTile(Bt.toUnwrapped())===0,me.renderPass==="shadow"&&qe){if(me.currentShadowCascade===1&&Ct.isInsideFirstShadowMapFrustum)continue;const At=Ze.calculatePosMatrix(Bt.toUnwrapped(),Ze.worldSize);if(hu.tileMatrix.set(At),hu.shadowTileMatrix=Float32Array.from(qe.calculateShadowPassMatrixFromMatrix(At)),hu.aabb.min.fill(0),hu.aabb.max[0]=hu.aabb.max[1]=s.aj,hu.aabb.max[2]=0,ly(Ct,hu,me,Ne.scope))continue}const at=1<<Bt.canonical.z,Dt=[((Ye.x-Bt.wrap)*at-Bt.canonical.x)*s.aj,(Ye.y*at-Bt.canonical.y)*s.aj,Ye.z*at*s.aj];me.conflationActive&&Object.keys(Ct.instancesPerModel).length>0&&me.style.isLayerClipped(Ne,be.getSource())&&Ct.updateReplacement(Bt,me.replacementSource,ct,Be)&&(Ct.uploaded=!1,Ct.upload(me.context));for(let At in Ct.instancesPerModel){const Gt=Ct.instancesPerModel[At];Gt.features.length>0&&(At=wt.evaluate(Gt.features[0].feature,{}));const Yt=Ue.getModel(At,Be);if(Yt||Ue.hasURLBeenRequested(At)||Ct.modelUris.includes(At)||(Ct.modelUris.push(At),Ct.modelsRequested=!1),Yt&&Yt.uploaded)for(const Ht of Yt.nodes)Fm(me,Ne,Ht,Gt,Dt,Bt,hu)}}})(y,a,d,v,H.type==="vector"?d.scope:""),void I();if(!H.loaded())return;if(H.type==="batched-model")return(function(me,be,Ne,De){Ne.resetLayerRenderingStats(me);const Be=me.context,Ze=me.transform,Ye=me.style.fog,Ue=me.shadowRenderer;if(Ze.projection.name!=="mercator")return void s.w(`Drawing 3D landmark models for ${Ze.projection.name} projection is not yet implemented`);const qe=me.transform.getFreeCameraOptions().position,Ge=s.c1([],[qe.x,qe.y,qe.z],me.transform.worldSize),_t=s.eq([],Ge),ct=s.bx([]),Bt=s.e9(Ze.center.lat,Ze.zoom),Ct=s.bn([],[1,1,1/Bt]);s.bo(ct,ct,_t);const Xt=Ne.paint.get("model-opacity").constantOr(1),gn=new Fn(Be.gl.LEQUAL,Fn.ReadWrite,me.depthRangeFor3D),wt=new Fn(Be.gl.LEQUAL,Fn.ReadOnly,me.depthRangeFor3D),at=new s.d6([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Dt=me.renderPass==="shadow",At=Dt&&Ue?Ue.getCurrentCascadeFrustum():Ze.getFrustum(Ze.scaleZoom(Ze.worldSize)),Gt=Ne.paint.get("model-front-cutoff"),Yt=Gt[2]<1,Ht=Du(me,Ne.paint.get("model-cutoff-fade-range")),en=Ne.getLayerRenderingStats();(function(Pn,Kn,In,rr){const ar=Pn.terrain?Pn.terrain.exaggeration():0,Er=Pn.transform.zoom;for(const Tr of rr){const Zr=Kn.getTile(Tr).getBucket(In);Zr&&(Zr.setFilter(In.filter),Pn.conflationActive&&Zr.updateReplacement(Tr,Pn.replacementSource),Zr.evaluateTransform(Pn,In),Pn.terrain&&ar>0&&Zr.elevationUpdate(Pn.terrain,ar,Tr,In.source),Zr.needsReEvaluation(Pn,Er,In)&&Zr.evaluate(In))}})(me,be,Ne,De),(function(){let Pn,Kn,In;Yt?(Pn=De.length-1,Kn=-1,In=-1):(Pn=0,Kn=De.length,In=1);const rr=new Float64Array(16),ar=s.cx(),Er=new s.P(0,0);for(let Tr=Pn;Tr!==Kn;Tr+=In){const Zr=De[Tr],ji=be.getTile(Zr).getBucket(Ne);if(!ji||!ji.uploaded)continue;let Lr=!1;Ue&&(Lr=Ue.getMaxCascadeForTile(Zr.toUnwrapped())===0);const mi=Ze.calculatePosMatrix(Zr.toUnwrapped(),Ze.worldSize),Ii=ji.modelTraits;!Dt&&Yt&&(s.bi(rr,mi),s.ad(ar,Ge,rr),Er.x=ar[0],Er.y=ar[1]);const os=[];ji.setFilter(Ne.filter);for(const Fr of ji.getNodesInfo()){if(Fr.hiddenByReplacement||!Fr.node.meshes)continue;const Bi=Fr.node;let $i=0;me.terrain&&Bi.elevation&&($i=Bi.elevation*me.terrain.exaggeration());const Wi=(()=>{const go=Fr.aabb;return at.min=[...go.min],at.max=[...go.max],at.min[2]+=$i,at.max[2]+=$i,s.ad(at.min,at.min,mi),s.ad(at.max,at.max,mi),at})(),ii=Fr.evaluatedScale;if(ii[0]<=1&&ii[1]<=1&&ii[2]<=1&&Wi.intersects(At)===0)continue;if(!Dt&&Yt){const go=.16666666666666666;Fr.cameraCollisionOpacity=Ge[0]>Wi.min[0]&&Ge[0]<Wi.max[0]&&Ge[1]>Wi.min[1]&&Ge[1]<Wi.max[1]&&Ge[2]*Bt<Wi.max[2]&&Bi.footprint&&s.bY(Er,Bi.footprint)?Math.max(Fr.cameraCollisionOpacity-go,0):Math.min(1,Fr.cameraCollisionOpacity+go)}const Xi=[...mi],oi=1/s.d4(Zr.canonical),js=Bi.anchor?Bi.anchor[0]:0,Ei=Bi.anchor?Bi.anchor[1]:0;s.bo(Xi,Xi,[js*(ii[0]-1)+Fr.evaluatedTranslation[0]*oi,Ei*(ii[1]-1)+Fr.evaluatedTranslation[1]*oi,$i+Fr.evaluatedTranslation[2]]),s.cn(ii,s.es)||s.cP(Xi,Xi,ii);const Ui=s.az([],Xi,Bi.matrix),fs=s.az([],Ze.expandedFarZProjMatrix,Ui),_a=s.az([],Ze.expandedFarZProjMatrix,Xi),ba=s.aA([],[js,Ei,$i,1],fs)[2];Bi.hidden=!1;let pa=Xt;Dt||(Yt&&(pa*=Fr.cameraCollisionOpacity,pa*=cy(Xi,Ze,Fr.aabb,Gt)),pa*=w_(Ht,ba)),pa!==0?os.push({nodeInfo:Fr,depth:ba,opacity:pa,wvpForNode:fs,wvpForTile:_a,nodeModelMatrix:Ui,tileModelMatrix:Xi}):Bi.hidden=!0}Dt||os.sort(((Fr,Bi)=>!Yt||Fr.opacity===1&&Bi.opacity===1?Fr.depth<Bi.depth?-1:1:Fr.opacity===1?-1:Bi.opacity===1?1:Fr.depth>Bi.depth?-1:1));for(const Fr of os){const Bi=Fr.nodeInfo,$i=Bi.node;let Wi=s.az([],Ct,Fr.tileModelMatrix);s.az(Wi,ct,Wi);const ii=s.bi([],Wi);s.ea(ii,ii),s.cP(ii,ii,Bm),Wi=s.az(Wi,Wi,$i.matrix);const Xi=me.renderPass==="light-beam",oi=Ne.paint.get("model-color-use-theme").constantOr("default")==="none",js=Ii&s.ex.HasMapboxMeshFeatures,Ei=js?0:Bi.evaluatedRMEA[0][2];for(let Ui=0;Ui<$i.meshes.length;++Ui){const fs=$i.meshes[Ui],_a=Ui===$i.lightMeshIndex;let ba=Fr.wvpForNode;if(_a){if(!Xi&&!me.terrain&&me.shadowRenderer){me.currentLayer<me.firstLightBeamLayer&&(me.firstLightBeamLayer=me.currentLayer);continue}ba=Fr.wvpForTile}else if(Xi)continue;const pa={defines:[]},go=[];if(!Dt&&Ue&&(Ue.useNormalOffset=!!fs.normalBuffer),yp(pa.defines,go,fs,me,oi?null:Ne.lut),js||pa.defines.push("DIFFUSE_SHADED"),Lr&&pa.defines.push("SHADOWS_SINGLE_CASCADE"),en&&(Dt?en.numRenderedVerticesInShadowPass+=fs.vertexArray.length:en.numRenderedVerticesInTransparentPass+=fs.vertexArray.length),Dt){zm(fs,Fr.nodeModelMatrix,me,Ne);continue}let so=null;if(Ye){const Ha=gp(Fr.nodeModelMatrix,me.transform);if(so=new Float32Array(Ha),Ze.projection.name!=="globe"){const la=fs.aabb.min,ia=fs.aabb.max,[ls,Ga]=Ye.getOpacityForBounds(Ha,la[0],la[1],ia[0],ia[1]);pa.overrideFog=ls>=Kt||Ga>=Kt}}const ll=fs.material;let za;ll.occlusionTexture&&ll.occlusionTexture.offsetScale&&(za=ll.occlusionTexture.offsetScale,pa.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const qo=me.getOrCreateProgram("model",pa);!Dt&&Ue&&Ue.setupShadowsFromMatrix(Fr.tileModelMatrix,qo,Ue.useNormalOffset),me.uploadCommonUniforms(Be,qo,null,so);const sc=ll.pbrMetallicRoughness;sc.metallicFactor=.9,sc.roughnessFactor=.5;const Wc=Pm(new Float32Array(ba),new Float32Array(Wi),new Float32Array(ii),new Float32Array($i.matrix),me,Fr.opacity,sc.baseColorFactor,ll.emissiveFactor,sc.metallicFactor,sc.roughnessFactor,ll,Ei,Ne,[0,0,0],za);!_a&&(Bi.hasTranslucentParts||Fr.opacity<1)&&qo.draw(me,Be.gl.TRIANGLES,gn,Pr.disabled,ei.disabled,_r.backCCW,Wc,Ne.id,fs.vertexBuffer,fs.indexBuffer,fs.segments,Ne.paint,me.transform.zoom,void 0,go),qo.draw(me,Be.gl.TRIANGLES,_a?wt:gn,Pr.disabled,_a||Fr.opacity<1||Bi.hasTranslucentParts?ei.alphaBlended:ei.unblended,_r.backCCW,Wc,Ne.id,fs.vertexBuffer,fs.indexBuffer,fs.segments,Ne.paint,me.transform.zoom,void 0,go)}}}})()})(y,a,d,v),void I();if(H.type!=="model")return;const G=H.getModels(),ne=[],J=y.transform.getFreeCameraOptions().position,re=s.c1([],[J.x,J.y,J.z],y.transform.worldSize);s.eq(re,re);const de=[],ce=[];let pe=0;for(const me of G){const be=d.paint.get("model-rotation").constantOr(null),Ne=d.paint.get("model-scale").constantOr(null),De=d.paint.get("model-translation").constantOr(null);me.computeModelMatrix(y,be,Ne,De,!0,!0,!1);const Be=s.bx([]),Ze=s.e9(me.position.lat,y.transform.zoom),Ye=s.bn([],[1,1,1/Ze]);s.bo(Be,Be,re),ne.push({zScaleMatrix:Ye,negCameraPosMatrix:Be});for(const Ue of me.nodes)oy(y.transform,Ue,me.matrix,y.transform.expandedFarZProjMatrix,pe,de,ce);pe++}if(de.sort(((me,be)=>be.depth-me.depth)),y.renderPass!=="shadow"){if(S===1)for(const me of ce)cf(me,y,d,ne[me.modelIndex],Pr.disabled,y.colorModeForRenderPass());else{for(const me of ce)cf(me,y,d,ne[me.modelIndex],Pr.disabled,ei.disabled);for(const me of ce)cf(me,y,d,ne[me.modelIndex],y.stencilModeFor3D(),y.colorModeForRenderPass());y.resetStencilClippingMasks()}for(const me of de)cf(me,y,d,ne[me.modelIndex],Pr.disabled,y.colorModeForRenderPass());I()}else{for(const me of ce)zm(me.mesh,me.nodeModelMatrix,y,d);for(const me of de)zm(me.mesh,me.nodeModelMatrix,y,d);I()}}},Ed={line:function(y,a,d){if(y.hasElevatedBuckets=!1,y.hasNonElevatedBuckets=!1,y._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||y._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(a){const v=a.getVisibleCoordinates();for(const S of v){const A=a.getTile(S).getBucket(y);if(A&&(A.elevationType!=="none"?y.hasElevatedBuckets=!0:y.hasNonElevatedBuckets=!0,y.hasElevatedBuckets&&y.hasNonElevatedBuckets))break}}}else y.hasNonElevatedBuckets=!0},model:function(y,a,d){const v=a.getSource();if(!v.loaded())return;if(v.type==="vector"||v.type==="geojson")return void(d.modelManager&&d.modelManager.upload(d,v.type==="vector"?y.scope:""));if(v.type==="batched-model"||v.type!=="model")return;const S=v.getModels();for(const A of S)A.upload(d.context)},raster:function(y,a,d){const v=a.getSource();if(!(v instanceof ts&&v.loaded()))return;const S=y.sourceLayer||v.rasterLayerIds&&v.rasterLayerIds[0];if(!S)return;const A=y.paint.get("raster-array-band")||v.getInitialBand(S);if(A==null)return;const P=a.getIds().map((O=>a.getTileByID(O)));for(const O of P)O.updateNeeded(y.id,A)&&v.prepareTile(O,S,y.id,A)},"raster-particle":function(y,a,d){const v=a.getSource();if(!(v instanceof ts&&v.loaded()))return;const S=y.sourceLayer||v.rasterLayerIds&&v.rasterLayerIds[0];if(!S)return;const A=y.paint.get("raster-particle-array-band")||v.getInitialBand(S);if(A==null)return;const P=a.getIds().map((O=>a.getTileByID(O)));for(const O of P)O.updateNeeded(y.id,A)&&v.prepareTile(O,S,y.id,A)}},wh={fill:Hn},wl={fill:function(y,a,d,v){if(!d.layout||d.layout.get("fill-elevation-reference")==="none")return;const S=y.context.gl,A=new Fn(S.LEQUAL,Fn.ReadOnly,y.depthRangeFor3D),P=new Pr({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),O=y.transform.getFreeCameraOptions().position,I=y.getOrCreateProgram("elevatedStructuresDepthReconstruct");for(const H of v){const G=a.getTile(H),ne=G.getBucket(d);if(!ne)continue;const J=ne.elevatedStructures;if(!J||J.depthSegments.segments[0].primitiveLength===0)continue;const re=dp(H.toUnwrapped(),O),de=y.translatePosMatrix(H.projMatrix,G,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor")),ce=Qh(de,re,0,1,0);I.draw(y,S.TRIANGLES,A,P,ei.disabled,_r.disabled,ce,d.id,J.vertexBuffer,J.indexBuffer,J.depthSegments,d.paint,y.transform.zoom)}}};class Hc{constructor(a,d,v,S,A,P){this.context=new Hu(a,d),this.transform=v,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=A,this._timeStamp=s.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const O=["fill","line","symbol","circle","heatmap","fill-extrusion","building","raster","raster-particle","hillshade","model","background","sky"];for(const H of O)this._debugParams.enabledLayers[H]=!0;A.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},(()=>{this.style.map.triggerRepaint()})),A.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),A.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),A.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),A.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),A.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const H of O)A.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],H);this.occlusionParams=new _h(A),this.setup(),this.numSublayers=$a.maxUnderzooming+$a.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new s.eE,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new _c(this),this._wireframeDebugCache=new vp,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const I=new s.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new s.T(this.context,I,a.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=S,this.worldview=P}updateTerrain(a,d){const v=!!a&&!!a.terrain&&this.transform.projection.supportsTerrain;if(!(v||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new op(this,a));const S=this._terrain;this.transform.elevation=v?S:null,S.update(a,this.transform,d),this.transform.elevation&&!S.enabled&&(this.transform.elevation=null)}_updateFog(a){const d=a.fog;if(!d||this.transform.projection.name==="globe"||d.getOpacity(this.transform.pitch)<1||d.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[v,S]=d.getFovAdjustedRange(this.transform._fov);if(v>S)return void(this.transform.fogCullDistSq=null);const A=v+.78*(S-v);this.transform.fogCullDistSq=A*A}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(a){a&&!this._terrain&&(this._terrain=new op(this,this.style)),this._forceTerrainMode=a}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(a,d){if(this.width=a*s.q.devicePixelRatio,this.height=d*s.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style.order)this.style._mergedLayers[v].resize()}setup(){const a=this.context,d=new s.ba;d.emplaceBack(0,0),d.emplaceBack(s.aj,0),d.emplaceBack(0,s.aj),d.emplaceBack(s.aj,s.aj),this.tileExtentBuffer=a.createVertexBuffer(d,s.bc.members),this.tileExtentSegments=s.bd.simpleSegment(0,0,4,2);const v=new s.ba;v.emplaceBack(0,0),v.emplaceBack(s.aj,0),v.emplaceBack(0,s.aj),v.emplaceBack(s.aj,s.aj),this.debugBuffer=a.createVertexBuffer(v,s.bc.members),this.debugSegments=s.bd.simpleSegment(0,0,4,5);const S=new s.ba;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=a.createVertexBuffer(S,s.bc.members),this.viewportSegments=s.bd.simpleSegment(0,0,4,2);const A=new s.aZ;A.emplaceBack(0,0,0,0),A.emplaceBack(s.aj,0,s.aj,0),A.emplaceBack(0,s.aj,0,s.aj),A.emplaceBack(s.aj,s.aj,s.aj,s.aj),this.mercatorBoundsBuffer=a.createVertexBuffer(A,s.bf.members),this.mercatorBoundsSegments=s.bd.simpleSegment(0,0,4,2);const P=new s.a_;P.emplaceBack(0,1,2),P.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=a.createIndexBuffer(P);const O=new s.bb;for(const H of[0,1,3,2,0])O.emplaceBack(H);this.debugIndexBuffer=a.createIndexBuffer(O),this.emptyTexture=new s.T(a,new s.r({width:1,height:1},Uint8Array.of(0,0,0,0)),a.gl.RGBA8),this.identityMat=s.bz();const I=this.context.gl;this.stencilClearMode=new Pr({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(a){return a._makeTileBoundsBuffers(this.context,this.transform.projection),a._tileBoundsBuffer?{tileBoundsBuffer:a._tileBoundsBuffer,tileBoundsIndexBuffer:a._tileBoundsIndexBuffer,tileBoundsSegments:a._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const a=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,a.TRIANGLES,Fn.disabled,this.stencilClearMode,ei.disabled,_r.disabled,Zg(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(a,d,v){if(!d||this.currentStencilSource===d.id||!a.isTileClipped()||!v||v.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let O=!1;for(const I of v)if(this._tileClippingMaskIDs[I.key]===void 0){O=!0;break}if(!O)return}this.currentStencilSource=d.id;const S=this.context,A=S.gl;this.nextStencilID+v.length>256&&this.clearStencil(),S.setColorMode(ei.disabled),S.setDepthMode(Fn.disabled);const P=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of v){const I=d.getTile(O),H=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,{tileBoundsBuffer:G,tileBoundsIndexBuffer:ne,tileBoundsSegments:J}=this.getTileBoundsBuffers(I);P.draw(this,A.TRIANGLES,Fn.disabled,new Pr({func:A.ALWAYS,mask:0},H,255,A.KEEP,A.KEEP,A.REPLACE),ei.disabled,_r.disabled,Zg(O.projMatrix),"$clipping",G,ne,J)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const a=this.nextStencilID++,d=this.context.gl;return new Pr({func:d.NOTEQUAL,mask:255},a,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(a){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(a);const d=this.context.gl;return new Pr({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(a){const d=this.context.gl,v=a.sort(((P,O)=>O.overscaledZ-P.overscaledZ)),S=v[v.length-1].overscaledZ,A=v[0].overscaledZ-S+1;if(A>1){this.currentStencilSource=void 0,this.nextStencilID+A>256&&this.clearStencil();const P={};for(let O=0;O<A;O++)P[O+S]=new Pr({func:d.GEQUAL,mask:255},O+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=A,[P,v]}return[{[S]:Pr.disabled},v]}colorModeForRenderPass(){const a=this.context.gl;return this._showOverdrawInspector?new ei([a.CONSTANT_COLOR,a.ONE,a.CONSTANT_COLOR,a.ONE],new s.am(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ei.unblended:ei.alphaBlended}colorModeForDrapableLayerRenderPass(a){const d=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new ei([d.ONE,d.ONE_MINUS_SRC_ALPHA,d.CONSTANT_ALPHA,d.ONE_MINUS_SRC_ALPHA],new s.am(0,0,0,a===void 0?0:a),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(a,d,v,S=!1){if(this.depthOcclusion)return new Fn(this.context.gl.GREATER,Fn.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!S)return Fn.disabled;const A=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new Fn(v||this.context.gl.LEQUAL,d,[A,A])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const a=this.context.gl,d=Math.ceil(this.width),v=Math.ceil(this.height),S=this.context.bindFramebuffer.get(),A=a.getParameter(a.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===d&&this.depthFBO.height===v||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),d!==0&&v!==0&&(this.depthFBO=new Uc(this.context,d,v,!1,"texture"),this.depthTexture=new s.T(this.context,{width:d,height:v,data:null},a.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(S),a.bindTexture(a.TEXTURE_2D,A),this.depthFBO&&(a.bindFramebuffer(a.READ_FRAMEBUFFER,null),a.bindFramebuffer(a.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),a.blitFramebuffer(0,0,d,v,0,0,d,v,a.DEPTH_BUFFER_BIT,a.NEAREST),a.bindFramebuffer(a.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce(((a,d)=>a+d/this._fpsHistory.length),0))}render(a,d){const v=s.q.now();this._dt=v-this._timeStamp,this._timeStamp=v,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=a.map.repaint,this.style=a,this.options=d;const S=this.style._mergedLayers,A=!(!this.terrain||!this.terrain.enabled),P=()=>this.style._getOrder(A).filter((wt=>{const at=S[wt];return!(at.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[at.type]}));let O=P(),I=!1,H=!1,G=null;for(const wt of O){const at=S[wt];at.type==="circle"?I=!0:at.type==="building"?G=at:at.type==="symbol"&&(at.hasInitialOcclusionOpacityProperties?H=!0:I=!0)}let ne=O.map((wt=>S[wt]));const J=this.style._mergedSourceCaches;this.imageManager=a.imageManager,this.modelManager=a.modelManager,this.symbolFadeChange=a.placement.symbolFadeChange(s.q.now()),this.imageManager.beginFrame();let re=0,de=!1;for(const wt in J){const at=J[wt];at.used&&(at.prepare(this.context),at.getSource().usedInConflation&&++re)}let ce=!1;for(const wt of ne)wt.isHidden(this.transform.zoom)||(wt.type==="clip"&&(ce=!0),this.prepareLayer(wt));const pe={},me={},be={},Ne={},De={};for(const wt in J){const at=J[wt];pe[wt]=at.getVisibleCoordinates(),me[wt]=pe[wt].slice().reverse(),be[wt]=at.getVisibleCoordinates(!0).reverse(),Ne[wt]=at.getShadowCasterCoordinates(),De[wt]=at.sortCoordinatesByDistance(pe[wt])}const Be=wt=>{const at=this.style.getLayerSourceCache(wt);return at&&at.used?at.getSource():null};if(re||ce||this._clippingActiveLastFrame){const wt=[],at=[];let Dt=0;for(const At of ne)this.isSourceForClippingOrConflation(At,Be(At))&&(wt.push(At),at.push(Dt)),Dt++;if(wt&&(ce||wt.length>1)||this._clippingActiveLastFrame){ce=!1;const At=[];for(let Gt=0;Gt<wt.length;Gt++){const Yt=wt[Gt],Ht=at[Gt],en=this.style.getLayerSourceCache(Yt);if(!en||!en.used||!en.getSource().usedInConflation&&Yt.type!=="clip"&&Yt.type!=="building")continue;let Pn=s.eF,Kn=s.bW.None;const In=[];let rr=!0;if(Yt.type==="building")Pn=s.eH;else if(Yt.type==="clip"){Pn=Ht;for(const ar of Yt.layout.get("clip-layer-types"))Kn|=ar==="model"?s.bW.Model:ar==="symbol"?s.bW.Symbol:s.bW.FillExtrusion;for(const ar of Yt.layout.get("clip-layer-scope"))In.push(ar);Yt.isHidden(this.transform.zoom)?rr=!1:ce=!0}rr&&At.push({layer:Yt.fqid,cache:en,order:Pn,clipMask:Kn,clipScope:In})}this.replacementSource.setSources(At),de=!0}}this._clippingActiveLastFrame=ce,de||this.replacementSource.clear(),this.conflationActive=de,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let wt=0;wt<ne.length;wt++){const at=ne[wt],Dt=at.cutoffRange();if(this.longestCutoffRange=Math.max(Dt,this.longestCutoffRange),Dt>0){const At=Be(at);At&&(this.minCutoffZoom=Math.max(At.minzoom,this.minCutoffZoom)),at.minzoom&&(this.minCutoffZoom=Math.max(at.minzoom,this.minCutoffZoom))}at.is3D(A)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=wt),this._lastOcclusionLayer=wt)}const Ze=this.style&&this.style.fog;Ze?(this._fogVisible=Ze.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Ze.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(be),this.opaquePassCutoff=0,O=P(),ne=O.map((wt=>S[wt])));const Ye=this._shadowRenderer;if(Ye){Ye.updateShadowParameters(this.transform,this.style.directionalLight);for(const wt in J)for(const at of pe[wt]){let Dt={min:0,max:0};this.terrain&&(Dt=this.terrain.getMinMaxForTile(at)||Dt),Ye.addShadowReceiver(at.toUnwrapped(),Dt.min,Dt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.eG(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new yt(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Ue=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),qe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Ue&&!this._snow&&(this._snow=new uy(this)),!Ue&&this._snow&&(this._snow.destroy(),delete this._snow),qe&&!this._rain&&(this._rain=new jd(this)),!qe&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),G){this.buildingTileBorderManager||(this.buildingTileBorderManager=new qv);const wt=this.style.getLayerSourceCache(G);this.buildingTileBorderManager.updateBorders(wt,G)}if(!nr.has(this.context.gl))return;this.renderPass="offscreen";for(const wt of ne){const at=a.getLayerSourceCache(wt);if(!wt.hasOffscreenPass()||wt.isHidden(this.transform.zoom))continue;const Dt=at?me[at.id]:void 0;(wt.type==="custom"||wt.type==="raster"||wt.type==="raster-particle"||wt.isSky()||Dt&&Dt.length)&&this.renderLayer(this,at,wt,Dt)}this.depthRangeFor3D=[0,1-(ne.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Ne)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Ge=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),_t=(()=>{if(d.showOverdrawInspector)return s.am.black;const wt=this.style.fog;if(wt&&this.transform.projection.supportsFog){const at=this.style.getLut(wt.scope);if(!Ge){const Dt=wt.properties.get("color-use-theme")==="none",At=wt.properties.get("color").toNonPremultipliedRenderColor(Dt?null:at).toArray01();return new s.am(...At)}if(Ge){const Dt=wt.properties.get("space-color-use-theme")==="none",At=wt.properties.get("space-color").toNonPremultipliedRenderColor(Dt?null:at).toArray01();return new s.am(...At)}}return s.am.transparent})();if(this.context.clear({color:_t,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ge&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=O.length-1;this.currentLayer>=0;this.currentLayer--){const wt=ne[this.currentLayer],at=a.getLayerSourceCache(wt);if(wt.isSky())continue;const Dt=at?(wt.is3D(A)?De:me)[at.id]:void 0;this._renderTileClippingMasks(wt,at,Dt),this.renderLayer(this,at,wt,Dt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ge&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||s.ah(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<O.length;this.currentLayer++){const wt=ne[this.currentLayer],at=a.getLayerSourceCache(wt);wt.isSky()&&this.renderLayer(this,at,wt,at?me[at.id]:void 0)}function ct(wt,at){let Dt;return at&&(Dt=(wt.type==="symbol"?be:wt.is3D(A)?De:me)[at.id]),Dt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<O.length;){const wt=ne[this.currentLayer];if(wt.type==="raster"||wt.type==="raster-particle"){const at=a.getLayerSourceCache(wt);this.renderLayer(this,at,wt,ct(wt,at))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Bt=0;Ye&&(Bt=Ye.getShadowCastingLayerCount());let Ct=!1,Xt=-1;for(let wt=0;wt<O.length;++wt){const at=ne[wt];at.isHidden(this.transform.zoom)||at.is3D(A)&&(Xt=wt)}H&&Xt===-1&&(I=!0);let gn=!1;for(;this.currentLayer<O.length;){const wt=ne[this.currentLayer],at=a.getLayerSourceCache(wt);if(wt.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(wt)){if(wt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!gn&&wt.is3D(A)&&!A){const Dt=this.currentLayer,At=Gt=>{for(this.currentLayer=0;this.currentLayer<ne.length;this.currentLayer++){const Yt=ne[this.currentLayer];if(wh[Yt.type]){const Ht=this.style.getLayerSourceCache(Yt);wh[Yt.type](this,Ht,Yt,ct(Yt,Ht),Gt)}}};At("initialize"),At("reset"),this.currentLayer=Dt,gn=!0}if(I&&!Ct&&this.terrain&&!this.transform.isOrthographic&&(Ct=!0,this.blitDepth()),H&&Xt!==-1&&this.currentLayer===Xt+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(wt,at,at?pe[at.id]:void 0),this.renderLayer(this,at,wt,ct(wt,at)),!this.terrain&&Ye&&Bt>0&&wt.hasShadowPass()&&--Bt==0){{this.clearStencil(),this.resetStencilClippingMasks();const Dt=this.currentLayer;for(this.currentLayer=0;this.currentLayer<ne.length;this.currentLayer++){const At=ne[this.currentLayer];if(wl[At.type]){const Gt=this.style.getLayerSourceCache(At);wl[At.type](this,Gt,At,ct(At,Gt))}}this.currentLayer=Dt}if(Ye.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer){const Dt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Dt;this.currentLayer++){const At=ne[this.currentLayer];if(!At.hasLightBeamPass())continue;const Gt=a.getLayerSourceCache(At);this.renderLayer(this,Gt,At,Gt?me[Gt.id]:void 0)}this.currentLayer=Dt,this.renderPass="translucent"}}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Dt=this.currentLayer;this.depthOcclusion=!0;for(const At of this.layersWithOcclusionOpacity){this.currentLayer=At;const Gt=ne[this.currentLayer],Yt=a.getLayerSourceCache(Gt),Ht=Yt?me[Yt.id]:void 0;this.terrain||this._renderTileClippingMasks(Gt,Yt,Yt?pe[Yt.id]:void 0),this.renderLayer(this,Yt,Gt,Ht)}this.depthOcclusion=!1,this.currentLayer=Dt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let wt=null;ne.forEach((at=>{const Dt=a.getLayerSourceCache(at);Dt&&!at.isHidden(this.transform.zoom)&&Dt.getVisibleCoordinates().length&&(!wt||wt.getSource().maxzoom<Dt.getSource().maxzoom)&&(wt=Dt)})),wt&&this.options.showTileBoundaries&&du(this,wt,wt.getVisibleCoordinates(),s.am.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&du(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new s.am(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&(function(wt){const at=wt.transform.padding;af(wt,wt.transform.height-(at.top||0),3,Fv),af(wt,at.bottom||0,3,Im),Lm(wt,at.left||0,3,ay),Lm(wt,wt.transform.width-(at.right||0),3,Bv);const Dt=wt.transform.centerPoint;(function(At,Gt,Yt,Ht){mp(At,Gt-1,Yt-10,2,20,Ht),mp(At,Gt-10,Yt-1,20,2,Ht)})(wt,Dt.x,wt.transform.height-Dt.y,Uv)})(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),de||(this.conflationActive=!1)}prepareLayer(a){this.gpuTimingStart(a);const{unsupportedLayers:d}=this.transform.projection,v=!d||!d.includes(a.type);if(Ed[a.type]&&(v||this.terrain&&a.type==="custom")){const S=this.style.getLayerSourceCache(a);Ed[a.type](a,S,this)}this.gpuTimingEnd()}renderLayer(a,d,v,S){v.isHidden(this.transform.zoom)||(v.type==="background"||v.type==="sky"||v.type==="custom"||v.type==="model"||v.type==="raster"||v.type==="raster-particle"||S&&S.length)&&(this.id=v.id,this.gpuTimingStart(v),a.transform.projection.unsupportedLayers&&a.transform.projection.unsupportedLayers.includes(v.type)&&(!a.terrain||v.type!=="custom")||v.type==="clip"||Gv[v.type](a,d,v,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(a){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery,v=this.context.gl;let S=this.gpuTimers[a.id];S||(S=this.gpuTimers[a.id]={calls:0,cpuTime:0,query:v.createQuery()}),S.calls++,v.beginQuery(d.TIME_ELAPSED_EXT,S.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const a=this.context.extTimerQuery,d=this.context.gl,v=d.createQuery();this.deferredRenderGpuTimeQueries.push(v),d.beginQuery(a.TIME_ELAPSED_EXT,v)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const a=this.gpuTimers;return this.gpuTimers={},a}collectDeferredRenderGpuQueries(){const a=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],a}queryGpuTimers(a){const d={};for(const v in a){const S=a[v],A=this.context.extTimerQuery,P=A.getQueryParameter(S.query,this.context.gl.QUERY_RESULT)/1e6;A.deleteQueryEXT(S.query),d[v]=P}return d}queryGpuTimeDeferredRender(a){if(!this.options.gpuTimingDeferredRender)return 0;const d=this.context.gl;let v=0;for(const S of a)v+=d.getQueryParameter(S,d.QUERY_RESULT)/1e6,d.deleteQuery(S);return v}translatePosMatrix(a,d,v,S,A){if(!v[0]&&!v[1])return a;const P=A?S==="map"?this.transform.angle:0:S==="viewport"?-this.transform.angle:0;if(P){const H=Math.sin(P),G=Math.cos(P);v=[v[0]*G-v[1]*H,v[0]*H+v[1]*G]}const O=[A?v[0]:s.aw(d,v[0],this.transform.zoom),A?v[1]:s.aw(d,v[1],this.transform.zoom),0],I=new Float32Array(16);return s.bo(I,a,O),I}saveTileTexture(a){if(a.context!==this.context)return;const d=a.size[0],v=this._tileTextures[d];v?v.push(a):this._tileTextures[d]=[a]}getTileTexture(a){const d=this._tileTextures[a];return d&&d.length>0?d.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(a,d,v){const S=v===void 0?this.terrain&&this.terrain.renderingToTexture:v,A=[];return this.style&&this.style.enable3dLights()&&(a==="globeRaster"||a==="terrainRaster"?(A.push("LIGHTING_3D_MODE"),A.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):S||A.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||A.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(A.push("TERRAIN"),this.linearFloatFilteringSupported()&&A.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&A.push("GLOBE"),!this._fogVisible||S||d!==void 0&&!d||A.push("FOG","FOG_DITHERING"),S&&A.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&A.push("OVERDRAW_INSPECTOR"),A}getOrCreateProgram(a,d){this.cache=this.cache||{};const v=d&&d.defines||[],S=d&&d.config,A=this.currentGlobalDefines(a,d&&d.overrideFog,d&&d.overrideRtt).concat(v),P=Am.cacheKey(lh[a],a,A,S);return this.cache[P]||(this.cache[P]=new Am(this.context,a,lh[a],S,Ts[a],A)),this.cache[P]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(a,d){if(this.style.enable3dLights()){const v=this.style.directionalLight,S=this.style.ambientLight;if(v&&S){const A=((P,O,I)=>{const H=P.properties.get("direction"),G=P.properties.get("color-use-theme")==="none",ne=P.properties.get("color").toNonPremultipliedRenderColor(G?null:I.getLut(P.scope)).toArray01(),J=P.properties.get("intensity"),re=O.properties.get("color-use-theme")==="none",de=O.properties.get("color").toNonPremultipliedRenderColor(re?null:I.getLut(O.scope)).toArray01(),ce=O.properties.get("intensity"),pe=[H.x,H.y,H.z],me=s.dI(de,ce),be=s.dI(ne,J);return{u_lighting_ambient_color:me,u_lighting_directional_dir:pe,u_lighting_directional_color:be,u_ground_radiance:mh(pe,be,me)}})(v,S,this.style);d.setLightsUniformValues(a,A)}}}uploadCommonUniforms(a,d,v,S,A){if(this.uploadCommonLightUniforms(a,d),this.terrain&&this.terrain.renderingToTexture)return;const P=this.style.fog;if(P){const O=P.getOpacity(this.transform.pitch),I=((H,G,ne,J,re,de,ce,pe,me,be,Ne,De)=>{const Be=H.transform,Ze=G.properties.get("color-use-theme")==="none",Ye=G.properties.get("color").toNonPremultipliedRenderColor(Ze?null:H.style.getLut(G.scope)).toArray01();Ye[3]=J;const Ue=H.frameCounter/1e3%1,[qe,Ge]=G.properties.get("vertical-range");return{u_fog_matrix:ne?Be.calculateFogTileMatrix(ne):De||H.identityMat,u_fog_range:G.getFovAdjustedRange(Be._fov),u_fog_color:Ye,u_fog_horizon_blend:G.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(qe,Ge),Ge],u_fog_temporal_offset:Ue,u_frustum_tl:re,u_frustum_tr:de,u_frustum_br:ce,u_frustum_bl:pe,u_globe_pos:me,u_globe_radius:be,u_viewport:Ne,u_globe_transition:s.ah(Be.zoom),u_is_globe:+(Be.projection.name==="globe")}})(this,P,v,O,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.q.devicePixelRatio,this.transform.height*s.q.devicePixelRatio],S);d.setFogUniformValues(a,I)}A&&d.setCutoffUniformValues(a,A.uniformValues)}setTileLoadedFlag(a){this.tileLoaded=a}saveCanvasCopy(){const a=this.canvasCopy();a&&(this.frameCopies.push(a),this.tileLoaded=!1)}canvasCopy(){const a=this.context.gl,d=a.createTexture();return a.bindTexture(a.TEXTURE_2D,d),a.copyTexImage2D(a.TEXTURE_2D,0,a.RGBA,0,0,a.drawingBufferWidth,a.drawingBufferHeight,0),d}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const a=this.style&&this.style.fog;return!!a&&a.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const a=this._backgroundTiles,d=this._backgroundTiles={},v=this.transform.coveringTiles({tileSize:512});for(const S of v)d[S.key]=a[S.key]||new Va(S,512,this.transform.tileZoom,this,void 0,this.worldview);return d}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(a,d){return!(!a.is3D(!(!this.terrain||!this.terrain.enabled))||a.type!=="clip"&&a.type!=="building"&&(a.minzoom&&a.minzoom>this.transform.zoom||(this.style._clipLayerPresent||a.sourceLayer!=="building"&&a.sourceLayer!=="procedural_buildings")&&(!d||d.type!=="batched-model")))}isTileAffectedByFog(a){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let d=this._cachedTileFogOpacities[a.key];return d||(this._cachedTileFogOpacities[a.key]=d=this.style.fog.getOpacityForTile(a)),d[0]>=Kt||d[1]>=Kt}setupDepthForOcclusion(a,d,v){const S=this.context,A=S.gl,P=!!v;var O;v||(v={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),S.activeTexture.set(A.TEXTURE3),a&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),v.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],v.u_depth_range_unpack=[2/((O=this.depthRangeFor3D)[1]-O[0]),-1-2*O[0]/(O[1]-O[0])],v.u_occluder_half_size=.5*this.occlusionParams.occluderSize,v.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),S.activeTexture.set(A.TEXTURE0),P||d.setTerrainUniformValues(S,v)}}function Cd(y,a){let d=!1,v=null;const S=()=>{v=null,d&&(y(),v=setTimeout(S,a),d=!1)};return()=>(d=!0,v||S(),v)}class Vm{constructor(a){this._hashName=a&&encodeURIComponent(a),s.aV(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Cd(this._updateHashUnthrottled.bind(this),300)}addTo(a){return this._map=a,window.addEventListener("hashchange",this._onHashChange,!1),a.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const a=this._map;if(!a)return"";const d=$m(a);if(this._hashName){const v=this._hashName;let S=!1;const A=location.hash.slice(1).split("&").map((P=>{const O=P.split("=")[0];return O===v?(S=!0,`${O}=${d}`):P})).filter((P=>P));return S||A.push(`${v}=${d}`),`#${A.join("&")}`}return`#${d}`}_getCurrentHash(){const a=location.hash.replace("#","");if(this._hashName){let d;return a.split("&").map((v=>v.split("="))).forEach((v=>{v[0]===this._hashName&&(d=v)})),(d&&d[1]||"").split("/")}return a.split("/")}_onHashChange(){const a=this._map;if(!a)return!1;const d=this._getCurrentHash();if(d.length>=3&&!d.some((v=>isNaN(Number(v))))){const v=a.dragRotate.isEnabled()&&a.touchZoomRotate.isEnabled()?+(d[3]||0):a.getBearing();return a.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:v,pitch:+(d[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function $m(y,a){const d=y.getCenter(),v=Math.round(100*y.getZoom())/100,S=Math.ceil((v*Math.LN2+Math.log(512/360/.5))/Math.LN10),A=Math.pow(10,S),P=Math.round(d.lng*A)/A,O=Math.round(d.lat*A)/A,I=y.getBearing(),H=y.getPitch();let G=a?`/${P}/${O}/${v}`:`${v}/${O}/${P}`;return(I||H)&&(G+="/"+Math.round(10*I)/10),H&&(G+=`/${Math.round(H)}`),G}const fu={linearity:.3,easing:s.eI(0,0,.3,1)},Nd=s.h({deceleration:2500,maxSpeed:1400},fu),nc=s.h({deceleration:20,maxSpeed:1400},fu),Vo=s.h({deceleration:1e3,maxSpeed:360},fu),Gu=s.h({deceleration:1e3,maxSpeed:90},fu);class qm{constructor(a){this._map=a,this.clear()}clear(){this._inertiaBuffer=[]}record(a){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.q.now(),settings:a})}_drainInertiaBuffer(){const a=this._inertiaBuffer,d=s.q.now();for(;a.length>0&&d-a[0].time>160;)a.shift()}_onMoveEnd(a){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const d={zoom:0,bearing:0,pitch:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:A}of this._inertiaBuffer)d.zoom+=A.zoomDelta||0,d.bearing+=A.bearingDelta||0,d.pitch+=A.pitchDelta||0,A.panDelta&&d.pan._add(A.panDelta),A.around&&(d.around=A.around),A.pinchAround&&(d.pinchAround=A.pinchAround);const v=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(d.pan.mag()){const A=rc(d.pan.mag(),v,s.h({},Nd,a||{}));S.offset=d.pan.mult(A.amount/d.pan.mag()),S.center=this._map.transform.center,Sc(S,A)}if(d.zoom){const A=rc(d.zoom,v,nc);S.zoom=this._map.transform.zoom+A.amount,Sc(S,A)}if(d.bearing){const A=rc(d.bearing,v,Vo);S.bearing=this._map.transform.bearing+s.ay(A.amount,-179,179),Sc(S,A)}if(d.pitch){const A=rc(d.pitch,v,Gu);S.pitch=this._map.transform.pitch+A.amount,Sc(S,A)}if(S.zoom||S.bearing){const A=d.pinchAround===void 0?d.around:d.pinchAround;S.around=A?this._map.unproject(A):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function Sc(y,a){(!y.duration||y.duration<a.duration)&&(y.duration=a.duration,y.easing=a.easing)}function rc(y,a,d){const{maxSpeed:v,linearity:S,deceleration:A}=d,P=s.ay(y*S/(a/1e3),-v,v),O=Math.abs(P)/(A*S);return{easing:d.easing,duration:1e3*O,amount:P*(O/2)}}class ki extends s.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,d,v,S={}){const A=ye(d.getCanvasContainer(),v),P=d.unproject(A);super(a,s.h({point:A,lngLat:P,originalEvent:v},S)),this._defaultPrevented=!1,this.target=d}}class Pd extends s.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,d,v){const S=a==="touchend"?v.changedTouches:v.touches,A=Ce(d.getCanvasContainer(),S),P=A.map((I=>d.unproject(I))),O=A.reduce(((I,H,G,ne)=>I.add(H.div(ne.length))),new s.P(0,0));super(a,{points:A,point:O,lngLats:P,lngLat:d.unproject(O),originalEvent:v}),this._defaultPrevented=!1}}class Hm extends s.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,d){super("wheel",{originalEvent:d}),this._defaultPrevented=!1}}class Gm{constructor(a,d){this._map=a,this._clickTolerance=d.clickTolerance}reset(){this._mousedownPos=void 0}wheel(a){return this._firePreventable(new Hm(this._map,a))}mousedown(a,d){return this._mousedownPos=d,this._firePreventable(new ki(a.type,this._map,a))}mouseup(a){this._map.fire(new ki(a.type,this._map,a))}preclick(a){const d=s.h({},a);d.type="preclick",this._map.fire(new ki(d.type,this._map,d))}click(a,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||(this.preclick(a),this._map.fire(new ki(a.type,this._map,a)))}dblclick(a){return this._firePreventable(new ki(a.type,this._map,a))}mouseover(a){this._map.fire(new ki(a.type,this._map,a))}mouseout(a){this._map.fire(new ki(a.type,this._map,a))}touchstart(a){return this._firePreventable(new Pd(a.type,this._map,a))}touchmove(a){this._map.fire(new Pd(a.type,this._map,a))}touchend(a){this._map.fire(new Pd(a.type,this._map,a))}touchcancel(a){this._map.fire(new Pd(a.type,this._map,a))}_firePreventable(a){if(this._map.fire(a),a.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Sh{constructor(a){this._map=a}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(a){this._map.fire(new ki(a.type,this._map,a))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ki("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(a){this._delayContextMenu?this._contextMenuEvent=a:this._map.fire(new ki(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class dy{constructor(a,d){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(a,d){this.isEnabled()&&a.shiftKey&&a.button===0&&(ae(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(a,d){if(!this._active)return;const v=d,S=this._startPos,A=this._lastPos;if(!S||!A||A.equals(v)||!this._box&&v.dist(S)<this._clickTolerance)return;this._lastPos=v,this._box||(this._box=B("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));const P=Math.min(S.x,v.x),O=Math.max(S.x,v.x),I=Math.min(S.y,v.y),H=Math.max(S.y,v.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform=`translate(${P}px,${I}px)`,this._box.style.width=O-P+"px",this._box.style.height=H-I+"px")}))}mouseupWindow(a,d){if(!this._active)return;const v=this._startPos,S=d;if(v&&a.button===0){if(this.reset(),he(),v.x!==S.x||v.y!==S.y)return this._map.fire(new s.A("boxzoomend",{originalEvent:a})),{cameraAnimation:A=>A.fitScreenCoordinates(v,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",a)}}keydown(a){this._active&&a.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",a))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Z(),delete this._startPos,delete this._lastPos}_fireEvent(a,d){return this._map.fire(new s.A(a,{originalEvent:d}))}}function pu(y,a){const d={};for(let v=0;v<y.length;v++)d[y[v].identifier]=a[v];return d}class bp{constructor(a){this.reset(),this.numTouches=a.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(a,d,v){(this.centroid||v.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=a.timeStamp),v.length===this.numTouches&&(this.centroid=(function(S){const A=new s.P(0,0);for(const P of S)A._add(P);return A.div(S.length)})(d),this.touches=pu(v,d)))}touchmove(a,d,v){if(this.aborted||!this.centroid)return;const S=pu(v,d);for(const A in this.touches){const P=S[A];(!P||P.dist(this.touches[A])>30)&&(this.aborted=!0)}}touchend(a,d,v){if((!this.centroid||a.timeStamp-this.startTime>500)&&(this.aborted=!0),v.length===0){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class Md{constructor(a){this.singleTap=new bp(a),this.numTaps=a.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(a,d,v){this.singleTap.touchstart(a,d,v)}touchmove(a,d,v){this.singleTap.touchmove(a,d,v)}touchend(a,d,v){const S=this.singleTap.touchend(a,d,v);if(S){const A=a.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(S)<30;if(A&&P||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class hy{constructor(){this._zoomIn=new Md({numTouches:1,numTaps:2}),this._zoomOut=new Md({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(a,d,v){this._zoomIn.touchstart(a,d,v),this._zoomOut.touchstart(a,d,v)}touchmove(a,d,v){this._zoomIn.touchmove(a,d,v),this._zoomOut.touchmove(a,d,v)}touchend(a,d,v){const S=this._zoomIn.touchend(a,d,v),A=this._zoomOut.touchend(a,d,v);return S?(this._active=!0,a.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()+1,around:P.unproject(S)},{originalEvent:a})}):A?(this._active=!0,a.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()-1,around:P.unproject(A)},{originalEvent:a})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const fy={0:1,2:2},df={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class hf{constructor(a){this.reset(),this._clickTolerance=a.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(a,d){return!1}_move(a,d){return{}}mousedown(a,d){if(this._lastPoint)return;const v=Ve(a);this._correctButton(a,v)&&(this._lastPoint=d,this._eventButton=v)}mousemoveWindow(a,d){const v=this._lastPoint;if(v){if(a.preventDefault(),this._eventButton!=null&&(function(S,A){const P=fy[A];return S.buttons===void 0||(S.buttons&P)!==P})(a,this._eventButton))this.reset();else if(this._moved||!(d.dist(v)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(v,d)}}mouseupWindow(a){this._lastPoint&&Ve(a)===this._eventButton&&(this._moved&&he(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wm extends hf{mousedown(a,d){super.mousedown(a,d),this._lastPoint&&(this._active=!0)}_correctButton(a,d){return d===0&&!a.ctrlKey}_move(a,d){return{around:d,panDelta:d.sub(a)}}}class Xm extends hf{constructor(a){super(a),this._pitchRotateKey=a.pitchRotateKey?df[a.pitchRotateKey]:void 0}_correctButton(a,d){return this._pitchRotateKey?d===0&&a[this._pitchRotateKey]:d===0&&a.ctrlKey||d===2}_move(a,d){const v=.8*(d.x-a.x);if(v)return this._active=!0,{bearingDelta:v}}contextmenu(a){this._pitchRotateKey||a.preventDefault()}}class py extends hf{constructor(a){super(a),this._pitchRotateKey=a.pitchRotateKey?df[a.pitchRotateKey]:void 0}_correctButton(a,d){return this._pitchRotateKey?d===0&&a[this._pitchRotateKey]:d===0&&a.ctrlKey||d===2}_move(a,d){const v=-.5*(d.y-a.y);if(v)return this._active=!0,{pitchDelta:v}}contextmenu(a){this._pitchRotateKey||a.preventDefault()}}class T_{constructor(a,d){this._map=a,this._el=a.getCanvasContainer(),this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset(),s.aV(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}touchstart(a,d,v){return this._calculateTransform(a,d,v)}touchmove(a,d,v){if(this._active&&!(v.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(v.length===1&&!s.eJ())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return a.cancelable&&a.preventDefault(),this._calculateTransform(a,d,v)}}touchend(a,d,v){this._calculateTransform(a,d,v),this._active&&v.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(a,d,v){v.length>0&&(this._active=!0);const S=pu(v,d),A=new s.P(0,0),P=new s.P(0,0);let O=0;for(const H in S){const G=S[H],ne=this._touches[H];ne&&(A._add(G),P._add(G.sub(ne)),O++,S[H]=G)}if(this._touches=S,O<this._minTouches||!P.mag())return;const I=P.div(O);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:A.div(O),panDelta:I}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=B("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")}),500)}}class Zm{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(a){}_move(a,d,v){return{}}touchstart(a,d,v){this._firstTwoTouches||v.length<2||(this._firstTwoTouches=[v[0].identifier,v[1].identifier],this._start([d[0],d[1]]))}touchmove(a,d,v){const S=this._firstTwoTouches;if(!S)return;a.preventDefault();const[A,P]=S,O=fo(v,d,A),I=fo(v,d,P);if(!O||!I)return;const H=this._aroundCenter?null:O.add(I).div(2);return this._move([O,I],H,a)}touchend(a,d,v){if(!this._firstTwoTouches)return;const[S,A]=this._firstTwoTouches,P=fo(v,d,S),O=fo(v,d,A);P&&O||(this._active&&he(),this.reset())}touchcancel(){this.reset()}enable(a){this._enabled=!0,this._aroundCenter=!!a&&a.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function fo(y,a,d){for(let v=0;v<y.length;v++)if(y[v].identifier===d)return a[v]}function $o(y,a){return Math.log(y/a)/Math.LN2}class Wv extends Zm{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(a){this._startDistance=this._distance=a[0].dist(a[1])}_move(a,d){const v=this._distance;if(this._distance=a[0].dist(a[1]),this._active||!(Math.abs($o(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:$o(this._distance,v),pinchAround:d}}}function my(y,a){return 180*y.angleWith(a)/Math.PI}class Xv extends Zm{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(a){this._startVector=this._vector=a[0].sub(a[1]),this._minDiameter=a[0].dist(a[1])}_move(a,d){const v=this._vector;if(this._vector=a[0].sub(a[1]),v&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:my(this._vector,v),pinchAround:d}}_isBelowThreshold(a){this._minDiameter=Math.min(this._minDiameter,a.mag());const d=25/(Math.PI*this._minDiameter)*360,v=this._startVector;if(!v)return!1;const S=my(a,v);return Math.abs(S)<d}}function Ym(y){return Math.abs(y.y)>Math.abs(y.x)}class Zv extends Zm{constructor(a){super(),this._map=a}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(a){this._lastPoints=a,Ym(a[0].sub(a[1]))&&(this._valid=!1)}_move(a,d,v){const S=this._lastPoints;if(!S)return;const A=a[0].sub(S[0]),P=a[1].sub(S[1]);return this._map._cooperativeGestures&&!s.eJ()&&v.touches.length<3||(this._valid=this.gestureBeginsVertically(A,P,v.timeStamp),!this._valid)?void 0:(this._lastPoints=a,this._active=!0,{pitchDelta:(A.y+P.y)/2*-.5})}gestureBeginsVertically(a,d,v){if(this._valid!==void 0)return this._valid;const S=a.mag()>=2,A=d.mag()>=2;if(!S&&!A)return;if(!S||!A)return this._firstMove==null&&(this._firstMove=v),v-this._firstMove<100&&void 0;const P=a.y>0==d.y>0;return Ym(a)&&Ym(d)&&P}}const Km={panStep:100,bearingStep:15,pitchStep:10};class gy{constructor(){const a=Km;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(a){if(a.altKey||a.ctrlKey||a.metaKey)return;let d=0,v=0,S=0,A=0,P=0;switch(a.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:a.shiftKey?v=-1:(a.preventDefault(),A=-1);break;case 39:a.shiftKey?v=1:(a.preventDefault(),A=1);break;case 38:a.shiftKey?S=1:(a.preventDefault(),P=-1);break;case 40:a.shiftKey?S=-1:(a.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(v=0,S=0),{cameraAnimation:O=>{const I=O.getZoom();O.easeTo({duration:300,easeId:"keyboardHandler",easing:Yv,zoom:d?Math.round(I)+d*(a.shiftKey?2:1):I,bearing:O.getBearing()+v*this._bearingStep,pitch:O.getPitch()+S*this._pitchStep,offset:[-A*this._panStep,-P*this._panStep],center:O.getCenter()},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Yv(y){return y*(2-y)}const Kv=4.000244140625,A_=1/450;class Jv{constructor(a,d){this._map=a,this._el=a.getCanvasContainer(),this._handler=d,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=A_,s.aV(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(a){this._defaultZoomRate=a}setWheelZoomRate(a){this._wheelZoomRate=a}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!a&&a.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(a){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(a.ctrlKey||a.metaKey||this.isZooming()||s.eJ()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let d=a.deltaMode===WheelEvent.DOM_DELTA_LINE?40*a.deltaY:a.deltaY;const v=s.q.now(),S=v-(this._lastWheelEventTime||0);this._lastWheelEventTime=v,d!==0&&d%Kv==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=d,this._timeout=window.setTimeout(this._onTimeout,40,a)):this._type||(this._type=Math.abs(S*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),a.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=a,this._delta-=d,this._active||this._start(a)),a.preventDefault()}_onTimeout(a){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(a)}_start(a){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=ye(this._el,a);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:d,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const a=this._map.transform;this._type==="wheel"&&a.projection.wrap&&(a._center.lng>=180||a._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const d=()=>a._terrainEnabled()&&this._aroundCoord?a.computeZoomRelativeTo(this._aroundCoord):a.zoom;if(this._delta!==0){const H=this._type==="wheel"&&Math.abs(this._delta)>Kv?this._wheelZoomRate:this._defaultZoomRate;let G=2/(1+Math.exp(-Math.abs(this._delta*H)));this._delta<0&&G!==0&&(G=1/G);const ne=d(),J=Math.pow(2,ne),re=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):J;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(re*G))),this._type==="wheel"&&(this._startZoom=ne,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const v=typeof this._targetZoom=="number"?this._targetZoom:d(),S=this._startZoom,A=this._easing;let P,O=!1;if(this._type==="wheel"&&S&&A){const H=Math.min((s.q.now()-this._lastWheelEventTime)/200,1),G=A(H);P=s.ai(S,v,G),H<1?this._frameId||(this._frameId=!0):O=!0}else P=v,O=!0;this._active=!0,O&&(this._active=!1,this._finishTimeout=window.setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200));let I=P-d();return I*this._lastDelta<0&&(I=0),{noInertia:!0,needsRenderFrame:!O,zoomDelta:I,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(a){let d=s.eK;if(this._prevEase){const v=this._prevEase,S=(s.q.now()-v.start)/v.duration,A=v.easing(S+.01)-v.easing(S),P=.27/Math.sqrt(A*A+1e-4)*.01,O=Math.sqrt(.0729-P*P);d=s.eI(P,O,.25,1)}return this._prevEase={start:s.q.now(),duration:a,easing:d},d}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=B("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")}),200)}}class Hs{constructor(a,d){this._clickZoom=a,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class yy{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(a,d){return a.preventDefault(),{cameraAnimation:v=>{v.easeTo({duration:300,zoom:v.getZoom()+(a.shiftKey?-1:1),around:v.unproject(d)},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class j_{constructor(){this._tap=new Md({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(a,d,v){this._swipePoint||(this._tapTime&&a.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?v.length>0&&(this._swipePoint=d[0],this._swipeTouch=v[0].identifier):this._tap.touchstart(a,d,v))}touchmove(a,d,v){if(this._tapTime){if(this._swipePoint){if(v[0].identifier!==this._swipeTouch)return;const S=d[0],A=S.y-this._swipePoint.y;return this._swipePoint=S,a.preventDefault(),this._active=!0,{zoomDelta:A/128}}}else this._tap.touchmove(a,d,v)}touchend(a,d,v){this._tapTime?this._swipePoint&&v.length===0&&this.reset():this._tap.touchend(a,d,v)&&(this._tapTime=a.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jm{constructor(a,d,v){this._el=a,this._mousePan=d,this._touchPan=v}enable(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class vy{constructor(a,d,v){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=d,this._mousePitch=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ff{constructor(a,d,v,S){this._el=a,this._touchZoom=d,this._touchRotate=v,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const wp=y=>y.zoom||y.drag||y.pitch||y.rotate;class Qm extends s.A{}class eg{constructor(){this.constants=[1,1,.01],this.radius=0}setup(a,d){const v=s.at([],d,a);this.radius=s.ae(v[2]<0?s.eM([],v,this.constants):[v[0],v[1],0])}projectRay(a){s.eM(a,a,this.constants),s.au(a,a),s.eN(a,a,this.constants);const d=s.c1([],a,this.radius);if(d[2]>0){const v=s.c1([],[0,0,1],s.bG(d,[0,0,1])),S=s.c1([],s.au([],[d[0],d[1],0]),this.radius),A=s.d5([],d,s.c1([],s.at([],s.d5([],S,v),d),2));d[0]=A[0],d[1]=A[1]}return d}}function Ro(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class Sp{constructor(a,d){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new qm(a),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new eg,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(d),s.aV(["handleEvent","handleWindowEvent"],this);const v=this._el;this._listeners=[[v,"touchstart",{passive:!0}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[window,"blur",void 0]];for(const[S,A,P]of this._listeners){const O=S===document?this.handleWindowEvent:this.handleEvent;S.addEventListener(A,O,P)}}destroy(){for(const[a,d,v]of this._listeners){const S=a===document?this.handleWindowEvent:this.handleEvent;a.removeEventListener(d,S,v)}}_addDefaultHandlers(a){const d=this._map,v=d.getCanvasContainer();this._add("mapEvent",new Gm(d,a));const S=d.boxZoom=new dy(d,a);this._add("boxZoom",S);const A=new hy,P=new yy;d.doubleClickZoom=new Hs(P,A),this._add("tapZoom",A),this._add("clickZoom",P);const O=new j_;this._add("tapDragZoom",O);const I=d.touchPitch=new Zv(d);this._add("touchPitch",I);const H=new Xm(a),G=new py(a);d.dragRotate=new vy(a,H,G),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",G,["mouseRotate"]);const ne=new Wm(a),J=new T_(d,a);d.dragPan=new Jm(v,ne,J),this._add("mousePan",ne),this._add("touchPan",J,["touchZoom","touchRotate"]);const re=new Xv,de=new Wv;d.touchZoomRotate=new ff(v,de,re,O),this._add("touchRotate",re,["touchPan","touchZoom"]),this._add("touchZoom",de,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Sh(d));const ce=d.scrollZoom=new Jv(d,this);this._add("scrollZoom",ce,["mousePan"]);const pe=d.keyboard=new gy;this._add("keyboard",pe);for(const me of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])a.interactive&&a[me]&&d[me].enable(a[me])}_add(a,d,v){this._handlers.push({handlerName:a,handler:d,allowed:v}),this._handlersById[a]=d}stop(a){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},a),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:a}of this._handlers)if(a.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!wp(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(a,d,v){for(const S in a)if(S!==v&&(!d||d.indexOf(S)<0))return!0;return!1}handleWindowEvent(a){this.handleEvent(a,`${a.type}Window`)}_getMapTouches(a){const d=[];for(const v of a)this._el.contains(v.target)&&d.push(v);return d}handleEvent(a,d){this._updatingCamera=!0;const v=a.type==="renderFrame",S=v?void 0:a,A={needsRenderFrame:!1},P={},O={},I=a.touches?this._getMapTouches(a.touches):void 0,H=I?Ce(this._el,I):v?void 0:ye(this._el,a);for(const{handlerName:J,handler:re,allowed:de}of this._handlers){if(!re.isEnabled())continue;let ce;this._blockedByActive(O,de,J)?re.reset():re[d||a.type]&&(ce=re[d||a.type](a,H,I),this.mergeHandlerResult(A,P,ce,J,S),ce&&ce.needsRenderFrame&&this._triggerRenderFrame()),(ce||re.isActive())&&(O[J]=re)}const G={};for(const J in this._previousActiveHandlers)O[J]||(G[J]=S);this._previousActiveHandlers=O,(Object.keys(G).length||Ro(A))&&(this._changes.push([A,P,G]),this._triggerRenderFrame()),(Object.keys(O).length||Ro(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ne}=A;ne&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ne(this._map))}mergeHandlerResult(a,d,v,S,A){if(!v)return;s.h(a,v);const P={handlerName:S,originalEvent:v.originalEvent||A};v.zoomDelta!==void 0&&(d.zoom=P),v.panDelta!==void 0&&(d.drag=P),v.pitchDelta!==void 0&&(d.pitch=P),v.bearingDelta!==void 0&&(d.rotate=P)}_applyChanges(){const a={},d={},v={};for(const[S,A,P]of this._changes)S.panDelta&&(a.panDelta=(a.panDelta||new s.P(0,0))._add(S.panDelta)),S.zoomDelta&&(a.zoomDelta=(a.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(a.bearingDelta=(a.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(a.pitchDelta=(a.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(a.around=S.around),S.aroundCoord!==void 0&&(a.aroundCoord=S.aroundCoord),S.pinchAround!==void 0&&(a.pinchAround=S.pinchAround),S.noInertia&&(a.noInertia=S.noInertia),s.h(d,A),s.h(v,P);this._updateMapTransform(a,d,v),this._changes=[]}_updateMapTransform(a,d,v){const S=this._map,A=S.transform,P=be=>[be.x,be.y,be.z];if((be=>{const Ne=this._eventsInProgress.drag;return Ne&&!this._handlersById[Ne.handlerName].isActive()})()&&!Ro(a)){const be=A.zoom;A.cameraElevationReference="sea",this._originalZoom!=null&&A._orthographicProjectionAtLowPitch&&A.projection.name!=="globe"&&A.pitch===0?(A.cameraElevationReference="ground",A.zoom=this._originalZoom):(A.recenterOnTerrain(),A.cameraElevationReference="ground"),be!==A.zoom&&this._map._update(!0)}if(A._isCameraConstrained&&S._stop(!0),!Ro(a))return void this._fireEvents(d,v,!0);let{panDelta:O,zoomDelta:I,bearingDelta:H,pitchDelta:G,around:ne,aroundCoord:J,pinchAround:re}=a;A._isCameraConstrained&&(I>0&&(I=0),A._isCameraConstrained=!1),re!==void 0&&(ne=re),(I||(be=>d[be]&&!this._eventsInProgress[be])("drag"))&&ne&&(this._dragOrigin=P(A.pointCoordinate3D(ne)),this._originalZoom=A.zoom,this._trackingEllipsoid.setup(A._camera.position,this._dragOrigin)),A.cameraElevationReference="sea",S._stop(!0),ne=ne||S.transform.centerPoint,H&&(A.bearing+=H),G&&(A.pitch+=G),A._updateCameraState();const de=[0,0,0];if(O)if(A.projection.name==="mercator"){const be=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(ne).dir),Ne=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(ne.sub(O)).dir);de[0]=Ne[0]-be[0],de[1]=Ne[1]-be[1]}else{const be=A.pointCoordinate(ne);if(A.projection.name==="globe"){O=O.rotate(-A.angle);const Ne=A._pixelsPerMercatorPixel/A.worldSize;de[0]=-O.x*s.eL(s.aY(be.y))*Ne,de[1]=-O.y*s.eL(A.center.lat)*Ne}else{const Ne=A.pointCoordinate(ne.sub(O));be&&Ne&&(de[0]=Ne.x-be.x,de[1]=Ne.y-be.y)}}const ce=A.zoom,pe=[0,0,0];if(I){const be=P(J||A.pointCoordinate3D(ne)),Ne={dir:s.au([],s.at([],be,A._camera.position))};if(Ne.dir[2]<0){const De=A.zoomDeltaToMovement(be,I);s.c1(pe,Ne.dir,De)}}const me=s.d5(de,de,pe);A._translateCameraConstrained(me),I&&Math.abs(A.zoom-ce)>1e-4&&A.recenterOnTerrain(),A.cameraElevationReference="ground",this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(d,v,!0)}_fireEvents(a,d,v){const S=wp(this._eventsInProgress),A=wp(a),P={};for(const G in a){const{originalEvent:ne}=a[G];this._eventsInProgress[G]||(P[`${G}start`]=ne),this._eventsInProgress[G]=a[G]}!S&&A&&this._fireEvent("movestart",A.originalEvent);for(const G in P)this._fireEvent(G,P[G]);A&&this._fireEvent("move",A.originalEvent);for(const G in a){const{originalEvent:ne}=a[G];this._fireEvent(G,ne)}const O={};let I;for(const G in this._eventsInProgress){const{handlerName:ne,originalEvent:J}=this._eventsInProgress[G];this._handlersById[ne].isActive()||(delete this._eventsInProgress[G],I=d[ne]||J,O[`${G}end`]=I)}for(const G in O)this._fireEvent(G,O[G]);const H=wp(this._eventsInProgress);if(v&&(S||A)&&!H){this._updatingCamera=!0;const G=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ne=J=>J!==0&&-this._bearingSnap<J&&J<this._bearingSnap;G?(ne(G.bearing||this._map.getBearing())&&(G.bearing=0),this._map.easeTo(G,{originalEvent:I})):(this._map.fire(new s.A("moveend",{originalEvent:I})),ne(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(a,d){this._map.fire(new s.A(a,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((a=>{this._frameId=void 0,this.handleEvent(new Qm("renderFrame",{timeStamp:a})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ra="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class mu extends s.E{constructor(a,d){super(),this._moving=!1,this._zooming=!1,this.transform=a,this._bearingSnap=d.bearingSnap,this._respectPrefersReducedMotion=d.respectPrefersReducedMotion!==!1,s.aV(["_renderFrameCallback"],this)}getCenter(){return new s.ci(this.transform.center.lng,this.transform.center.lat)}setCenter(a,d){return this.jumpTo({center:a},d)}panBy(a,d,v){return a=s.P.convert(a).mult(-1),this.panTo(this.transform.center,s.h({offset:a},d),v)}panTo(a,d,v){return this.easeTo(s.h({center:a},d),v)}getZoom(){return this.transform.zoom}setZoom(a,d){return this.jumpTo({zoom:a},d),this}zoomTo(a,d,v){return this.easeTo(s.h({zoom:a},d),v)}zoomIn(a,d){return this.zoomTo(this.getZoom()+1,a,d),this}zoomOut(a,d){return this.zoomTo(this.getZoom()-1,a,d),this}getBearing(){return this.transform.bearing}setBearing(a,d){return this.jumpTo({bearing:a},d),this}getPadding(){return this.transform.padding}setPadding(a,d){return this.jumpTo({padding:a},d),this}rotateTo(a,d,v){return this.easeTo(s.h({bearing:a},d),v)}resetNorth(a,d){return this.rotateTo(0,s.h({duration:1e3},a),d),this}resetNorthPitch(a,d){return this.easeTo(s.h({bearing:0,pitch:0,duration:1e3},a),d),this}snapToNorth(a,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,d):this}getPitch(){return this.transform.pitch}setPitch(a,d){return this.jumpTo({pitch:a},d),this}cameraForBounds(a,d){a=s.aG.convert(a);const v=d&&d.bearing||0,S=d&&d.pitch||0,A=a.getNorthWest(),P=a.getSouthEast();return this._cameraForBounds(this.transform,A,P,v,S,d)}_extendPadding(a){const d={top:0,right:0,bottom:0,left:0};return a==null?s.h({},d,this.transform.padding):typeof a=="number"?{top:a,bottom:a,right:a,left:a}:s.h({},d,a)}_extendCameraOptions(a){return(a=s.h({offset:[0,0],maxZoom:this.transform.maxZoom},a)).padding=this._extendPadding(a.padding),a}_minimumAABBFrustumDistance(a,d){const v=d.max[0]-d.min[0],S=d.max[1]-d.min[1];return v/S>a.aspect?v/(2*Math.tan(.5*a.fovX)*a.aspect):S/(2*Math.tan(.5*a.fovY)*a.aspect)}_cameraForBoundsOnGlobe(a,d,v,S,A,P){const O=a.clone(),I=this._extendCameraOptions(P);O.bearing=S,O.pitch=A;const H=s.ci.convert(d),G=s.ci.convert(v),ne=.5*(H.lat+G.lat),J=.5*(H.lng+G.lng),re=s.eO(ne,J),de=s.au([],re),ce=s.au([],s.bF([],de,[0,1,0])),pe=s.bF([],ce,de),me=[ce[0],ce[1],ce[2],0,pe[0],pe[1],pe[2],0,de[0],de[1],de[2],0,0,0,0,1],be=[re,s.eO(H.lat,H.lng),s.eO(G.lat,H.lng),s.eO(G.lat,G.lng),s.eO(H.lat,G.lng),s.eO(ne,H.lng),s.eO(ne,G.lng),s.eO(H.lat,J),s.eO(G.lat,J)];let Ne=s.d6.fromPoints(be.map((At=>[s.bG(ce,At),s.bG(pe,At),s.bG(de,At)])));const De=s.ad([],Ne.center,me);s.eP(De)===0&&s.eQ(De,0,0,1),s.au(De,De),s.c1(De,De,s.aB),O.center=s.eR(De);const Be=O.getWorldToCameraMatrix(),Ze=s.bi(new Float64Array(16),Be);Ne=s.d6.applyTransform(Ne,s.az([],Be,me));const Ye=this._extendAABB(Ne,O,I,S);if(!Ye)return void s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ne=Ye,s.ad(De,De,Be);const Ue=.5*(Ne.max[2]-Ne.min[2]),qe=this._minimumAABBFrustumDistance(O,Ne),Ge=s.c1([],[0,0,1],Ue),_t=s.d5(Ge,De,Ge),ct=qe+(O.pitch===0?0:s.bD(De,_t)),Bt=O.globeCenterInViewSpace,Ct=s.at([],De,[Bt[0],Bt[1],Bt[2]]);s.au(Ct,Ct),s.c1(Ct,Ct,ct);const Xt=s.d5([],De,Ct);s.ad(Xt,Xt,Ze);const gn=s.eB/s.aB,wt=s.ae(Xt),at=s.cb(Math.max(wt*gn-s.eB,Number.EPSILON),0),Dt=Math.min(O.zoomFromMercatorZAdjusted(at),I.maxZoom);return Dt>.5*(s.cX+s.cI)?(O.setProjection({name:"mercator"}),O.zoom=Dt,this._cameraForBounds(O,d,v,S,A,P)):{center:O.center,zoom:Dt,bearing:S,pitch:A}}_extendAABB(a,d,v,S){const A=.5*((v.padding.left||0)+(v.padding.right||0)),P=.5*((v.padding.top||0)+(v.padding.bottom||0)),O=P,I=A,H=A,G=P,ne=d.width-(I+H),J=d.height-(O+G),re=s.at([],a.max,a.min),de=Math.min(ne/re[0],J/re[1]),ce=Math.min(d.scaleZoom(d.scale*de),v.maxZoom);if(isNaN(ce))return null;const pe=d.scale/d.zoomScale(ce),me=new s.d6([a.min[0]-I*pe,a.min[1]-G*pe,a.min[2]],[a.max[0]+H*pe,a.max[1]+O*pe,a.max[2]]),be=(typeof v.offset.x=="number"&&typeof v.offset.y=="number"?new s.P(v.offset.x,v.offset.y):s.P.convert(v.offset)).rotate(-s.al(S));return me.center[0]-=be.x*pe,me.center[1]+=be.y*pe,me}queryTerrainElevation(a,d){const v=this.transform.elevation;return v?(d=s.h({},{exaggerated:!0},d),v.getAtPoint(s.ac.fromLngLat(a),null,d.exaggerated)):null}_cameraForBounds(a,d,v,S,A,P){if(a.projection.name==="globe")return this._cameraForBoundsOnGlobe(a,d,v,S,A,P);const O=a.clone(),I=this._extendCameraOptions(P);O.bearing=S,O.pitch=A;const H=s.ci.convert(d),G=s.ci.convert(v),ne=new s.ci(H.lng,G.lat),J=new s.ci(G.lng,H.lat),re=O.project(H),de=O.project(G),ce=this.queryTerrainElevation(H),pe=this.queryTerrainElevation(G),me=this.queryTerrainElevation(ne),be=this.queryTerrainElevation(J),Ne=[[re.x,re.y,Math.min(ce||0,pe||0,me||0,be||0)],[de.x,de.y,Math.max(ce||0,pe||0,me||0,be||0)]];let De=s.d6.fromPoints(Ne);const Be=O.getWorldToCameraMatrix(),Ze=s.bi(new Float64Array(16),Be);De=s.d6.applyTransform(De,Be);const Ye=this._extendAABB(De,O,I,S);if(!Ye)return void s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");De=Ye;const Ue=.5*s.at([],De.max,De.min)[2],qe=this._minimumAABBFrustumDistance(O,De),Ge=[0,0,1,0];s.aA(Ge,Ge,Be),s.eS(Ge,Ge);const _t=s.c1([],Ge,qe+Ue),ct=s.d5([],De.center,_t);s.ad(De.center,De.center,Ze),s.ad(ct,ct,Ze);const Bt=O.unproject(new s.P(De.center[0],De.center[1])),Ct=s.eT(O.projection,Bt),Xt=Math.pow(2,Ct),gn=Math.min(O._zoomFromMercatorZ(ct[2]*O.pixelsPerMeter*Xt/O.worldSize),I.maxZoom);return O.mercatorFromTransition&&gn<.5*(s.cX+s.cI)?(O.setProjection({name:"globe"}),O.zoom=gn,this._cameraForBounds(O,d,v,S,A,P)):{center:Bt,zoom:gn,bearing:S,pitch:A}}fitBounds(a,d,v){const S=this.cameraForBounds(a,d);return this._fitInternal(S,d,v)}fitScreenCoordinates(a,d,v,S,A){const P=s.P.convert(a),O=s.P.convert(d),I=new s.P(Math.min(P.x,O.x),Math.min(P.y,O.y)),H=new s.P(Math.max(P.x,O.x),Math.max(P.y,O.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(P,O))return this;const G=this.transform.pointLocation3D(I),ne=this.transform.pointLocation3D(H),J=this.transform.pointLocation3D(new s.P(I.x,H.y)),re=this.transform.pointLocation3D(new s.P(H.x,I.y)),de=[Math.min(G.lng,ne.lng,J.lng,re.lng),Math.min(G.lat,ne.lat,J.lat,re.lat)],ce=[Math.max(G.lng,ne.lng,J.lng,re.lng),Math.max(G.lat,ne.lat,J.lat,re.lat)],pe=S&&S.pitch?S.pitch:this.getPitch(),me=this._cameraForBounds(this.transform,de,ce,v,pe,S);return this._fitInternal(me,S,A)}_fitInternal(a,d,v){return a?(d=s.h(a,d)).linear?this.easeTo(d,v):this.flyTo(d,v):this}jumpTo(a,d){this.stop();const v=a.preloadOnly?this.transform.clone():this.transform;let S=!1,A=!1,P=!1;"zoom"in a&&v.zoom!==+a.zoom&&(S=!0,v.zoom=+a.zoom),a.center!==void 0&&(v.center=s.ci.convert(a.center)),"bearing"in a&&v.bearing!==+a.bearing&&(A=!0,v.bearing=+a.bearing),"pitch"in a&&v.pitch!==+a.pitch&&(P=!0,v.pitch=+a.pitch);const O=typeof a.padding=="number"?this._extendPadding(a.padding):a.padding;if(a.padding!=null&&!v.isPaddingEqual(O))if(a.retainPadding===!1){const I=v.clone();I.padding=O,v.setLocationAtPoint(v.center,I.centerPoint)}else v.padding=O;return a.preloadOnly?(this._preloadTiles(v),this):(this.fire(new s.A("movestart",d)).fire(new s.A("move",d)),S&&this.fire(new s.A("zoomstart",d)).fire(new s.A("zoom",d)).fire(new s.A("zoomend",d)),A&&this.fire(new s.A("rotatestart",d)).fire(new s.A("rotate",d)).fire(new s.A("rotateend",d)),P&&this.fire(new s.A("pitchstart",d)).fire(new s.A("pitch",d)).fire(new s.A("pitchend",d)),this.fire(new s.A("moveend",d)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.w(Ra),this.transform.getFreeCameraOptions()}setFreeCameraOptions(a,d){const v=this.transform;if(!v.projection.supportsFreeCamera)return s.w(Ra),this;this.stop();const S=v.zoom,A=v.pitch,P=v.bearing;v.setFreeCameraOptions(a);const O=S!==v.zoom,I=A!==v.pitch,H=P!==v.bearing;return this.fire(new s.A("movestart",d)).fire(new s.A("move",d)),O&&this.fire(new s.A("zoomstart",d)).fire(new s.A("zoom",d)).fire(new s.A("zoomend",d)),H&&this.fire(new s.A("rotatestart",d)).fire(new s.A("rotate",d)).fire(new s.A("rotateend",d)),I&&this.fire(new s.A("pitchstart",d)).fire(new s.A("pitch",d)).fire(new s.A("pitchend",d)),this.fire(new s.A("moveend",d)),this}easeTo(a,d){this._stop(!1,a.easeId),((a=s.h({offset:[0,0],duration:500,easing:s.eK},a)).animate===!1||this._prefersReducedMotion(a))&&(a.duration=0);const v=this.transform,S=this.getZoom(),A=this.getBearing(),P=this.getPitch(),O=this.getPadding(),I="zoom"in a?+a.zoom:S,H="bearing"in a?this._normalizeBearing(a.bearing,A):A,G="pitch"in a?+a.pitch:P,ne=this._extendPadding(a.padding),J=s.P.convert(a.offset);let re,de,ce;if(v.projection.name==="globe"){const Ge=s.ac.fromLngLat(v.center),_t=J.rotate(-v.angle);Ge.x+=_t.x/v.worldSize,Ge.y+=_t.y/v.worldSize;const ct=Ge.toLngLat(),Bt=s.ci.convert(a.center||ct);this._normalizeCenter(Bt),re=v.centerPoint.add(_t),de=new s.P(Ge.x,Ge.y).mult(v.worldSize),ce=new s.P(s.aD(Bt.lng),s.aH(Bt.lat)).mult(v.worldSize).sub(de)}else{re=v.centerPoint.add(J);const Ge=v.pointLocation(re),_t=s.ci.convert(a.center||Ge);this._normalizeCenter(_t),de=v.project(Ge),ce=v.project(_t).sub(de)}const pe=v.zoomScale(I-S);let me,be;a.around&&(me=s.ci.convert(a.around),be=v.locationPoint(me));const Ne=this._zooming||I!==S,De=this._rotating||A!==H,Be=this._pitching||G!==P,Ze=!v.isPaddingEqual(ne),Ye=a.retainPadding===!1?v.clone():v,Ue=Ge=>_t=>{if(Ne&&(Ge.zoom=s.ai(S,I,_t)),De&&(Ge.bearing=s.ai(A,H,_t)),Be&&(Ge.pitch=s.ai(P,G,_t)),Ze&&(Ye.interpolatePadding(O,ne,_t),re=Ye.centerPoint.add(J)),me)Ge.setLocationAtPoint(me,be);else{const ct=Ge.zoomScale(Ge.zoom-S),Bt=I>S?Math.min(2,pe):Math.max(.5,pe),Ct=Math.pow(Bt,1-_t),Xt=Ge.unproject(de.add(ce.mult(_t*Ct)).mult(ct));Ge.setLocationAtPoint(Ge.renderWorldCopies?Xt.wrap():Xt,re)}return a.preloadOnly||this._fireMoveEvents(d),Ge};if(a.preloadOnly){const Ge=this._emulate(Ue,a.duration,v);return this._preloadTiles(Ge),this}const qe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ne,this._rotating=De,this._pitching=Be,this._padding=Ze,this._easeId=a.easeId,this._prepareEase(d,a.noMoveStart,qe),this._ease(Ue(v),(Ge=>{v.cameraElevationReference==="sea"&&v.recenterOnTerrain(),this._afterEase(d,Ge)}),a),this}_prepareEase(a,d,v={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),d||v.moving||this.fire(new s.A("movestart",a)),this._zooming&&!v.zooming&&this.fire(new s.A("zoomstart",a)),this._rotating&&!v.rotating&&this.fire(new s.A("rotatestart",a)),this._pitching&&!v.pitching&&this.fire(new s.A("pitchstart",a))}_fireMoveEvents(a){this.fire(new s.A("move",a)),this._zooming&&this.fire(new s.A("zoom",a)),this._rotating&&this.fire(new s.A("rotate",a)),this._pitching&&this.fire(new s.A("pitch",a))}_afterEase(a,d){if(this._easeId&&d&&this._easeId===d)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const v=this._zooming,S=this._rotating,A=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,v&&this.fire(new s.A("zoomend",a)),S&&this.fire(new s.A("rotateend",a)),A&&this.fire(new s.A("pitchend",a)),this.fire(new s.A("moveend",a))}flyTo(a,d){if(this._prefersReducedMotion(a)){const At=s.aF(a,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(At,d)}this.stop(),a=s.h({offset:[0,0],speed:1.2,curve:1.42,easing:s.eK},a);const v=this.transform,S=this.getZoom(),A=this.getBearing(),P=this.getPitch(),O=this.getPadding(),I="zoom"in a?s.ay(+a.zoom,v.minZoom,v.maxZoom):S,H="bearing"in a?this._normalizeBearing(a.bearing,A):A,G="pitch"in a?+a.pitch:P,ne=this._extendPadding(a.padding),J=v.zoomScale(I-S),re=s.P.convert(a.offset);let de=v.centerPoint.add(re);const ce=v.pointLocation(de),pe=s.ci.convert(a.center||ce);this._normalizeCenter(pe);const me=v.project(ce),be=v.project(pe).sub(me);let Ne=a.curve;const De=Math.max(v.width,v.height),Be=De/J,Ze=be.mag();if("minZoom"in a){const At=s.ay(Math.min(a.minZoom,S,I),v.minZoom,v.maxZoom),Gt=De/v.zoomScale(At-S);Ne=Math.sqrt(Gt/Ze*2)}const Ye=Ne*Ne;function Ue(At){const Gt=(Be*Be-De*De+(At?-1:1)*Ye*Ye*Ze*Ze)/(2*(At?Be:De)*Ye*Ze);return Math.log(Math.sqrt(Gt*Gt+1)-Gt)}function qe(At){return(Math.exp(At)-Math.exp(-At))/2}function Ge(At){return(Math.exp(At)+Math.exp(-At))/2}const _t=Ue(0);let ct=function(At){return Ge(_t)/Ge(_t+Ne*At)},Bt=function(At){return De*((Ge(_t)*(qe(Gt=_t+Ne*At)/Ge(Gt))-qe(_t))/Ye)/Ze;var Gt},Ct=(Ue(1)-_t)/Ne;if(Math.abs(Ze)<1e-6||!isFinite(Ct)){if(Math.abs(De-Be)<1e-6)return this.easeTo(a,d);const At=Be<De?-1:1;Ct=Math.abs(Math.log(Be/De))/Ne,Bt=function(){return 0},ct=function(Gt){return Math.exp(At*Ne*Gt)}}a.duration="duration"in a?+a.duration:1e3*Ct/("screenSpeed"in a?+a.screenSpeed/Ne:+a.speed),a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0);const Xt=A!==H,gn=G!==P,wt=!v.isPaddingEqual(ne),at=a.retainPadding===!1?v.clone():v,Dt=At=>Gt=>{const Yt=Gt*Ct,Ht=1/ct(Yt);At.zoom=Gt===1?I:S+At.scaleZoom(Ht),Xt&&(At.bearing=s.ai(A,H,Gt)),gn&&(At.pitch=s.ai(P,G,Gt)),wt&&(at.interpolatePadding(O,ne,Gt),de=at.centerPoint.add(re));const en=Gt===1?pe:At.unproject(me.add(be.mult(Bt(Yt))).mult(Ht));return At.setLocationAtPoint(At.renderWorldCopies?en.wrap():en,de),At._updateCameraOnTerrain(),a.preloadOnly||this._fireMoveEvents(d),At};if(a.preloadOnly){const At=this._emulate(Dt,a.duration,v);return this._preloadTiles(At),this}return this._zooming=!0,this._rotating=Xt,this._pitching=gn,this._padding=wt,this._prepareEase(d,!1),this._ease(Dt(v),(()=>this._afterEase(d)),a),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(a){}_cancelRenderFrame(a){}_stop(a,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const v=this._onEaseEnd;this._onEaseEnd=void 0,v.call(this,d)}if(!a){const v=this.handlers;v&&v.stop(!1)}return this}_ease(a,d,v){v.animate===!1||v.duration===0?(a(1),d()):(this._easeStart=s.q.now(),this._easeOptions=v,this._onEaseFrame=a,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const a=Math.min((s.q.now()-this._easeStart)/this._easeOptions.duration,1),d=this._onEaseFrame;d&&d(this._easeOptions.easing(a)),a<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(a,d){a=s.bQ(a,-180,180);const v=Math.abs(a-d);return Math.abs(a-360-d)<v&&(a-=360),Math.abs(a+360-d)<v&&(a+=360),a}_normalizeCenter(a){const d=this.transform;if(d.maxBounds||d.projection.name!=="globe"&&!d.renderWorldCopies)return;const v=a.lng-d.center.lng;a.lng+=v>180?-360:v<-180?360:0}_prefersReducedMotion(a){return this._respectPrefersReducedMotion&&s.q.prefersReducedMotion&&!(a&&a.essential)}_emulate(a,d,v){const S=Math.ceil(15*d/1e3),A=[],P=a(v.clone());for(let O=0;O<=S;O++){const I=P(O/S);A.push(I.clone())}return A}_preloadTiles(a,d){}}class ic{constructor(a={}){this.options=a,s.aV(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(a){const d=this.options&&this.options.compact,v=a._getUIString("AttributionControl.ToggleAttribution");this._map=a,this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=B("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",v);const S=B("span","mapboxgl-ctrl-icon",this._compactButton);return S.setAttribute("aria-hidden","true"),S.setAttribute("title",v),this._innerContainer=B("div","mapboxgl-ctrl-attrib-inner",this._container),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),d===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let a=this._editLink;a||(a=this._editLink=this._container.querySelector(".mapbox-improve-map"));const d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.e.ACCESS_TOKEN}];if(a){const v=d.reduce(((S,A,P)=>(A.value&&(S+=`${A.key}=${A.value}${P<d.length-1?"&":""}`),S)),"?");a.href=`${s.e.FEEDBACK_URL}/${v}#${$m(this._map,!0)}`,a.rel="noopener nofollow"}}_updateData(a){!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let a=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const d=this._map.style._mergedSourceCaches;for(const S in d){const A=d[S];if(A.used){const P=A.getSource();P.attribution&&a.indexOf(P.attribution)<0&&a.push(P.attribution)}}a.sort(((S,A)=>S.length-A.length)),a=a.filter(((S,A)=>{for(let P=A+1;P<a.length;P++)if(a[P].indexOf(S)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=[...this.options.customAttribution,...a]:a.unshift(this.options.customAttribution));const v=a.join(" | ");v!==this._attribHTML&&(this._attribHTML=v,a.length?(this._innerContainer.innerHTML=v,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Tp{constructor(){s.aV(["_updateLogo","_updateCompact"],this)}onAdd(a){this._map=a,this._container=B("div","mapboxgl-ctrl");const d=B("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(a){a&&a.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const a=this._map.style._sourceCaches;if(Object.entries(a).length===0)return!0;for(const d in a){const v=a[d].getSource();if(v.hasOwnProperty("mapbox_logo")&&!v.mapbox_logo)return!1}return!0}_updateCompact(){const a=this._container.children;if(a.length){const d=a[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}}}class Ap{constructor(){s.aV(["_onIndoorUpdate"],this)}onAdd(a){return this._map=a,this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._map.indoor.on("indoorupdate",(d=>this._onIndoorUpdate({selectedFloorId:d.selectedFloorId,floors:d.floors}))),this._container}_createButton(a,d){const v=B("button",a,this._container);return v.type="button",v.addEventListener("click",d),v}_setButtonTitle(a,d){this._map&&(a.setAttribute("aria-label",d),a.innerHTML=`<strong>${d}</strong>`,a.firstElementChild&&a.firstElementChild.setAttribute("title",d))}onRemove(){this._container&&this._container.remove(),this._map&&this._map.indoor&&(this._map.indoor.off("indoorupdate",this._onIndoorUpdate),this._map=null)}getDefaultPosition(){return"right"}_onIndoorUpdate(a){if(!a||!a.floors)return void(this._container.style.display="none");const d=this._model;this._model=a,this._container.style.display="inline-block";const v=a.floors.sort(((S,A)=>S.levelOrder-A.levelOrder));d?(Array.from(this._container.children).forEach((S=>S.remove())),this.addCurrentFloors(v)):this.addCurrentFloors(v)}addCurrentFloors(a){for(const d of a){const v=this._createButton("mapboxgl-ctrl-level-button",(()=>{this._map._selectIndoorFloor(d.id),Array.from(this._container.children).forEach((S=>{S.classList.remove("mapboxgl-ctrl-level-button-selected")})),v.classList.add("mapboxgl-ctrl-level-button-selected")}));this._setButtonTitle(v,d.shortName),this._model&&d.id===this._model.selectedFloorId&&(this._map._selectIndoorFloor(d.id),v.classList.add("mapboxgl-ctrl-level-button-selected")),this._container.append(v)}}}class jp{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(a){const d=++this._id;return this._queue.push({callback:a,id:d,cancelled:!1}),d}remove(a){const d=this._currentlyRunning,v=d?this._queue.concat(d):this._queue;for(const S of v)if(S.id===a)return void(S.cancelled=!0)}run(a=0){const d=this._currentlyRunning=this._queue;this._queue=[];for(const v of d)if(!v.cancelled&&(v.callback(a),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Oa{constructor(a){this.jumpTo(a)}getValue(a){if(a<=this._startTime)return this._start;if(a>=this._endTime)return this._end;const d=s.dx((a-this._startTime)/(this._endTime-this._startTime));return this._start*(1-d)+this._end*d}isEasing(a){return a>=this._startTime&&a<=this._endTime}jumpTo(a){this._startTime=-1/0,this._endTime=-1/0,this._start=a,this._end=a}easeTo(a,d,v){this._start=this.getValue(d),this._end=a,this._startTime=d,this._endTime=d+v}}const nw={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class E_ extends s.A{constructor(a,d,v,S){const{point:A,lngLat:P,originalEvent:O,target:I}=a;super(a.type,{point:A,lngLat:P,originalEvent:O,target:I}),this.preventDefault=()=>{a.preventDefault()},this.id=d,this.interaction=v,this.feature=S}}class xy{constructor(a){this.map=a,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(a,d){if(this.typeById.has(a))throw new Error(`Interaction id "${a}" already exists.`);const v=d.filter;let S=d.type;v&&this.filters.set(a,s.b3(v)),S==="mouseover"&&(S="mouseenter"),S==="mouseout"&&(S="mouseleave");const A=this.interactionsByType.get(S)||new Map;S==="mouseenter"||S==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(a,d)):A.size===0&&this.map.on(S,this.handleType),A.size===0&&this.interactionsByType.set(S,A),A.set(a,d),this.typeById.set(a,S)}get(a){const d=this.typeById.get(a);if(!d)return;const v=this.interactionsByType.get(d);return v?v.get(a):void 0}remove(a){const d=this.typeById.get(a);if(!d)return;this.typeById.delete(a),this.filters.delete(a);const v=this.interactionsByType.get(d);v&&(v.delete(a),d==="mouseenter"||d==="mouseleave"?(this.delegatedInteractions.delete(a),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):v.size===0&&this.map.off(d,this.handleType))}queryTargets(a,d){const v=[];for(const[S,A]of d)A.target&&v.push({targetId:S,target:A.target,filter:this.filters.get(S)});return this.map.style.queryRenderedTargets(a,v,this.map.transform)}handleMove(a){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const d=this.queryTargets(a.point,Array.from(this.delegatedInteractions).reverse());d.length&&(a.type="mouseenter",this.handleType(a,d));const v=new Map;for(const[S,{feature:A}]of this.prevHoveredFeatures)this.hoveredFeatures.has(S)||v.set(A.id,A);v.size&&(a.type="mouseleave",this.handleType(a,Array.from(v.values())))}handleOut(a){const d=Array.from(this.hoveredFeatures.values()).map((({feature:v})=>v));d.length&&(a.type="mouseleave",this.handleType(a,d)),this.hoveredFeatures.clear()}handleType(a,d){const v=a.type==="mouseenter";if(v&&!this.interactionsByType.has(a.type))return void s.w("mouseenter interaction required for mouseleave to work.");const S=Array.from(this.interactionsByType.get(a.type)).reverse(),A=!!d;d=d||this.queryTargets(a.point,S);let P=!1;const O=new Set;for(const I of d){for(const[H,G]of S){if(!G.target)continue;const ne=I.variants?I.variants[H]:null;if(ne){for(const J of ne){if(Nu(J,I,O,H))continue;const re=new s.dr(I,J),de=hc(J,I,H);A&&(re.state=this.map.getFeatureState(re));const ce=v?this.prevHoveredFeatures.get(de):null,pe=new E_(a,H,G,re),me=ce?ce.stop:G.handler(pe);if(v&&this.hoveredFeatures.set(de,{feature:I,stop:me}),me!==!1){P=!0;break}}if(P)break}}if(P)break}if(!P)for(const[I,H]of S){const{handler:G,target:ne}=H;if(!ne&&G(new E_(a,I,H,null))!==!1)break}}}function pf(y,a){if(Array.isArray(y)&&Array.isArray(a)){const d=new Set(y),v=new Set(a);return d.size===v.size&&y.every((S=>v.has(S)))}return s.bv(y,a)}const Gc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},mf={showCompass:!0,showZoom:!0,visualizePitch:!1};class Wu{constructor(a,d,v=!1){this._clickTolerance=10,this.element=d,this.mouseRotate=new Xm({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,v&&(this.mousePitch=new py({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),s.aV(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),d.addEventListener("mousedown",this.mousedown),d.addEventListener("touchstart",this.touchstart,{passive:!1}),d.addEventListener("touchmove",this.touchmove),d.addEventListener("touchend",this.touchend),d.addEventListener("touchcancel",this.reset)}down(a,d){this.mouseRotate.mousedown(a,d),this.mousePitch&&this.mousePitch.mousedown(a,d),ae()}move(a,d){const v=this.map,S=this.mouseRotate.mousemoveWindow(a,d),A=S&&S.bearingDelta;if(A&&v.setBearing(v.getBearing()+A),this.mousePitch){const P=this.mousePitch.mousemoveWindow(a,d),O=P&&P.pitchDelta;O&&v.setPitch(v.getPitch()+O)}}off(){const a=this.element;a.removeEventListener("mousedown",this.mousedown),a.removeEventListener("touchstart",this.touchstart),a.removeEventListener("touchmove",this.touchmove),a.removeEventListener("touchend",this.touchend),a.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Z(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(a){this.down(s.h({},a,{ctrlKey:!0,preventDefault:()=>a.preventDefault()}),ye(this.element,a)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(a){this.move(a,ye(this.element,a))}mouseup(a){this.mouseRotate.mouseupWindow(a),this.mousePitch&&this.mousePitch.mouseupWindow(a),this.offTemp()}touchstart(a){a.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ce(this.element,a.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>a.preventDefault()},this._startPos))}touchmove(a){a.targetTouches.length!==1?this.reset():(this._lastPos=Ce(this.element,a.targetTouches)[0],this.move({preventDefault:()=>a.preventDefault()},this._lastPos))}touchend(a){a.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Sl(y,a,d){if(y=new s.ci(y.lng,y.lat),a){const v=new s.ci(y.lng-360,y.lat),S=new s.ci(y.lng+360,y.lat),A=360*Math.ceil(Math.abs(y.lng-d.center.lng)/360),P=d.locationPoint3D(y).distSqr(a),O=a.x<0||a.y<0||a.x>d.width||a.y>d.height;d.locationPoint3D(v).distSqr(a)<P&&(O||Math.abs(v.lng-d.center.lng)<A)?y=v:d.locationPoint3D(S).distSqr(a)<P&&(O||Math.abs(S.lng-d.center.lng)<A)&&(y=S)}for(;Math.abs(y.lng-d.center.lng)>180;){const v=d.locationPoint3D(y);if(v.x>=0&&v.y>=0&&v.x<=d.width&&v.y<=d.height)break;y.lng>d.center.lng?y.lng-=360:y.lng+=360}return y}const po={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},ol={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class Ul extends s.E{constructor(a,d){super(),(a instanceof HTMLElement||d)&&(a=s.h({element:a},d)),s.aV(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:v="center",color:S="#3FB1CE",scale:A=1,draggable:P=!1,clickTolerance:O=0,rotation:I=ol.rotation,rotationAlignment:H=ol.rotationAlignment,pitchAlignment:G=ol.pitchAlignment,occludedOpacity:ne=ol.occludedOpacity,altitude:J=ol.altitude}=a||{};this._anchor=v,this._color=S,this._scale=A,this._draggable=P,this._clickTolerance=O,this._rotation=I,this._rotationAlignment=H,this._pitchAlignment=G,this._occludedOpacity=ne,this._altitude=J,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),a&&a.element?(this._element=a.element,this._offset=s.P.convert(a&&a.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=s.P.convert(a&&a.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(ce=>{ce.preventDefault()})),this._element.addEventListener("mousedown",(ce=>{ce.preventDefault()}));const re=this._element.classList;for(const ce in po)re.remove(`mapboxgl-marker-anchor-${ce}`);re.add(`mapboxgl-marker-anchor-${this._anchor}`);const de=a&&a.className?a.className.trim().split(/\s+/):[];re.add(...de),this._popup=null}_createDefaultMarker(){const a=B("div"),d=F("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},a);if(this._altitude===0){const v=F("radialGradient",{id:"shadowGradient"},F("defs",{},d));F("stop",{offset:"10%","stop-opacity":.4},v),F("stop",{offset:"100%","stop-opacity":.05},v),F("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},d)}return F("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},d),F("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},d),F("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},d),a}addTo(a){return a===this._map||(this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._updateMoving),a.on("moveend",this._update),a.on("remove",this._clearFadeTimer),a._addMarker(this),this.setDraggable(this._draggable),this._update(),a.on("click",this._onMapClick)),this}remove(){const a=this._map;return a&&(a.off("click",this._onMapClick),a.off("move",this._updateMoving),a.off("moveend",this._update),a.off("mousedown",this._addDragHandler),a.off("touchstart",this._addDragHandler),a.off("mouseup",this._onUp),a.off("touchend",this._onUp),a.off("mousemove",this._onMove),a.off("touchmove",this._onMove),a.off("remove",this._clearFadeTimer),a._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(a){return this._lngLat=s.ci.convert(a),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(a){return a===this._altitude||(this._defaultMarker&&(this._altitude===0&&a!==0||this._altitude!==0&&a===0)&&(this._element=this._createDefaultMarker()),this._altitude=a||ol.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(a){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),a){if(!("offset"in a.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=a,a._marker=this,a._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(a){const d=a.code,v=a.charCode||a.keyCode;d!=="Space"&&d!=="Enter"&&v!==32&&v!==13||this.togglePopup()}_onMapClick(a){const d=a.originalEvent.target,v=this._element;this._popup&&(d===v||v.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const a=this._popup;return a?(a.isOpen()?(a.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(a.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const a=this._map,d=this._pos;if(!a||!d)return!1;const v=a.unproject(d,this._altitude),S=a.getFreeCameraOptions();if(!S.position)return!1;const A=S.position.toLngLat();return A.distanceTo(v)<.9*A.distanceTo(this._lngLat)}_evaluateOpacity(){const a=this._map;if(!a)return;const d=this._pos;if(!d||d.x<0||d.x>a.transform.width||d.y<0||d.y>a.transform.height)return void this._clearFadeTimer();const v=a.unproject(d,this._altitude);let S;a._showingGlobe()&&s.eW(a.transform,this._lngLat)?S=0:(S=1-a._queryFogOpacity(v),a.transform._terrainEnabled()&&a.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const a=this._pos;if(!a||!this._map)return;const d=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${a.x}px,${a.y}px)
            ${po[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${d.x}px,${d.y}px)
        `}_calculateXYTransform(){const a=this._pos,d=this._map,v=this.getPitchAlignment();if(!d||!a||v!=="map")return"";if(!d._showingGlobe()){const I=d.getPitch();return I?`rotateX(${I}deg)`:""}const S=s.cU(s.eX(d.transform,this._lngLat)),A=a.sub(s.eY(d.transform)),P=Math.abs(A.x)+Math.abs(A.y);if(P===0)return"";const O=S/P;return`rotateX(${-A.y*O}deg) rotateY(${A.x*O}deg)`}_calculateZTransform(){const a=this._pos,d=this._map;if(!d||!a)return"";let v=0;const S=this.getRotationAlignment();if(S==="map")if(d._showingGlobe()){const A=d.project(new s.ci(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),P=d.project(new s.ci(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(A);v=s.cU(Math.atan2(P.y,P.x))-90}else v=-d.getBearing();else if(S==="horizon"){const A=s.af(4,6,d.getZoom()),P=s.eY(d.transform);P.y+=A*d.transform.height;const O=a.sub(P),I=s.cU(Math.atan2(O.y,O.x));v=(I>90?I-270:I+90)*(1-A)}return v+=this._rotation,v?`rotateZ(${v}deg)`:""}_update(a){cancelAnimationFrame(this._updateFrameId);const d=this._map;d&&(d.transform.renderWorldCopies&&(this._lngLat=Sl(this._lngLat,this._pos,d.transform)),this._pos=d.project(this._lngLat,this._altitude),a===!0?this._updateFrameId=requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),d._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(d._showingGlobe()||d.getTerrain()||d.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(a){return this._offset=s.P.convert(a),this._update(),this}addClassName(a){return this._element.classList.add(a),this}removeClassName(a){return this._element.classList.remove(a),this}toggleClassName(a){return this._element.classList.toggle(a)}_onMove(a){const d=this._map;if(!d)return;const v=this._pointerdownPos,S=this._positionDelta;if(v&&S){if(!this._isDragging){const A=this._clickTolerance||d._clickTolerance;if(a.point.dist(v)<A)return;this._isDragging=!0}this._pos=a.point.sub(S),this._lngLat=d.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.A("dragstart"))),this.fire(new s.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const a=this._map;a&&(a.off("mousemove",this._onMove),a.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.A("dragend")),this._state="inactive"}_addDragHandler(a){const d=this._map,v=this._pos;d&&v&&this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(v),this._pointerdownPos=a.point,this._state="pending",d.on("mousemove",this._onMove),d.on("touchmove",this._onMove),d.once("mouseup",this._onUp),d.once("touchend",this._onUp))}setDraggable(a){this._draggable=!!a;const d=this._map;return d&&(a?(d.on("mousedown",this._addDragHandler),d.on("touchstart",this._addDragHandler)):(d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(a){return this._rotation=a||ol.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(a){return this._rotationAlignment=a||ol.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(a){return this._pitchAlignment=a||ol.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(a){return this._occludedOpacity=a||ol.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const C_={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Qv={maxWidth:100,unit:"metric"},ex={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},_y={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},tx=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function qa(y=new s.P(0,0),a="bottom"){if(typeof y=="number"){const d=Math.round(Math.sqrt(.5*Math.pow(y,2)));switch(a){case"top":return new s.P(0,y);case"top-left":return new s.P(d,d);case"top-right":return new s.P(-d,d);case"bottom":return new s.P(0,-y);case"bottom-left":return new s.P(d,-d);case"bottom-right":return new s.P(-d,-d);case"left":return new s.P(y,0);case"right":return new s.P(-y,0)}return new s.P(0,0)}return y instanceof s.P||Array.isArray(y)?s.P.convert(y):s.P.convert(y[a]||[0,0])}return{version:w,supported:$.supported,setRTLTextPlugin:s.f0,getRTLTextPluginStatus:s.e$,Map:class extends mu{constructor(y){E.mark(T.create);const a=y;if((y=s.h({},Gc,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(y.antialias&&s.eU(window)&&(y.antialias=!1,s.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new wv(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies,null,null),y),this._repaint=!!y.repaint,this._interactive=y.interactive,this._minTileCacheSize=y.minTileCacheSize,this._maxTileCacheSize=y.maxTileCacheSize,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=y.crossSourceCollisions,this._collectResourceTiming=y.collectResourceTiming,this._language=this._parseLanguage(y.language),this._worldview=y.worldview,this._renderTaskQueue=new jp,this._domRenderTaskQueue=new jp,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.a$(),this._locale=s.h({},nw,y.locale),this._clickTolerance=y.clickTolerance,this._cooperativeGestures=y.cooperativeGestures,this._performanceMetricsCollection=y.performanceMetricsCollection,this._tessellationStep=y.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=y.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Oa(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=y.scaleFactor,this._requestManager=new Me(y.transformRequest,y.accessToken,y.testMode),this._silenceAuthErrors=!!y.testMode,this._contextCreateOptions=y.contextCreateOptions?Object.assign({},y.contextCreateOptions):{},typeof y.container=="string"){const d=document.getElementById(y.container);if(!d)throw new Error(`Container '${y.container.toString()}' not found.`);this._container=d}else{if(!(y.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(this._container.childNodes.length>0&&s.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),y.maxBounds&&this.setMaxBounds(y.maxBounds),this._spriteFormat=y.spriteFormat,s.aV(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new S_),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},(()=>{this._update()})),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},(()=>{this.setScaleFactor(this._scaleFactor)})),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Sp(this,y),this._localFontFamily=y.localFontFamily,this._localIdeographFontFamily=y.localIdeographFontFamily,(y.style||!y.testMode)&&this.setStyle(y.style||s.e.DEFAULT_STYLE,{config:y.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),y.projection&&this.setProjection(y.projection),this.indoor=new jv(this),y.hash&&(this._hash=new Vm(typeof y.hash=="string"&&y.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){a.center==null&&a.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch});const d=y.bounds;d&&(this.resize(),this.fitBounds(d,s.h({},y.fitBoundsOptions,{duration:0})))}this.resize(),y.attributionControl&&this.addControl(new ic({customAttribution:y.customAttribution})),this._logoControl=new Tp,this.addControl(this._logoControl,y.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()})),this.on("data",(d=>{this._update(d.dataType==="style"),this.fire(new s.A(`${d.dataType}data`,d))})),this.on("dataloading",(d=>{this.fire(new s.A(`${d.dataType}dataloading`,d))})),this._interactions=new xy(this)}_getMapId(){return this._mapId}addControl(y,a){if(a===void 0&&(a=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new s.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=y.onAdd(this);this._controls.push(y);const v=this._controlPositions[a];return a.indexOf("bottom")!==-1?v.insertBefore(d,v.firstChild):v.appendChild(d),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new s.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const a=this._controls.indexOf(y);return a>-1&&this._controls.splice(a,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(y){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const a=!this._moving;return a&&this.fire(new s.A("movestart",y)).fire(new s.A("move",y)),this.fire(new s.A("resize",y)),a&&this.fire(new s.A("moveend",y)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(y){return this.transform.setMaxBounds(s.aG.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y?this.setZoom(y):this.fire(new s.A("zoomstart")).fire(new s.A("zoom")).fire(new s.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y?this.setZoom(y):this.fire(new s.A("zoomstart")).fire(new s.A("zoom")).fire(new s.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y?this.setPitch(y):this.fire(new s.A("pitchstart")).fire(new s.A("pitch")).fire(new s.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y?this.setPitch(y):this.fire(new s.A("pitchstart")).fire(new s.A("pitch")).fire(new s.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(y){return this._scaleFactor=y,this.painter.scaleFactor=y,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers((a=>a.type==="symbol")),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(y){return y==="auto"?navigator.language:Array.isArray(y)?y.length===0?void 0:y.map((a=>a==="auto"?navigator.language:a)):y}setLanguage(y){const a=this._parseLanguage(y);if(!this.style||a===this._language)return this;this._language=a,this.style.reloadSources();for(const d of this._controls)d._setLanguage&&d._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(y){return this.style&&y!==this._worldview?(this._worldview=y,this._styleDirty=!0,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(y){return this._lazyInitEmptyStyle(),y?typeof y=="string"&&(y={name:y}):y=null,this._useExplicitProjection=!!y,this._prioritizeAndUpdateProjection(y,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const y=this.transform,a=y.projection.name;let d;a==="globe"&&y.zoom>=s.cI?(y.setMercatorFromTransition(),d=!0):a==="mercator"&&y.zoom<s.cI&&(y.setProjection({name:"globe"}),d=!0),d&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate(),this._update(!0))}_prioritizeAndUpdateProjection(y,a){return this._updateProjection(y||a||{name:"mercator"})}_updateProjection(y){let a;return a=y.name==="globe"&&this.transform.zoom>=s.cI?this.transform.setMercatorFromTransition():this.transform.setProjection(y),this.style.applyProjectionUpdate(),a&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(y,a){return this.transform.locationPoint3D(s.ci.convert(y),a)}unproject(y,a){return this.transform.pointLocation3D(s.P.convert(y),a)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(y,a,d){const v=S=>{let A=[];if(Array.isArray(a)){const P=a.filter((O=>this.getLayer(O)));A=P.length?this.queryRenderedFeatures(S,{layers:P}):[]}else A=this.queryRenderedFeatures(S,{target:a});return A};if(y==="mouseenter"||y==="mouseover"){let S=!1;return{listener:d,targets:a,delegates:{mousemove:P=>{const O=v(P.point);O.length?S||(S=!0,d.call(this,new ki(y,this,P.originalEvent,{features:O}))):S=!1},mouseout:()=>{S=!1}}}}if(y==="mouseleave"||y==="mouseout"){let S=!1;return{listener:d,targets:a,delegates:{mousemove:O=>{v(O.point).length?S=!0:S&&(S=!1,d.call(this,new ki(y,this,O.originalEvent)))},mouseout:O=>{S&&(S=!1,d.call(this,new ki(y,this,O.originalEvent)))}}}}{const S=A=>{const P=v(A.point);P.length&&(A.features=P,d.call(this,A),delete A.features)};return{listener:d,targets:a,delegates:{[y]:S}}}}on(y,a,d){if(typeof a=="function"||d===void 0)return super.on(y,a);if(typeof a=="string"&&(a=[a]),!this._areTargetsValid(a))return this;const v=this._createDelegatedListener(y,a,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(v);for(const S in v.delegates)this.on(S,v.delegates[S]);return this}once(y,a,d){if(typeof a=="function"||d===void 0)return super.once(y,a);if(typeof a=="string"&&(a=[a]),!this._areTargetsValid(a))return this;const v=this._createDelegatedListener(y,a,d);for(const S in v.delegates)this.once(S,v.delegates[S]);return this}off(y,a,d){if(typeof a=="function"||d===void 0)return super.off(y,a);if(typeof a=="string"&&(a=[a]),!this._areTargetsValid(a))return this;const v=this._delegatedListeners?this._delegatedListeners[y]:void 0;return v&&(S=>{for(let A=0;A<S.length;A++){const P=S[A];if(P.listener===d&&pf(P.targets,a)){for(const O in P.delegates)this.off(O,P.delegates[O]);return S.splice(A,1),this}}})(v),this}queryRenderedFeatures(y,a){if(!this.style)return[];if(y===void 0||y instanceof s.P||Array.isArray(y)||a!==void 0||(a=y,y=void 0),y=y||[[0,0],[this.transform.width,this.transform.height]],!a){const A=this.style.queryRenderedFeatures(y,void 0,this.transform),P=this.style.queryRenderedFeatureset(y,void 0,this.transform);return A.concat(P)}let d=!0;if(a.target&&(d=this._isTargetValid(a.target),d&&!a.layers))return this.style.queryRenderedFeatureset(y,a,this.transform);let v=!0;if(a.layers&&Array.isArray(a.layers)){for(const A of a.layers)if(!this._isValidId(A)){v=!1;break}if(v&&!a.target)return this.style.queryRenderedFeatures(y,a,this.transform)}let S=[];return v&&(S=S.concat(this.style.queryRenderedFeatures(y,a,this.transform))),d&&(S=S.concat(this.style.queryRenderedFeatureset(y,a,this.transform))),S}querySourceFeatures(y,a){return!y||typeof y=="string"&&!this._isValidId(y)?[]:this.style.querySourceFeatures(y,a)}isPointOnSurface(y){const{name:a}=this.transform.projection;return a!=="globe"&&a!=="mercator"&&s.w(`${a} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(s.P.convert(y))}addInteraction(y,a){return this._interactions.add(y,a),this}removeInteraction(y){return this._interactions.remove(y),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(y){return this._cooperativeGestures=y,this}setStyle(y,a){return a=s.h({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},a),this.style&&y&&a.diff!==!1&&a.localFontFamily===this._localFontFamily&&a.localIdeographFontFamily===this._localIdeographFontFamily&&!a.config?(this.style._diffStyle(y,((d,v)=>{if(d){const S=typeof d=="string"?d:d instanceof Error?d.message:d.error;s.w(`Unable to perform style diff: ${S}. Rebuilding the style from scratch.`),this._updateStyle(y,a)}else v&&this._update(!0)}),(()=>this._postStyleLoadEvent())),this):(this._localIdeographFontFamily=a.localIdeographFontFamily,this._localFontFamily=a.localFontFamily,this._updateStyle(y,a))}_getUIString(y){const a=this._locale[y];if(a==null)throw new Error(`Missing UI string '${y}'`);return a}_updateStyle(y,a){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),y){const d=s.h({},a);a&&a.config&&(d.initialConfig=a.config,delete d.config),this.style=new Lc(this,d).load(y),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Lc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.w("There is no style added to the map."),!1)}_isValidId(y){return y==null?(this.fire(new s.z(new Error("IDs can't be empty."))),!1):!s.dk(y)||(this.fire(new s.z(new Error(`IDs can't contain special symbols: "${y}".`))),!1)}_isTargetValid(y){return"featuresetId"in y?this._isValidId("importId"in y?y.importId:y.featuresetId):"layerId"in y&&this._isValidId(y.layerId)}_areTargetsValid(y){if(Array.isArray(y)){for(const a of y)if(!this._isValidId(a))return!1;return!0}return this._isTargetValid(y)}addSource(y,a){return this._isValidId(y)?(this._lazyInitEmptyStyle(),this.style.addSource(y,a),this._update(!0)):this}isSourceLoaded(y){return!!this._isValidId(y)&&!!this.style&&this.style._isSourceCacheLoaded(y)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(y,a,d){this._lazyInitEmptyStyle(),this.style.addSourceType(y,a,d)}removeSource(y){return this._isValidId(y)?(this.style.removeSource(y),this._updateTerrain(),this._update(!0)):this}getSource(y){return this._isValidId(y)?this.style.getOwnSource(y):null}addImage(y,a,{pixelRatio:d=1,sdf:v=!1,stretchX:S,stretchY:A,content:P}={}){this._lazyInitEmptyStyle();const O=s.I.from(y);if(a instanceof HTMLImageElement||ImageBitmap&&a instanceof ImageBitmap){const{width:I,height:H,data:G}=s.q.getImageData(a);this.style.addImage(O,{data:new s.r({width:I,height:H},G),pixelRatio:d,stretchX:S,stretchY:A,content:P,sdf:v,version:0,usvg:!1})}else if(a.width===void 0||a.height===void 0)this.fire(new s.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:H}=a,G=a;this.style.addImage(O,{data:new s.r({width:I,height:H},new Uint8Array(G.data)),pixelRatio:d,stretchX:S,stretchY:A,content:P,sdf:v,usvg:!1,version:0,userImage:G}),G.onAdd&&G.onAdd(this,y)}}updateImage(y,a){this._lazyInitEmptyStyle();const d=s.I.from(y),v=this.style.getImage(d);if(!v)return void this.fire(new s.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const S=a instanceof HTMLImageElement||ImageBitmap&&a instanceof ImageBitmap?s.q.getImageData(a):a,{width:A,height:P,data:O}=S;if(A===void 0||P===void 0)return void this.fire(new s.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(A!==(v.usvg?v.icon.usvg_tree.width:v.data.width)||P!==(v.usvg?v.icon.usvg_tree.height:v.data.height))return void this.fire(new s.z(new Error(`The width and height of the updated image (${A}, ${P})
                must be that same as the previous version of the image
                (${v.data.width}, ${v.data.height})`)));const I=!(a instanceof HTMLImageElement||ImageBitmap&&a instanceof ImageBitmap);let H=!1;v.usvg?(v.data=new s.r({width:A,height:P},new Uint8Array(O)),v.usvg=!1,v.icon=void 0,H=!0):v.data.replace(O,I),this.style.updateImage(d,v,H)}hasImage(y){return y?!!this.style&&!!this.style.getImage(s.I.from(y)):(this.fire(new s.z(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(s.I.from(y))}loadImage(y,a){s.o(this._requestManager.transformRequest(y,s.R.Image),((d,v)=>{a(d,v instanceof HTMLImageElement?s.q.getImageData(v):v)}))}listImages(){return this.style.listImages().map((y=>y.name))}addModel(y,a){this._lazyInitEmptyStyle(),this.style.addModel(y,a)}hasModel(y){return y?this.style.hasModel(y):(this.fire(new s.z(new Error("Missing required model id"))),!1)}removeModel(y){this.style.removeModel(y)}listModels(){return this.style.listModels()}addLayer(y,a){return this._isValidId(y.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(y,a),this._update(!0)):this}getSlot(y){const a=this.getLayer(y);return a&&a.slot||null}setSlot(y,a){return this.style.setSlot(y,a),this.style.mergeLayers(),this._update(!0)}addImport(y,a){return this.style.addImport(y,a).catch((d=>this.fire(new s.z(new Error("Failed to add import",d))))),this}updateImport(y,a){return typeof a!="string"&&a.id!==y?(this.removeImport(y),this.addImport(a)):(this.style.updateImport(y,a),this._update(!0))}removeImport(y){return this.style.removeImport(y),this}moveImport(y,a){return this.style.moveImport(y,a),this._update(!0)}moveLayer(y,a){return this._isValidId(y)?(this.style.moveLayer(y,a),this._update(!0)):this}removeLayer(y){return this._isValidId(y)?(this.style.removeLayer(y),this._update(!0)):this}getLayer(y){if(!this._isValidId(y))return null;const a=this.style.getOwnLayer(y);return a?a.type==="custom"?a.implementation:a.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(y,a,d){return this._isValidId(y)?(this.style.setLayerZoomRange(y,a,d),this._update(!0)):this}setFilter(y,a,d={}){return this._isValidId(y)?(this.style.setFilter(y,a,d),this._update(!0)):this}getFilter(y){return this._isValidId(y)?this.style.getFilter(y):null}setPaintProperty(y,a,d,v={}){return this._isValidId(y)?(this.style.setPaintProperty(y,a,d,v),this._update(!0)):this}getPaintProperty(y,a){return this._isValidId(y)?this.style.getPaintProperty(y,a):null}setLayoutProperty(y,a,d,v={}){return this._isValidId(y)?(this.style.setLayoutProperty(y,a,d,v),this._update(!0)):this}getLayoutProperty(y,a){return this._isValidId(y)?this.style.getLayoutProperty(y,a):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(y){return this.style.setGlyphsUrl(y),this._update(!0)}getSchema(y){return this.style.getSchema(y)}setSchema(y,a){return this.style.setSchema(y,a),this._update(!0)}getConfig(y){return this.style.getConfig(y)}setConfig(y,a){return this.style.setConfig(y,a),this._update(!0)}getConfigProperty(y,a){return this.style.getConfigProperty(y,a)}setConfigProperty(y,a,d){return this.style.setConfigProperty(y,a,d),this._update(!0)}getFeaturesetDescriptors(y){return this.style.getFeaturesetDescriptors(y)}setLights(y){if(this._lazyInitEmptyStyle(),y&&y.length===1&&y[0].type==="flat"){const a=y[0];a.properties?this.style.setFlatLight(a.properties,a.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(y),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const y=this.style.getLights()||[];return y.length===0&&y.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),y}setLight(y,a={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:y}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(y){return this._lazyInitEmptyStyle(),!y&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(y),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(y){return this._lazyInitEmptyStyle(),this.style.setFog(y),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(y){return this._lazyInitEmptyStyle(),this.style.setSnow(y),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(y){return this._lazyInitEmptyStyle(),this.style.setRain(y),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(y){return this._lazyInitEmptyStyle(),this.style.setColorTheme(y),this._update(!0)}setImportColorTheme(y,a){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(y,a),this._update(!0)}setCamera(y){return this.style.setCamera(y),this._triggerCameraUpdate(y)}_triggerCameraUpdate(y){return this._update(this.transform.setOrthographicProjectionAtLowPitch(y["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(y){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.ci.convert(y),this.transform):0}setFeatureState(y,a){return y.source&&!this._isValidId(y.source)?this:(this.style.setFeatureState(y,a),this._update())}removeFeatureState(y,a){return y.source&&!this._isValidId(y.source)?this:(this.style.removeFeatureState(y,a),this._update())}getFeatureState(y){return y.source&&!this._isValidId(y.source)?null:this.style.getFeatureState(y)}_selectIndoorFloor(y){this.indoor.selectFloor(y)}_addIndoorControl(){this._indoorControl||(this._indoorControl=new Ap),this.addControl(this._indoorControl,"right")}_removeIndoorControl(){this._indoorControl&&this.removeControl(this._indoorControl)}_updateContainerDimensions(){if(!this._container)return;const y=this._container.getBoundingClientRect().width||400,a=this._container.getBoundingClientRect().height||300;let d,v,S,A=this._container;for(;A&&(!v||!S);){const P=window.getComputedStyle(A).transform;P&&P!=="none"&&(d=P.match(/matrix.*\((.+)\)/)[1].split(", "),d[0]&&d[0]!=="0"&&d[0]!=="1"&&(v=d[0]),d[3]&&d[3]!=="0"&&d[3]!=="1"&&(S=d[3])),A=A.parentElement}this._containerWidth=v?Math.abs(y/v):y,this._containerHeight=S?Math.abs(a/S):a}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const y=this._container;y.classList.add("mapboxgl-map"),(this._missingCSSCanary=B("div","mapboxgl-canary",y)).style.visibility="hidden",this._detectMissingCSS();const a=this._canvasContainer=B("div","mapboxgl-canvas-container",y);this._canvas=B("canvas","mapboxgl-canvas",a),this._interactive&&(a.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const d=this._controlContainer=B("div","mapboxgl-control-container",y),v=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach((S=>{v[S]=B("div",`mapboxgl-ctrl-${S}`,d)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,a){const d=s.q.devicePixelRatio||1;this._canvas.width=d*Math.ceil(y),this._canvas.height=d*Math.ceil(a),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${a}px`}_addMarker(y){this._markers.push(y)}_removeMarker(y){const a=this._markers.indexOf(y);a!==-1&&this._markers.splice(a,1)}_addPopup(y){this._popups.push(y)}_removePopup(y){const a=this._popups.indexOf(y);a!==-1&&this._popups.splice(a,1)}_setupPainter(){const y=s.h({},$.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),a=this._canvas.getContext("webgl2",y);a?(sn(a,!0),this.painter=new Hc(a,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp,this._worldview),this.on("data",(d=>{d.dataType==="source"&&this.painter.setTileLoadedFlag(!0)})),s.l.testSupport(a)):this.fire(new s.z(new Error("Failed to initialize WebGL")))}_contextLost(y){y.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.A("webglcontextlost",{originalEvent:y}))}_contextRestored(y){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.clearLayers(),this.style.imageManager.destroyAtlasTextures(),this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new s.A("webglcontextrestored",{originalEvent:y}))}_onMapScroll(y){if(y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(y){return this.style?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_requestDomTask(y){!this.loaded()||this.loaded()&&!this.isMoving()?y():this._domRenderTaskQueue.add(y)}_render(y){let a;this.fire(new s.A("renderstart")),++this._frameId;const d=this.painter.context.extTimerQuery,v=s.q.now(),S=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(a=S.createQuery(),S.beginQuery(d.TIME_ELAPSED_EXT,a)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(y),this._domRenderTaskQueue.run(y),this._removed)return;this._updateProjectionTransition();const A=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const H=this.transform.zoom,G=this.transform.pitch,ne=s.q.now(),J=new s.aa(H,{now:ne,fadeDuration:A,pitch:G,transition:this.style.transition,worldview:this._worldview});this.style.update(J)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let P=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),P=this._updateAverageElevation(v),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):P=this._updateAverageElevation(v);const O=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,A,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),O&&(this._placementDirty=O.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,E.mark(T.load),this.fire(new s.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),a){const H=s.q.now()-v;S.endQuery(d.TIME_ELAPSED_EXT),setTimeout((()=>{const G=S.getQueryParameter(a,S.QUERY_RESULT)/1e6;S.deleteQuery(a),this.fire(new s.A("gpu-timing-frame",{cpuTime:H,gpuTime:G}))}),50)}if(this.listens("gpu-timing-layer")){const H=this.painter.collectGpuTimers();setTimeout((()=>{const G=this.painter.queryGpuTimers(H);this.fire(new s.A("gpu-timing-layer",{layerTimes:G}))}),50)}if(this.listens("gpu-timing-deferred-render")){const H=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const G=this.painter.queryGpuTimeDeferredRender(H);this.fire(new s.A("gpu-timing-deferred-render",{gpuTime:G}))}),50)}const I=this._sourcesDirty||this._styleDirty||this._placementDirty||P;if(I||this._repaint)this.triggerRepaint();else{const H=this.idle();if(H&&(P=this._updateAverageElevation(v,!0)),P)this.triggerRepaint();else if(this._triggerFrame(!1),H&&(this.fire(new s.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const G=this._calculateSpeedIndex();this.fire(new s.A("speedindexcompleted",{speedIndex:G})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||I||(this._fullyLoaded=!0,E.mark(T.fullLoad),this._performanceMetricsCollection&&an(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(y){for(const a of this._markers)y&&!this.getRenderWorldCopies()&&(a._lngLat=a._lngLat.wrap()),a._update();for(const a of this._popups)!y||this.getRenderWorldCopies()||a._trackPointer||(a._lngLat=a._lngLat.wrap()),a._update()}_updateAverageElevation(y,a=!1){const d=S=>(this.transform.averageElevation=S,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&d(0);const v=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(v||(a||y-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(y)){const S=this.transform.averageElevation;let A=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(A)?A=0:this._averageElevationLastSampledAt=y;const P=Math.abs(S-A);if(P>1){if(this._isInitialLoad||v)return this._averageElevation.jumpTo(A),d(A);this._averageElevation.easeTo(A,y,300)}else if(P>1e-4)return this._averageElevation.jumpTo(A),d(A)}return!!this._averageElevation.isEasing(y)&&d(this._averageElevation.getValue(y))}_authenticate(){Cn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(y=>{if(y&&(y.message===nt||y.status===401)){const a=this.painter.context.gl;sn(a,!1),this._logoControl instanceof Tp&&this._logoControl._updateLogo(),a&&a.clear(a.DEPTH_BUFFER_BIT|a.COLOR_BUFFER_BIT|a.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),jt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_postStyleLoadEvent(){this.style.globalId&&Ot(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const y=this._isDragging();this.painter.updateTerrain(this.style,y)}_calculateSpeedIndex(){const y=this.painter.canvasCopy(),a=this.painter.getCanvasCopiesAndTimestamps();a.timeStamps.push(performance.now());const d=this.painter.context.gl,v=d.createFramebuffer();function S(A){d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,A,0);const P=new Uint8Array(d.drawingBufferWidth*d.drawingBufferHeight*4);return d.readPixels(0,0,d.drawingBufferWidth,d.drawingBufferHeight,d.RGBA,d.UNSIGNED_BYTE,P),P}return d.bindFramebuffer(d.FRAMEBUFFER,v),this._canvasPixelComparison(S(y),a.canvasCopies.map(S),a.timeStamps)}_canvasPixelComparison(y,a,d){let v=d[1]-d[0];const S=y.length/4;for(let A=0;A<a.length;A++){const P=a[A];let O=0;for(let I=0;I<P.length;I+=4)P[I]===y[I]&&P[I+1]===y[I+1]&&P[I+2]===y[I+2]&&P[I+3]===y[I+3]&&(O+=1);v+=(d[A+2]-d[A+1])*(1-O/S)}return v}remove(){this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const y=this.painter.context.gl.getExtension("WEBGL_lose_context");y&&y.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),nr.delete(this.painter.context.gl),Jt.remove(),Je.remove(),this._removed=!0,this.fire(new s.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(y){this._renderNextFrame=this._renderNextFrame||y,this.style&&!this._frame&&(this._frame=s.q.frame((a=>{const d=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,d&&this._render(a)})))}_preloadTiles(y){const a=this.style?this.style.getSourceCaches():[];return s.bt(a,((d,v)=>d._preloadTiles(y,v)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(y){this._trackResize&&this.resize({originalEvent:y})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(y){this._showParseStatus!==y&&(this._showParseStatus=y,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(y){this._showTerrainWireframe!==y&&(this._showTerrainWireframe=y,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(y){this._showLayers2DWireframe!==y&&(this._showLayers2DWireframe=y,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(y){this._showLayers3DWireframe!==y&&(this._showLayers3DWireframe=y,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(y){this._speedIndexTiming!==y&&(this._speedIndexTiming=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,this._tp.refreshUI(),y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(y){this._showTileAABBs!==y&&(this._showTileAABBs=y,this._tp.refreshUI(),y&&this._update())}_setCacheLimits(y,a){s.eV(y,a)}get version(){return w}},NavigationControl:class{constructor(y={}){this.options=s.h({},mf,y),this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(a=>a.preventDefault())),this.options.showZoom&&(s.aV(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(a=>{this._map&&this._map.zoomIn({},{originalEvent:a})})),B("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(a=>{this._map&&this._map.zoomOut({},{originalEvent:a})})),B("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.aV(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(a=>{const d=this._map;d&&(this.options.visualizePitch?d.resetNorthPitch({},{originalEvent:a}):d.resetNorth({},{originalEvent:a}))})),this._compassIcon=B("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const y=this._map;if(!y)return;const a=y.getZoom(),d=a===y.getMaxZoom(),v=a===y.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=v,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",v.toString())}_rotateCompassArrow(){const y=this._map;if(!y)return;const a=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(y.transform.pitch*(Math.PI/180)),.5)}) rotateX(${y.transform.pitch}deg) rotateZ(${y.transform.angle*(180/Math.PI)}deg)`:`rotate(${y.transform.angle*(180/Math.PI)}deg)`;y._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=a)}))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),y.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&y.on("pitch",this._rotateCompassArrow),y.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Wu(y,this._compass,this.options.visualizePitch)),this._container}onRemove(){const y=this._map;y&&(this._container.remove(),this.options.showZoom&&y.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&y.off("pitch",this._rotateCompassArrow),y.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(y,a){const d=B("button",y,this._container);return d.type="button",d.addEventListener("click",a),d}_setButtonTitle(y,a){if(!this._map)return;const d=this._map._getUIString(`NavigationControl.${a}`);y.setAttribute("aria-label",d),y.firstElementChild&&y.firstElementChild.setAttribute("title",d)}},GeolocateControl:class extends s.E{constructor(y={}){super();const a=navigator.geolocation;this.options=s.h({geolocation:a},C_,y),s.aV(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Cd(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(y){return this._map=y,this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(y){const a=(d=!!this.options.geolocation)=>{this._supportsGeolocation=d,y(d)};this._supportsGeolocation!==void 0?y(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then((d=>a(d.state!=="denied"))).catch((()=>a())):a()}_isOutOfMapMaxBounds(y){const a=this._map.getMaxBounds(),d=y.coords;return!!a&&(d.longitude<a.getWest()||d.longitude>a.getEast()||d.latitude<a.getSouth()||d.latitude>a.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(y){if(this._map){if(this._isOutOfMapMaxBounds(y))return this._setErrorState(),this.fire(new s.A("outofmaxbounds",y)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=y,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(y),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(y),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new s.A("geolocate",y)),this._finish()}}_updateCamera(y){const a=new s.ci(y.coords.longitude,y.coords.latitude),d=y.coords.accuracy,v=this._map.getBearing(),S=s.h({bearing:v},this.options.fitBoundsOptions);this._map.fitBounds(a.toBounds(d),S,{geolocateSource:!0})}_updateMarker(y){if(y){const a=new s.ci(y.coords.longitude,y.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=y.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const y=this._map.transform,a=s.cb(1,y._center.lat)*y.worldSize,d=Math.ceil(2*this._accuracy*a);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(y){if(this._map){if(this.options.trackUserLocation)if(y.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(y.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new s.A("error",y)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(y){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",(a=>a.preventDefault())),this._geolocateButton=B("button","mapboxgl-ctrl-geolocate",this._container),B("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",y===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=B("div","mapboxgl-user-location"),this._dotElement.appendChild(B("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(B("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ul({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=B("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ul({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.A("trackuserlocationend")))}))}}_onDeviceOrientation(y){this._userLocationDotMarker&&(y.webkitCompassHeading?this._heading=y.webkitCompassHeading:y.absolute===!0&&(this._heading=-1*y.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(y={maximumAge:6e5,timeout:0},this._noTimeout=!0):(y=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,y),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const y=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then((a=>{a==="granted"&&y()})).catch(console.error):y()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:ic,ScaleControl:class{constructor(y={}){this.options=s.h({},Qv,y),this._isNumberFormatSupported=(function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}})(),s.aV(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const y=this.options.maxWidth||100,a=this._map,d=a._containerHeight/2,v=a._containerWidth/2-y/2,S=a.unproject([v,d]),A=a.unproject([v+y,d]),P=S.distanceTo(A);if(this.options.unit==="imperial"){const O=3.2808*P;O>5280?this._setScale(y,O/5280,"mile"):this._setScale(y,O,"foot")}else this.options.unit==="nautical"?this._setScale(y,P/1852,"nautical-mile"):P>=1e3?this._setScale(y,P/1e3,"kilometer"):this._setScale(y,P,"meter")}_setScale(y,a,d){this._map._requestDomTask((()=>{const v=(function(A){const P=Math.pow(10,`${Math.floor(A)}`.length-1);let O=A/P;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:(function(I){const H=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*H)/H})(O),P*O})(a),S=v/a;this._container.innerHTML=this._isNumberFormatSupported&&d!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:d}).format(v):`${v}&nbsp;${ex[d]}`,this._container.style.width=y*S+"px"}))}onAdd(y){return this._map=y,this._language=y.getLanguage(),this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-scale",y.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(y){this._language=y,this._update()}setUnit(y){this.options.unit=y,this._update()}},FullscreenControl:class{constructor(y={}){this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:s.w("Full screen control 'container' must be a DOM element.")),s.aV(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=B("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const y=this._fullscreenButton=B("button","mapboxgl-ctrl-fullscreen",this._controlContainer);B("span","mapboxgl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",y)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},IndoorControl:Ap,Popup:class extends s.E{constructor(y){super(),this.options=s.h(Object.create(_y),y),this._altitude=this.options.altitude,s.aV(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(y&&y.className?y.className.trim().split(/\s+/):[])}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&y.on("preclick",this._onClose),this.options.closeOnMove&&y.on("move",this._onClose),y.on("remove",this.remove),this._update(),y._addPopup(this),this._focusFirstElement(),this._trackPointer?(y.on("mousemove",this._onMouseEvent),y.on("mouseup",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")):y.on("move",this._update),this.fire(new s.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const y=this._map;return y&&(y.off("move",this._update),y.off("move",this._onClose),y.off("preclick",this._onClose),y.off("click",this._onClose),y.off("remove",this.remove),y.off("mousemove",this._onMouseEvent),y.off("mouseup",this._onMouseEvent),y.off("drag",this._onMouseEvent),y._canvasContainer&&y._canvasContainer.classList.remove("mapboxgl-track-pointer"),y._removePopup(this),this._map=void 0),this.fire(new s.A("close")),this}getLngLat(){return this._lngLat}setLngLat(y){this._lngLat=s.ci.convert(y),this._pos=null,this._trackPointer=!1,this._update();const a=this._map;return a&&(a.on("move",this._update),a.off("mousemove",this._onMouseEvent),a._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(y){return this._altitude=y,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const y=this._map;return y&&(y.off("move",this._update),y.on("mousemove",this._onMouseEvent),y.on("drag",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const a=document.createDocumentFragment(),d=document.createElement("body");let v;for(d.innerHTML=y;v=d.firstChild,v;)a.appendChild(v);return this.setDOMContent(a)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){let a=this._content;if(a)for(;a.hasChildNodes();)a.firstChild&&a.removeChild(a.firstChild);else a=this._content=B("div","mapboxgl-popup-content",this._container||void 0);if(a.appendChild(y),this.options.closeButton){const d=this._closeButton=B("button","mapboxgl-popup-close-button",a);d.type="button",d.setAttribute("aria-label","Close popup"),d.innerHTML='<span aria-hidden="true">&#215;</span>',d.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(y){return this._classList.add(y),this._updateClassList(),this}removeClassName(y){return this._classList.delete(y),this._updateClassList(),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){let a;return this._classList.delete(y)?a=!1:(this._classList.add(y),a=!0),this._updateClassList(),a}_onMouseEvent(y){this._update(y.point)}_getAnchor(y){if(this.options.anchor)return this.options.anchor;const a=this._map,d=this._container,v=this._pos;if(!a||!d||!v)return"bottom";const S=d.offsetWidth,A=d.offsetHeight,P=v.x<S/2,O=v.x>a.transform.width-S/2;if(v.y+y<A)return P?"top-left":O?"top-right":"top";if(v.y>a.transform.height-A){if(P)return"bottom-left";if(O)return"bottom-right"}return P?"left":O?"right":"bottom"}_updateClassList(){const y=this._container;if(!y)return;const a=[...this._classList];a.push("mapboxgl-popup"),this._anchor&&a.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&a.push("mapboxgl-popup-track-pointer"),y.className=a.join(" ")}_update(y){const a=this._map,d=this._content;if(!a||!this._lngLat&&!this._trackPointer||!d)return;let v=this._container;if(v||(v=this._container=B("div","mapboxgl-popup",a.getContainer()),this._tip=B("div","mapboxgl-popup-tip",v),v.appendChild(d)),this.options.maxWidth&&v.style.maxWidth!==this.options.maxWidth&&(v.style.maxWidth=this.options.maxWidth),a.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Sl(this._lngLat,this._pos,a.transform)),!this._trackPointer||y){const S=this._pos=this._trackPointer&&y instanceof s.P?y:a.project(this._lngLat,this._altitude),A=qa(this.options.offset),P=this._anchor=this._getAnchor(A.y),O=qa(this.options.offset,P),I=S.add(O).round();a._requestDomTask((()=>{this._container&&P&&(this._container.style.transform=`${po[P]} translate(${I.x}px,${I.y}px)`)}))}if(!this._marker&&a._showingGlobe()){const S=s.eW(a.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(tx);y&&y.focus()}_onClose(){this.remove()}_setOpacity(y){this._container&&(this._container.style.opacity=`${y}`),this._content&&(this._content.style.pointerEvents=y?"auto":"none")}},Marker:Ul,Style:Lc,LngLat:s.ci,LngLatBounds:s.aG,Point:s.P,MercatorCoordinate:s.ac,FreeCameraOptions:Xf,Evented:s.E,config:s.e,prewarm:s.e_,clearPrewarmedResources:s.eZ,get accessToken(){return s.e.ACCESS_TOKEN},set accessToken(y){s.e.ACCESS_TOKEN=y},get baseApiUrl(){return s.e.API_URL},set baseApiUrl(y){s.e.API_URL=y},get workerCount(){return s.f7.workerCount},set workerCount(y){s.f7.workerCount=y},get maxParallelImageRequests(){return s.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(y){s.e.MAX_PARALLEL_IMAGE_REQUESTS=y},clearStorage(y){s.f6(y)},get workerUrl(){return s.f5.workerUrl},set workerUrl(y){s.f5.workerUrl=y},get workerClass(){return s.f5.workerClass},set workerClass(y){s.f5.workerClass=y},get workerParams(){return s.f5.workerParams},set workerParams(y){s.f5.workerParams=y},get dracoUrl(){return s.f4()},set dracoUrl(y){s.f3(y)},get meshoptUrl(){return s.f2()},set meshoptUrl(y){s.f1(y)},setNow:s.q.setNow,restoreNow:s.q.restoreNow}}));var p=c;return p}))})(BA)),BA.exports}var vVe=yVe();const T0=Ca(vVe);T0.accessToken="pk.eyJ1IjoiY2hyaXN0aWFubWFwYm94Y29tIiwiYSI6ImNtZXJ1bTcweTBhYjcya3EwZjloOG5vMjIifQ.KPbfNzCPPimuiUecFEZxCA";function xVe({data:e,className:t}){const n=z.useRef(null),r=z.useRef(null),c=z.useRef([]),f=e?.filter(p=>p.latitude&&p.longitude).map(p=>[parseFloat(p.longitude),parseFloat(p.latitude)])||[];return z.useEffect(()=>{if(!(!n.current||f.length<2))return r.current&&(r.current.remove(),r.current=null),r.current=new T0.Map({container:n.current,style:"mapbox://styles/mapbox/streets-v12",center:f[0],zoom:16}),r.current.on("load",async()=>{f.forEach((s,w)=>{const T=new T0.Popup({offset:25,closeButton:!1,closeOnClick:!1}).setHTML(`<div style="border-radius:0.375rem;padding:0.5rem;color:#000;background:#fff;">${e[w].full_address}</div>`),E=new T0.Marker().setLngLat(s).setPopup(T).addTo(r.current);c.current.push(E)});const p=f.map(s=>s.join(",")).join(";");try{const w=await(await fetch(`https://api.mapbox.com/directions/v5/mapbox/driving/${p}?geometries=geojson&access_token=${T0.accessToken}`)).json();if(w.routes&&w.routes.length){const T=w.routes[0].geometry;r.current.addSource("route",{type:"geojson",data:{type:"Feature",geometry:T}}),r.current.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#007bff","line-width":4}});const E=new T0.LngLatBounds;T.coordinates.forEach(N=>E.extend(N)),r.current.fitBounds(E,{padding:50})}}catch(s){console.error("Failed to fetch route from Mapbox Directions API",s)}}),()=>{c.current.forEach(p=>p.remove()),c.current=[],r.current&&(r.current.remove(),r.current=null)}},[f,e]),o.jsx("div",{ref:n,className:t})}const _Ve=_e.memo(xVe,(e,t)=>JSON.stringify(e.data)===JSON.stringify(t.data));Qa.broadcast.config();function bVe(){const{batch_number:e}=NE(),[t,n]=z.useState(),[r,c]=z.useState(!1),[f,p]=z.useState([]),[s,w]=z.useState(0),[T,E]=z.useState(0),[N,D]=z.useState(0),{setMapComponent:V}=Soe(),$=z.useCallback(()=>{c(!0),Qa.reservations.details({batch_number:e}).then(Y=>{const X=Y.data?.reservation;if(!X)return Zt.error("Reservation not found");n(X),X.metrics?.totals&&w(X.metrics.totals.totalFuelCost??0),X.metrics?.trip_metrics?.length&&(E(X.metrics.trip_metrics.reduce((ae,Z)=>ae+(Z.distance??0),0)),D(X.metrics.trip_metrics.reduce((ae,Z)=>ae+(Z.duration??0),0)))}).catch(()=>Zt.error("Failed to fetch reservation")).finally(()=>c(!1))},[e]);z.useEffect(()=>{e&&$()},[$,e]);const B=(Y,X)=>{p(ae=>ae.find(se=>se.vehicle_id===Y)?ae.map(se=>se.vehicle_id===Y?{...se,driver_uuid:X}:se):[...ae,{vehicle_id:Y,driver_uuid:X}])},F=Y=>{const X=t?.assignments.length;if(!f.length||f.some(ae=>!ae.driver_uuid||f.length!==X)){Zt.error("Please assign drivers before saving.");return}Y(!0),Qa.reservations.approve({batch_number:e,assignments:f}).then(()=>Zt.success("Reservation approved, budget request sent")).catch(ae=>Zt.error(`Failed to update reservation ${ae.response?.data?.message}`)).finally(()=>Y(!1))},K=Y=>{t?.id&&(Y(!0),Qa.reservations.reject({batch_number:e}).then(()=>Zt.success("Reservation rejected, resources freed")).catch(X=>Zt.error(`Failed to update reservation ${X.response?.data?.message}`)).finally(()=>Y(!1)))};return Kb("reservation_channel","ReservationEvents",Y=>{Y.batch_number===e&&$()}),z.useEffect(()=>{const Y=t?.trip_routes?.length>=2?o.jsx(_Ve,{data:t.trip_routes,className:"w-full h-full"}):null;return V(Y),()=>V(null)},[t,V]),o.jsx(ju.div,{className:"flex flex-col h-full w-full px-4 pb-4",children:r?o.jsx("div",{className:"w-full h-full px-4",children:o.jsx(ko,{})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"h-[70vh]"}),o.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[o.jsx(mVe,{totalCost:s,totalDistance:T,totalDuration:N}),o.jsx(hVe,{record:t,onApprove:F,onReject:K,isSubmitting:r,setIsSubmitting:c}),o.jsx("div",{className:"flex rounded-md backdrop-blur-md w-full justify-center items-center",children:o.jsx(pVe,{record:t,assignments:f,onAssign:B})})]})]})})}function wVe(){return o.jsx(ju.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"w-full h-full flex flex-col items-center justify-center",children:o.jsxs("div",{className:"flex flex-col items-center justify-center",children:[o.jsxs("svg",{width:"80",height:"80",viewBox:"0 0 80 80",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsx("circle",{cx:"40",cy:"40",r:"40",fill:"#4BB543"}),o.jsx("path",{d:"M24 42L36 54L56 34",stroke:"white",strokeWidth:"6",strokeLinecap:"round",strokeLinejoin:"round"})]}),o.jsx("h2",{className:"mt-6 text-2xl font-bold text-gray-800",children:"Success!"}),o.jsx("p",{className:"mt-2 text-gray-600 text-center",children:"Your operation was completed successfully. Please wait for approval."})]})})}Qa.broadcast.config();const SVe=[{title:"Name",accessor:"name",cellClassName:"font-medium"},{title:"Status",accessor:"status"},{render:e=>o.jsx(Yl,{to:`${e.uuid}`,children:o.jsx(kt,{variant:"",size:"sm",children:o.jsx(Mb,{})})})}];function TVe(){const[e,t]=z.useState([]),[n,r]=z.useState(1),[c,f]=z.useState(1),[p,s]=z.useState(""),[w,T]=z.useState(!1),E=z.useCallback(()=>{Qa.drivers.list({page:n,q:p||void 0}).then(D=>{let V=D.data.drivers;t(V.data||[]),f(V.last_page||1)}).catch(()=>Zt.error("Error fetching drivers"))},[n,p]);z.useEffect(()=>{const D=setTimeout(E,300);return()=>clearTimeout(D)},[E]);const N=()=>{T(!0),Qa.drivers.getDrivers().then(()=>Zt.success("Successfully fetched drivers from HR")).catch(()=>Zt.error("Failed to fetch drivers from HR")).finally(()=>T(!1))};return Kb("driver_channel","DriverEvent",D=>{let V=D.record;const $=prev.findIndex(B=>B.uuid===V.uuid);if($!==-1){const B=[...prev];return B[$]={...B[$],...V},B}return[V,...prev]}),o.jsx(ju.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"h-full",children:o.jsxs("div",{className:"flex flex-col flex-2 h-full gap-2",children:[o.jsxs("div",{className:"flex-4/5",children:[o.jsxs("div",{className:"flex mb-3 gap-2",children:[o.jsx(On,{placeholder:"Search Drivers",value:p,onChange:D=>s(D.target.value)}),o.jsx(kt,{disabled:w,onClick:N,children:w?"Fetching...":"Fetch Drivers"})]}),o.jsx("div",{className:"min-h-96 max-h-full",children:o.jsx(rie,{list:e,recordName:"driver",columns:SVe})})]}),o.jsx(iN,{totalPage:c,page:n,setPage:r,className:"flex-2/12"})]})})}function AVe({driverInfo:e,loading:t}){return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-full py-2 px-6 flex justify-between",children:o.jsx("h2",{className:"text-2xl mb-0 font-medium",children:"Driver Information"})}),o.jsx(Oc,{}),o.jsx("div",{className:"py-3 px-8",children:o.jsx("div",{className:"grid gap-3 mb-3",children:o.jsx("div",{className:"flex flex-col gap-1",children:t?o.jsxs(o.Fragment,{children:[o.jsx(ko,{className:"w-24 h-7"}),o.jsx(ko,{className:"w-full h-7"}),o.jsx(ko,{className:"w-full h-7"})]}):o.jsxs(o.Fragment,{children:[o.jsx("h3",{className:"font-medium",children:"Name"}),o.jsx("h4",{className:"px-4",children:e?.name})]})})})})]})}function jVe({dispatches:e,loading:t}){return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-full py-2 px-6 flex justify-between",children:o.jsx("h2",{className:"text-2xl mb-0 font-medium",children:"Dispatch History"})}),o.jsx(Oc,{}),o.jsx("div",{className:"py-3 px-8 min-h-24",children:o.jsx("div",{className:"grid gap-3 mb-3",children:o.jsx("div",{className:"flex flex-col gap-1",children:t?o.jsxs(o.Fragment,{children:[o.jsx(ko,{className:"w-24 h-7"}),o.jsx(ko,{className:"w-full h-7"}),o.jsx(ko,{className:"w-full h-7"})]}):e?.length>0?o.jsxs(Pc,{children:[o.jsx(Mc,{children:o.jsxs(zi,{children:[o.jsx(vr,{children:"Dispatch"}),o.jsx(vr,{children:"Batch Number"}),o.jsx(vr,{children:"Status"})]})}),o.jsx(Rc,{children:e?.map((n,r)=>o.jsxs(zi,{children:[o.jsx(qn,{children:o.jsx("h4",{className:"px-4",children:n?.uuid})}),o.jsx(qn,{children:o.jsx("h4",{className:"px-4",children:n?.batch_number})}),o.jsx(qn,{children:o.jsx(_i,{variant:n?.status==="Completed"?"default":"destructive",className:"min-w-30",children:o.jsx("h4",{className:"px-4 font-medium",children:n?.status})})}),o.jsx(qn,{children:o.jsx(Yl,{to:`/logisticsII/dispatch/${n?.batch_number}`,children:o.jsx(kt,{children:o.jsx(Mb,{})})})})]},`${n.id}-`+r))})]}):o.jsx("div",{className:"w-full",children:o.jsx("h3",{className:"text-center font-medium text-muted-foreground",children:"No dispatches found"})})})})})]})}function EVe({reports:e,loading:t}){return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-full py-2 px-6 flex justify-between",children:o.jsx("h2",{className:"text-2xl mb-0 font-medium",children:"Reports History"})}),o.jsx(Oc,{}),o.jsx("div",{className:"py-3 px-8 min-h-24",children:o.jsx("div",{className:"grid gap-3 mb-3",children:o.jsx("div",{className:"flex flex-col gap-1",children:t?o.jsxs(o.Fragment,{children:[o.jsx(ko,{className:"w-24 h-7"}),o.jsx(ko,{className:"w-full h-7"}),o.jsx(ko,{className:"w-full h-7"})]}):e?.length>0?o.jsxs(Pc,{className:"table-fixed w-full",children:[o.jsx(Mc,{children:o.jsxs(zi,{children:[o.jsx(vr,{className:"w-1/3",children:"Report"}),o.jsx(vr,{className:"w-1/4",children:"Batch Number"}),o.jsx(vr,{className:"w-1/4",children:"Date"}),o.jsx(vr,{className:"w-[60px]"})]})}),o.jsx(Rc,{children:e?.map((n,r)=>o.jsxs(zi,{className:"group",children:[o.jsx(qn,{children:o.jsx("h4",{className:"px-4 truncate",children:n?.uuid})}),o.jsx(qn,{children:o.jsx("h4",{className:"px-4 truncate",children:n?.batch_number})}),o.jsx(qn,{children:o.jsx("h4",{className:"px-4",children:n?.created_at})}),o.jsx(qn,{className:"text-center",children:o.jsxs(ds,{children:[o.jsx(kf,{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:o.jsx(kt,{size:"sm",children:o.jsx($A,{})})}),o.jsxs(gs,{children:[o.jsxs(ys,{children:[o.jsxs(vs,{children:["Report ",n?.uuid]}),o.jsxs(Cc,{children:["Created at ",n?.created_at]})]}),o.jsx("div",{className:"w-full",children:o.jsx("p",{children:n?.message})})]})]})})]},`${n.id}-${r}`))})]}):o.jsx("div",{className:"w-full",children:o.jsx("h3",{className:"text-center font-medium text-muted-foreground",children:"No reports found"})})})})})]})}function CVe({tDispatch:e,avgSpeed:t,reports:n,comRate:r,loading:c}){return o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-4 gap-2",children:[o.jsxs(ni,{className:"rounded-md flex flex-col h-full",children:[o.jsxs(Ns,{className:"flex-grow",children:[o.jsx(us,{children:"Dispatches"}),o.jsx(Nc,{children:"Total driver dispatches"})]}),o.jsxs(qi,{children:[o.jsx("p",{className:"font-medium text-gray-500 text-md",children:"Counts"}),o.jsx("h1",{className:"font-semibold text-3xl",children:e??"N/A"})]})]}),o.jsxs(ni,{className:"rounded-md flex flex-col h-full",children:[o.jsxs(Ns,{className:"flex-grow",children:[o.jsx(us,{children:"Average Speed"}),o.jsx(Nc,{children:"Average driving speed"})]}),o.jsxs(qi,{children:[o.jsx("p",{className:"text-gray-500 text-lg",children:"Mph"}),o.jsx("p",{className:"font-medium text-3xl",children:t??"N/A"})]})]}),o.jsxs(ni,{className:"rounded-md flex flex-col h-full",children:[o.jsxs(Ns,{className:"flex-grow",children:[o.jsx(us,{children:"Accident Reports"}),o.jsx(Nc,{children:"Total accident report involving this driver"})]}),o.jsxs(qi,{children:[o.jsx("p",{className:"font-medium text-gray-500 text-md",children:"Counts"}),o.jsx("h1",{className:"font-medium text-3xl",children:n??"N/A"})]})]}),o.jsxs(ni,{className:"rounded-md flex flex-col h-full",children:[o.jsxs(Ns,{className:"flex-grow",children:[o.jsx(us,{children:"Completion Rate"}),o.jsx(Nc,{children:"Percentage of which driver can accomplish the dispatch order"})]}),o.jsxs(qi,{children:[o.jsx("p",{className:"font-medium text-gray-500 text-md",children:"Percentage"}),o.jsx("h1",{className:"font-medium text-3xl",children:r??"N/A"})]})]})]})}function NVe({id:e,main_message:t,message:n,buttonTitle:r,type:c,status:f,loading:p}){const{handleSubmit:s,formState:{isSubmitting:w}}=dv(),[T,E]=z.useState(!1),N=async()=>{};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-full py-2 px-6 flex justify-between",children:o.jsx("h2",{className:"text-2xl mb-0 font-medium",children:"Danger Zone"})}),o.jsx(Oc,{}),o.jsxs("div",{className:"flex w-full items-center justify-between px-6 py-4",children:[o.jsx("p",{className:"text-sm leading-relaxed max-w-[70%]",children:t}),o.jsxs(xE,{open:T,onOpenChange:E,children:[o.jsx(_E,{asChild:!0,children:o.jsx(kt,{className:(c==="danger"?"bg-destructive ":"")+"ml-6 shrink-0 px-4 py-2",children:r})}),o.jsx(bE,{children:o.jsxs("form",{onSubmit:s(N),children:[o.jsxs(wE,{children:[o.jsx(TE,{children:"Are you absolutely sure?"}),o.jsx(AE,{children:"This action cannot be reverted."})]}),o.jsx("div",{className:"my-3",children:n}),o.jsxs(SE,{children:[o.jsx(jE,{type:"button",children:"Cancel"}),o.jsx(kt,{type:"submit",variant:"destructive",disabled:w,children:w?"Processing...":"Continue"})]})]})})]})]})]})}function PVe(){const{uuid:e}=NE(),t="Deactivate driver. This will prevent the system from assigning the driver in future orders.",n="This will prevent the system from assigning the driver in future orders.",[r,c]=z.useState(),[f,p]=z.useState(!1),[s,w]=z.useState(!1),T=z.useCallback(()=>{e&&(w(!0),Qa.drivers.driverDetails({driver_uuid:e}).then(E=>{console.log(E.data),c(E.data)}).catch(E=>{console.log(E),f||(Zt.error("Unable to get driver details"),p(!0))}).finally(()=>{w(!1)}))},[e]);return z.useEffect(()=>{T()},[T]),o.jsx(ju.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex flex-col w-full mb-16 space-x-3",children:o.jsx("div",{className:"w-full",children:s?o.jsx(ko,{className:"w-full h-full"}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex-1 max-h-dvh mb-5",children:o.jsx(CVe,{tDispatch:r?.dispatchTotalCount,avgSpeed:r?.averageSpeed,reports:r?.accidentReportsCount,comRate:r?.dispatchCompletionPrt,loading:s})}),o.jsx("div",{className:"flex-1 border rounded-md shadow max-h-dvh mb-5 bg-primary-foreground",children:o.jsx(AVe,{driverInfo:r?.driverInfo,loading:s})}),o.jsx("div",{className:"flex-1 border rounded-md shadow max-h-dvh mb-5 bg-primary-foreground",children:o.jsx(jVe,{dispatches:r?.dispatches,loading:s})}),o.jsx("div",{className:"flex-1 border rounded-md shadow max-h-dvh mb-5 bg-primary-foreground",children:o.jsx(EVe,{reports:r?.accidentReports,loading:s})}),o.jsx("div",{className:"flex-1 border rounded-md shadow max-h-dvh mb-5 bg-primary-foreground",children:o.jsx(NVe,{id:2,main_message:t,message:n,buttonTitle:"Deactivate",type:"danger",status:"",loading:s})})]})})})}function MVe(){return o.jsx("h1",{children:"Dashboard"})}const Y9={wsPort:6061,wssPort:6061,broadcaster:"reverb",key:"luoioknoyyzonvz8gf6o",wsHost:"localhost",forceTLS:window.location.protocol==="https:",enabledTransports:["ws","wss"]},sie=8094,Ri=`http://localhost:${sie}`,Ir={reverb:{...Y9,config:()=>Fne(Y9)},backend:{port:sie,uri:Ri,api:{equipment:`${Ri}/api/equipment`,equipmentSearch:`${Ri}/api/equipment/search`,equipmentAdd:`${Ri}/api/equipment/add`,equipmentUpdate:`${Ri}/api/equipment/change`,equipmentArchive:`${Ri}/api/equipment/archive`,lowStockAlert:`${Ri}/api/equipment/low-stock-alert`,overStockAlert:`${Ri}/api/equipment/overstock-alert`,categorizeEquipment:`${Ri}/api/equipment/{id}/categorize/{categoryId}`,archiveOldEquipment:`${Ri}/api/equipment/{id}/archive-old`,suppliers:`${Ri}/api/suppliers`,supplierAdd:`${Ri}/api/suppliers/add`,supplierUpdate:`${Ri}/api/suppliers/{id}`,supplierArchive:`${Ri}/api/suppliers/archive/{id}`,purchaseRequests:`${Ri}/api/requests`,purchaseRequestAdd:`${Ri}/api/requests/add`,purchaseRequestUpdate:`${Ri}/api/requests/{id}`,purchaseOrders:`${Ri}/api/orders`,purchaseOrderAdd:`${Ri}/api/orders/add`,purchaseOrderUpdate:`${Ri}/api/orders/{id}`,expenseRecords:`${Ri}/api/expenses`,expenseRecordAdd:`${Ri}/api/expenses/add`,expenseRecordUpdate:`${Ri}/api/expenses/{id}`,equipmentSchedules:`${Ri}/api/equipment-schedule`,equipmentScheduleAdd:`${Ri}/api/equipment-schedule`,equipmentScheduleUpdate:`${Ri}/api/equipment-schedule/{id}`,equipmentScheduleApprove:`${Ri}/api/equipment-schedule/{id}/approve`,deliveries:`${Ri}/api/delivery`,deliveryAdd:`${Ri}/api/delivery`,deliveryUpdate:`${Ri}/api/delivery/{id}`,markDelivered:`${Ri}/api/delivery/{id}/mark-delivered`,assets:`${Ri}/api/asset`,assetAdd:`${Ri}/api/asset`,assetUpdate:`${Ri}/api/asset/{id}`,assetArchive:`${Ri}/api/asset/archive/{id}`,maintenance:`${Ri}/api/maintenance`,maintenanceAdd:`${Ri}/api/maintenance`,maintenanceUpdate:`${Ri}/api/maintenance/{id}`,maintenanceArchive:`${Ri}/api/maintenance/archive/{id}`,deliveryReceipts:`${Ri}/api/delivery-receipts`,deliveryReceiptAdd:`${Ri}/api/delivery-receipts`,deliveryReceiptUpdate:`${Ri}/api/delivery-receipts/{id}`,deliveryReceiptArchive:`${Ri}/api/delivery-receipts/archive/{id}`,equipmentLogs:`${Ri}/api/equipment-logs`,equipmentLogAdd:`${Ri}/api/equipment-logs`,equipmentLogUpdate:`${Ri}/api/equipment-logs/{id}`,equipmentLogArchive:`${Ri}/api/equipment-logs/archive/{id}`,logisticsReports:`${Ri}/api/logistics-reports`,logisticsReportAdd:`${Ri}/api/logistics-reports`,logisticsReportUpdate:`${Ri}/api/logistics-reports/{id}`,logisticsReportArchive:`${Ri}/api/logistics-reports/archive/{id}`,fleetDocuments:`${Ri}/api/fleet-documents`,fleetDocumentAdd:`${Ri}/api/fleet-documents`,fleetDocumentUpdate:`${Ri}/api/fleet-documents/{id}`,fleetDocumentArchive:`${Ri}/api/fleet-documents/archive/{id}`,qrAssets:`${Ri}/api/assets`,qrAssetAdd:`${Ri}/api/assets`,qrAssetShow:`${Ri}/api/assets/{token}`}}},RVe=()=>{const[e,t]=z.useState([]),[n,r]=z.useState(""),[c,f]=z.useState(1),[p,s]=z.useState(1),[w,T]=z.useState(!1),[E,N]=z.useState(!1),[D,V]=z.useState("add"),[$,B]=z.useState({equipment_id:null,name:"",description:"",stock_quantity:0,status:"active"}),[F,K]=z.useState(!1),[Y,X]=z.useState(""),[ae,Z]=z.useState(null),[se,he]=z.useState(0),[ye,Ce]=z.useState(null),[Ve,Re]=z.useState(null),[$e,nt]=z.useState(!1),[Me,rt]=z.useState(null),[Ee,it]=z.useState(0),[et,mt]=z.useState(!1),[He,pt]=z.useState(null),[We,Je]=z.useState(!1),[jt,Pt]=z.useState(null),Ot=async(Nn=1)=>{T(!0);try{const ci={page:Nn,q:n};E&&(ci.status="archived");const ui=await $r.get(Ir.backend.api.equipment,{params:ci});let st=ui.data.data||ui.data;Array.isArray(st)&&(st=st.sort((qt,rn)=>{const Wn=new Date(qt.created_at);return new Date(rn.created_at)-Wn})),t(st),f(ui.data.current_page||Nn),s(ui.data.last_page||1)}catch(ci){console.error("Error fetching equipment:",ci)}finally{T(!1)}};z.useEffect(()=>{Ot(c)},[c,n,E]);const Mt=Nn=>{const{name:ci,value:ui}=Nn.target;B(st=>({...st,[ci]:ui}))},an=async Nn=>{Nn.preventDefault();try{if(D==="add")await $r.post(Ir.backend.api.equipmentAdd,$);else if(D==="edit"&&$.equipment_id){const ci=Ir.backend.api.equipmentUpdate.replace("{id}",$.equipment_id);await $r.put(ci,$)}B({equipment_id:null,name:"",description:"",stock_quantity:0,status:"active"}),V("add"),Ot(c),K(!1),X(D==="add"?`Item "${$.name}" successfully added`:`Item "${$.name}" successfully updated`),setTimeout(()=>X(""),3e3)}catch(ci){console.error("Error saving equipment:",ci)}},Jt=Nn=>{B({equipment_id:Nn.equipment_id,name:Nn.name,description:Nn.description||"",stock_quantity:Nn.stock_quantity||0,status:Nn.status||"active"}),V("edit"),K(!0)},Cn=Nn=>{rt(Nn),it(0),nt(!0)},nr=async()=>{if(Ee<=0){alert("Please enter a positive quantity to add");return}try{const Nn=Me.stock_quantity+Ee,ci=Ir.backend.api.equipmentUpdateStock.replace("{id}",Me.equipment_id);await $r.put(ci,{stock_quantity:Nn}),nt(!1),rt(null),it(0),Ot(c),X(`Stock updated successfully! Added ${Ee} to ${Me.name}`),setTimeout(()=>X(""),3e3)}catch(Nn){console.error("Error updating stock:",Nn)}},sn=Nn=>{pt(Nn),mt(!0)},zr=async()=>{if(He)try{const Nn=Ir.backend.api.equipmentArchive.replace("{id}",He.equipment_id);await $r.put(Nn),Ot(c),mt(!1),pt(null),X(`Equipment "${He.name}" archived successfully`),setTimeout(()=>X(""),3e3)}catch(Nn){console.error("Error archiving equipment:",Nn)}},or=Nn=>{Pt(Nn),Je(!0)},Rr=async()=>{if(jt)try{const Nn=Ir.backend.api.equipmentActivate.replace("{id}",jt.equipment_id);await $r.put(Nn),Ot(c),Je(!1),Pt(null),X(`Equipment "${jt.name}" activated successfully`),setTimeout(()=>X(""),3e3)}catch(Nn){console.error("Error activating equipment:",Nn)}},qr=Nn=>{Nn<1||Nn>p||f(Nn)};return o.jsxs("div",{className:"p-8 max-w-7xl mx-auto",children:[o.jsx("div",{className:"bg-white shadow-md rounded-lg border border-gray-100 overflow-hidden",children:o.jsxs("div",{className:"p-6",children:[o.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 mb-4 tracking-tight",children:"Inventory Management"}),o.jsxs("div",{className:"mb-6 flex flex-col md:flex-row items-stretch md:items-center justify-between gap-4",children:[o.jsx("div",{className:"flex items-center flex-1 mb-2 md:mb-0",children:o.jsx("input",{type:"text",placeholder:"Search equipment...",value:n,onChange:Nn=>{r(Nn.target.value),f(1)},className:"w-full bg-gray-50 border border-gray-200 rounded-md px-4 py-3 text-sm text-gray-700 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent"})}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>{N(Nn=>!Nn),f(1)},className:`ml-0 md:ml-2 inline-flex items-center px-4 py-2 rounded-md text-sm font-semibold tracking-wide shadow-sm focus:outline-none focus:ring-2 ${E?"bg-gray-700 text-white hover:bg-gray-800 focus:ring-gray-600":"bg-gray-200 text-gray-800 hover:bg-gray-300 focus:ring-gray-400"}`,children:E?"Showing Archived":"Show Archived"}),o.jsx("button",{onClick:()=>{V("add"),B({equipment_id:null,name:"",description:"",stock_quantity:0,status:"active"}),K(!0)},className:"ml-0 md:ml-4 inline-flex items-center bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-semibold tracking-wide shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:"Add Equipment"})]})]}),w?o.jsx("p",{className:"text-sm text-gray-500",children:"Loading equipment..."}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs("table",{className:"min-w-full w-full table-auto divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Name"}),o.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Description"}),o.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Category"}),o.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Stock"}),o.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Storage"}),o.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Created"}),o.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Updated"}),o.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:e.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:"9",className:"text-center py-8 text-sm text-gray-500",children:"No equipment found."})}):e.map(Nn=>o.jsxs("tr",{className:"odd:bg-white even:bg-gray-50 hover:bg-blue-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:Nn.name}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:Nn.description||"-"}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:Nn.category_name||"-"}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-800 font-medium",children:Nn.stock_quantity}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:Nn.location_name||"-"}),o.jsx("td",{className:"px-6 py-4 text-sm",children:o.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold ${Nn.status==="archived"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:Nn.status})}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(Nn.created_at).toLocaleString("en-PH",{timeZone:"Asia/Manila"})}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(Nn.updated_at).toLocaleString("en-PH",{timeZone:"Asia/Manila"})}),o.jsx("td",{className:"px-6 py-4 text-sm",children:o.jsx("div",{className:"flex flex-col gap-2",children:Nn.status==="archived"?o.jsx("div",{className:"flex",children:o.jsx("button",{onClick:()=>or(Nn),className:"w-full inline-flex justify-center items-center bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded-md text-xs font-semibold",children:"Activate"})}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>Jt(Nn),className:"inline-flex items-center bg-green-600 hover:bg-green-700 text-white px-3 py-1.5 rounded-md text-xs font-semibold",children:"Edit"}),o.jsx("button",{onClick:()=>sn(Nn),className:"inline-flex items-center bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded-md text-xs font-semibold",children:"Archive"})]}),o.jsx("div",{className:"flex",children:o.jsx("button",{onClick:()=>Cn(Nn),className:"inline-flex items-center bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-1.5 rounded-md text-xs font-semibold",children:"Update Stock"})})]})})})]},Nn.equipment_id))})]})}),o.jsx("div",{className:"md:hidden space-y-3",children:e.length===0?o.jsx("div",{className:"text-center py-8 text-sm text-gray-500",children:"No equipment found."}):e.map(Nn=>o.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm",children:[o.jsx("div",{className:"flex justify-between items-start gap-3",children:o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-800 truncate",children:Nn.name}),o.jsx("span",{className:`text-xs font-medium inline-flex items-center px-2 py-0.5 rounded-full ${Nn.status==="archived"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:Nn.status})]}),o.jsx("p",{className:"text-xs text-gray-600 mt-1 truncate",children:Nn.description||"-"}),o.jsxs("div",{className:"mt-2 text-xs text-gray-600 grid grid-cols-2 gap-2",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Category:"})," ",o.jsx("span",{className:"ml-1",children:Nn.category_name||"-"})]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Stock:"})," ",o.jsx("span",{className:"ml-1 font-medium",children:Nn.stock_quantity})]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Storage:"})," ",o.jsx("span",{className:"ml-1",children:Nn.location_name||"-"})]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Updated:"})," ",o.jsx("span",{className:"ml-1",children:new Date(Nn.updated_at).toLocaleString("en-PH",{timeZone:"Asia/Manila"})})]})]})]})}),o.jsx("div",{className:"mt-3 flex flex-col sm:flex-row gap-2",children:Nn.status==="archived"?o.jsx("button",{onClick:()=>or(Nn),className:"w-full inline-flex justify-center items-center bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-md text-xs font-semibold",children:"Activate"}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex gap-2 w-full",children:[o.jsx("button",{onClick:()=>Jt(Nn),className:"flex-1 inline-flex items-center justify-center bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-md text-xs font-semibold",children:"Edit"}),o.jsx("button",{onClick:()=>sn(Nn),className:"flex-1 inline-flex items-center justify-center bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-md text-xs font-semibold",children:"Archive"})]}),o.jsx("button",{onClick:()=>Cn(Nn),className:"w-full inline-flex items-center justify-center bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-2 rounded-md text-xs font-semibold",children:"Update Stock"})]})})]},Nn.equipment_id))}),o.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[o.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",c," of ",p]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("button",{onClick:()=>qr(c-1),disabled:c<=1,className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-md text-sm disabled:opacity-50",children:"Previous"}),o.jsx("button",{onClick:()=>qr(c+1),disabled:c>=p,className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-md text-sm disabled:opacity-50",children:"Next"})]})]})]})]})}),$e&&Me&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 w-full max-w-md mx-4",children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Update Stock"}),o.jsx("button",{onClick:()=>{nt(!1),rt(null),it(0)},className:"text-gray-400 hover:text-gray-600","aria-label":"Close",children:"×"})]}),o.jsx("div",{className:"mb-4",children:o.jsxs("div",{className:"bg-gray-50 p-3 rounded border border-gray-100",children:[o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("strong",{children:"Name:"})," ",Me.name]}),o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("strong",{children:"Current Stock:"})," ",Me.stock_quantity]}),o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("strong",{children:"Category:"})," ",Me.category_name||"N/A"]})]})}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Quantity to Add"}),o.jsx("input",{type:"number",value:Ee,onChange:Nn=>it(parseInt(Nn.target.value,10)||0),min:"0",className:"w-full border border-gray-200 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"Enter quantity to add"})]}),o.jsxs("div",{className:"mb-4 text-sm text-gray-600",children:[o.jsx("strong",{children:"New Stock Total:"})," ",Me.stock_quantity+Ee]}),o.jsxs("div",{className:"mt-4 flex justify-end gap-3",children:[o.jsx("button",{onClick:()=>{nt(!1),rt(null),it(0)},className:"px-4 py-2 rounded-md bg-white border border-gray-200 text-gray-700 text-sm hover:bg-gray-50",children:"Cancel"}),o.jsx("button",{onClick:nr,className:"px-4 py-2 rounded-md bg-blue-600 text-white text-sm hover:bg-blue-700",children:"Save"})]})]})}),F&&o.jsx(o.Fragment,{children:o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 w-full max-w-xl max-h-[90vh] overflow-auto mx-4",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-900",children:D==="add"?"Add New Equipment":"Edit Equipment"}),o.jsx("button",{onClick:()=>K(!1),className:"text-gray-400 hover:text-gray-600","aria-label":"Close",children:"×"})]}),o.jsxs("form",{onSubmit:an,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Name"}),o.jsx("input",{name:"name",value:$.name,onChange:Mt,required:!0,maxLength:100,className:"w-full border border-gray-200 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Description"}),o.jsx("textarea",{name:"description",value:$.description,onChange:Mt,className:"w-full border border-gray-200 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Stock Quantity"}),o.jsx("input",{name:"stock_quantity",type:"number",value:$.stock_quantity,onChange:Mt,min:"0",required:!0,className:"w-full border border-gray-200 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),o.jsxs("div",{className:"mt-4 flex justify-end gap-3",children:[o.jsx("button",{type:"button",onClick:()=>K(!1),className:"px-4 py-2 rounded-md bg-white border border-gray-200 text-gray-700 text-sm hover:bg-gray-50",children:"Cancel"}),o.jsx("button",{type:"submit",className:"px-4 py-2 rounded-md bg-blue-600 text-white text-sm hover:bg-blue-700",children:D==="add"?"Add Equipment":"Update Equipment"})]})]})]})})}),et&&He&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 w-full max-w-md mx-4",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-bold text-red-600",children:"Archive Equipment"}),o.jsx("button",{onClick:()=>{mt(!1),pt(null)},className:"text-gray-400 hover:text-gray-600","aria-label":"Close",children:"×"})]}),o.jsx("div",{className:"mb-4",children:o.jsxs("div",{className:"bg-gray-50 p-3 rounded border border-gray-100",children:[o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("strong",{children:"Name:"})," ",He.name]}),o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("strong",{children:"Description:"})," ",He.description||"N/A"]}),o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("strong",{children:"Category:"})," ",He.category_name||"N/A"]}),o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("strong",{children:"Current Stock:"})," ",He.stock_quantity]}),o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("strong",{children:"Status:"})," ",He.status]})]})}),o.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:[o.jsx("strong",{children:"Warning:"})," This action will archive the equipment and mark it as archived. It will no longer be available for regular operations."]}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{onClick:()=>{mt(!1),pt(null)},className:"px-4 py-2 rounded-md bg-white border border-gray-200 text-gray-700 text-sm hover:bg-gray-50",children:"Cancel"}),o.jsx("button",{onClick:zr,className:"px-4 py-2 rounded-md bg-red-600 text-white text-sm hover:bg-red-700",children:"Archive"})]})]})}),We&&jt&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 w-full max-w-md mx-4",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-bold text-blue-600",children:"Activate Equipment"}),o.jsx("button",{onClick:()=>{Je(!1),Pt(null)},className:"text-gray-400 hover:text-gray-600","aria-label":"Close",children:"×"})]}),o.jsx("div",{className:"mb-4",children:o.jsxs("div",{className:"bg-gray-50 p-3 rounded border border-gray-100",children:[o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("strong",{children:"Name:"})," ",jt.name]}),o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("strong",{children:"Description:"})," ",jt.description||"N/A"]}),o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("strong",{children:"Category:"})," ",jt.category_name||"N/A"]}),o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("strong",{children:"Current Stock:"})," ",jt.stock_quantity]}),o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("strong",{children:"Status:"})," ",jt.status]})]})}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Activating will make this equipment available again for regular operations."}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{onClick:()=>{Je(!1),Pt(null)},className:"px-4 py-2 rounded-md bg-white border border-gray-200 text-gray-700 text-sm hover:bg-gray-50",children:"Cancel"}),o.jsx("button",{onClick:Rr,className:"px-4 py-2 rounded-md bg-blue-600 text-white text-sm hover:bg-blue-700",children:"Activate"})]})]})}),Y&&o.jsx("div",{className:"fixed bottom-6 right-6 bg-gradient-to-r from-green-600 to-green-500 text-white px-5 py-3 rounded-lg shadow-lg z-50",children:o.jsx("div",{className:"text-sm",children:Y})})]})},OVe=()=>{const[e,t]=z.useState([]),[n,r]=z.useState([]),[c,f]=z.useState([]),[p,s]=z.useState(""),[w,T]=z.useState(!1),[E,N]=z.useState(""),[D,V]=z.useState(""),[$,B]=z.useState(!1),[F,K]=z.useState(!1),[Y,X]=z.useState(new Set),[ae,Z]=z.useState(""),[se,he]=z.useState(""),[ye,Ce]=z.useState(!1),[Ve,Re]=z.useState(!1),[$e,nt]=z.useState(null),[Me,rt]=z.useState(!1),[Ee,it]=z.useState(!1),[et,mt]=z.useState(""),[He,pt]=z.useState(""),[We,Je]=z.useState(""),[jt,Pt]=z.useState(!1),[Ot,Mt]=z.useState(""),[an,Jt]=z.useState({totalEquipment:0,assignedLocations:0,assignedCategories:0,unassignedItems:0}),[Cn,nr]=z.useState(!1),[sn,zr]=z.useState(!1),or=async(Fe=!1)=>{T(!0);try{const jn={};Fe&&(jn.all="true");const Xn=await $r.get(Ir.backend.api.equipment,{params:jn});let mr=[];Array.isArray(Xn.data)?mr=Xn.data:Xn.data&&Array.isArray(Xn.data.data)?mr=Xn.data.data:Xn.data&&typeof Xn.data=="object"&&(mr=Xn.data.data||[]),Array.isArray(mr)&&mr.length>0&&(mr=mr.sort((Ur,yi)=>{const Hi=new Date(Ur.created_at);return new Date(yi.created_at)-Hi})),t(mr),Nn(mr)}catch(jn){console.error("Error fetching equipment:",jn),Mt("Error loading equipment data"),setTimeout(()=>Mt(""),3e3)}finally{T(!1)}},Rr=async()=>{try{const Fe=await $r.get(Ir.backend.api.equipmentCategory);r(Fe.data)}catch(Fe){console.error("Error fetching categories:",Fe)}},qr=async()=>{try{const Fe=await $r.get(Ir.backend.api.storageLocation);f(Fe.data)}catch(Fe){console.error("Error fetching storage locations:",Fe)}},Nn=Fe=>{const jn=Fe.length,Xn=Fe.filter(yi=>yi.storage_location_id).length,mr=Fe.filter(yi=>yi.category_id).length,Ur=Fe.filter(yi=>!yi.storage_location_id||!yi.category_id).length;Jt({totalEquipment:jn,assignedLocations:Xn,assignedCategories:mr,unassignedItems:Ur})};z.useEffect(()=>{or(!0),Rr(),qr()},[]);const ci=e.filter(Fe=>{const jn=Fe.name.toLowerCase().includes(p.toLowerCase())||Fe.description?.toLowerCase().includes(p.toLowerCase()),Xn=!E||Fe.category_id!=null&&String(Fe.category_id)===String(E),mr=!D||Fe.storage_location_id!=null&&String(Fe.storage_location_id)===String(D),Ur=!$||!Fe.category_id||!Fe.storage_location_id;return jn&&Xn&&mr&&Ur}),ui=ci.filter(Fe=>Fe.status!=="archived"),st=async(Fe,jn,Xn)=>{try{const mr=e.find(Ur=>Ur.equipment_id===Fe);if(!mr||mr.status==="archived"){Mt("Cannot assign archived equipment"),setTimeout(()=>Mt(""),3e3);return}if(jn){const Ur=Ir.backend.api.categorizeEquipment.replace("{equipmentId}",Fe).replace("{categoryId}",jn);await $r.put(Ur)}if(Xn){const Ur=Ir.backend.api.equipmentUpdate.replace("{id}",Fe);await $r.put(Ur,{storage_location_id:Xn})}or(),Re(!1),nt(null),Mt("Equipment assignment updated successfully"),setTimeout(()=>Mt(""),3e3)}catch(mr){console.error("Error updating equipment assignment:",mr)}},qt=async()=>{if(Y.size===0){alert("Please select items to assign");return}try{const Fe=Array.from(Y).filter(Xn=>{const mr=e.find(Ur=>Ur.equipment_id===Xn);return mr&&mr.status!=="archived"});if(Fe.length===0){alert("Selected items are archived and cannot be assigned.");return}const jn=[];Fe.forEach(Xn=>{if(ae){const mr=Ir.backend.api.categorizeEquipment.replace("{equipmentId}",Xn).replace("{categoryId}",ae);jn.push($r.put(mr))}if(se){const mr=Ir.backend.api.equipmentUpdate.replace("{id}",Xn);jn.push($r.put(mr,{storage_location_id:se}))}}),await Promise.all(jn),or(),Ce(!1),X(new Set),Z(""),he(""),K(!1),Mt(`Successfully assigned ${Fe.length} items`),setTimeout(()=>Mt(""),3e3)}catch(Fe){console.error("Error bulk assigning equipment:",Fe)}},rn=Fe=>{const jn=e.find(mr=>mr.equipment_id===Fe);if(!jn||jn.status==="archived")return;const Xn=new Set(Y);Xn.has(Fe)?Xn.delete(Fe):Xn.add(Fe),X(Xn)},Wn=()=>{Y.size===ui.length?X(new Set):X(new Set(ui.map(Fe=>Fe.equipment_id)))},Vt=Fe=>{if(Fe.status==="archived"){Mt("Cannot assign archived equipment"),setTimeout(()=>Mt(""),3e3);return}nt(Fe),Re(!0)},un=async()=>{if(!et.trim()){Mt("Category name is required"),setTimeout(()=>Mt(""),3e3);return}try{Pt(!0),await $r.post(Ir.backend.api.equipmentCategoryAdd,{category_name:et.trim()}),await Rr(),rt(!1),mt(""),Mt("Category added successfully"),setTimeout(()=>Mt(""),3e3)}catch(Fe){console.error("Error adding category:",Fe),Mt("Failed to add category"),setTimeout(()=>Mt(""),3e3)}finally{Pt(!1)}},hr=async()=>{if(!He.trim()){Mt("Location name is required"),setTimeout(()=>Mt(""),3e3);return}try{Pt(!0),await $r.post(Ir.backend.api.storageLocationAdd,{location_name:He.trim(),description:We.trim()}),await qr(),it(!1),pt(""),Je(""),Mt("Location added successfully"),setTimeout(()=>Mt(""),3e3)}catch(Fe){console.error("Error adding location:",Fe),Mt("Failed to add location"),setTimeout(()=>Mt(""),3e3)}finally{Pt(!1)}},$t=async(Fe,jn)=>{for(const Xn of Fe)if(Xn)try{if(Xn.includes("{id}")){try{return await $r.put(Xn,jn),!0}catch{}try{return await $r.delete(Xn),!0}catch{}}else{try{return await $r.put(Xn,jn),!0}catch{}try{return await $r.delete(Xn),!0}catch{}}}catch{}return!1},lr=async Fe=>{if(!(!Fe||!Fe.category_id)&&window.confirm(`Archive category "${Fe.category_name}"? This cannot be undone easily.`)){zr(!0);try{const jn=Fe.category_id,Xn=[Ir?.backend?.api?.equipmentCategoryArchive?.replace("{id}",jn),Ir?.backend?.api?.equipmentCategoryUpdate?.replace("{id}",jn),Ir?.backend?.api?.equipmentCategory?`${Ir.backend.api.equipmentCategory.replace(/\/$/,"")}/${jn}`:null];await $t(Xn,{status:"archived"})?(Mt(`Category "${Fe.category_name}" archived`),await Rr()):Mt("Failed to archive category (no compatible endpoint found)")}catch(jn){console.error("Error archiving category:",jn),Mt("Error archiving category")}finally{zr(!1),setTimeout(()=>Mt(""),3e3)}}},ze=async Fe=>{if(!(!Fe||!Fe.storage_location_id)&&window.confirm(`Archive location "${Fe.location_name}"? This cannot be undone easily.`)){zr(!0);try{const jn=Fe.storage_location_id,Xn=[Ir?.backend?.api?.storageLocationArchive?.replace("{id}",jn),Ir?.backend?.api?.storageLocationUpdate?.replace("{id}",jn),Ir?.backend?.api?.storageLocation?`${Ir.backend.api.storageLocation.replace(/\/$/,"")}/${jn}`:null];await $t(Xn,{status:"archived"})?(Mt(`Location "${Fe.location_name}" archived`),await qr()):Mt("Failed to archive location (no compatible endpoint found)")}catch(jn){console.error("Error archiving location:",jn),Mt("Error archiving location")}finally{zr(!1),setTimeout(()=>Mt(""),3e3)}}};return o.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Storage Organization"}),o.jsxs("div",{className:"mb-6 bg-white rounded-lg shadow-md p-4",children:[o.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Organization Overview"}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:an.totalEquipment}),o.jsx("div",{className:"text-sm text-blue-800",children:"Total Equipment"})]}),o.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:an.assignedLocations}),o.jsx("div",{className:"text-sm text-green-800",children:"Assigned Locations"})]}),o.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-purple-600",children:an.assignedCategories}),o.jsx("div",{className:"text-sm text-purple-800",children:"Assigned Categories"})]}),o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-red-600",children:an.unassignedItems}),o.jsx("div",{className:"text-sm text-red-800",children:"Unassigned Items"})]})]})]}),o.jsxs("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex flex-wrap items-center space-x-4 flex-1",children:[o.jsx("input",{type:"text",placeholder:"Search equipment...",value:p,onChange:Fe=>s(Fe.target.value),className:"border border-gray-300 rounded px-3 py-2 w-full md:w-64"}),o.jsxs("select",{value:E,onChange:Fe=>N(Fe.target.value),className:"border border-gray-300 rounded px-3 py-2 w-full md:w-48",children:[o.jsx("option",{value:"",children:"All Categories"}),n.map(Fe=>o.jsx("option",{value:String(Fe.category_id),children:Fe.category_name},Fe.category_id))]}),o.jsxs("select",{value:D,onChange:Fe=>V(Fe.target.value),className:"border border-gray-300 rounded px-3 py-2 w-full md:w-48",children:[o.jsx("option",{value:"",children:"All Locations"}),c.map(Fe=>o.jsx("option",{value:String(Fe.storage_location_id),children:Fe.location_name},Fe.storage_location_id))]}),o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",checked:$,onChange:Fe=>B(Fe.target.checked),className:"mr-2"}),"Show Unassigned Only"]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>K(!F),className:`px-4 py-2 rounded ${F?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:F?"Exit Bulk Mode":"Bulk Assign"}),o.jsxs("button",{onClick:()=>{Ce(!0),Z(""),he("")},disabled:!F||Y.size===0,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:["Assign Selected (",Y.size,")"]}),o.jsx("button",{onClick:()=>rt(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700",title:"Add a new category",children:"Add Category"}),o.jsx("button",{onClick:()=>it(!0),className:"bg-teal-600 text-white px-4 py-2 rounded hover:bg-teal-700",title:"Add a new storage location",children:"Add Location"}),o.jsx("button",{onClick:()=>nr(!0),className:"bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700",title:"View and manage all categories and locations",children:"Manage Categories & Locations"})]})]}),w?o.jsx("p",{children:"Loading equipment..."}):o.jsxs(o.Fragment,{children:[F&&o.jsxs("div",{className:"mb-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[o.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Bulk Assignment Mode"}),o.jsx("p",{className:"text-sm text-blue-700",children:'Select items using checkboxes, then click "Assign Selected" to assign them to categories and locations.'})]}),o.jsxs("table",{className:"min-w-full border border-gray-300 rounded overflow-hidden",children:[o.jsx("thead",{className:"bg-gray-100",children:o.jsxs("tr",{children:[F&&o.jsx("th",{className:"text-left px-4 py-2 border-b border-gray-300 w-12",children:o.jsx("input",{type:"checkbox",checked:Y.size===ui.length&&ui.length>0,onChange:Wn,className:"rounded","aria-label":"select all non-archived"})}),o.jsx("th",{className:"text-left px-4 py-2 border-b border-gray-300",children:"Equipment"}),o.jsx("th",{className:"text-left px-4 py-2 border-b border-gray-300",children:"Category"}),o.jsx("th",{className:"text-left px-4 py-2 border-b border-gray-300",children:"Storage Location"}),o.jsx("th",{className:"text-left px-4 py-2 border-b border-gray-300",children:"Stock"}),o.jsx("th",{className:"text-left px-4 py-2 border-b border-gray-300",children:"Status"}),o.jsx("th",{className:"text-left px-4 py-2 border-b border-gray-300",children:"Actions"})]})}),o.jsx("tbody",{children:ci.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:F?"7":"6",className:"text-center py-4",children:p||E||D||$?"No equipment matches your filters.":"No equipment found."})}):ci.map(Fe=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[F&&o.jsx("td",{className:"px-4 py-2 border-b border-gray-300",children:o.jsx("input",{type:"checkbox",checked:Y.has(Fe.equipment_id),onChange:()=>rn(Fe.equipment_id),className:`rounded ${Fe.status==="archived"?"opacity-50 cursor-not-allowed":""}`,disabled:Fe.status==="archived",title:Fe.status==="archived"?"Archived items cannot be selected":"Select item"})}),o.jsx("td",{className:"px-4 py-2 border-b border-gray-300",children:o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:Fe.name}),Fe.description&&o.jsx("div",{className:"text-sm text-gray-600",children:Fe.description})]})}),o.jsx("td",{className:"px-4 py-2 border-b border-gray-300",children:o.jsx("span",{className:`px-2 py-1 rounded text-xs ${Fe.category_id?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-600"}`,children:Fe.category_name||"Unassigned"})}),o.jsx("td",{className:"px-4 py-2 border-b border-gray-300",children:o.jsx("span",{className:`px-2 py-1 rounded text-xs ${Fe.storage_location_id?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:Fe.location_name||"Unassigned"})}),o.jsx("td",{className:"px-4 py-2 border-b border-gray-300",children:o.jsx("span",{className:`px-2 py-1 rounded text-xs ${Fe.stock_quantity<=3?"bg-red-100 text-red-800":Fe.stock_quantity>=50?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:Fe.stock_quantity})}),o.jsx("td",{className:"px-4 py-2 border-b border-gray-300",children:o.jsx("span",{className:`px-2 py-1 rounded text-xs ${Fe.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:Fe.status})}),o.jsx("td",{className:"px-4 py-2 border-b border-gray-300",children:F?o.jsx("span",{className:"text-sm text-gray-500",children:"Bulk Mode"}):o.jsx("button",{onClick:()=>Vt(Fe),className:`px-3 py-1 rounded text-sm ${Fe.status==="archived"?"bg-gray-300 text-gray-600 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,disabled:Fe.status==="archived",title:Fe.status==="archived"?"Cannot assign archived equipment":"Quick Assign",children:Fe.status==="archived"?"Archived":"Quick Assign"})})]},Fe.equipment_id))})]})]}),ye&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[o.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Bulk Assign Equipment"}),o.jsx("div",{className:"mb-4",children:o.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Assigning ",Y.size," selected items"]})}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block mb-2 font-medium",children:"Category:"}),o.jsxs("select",{value:ae,onChange:Fe=>Z(Fe.target.value),className:"w-full border border-gray-300 rounded px-3 py-2",children:[o.jsx("option",{value:"",children:"-- No Category Change --"}),n.map(Fe=>o.jsx("option",{value:Fe.category_id,children:Fe.category_name},Fe.category_id))]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block mb-2 font-medium",children:"Storage Location:"}),o.jsxs("select",{value:se,onChange:Fe=>he(Fe.target.value),className:"w-full border border-gray-300 rounded px-3 py-2",children:[o.jsx("option",{value:"",children:"-- No Location Change --"}),c.map(Fe=>o.jsx("option",{value:Fe.storage_location_id,children:Fe.location_name},Fe.storage_location_id))]})]}),o.jsxs("div",{className:"flex space-x-4",children:[o.jsx("button",{onClick:qt,disabled:!ae&&!se,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50",children:"Assign Items"}),o.jsx("button",{onClick:()=>{Ce(!1),Z(""),he("")},className:"bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400",children:"Cancel"})]})]})}),Ve&&$e&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[o.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Quick Assign Equipment"}),o.jsxs("div",{className:"mb-4",children:[o.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Equipment Details:"}),o.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Name:"})," ",$e.name]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Current Category:"})," ",$e.category_name||"Unassigned"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Current Location:"})," ",$e.location_name||"Unassigned"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Stock:"})," ",$e.stock_quantity]})]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block mb-2 font-medium",children:"Assign Category:"}),o.jsxs("select",{value:$e&&$e.category_id!=null?String($e.category_id):"",onChange:Fe=>nt({...$e,category_id:Fe.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",children:[o.jsx("option",{value:"",children:"-- No Category --"}),n.map(Fe=>o.jsx("option",{value:String(Fe.category_id),children:Fe.category_name},Fe.category_id))]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block mb-2 font-medium",children:"Assign Storage Location:"}),o.jsxs("select",{value:$e&&$e.storage_location_id!=null?String($e.storage_location_id):"",onChange:Fe=>nt({...$e,storage_location_id:Fe.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",children:[o.jsx("option",{value:"",children:"-- No Location --"}),c.map(Fe=>o.jsx("option",{value:String(Fe.storage_location_id),children:Fe.location_name},Fe.storage_location_id))]})]}),o.jsxs("div",{className:"flex space-x-4",children:[o.jsx("button",{onClick:()=>st($e.equipment_id,$e.category_id,$e.storage_location_id),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Update Assignment"}),o.jsx("button",{onClick:()=>{Re(!1),nt(null)},className:"bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400",children:"Cancel"})]})]})}),Me&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[o.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Add Category"}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block mb-2 font-medium",children:"Category Name:"}),o.jsx("input",{type:"text",value:et,onChange:Fe=>mt(Fe.target.value),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"Enter category name"})]}),o.jsxs("div",{className:"flex space-x-4",children:[o.jsx("button",{onClick:un,disabled:jt,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50",children:jt?"Adding...":"Add Category"}),o.jsx("button",{onClick:()=>{rt(!1),mt("")},className:"bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400",children:"Cancel"})]})]})}),Ee&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[o.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Add Storage Location"}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block mb-2 font-medium",children:"Location Name:"}),o.jsx("input",{type:"text",value:He,onChange:Fe=>pt(Fe.target.value),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"Enter location name"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block mb-2 font-medium",children:"Description:"}),o.jsx("textarea",{value:We,onChange:Fe=>Je(Fe.target.value),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"Enter location description (optional)",rows:"3"})]}),o.jsxs("div",{className:"flex space-x-4",children:[o.jsx("button",{onClick:hr,disabled:jt,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50",children:jt?"Adding...":"Add Location"}),o.jsx("button",{onClick:()=>{it(!1),pt("")},className:"bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400",children:"Cancel"})]})]})}),Cn&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-4xl max-h-[80vh] overflow-auto",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-xl font-semibold",children:"Manage Categories & Locations"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:async()=>{zr(!0),await Rr(),await qr(),zr(!1)},className:"bg-gray-200 text-gray-700 px-3 py-1 rounded hover:bg-gray-300",children:"Refresh"}),o.jsx("button",{onClick:()=>nr(!1),className:"bg-gray-300 text-gray-700 px-3 py-1 rounded hover:bg-gray-400",children:"Close"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold mb-3",children:"Categories"}),o.jsxs("div",{className:"space-y-3",children:[n.length===0?o.jsx("p",{className:"text-sm text-gray-500",children:"No categories found."}):null,n.map(Fe=>o.jsxs("div",{className:"border rounded p-3 flex items-start justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:Fe.category_name}),Fe.description&&o.jsx("div",{className:"text-sm text-gray-600",children:Fe.description}),Fe.status&&o.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Status: ",Fe.status]})]}),o.jsx("div",{className:"flex flex-col items-end space-y-2",children:Fe.status==="archived"?o.jsx("span",{className:"text-sm text-red-600",children:"Archived"}):o.jsx("button",{onClick:()=>lr(Fe),disabled:sn,className:"bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700 disabled:opacity-50",children:sn?"Working...":"Archive"})})]},Fe.category_id))]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold mb-3",children:"Storage Locations"}),o.jsxs("div",{className:"space-y-3",children:[c.length===0?o.jsx("p",{className:"text-sm text-gray-500",children:"No storage locations found."}):null,c.map(Fe=>o.jsxs("div",{className:"border rounded p-3 flex items-start justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:Fe.location_name}),Fe.description&&o.jsx("div",{className:"text-sm text-gray-600",children:Fe.description}),Fe.status&&o.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Status: ",Fe.status]})]}),o.jsx("div",{className:"flex flex-col items-end space-y-2",children:Fe.status==="archived"?o.jsx("span",{className:"text-sm text-red-600",children:"Archived"}):o.jsx("button",{onClick:()=>ze(Fe),disabled:sn,className:"bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700 disabled:opacity-50",children:sn?"Working...":"Archive"})})]},Fe.storage_location_id))]})]})]})]})}),Ot&&o.jsx("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-green-600 text-white px-6 py-3 rounded shadow-lg z-50",children:Ot})]})},DVe=()=>{const[e,t]=z.useState("overview"),[n,r]=z.useState([]),[c,f]=z.useState([]),[p,s]=z.useState([]),[w,T]=z.useState(0),[E,N]=z.useState(0),[D,V]=z.useState(0),[$,B]=z.useState(!0),[F,K]=z.useState(null),[Y,X]=z.useState(""),[ae,Z]=z.useState(!1),[se,he]=z.useState(!1),[ye,Ce]=z.useState(null),[Ve,Re]=z.useState(null),[$e,nt]=z.useState(!1),[Me,rt]=z.useState(!1),[Ee,it]=z.useState(!1),[et,mt]=z.useState([]),[He,pt]=z.useState(!1),[We,Je]=z.useState({}),[jt,Pt]=z.useState(!1),Ot=z.useRef(null),Mt=z.useRef(null),[an,Jt]=z.useState({show:!1,message:"",type:"success",title:""}),Cn=ze=>{if(Array.isArray(ze))return{items:ze,total:ze.length};if(ze&&Array.isArray(ze.data)){const Fe=ze.total??(ze.meta&&(ze.meta.total||ze.meta.pagination?.total))??(ze.meta&&(ze.meta.total_count||ze.meta.totalCount))??ze.data.length;return{items:ze.data,total:Fe}}return ze&&Array.isArray(ze.items)?{items:ze.items,total:ze.total??ze.items.length}:{items:[],total:0}},nr=async()=>{try{B(!0),K(null);const ze="?per_page=10000",[Fe,jn,Xn]=await Promise.all([fetch(`${Ir.backend.uri}/api/equipment${ze}`),fetch(`${Ir.backend.uri}/api/low-stock-alert${ze}`),fetch(`${Ir.backend.uri}/api/overstock-alert${ze}`)]);if(!Fe.ok||!jn.ok||!Xn.ok)throw new Error("Failed to fetch data");const[mr,Ur,yi]=await Promise.all([Fe.json(),jn.json(),Xn.json()]),Hi=Cn(mr),xr=Cn(Ur),dr=Cn(yi);r(Hi.items),T(Hi.total),f(xr.items),N(xr.total),s(dr.items),V(dr.total)}catch(ze){K(ze.message),console.error("Error fetching stock data:",ze)}finally{B(!1),Z(!1)}};z.useEffect(()=>{nr()},[]);const sn=async()=>{Z(!0),await nr()},zr=()=>{mt([]),rt(!0)},or=ze=>{mt(Fe=>Fe.includes(ze)?Fe.filter(jn=>jn!==ze):[...Fe,ze])},Rr=()=>{et.length===c.length?mt([]):mt(c.map(ze=>ze.equipment_id))},qr=()=>{if(et.length===0){Jt({show:!0,type:"error",title:"No Selection",message:"Please select at least one item to request stock."});return}const ze={};et.forEach(Fe=>{const jn=c.find(Xn=>Xn.equipment_id===Fe);if(jn){const Xn=Math.max(1,10-jn.stock_quantity);ze[Fe]=Xn}}),Je(ze),rt(!1),pt(!0)},Nn=async()=>{if(Object.values(We).some(Fe=>!Fe||Fe<1)){Jt({show:!0,type:"error",title:"Invalid Quantities",message:"All quantities must be at least 1."});return}Pt(!0);try{const Fe=et.map(Ur=>({item_name:c.find(Hi=>Hi.equipment_id===Ur).name,quantity:We[Ur],requested_by:"requested by SWS"})),jn=Fe.map(Ur=>fetch(Ir.backend.api.lowStockRequests,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ur)})),mr=(await Promise.all(jn)).filter(Ur=>!Ur.ok);if(mr.length>0)throw new Error(`${mr.length} out of ${Fe.length} requests failed`);Jt({show:!0,type:"success",title:"Stock Requests Submitted",message:`Successfully submitted ${Fe.length} stock request(s).`}),hr()}catch(Fe){console.error("Error submitting requests:",Fe),Jt({show:!0,type:"error",title:"Submission Failed",message:Fe.message||"Failed to submit stock requests."})}finally{Pt(!1)}},ci=n.filter(ze=>ze.name?.toLowerCase().includes(Y.toLowerCase())||ze.description?.toLowerCase().includes(Y.toLowerCase())||ze.category_name?.toLowerCase().includes(Y.toLowerCase())),ui=({quantity:ze,type:Fe="normal"})=>{const jn=()=>Fe==="low"||ze<=3?"bg-red-100 text-red-800 border-red-200":Fe==="over"||ze>=50?"bg-yellow-100 text-yellow-800 border-yellow-200":ze<=10?"bg-orange-100 text-orange-800 border-orange-200":"bg-green-100 text-green-800 border-green-200",Xn=()=>Fe==="low"||ze<=3?"⚠️":Fe==="over"||ze>=50?"📦":ze<=10?"⚡":"✅";return o.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${jn()}`,children:[Xn()," ",ze," units"]})},st=({item:ze})=>o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 border border-gray-200 hover:shadow-lg transition-shadow",children:[o.jsxs("div",{className:"flex justify-between items-start mb-3",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ze.name}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:ze.category_name&&o.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:ze.category_name})}),ze.location_name&&o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:o.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs",children:["📍 ",ze.location_name]})})]}),o.jsx(ui,{quantity:ze.stock_quantity})]}),ze.description&&o.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:ze.description}),o.jsxs("div",{className:"flex justify-between items-center text-sm",children:[o.jsx("span",{className:"text-gray-500",children:"Status:"}),o.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${ze.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:ze.status})]})]}),qt=({item:ze,isSelected:Fe,onToggle:jn})=>o.jsx("div",{className:`bg-white rounded-lg shadow-md p-4 border ${Fe?"border-blue-500 ring-2 ring-blue-200":"border-gray-200"} hover:shadow-lg transition-all`,children:o.jsxs("div",{className:"flex items-start mb-3",children:[o.jsx("input",{type:"checkbox",checked:Fe,onChange:()=>jn(ze.equipment_id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded mt-1 flex-shrink-0"}),o.jsxs("div",{className:"flex-1 ml-3",children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ze.name}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:ze.category_name&&o.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:ze.category_name})}),ze.location_name&&o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:o.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs",children:["📍 ",ze.location_name]})})]}),o.jsx(ui,{quantity:ze.stock_quantity,type:"low"})]}),ze.description&&o.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:ze.description}),o.jsxs("div",{className:"flex justify-between items-center text-sm",children:[o.jsx("span",{className:"text-gray-500",children:"Status:"}),o.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${ze.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:ze.status})]})]})]})}),rn=()=>o.jsxs("div",{className:"flex items-center justify-center py-12",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),o.jsx("span",{className:"ml-3 text-gray-600",children:"Loading stock data..."})]}),Wn=({message:ze,onRetry:Fe})=>o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("span",{className:"text-red-400",children:"❌"})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error loading data"}),o.jsx("p",{className:"text-sm text-red-700 mt-1",children:ze}),o.jsx("button",{onClick:Fe,className:"mt-2 bg-red-100 hover:bg-red-200 text-red-800 px-3 py-1 rounded text-sm font-medium transition-colors",children:"Try Again"})]})]})});z.useEffect(()=>{const ze=Fe=>{const{item:jn,type:Xn}=Fe.detail||{};!jn||!Xn||(Re(jn),Ce(Xn),he(!0))};return window.addEventListener("openArchiveModal",ze),()=>window.removeEventListener("openArchiveModal",ze)},[]),z.useEffect(()=>{if(!se)return;requestAnimationFrame(()=>{Ot.current?.focus()});const ze=Fe=>{Fe.key==="Escape"&&Vt(),Fe.key==="Enter"&&document.activeElement!==document.body&&Mt.current?.contains(document.activeElement)&&$t()};return window.addEventListener("keydown",ze),()=>window.removeEventListener("keydown",ze)},[se]);const Vt=()=>{he(!1),Re(null),Ce(null),nt(!1)},un=()=>{rt(!1),it(!1),mt([]),Je({}),pt(!1),Pt(!1)},hr=()=>{pt(!1),Je({}),Pt(!1),mt([])},$t=async()=>{if(!(!Ve||!ye)){nt(!0);try{const ze=Ve.category_id??Ve.storage_location_id;let Fe="";if(ye==="category"?Fe=Ir.backend.api.equipmentCategoryArchive.replace("{id}",ze):ye==="location"&&(Fe=Ir.backend.api.storageLocationArchive.replace("{id}",ze)),!(await fetch(Fe,{method:"PUT"})).ok)throw new Error("Archive request failed");await nr(),Jt({show:!0,type:"success",title:"Archived",message:`${ye==="category"?"Category":"Location"} archived successfully`})}catch(ze){console.error("Archive error:",ze),K(ze.message||"Failed to archive"),Jt({show:!0,type:"error",title:"Archive Failed",message:ze.message||"Failed to archive item"})}finally{nt(!1),Vt()}}};z.useEffect(()=>{if(!an.show)return;const ze=setTimeout(()=>Jt(Fe=>({...Fe,show:!1})),3800);return()=>clearTimeout(ze)},[an.show]);const lr=()=>Jt(ze=>({...ze,show:!1}));return $?o.jsx(rn,{}):F?o.jsx(Wn,{message:F,onRetry:nr}):o.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[o.jsxs("div",{className:"max-w-7xl mx-auto",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Stock Monitoring Dashboard"}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Monitor inventory levels and stock alerts"})]}),o.jsxs("div",{className:"flex space-x-4",children:[o.jsxs("button",{onClick:sn,disabled:ae,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white px-4 py-2 rounded-lg flex items-center transition-colors",children:[ae?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):o.jsx("span",{className:"mr-2",children:"🔄"}),"Refresh"]}),o.jsxs("button",{onClick:zr,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center transition-colors",children:[o.jsx("span",{className:"mr-2",children:"📦"}),"Request Stock"]})]})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-3 rounded-full bg-blue-100",children:o.jsx("span",{className:"text-2xl",children:"📦"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Items"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-3 rounded-full bg-red-100",children:o.jsx("span",{className:"text-2xl",children:"⚠️"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Low Stock Alerts"}),o.jsx("p",{className:"text-2xl font-bold text-red-600",children:E})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-3 rounded-full bg-yellow-100",children:o.jsx("span",{className:"text-2xl",children:"📈"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overstock Alerts"}),o.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:D})]})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm mb-6",children:[o.jsx("div",{className:"border-b border-gray-200",children:o.jsx("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs",children:[{id:"overview",label:"Available Units",icon:"📦"},{id:"low-stock",label:"Low Stock Alerts",icon:"⚠️"},{id:"overstock",label:"Overstock Alerts",icon:"📈"}].map(ze=>o.jsxs("button",{onClick:()=>t(ze.id),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center ${e===ze.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[o.jsx("span",{className:"mr-2",children:ze.icon}),ze.label,ze.id==="low-stock"&&E>0&&o.jsx("span",{className:"ml-2 bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs",children:E}),ze.id==="overstock"&&D>0&&o.jsx("span",{className:"ml-2 bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs",children:D})]},ze.id))})}),o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("span",{className:"text-gray-400",children:"🔍"})}),o.jsx("input",{type:"text",placeholder:"Search equipment, categories, or locations...",value:Y,onChange:ze=>X(ze.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]})}),e==="overview"&&o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Available Units"}),ci.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("span",{className:"text-4xl mb-4 block",children:"📦"}),o.jsx("p",{className:"text-gray-500",children:Y?"No equipment found matching your search.":"No equipment available."})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ci.map(ze=>o.jsx(st,{item:ze},ze.equipment_id))}),o.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:["Showing ",ci.length," of ",w," total items"]})]}),e==="low-stock"&&o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Low Stock Alerts"}),c.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("span",{className:"text-4xl mb-4 block",children:"✅"}),o.jsx("p",{className:"text-gray-500",children:"No low stock items found. All items are well stocked!"})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(ze=>o.jsx(st,{item:ze},ze.equipment_id))})]}),e==="overstock"&&o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Overstock Alerts"}),p.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("span",{className:"text-4xl mb-4 block",children:"✅"}),o.jsx("p",{className:"text-gray-500",children:"No overstock items found. Inventory levels are optimal!"})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(ze=>o.jsx(st,{item:ze},ze.equipment_id))})]})]})]})]}),se&&o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[o.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm transition-opacity",onClick:Vt,"aria-hidden":"true"}),o.jsxs("div",{ref:Mt,role:"dialog","aria-modal":"true","aria-labelledby":"archive-title","aria-describedby":"archive-desc",className:"relative w-full max-w-md mx-4 transform rounded-2xl bg-white shadow-2xl border border-gray-100 transition-all duration-200 ease-out",style:{willChange:"transform, opacity"},children:[o.jsx("div",{className:"rounded-t-2xl bg-gradient-to-r from-gray-50 to-white/80 px-5 py-3 border-b border-gray-100"}),o.jsx("div",{className:"p-6",children:o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("div",{className:"h-14 w-14 rounded-full bg-red-50 flex items-center justify-center ring-1 ring-red-100",children:o.jsx("span",{className:"text-3xl",children:"🗑️"})})}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("h3",{id:"archive-title",className:"text-lg font-semibold text-gray-900",children:["Archive ",ye==="category"?"Category":"Location",' "',Ve?.category_name??Ve?.location_name??Ve?.name,'"']}),o.jsxs("p",{id:"archive-desc",className:"mt-2 text-sm text-gray-600",children:["This cannot be undone easily. Are you sure you want to archive this ",ye==="category"?"category":"location","?"]}),Ve?.description&&o.jsx("div",{className:"mt-4 rounded-md bg-gray-50 p-3 border border-gray-100",children:o.jsx("p",{className:"text-sm text-gray-700 truncate",children:Ve.description})}),o.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3",children:[o.jsx("button",{onClick:Vt,className:"px-4 py-2 rounded-full bg-cyan-100 hover:bg-cyan-200 text-cyan-800 text-sm font-medium transition-shadow shadow-sm",disabled:$e,children:"Cancel"}),o.jsx("button",{ref:Ot,onClick:$t,className:`inline-flex items-center gap-2 px-5 py-2 rounded-full text-sm font-semibold text-white transition
                                                ${$e?"bg-teal-300 cursor-wait":"bg-teal-600 hover:bg-teal-700"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-400`,disabled:$e,"aria-disabled":$e,children:$e?o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white inline-block"}),"Archiving..."]}):o.jsx("span",{children:"Archive"})})]})]})]})})]})]}),Me&&o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[o.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm transition-opacity",onClick:un,"aria-hidden":"true"}),o.jsxs("div",{className:"relative w-full max-w-4xl mx-4 transform rounded-2xl bg-white shadow-2xl border border-gray-100 transition-all duration-200 ease-out",style:{willChange:"transform, opacity"},children:[o.jsx("div",{className:"rounded-t-2xl bg-gradient-to-r from-gray-50 to-white/80 px-5 py-3 border-b border-gray-100"}),o.jsx("div",{className:"p-6",children:o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("div",{className:"h-14 w-14 rounded-full bg-red-50 flex items-center justify-center ring-1 ring-red-100",children:o.jsx("span",{className:"text-3xl",children:"⚠️"})})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Select Items to Restock"}),o.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Choose which low stock items you want to request for restocking. You can select all or individual items."}),o.jsx("div",{className:"mt-4 max-h-96 overflow-y-auto",children:c.length===0?o.jsx("p",{className:"text-gray-500",children:"No low stock items found."}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center mb-4",children:[o.jsx("input",{type:"checkbox",checked:et.length===c.length&&c.length>0,onChange:Rr,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),o.jsxs("label",{className:"ml-2 text-sm font-medium text-gray-700 cursor-pointer",children:["Select All (",c.length," items)"]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:c.map(ze=>o.jsx(qt,{item:ze,isSelected:et.includes(ze.equipment_id),onToggle:or},ze.equipment_id))})]})}),o.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3",children:[o.jsx("button",{onClick:un,className:"px-4 py-2 rounded-full bg-cyan-100 hover:bg-cyan-200 text-cyan-800 text-sm font-medium transition-shadow shadow-sm",children:"Cancel"}),o.jsxs("button",{onClick:qr,disabled:et.length===0,className:`px-4 py-2 rounded-full text-sm font-medium transition-shadow shadow-sm ${et.length===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"}`,children:["Request Stock (",et.length,")"]})]})]})]})})]})]}),He&&o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[o.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm transition-opacity",onClick:hr,"aria-hidden":"true"}),o.jsxs("div",{className:"relative w-full max-w-4xl mx-4 transform rounded-2xl bg-white shadow-2xl border border-gray-100 transition-all duration-200 ease-out",style:{willChange:"transform, opacity"},children:[o.jsx("div",{className:"rounded-t-2xl bg-gradient-to-r from-gray-50 to-white/80 px-5 py-3 border-b border-gray-100"}),o.jsx("div",{className:"p-6",children:o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("div",{className:"h-14 w-14 rounded-full bg-blue-50 flex items-center justify-center ring-1 ring-blue-100",children:o.jsx("span",{className:"text-3xl",children:"📝"})})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Specify Quantities"}),o.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Enter the quantities you want to request for each selected item. Suggested quantities are pre-filled based on current stock levels."}),o.jsx("div",{className:"mt-4 max-h-96 overflow-y-auto",children:et.length===0?o.jsx("p",{className:"text-gray-500",children:"No items selected."}):o.jsx("div",{className:"space-y-4",children:et.map(ze=>{const Fe=c.find(jn=>jn.equipment_id===ze);return Fe?o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[o.jsxs("div",{className:"flex justify-between items-start mb-3",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-md font-semibold text-gray-900",children:Fe.name}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:Fe.category_name&&o.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:Fe.category_name})}),o.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Current Stock: ",o.jsxs("span",{className:"font-medium",children:[Fe.stock_quantity," units"]})]})]}),o.jsx(ui,{quantity:Fe.stock_quantity,type:"low"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Request Quantity:"}),o.jsx("input",{type:"number",min:"1",value:We[ze]||"",onChange:jn=>{const Xn=parseInt(jn.target.value)||0;Je(mr=>({...mr,[ze]:Xn}))},className:"w-24 px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"0"}),o.jsx("span",{className:"text-sm text-gray-500",children:"units"})]})]},ze):null})})}),o.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3",children:[o.jsx("button",{onClick:hr,className:"px-4 py-2 rounded-full bg-cyan-100 hover:bg-cyan-200 text-cyan-800 text-sm font-medium transition-shadow shadow-sm",disabled:jt,children:"Back"}),o.jsx("button",{onClick:Nn,disabled:jt,className:`px-4 py-2 rounded-full text-sm font-medium transition-shadow shadow-sm ${jt?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"}`,children:jt?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 inline-block"}),"Submitting..."]}):"Submit Requests"})]})]})]})})]})]}),o.jsx("div",{"aria-live":"polite",className:"fixed inset-0 z-50 flex items-center justify-center pointer-events-none",children:o.jsx("div",{className:"pointer-events-auto max-w-lg w-full px-4",children:o.jsxs("div",{role:"status",className:`mx-auto transform rounded-xl shadow-2xl border border-gray-100 bg-gradient-to-r from-white/90 to-gray-50/90 backdrop-blur-md px-5 py-3 flex items-center gap-4 transition-all duration-300 ease-out
							${an.show?"opacity-100 translate-y-0 scale-100":"opacity-0 -translate-y-4 scale-95"}`,style:{willChange:"transform, opacity"},children:[o.jsx("div",{className:`h-12 w-12 flex items-center justify-center rounded-full ${an.type==="success"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"} text-xl font-bold`,children:an.type==="success"?"✅":"❌"}),o.jsx("div",{className:"flex-1 min-w-0",children:o.jsxs("div",{className:"flex items-start justify-between gap-4",children:[o.jsxs("div",{className:"truncate",children:[o.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:an.title||(an.type==="success"?"Success":"Notice")}),o.jsx("p",{className:"mt-0.5 text-xs text-gray-500 truncate",children:an.message})]}),o.jsx("button",{onClick:lr,className:"ml-3 inline-flex items-center justify-center rounded-md p-1 text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500","aria-label":"Dismiss notification",children:"✖️"})]})})]})})})]})},kVe=()=>{const[e,t]=z.useState([]),[n,r]=z.useState(!0),[c,f]=z.useState(""),[p,s]=z.useState("all"),[w,T]=z.useState(!1),[E,N]=z.useState(null),[D,V]=z.useState(!1),[$,B]=z.useState(!1),[F,K]=z.useState(!1),[Y,X]=z.useState(!1),[ae,Z]=z.useState(!1),[se,he]=z.useState(null),[ye,Ce]=z.useState([]),[Ve,Re]=z.useState(!1),[$e,nt]=z.useState([]),[Me,rt]=z.useState(!1),[Ee,it]=z.useState({supplier_name:"",item_name:"",price:"",email:"",phone:"",address:"",website:"",comments:""}),[et,mt]=z.useState({email:"",phone:"",address:"",website:""}),[He,pt]=z.useState({rating:5}),[We,Je]=z.useState({name:""}),[jt,Pt]=z.useState({core2_supplier_id:"",supplier_name:"",item_name:"",price:"",email:"",phone:"",address:"",website:"",comments:""});z.useEffect(()=>{Ot()},[]);const Ot=async()=>{try{r(!0);const lr=await(await fetch(Ir.backend.api.suppliers)).json();t(lr)}catch($t){console.error("Error fetching suppliers:",$t)}finally{r(!1)}},Mt=e.filter($t=>{const lr=$t.supplier_name.toLowerCase().includes(c.toLowerCase())||$t.item_name?.toLowerCase().includes(c.toLowerCase()),ze=p==="all"||$t.status===p;return lr&&ze}),an=$t=>{it({...Ee,[$t.target.name]:$t.target.value})},Jt=$t=>{mt({...et,[$t.target.name]:$t.target.value})},Cn=$t=>{pt({rating:$t})},nr=$t=>{Je({...We,[$t.target.name]:$t.target.value})},sn=$t=>{N($t),it({supplier_id:$t.supplier_id,supplier_name:$t.supplier_name,item_name:$t.item_name||"",price:$t.price||"",email:$t.email||"",phone:$t.phone||"",address:$t.address||"",website:$t.website||"",comments:$t.comments||""}),T(!0)},zr=$t=>{he($t),mt({email:$t.email||"",phone:$t.phone||"",address:$t.address||"",website:$t.website||""}),V(!0)},or=$t=>{he($t),pt({rating:$t.rating||5}),B(!0)},Rr=async $t=>{$t.preventDefault();try{const lr=E?{...Ee}:{...Ee},ze=await fetch(Ir.backend.api.suppliers,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(lr)}),Fe=await ze.json();ze.ok?(await Ot(),T(!1),Zt.success(E?"Supplier updated successfully!":"Supplier created successfully!")):Zt.error("Error: "+Fe.message)}catch(lr){console.error("Error saving supplier:",lr),Zt.error("Error saving supplier")}},qr=async $t=>{$t.preventDefault();try{const lr=await fetch(Ir.backend.api.supplierContact.replace("{supplierId}",se.supplier_id),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(et)}),ze=await lr.json();lr.ok?(await Ot(),V(!1),Zt.success("Contact details updated successfully!")):Zt.error("Error: "+ze.message)}catch(lr){console.error("Error updating contact:",lr),Zt.error("Error updating contact details")}},Nn=async $t=>{$t.preventDefault();try{const lr=await fetch(Ir.backend.api.supplierRate.replace("{supplierId}",se.supplier_id),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(He)}),ze=await lr.json();lr.ok?(await Ot(),B(!1),Zt.success("Supplier rating updated successfully!")):Zt.error("Error: "+ze.message)}catch(lr){console.error("Error updating rating:",lr),Zt.error("Error updating supplier rating")}},ci=async $t=>{if(window.confirm("Are you sure you want to archive this supplier?"))try{(await fetch(Ir.backend.api.supplierArchive.replace("{id}",$t),{method:"PUT"})).ok?(await Ot(),Zt.success("Supplier archived successfully!")):Zt.error("Error archiving supplier")}catch(lr){console.error("Error archiving supplier:",lr),Zt.error("Error archiving supplier")}},ui=async $t=>{try{(await fetch(Ir.backend.api.supplierActivate.replace("{id}",$t),{method:"PUT"})).ok?(await Ot(),Zt.success("Supplier activated successfully!")):Zt.error("Error activating supplier")}catch(lr){console.error("Error activating supplier:",lr),Zt.error("Error activating supplier")}},st=async $t=>{$t.preventDefault();try{const lr=await fetch(Ir.backend.api.supplierRequests,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(We)}),ze=await lr.json();lr.ok?(K(!1),Je({name:""}),Zt.success("Supplier request submitted successfully!")):Zt.error("Error: "+ze.message)}catch(lr){console.error("Error submitting supplier request:",lr),Zt.error("Error submitting supplier request")}},qt=async()=>{try{Re(!0);const lr=await(await fetch(Ir.backend.api.supplierRequests)).json();Ce(lr)}catch($t){console.error("Error fetching supplier requests:",$t),Zt.error("Error fetching supplier requests")}finally{Re(!1)}},rn=()=>{qt(),X(!0)},Wn=async()=>{try{rt(!0);const lr=await(await fetch(Ir.backend.api.core2Suppliers)).json();nt(lr)}catch($t){console.error("Error fetching core2 suppliers:",$t),Zt.error("Error fetching core2 suppliers")}finally{rt(!1)}},Vt=()=>{Wn(),Z(!0)},un=async $t=>{try{const lr=await fetch(Ir.backend.api.addSupplier.replace("{id}",$t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"add"})}),ze=await lr.json();lr.ok?(await Wn(),await Ot(),Zt.success("Supplier Successfully Added!")):Zt.error("Error: "+ze.message)}catch(lr){console.error("Error updating supplier status:",lr),Zt.error("Error updating supplier status")}},hr=({rating:$t,onRatingChange:lr,readonly:ze=!1})=>o.jsxs("div",{className:"flex items-center",children:[[1,2,3,4,5].map(Fe=>o.jsx("button",{type:"button",className:`text-2xl ${ze?"cursor-default":"cursor-pointer hover:scale-110"} transition-transform ${Fe<=$t?"text-yellow-400":"text-gray-300"}`,onClick:()=>!ze&&lr(Fe),disabled:ze,children:"★"},Fe)),o.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(",$t,"/5)"]})]});return n?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:o.jsxs("div",{className:"max-w-7xl mx-auto",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Supplier Management"}),o.jsx("p",{className:"text-gray-600",children:"Manage supplier profiles, contact details, and performance ratings"})]}),o.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[o.jsx("input",{type:"text",placeholder:"Search suppliers...",value:c,onChange:$t=>f($t.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),o.jsxs("select",{value:p,onChange:$t=>s($t.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"all",children:"All Status"}),o.jsx("option",{value:"active",children:"Active"}),o.jsx("option",{value:"archived",children:"Archived"})]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:()=>K(!0),className:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:"Request Supplier"}),o.jsx("button",{onClick:Vt,className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"New Supplier"}),o.jsx("button",{onClick:rn,className:"bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition-colors",children:"Request List"})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Mt.map($t=>o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:$t.supplier_name}),o.jsx("p",{className:"text-gray-600",children:$t.item_name})]}),o.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${$t.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:$t.status})]}),o.jsxs("div",{className:"space-y-2 mb-4",children:[o.jsxs("div",{className:"flex items-start text-sm text-gray-600",children:[o.jsx("span",{className:"font-medium w-20 flex-shrink-0",children:"Email:"}),o.jsx("span",{className:"break-all",children:$t.email||"N/A"})]}),o.jsxs("div",{className:"flex items-start text-sm text-gray-600",children:[o.jsx("span",{className:"font-medium w-20 flex-shrink-0",children:"Phone:"}),o.jsx("span",{children:$t.phone||"N/A"})]}),o.jsxs("div",{className:"flex items-start text-sm text-gray-600",children:[o.jsx("span",{className:"font-medium w-20 flex-shrink-0",children:"Address:"}),o.jsx("span",{className:"break-words",children:$t.address||"N/A"})]}),o.jsxs("div",{className:"flex items-start text-sm text-gray-600",children:[o.jsx("span",{className:"font-medium w-20 flex-shrink-0",children:"Website:"}),o.jsx("span",{className:"break-all",children:$t.website?o.jsx("a",{href:$t.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:$t.website}):"N/A"})]}),o.jsxs("div",{className:"flex items-start text-sm text-gray-600",children:[o.jsx("span",{className:"font-medium w-20 flex-shrink-0",children:"Price:"}),o.jsx("span",{className:"font-semibold text-green-600",children:$t.price?`$${parseFloat($t.price).toFixed(2)}`:"N/A"})]}),o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx("span",{className:"font-medium w-20 flex-shrink-0",children:"Rating:"}),o.jsx(hr,{rating:$t.rating||0,readonly:!0})]}),$t.comments&&o.jsx("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:o.jsxs("div",{className:"flex items-start text-sm text-gray-600",children:[o.jsx("span",{className:"font-medium w-20 flex-shrink-0",children:"Notes:"}),o.jsx("span",{className:"break-words text-gray-700",children:$t.comments})]})})]}),o.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:$t.status==="active"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>sn($t),className:"bg-blue-100 text-blue-800 px-3 py-1 rounded text-sm hover:bg-blue-200 transition-colors",children:"Edit Profile"}),o.jsx("button",{onClick:()=>zr($t),className:"bg-green-100 text-green-800 px-3 py-1 rounded text-sm hover:bg-green-200 transition-colors",children:"Update Contact"}),o.jsx("button",{onClick:()=>or($t),className:"bg-yellow-100 text-yellow-800 px-3 py-1 rounded text-sm hover:bg-yellow-200 transition-colors",children:"Rate Performance"})]})}),o.jsx("div",{className:"flex gap-2",children:$t.status==="active"?o.jsx("button",{onClick:()=>ci($t.supplier_id),className:"bg-red-100 text-red-800 px-3 py-1 rounded text-sm hover:bg-red-200 transition-colors flex-1",children:"Archive"}):o.jsx("button",{onClick:()=>ui($t.supplier_id),className:"bg-green-100 text-green-800 px-3 py-1 rounded text-sm hover:bg-green-200 transition-colors flex-1",children:"Activate"})})]},$t.supplier_id))}),Mt.length===0&&o.jsx("div",{className:"text-center py-12",children:o.jsx("p",{className:"text-gray-500 text-lg",children:"No suppliers found"})}),D&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsx("div",{className:"bg-white rounded-lg max-w-md w-full",children:o.jsxs("div",{className:"p-6",children:[o.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Update Contact Details"}),o.jsxs("p",{className:"text-gray-600 mb-4",children:["Supplier: ",se?.supplier_name]}),o.jsxs("form",{onSubmit:qr,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),o.jsx("input",{type:"email",name:"email",value:et.email,onChange:Jt,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),o.jsx("input",{type:"tel",name:"phone",value:et.phone,onChange:Jt,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),o.jsx("textarea",{name:"address",value:et.address,onChange:Jt,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website"}),o.jsx("input",{type:"url",name:"website",value:et.website,onChange:Jt,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),o.jsxs("div",{className:"flex gap-4 pt-4",children:[o.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Update Contact"}),o.jsx("button",{type:"button",onClick:()=>V(!1),className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]})})}),$&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsx("div",{className:"bg-white rounded-lg max-w-md w-full",children:o.jsxs("div",{className:"p-6",children:[o.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Rate Supplier Performance"}),o.jsxs("p",{className:"text-gray-600 mb-4",children:["Supplier: ",se?.supplier_name]}),o.jsxs("p",{className:"text-gray-600 mb-6",children:["Current Rating: ",se?.rating||"Not rated"]}),o.jsxs("form",{onSubmit:Nn,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Performance Rating"}),o.jsx("div",{className:"flex justify-center",children:o.jsx(hr,{rating:He.rating,onRatingChange:Cn,readonly:!1})})]}),o.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[o.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Rating Guide:"}),o.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[o.jsx("div",{children:"⭐⭐⭐⭐⭐ (5) - Excellent performance"}),o.jsx("div",{children:"⭐⭐⭐⭐ (4) - Good performance"}),o.jsx("div",{children:"⭐⭐⭐ (3) - Satisfactory performance"}),o.jsx("div",{children:"⭐⭐ (2) - Needs improvement"}),o.jsx("div",{children:"⭐ (1) - Poor performance"})]})]}),o.jsxs("div",{className:"flex gap-4 pt-4",children:[o.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Submit Rating"}),o.jsx("button",{type:"button",onClick:()=>B(!1),className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]})})}),F&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsx("div",{className:"bg-white rounded-lg max-w-md w-full",children:o.jsxs("div",{className:"p-6",children:[o.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Request New Supplier"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Submit a request for a new supplier to be added to the system"}),o.jsxs("form",{onSubmit:st,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Name *"}),o.jsx("input",{type:"text",name:"name",value:We.name,onChange:nr,required:!0,maxLength:"100",placeholder:"Enter the name of the item you need",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),o.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[o.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Note:"}),o.jsx("p",{className:"text-sm text-blue-800",children:"Your request will be reviewed by the Core 2 team. You will be notified once the supplier is added to the system."})]}),o.jsxs("div",{className:"flex gap-4 pt-4",children:[o.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Submit Request"}),o.jsx("button",{type:"button",onClick:()=>K(!1),className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]})})}),Y&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Supplier Requests"}),o.jsx("button",{onClick:()=>X(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),Ve?o.jsx("div",{className:"flex justify-center items-center h-32",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):ye.length===0?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500 text-lg",children:"No supplier requests found"})}):o.jsx("div",{className:"space-y-4",children:ye.map(($t,lr)=>o.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:o.jsx("div",{className:"flex justify-between items-start",children:o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Requesting sent for a new supplier for this item"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:$t.name||"Unnamed Item"}),o.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"font-medium",children:"Status:"}),o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${$t.status==="pending"?"bg-yellow-100 text-yellow-800":$t.status==="approved"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:$t.status||"pending"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"font-medium",children:"Date:"}),o.jsx("span",{children:$t.created_at?new Date($t.created_at).toLocaleDateString():"N/A"})]})]})]})})},lr))}),o.jsx("div",{className:"flex justify-end mt-6",children:o.jsx("button",{onClick:()=>X(!1),className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Close"})})]})})}),w&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsx("div",{className:"bg-white rounded-lg max-w-lg w-full max-h-[90vh] overflow-y-auto",children:o.jsxs("div",{className:"p-6",children:[o.jsx("h2",{className:"text-2xl font-bold mb-6",children:E?"Edit Supplier Profile":"Add New Supplier"}),o.jsx("p",{className:"text-gray-600 mb-6",children:E?"Update supplier information":"Enter supplier details"}),o.jsxs("form",{onSubmit:Rr,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier Name *"}),o.jsx("input",{type:"text",name:"supplier_name",value:Ee.supplier_name,onChange:an,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter supplier name"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Name *"}),o.jsx("input",{type:"text",name:"item_name",value:Ee.item_name,onChange:an,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter item name"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price"}),o.jsx("input",{type:"number",name:"price",value:Ee.price,onChange:an,step:"0.01",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter price"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Comments/Notes"}),o.jsx("textarea",{name:"comments",value:Ee.comments,onChange:an,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter any additional notes or comments"})]}),o.jsxs("div",{className:"flex gap-4 pt-4",children:[o.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:E?"Update Supplier":"Add Supplier"}),o.jsx("button",{type:"button",onClick:()=>T(!1),className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]})})}),ae&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Core 2 Suppliers"}),o.jsx("p",{className:"text-gray-600",children:"View all suppliers from Core 2 system"})]}),o.jsx("button",{onClick:()=>Z(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),Me?o.jsx("div",{className:"flex justify-center items-center h-32",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):$e.length===0?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500 text-lg",children:"No Core 2 suppliers found"})}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:$e.filter($t=>$t.status==="pending").map($t=>o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[o.jsx("div",{className:"mb-4",children:o.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg mb-3",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:$t.supplier_name||$t.name}),o.jsx("p",{className:"text-blue-700 font-medium",children:$t.item_name})]})}),o.jsxs("div",{className:"space-y-2 text-sm",children:[$t.email&&o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-medium text-gray-700",children:"Email:"}),o.jsx("span",{className:"text-gray-600 break-all text-right",children:$t.email})]}),$t.phone&&o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-medium text-gray-700",children:"Phone:"}),o.jsx("span",{className:"text-gray-600",children:$t.phone})]}),$t.address&&o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-medium text-gray-700",children:"Address:"}),o.jsx("span",{className:"text-gray-600 break-words text-right",children:$t.address})]}),$t.website&&o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-medium text-gray-700",children:"Website:"}),o.jsx("span",{className:"text-gray-600 break-all text-right",children:o.jsx("a",{href:$t.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:$t.website})})]}),$t.price&&o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-medium text-gray-700",children:"Price:"}),o.jsxs("span",{className:"text-green-600 font-semibold",children:["$",parseFloat($t.price).toFixed(2)]})]}),$t.rating&&o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"font-medium text-gray-700",children:"Rating:"}),o.jsx(hr,{rating:$t.rating,readonly:!0})]}),$t.comments&&o.jsxs("div",{className:"mt-3 p-2 bg-white rounded border",children:[o.jsx("span",{className:"font-medium text-gray-700 block mb-1",children:"Notes:"}),o.jsx("span",{className:"text-gray-600 text-xs break-words",children:$t.comments})]})]}),o.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[o.jsx("div",{className:"flex justify-center mb-3",children:o.jsx("button",{onClick:()=>un($t.id),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors font-medium",children:"Add Supplier"})}),o.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[o.jsxs("span",{children:["Created: ",$t.created_at?new Date($t.created_at).toLocaleDateString():"N/A"]}),o.jsxs("span",{children:["Updated: ",$t.updated_at?new Date($t.updated_at).toLocaleDateString():"N/A"]})]})]})]},$t.id))}),o.jsx("div",{className:"flex justify-end mt-6",children:o.jsx("button",{onClick:()=>Z(!1),className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Close"})})]})})})]})})},IVe=()=>{const[e,t]=z.useState([]),[n,r]=z.useState(!1),[c,f]=z.useState(""),[p,s]=z.useState({request_id:"",supplier_id:"",total_amount:""}),[w,T]=z.useState([]),[E,N]=z.useState([]),[D,V]=z.useState("create"),[$,B]=z.useState(!1),[F,K]=z.useState(null),[Y,X]=z.useState({supplier_id:"",price:"",quantity:"",total:""});z.useEffect(()=>{ae(),Z(),se()},[]);const ae=async()=>{try{const Me=await fetch(Ir.backend.api.purchaseRequests);if(!Me.ok)throw new Error("Failed to fetch purchase requests");const rt=await Me.json();t(rt||[])}catch(Me){console.error("Error fetching purchase requests:",Me),f("Failed to fetch purchase requests")}},Z=async()=>{try{const Me=await fetch(Ir.backend.api.suppliers);if(!Me.ok)throw new Error("Failed to fetch suppliers");const rt=await Me.json();T(rt||[])}catch(Me){console.error("Error fetching suppliers:",Me),f("Failed to fetch suppliers")}},se=async()=>{try{const Me=await fetch(Ir.backend.api.lowStockRequests);if(!Me.ok)throw new Error("Failed to fetch low stock requests");const rt=await Me.json();N(rt||[])}catch(Me){console.error("Error fetching low stock requests:",Me),f("Failed to fetch low stock requests")}},he=async(Me,rt)=>{r(!0),f("");try{const Ee=await fetch(Ir.backend.api.purchaseRequestApprove.replace("{requestId}",Me),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:rt})});if(Ee.ok)alert(`Purchase request ${rt} successfully`),ae();else{const it=await Ee.json();f(it.error||"Failed to update purchase request status")}}catch(Ee){console.error("Error updating purchase request status:",Ee),f("Error updating purchase request status")}r(!1)},ye=Me=>{K(Me),X({supplier_id:"",price:"",quantity:Me.quantity,total:""}),B(!0)},Ce=()=>{B(!1),K(null),X({supplier_id:"",price:"",quantity:"",total:""})},Ve=Me=>{const rt=w.find(Ee=>String(Ee.supplier_id)===Me);X(Ee=>({...Ee,supplier_id:Me,price:rt?String(rt.price||""):""}))};z.useEffect(()=>{const Me=parseFloat(Y.price)||0,rt=parseFloat(Y.quantity)||0,Ee=(Me*rt).toFixed(2);X(it=>({...it,total:Ee}))},[Y.price,Y.quantity]);const Re=async Me=>{r(!0),f("");try{const rt=await fetch(Ir.backend.api.lowStockRequestUpdate.replace("{id}",Me),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"rejected"})});if(rt.ok)alert("Low stock request rejected successfully"),se();else{const Ee=await rt.json();f(Ee.error||"Failed to reject low stock request")}}catch(rt){console.error("Error rejecting low stock request:",rt),f("Error rejecting low stock request")}r(!1)},$e=async Me=>{if(Me.preventDefault(),!Y.supplier_id||!Y.price||!Y.total){f("Please fill all fields");return}r(!0),f("");try{const rt=await fetch(Ir.backend.api.purchaseRequestAdd,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lowstock_id:F.id,item_name:F.item_name,quantity:Y.quantity,supplier_id:Y.supplier_id,price_per_unit:Y.price,total_amount:Y.total,requested_by:F.requested_by,status:"pending"})});if(rt.ok)alert("Purchase request created successfully"),Ce(),se(),await fetch(Ir.backend.api.lowStockRequestUpdate.replace("{id}",F.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"submitted"})}),se();else{const Ee=await rt.json();f(Ee.error||"Failed to create purchase request")}}catch(rt){console.error("Error creating purchase request:",rt),f("Error creating purchase request")}r(!1)},nt=async Me=>{Me.preventDefault(),r(!0),f("");try{const rt=await fetch(Ir.backend.api.purchaseOrderAdd.replace("{requestId}",p.request_id),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({supplier_id:p.supplier_id,total_amount:p.total_amount})});if(rt.ok)alert("Purchase order issued successfully"),s({request_id:"",supplier_id:"",total_amount:""}),ae();else{const Ee=await rt.json();f(Ee.error||"Failed to issue purchase order")}}catch(rt){console.error("Error issuing purchase order:",rt),f("Error issuing purchase order")}r(!1)};return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:o.jsxs("div",{className:"max-w-full mx-auto bg-white rounded-lg shadow-lg p-4",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-4 text-center",children:"Purchase Processing"}),c&&o.jsx("p",{className:"text-red-500 bg-red-100 p-2 rounded mb-2 text-sm",children:c}),o.jsxs("div",{className:"flex justify-center mb-4 space-x-2 overflow-x-auto pb-2",children:[o.jsx("button",{onClick:()=>V("create"),className:`px-4 py-2 rounded-lg font-medium text-sm transition duration-200 whitespace-nowrap ${D==="create"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Create Request"}),o.jsx("button",{onClick:()=>V("approval"),className:`px-4 py-2 rounded-lg font-medium text-sm transition duration-200 whitespace-nowrap ${D==="approval"?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Approval"}),o.jsx("button",{onClick:()=>V("issue"),className:`px-4 py-2 rounded-lg font-medium text-sm transition duration-200 whitespace-nowrap ${D==="issue"?"bg-indigo-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Issue Order"})]}),D==="create"&&o.jsxs("section",{children:[o.jsx("h2",{className:"text-2xl font-semibold text-gray-700 mb-4",children:"Low Stock Requests"}),E.length>0?o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full bg-white border border-gray-300 table-fixed",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-100",children:[o.jsx("th",{className:"py-1 px-2 border-b text-base text-center w-40",children:"Item"}),o.jsx("th",{className:"py-1 px-2 border-b text-base text-center w-12",children:"Quantity"}),o.jsx("th",{className:"py-1 px-2 border-b text-base text-center w-24",children:"Requested By"}),o.jsx("th",{className:"py-1 px-2 border-b text-base text-center w-16",children:"Status"}),o.jsx("th",{className:"py-1 px-2 border-b text-base text-center w-20",children:"Action"})]})}),o.jsx("tbody",{children:E.map(Me=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"py-1 px-2 border-b text-base text-center truncate overflow-hidden",children:Me.item_name}),o.jsx("td",{className:"py-1 px-2 border-b text-base text-center",children:Me.quantity}),o.jsx("td",{className:"py-1 px-2 border-b text-base text-center truncate overflow-hidden",children:Me.requested_by||"N/A"}),o.jsx("td",{className:"py-1 px-2 border-b text-center",children:o.jsx("span",{className:`px-2 py-1 rounded text-base inline-block ${Me.status==="approved"?"bg-green-100 text-green-800":Me.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:Me.status})}),o.jsxs("td",{className:"py-1 px-2 border-b text-center",children:[Me.status==="pending"&&o.jsxs("div",{className:"flex flex-row space-x-1 justify-center",children:[o.jsx("button",{onClick:()=>ye(Me),disabled:n,className:"bg-green-600 text-white px-2 py-1 rounded text-base hover:bg-green-700 disabled:opacity-50 transition duration-200",children:"App"}),o.jsx("button",{onClick:()=>Re(Me.id),disabled:n,className:"bg-red-600 text-white px-2 py-1 rounded text-base hover:bg-red-700 disabled:opacity-50 transition duration-200",children:"Rej"})]}),Me.status==="submitted"&&o.jsx("span",{className:"text-blue-600 font-medium text-base block text-center",children:"Waiting for Approval"})]})]},Me.id))})]})}):o.jsx("p",{className:"text-gray-500",children:"No low stock requests available"})]}),D==="approval"&&o.jsxs("section",{children:[o.jsx("h2",{className:"text-2xl font-semibold text-gray-700 mb-4",children:"Approval Workflow"}),e.length>0?o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full bg-white border border-gray-300 table-fixed",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-100",children:[o.jsx("th",{className:"py-1 px-2 border-b text-base text-center w-16",children:"ID"}),o.jsx("th",{className:"py-1 px-2 border-b text-base text-center w-32",children:"Item"}),o.jsx("th",{className:"py-1 px-2 border-b text-base text-center w-12",children:"Quantity"}),o.jsx("th",{className:"py-1 px-2 border-b text-base text-center w-24",children:"Supplier"}),o.jsx("th",{className:"py-1 px-2 border-b text-base text-center w-16",children:"Price"}),o.jsx("th",{className:"py-1 px-2 border-b text-base text-center w-16",children:"Total"}),o.jsx("th",{className:"py-1 px-2 border-b text-base text-center w-24",children:"Requested By"}),o.jsx("th",{className:"py-1 px-2 border-b text-base text-center w-16",children:"Status"}),o.jsx("th",{className:"py-1 px-2 border-b text-base text-center w-20",children:"Action"})]})}),o.jsx("tbody",{children:e.map(Me=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"py-1 px-2 border-b text-base text-center",children:Me.request_id}),o.jsx("td",{className:"py-1 px-2 border-b text-base text-center truncate overflow-hidden",children:Me.item_name}),o.jsx("td",{className:"py-1 px-2 border-b text-base text-center",children:Me.quantity}),o.jsx("td",{className:"py-1 px-2 border-b text-base text-center truncate overflow-hidden",children:Me.supplier_name||"N/A"}),o.jsxs("td",{className:"py-1 px-2 border-b text-base text-center",children:["$",Me.price]}),o.jsxs("td",{className:"py-1 px-2 border-b text-base text-center",children:["$",Me.total_price]}),o.jsx("td",{className:"py-1 px-2 border-b text-base text-center truncate overflow-hidden",children:Me.requested_by||"N/A"}),o.jsx("td",{className:"py-1 px-2 border-b text-center",children:o.jsx("span",{className:`px-2 py-1 rounded text-base inline-block ${Me.status==="approved"?"bg-green-100 text-green-800":Me.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:Me.status})}),o.jsx("td",{className:"py-1 px-2 border-b text-center",children:Me.status==="pending"&&o.jsxs("div",{className:"flex flex-row space-x-1 justify-center",children:[o.jsx("button",{onClick:()=>he(Me.request_id,"approved"),disabled:n,className:"bg-green-600 text-white px-2 py-1 rounded text-base hover:bg-green-700 disabled:opacity-50 transition duration-200",children:"App"}),o.jsx("button",{onClick:()=>he(Me.request_id,"rejected"),disabled:n,className:"bg-red-600 text-white px-2 py-1 rounded text-base hover:bg-red-700 disabled:opacity-50 transition duration-200",children:"Rej"})]})})]},Me.request_id))})]})}):o.jsx("p",{className:"text-gray-500",children:"No purchase requests available"})]}),D==="issue"&&o.jsxs("section",{children:[o.jsx("h2",{className:"text-2xl font-semibold text-gray-700 mb-4",children:"Issue Purchase Order"}),o.jsxs("form",{onSubmit:nt,className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("select",{value:p.request_id,onChange:Me=>s({...p,request_id:Me.target.value}),required:!0,className:"p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"",children:"Select Approved Request"}),e.filter(Me=>Me.status==="approved").map(Me=>o.jsxs("option",{value:Me.request_id,children:["Request ID: ",Me.request_id]},Me.request_id))]}),o.jsxs("select",{value:p.supplier_id,onChange:Me=>s({...p,supplier_id:Me.target.value}),required:!0,className:"p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"",children:"Select Supplier"}),w.length>0?w.map(Me=>o.jsx("option",{value:Me.supplier_id,children:Me.supplier_name},Me.supplier_id)):o.jsx("option",{disabled:!0,children:"No suppliers available"})]}),o.jsx("input",{type:"number",placeholder:"Total Amount",value:p.total_amount,onChange:Me=>s({...p,total_amount:Me.target.value}),required:!0,className:"p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),o.jsx("button",{type:"submit",disabled:n,className:"w-full bg-indigo-600 text-white py-3 rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition duration-200",children:n?"Issuing...":"Issue Order"})]})]}),$&&F&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[o.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Create Purchase Request"}),o.jsxs("p",{className:"mb-4",children:[o.jsx("strong",{children:"Item Name:"})," ",F.item_name]}),o.jsxs("p",{className:"mb-4",children:[o.jsx("strong",{children:"Requested By:"})," ",F.requested_by||"N/A"]}),o.jsxs("form",{onSubmit:$e,children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Supplier"}),o.jsxs("select",{value:Y.supplier_id,onChange:Me=>Ve(Me.target.value),required:!0,className:"w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"",children:"Select Supplier"}),w.map(Me=>o.jsxs("option",{value:Me.supplier_id,children:[Me.supplier_name," - ",Me.item_name," - $",Me.price||"N/A"]},Me.supplier_id))]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Price per Unit"}),o.jsx("input",{type:"number",step:"0.01",value:Y.price,readOnly:!0,className:"w-full p-2 border border-gray-300 rounded bg-gray-100"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Quantity"}),o.jsx("input",{type:"number",value:Y.quantity,readOnly:!0,className:"w-full p-2 border border-gray-300 rounded bg-gray-100"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Total Amount"}),o.jsx("input",{type:"number",value:Y.total,readOnly:!0,className:"w-full p-2 border border-gray-300 rounded bg-gray-100"})]}),o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx("button",{type:"button",onClick:Ce,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:n,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:n?"Creating...":"Create Request"})]})]})]})})]})})};function LVe(){const[e,t]=z.useState([]),[n,r]=z.useState(!1),[c,f]=z.useState(""),[p,s]=z.useState(!1),[w,T]=z.useState("add"),[E,N]=z.useState({});z.useEffect(()=>{D()},[]);async function D(){r(!0);try{const X=await $r.get(Ir.backend.api.expenseRecords);t(X.data)}catch(X){console.error("Failed to fetch expense records",X)}finally{r(!1)}}const V=e.filter(X=>X.description?.toLowerCase().includes(c.toLowerCase()));function $(){T("add"),N({}),s(!0)}function B(X){T("edit"),N(X),s(!0)}function F(X){const{name:ae,value:Z}=X.target;N(se=>({...se,[ae]:Z}))}async function K(){try{w==="add"?await $r.post(Ir.backend.api.expenseRecordAdd,E):await $r.put(`${Ir.backend.api.expenseRecordUpdate}/${E.id}`,E),D(),s(!1)}catch(X){console.error("Failed to save expense",X)}}async function Y(X){try{await $r.put(`${Ir.backend.api.expenseRecordArchive}/${X}`),D()}catch(ae){console.error("Failed to archive expense",ae)}}return o.jsxs("div",{className:"flex",children:[o.jsx(td,{}),o.jsxs("main",{className:"flex-1 p-6",children:[o.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Expense Records"}),o.jsxs("div",{className:"flex justify-between mb-4",children:[o.jsx(On,{placeholder:"Search Expenses",value:c,onChange:X=>f(X.target.value),className:"max-w-xs"}),o.jsx(kt,{onClick:$,children:"Add Expense"})]}),o.jsxs(Pc,{children:[o.jsx(Mc,{children:o.jsxs(zi,{children:[o.jsx(vr,{children:"ID"}),o.jsx(vr,{children:"Description"}),o.jsx(vr,{children:"Amount"}),o.jsx(vr,{children:"Date"}),o.jsx(vr,{children:"Actions"})]})}),o.jsx(Rc,{children:n?o.jsx(zi,{children:o.jsx(qn,{colSpan:5,children:"Loading..."})}):V.length===0?o.jsx(zi,{children:o.jsx(qn,{colSpan:5,children:"No expenses found."})}):V.map(X=>o.jsxs(zi,{children:[o.jsx(qn,{children:X.id}),o.jsx(qn,{children:X.description}),o.jsx(qn,{children:X.amount}),o.jsx(qn,{children:X.date}),o.jsxs(qn,{children:[o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>B(X),className:"mr-2",children:"Edit"}),o.jsx(kt,{variant:"destructive",size:"sm",onClick:()=>Y(X.id),children:"Archive"})]})]},X.id))})]}),o.jsx(ds,{open:p,onOpenChange:s,children:o.jsxs(gs,{children:[o.jsx(ys,{children:o.jsxs(vs,{children:[w==="add"?"Add":"Edit"," Expense Record"]})}),o.jsx("div",{className:"space-y-4 py-2 pb-4",children:o.jsxs("form",{onSubmit:X=>{X.preventDefault(),K()},children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Description"}),o.jsx(On,{name:"description",value:E.description||"",onChange:F,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Amount"}),o.jsx(On,{name:"amount",type:"number",step:"0.01",value:E.amount||"",onChange:F,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Date"}),o.jsx(On,{name:"date",type:"date",value:E.date||"",onChange:F,required:!0})]}),o.jsx(Co,{children:o.jsx(kt,{type:"submit",children:w==="add"?"Add":"Save"})})]})})]})})]})]})}function zVe(){const[e,t]=z.useState("all"),[n,r]=z.useState([]),[c,f]=z.useState(!1),[p,s]=z.useState(""),[w,T]=z.useState(!1),[E,N]=z.useState("add"),[D,V]=z.useState({});z.useEffect(()=>{$()},[]);async function $(){f(!0);try{const Z=await $r.get(Ir.backend.api.equipmentSchedules);r(Z.data)}catch(Z){console.error("Failed to fetch equipment schedules",Z)}finally{f(!1)}}const B=n.filter(Z=>{const se=Z.equipment_name?.toLowerCase().includes(p.toLowerCase())||Z.project_name?.toLowerCase().includes(p.toLowerCase());return e==="all"?se:e==="pending"?se&&Z.status==="pending":e==="approved"?se&&Z.status==="approved":se});function F(){N("add"),V({}),T(!0)}function K(Z){N("edit"),V(Z),T(!0)}function Y(Z){const{name:se,value:he}=Z.target;V(ye=>({...ye,[se]:he}))}async function X(){try{E==="add"?await $r.post(Ir.backend.api.equipmentScheduleAdd,D):await $r.put(`${Ir.backend.api.equipmentScheduleUpdate}/${D.id}`,D),$(),T(!1)}catch(Z){console.error("Failed to save schedule",Z)}}async function ae(Z){try{await $r.put(`${Ir.backend.api.equipmentScheduleApprove}/${Z}`),$()}catch(se){console.error("Failed to approve schedule",se)}}return o.jsxs("div",{className:"flex",children:[o.jsx(td,{}),o.jsxs("main",{className:"flex-1 p-6",children:[o.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Equipment Scheduling"}),o.jsxs(EF,{value:e,onValueChange:t,children:[o.jsxs(CF,{children:[o.jsx(tv,{value:"all",children:"All Schedules"}),o.jsx(tv,{value:"pending",children:"Pending"}),o.jsx(tv,{value:"approved",children:"Approved"})]}),o.jsxs(gE,{value:e,children:[o.jsxs("div",{className:"flex justify-between mb-4",children:[o.jsx(On,{placeholder:"Search Schedules",value:p,onChange:Z=>s(Z.target.value),className:"max-w-xs"}),o.jsx(kt,{onClick:F,children:"Add Schedule"})]}),o.jsxs(Pc,{children:[o.jsx(Mc,{children:o.jsxs(zi,{children:[o.jsx(vr,{children:"ID"}),o.jsx(vr,{children:"Equipment"}),o.jsx(vr,{children:"Project"}),o.jsx(vr,{children:"Start Date"}),o.jsx(vr,{children:"End Date"}),o.jsx(vr,{children:"Status"}),o.jsx(vr,{children:"Actions"})]})}),o.jsx(Rc,{children:c?o.jsx(zi,{children:o.jsx(qn,{colSpan:7,children:"Loading..."})}):B.length===0?o.jsx(zi,{children:o.jsx(qn,{colSpan:7,children:"No schedules found."})}):B.map(Z=>o.jsxs(zi,{children:[o.jsx(qn,{children:Z.id}),o.jsx(qn,{children:Z.equipment_name}),o.jsx(qn,{children:Z.project_name}),o.jsx(qn,{children:Z.start_date}),o.jsx(qn,{children:Z.end_date}),o.jsx(qn,{children:Z.status}),o.jsxs(qn,{children:[o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>K(Z),className:"mr-2",children:"Edit"}),Z.status==="pending"&&o.jsx(kt,{variant:"default",size:"sm",onClick:()=>ae(Z.id),children:"Approve"})]})]},Z.id))})]})]})]}),o.jsx(ds,{open:w,onOpenChange:T,children:o.jsxs(gs,{children:[o.jsx(ys,{children:o.jsxs(vs,{children:[E==="add"?"Add":"Edit"," Equipment Schedule"]})}),o.jsx("div",{className:"space-y-4 py-2 pb-4",children:o.jsxs("form",{onSubmit:Z=>{Z.preventDefault(),X()},children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Equipment ID"}),o.jsx(On,{name:"equipment_id",type:"number",value:D.equipment_id||"",onChange:Y,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Project Name"}),o.jsx(On,{name:"project_name",value:D.project_name||"",onChange:Y,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Start Date"}),o.jsx(On,{name:"start_date",type:"date",value:D.start_date||"",onChange:Y,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"End Date"}),o.jsx(On,{name:"end_date",type:"date",value:D.end_date||"",onChange:Y,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Status"}),o.jsxs(Fs,{value:D.status||"",onValueChange:Z=>V({...D,status:Z}),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select status"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"pending",children:"Pending"}),o.jsx(Gn,{value:"approved",children:"Approved"}),o.jsx(Gn,{value:"completed",children:"Completed"})]})]})]}),o.jsx(Co,{children:o.jsx(kt,{type:"submit",children:E==="add"?"Add":"Save"})})]})})]})})]})]})}function FVe(){const[e,t]=z.useState("all"),[n,r]=z.useState([]),[c,f]=z.useState(!1),[p,s]=z.useState(""),[w,T]=z.useState(!1),[E,N]=z.useState("add"),[D,V]=z.useState({});z.useEffect(()=>{$()},[]);async function $(){f(!0);try{const Z=await $r.get(Ir.backend.api.deliveries);r(Z.data)}catch(Z){console.error("Failed to fetch deliveries",Z)}finally{f(!1)}}const B=n.filter(Z=>{const se=Z.item_name?.toLowerCase().includes(p.toLowerCase())||Z.destination?.toLowerCase().includes(p.toLowerCase());return e==="all"?se:e==="in-transit"?se&&Z.status==="in-transit":e==="delivered"?se&&Z.status==="delivered":se});function F(){N("add"),V({}),T(!0)}function K(Z){N("edit"),V(Z),T(!0)}function Y(Z){const{name:se,value:he}=Z.target;V(ye=>({...ye,[se]:he}))}async function X(){try{E==="add"?await $r.post(Ir.backend.api.deliveryAdd,D):await $r.put(`${Ir.backend.api.deliveryUpdate}/${D.id}`,D),$(),T(!1)}catch(Z){console.error("Failed to save delivery",Z)}}async function ae(Z){try{await $r.put(`${Ir.backend.api.markDelivered}/${Z}`),$()}catch(se){console.error("Failed to mark delivery as delivered",se)}}return o.jsxs("div",{className:"flex",children:[o.jsx(td,{}),o.jsxs("main",{className:"flex-1 p-6",children:[o.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Delivery & Transport Tracking"}),o.jsxs(EF,{value:e,onValueChange:t,children:[o.jsxs(CF,{children:[o.jsx(tv,{value:"all",children:"All Deliveries"}),o.jsx(tv,{value:"in-transit",children:"In Transit"}),o.jsx(tv,{value:"delivered",children:"Delivered"})]}),o.jsxs(gE,{value:e,children:[o.jsxs("div",{className:"flex justify-between mb-4",children:[o.jsx(On,{placeholder:"Search Deliveries",value:p,onChange:Z=>s(Z.target.value),className:"max-w-xs"}),o.jsx(kt,{onClick:F,children:"Add Delivery"})]}),o.jsxs(Pc,{children:[o.jsx(Mc,{children:o.jsxs(zi,{children:[o.jsx(vr,{children:"ID"}),o.jsx(vr,{children:"Item"}),o.jsx(vr,{children:"Destination"}),o.jsx(vr,{children:"Driver"}),o.jsx(vr,{children:"Status"}),o.jsx(vr,{children:"Delivery Date"}),o.jsx(vr,{children:"Actions"})]})}),o.jsx(Rc,{children:c?o.jsx(zi,{children:o.jsx(qn,{colSpan:7,children:"Loading..."})}):B.length===0?o.jsx(zi,{children:o.jsx(qn,{colSpan:7,children:"No deliveries found."})}):B.map(Z=>o.jsxs(zi,{children:[o.jsx(qn,{children:Z.id}),o.jsx(qn,{children:Z.item_name}),o.jsx(qn,{children:Z.destination}),o.jsx(qn,{children:Z.driver_name}),o.jsx(qn,{children:Z.status}),o.jsx(qn,{children:Z.delivery_date}),o.jsxs(qn,{children:[o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>K(Z),className:"mr-2",children:"Edit"}),Z.status!=="delivered"&&o.jsx(kt,{variant:"default",size:"sm",onClick:()=>ae(Z.id),children:"Mark Delivered"})]})]},Z.id))})]})]})]}),o.jsx(ds,{open:w,onOpenChange:T,children:o.jsxs(gs,{children:[o.jsx(ys,{children:o.jsxs(vs,{children:[E==="add"?"Add":"Edit"," Delivery"]})}),o.jsx("div",{className:"space-y-4 py-2 pb-4",children:o.jsxs("form",{onSubmit:Z=>{Z.preventDefault(),X()},children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Item Name"}),o.jsx(On,{name:"item_name",value:D.item_name||"",onChange:Y,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Destination"}),o.jsx(On,{name:"destination",value:D.destination||"",onChange:Y,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Driver Name"}),o.jsx(On,{name:"driver_name",value:D.driver_name||"",onChange:Y,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Status"}),o.jsxs(Fs,{value:D.status||"",onValueChange:Z=>V({...D,status:Z}),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select status"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"pending",children:"Pending"}),o.jsx(Gn,{value:"in-transit",children:"In Transit"}),o.jsx(Gn,{value:"delivered",children:"Delivered"})]})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Delivery Date"}),o.jsx(On,{name:"delivery_date",type:"date",value:D.delivery_date||"",onChange:Y,required:!0})]}),o.jsx(Co,{children:o.jsx(kt,{type:"submit",children:E==="add"?"Add":"Save"})})]})})]})})]})]})}function BVe(){const[e,t]=z.useState([]),[n,r]=z.useState(!1),[c,f]=z.useState(""),[p,s]=z.useState(!1),[w,T]=z.useState("add"),[E,N]=z.useState({}),[D,V]=z.useState({});z.useEffect(()=>{$()},[]);async function $(){r(!0);try{const Z=await $r.get(Ir.backend.api.logisticsReports);t(Z.data)}catch(Z){console.error("Failed to fetch reports",Z)}finally{r(!1)}}const B=e.filter(Z=>Z.report_type?.toLowerCase().includes(c.toLowerCase()));function F(){T("add"),N({}),s(!0)}function K(Z){T("view"),V(Z),s(!0)}function Y(Z){const{name:se,value:he}=Z.target;N(ye=>({...ye,[se]:he}))}async function X(){try{await $r.post(Ir.backend.api.logisticsReportAdd,E),$(),s(!1)}catch(Z){console.error("Failed to generate report",Z)}}async function ae(Z){try{await $r.put(`${Ir.backend.api.logisticsReportArchive}/${Z}`),$()}catch(se){console.error("Failed to archive report",se)}}return o.jsxs("div",{className:"flex",children:[o.jsx(td,{}),o.jsxs("main",{className:"flex-1 p-6",children:[o.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Tour Reports"}),o.jsxs("div",{className:"flex justify-between mb-4",children:[o.jsx(On,{placeholder:"Search Reports",value:c,onChange:Z=>f(Z.target.value),className:"max-w-xs"}),o.jsx(kt,{onClick:F,children:"Generate Report"})]}),o.jsxs(Pc,{children:[o.jsx(Mc,{children:o.jsxs(zi,{children:[o.jsx(vr,{children:"ID"}),o.jsx(vr,{children:"Report Type"}),o.jsx(vr,{children:"Generated Date"}),o.jsx(vr,{children:"Status"}),o.jsx(vr,{children:"Actions"})]})}),o.jsx(Rc,{children:n?o.jsx(zi,{children:o.jsx(qn,{colSpan:5,children:"Loading..."})}):B.length===0?o.jsx(zi,{children:o.jsx(qn,{colSpan:5,children:"No reports found."})}):B.map(Z=>o.jsxs(zi,{children:[o.jsx(qn,{children:Z.id}),o.jsx(qn,{children:Z.report_type}),o.jsx(qn,{children:Z.generated_date}),o.jsx(qn,{children:Z.status}),o.jsxs(qn,{children:[o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>K(Z),className:"mr-2",children:"View"}),o.jsx(kt,{variant:"destructive",size:"sm",onClick:()=>ae(Z.id),children:"Archive"})]})]},Z.id))})]}),o.jsx(ds,{open:p,onOpenChange:s,children:o.jsxs(gs,{children:[o.jsx(ys,{children:o.jsx(vs,{children:w==="add"?"Generate New Report":"View Report"})}),o.jsx("div",{className:"space-y-4 py-2 pb-4",children:w==="add"?o.jsxs("form",{onSubmit:Z=>{Z.preventDefault(),X()},children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Report Type"}),o.jsxs(Fs,{value:E.report_type||"",onValueChange:Z=>N({...E,report_type:Z}),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select report type"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Equipment Usage",children:"Equipment Usage"}),o.jsx(Gn,{value:"Delivery Summary",children:"Delivery Summary"}),o.jsx(Gn,{value:"Tour Performance",children:"Tour Performance"}),o.jsx(Gn,{value:"Maintenance Logs",children:"Maintenance Logs"})]})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Start Date"}),o.jsx(On,{name:"start_date",type:"date",value:E.start_date||"",onChange:Y,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"End Date"}),o.jsx(On,{name:"end_date",type:"date",value:E.end_date||"",onChange:Y,required:!0})]}),o.jsx(Co,{children:o.jsx(kt,{type:"submit",children:"Generate"})})]}):o.jsxs("div",{children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Report Type"}),o.jsx("p",{children:D.report_type})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Generated Date"}),o.jsx("p",{children:D.generated_date})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Status"}),o.jsx("p",{children:D.status})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Report Content"}),o.jsx(Ec,{value:D.content||"Report content not available",readOnly:!0,rows:10})]})]})})]})})]})]})}function UVe(){const[e,t]=z.useState([]),[n,r]=z.useState(!1),[c,f]=z.useState(""),[p,s]=z.useState(!1),[w,T]=z.useState("add"),[E,N]=z.useState({});z.useEffect(()=>{D()},[]);async function D(){r(!0);try{const X=await $r.get(Ir.backend.api.assets);t(X.data)}catch(X){console.error("Failed to fetch assets",X)}finally{r(!1)}}const V=e.filter(X=>X.asset_name?.toLowerCase().includes(c.toLowerCase()));function $(){T("add"),N({}),s(!0)}function B(X){T("edit"),N(X),s(!0)}function F(X){const{name:ae,value:Z}=X.target;N(se=>({...se,[ae]:Z}))}async function K(){try{w==="add"?await $r.post(Ir.backend.api.assetAdd,E):await $r.put(`${Ir.backend.api.assetUpdate}/${E.id}`,E),D(),s(!1)}catch(X){console.error("Failed to save asset",X)}}async function Y(X){try{await $r.put(`${Ir.backend.api.assetArchive}/${X}`),D()}catch(ae){console.error("Failed to archive asset",ae)}}return o.jsxs("div",{className:"flex",children:[o.jsx(td,{}),o.jsxs("main",{className:"flex-1 p-6",children:[o.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Asset Registration & QR Tagging"}),o.jsxs("div",{className:"flex justify-between mb-4",children:[o.jsx(On,{placeholder:"Search Assets",value:c,onChange:X=>f(X.target.value),className:"max-w-xs"}),o.jsx(kt,{onClick:$,children:"Add Asset"})]}),o.jsxs(Pc,{children:[o.jsx(Mc,{children:o.jsxs(zi,{children:[o.jsx(vr,{children:"ID"}),o.jsx(vr,{children:"Asset Name"}),o.jsx(vr,{children:"Category"}),o.jsx(vr,{children:"QR Code"}),o.jsx(vr,{children:"Status"}),o.jsx(vr,{children:"Actions"})]})}),o.jsx(Rc,{children:n?o.jsx(zi,{children:o.jsx(qn,{colSpan:6,children:"Loading..."})}):V.length===0?o.jsx(zi,{children:o.jsx(qn,{colSpan:6,children:"No assets found."})}):V.map(X=>o.jsxs(zi,{children:[o.jsx(qn,{children:X.id}),o.jsx(qn,{children:X.asset_name}),o.jsx(qn,{children:X.category}),o.jsx(qn,{children:X.qr_code}),o.jsx(qn,{children:X.status}),o.jsxs(qn,{children:[o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>B(X),className:"mr-2",children:"Edit"}),o.jsx(kt,{variant:"destructive",size:"sm",onClick:()=>Y(X.id),children:"Archive"})]})]},X.id))})]}),o.jsx(ds,{open:p,onOpenChange:s,children:o.jsxs(gs,{children:[o.jsx(ys,{children:o.jsxs(vs,{children:[w==="add"?"Add":"Edit"," Asset"]})}),o.jsx("div",{className:"space-y-4 py-2 pb-4",children:o.jsxs("form",{onSubmit:X=>{X.preventDefault(),K()},children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Asset Name"}),o.jsx(On,{name:"asset_name",value:E.asset_name||"",onChange:F,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Category"}),o.jsx(On,{name:"category",value:E.category||"",onChange:F,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"QR Code"}),o.jsx(On,{name:"qr_code",value:E.qr_code||"",onChange:F,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Status"}),o.jsxs(Fs,{value:E.status||"",onValueChange:X=>N({...E,status:X}),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select status"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"active",children:"Active"}),o.jsx(Gn,{value:"inactive",children:"Inactive"}),o.jsx(Gn,{value:"maintenance",children:"Maintenance"})]})]})]}),o.jsx(Co,{children:o.jsx(kt,{type:"submit",children:w==="add"?"Add":"Save"})})]})})]})})]})]})}function VVe(){const[e,t]=z.useState([]),[n,r]=z.useState(!1),[c,f]=z.useState(""),[p,s]=z.useState(!1),[w,T]=z.useState({});z.useEffect(()=>{E()},[]);async function E(){r(!0);try{const $=await $r.get(Ir.backend.api.maintenance);t($.data.filter(B=>B.type==="predictive"||!0))}catch($){console.error("Failed to fetch predictive alerts",$)}finally{r(!1)}}const N=e.filter($=>$.equipment_name?.toLowerCase().includes(c.toLowerCase()));function D($){T($),s(!0)}async function V($){console.log("Marking alert as resolved",$),t(e.map(B=>B.id===$?{...B,status:"resolved"}:B))}return o.jsxs("div",{className:"flex",children:[o.jsx(td,{}),o.jsxs("main",{className:"flex-1 p-6",children:[o.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Predictive Maintenance"}),o.jsx("div",{className:"flex justify-between mb-4",children:o.jsx(On,{placeholder:"Search Equipment",value:c,onChange:$=>f($.target.value),className:"max-w-xs"})}),o.jsxs(Pc,{children:[o.jsx(Mc,{children:o.jsxs(zi,{children:[o.jsx(vr,{children:"ID"}),o.jsx(vr,{children:"Equipment"}),o.jsx(vr,{children:"Predicted Issue"}),o.jsx(vr,{children:"Confidence"}),o.jsx(vr,{children:"Date"}),o.jsx(vr,{children:"Status"}),o.jsx(vr,{children:"Actions"})]})}),o.jsx(Rc,{children:n?o.jsx(zi,{children:o.jsx(qn,{colSpan:7,children:"Loading..."})}):N.length===0?o.jsx(zi,{children:o.jsx(qn,{colSpan:7,children:"No alerts found."})}):N.map($=>o.jsxs(zi,{children:[o.jsx(qn,{children:$.id}),o.jsx(qn,{children:$.equipment_name||$.asset_name}),o.jsx(qn,{children:$.predicted_issue||$.description}),o.jsx(qn,{children:$.confidence||"N/A"}),o.jsx(qn,{children:$.date}),o.jsx(qn,{children:$.status}),o.jsxs(qn,{children:[o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>D($),className:"mr-2",children:"View Details"}),$.status!=="resolved"&&o.jsx(kt,{variant:"default",size:"sm",onClick:()=>V($.id),children:"Mark Resolved"})]})]},$.id))})]}),o.jsx(ds,{open:p,onOpenChange:s,children:o.jsxs(gs,{children:[o.jsx(ys,{children:o.jsx(vs,{children:"Alert Details"})}),o.jsxs("div",{className:"space-y-4 py-2 pb-4",children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Equipment"}),o.jsx("p",{children:w.equipment_name||w.asset_name})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Predicted Issue"}),o.jsx("p",{children:w.predicted_issue||w.description})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Confidence"}),o.jsx("p",{children:w.confidence||"N/A"})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Date"}),o.jsx("p",{children:w.date})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Status"}),o.jsx("p",{children:w.status})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Details"}),o.jsx("p",{children:w.details||"Additional details not available"})]})]})]})})]})]})}function $Ve(){const[e,t]=z.useState([]),[n,r]=z.useState(!1),[c,f]=z.useState(""),[p,s]=z.useState(!1),[w,T]=z.useState("add"),[E,N]=z.useState({});z.useEffect(()=>{D()},[]);async function D(){r(!0);try{const X=await $r.get(Ir.backend.api.maintenance);t(X.data)}catch(X){console.error("Failed to fetch maintenance history",X)}finally{r(!1)}}const V=e.filter(X=>X.asset_name?.toLowerCase().includes(c.toLowerCase()));function $(){T("add"),N({}),s(!0)}function B(X){T("edit"),N(X),s(!0)}function F(X){const{name:ae,value:Z}=X.target;N(se=>({...se,[ae]:Z}))}async function K(){try{w==="add"?await $r.post(Ir.backend.api.maintenanceAdd,E):await $r.put(`${Ir.backend.api.maintenanceUpdate}/${E.id}`,E),D(),s(!1)}catch(X){console.error("Failed to save maintenance",X)}}async function Y(X){try{await $r.put(`${Ir.backend.api.maintenanceArchive}/${X}`),D()}catch(ae){console.error("Failed to archive maintenance",ae)}}return o.jsxs("div",{className:"flex",children:[o.jsx(td,{}),o.jsxs("main",{className:"flex-1 p-6",children:[o.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Maintenance History"}),o.jsxs("div",{className:"flex justify-between mb-4",children:[o.jsx(On,{placeholder:"Search Assets",value:c,onChange:X=>f(X.target.value),className:"max-w-xs"}),o.jsx(kt,{onClick:$,children:"Add Maintenance"})]}),o.jsxs(Pc,{children:[o.jsx(Mc,{children:o.jsxs(zi,{children:[o.jsx(vr,{children:"ID"}),o.jsx(vr,{children:"Asset"}),o.jsx(vr,{children:"Maintenance Type"}),o.jsx(vr,{children:"Date"}),o.jsx(vr,{children:"Technician"}),o.jsx(vr,{children:"Status"}),o.jsx(vr,{children:"Actions"})]})}),o.jsx(Rc,{children:n?o.jsx(zi,{children:o.jsx(qn,{colSpan:7,children:"Loading..."})}):V.length===0?o.jsx(zi,{children:o.jsx(qn,{colSpan:7,children:"No maintenance records found."})}):V.map(X=>o.jsxs(zi,{children:[o.jsx(qn,{children:X.id}),o.jsx(qn,{children:X.asset_name}),o.jsx(qn,{children:X.maintenance_type}),o.jsx(qn,{children:X.date}),o.jsx(qn,{children:X.technician}),o.jsx(qn,{children:X.status}),o.jsxs(qn,{children:[o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>B(X),className:"mr-2",children:"Edit"}),o.jsx(kt,{variant:"destructive",size:"sm",onClick:()=>Y(X.id),children:"Archive"})]})]},X.id))})]}),o.jsx(ds,{open:p,onOpenChange:s,children:o.jsxs(gs,{children:[o.jsx(ys,{children:o.jsxs(vs,{children:[w==="add"?"Add":"Edit"," Maintenance Record"]})}),o.jsx("div",{className:"space-y-4 py-2 pb-4",children:o.jsxs("form",{onSubmit:X=>{X.preventDefault(),K()},children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Asset ID"}),o.jsx(On,{name:"asset_id",type:"number",value:E.asset_id||"",onChange:F,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Maintenance Type"}),o.jsxs(Fs,{value:E.maintenance_type||"",onValueChange:X=>N({...E,maintenance_type:X}),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select type"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"preventive",children:"Preventive"}),o.jsx(Gn,{value:"corrective",children:"Corrective"}),o.jsx(Gn,{value:"predictive",children:"Predictive"}),o.jsx(Gn,{value:"emergency",children:"Emergency"})]})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Date"}),o.jsx(On,{name:"date",type:"date",value:E.date||"",onChange:F,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Technician"}),o.jsx(On,{name:"technician",value:E.technician||"",onChange:F,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Status"}),o.jsxs(Fs,{value:E.status||"",onValueChange:X=>N({...E,status:X}),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select status"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"scheduled",children:"Scheduled"}),o.jsx(Gn,{value:"in-progress",children:"In Progress"}),o.jsx(Gn,{value:"completed",children:"Completed"}),o.jsx(Gn,{value:"cancelled",children:"Cancelled"})]})]})]}),o.jsx(Co,{children:o.jsx(kt,{type:"submit",children:w==="add"?"Add":"Save"})})]})})]})})]})]})}function qVe(){const[e,t]=z.useState([]),[n,r]=z.useState(!1),[c,f]=z.useState(""),[p,s]=z.useState(!1),[w,T]=z.useState("add"),[E,N]=z.useState({});z.useEffect(()=>{D()},[]);async function D(){r(!0);try{const X=await $r.get(Ir.backend.api.deliveryReceipts);t(X.data)}catch(X){console.error("Failed to fetch delivery receipts",X)}finally{r(!1)}}const V=e.filter(X=>X.receipt_number?.toLowerCase().includes(c.toLowerCase())||X.supplier?.toLowerCase().includes(c.toLowerCase()));function $(){T("add"),N({}),s(!0)}function B(X){T("edit"),N(X),s(!0)}function F(X){const{name:ae,value:Z}=X.target;N(se=>({...se,[ae]:Z}))}async function K(){try{w==="add"?await $r.post(Ir.backend.api.deliveryReceiptAdd,E):await $r.put(`${Ir.backend.api.deliveryReceiptUpdate}/${E.id}`,E),D(),s(!1)}catch(X){console.error("Failed to save receipt",X)}}async function Y(X){try{await $r.put(`${Ir.backend.api.deliveryReceiptArchive}/${X}`),D()}catch(ae){console.error("Failed to archive receipt",ae)}}return o.jsxs("div",{className:"flex",children:[o.jsx(td,{}),o.jsxs("main",{className:"flex-1 p-6",children:[o.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Delivery Receipts"}),o.jsxs("div",{className:"flex justify-between mb-4",children:[o.jsx(On,{placeholder:"Search Receipts",value:c,onChange:X=>f(X.target.value),className:"max-w-xs"}),o.jsx(kt,{onClick:$,children:"Add Receipt"})]}),o.jsxs(Pc,{children:[o.jsx(Mc,{children:o.jsxs(zi,{children:[o.jsx(vr,{children:"ID"}),o.jsx(vr,{children:"Receipt Number"}),o.jsx(vr,{children:"Date"}),o.jsx(vr,{children:"Supplier"}),o.jsx(vr,{children:"Status"}),o.jsx(vr,{children:"Actions"})]})}),o.jsx(Rc,{children:n?o.jsx(zi,{children:o.jsx(qn,{colSpan:6,children:"Loading..."})}):V.length===0?o.jsx(zi,{children:o.jsx(qn,{colSpan:6,children:"No receipts found."})}):V.map(X=>o.jsxs(zi,{children:[o.jsx(qn,{children:X.id}),o.jsx(qn,{children:X.receipt_number}),o.jsx(qn,{children:X.date}),o.jsx(qn,{children:X.supplier}),o.jsx(qn,{children:X.status}),o.jsxs(qn,{children:[o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>B(X),className:"mr-2",children:"Edit"}),o.jsx(kt,{variant:"destructive",size:"sm",onClick:()=>Y(X.id),children:"Archive"})]})]},X.id))})]}),o.jsx(ds,{open:p,onOpenChange:s,children:o.jsxs(gs,{children:[o.jsx(ys,{children:o.jsxs(vs,{children:[w==="add"?"Add":"Edit"," Delivery Receipt"]})}),o.jsx("div",{className:"space-y-4 py-2 pb-4",children:o.jsxs("form",{onSubmit:X=>{X.preventDefault(),K()},children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Receipt Number"}),o.jsx(On,{name:"receipt_number",value:E.receipt_number||"",onChange:F,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Date"}),o.jsx(On,{name:"date",type:"date",value:E.date||"",onChange:F,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Supplier"}),o.jsx(On,{name:"supplier",value:E.supplier||"",onChange:F,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Status"}),o.jsxs(Fs,{value:E.status||"",onValueChange:X=>N({...E,status:X}),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select status"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"pending",children:"Pending"}),o.jsx(Gn,{value:"received",children:"Received"}),o.jsx(Gn,{value:"processed",children:"Processed"}),o.jsx(Gn,{value:"cancelled",children:"Cancelled"})]})]})]}),o.jsx(Co,{children:o.jsx(kt,{type:"submit",children:w==="add"?"Add":"Save"})})]})})]})})]})]})}function HVe(){const[e,t]=z.useState([]),[n,r]=z.useState(!1),[c,f]=z.useState(""),[p,s]=z.useState(!1),[w,T]=z.useState("add"),[E,N]=z.useState({});z.useEffect(()=>{D()},[]);async function D(){r(!0);try{const X=await $r.get(Ir.backend.api.equipmentLogs);t(X.data)}catch(X){console.error("Failed to fetch check-in/out logs",X)}finally{r(!1)}}const V=e.filter(X=>X.equipment_name?.toLowerCase().includes(c.toLowerCase())||X.user?.toLowerCase().includes(c.toLowerCase()));function $(){T("add"),N({}),s(!0)}function B(X){T("edit"),N(X),s(!0)}function F(X){const{name:ae,value:Z}=X.target;N(se=>({...se,[ae]:Z}))}async function K(){try{w==="add"?await $r.post(Ir.backend.api.equipmentLogAdd,E):await $r.put(`${Ir.backend.api.equipmentLogUpdate}/${E.id}`,E),D(),s(!1)}catch(X){console.error("Failed to save log",X)}}async function Y(X){try{await $r.put(`${Ir.backend.api.equipmentLogArchive}/${X}`),D()}catch(ae){console.error("Failed to archive log",ae)}}return o.jsxs("div",{className:"flex",children:[o.jsx(td,{}),o.jsxs("main",{className:"flex-1 p-6",children:[o.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Check-In/Check-Out Logs"}),o.jsxs("div",{className:"flex justify-between mb-4",children:[o.jsx(On,{placeholder:"Search Logs",value:c,onChange:X=>f(X.target.value),className:"max-w-xs"}),o.jsx(kt,{onClick:$,children:"Add Log"})]}),o.jsxs(Pc,{children:[o.jsx(Mc,{children:o.jsxs(zi,{children:[o.jsx(vr,{children:"ID"}),o.jsx(vr,{children:"Equipment"}),o.jsx(vr,{children:"Action"}),o.jsx(vr,{children:"Date"}),o.jsx(vr,{children:"User"}),o.jsx(vr,{children:"Actions"})]})}),o.jsx(Rc,{children:n?o.jsx(zi,{children:o.jsx(qn,{colSpan:6,children:"Loading..."})}):V.length===0?o.jsx(zi,{children:o.jsx(qn,{colSpan:6,children:"No logs found."})}):V.map(X=>o.jsxs(zi,{children:[o.jsx(qn,{children:X.id}),o.jsx(qn,{children:X.equipment_name}),o.jsx(qn,{children:X.action}),o.jsx(qn,{children:X.date}),o.jsx(qn,{children:X.user}),o.jsxs(qn,{children:[o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>B(X),className:"mr-2",children:"Edit"}),o.jsx(kt,{variant:"destructive",size:"sm",onClick:()=>Y(X.id),children:"Archive"})]})]},X.id))})]}),o.jsx(ds,{open:p,onOpenChange:s,children:o.jsxs(gs,{children:[o.jsx(ys,{children:o.jsxs(vs,{children:[w==="add"?"Add":"Edit"," Check-In/Check-Out Log"]})}),o.jsx("div",{className:"space-y-4 py-2 pb-4",children:o.jsxs("form",{onSubmit:X=>{X.preventDefault(),K()},children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Equipment ID"}),o.jsx(On,{name:"equipment_id",type:"number",value:E.equipment_id||"",onChange:F,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Action"}),o.jsxs(Fs,{value:E.action||"",onValueChange:X=>N({...E,action:X}),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select action"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"check-in",children:"Check-In"}),o.jsx(Gn,{value:"check-out",children:"Check-Out"})]})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Date"}),o.jsx(On,{name:"date",type:"datetime-local",value:E.date||"",onChange:F,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"User"}),o.jsx(On,{name:"user",value:E.user||"",onChange:F,required:!0})]}),o.jsx(Co,{children:o.jsx(kt,{type:"submit",children:w==="add"?"Add":"Save"})})]})})]})})]})]})}function GVe(){const[e,t]=z.useState([]),[n,r]=z.useState(!1),[c,f]=z.useState(""),[p,s]=z.useState(!1),[w,T]=z.useState("add"),[E,N]=z.useState({}),[D,V]=z.useState({});z.useEffect(()=>{$()},[]);async function $(){r(!0);try{const Z=await $r.get(Ir.backend.api.logisticsReports);t(Z.data)}catch(Z){console.error("Failed to fetch reports",Z)}finally{r(!1)}}const B=e.filter(Z=>Z.report_type?.toLowerCase().includes(c.toLowerCase()));function F(){T("add"),N({}),s(!0)}function K(Z){T("view"),V(Z),s(!0)}function Y(Z){const{name:se,value:he}=Z.target;N(ye=>({...ye,[se]:he}))}async function X(){try{await $r.post(Ir.backend.api.logisticsReportAdd,E),$(),s(!1)}catch(Z){console.error("Failed to generate report",Z)}}async function ae(Z){try{await $r.put(`${Ir.backend.api.logisticsReportArchive}/${Z}`),$()}catch(se){console.error("Failed to archive report",se)}}return o.jsxs("div",{className:"flex",children:[o.jsx(td,{}),o.jsxs("main",{className:"flex-1 p-6",children:[o.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Logistics Reports"}),o.jsxs("div",{className:"flex justify-between mb-4",children:[o.jsx(On,{placeholder:"Search Reports",value:c,onChange:Z=>f(Z.target.value),className:"max-w-xs"}),o.jsx(kt,{onClick:F,children:"Generate Report"})]}),o.jsxs(Pc,{children:[o.jsx(Mc,{children:o.jsxs(zi,{children:[o.jsx(vr,{children:"ID"}),o.jsx(vr,{children:"Report Type"}),o.jsx(vr,{children:"Generated Date"}),o.jsx(vr,{children:"Status"}),o.jsx(vr,{children:"Actions"})]})}),o.jsx(Rc,{children:n?o.jsx(zi,{children:o.jsx(qn,{colSpan:5,children:"Loading..."})}):B.length===0?o.jsx(zi,{children:o.jsx(qn,{colSpan:5,children:"No reports found."})}):B.map(Z=>o.jsxs(zi,{children:[o.jsx(qn,{children:Z.id}),o.jsx(qn,{children:Z.report_type}),o.jsx(qn,{children:Z.generated_date}),o.jsx(qn,{children:Z.status}),o.jsxs(qn,{children:[o.jsx(kt,{variant:"outline",size:"sm",onClick:()=>K(Z),className:"mr-2",children:"View"}),o.jsx(kt,{variant:"destructive",size:"sm",onClick:()=>ae(Z.id),children:"Archive"})]})]},Z.id))})]}),o.jsx(ds,{open:p,onOpenChange:s,children:o.jsxs(gs,{children:[o.jsx(ys,{children:o.jsx(vs,{children:w==="add"?"Generate New Report":"View Report"})}),o.jsx("div",{className:"space-y-4 py-2 pb-4",children:w==="add"?o.jsxs("form",{onSubmit:Z=>{Z.preventDefault(),X()},children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Report Type"}),o.jsxs(Fs,{value:E.report_type||"",onValueChange:Z=>N({...E,report_type:Z}),children:[o.jsx(Us,{children:o.jsx(Bs,{placeholder:"Select report type"})}),o.jsxs(Vs,{children:[o.jsx(Gn,{value:"Inventory Summary",children:"Inventory Summary"}),o.jsx(Gn,{value:"Delivery Performance",children:"Delivery Performance"}),o.jsx(Gn,{value:"Maintenance Overview",children:"Maintenance Overview"}),o.jsx(Gn,{value:"Asset Utilization",children:"Asset Utilization"}),o.jsx(Gn,{value:"Supplier Performance",children:"Supplier Performance"})]})]})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Start Date"}),o.jsx(On,{name:"start_date",type:"date",value:E.start_date||"",onChange:Y,required:!0})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"End Date"}),o.jsx(On,{name:"end_date",type:"date",value:E.end_date||"",onChange:Y,required:!0})]}),o.jsx(Co,{children:o.jsx(kt,{type:"submit",children:"Generate"})})]}):o.jsxs("div",{children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Report Type"}),o.jsx("p",{children:D.report_type})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Generated Date"}),o.jsx("p",{children:D.generated_date})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Status"}),o.jsx("p",{children:D.status})]}),o.jsxs("div",{children:[o.jsx(bt,{children:"Report Content"}),o.jsx(Ec,{value:D.content||"Report content not available",readOnly:!0,rows:10})]})]})})]})})]})]})}Wae.createRoot(document.getElementById("root")).render(o.jsx(lle,{basename:"/",children:o.jsx(jue,{children:o.jsxs(Eue,{defaultTheme:"dark",storageKey:"vite-ui-theme",children:[o.jsx(Xle,{richColors:!0}),o.jsxs(Foe,{children:[o.jsx(ms,{path:"/",element:o.jsx(lxe,{})}),o.jsx(ms,{path:"/login",element:o.jsx(Nue,{}),children:o.jsx(ms,{index:!0,element:o.jsx(u1e,{})})}),o.jsxs(ms,{path:"/hr2",element:o.jsx(IP,{allowedRoles:["Super Admin","HR2 Admin","Trainer","Employee"]}),children:[o.jsx(ms,{path:"db",element:o.jsx(nze,{})}),o.jsx(ms,{path:"cms",element:o.jsx(RFe,{})}),o.jsx(ms,{path:"lms",element:o.jsx(FFe,{})}),o.jsx(ms,{path:"tms",element:o.jsx(BFe,{})}),o.jsx(ms,{path:"sps",element:o.jsx(UFe,{})}),o.jsx(ms,{path:"ess",element:o.jsx($Fe,{})})]}),o.jsxs(ms,{path:"/logisticsII",children:[o.jsxs(ms,{element:o.jsx(IP,{allowedRoles:["LogisticsII Admin","Super Admin"]}),children:[o.jsx(ms,{index:!0,element:o.jsx(pBe,{})}),o.jsxs(ms,{path:"vehicles",children:[o.jsx(ms,{index:!0,element:o.jsx(s4e,{})}),o.jsx(ms,{path:":uuid",element:o.jsx(KUe,{})})]}),o.jsxs(ms,{path:"drivers",children:[o.jsx(ms,{index:!0,element:o.jsx(TVe,{})}),o.jsx(ms,{path:":uuid",element:o.jsx(PVe,{})})]})]}),o.jsxs(ms,{element:o.jsx(rxe,{allowedRoles:["LogisticsII Admin","Super Admin"]}),children:[o.jsxs(ms,{path:"dispatch",children:[o.jsx(ms,{index:!0,element:o.jsx(eVe,{})}),o.jsx(ms,{path:":batch_number",element:o.jsx(nVe,{})})]}),o.jsxs(ms,{path:"reservation",children:[o.jsx(ms,{index:!0,element:o.jsx(QUe,{})}),o.jsx(ms,{path:"make",element:o.jsx(dVe,{})}),o.jsx(ms,{path:":batch_number",element:o.jsx(bVe,{})})]}),o.jsx(ms,{path:"success",element:o.jsx(wVe,{})})]})]}),o.jsxs(ms,{path:"/logistics1",element:o.jsx(IP,{allowedRoles:["LogisticI Admin","Super Admin"]}),children:[o.jsx(ms,{index:!0,element:o.jsx(MVe,{})}),o.jsx(ms,{path:"InventoryManagement",element:o.jsx(RVe,{})}),o.jsx(ms,{path:"StorageOrganization",element:o.jsx(OVe,{})}),o.jsx(ms,{path:"StockMonitoring",element:o.jsx(DVe,{})}),o.jsx(ms,{path:"SupplierManagement",element:o.jsx(kVe,{})}),o.jsx(ms,{path:"PurchaseProcessing",element:o.jsx(IVe,{})}),o.jsx(ms,{path:"ExpenseRecords",element:o.jsx(LVe,{})}),o.jsx(ms,{path:"EquipmentScheduling",element:o.jsx(zVe,{})}),o.jsx(ms,{path:"DeliveryTransportTracking",element:o.jsx(FVe,{})}),o.jsx(ms,{path:"TourReports",element:o.jsx(BVe,{})}),o.jsx(ms,{path:"AssetRegistration",element:o.jsx(UVe,{})}),o.jsx(ms,{path:"PredictiveMaintenance",element:o.jsx(VVe,{})}),o.jsx(ms,{path:"MaintenanceHistory",element:o.jsx($Ve,{})}),o.jsx(ms,{path:"DeliveryReceipts",element:o.jsx(qVe,{})}),o.jsx(ms,{path:"CheckInOutLogs",element:o.jsx(HVe,{})}),o.jsx(ms,{path:"LogisticsReports",element:o.jsx(GVe,{})})]}),o.jsx(ms,{path:"*",element:o.jsx(d1e,{})})]})]})})}));
